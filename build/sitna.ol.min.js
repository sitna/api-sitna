function JL(e){if(!e)return JL.__;Array.prototype.reduce||(Array.prototype.reduce=function(e,t){for(var o=t,r=0;r<this.length;r++)o=e(o,this[r],r,this);return o});var t="";return("."+e).split(".").reduce(function(e,o,r,i){t=t?t+("."+o):o;o=e["__"+t];void 0===o&&(JL.Logger.prototype=e,o=new JL.Logger(t),e["__"+t]=o);return o},JL.__)}function xml2json(e){var t={toObj:function(e){var o={};if(1==e.nodeType){if(e.attributes.length)for(var r=0;r<e.attributes.length;r++)"name"!==e.attributes[r].nodeName&&(o[e.attributes[r].nodeName]=(e.attributes[r].nodeValue||"").toString());if(e.firstChild){for(var i=0,n=0,a=!1,l=e.firstChild;l;l=l.nextSibling)1==l.nodeType?a=!0:3==l.nodeType&&l.nodeValue.match(/[^ \f\n\r\t\v]/)?i++:4==l.nodeType&&n++;if(a)if(2>i&&2>n){t.removeWhite(e);for(var l=e.firstChild;l;l=l.nextSibling){var s=t.removePrefix(l.nodeName);if(3==l.nodeType)o["#text"]=t.escape(l.nodeValue);else if(4==l.nodeType)o["#cdata"]=t.escape(l.nodeValue);else if(o[s])o[s]instanceof Array?o[s][o[s].length]=t.toObj(l):o[s]=[o[s],t.toObj(l)];else{var p=null;l.attributes.getNamedItem("name")&&(p=l.attributes.getNamedItem("name").nodeValue),o[p?p:s]=t.toObj(l)}}}else e.attributes.length?o["#text"]=t.escape(t.innerXml(e)):o=t.escape(t.innerXml(e));else if(i)e.attributes.length?o["#text"]=t.escape(t.innerXml(e)):o=t.escape(t.innerXml(e));else if(n)if(n>1)o=t.escape(t.innerXml(e));else for(var l=e.firstChild;l;l=l.nextSibling)o["#cdata"]=t.escape(l.nodeValue)}e.attributes.length||e.firstChild||(o=null)}else 9==e.nodeType?o=t.toObj(e.documentElement):8==e.nodeType?console.log(e.textContent):alert("unhandled node type: "+e.nodeType);return o},toJson:function(e,o,r){var i=o?'"'+o+'"':"";if(e instanceof Array){for(var n=0,a=e.length;a>n;n++)e[n]=t.toJson(e[n],"",r+"	");i+=(o?":[":"[")+(e.length>1?"\n"+r+"	"+e.join(",\n"+r+"	")+"\n"+r:e.join(""))+"]"}else if(null==e)i+=(o&&":")+"null";else if("object"==typeof e){var l=[];for(var s in e)l[l.length]=t.toJson(e[s],s,r+"	");i+=(o?":{":"{")+(l.length>1?"\n"+r+"	"+l.join(",\n"+r+"	")+"\n"+r:l.join(""))+"}"}else i+="string"==typeof e?(o&&":")+'"'+e.toString()+'"':(o&&":")+e.toString();return i},innerXml:function(e){var t="";if("innerHTML"in e)t=e.innerHTML;else for(var o=function(e){var t="";if(1==e.nodeType){t+="<"+e.nodeName;for(var r=0;r<e.attributes.length;r++)t+=" "+e.attributes[r].nodeName+'="'+(e.attributes[r].nodeValue||"").toString()+'"';if(e.firstChild){t+=">";for(var i=e.firstChild;i;i=i.nextSibling)t+=o(i);t+="</"+e.nodeName+">"}else t+="/>"}else 3==e.nodeType?t+=e.nodeValue:4==e.nodeType&&(t+="<![CDATA["+e.nodeValue+"]]>");return t},r=e.firstChild;r;r=r.nextSibling)t+=o(r);return t},escape:function(e){return e.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(e){e.normalize();for(var o=e.firstChild;o;)if(3==o.nodeType)if(o.nodeValue.match(/[^ \f\n\r\t\v]/))o=o.nextSibling;else{var r=o.nextSibling;e.removeChild(o),o=r}else 1==o.nodeType?(t.removeWhite(o),o=o.nextSibling):o=o.nextSibling;return e},removePrefix:function(e){return e.substring(e.indexOf(":")+1)}};return 9==e.nodeType&&(e=e.documentElement),t.toObj(t.removeWhite(e))}window.Modernizr=function(e,t,o){function r(e){d.cssText=e}function i(e,t){return typeof e===t}var n,a,l,s="2.7.1",p={},c=t.documentElement,u="modernizr",g=t.createElement(u),d=g.style,h=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),f={},y=[],m=y.slice,v=function(e,o,r,i){var n,a,l,s,p=t.createElement("div"),g=t.body,d=g||t.createElement("body");if(parseInt(r,10))for(;r--;)l=t.createElement("div"),l.id=i?i[r]:u+(r+1),p.appendChild(l);return n=["&#173;",'<style id="s',u,'">',e,"</style>"].join(""),p.id=u,(g?p:d).innerHTML+=n,d.appendChild(p),g||(d.style.background="",d.style.overflow="hidden",s=c.style.overflow,c.style.overflow="hidden",c.appendChild(d)),a=o(p,e),g?p.parentNode.removeChild(p):(d.parentNode.removeChild(d),c.style.overflow=s),!!a},C=function(t){var o=e.matchMedia||e.msMatchMedia;if(o)return o(t).matches;var r;return v("@media "+t+" { #"+u+" { position: absolute; } }",function(t){r="absolute"==(e.getComputedStyle?getComputedStyle(t,null):t.currentStyle).position}),r},T={}.hasOwnProperty;l=i(T,"undefined")||i(T.call,"undefined")?function(e,t){return t in e&&i(e.constructor.prototype[t],"undefined")}:function(e,t){return T.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var o=m.call(arguments,1),r=function(){if(this instanceof r){var i=function(){};i.prototype=t.prototype;var n=new i,a=t.apply(n,o.concat(m.call(arguments)));return Object(a)===a?a:n}return t.apply(e,o.concat(m.call(arguments)))};return r}),f.canvas=function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},f.touch=function(){var o;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?o=!0:v(["@media (",h.join("touch-enabled),("),u,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){o=9===e.offsetTop}),o};for(var _ in f)l(f,_)&&(a=_.toLowerCase(),p[a]=f[_](),y.push((p[a]?"":"no-")+a));return p.addTest=function(e,t){if("object"==typeof e)for(var r in e)l(e,r)&&p.addTest(r,e[r]);else{e=e.toLowerCase();if(p[e]!==o)return p;t="function"==typeof t?t():t,"undefined"!=typeof enableClasses&&enableClasses&&(c.className+=" "+(t?"":"no-")+e),p[e]=t}return p},r(""),g=n=null,function(e,t){function o(e,t){var o=e.createElement("p"),r=e.getElementsByTagName("head")[0]||e.documentElement;return o.innerHTML="x<style>"+t+"</style>",r.insertBefore(o.lastChild,r.firstChild)}function r(){var e=v.elements;return"string"==typeof e?e.split(" "):e}function i(e){var t=m[e[f]];return t||(t={},y++,e[f]=y,m[y]=t),t}function n(e,o,r){o||(o=t);if(c)return o.createElement(e);r||(r=i(o));var n;return n=r.cache[e]?r.cache[e].cloneNode():h.test(e)?(r.cache[e]=r.createElem(e)).cloneNode():r.createElem(e),!n.canHaveChildren||d.test(e)||n.tagUrn?n:r.frag.appendChild(n)}function a(e,o){e||(e=t);if(c)return e.createDocumentFragment();o=o||i(e);for(var n=o.frag.cloneNode(),a=0,l=r(),s=l.length;s>a;a++)n.createElement(l[a]);return n}function l(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(o){return v.shivMethods?n(o,e,t):t.createElem(o)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+r().join().replace(/[\w\-]+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(v,t.frag)}function s(e){e||(e=t);var r=i(e);return v.shivCSS&&!p&&!r.hasCSS&&(r.hasCSS=!!o(e,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),c||l(e,r),e}var p,c,u="3.7.0",g=e.html5||{},d=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,h=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,f="_html5shiv",y=0,m={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",p="hidden"in e,c=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(o){p=!0,c=!0}}();var v={elements:g.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:u,shivCSS:g.shivCSS!==!1,supportsUnknownElements:c,shivMethods:g.shivMethods!==!1,type:"default",shivDocument:s,createElement:n,createDocumentFragment:a};e.html5=v,s(t)}(this,t),p._version=s,p._prefixes=h,p.mq=C,p.testStyles=v,p}(this,this.document),function(e,t,o){function r(e){return"[object Function]"==y.call(e)}function i(e){return"string"==typeof e}function n(){}function a(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function l(){var e=m.shift();v=1,e?e.t?h(function(){("c"==e.t?g.injectCss:g.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),l()):v=0}function s(e,o,r,i,n,s,p){function c(t){if(!d&&a(u.readyState)&&(C.r=d=1,!v&&l(),u.onload=u.onreadystatechange=null,t)){"img"!=e&&h(function(){_.removeChild(u)},50);for(var r in L[o])L[o].hasOwnProperty(r)&&L[o][r].onload()}}var p=p||g.errorTimeout,u=t.createElement(e),d=0,y=0,C={t:r,s:o,e:n,a:s,x:p};1===L[o]&&(y=1,L[o]=[]),"object"==e?u.data=o:(u.src=o,u.type=e),u.width=u.height="0",u.onerror=u.onload=u.onreadystatechange=function(){c.call(this,y)},m.splice(i,0,C),"img"!=e&&(y||2===L[o]?(_.insertBefore(u,T?null:f),h(c,p)):L[o].push(u))}function p(e,t,o,r,n){return v=0,t=t||"j",i(e)?s("c"==t?E:S,e,t,this.i++,o,r,n):(m.splice(this.i++,0,e),1==m.length&&l()),this}function c(){var e=g;return e.loader={load:p,i:0},e}var u,g,d=t.documentElement,h=e.setTimeout,f=t.getElementsByTagName("script")[0],y={}.toString,m=[],v=0,C="MozAppearance"in d.style,T=C&&!!t.createRange().compareNode,_=T?d:f.parentNode,d=e.opera&&"[object Opera]"==y.call(e.opera),d=!!t.attachEvent&&!d,S=C?"object":d?"script":"img",E=d?"script":S,x=Array.isArray||function(e){return"[object Array]"==y.call(e)},P=[],L={},w={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};g=function(e){function t(e){var t,o,r,e=e.split("!"),i=P.length,n=e.pop(),a=e.length,n={url:n,origUrl:n,prefixes:e};for(o=0;a>o;o++)r=e[o].split("="),(t=w[r.shift()])&&(n=t(n,r));for(o=0;i>o;o++)n=P[o](n);return n}function a(e,i,n,a,l){var s=t(e),p=s.autoCallback;s.url.split(".").pop().split("?").shift(),s.bypass||(i&&(i=r(i)?i:i[e]||i[a]||i[e.split("/").pop().split("?")[0]]),s.instead?s.instead(e,i,n,a,l):(L[s.url]?s.noexec=!0:L[s.url]=1,n.load(s.url,s.forceCSS||!s.forceJS&&"css"==s.url.split(".").pop().split("?").shift()?"c":o,s.noexec,s.attrs,s.timeout),(r(i)||r(p))&&n.load(function(){c(),i&&i(s.origUrl,l,a),p&&p(s.origUrl,l,a),L[s.url]=2})))}function l(e,t){function o(e,o){if(e){if(i(e))o||(u=function(){var e=[].slice.call(arguments);g.apply(this,e),d()}),a(e,u,t,0,p);else if(Object(e)===e)for(s in l=function(){var t,o=0;for(t in e)e.hasOwnProperty(t)&&o++;return o}(),e)e.hasOwnProperty(s)&&(!o&&!--l&&(r(u)?u=function(){var e=[].slice.call(arguments);g.apply(this,e),d()}:u[s]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),d()}}(g[s])),a(e[s],u,t,s,p))}else!o&&d()}var l,s,p=!!e.test,c=e.load||e.both,u=e.callback||n,g=u,d=e.complete||n;o(p?e.yep:e.nope,!!c),c&&o(c)}var s,p,u=this.yepnope.loader;if(i(e))a(e,0,u,0);else if(x(e))for(s=0;s<e.length;s++)p=e[s],i(p)?a(p,0,u,0):x(p)?g(p):Object(p)===p&&l(p,u);else Object(e)===e&&l(e,u)},g.addPrefix=function(e,t){w[e]=t},g.addFilter=function(e){P.push(e)},g.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",u=function(){t.removeEventListener("DOMContentLoaded",u,0),t.readyState="complete"},0)),e.yepnope=c(),e.yepnope.executeStack=l,e.yepnope.injectJs=function(e,o,r,i,s,p){var c,u,d=t.createElement("script"),i=i||g.errorTimeout;d.src=e;for(u in r)d.setAttribute(u,r[u]);o=p?l:o||n,d.onreadystatechange=d.onload=function(){!c&&a(d.readyState)&&(c=1,o(),d.onload=d.onreadystatechange=null)},h(function(){c||(c=1,o(1))},i),s?d.onload():f.parentNode.insertBefore(d,f)},e.yepnope.injectCss=function(e,o,r,i,a,s){var p,i=t.createElement("link"),o=s?l:o||n;i.href=e,i.rel="stylesheet",i.type="text/css";for(p in r)i.setAttribute(p,r[p]);a||(f.parentNode.insertBefore(i,f),h(o,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};!function(e,t){"function"==typeof define&&define.amd&&define.amd.dust===!0?define("dust.core",[],t):"object"==typeof exports?module.exports=t():e.dust=t()}(this,function(){function c(e,t){return e?"function"==typeof e&&e.template?e.template:n.isTemplateFn(e)?e:t!==!1?n.cache[e]:void 0:void 0}function o(e,t,o){if(!e)return t.setError(new Error("No template or template name provided to render"));var r=c(e,n.config.cache);return r?r(t,i.wrap(o,r.templateName)):n.onLoad?t.map(function(t){function r(e,r){var l;if(e)return t.setError(e);if(l=c(r,!1)||c(a,n.config.cache),!l){if(!n.compile)return t.setError(new Error("Dust compiler not available"));l=n.loadSource(n.compile(r,a))}l(t,i.wrap(o,l.templateName)).end()}var a=e;3===n.onLoad.length?n.onLoad(a,o.options,r):n.onLoad(a,r)}):t.setError(new Error("Template Not Found: "+e))}function i(e,t,o,r,i){void 0===e||e instanceof l||(e=new l(e));this.stack=e;this.global=t;this.options=o;this.blocks=r;this.templateName=i}function k(e,t,o){return function(r){return e.push(r)._get(t,o)}}function l(e,t,o,r){this.tail=t;this.isObject=e&&"object"==typeof e;this.head=e;this.index=o;this.of=r}function a(e){this.head=new t(this);this.callback=e;this.out=""}function e(){this.head=new t(this)}function t(e,t,o){this.root=e;this.next=t;this.data=[];this.flushable=!1;this.taps=o}function s(e,t){this.head=e;this.tail=t}var n={version:"2.7.1"},d="NONE",r="ERROR",u="WARN",v="INFO",f="DEBUG",y=function(){},h;n.config={whitespace:!1,amd:!1,cjs:!1,cache:!0};n._aliases={write:"w",end:"e",map:"m",render:"r",reference:"f",section:"s",exists:"x",notexists:"nx",block:"b",partial:"p",helper:"h"},function(){var e,t,o={DEBUG:0,INFO:1,WARN:2,ERROR:3,NONE:4};"undefined"!=typeof console&&console.log?(e=console.log,t="function"==typeof e?function(){e.apply(console,arguments)}:function(){e(Array.prototype.slice.apply(arguments).join(" "))}):t=y;n.log=function(e,r){r=r||v;o[r]>=o[n.debugLevel]&&t("[DUST:"+r+"]",e)};n.debugLevel=d;"undefined"!=typeof process&&process.env&&/\bdust\b/.test(process.env.DEBUG)&&(n.debugLevel=f)}();n.helpers={};n.cache={};n.register=function(e,t){e&&(t.templateName=e,n.config.cache!==!1&&(n.cache[e]=t))};n.render=function(e,t,r){var i=new a(r).head;try{o(e,i,t).end()}catch(n){i.setError(n)}};n.stream=function(t,r){var i=new e,a=i.head;return n.nextTick(function(){try{o(t,a,r).end()}catch(e){a.setError(e)}}),i};n.loadSource=function(source){return eval(source)};n.isArray=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};n.nextTick=function(){return function(e){setTimeout(e,0)}}();n.isEmpty=function(e){return 0===e?!1:n.isArray(e)&&!e.length?!0:!e};n.isEmptyObject=function(e){var t;if(null===e||void 0===e||e.length>0)return!1;for(t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0};n.isTemplateFn=function(e){return"function"==typeof e&&e.__dustBody};n.isThenable=function(e){return e&&"object"==typeof e&&"function"==typeof e.then};n.isStreamable=function(e){return e&&"function"==typeof e.on};n.filter=function(e,t,o){var r,i,a;if(o)for(r=0,i=o.length;i>r;r++)a=o[r],"s"===a?t=null:"function"==typeof n.filters[a]?e=n.filters[a](e):n.log("Invalid filter `"+a+"`",u);return t&&(e=n.filters[t](e)),e};n.filters={h:function(e){return n.escapeHtml(e)},j:function(e){return n.escapeJs(e)},u:encodeURI,uc:encodeURIComponent,js:function(e){return n.escapeJSON(e)},jp:function(e){return JSON?JSON.parse(e):(n.log("JSON is undefined; could not parse `"+e+"`",u),e)}};n.makeBase=n.context=function(e,t){return new i(void 0,e,t)};i.wrap=function(e,t){return e instanceof i?e:new i(e,{},{},null,t)};i.prototype.get=function(e,t){return"string"==typeof e&&("."===e[0]&&(t=!0,e=e.substr(1)),e=e.split(".")),this._get(t,e)};i.prototype._get=function(e,t){var o,i,a,l,s,p=this.stack||{},c=1;if(i=t[0],a=t.length,e&&0===a)l=p,p=p.head;else{if(e)p&&(p=p.head?p.head[i]:void 0);else{for(;p&&(!p.isObject||(l=p.head,o=p.head[i],void 0===o));)p=p.tail;p=void 0!==o?o:this.global&&this.global[i]}for(;p&&a>c;){if(n.isThenable(p))return p.then(k(this,e,t.slice(c)));l=p;p=p[t[c]];c++}}return"function"==typeof p?(s=function(){try{return p.apply(l,arguments)}catch(e){throw n.log(e,r),e}},s.__dustBody=!!p.__dustBody,s):(void 0===p&&n.log("Cannot find reference `{"+t.join(".")+"}` in template `"+this.getTemplateName()+"`",v),p)};i.prototype.getPath=function(e,t){return this._get(e,t)};i.prototype.push=function(e,t,o){return void 0===e?(n.log("Not pushing an undefined variable onto the context",v),this):this.rebase(new l(e,this.stack,t,o))};i.prototype.pop=function(){var e=this.current();return this.stack=this.stack&&this.stack.tail,e};i.prototype.rebase=function(e){return new i(e,this.global,this.options,this.blocks,this.getTemplateName())};i.prototype.clone=function(){var e=this.rebase();return e.stack=this.stack,e};i.prototype.current=function(){return this.stack&&this.stack.head};i.prototype.getBlock=function(e){var o,r,i;if("function"==typeof e&&(e=e(new t,this).data.join("")),o=this.blocks,!o)return n.log("No blocks for context `"+e+"` in template `"+this.getTemplateName()+"`",f),!1;for(r=o.length;r--;)if(i=o[r][e])return i;return n.log("Malformed template `"+this.getTemplateName()+"` was missing one or more blocks."),!1};i.prototype.shiftBlocks=function(e){var t,o=this.blocks;return e?(t=o?o.concat([e]):[e],new i(this.stack,this.global,this.options,t,this.getTemplateName())):this};i.prototype.resolve=function(e){var o;return"function"!=typeof e?e:(o=(new t).render(e,this),o instanceof t?o.data.join(""):o)};i.prototype.getTemplateName=function(){return this.templateName};a.prototype.flush=function(){for(var e=this.head;e;){if(!e.flushable)return e.error?(this.callback(e.error),n.log("Rendering failed with error `"+e.error+"`",r),void(this.flush=y)):void 0;this.out+=e.data.join("");e=e.next;this.head=e}this.callback(null,this.out)};e.prototype.flush=function(){for(var e=this.head;e;){if(!e.flushable)return e.error?(this.emit("error",e.error),this.emit("end"),n.log("Streaming failed with error `"+e.error+"`",r),void(this.flush=y)):void 0;this.emit("data",e.data.join(""));e=e.next;this.head=e}this.emit("end")};e.prototype.emit=function(e,t){var o,r,i=this.events||{},a=i[e]||[];if(!a.length)return n.log("Stream broadcasting, but no listeners for `"+e+"`",f),!1;for(a=a.slice(0),o=0,r=a.length;r>o;o++)a[o](t);return!0};e.prototype.on=function(e,t){var o=this.events=this.events||{},r=o[e]=o[e]||[];return"function"!=typeof t?n.log("No callback function provided for `"+e+"` event listener",u):r.push(t),this};e.prototype.pipe=function(e){if("function"!=typeof e.write||"function"!=typeof e.end)return n.log("Incompatible stream passed to `pipe`",u),this;var t=!1;return"function"==typeof e.emit&&e.emit("pipe",this),"function"==typeof e.on&&e.on("error",function(){t=!0}),this.on("data",function(o){if(!t)try{e.write(o,"utf8")}catch(i){n.log(i,r)}}).on("end",function(){if(!t)try{e.end();t=!0}catch(o){n.log(o,r)}})};t.prototype.write=function(e){var t=this.taps;return t&&(e=t.go(e)),this.data.push(e),this};t.prototype.end=function(e){return e&&this.write(e),this.flushable=!0,this.root.flush(),this};t.prototype.map=function(e){var o=new t(this.root,this.next,this.taps),i=new t(this.root,o,this.taps);this.next=i;this.flushable=!0;try{e(i)}catch(a){n.log(a,r);i.setError(a)}return o};t.prototype.tap=function(e){var t=this.taps;return this.taps=t?t.push(e):new s(e),this};t.prototype.untap=function(){return this.taps=this.taps.tail,this};t.prototype.render=function(e,t){return e(this,t)};t.prototype.reference=function(e,o,r,i){return"function"==typeof e?(e=e.apply(o.current(),[this,o,null,{auto:r,filters:i}]),e instanceof t?e:this.reference(e,o,r,i)):n.isThenable(e)?this.await(e,o,null,r,i):n.isStreamable(e)?this.stream(e,o,null,r,i):n.isEmpty(e)?this:this.write(n.filter(e,r,i))};t.prototype.section=function(e,o,i,a){var l,s,p,c=i.block,u=i["else"],g=this;if("function"==typeof e&&!n.isTemplateFn(e)){try{e=e.apply(o.current(),[this,o,i,a])}catch(d){return n.log(d,r),this.setError(d)}if(e instanceof t)return e}if(n.isEmptyObject(a)||(o=o.push(a)),n.isArray(e)){if(c){if(s=e.length,s>0){for(p=o.stack&&o.stack.head||{},p.$len=s,l=0;s>l;l++)p.$idx=l,g=c(g,o.push(e[l],l,s));return p.$idx=void 0,p.$len=void 0,g}if(u)return u(this,o)}}else{if(n.isThenable(e))return this.await(e,o,i);if(n.isStreamable(e))return this.stream(e,o,i);if(e===!0){if(c)return c(this,o)}else if(e||0===e){if(c)return c(this,o.push(e))}else if(u)return u(this,o)}return n.log("Section without corresponding key in template `"+o.getTemplateName()+"`",f),this};t.prototype.exists=function(e,t,o){var r=o.block,i=o["else"];if(n.isEmpty(e)){if(i)return i(this,t)}else{if(r)return r(this,t);n.log("No block for exists check in template `"+t.getTemplateName()+"`",f)}return this};t.prototype.notexists=function(e,t,o){var r=o.block,i=o["else"];if(n.isEmpty(e)){if(r)return r(this,t);n.log("No block for not-exists check in template `"+t.getTemplateName()+"`",f)}else if(i)return i(this,t);return this};t.prototype.block=function(e,t,o){var r=e||o.block;return r?r(this,t):this};t.prototype.partial=function(e,t,r,i){var a;return void 0===i&&(i=r,r=t),n.isEmptyObject(i)||(r=r.clone(),a=r.pop(),r=r.push(i).push(a)),n.isTemplateFn(e)?this.capture(e,t,function(e,t){r.templateName=e;o(e,t,r).end()}):(r.templateName=e,o(e,this,r))};t.prototype.helper=function(e,t,o,i){var a,l=this;if(!n.helpers[e])return n.log("Helper `"+e+"` does not exist",u),l;try{return a=n.helpers[e](l,t,o,i),n.isThenable(a)?this.await(a,t,o):a}catch(s){return n.log("Error in helper `"+e+"`: "+s.message,r),l.setError(s)}};t.prototype.await=function(e,t,o,r,i){var a=o&&o.block,l=o&&o.error;return this.map(function(o){e.then(function(e){a?o.render(a,t.push(e)).end():o.reference(e,t,r,i).end()},function(e){l?o.render(l,t.push(e)).end():(n.log("Unhandled promise rejection in `"+t.getTemplateName()+"`"),o.end())})})};t.prototype.stream=function(e,t,o,r,i){var a=o&&o.block,l=o&&o.error;return this.map(function(o){var s=!1;e.on("data",function(e){s||(o=a?o.map(function(o){o.render(a,t.push(e)).end()}):o.reference(e,t,r,i))}).on("error",function(e){s||(l?o.render(l,t.push(e)):n.log("Unhandled stream error in `"+t.getTemplateName()+"`"),s||(s=!0,o.end()))}).on("end",function(){s||(s=!0,o.end())})})};t.prototype.capture=function(e,t,o){return this.map(function(r){var i=new a(function(e,t){e?r.setError(e):o(t,r)});e(i.head,t).end()})};t.prototype.setError=function(e){return this.error=e,this.root.flush(),this};for(h in t.prototype)n._aliases[h]&&(t.prototype[n._aliases[h]]=t.prototype[h]);s.prototype.push=function(e){return new s(e,this)};s.prototype.go=function(e){for(var t=this;t;)e=t.head(e),t=t.tail;return e};var g=/[&<>"']/,nt=/&/g,p=/</g,tt=/>/g,it=/\"/g,rt=/\'/g;n.escapeHtml=function(e){return"string"==typeof e||e&&"function"==typeof e.toString?("string"!=typeof e&&(e=e.toString()),g.test(e)?e.replace(nt,"&amp;").replace(p,"&lt;").replace(tt,"&gt;").replace(it,"&quot;").replace(rt,"&#39;"):e):e};var ut=/\\/g,ft=/\//g,et=/\r/g,w=/\u2028/g,b=/\u2029/g,ot=/\n/g,st=/\f/g,ht=/'/g,ct=/"/g,lt=/\t/g;return n.escapeJs=function(e){return"string"==typeof e?e.replace(ut,"\\\\").replace(ft,"\\/").replace(ct,'\\"').replace(ht,"\\'").replace(et,"\\r").replace(w,"\\u2028").replace(b,"\\u2029").replace(ot,"\\n").replace(st,"\\f").replace(lt,"\\t"):e},n.escapeJSON=function(e){return JSON?JSON.stringify(e).replace(w,"\\u2028").replace(b,"\\u2029").replace(p,"\\u003c"):(n.log("JSON is undefined; could not escape `"+e+"`",u),e)},n}),function(e,t){"function"==typeof define&&define.amd&&define.amd.dust===!0?define("dust.parse",["dust.core"],function(e){return t(e).parse}):"object"==typeof exports?module.exports=t(require("./dust")):t(e.dust)}(this,function(e){var t=function(){function e(e,t){function o(){this.constructor=e}o.prototype=t.prototype;e.prototype=new o}function t(e,t,o,r,i,n){this.message=e;this.expected=t;this.found=o;this.offset=r;this.line=i;this.column=n;this.name="SyntaxError"}function o(e){function o(){return n(Eo).line}function r(){return n(Eo).column}function i(e){throw l(e,null,Eo)}function n(t){function o(t,o,r){for(var i,n=o;r>n;n++)i=e.charAt(n),"\n"===i?(t.seenCR||t.line++,t.column=1,t.seenCR=!1):"\r"===i||"\u2028"===i||"\u2029"===i?(t.line++,t.column=1,t.seenCR=!0):(t.column++,t.seenCR=!1)}return xo!==t&&(xo>t&&(xo=0,Po={line:1,column:1,seenCR:!1}),o(Po,xo,t),xo=t),Po}function a(e){Lo>So||(So>Lo&&(Lo=So,wo=[]),wo.push(e))}function l(o,r,i){function a(e){var t=1;for(e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}function l(e,t){function o(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0180-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1080-\uFFFF]/g,function(e){return"\\u"+t(e)})}for(var r,i,n=new Array(e.length),a=0;a<e.length;a++)n[a]=e[a].description;return r=e.length>1?n.slice(0,-1).join(", ")+" or "+n[e.length-1]:n[0],i=t?'"'+o(t)+'"':"end of input","Expected "+r+" but "+i+" found."}var s=n(i),p=i<e.length?e.charAt(i):null;return null!==r&&a(r),new t(null!==o?o:l(r,p),r,p,i,s.line,s.column)}function s(){return p()}function p(){var e,t,o;for(e=So,t=[],o=c();o!==H;)t.push(o),o=c();return t!==H&&(Eo=e,t=J(t)),e=t}function c(){var e;return e=F(),e===H&&(e=k(),e===H&&(e=u(),e===H&&(e=v(),e===H&&(e=T(),e===H&&(e=m(),e===H&&(e=O())))))),e}function u(){var t,o,r,i,n,l,s,c;if(Ro++,t=So,o=g(),o!==H){for(r=[],i=W();i!==H;)r.push(i),i=W();r!==H?(i=B(),i!==H?(n=p(),n!==H?(l=y(),l!==H?(s=d(),s===H&&(s=te),s!==H?(Eo=So,c=oe(o,n,l,s),c=c?re:ee,c!==H?(Eo=t,o=ie(o,n,l,s),t=o):(So=t,t=ee)):(So=t,t=ee)):(So=t,t=ee)):(So=t,t=ee)):(So=t,t=ee)):(So=t,t=ee)}else So=t,t=ee;if(t===H)if(t=So,o=g(),o!==H){for(r=[],i=W();i!==H;)r.push(i),i=W();r!==H?(47===e.charCodeAt(So)?(i=ne,So++):(i=H,0===Ro&&a(ae)),i!==H?(n=B(),n!==H?(Eo=t,o=le(o),t=o):(So=t,t=ee)):(So=t,t=ee)):(So=t,t=ee)}else So=t,t=ee;return Ro--,t===H&&(o=H,0===Ro&&a(Q)),t}function g(){var t,o,r,i,n,l,s;if(t=So,o=U(),o!==H)if(se.test(e.charAt(So))?(r=e.charAt(So),So++):(r=H,0===Ro&&a(pe)),r!==H){for(i=[],n=W();n!==H;)i.push(n),n=W();i!==H?(n=_(),n!==H?(l=h(),l!==H?(s=f(),s!==H?(Eo=t,o=ce(r,n,l,s),t=o):(So=t,t=ee)):(So=t,t=ee)):(So=t,t=ee)):(So=t,t=ee)}else So=t,t=ee;else So=t,t=ee;return t}function d(){var t,o,r,i,n,l,s;if(Ro++,t=So,o=U(),o!==H)if(47===e.charCodeAt(So)?(r=ne,So++):(r=H,0===Ro&&a(ae)),r!==H){for(i=[],n=W();n!==H;)i.push(n),n=W();if(i!==H)if(n=_(),n!==H){for(l=[],s=W();s!==H;)l.push(s),s=W();l!==H?(s=B(),s!==H?(Eo=t,o=ge(n),t=o):(So=t,t=ee)):(So=t,t=ee)}else So=t,t=ee;else So=t,t=ee}else So=t,t=ee;else So=t,t=ee;return Ro--,t===H&&(o=H,0===Ro&&a(ue)),t}function h(){var t,o,r,i;return t=So,o=So,58===e.charCodeAt(So)?(r=de,So++):(r=H,0===Ro&&a(he)),r!==H?(i=_(),i!==H?(Eo=o,r=fe(i),o=r):(So=o,o=ee)):(So=o,o=ee),o===H&&(o=te),o!==H&&(Eo=t,o=ye(o)),t=o}function f(){var t,o,r,i,n,l,s;if(Ro++,t=So,o=[],r=So,i=[],n=W(),n!==H)for(;n!==H;)i.push(n),n=W();else i=ee;for(i!==H?(n=R(),n!==H?(61===e.charCodeAt(So)?(l=ve,So++):(l=H,0===Ro&&a(Ce)),l!==H?(s=S(),s===H&&(s=_(),s===H&&(s=M())),s!==H?(Eo=r,i=Te(n,s),r=i):(So=r,r=ee)):(So=r,r=ee)):(So=r,r=ee)):(So=r,r=ee);r!==H;){if(o.push(r),r=So,i=[],n=W(),n!==H)for(;n!==H;)i.push(n),n=W();else i=ee;i!==H?(n=R(),n!==H?(61===e.charCodeAt(So)?(l=ve,So++):(l=H,0===Ro&&a(Ce)),l!==H?(s=S(),s===H&&(s=_(),s===H&&(s=M())),s!==H?(Eo=r,i=Te(n,s),r=i):(So=r,r=ee)):(So=r,r=ee)):(So=r,r=ee)):(So=r,r=ee)}return o!==H&&(Eo=t,o=_e(o)),t=o,Ro--,t===H&&(o=H,0===Ro&&a(me)),t}function y(){var t,o,r,i,n,l,s,c;for(Ro++,t=So,o=[],r=So,i=U(),i!==H?(58===e.charCodeAt(So)?(n=de,So++):(n=H,0===Ro&&a(he)),n!==H?(l=R(),l!==H?(s=B(),s!==H?(c=p(),c!==H?(Eo=r,i=Te(l,c),r=i):(So=r,r=ee)):(So=r,r=ee)):(So=r,r=ee)):(So=r,r=ee)):(So=r,r=ee);r!==H;)o.push(r),r=So,i=U(),i!==H?(58===e.charCodeAt(So)?(n=de,So++):(n=H,0===Ro&&a(he)),n!==H?(l=R(),l!==H?(s=B(),s!==H?(c=p(),c!==H?(Eo=r,i=Te(l,c),r=i):(So=r,r=ee)):(So=r,r=ee)):(So=r,r=ee)):(So=r,r=ee)):(So=r,r=ee);return o!==H&&(Eo=t,o=Ee(o)),t=o,Ro--,t===H&&(o=H,0===Ro&&a(Se)),t}function m(){var e,t,o,r,i;return Ro++,e=So,t=U(),t!==H?(o=_(),o!==H?(r=C(),r!==H?(i=B(),i!==H?(Eo=e,t=Pe(o,r),e=t):(So=e,e=ee)):(So=e,e=ee)):(So=e,e=ee)):(So=e,e=ee),Ro--,e===H&&(t=H,0===Ro&&a(xe)),e}function v(){var t,o,r,i,n,l,s,p,c,u;if(Ro++,t=So,o=U(),o!==H)if(62===e.charCodeAt(So)?(r=we,So++):(r=H,0===Ro&&a(Re)),r===H&&(43===e.charCodeAt(So)?(r=Ae,So++):(r=H,0===Ro&&a(be))),r!==H){for(i=[],n=W();n!==H;)i.push(n),n=W();if(i!==H)if(n=So,l=R(),l!==H&&(Eo=n,l=Me(l)),n=l,n===H&&(n=M()),n!==H)if(l=h(),l!==H)if(s=f(),s!==H){for(p=[],c=W();c!==H;)p.push(c),c=W();p!==H?(47===e.charCodeAt(So)?(c=ne,So++):(c=H,0===Ro&&a(ae)),c!==H?(u=B(),u!==H?(Eo=t,o=Ie(r,n,l,s),t=o):(So=t,t=ee)):(So=t,t=ee)):(So=t,t=ee)}else So=t,t=ee;else So=t,t=ee;else So=t,t=ee;else So=t,t=ee}else So=t,t=ee;else So=t,t=ee;return Ro--,t===H&&(o=H,0===Ro&&a(Le)),t}function C(){var t,o,r,i,n;for(Ro++,t=So,o=[],r=So,124===e.charCodeAt(So)?(i=Ne,So++):(i=H,0===Ro&&a(De)),i!==H?(n=R(),n!==H?(Eo=r,i=fe(n),r=i):(So=r,r=ee)):(So=r,r=ee);r!==H;)o.push(r),r=So,124===e.charCodeAt(So)?(i=Ne,So++):(i=H,0===Ro&&a(De)),i!==H?(n=R(),n!==H?(Eo=r,i=fe(n),r=i):(So=r,r=ee)):(So=r,r=ee);return o!==H&&(Eo=t,o=Fe(o)),t=o,Ro--,t===H&&(o=H,0===Ro&&a(Oe)),t}function T(){var t,o,r,i,n;return Ro++,t=So,o=U(),o!==H?(126===e.charCodeAt(So)?(r=Ge,So++):(r=H,0===Ro&&a(Ue)),r!==H?(i=R(),i!==H?(n=B(),n!==H?(Eo=t,o=Be(i),t=o):(So=t,t=ee)):(So=t,t=ee)):(So=t,t=ee)):(So=t,t=ee),Ro--,t===H&&(o=H,0===Ro&&a(ke)),t}function _(){var e,t;return Ro++,e=So,t=w(),t!==H&&(Eo=e,t=je(t)),e=t,e===H&&(e=So,t=R(),t!==H&&(Eo=e,t=$e(t)),e=t),Ro--,e===H&&(t=H,0===Ro&&a(qe)),e}function S(){var e,t;return Ro++,e=So,t=E(),t===H&&(t=L()),t!==H&&(Eo=e,t=Ve(t)),e=t,Ro--,e===H&&(t=H,0===Ro&&a(We)),e}function E(){var t,o,r,i;return Ro++,t=So,o=L(),o!==H?(46===e.charCodeAt(So)?(r=Ke,So++):(r=H,0===Ro&&a(Xe)),r!==H?(i=x(),i!==H?(Eo=t,o=He(o,i),t=o):(So=t,t=ee)):(So=t,t=ee)):(So=t,t=ee),Ro--,t===H&&(o=H,0===Ro&&a(Ye)),t}function x(){var t,o,r;if(Ro++,t=So,o=[],Ze.test(e.charAt(So))?(r=e.charAt(So),So++):(r=H,0===Ro&&a(Je)),r!==H)for(;r!==H;)o.push(r),Ze.test(e.charAt(So))?(r=e.charAt(So),So++):(r=H,0===Ro&&a(Je));else o=ee;return o!==H&&(Eo=t,o=Qe(o)),t=o,Ro--,t===H&&(o=H,0===Ro&&a(ze)),t}function P(){var t,o,r;return Ro++,t=So,45===e.charCodeAt(So)?(o=tt,So++):(o=H,0===Ro&&a(ot)),o!==H?(r=x(),r!==H?(Eo=t,o=rt(o,r),t=o):(So=t,t=ee)):(So=t,t=ee),Ro--,t===H&&(o=H,0===Ro&&a(et)),t}function L(){var e,t;return Ro++,e=P(),e===H&&(e=x()),Ro--,e===H&&(t=H,0===Ro&&a(it)),e}function w(){var t,o,r,i;if(Ro++,t=So,o=R(),o===H&&(o=te),o!==H){if(r=[],i=b(),i===H&&(i=A()),i!==H)for(;i!==H;)r.push(i),i=b(),i===H&&(i=A());else r=ee;r!==H?(Eo=t,o=at(o,r),t=o):(So=t,t=ee)}else So=t,t=ee;if(t===H)if(t=So,46===e.charCodeAt(So)?(o=Ke,So++):(o=H,0===Ro&&a(Xe)),o!==H){for(r=[],i=b(),i===H&&(i=A());i!==H;)r.push(i),i=b(),i===H&&(i=A());r!==H?(Eo=t,o=lt(r),t=o):(So=t,t=ee)}else So=t,t=ee;return Ro--,t===H&&(o=H,0===Ro&&a(nt)),t}function R(){var t,o,r,i;if(Ro++,t=So,pt.test(e.charAt(So))?(o=e.charAt(So),So++):(o=H,0===Ro&&a(ct)),o!==H){for(r=[],ut.test(e.charAt(So))?(i=e.charAt(So),So++):(i=H,0===Ro&&a(gt));i!==H;)r.push(i),ut.test(e.charAt(So))?(i=e.charAt(So),So++):(i=H,0===Ro&&a(gt));r!==H?(Eo=t,o=dt(o,r),t=o):(So=t,t=ee)}else So=t,t=ee;return Ro--,t===H&&(o=H,0===Ro&&a(st)),t}function A(){var t,o,r,i,n,l;if(Ro++,t=So,o=So,r=q(),r!==H){if(i=So,n=[],Ze.test(e.charAt(So))?(l=e.charAt(So),So++):(l=H,0===Ro&&a(Je)),l!==H)for(;l!==H;)n.push(l),Ze.test(e.charAt(So))?(l=e.charAt(So),So++):(l=H,0===Ro&&a(Je));else n=ee;n!==H&&(Eo=i,n=ft(n));i=n;i===H&&(i=_());i!==H?(n=j(),n!==H?(Eo=o,r=yt(i),o=r):(So=o,o=ee)):(So=o,o=ee)}else So=o,o=ee;return o!==H?(r=b(),r===H&&(r=te),r!==H?(Eo=t,o=mt(o,r),t=o):(So=t,t=ee)):(So=t,t=ee),Ro--,t===H&&(o=H,0===Ro&&a(ht)),t}function b(){var t,o,r,i,n;if(Ro++,t=So,o=[],r=So,46===e.charCodeAt(So)?(i=Ke,So++):(i=H,0===Ro&&a(Xe)),i!==H?(n=R(),
n!==H?(Eo=r,i=Ct(n),r=i):(So=r,r=ee)):(So=r,r=ee),r!==H)for(;r!==H;)o.push(r),r=So,46===e.charCodeAt(So)?(i=Ke,So++):(i=H,0===Ro&&a(Xe)),i!==H?(n=R(),n!==H?(Eo=r,i=Ct(n),r=i):(So=r,r=ee)):(So=r,r=ee);else o=ee;return o!==H?(r=A(),r===H&&(r=te),r!==H?(Eo=t,o=Tt(o,r),t=o):(So=t,t=ee)):(So=t,t=ee),Ro--,t===H&&(o=H,0===Ro&&a(vt)),t}function M(){var t,o,r,i;if(Ro++,t=So,34===e.charCodeAt(So)?(o=St,So++):(o=H,0===Ro&&a(Et)),o!==H?(34===e.charCodeAt(So)?(r=St,So++):(r=H,0===Ro&&a(Et)),r!==H?(Eo=t,o=xt(),t=o):(So=t,t=ee)):(So=t,t=ee),t===H&&(t=So,34===e.charCodeAt(So)?(o=St,So++):(o=H,0===Ro&&a(Et)),o!==H?(r=N(),r!==H?(34===e.charCodeAt(So)?(i=St,So++):(i=H,0===Ro&&a(Et)),i!==H?(Eo=t,o=Pt(r),t=o):(So=t,t=ee)):(So=t,t=ee)):(So=t,t=ee),t===H))if(t=So,34===e.charCodeAt(So)?(o=St,So++):(o=H,0===Ro&&a(Et)),o!==H){if(r=[],i=I(),i!==H)for(;i!==H;)r.push(i),i=I();else r=ee;r!==H?(34===e.charCodeAt(So)?(i=St,So++):(i=H,0===Ro&&a(Et)),i!==H?(Eo=t,o=Lt(r),t=o):(So=t,t=ee)):(So=t,t=ee)}else So=t,t=ee;return Ro--,t===H&&(o=H,0===Ro&&a(_t)),t}function I(){var e,t;return e=T(),e===H&&(e=m(),e===H&&(e=So,t=N(),t!==H&&(Eo=e,t=wt(t)),e=t)),e}function O(){var t,o,r,i,n,l,s,p;if(Ro++,t=So,o=$(),o!==H){for(r=[],i=W();i!==H;)r.push(i),i=W();r!==H?(Eo=t,o=At(o,r),t=o):(So=t,t=ee)}else So=t,t=ee;if(t===H){if(t=So,o=[],r=So,i=So,Ro++,n=G(),Ro--,n===H?i=re:(So=i,i=ee),i!==H?(n=So,Ro++,l=F(),Ro--,l===H?n=re:(So=n,n=ee),n!==H?(l=So,Ro++,s=k(),Ro--,s===H?l=re:(So=l,l=ee),l!==H?(s=So,Ro++,p=$(),Ro--,p===H?s=re:(So=s,s=ee),s!==H?(e.length>So?(p=e.charAt(So),So++):(p=H,0===Ro&&a(bt)),p!==H?(Eo=r,i=Mt(p),r=i):(So=r,r=ee)):(So=r,r=ee)):(So=r,r=ee)):(So=r,r=ee)):(So=r,r=ee),r!==H)for(;r!==H;)o.push(r),r=So,i=So,Ro++,n=G(),Ro--,n===H?i=re:(So=i,i=ee),i!==H?(n=So,Ro++,l=F(),Ro--,l===H?n=re:(So=n,n=ee),n!==H?(l=So,Ro++,s=k(),Ro--,s===H?l=re:(So=l,l=ee),l!==H?(s=So,Ro++,p=$(),Ro--,p===H?s=re:(So=s,s=ee),s!==H?(e.length>So?(p=e.charAt(So),So++):(p=H,0===Ro&&a(bt)),p!==H?(Eo=r,i=Mt(p),r=i):(So=r,r=ee)):(So=r,r=ee)):(So=r,r=ee)):(So=r,r=ee)):(So=r,r=ee);else o=ee;o!==H&&(Eo=t,o=It(o));t=o}return Ro--,t===H&&(o=H,0===Ro&&a(Rt)),t}function N(){var t,o,r,i,n;if(Ro++,t=So,o=[],r=So,i=So,Ro++,n=G(),Ro--,n===H?i=re:(So=i,i=ee),i!==H?(n=D(),n===H&&(Nt.test(e.charAt(So))?(n=e.charAt(So),So++):(n=H,0===Ro&&a(Dt))),n!==H?(Eo=r,i=Mt(n),r=i):(So=r,r=ee)):(So=r,r=ee),r!==H)for(;r!==H;)o.push(r),r=So,i=So,Ro++,n=G(),Ro--,n===H?i=re:(So=i,i=ee),i!==H?(n=D(),n===H&&(Nt.test(e.charAt(So))?(n=e.charAt(So),So++):(n=H,0===Ro&&a(Dt))),n!==H?(Eo=r,i=Mt(n),r=i):(So=r,r=ee)):(So=r,r=ee);else o=ee;return o!==H&&(Eo=t,o=Ft(o)),t=o,Ro--,t===H&&(o=H,0===Ro&&a(Ot)),t}function D(){var t,o;return t=So,e.substr(So,2)===kt?(o=kt,So+=2):(o=H,0===Ro&&a(Gt)),o!==H&&(Eo=t,o=Ut()),t=o}function F(){var t,o,r,i,n,l;if(Ro++,t=So,e.substr(So,2)===qt?(o=qt,So+=2):(o=H,0===Ro&&a(jt)),o!==H){for(r=[],i=So,n=So,Ro++,e.substr(So,2)===$t?(l=$t,So+=2):(l=H,0===Ro&&a(Wt)),Ro--,l===H?n=re:(So=n,n=ee),n!==H?(e.length>So?(l=e.charAt(So),So++):(l=H,0===Ro&&a(bt)),l!==H?(Eo=i,n=Vt(l),i=n):(So=i,i=ee)):(So=i,i=ee);i!==H;)r.push(i),i=So,n=So,Ro++,e.substr(So,2)===$t?(l=$t,So+=2):(l=H,0===Ro&&a(Wt)),Ro--,l===H?n=re:(So=n,n=ee),n!==H?(e.length>So?(l=e.charAt(So),So++):(l=H,0===Ro&&a(bt)),l!==H?(Eo=i,n=Vt(l),i=n):(So=i,i=ee)):(So=i,i=ee);r!==H?(e.substr(So,2)===$t?(i=$t,So+=2):(i=H,0===Ro&&a(Wt)),i!==H?(Eo=t,o=Yt(r),t=o):(So=t,t=ee)):(So=t,t=ee)}else So=t,t=ee;return Ro--,t===H&&(o=H,0===Ro&&a(Bt)),t}function k(){var t,o,r,i,n,l;if(Ro++,t=So,e.substr(So,2)===Xt?(o=Xt,So+=2):(o=H,0===Ro&&a(Ht)),o!==H){for(r=[],i=So,n=So,Ro++,e.substr(So,2)===zt?(l=zt,So+=2):(l=H,0===Ro&&a(Zt)),Ro--,l===H?n=re:(So=n,n=ee),n!==H?(e.length>So?(l=e.charAt(So),So++):(l=H,0===Ro&&a(bt)),l!==H?(Eo=i,n=Mt(l),i=n):(So=i,i=ee)):(So=i,i=ee);i!==H;)r.push(i),i=So,n=So,Ro++,e.substr(So,2)===zt?(l=zt,So+=2):(l=H,0===Ro&&a(Zt)),Ro--,l===H?n=re:(So=n,n=ee),n!==H?(e.length>So?(l=e.charAt(So),So++):(l=H,0===Ro&&a(bt)),l!==H?(Eo=i,n=Mt(l),i=n):(So=i,i=ee)):(So=i,i=ee);r!==H?(e.substr(So,2)===zt?(i=zt,So+=2):(i=H,0===Ro&&a(Zt)),i!==H?(Eo=t,o=Jt(r),t=o):(So=t,t=ee)):(So=t,t=ee)}else So=t,t=ee;return Ro--,t===H&&(o=H,0===Ro&&a(Kt)),t}function G(){var t,o,r,i,n,l,s,p,c,u;if(t=So,o=U(),o!==H){for(r=[],i=W();i!==H;)r.push(i),i=W();if(r!==H)if(Qt.test(e.charAt(So))?(i=e.charAt(So),So++):(i=H,0===Ro&&a(eo)),i!==H){for(n=[],l=W();l!==H;)n.push(l),l=W();if(n!==H){if(l=[],s=So,p=So,Ro++,c=B(),Ro--,c===H?p=re:(So=p,p=ee),p!==H?(c=So,Ro++,u=$(),Ro--,u===H?c=re:(So=c,c=ee),c!==H?(e.length>So?(u=e.charAt(So),So++):(u=H,0===Ro&&a(bt)),u!==H?(p=[p,c,u],s=p):(So=s,s=ee)):(So=s,s=ee)):(So=s,s=ee),s!==H)for(;s!==H;)l.push(s),s=So,p=So,Ro++,c=B(),Ro--,c===H?p=re:(So=p,p=ee),p!==H?(c=So,Ro++,u=$(),Ro--,u===H?c=re:(So=c,c=ee),c!==H?(e.length>So?(u=e.charAt(So),So++):(u=H,0===Ro&&a(bt)),u!==H?(p=[p,c,u],s=p):(So=s,s=ee)):(So=s,s=ee)):(So=s,s=ee);else l=ee;if(l!==H){for(s=[],p=W();p!==H;)s.push(p),p=W();s!==H?(p=B(),p!==H?(o=[o,r,i,n,l,s,p],t=o):(So=t,t=ee)):(So=t,t=ee)}else So=t,t=ee}else So=t,t=ee}else So=t,t=ee;else So=t,t=ee}else So=t,t=ee;return t===H&&(t=m()),t}function U(){var t;return 123===e.charCodeAt(So)?(t=to,So++):(t=H,0===Ro&&a(oo)),t}function B(){var t;return 125===e.charCodeAt(So)?(t=ro,So++):(t=H,0===Ro&&a(io)),t}function q(){var t;return 91===e.charCodeAt(So)?(t=no,So++):(t=H,0===Ro&&a(ao)),t}function j(){var t;return 93===e.charCodeAt(So)?(t=lo,So++):(t=H,0===Ro&&a(so)),t}function $(){var t;return 10===e.charCodeAt(So)?(t=po,So++):(t=H,0===Ro&&a(co)),t===H&&(e.substr(So,2)===uo?(t=uo,So+=2):(t=H,0===Ro&&a(go)),t===H&&(13===e.charCodeAt(So)?(t=ho,So++):(t=H,0===Ro&&a(fo)),t===H&&(8232===e.charCodeAt(So)?(t=yo,So++):(t=H,0===Ro&&a(mo)),t===H&&(8233===e.charCodeAt(So)?(t=vo,So++):(t=H,0===Ro&&a(Co)))))),t}function W(){var t;return To.test(e.charAt(So))?(t=e.charAt(So),So++):(t=H,0===Ro&&a(_o)),t===H&&(t=$()),t}function V(e){return parseInt(e.join(""),10)}function Y(e){return e.concat([["line",o()],["col",r()]])}var K,X=arguments.length>1?arguments[1]:{},H={},z={start:s},Z=s,J=function(e){var t=["body"].concat(e);return Y(t)},Q={type:"other",description:"section"},ee=H,te=null,oe=function(e,t,o,r){return r&&e[1].text===r.text||i("Expected end tag for "+e[1].text+" but it was not found."),!0},re=void 0,ie=function(e,t,o){return o.push(["param",["literal","block"],t]),e.push(o),Y(e)},ne="/",ae={type:"literal",value:"/",description:'"/"'},le=function(e){return e.push(["bodies"]),Y(e)},se=/^[#?\^<+@%]/,pe={type:"class",value:"[#?\\^<+@%]",description:"[#?\\^<+@%]"},ce=function(e,t,o,r){return[e,t,o,r]},ue={type:"other",description:"end tag"},ge=function(e){return e},de=":",he={type:"literal",value:":",description:'":"'},fe=function(e){return e},ye=function(e){return e?["context",e]:["context"]},me={type:"other",description:"params"},ve="=",Ce={type:"literal",value:"=",description:'"="'},Te=function(e,t){return["param",["literal",e],t]},_e=function(e){return["params"].concat(e)},Se={type:"other",description:"bodies"},Ee=function(e){return["bodies"].concat(e)},xe={type:"other",description:"reference"},Pe=function(e,t){return Y(["reference",e,t])},Le={type:"other",description:"partial"},we=">",Re={type:"literal",value:">",description:'">"'},Ae="+",be={type:"literal",value:"+",description:'"+"'},Me=function(e){return["literal",e]},Ie=function(e,t,o,r){var i=">"===e?"partial":e;return Y([i,t,o,r])},Oe={type:"other",description:"filters"},Ne="|",De={type:"literal",value:"|",description:'"|"'},Fe=function(e){return["filters"].concat(e)},ke={type:"other",description:"special"},Ge="~",Ue={type:"literal",value:"~",description:'"~"'},Be=function(e){return Y(["special",e])},qe={type:"other",description:"identifier"},je=function(e){var t=["path"].concat(e);return t.text=e[1].join(".").replace(/,line,\d+,col,\d+/g,""),t},$e=function(e){var t=["key",e];return t.text=e,t},We={type:"other",description:"number"},Ve=function(e){return["literal",e]},Ye={type:"other",description:"float"},Ke=".",Xe={type:"literal",value:".",description:'"."'},He=function(e,t){return parseFloat(e+"."+t)},ze={type:"other",description:"unsigned_integer"},Ze=/^[0-9]/,Je={type:"class",value:"[0-9]",description:"[0-9]"},Qe=function(e){return V(e)},et={type:"other",description:"signed_integer"},tt="-",ot={type:"literal",value:"-",description:'"-"'},rt=function(e,t){return-1*t},it={type:"other",description:"integer"},nt={type:"other",description:"path"},at=function(e,t){return t=t[0],e&&t?(t.unshift(e),Y([!1,t])):Y([!0,t])},lt=function(e){return Y(e.length>0?[!0,e[0]]:[!0,[]])},st={type:"other",description:"key"},pt=/^[a-zA-Z_$]/,ct={type:"class",value:"[a-zA-Z_$]",description:"[a-zA-Z_$]"},ut=/^[0-9a-zA-Z_$\-]/,gt={type:"class",value:"[0-9a-zA-Z_$\\-]",description:"[0-9a-zA-Z_$\\-]"},dt=function(e,t){return e+t.join("")},ht={type:"other",description:"array"},ft=function(e){return e.join("")},yt=function(e){return e},mt=function(e,t){return t?t.unshift(e):t=[e],t},vt={type:"other",description:"array_part"},Ct=function(e){return e},Tt=function(e,t){return t?e.concat(t):e},_t={type:"other",description:"inline"},St='"',Et={type:"literal",value:'"',description:'"\\""'},xt=function(){return Y(["literal",""])},Pt=function(e){return Y(["literal",e])},Lt=function(e){return Y(["body"].concat(e))},wt=function(e){return["buffer",e]},Rt={type:"other",description:"buffer"},At=function(e,t){return Y(["format",e,t.join("")])},bt={type:"any",description:"any character"},Mt=function(e){return e},It=function(e){return Y(["buffer",e.join("")])},Ot={type:"other",description:"literal"},Nt=/^[^"]/,Dt={type:"class",value:'[^"]',description:'[^"]'},Ft=function(e){return e.join("")},kt='\\"',Gt={type:"literal",value:'\\"',description:'"\\\\\\""'},Ut=function(){return'"'},Bt={type:"other",description:"raw"},qt="{`",jt={type:"literal",value:"{`",description:'"{`"'},$t="`}",Wt={type:"literal",value:"`}",description:'"`}"'},Vt=function(e){return e},Yt=function(e){return Y(["raw",e.join("")])},Kt={type:"other",description:"comment"},Xt="{!",Ht={type:"literal",value:"{!",description:'"{!"'},zt="!}",Zt={type:"literal",value:"!}",description:'"!}"'},Jt=function(e){return Y(["comment",e.join("")])},Qt=/^[#?\^><+%:@\/~%]/,eo={type:"class",value:"[#?\\^><+%:@\\/~%]",description:"[#?\\^><+%:@\\/~%]"},to="{",oo={type:"literal",value:"{",description:'"{"'},ro="}",io={type:"literal",value:"}",description:'"}"'},no="[",ao={type:"literal",value:"[",description:'"["'},lo="]",so={type:"literal",value:"]",description:'"]"'},po="\n",co={type:"literal",value:"\n",description:'"\\n"'},uo="\r\n",go={type:"literal",value:"\r\n",description:'"\\r\\n"'},ho="\r",fo={type:"literal",value:"\r",description:'"\\r"'},yo="\u2028",mo={type:"literal",value:"\u2028",description:'"\\u2028"'},vo="\u2029",Co={type:"literal",value:"\u2029",description:'"\\u2029"'},To=/^[\t\x0B\f \xA0\uFEFF]/,_o={type:"class",value:"[\\t\\x0B\\f \\xA0\\uFEFF]",description:"[\\t\\x0B\\f \\xA0\\uFEFF]"},So=0,Eo=0,xo=0,Po={line:1,column:1,seenCR:!1},Lo=0,wo=[],Ro=0;if("startRule"in X){if(!(X.startRule in z))throw new Error("Can't start parsing from rule \""+X.startRule+'".');Z=z[X.startRule]}if(K=Z(),K!==H&&So===e.length)return K;throw K!==H&&So<e.length&&a({type:"end",description:"end of input"}),l(null,wo,Lo)}return e(t,Error),{SyntaxError:t,parse:o}}();return e.parse=t.parse,t}),function(e,t){"function"==typeof define&&define.amd&&define.amd.dust===!0?define("dust.compile",["dust.core","dust.parse"],function(e,o){return t(o,e).compile}):"object"==typeof exports?module.exports=t(require("./parser").parse,require("./dust")):t(e.dust.parse,e.dust)}(this,function(e,t){function o(e){return C.filterNode({},e)}function r(e,t){for(var o,r=[t[0]],i=1,n=t.length;n>i;i++)o=C.filterNode(e,t[i]),o&&r.push(o);return r}function i(e,t){for(var o,r,i=[t[0]],n=1,a=t.length;a>n;n++)r=C.filterNode(e,t[n]),r&&("buffer"===r[0]||"format"===r[0]?o?(o[0]="buffer"===r[0]?"buffer":o[0],o[1]+=r.slice(1,-2).join("")):(o=r,i.push(r)):(o=null,i.push(r)));return i}function n(e,t){return["buffer",v[t[1]],t[2],t[3]]}function a(e,t){return t}function l(){}function s(e,o){return t.config.whitespace?(o.splice(1,2,o.slice(1,-2).join("")),o):null}function p(e,o){var r,i={name:o,bodies:[],blocks:{},index:0,auto:"h"},n=t.escapeJs(o),a=o?'"'+n+'",':"",l="function(dust){",s=C.compileNode(i,e);return o&&(l+='dust.register("'+n+'",'+s+");"),l+=c(i)+u(i)+"return "+s+"}",r="("+l+"(dust));",t.config.amd?"define("+a+'["dust.core"],'+l+");":t.config.cjs?"module.exports=function(dust){var tmpl="+r+"var f="+m().toString()+";f.template=tmpl;return f}":r}function c(e){var t,o=[],r=e.blocks;for(t in r)o.push('"'+t+'":'+r[t]);return o.length?(e.blocks="ctx=ctx.shiftBlocks(blocks);","var blocks={"+o.join(",")+"};"):(e.blocks="",e.blocks)}function u(e){for(var t=[],o=e.bodies,r=e.blocks,i=0,n=o.length;n>i;i++)t[i]="function body_"+i+"(chk,ctx){"+r+"return chk"+o[i]+";}body_"+i+".__dustBody=!0;";return t.join("")}function g(e,t){for(var o="",r=1,i=t.length;i>r;r++)o+=C.compileNode(e,t[r]);return o}function d(e,o,r){return"."+(t._aliases[r]||r)+"("+C.compileNode(e,o[1])+","+C.compileNode(e,o[2])+","+C.compileNode(e,o[4])+","+C.compileNode(e,o[3])+")"}function h(e){return e.replace(_,"\\\\").replace(S,'\\"').replace(E,"\\f").replace(x,"\\n").replace(P,"\\r").replace(L,"\\t")}function f(e,o,r){var i=t.loadSource(t.compile(e));return m(i)(o,r)}function y(e,o){var r=t.loadSource(t.compile(e,o));return m(r)}function m(e){return function(o,r){var i=r?"render":"stream";return t[i](e,o,r)}}var v,C={},T=t.isArray;C.compile=function(t,r){try{var i=o(e(t));return p(i,r)}catch(n){if(!n.line||!n.column)throw n;throw new SyntaxError(n.message+" At line : "+n.line+", column : "+n.column)}};C.filterNode=function(e,t){return C.optimizers[t[0]](e,t)};C.optimizers={body:i,buffer:a,special:n,format:s,reference:r,"#":r,"?":r,"^":r,"<":r,"+":r,"@":r,"%":r,partial:r,context:r,params:r,bodies:r,param:r,filters:a,key:a,path:a,literal:a,raw:a,comment:l,line:l,col:l};C.pragmas={esc:function(e,t,o){var r,i=e.auto;return t||(t="h"),e.auto="s"===t?"":t,r=g(e,o.block),e.auto=i,r}};v={s:" ",n:"\n",r:"\r",lb:"{",rb:"}"};C.compileNode=function(e,t){return C.nodes[t[0]](e,t)};C.nodes={body:function(e,t){var o=e.index++,r="body_"+o;return e.bodies[o]=g(e,t),r},buffer:function(e,t){return".w("+w(t[1])+")"},format:function(e,t){return".w("+w(t[1])+")"},reference:function(e,t){return".f("+C.compileNode(e,t[1])+",ctx,"+C.compileNode(e,t[2])+")"},"#":function(e,t){return d(e,t,"section")},"?":function(e,t){return d(e,t,"exists")},"^":function(e,t){return d(e,t,"notexists")},"<":function(e,t){for(var o,r,i=t[4],n=1,a=i.length;a>n;n++)if(o=i[n],r=o[1][1],"block"===r)return e.blocks[t[1].text]=C.compileNode(e,o[2]),"";return""},"+":function(e,t){return"undefined"==typeof t[1].text&&"undefined"==typeof t[4]?".b(ctx.getBlock("+C.compileNode(e,t[1])+",chk, ctx),"+C.compileNode(e,t[2])+", {},"+C.compileNode(e,t[3])+")":".b(ctx.getBlock("+w(t[1].text)+"),"+C.compileNode(e,t[2])+","+C.compileNode(e,t[4])+","+C.compileNode(e,t[3])+")"},"@":function(e,t){return".h("+w(t[1].text)+","+C.compileNode(e,t[2])+","+C.compileNode(e,t[4])+","+C.compileNode(e,t[3])+")"},"%":function(e,t){var o,r,i,n,a,l,s,p,c,u=t[1][1];if(!C.pragmas[u])return"";for(o=t[4],r={},p=1,c=o.length;c>p;p++)l=o[p],r[l[1][1]]=l[2];for(i=t[3],n={},p=1,c=i.length;c>p;p++)s=i[p],n[s[1][1]]=s[2][1];return a=t[2][1]?t[2][1].text:null,C.pragmas[u](e,a,r,n)},partial:function(e,t){return".p("+C.compileNode(e,t[1])+",ctx,"+C.compileNode(e,t[2])+","+C.compileNode(e,t[3])+")"},context:function(e,t){return t[1]?"ctx.rebase("+C.compileNode(e,t[1])+")":"ctx"},params:function(e,t){for(var o=[],r=1,i=t.length;i>r;r++)o.push(C.compileNode(e,t[r]));return o.length?"{"+o.join(",")+"}":"{}"},bodies:function(e,t){for(var o=[],r=1,i=t.length;i>r;r++)o.push(C.compileNode(e,t[r]));return"{"+o.join(",")+"}"},param:function(e,t){return C.compileNode(e,t[1])+":"+C.compileNode(e,t[2])},filters:function(e,t){for(var o,r=[],i=1,n=t.length;n>i;i++)o=t[i],r.push('"'+o+'"');return'"'+e.auto+'"'+(r.length?",["+r.join(",")+"]":"")},key:function(e,t){return'ctx.get(["'+t[1]+'"], false)'},path:function(e,t){for(var o=t[1],r=t[2],i=[],n=0,a=r.length;a>n;n++)i.push(T(r[n])?C.compileNode(e,r[n]):'"'+r[n]+'"');return"ctx.getPath("+o+", ["+i.join(",")+"])"},literal:function(e,t){return w(t[1])},raw:function(e,t){return".w("+w(t[1])+")"}};var _=/\\/g,S=/"/g,E=/\f/g,x=/\n/g,P=/\r/g,L=/\t/g,w="undefined"==typeof JSON?function(e){return'"'+h(e)+'"'}:JSON.stringify;return t.compiler=C,t.compile=t.compiler.compile,t.renderSource=f,t.compileFn=y,t.filterNode=C.filterNode,t.optimizers=C.optimizers,t.pragmas=C.pragmas,t.compileNode=C.compileNode,t.nodes=C.nodes,C});"function"==typeof define&&define.amd&&define.amd.dust===!0&&define(["require","dust.core","dust.compile"],function(e,t){return t.onLoad=function(t,o){e([t],function(){o()})},t});!function(e,t){"function"==typeof define&&define.amd&&define.amd.dust===!0?define(["dust.core"],t):"object"==typeof exports?module.exports=t(require("dustjs-linkedin")):t(e.dust)}(this,function(e){function t(t,o,r){r=r||"INFO";t=t?"{@"+t+"}: ":"";e.log(t+o,r)}function o(e){u[e]||(t(e,"Deprecation warning: "+e+" is deprecated and will be removed in a future version of dustjs-helpers","WARN"),t(null,"For help and a deprecation timeline, see https://github.com/linkedin/dustjs-helpers/wiki/Deprecated-Features#"+e.replace(/\W+/g,""),"WARN"),u[e]=!0)}function r(e){return e.stack.tail&&e.stack.tail.head&&"undefined"!=typeof e.stack.tail.head.__select__}function i(e){return r(e)&&e.get("__select__")}function n(e,t){var o,r,i=e.stack.head,n=e.rebase();e.stack&&e.stack.tail&&(n.stack=e.stack.tail);r={isPending:!1,isResolved:!1,isDeferredComplete:!1,deferreds:[]};for(o in t)r[o]=t[o];return n.push({__select__:r}).push(i,e.stack.index,e.stack.of)}function a(e){var t,o;if(e.isDeferredPending=!0,e.deferreds.length)for(e.isDeferredComplete=!0,t=0,o=e.deferreds.length;o>t;t++)e.deferreds[t]();e.isDeferredPending=!1}function l(e,t){return"function"==typeof t?t.toString().replace(/(^\s+|\s+$)/gm,"").replace(/\n/gm,"").replace(/,\s*/gm,", ").replace(/\)\{/gm,") {"):t}function s(e,t){return function(o,r,i,n){return p(o,r,i,n,e,t)}}function p(e,o,r,n,a,l){var s,p,u,g,d=r.block,h=r["else"],f=i(o)||{};if(f.isResolved&&!f.isDeferredPending)return e;if(n.hasOwnProperty("key"))p=n.key;else{if(!f.hasOwnProperty("key"))return t(a,"No key specified","WARN"),e;p=f.key}return g=n.type||f.type,p=c(o.resolve(p),g),u=c(o.resolve(n.value),g),l(p,u)?(f.isPending||(s=!0,f.isPending=!0),d&&(e=e.render(d,o)),s&&(f.isResolved=!0)):h&&(e=e.render(h,o)),e}function c(e,t){t&&(t=t.toLowerCase());switch(t){case"number":return+e;case"string":return String(e);case"boolean":return e="false"===e?!1:e,Boolean(e);case"date":return new Date(e)}return e}var u={},g={tap:function(e,t,r){return o("tap"),r.resolve(e)},sep:function(e,t,o){var r=o.block;return t.stack.index===t.stack.of-1?e:r?r(e,t):e},first:function(e,t,o){return 0===t.stack.index?o.block(e,t):e},last:function(e,t,o){return t.stack.index===t.stack.of-1?o.block(e,t):e},contextDump:function(e,o,r,i){var n,a,s=o.resolve(i.to),p=o.resolve(i.key);switch(p){case"full":n=o.stack;break;default:n=o.stack.head}a=JSON.stringify(n,l,2);switch(s){case"console":t("contextDump",a);break;default:a=a.replace(/</g,"\\u003c");e=e.write(a)}return e},math:function(e,o,r,l){var s,p=l.key,c=l.method,u=l.operand,g=l.round;if(!l.hasOwnProperty("key")||!l.method)return t("math","`key` or `method` was not provided","ERROR"),e;p=parseFloat(o.resolve(p));u=parseFloat(o.resolve(u));switch(c){case"mod":0===u&&t("math","Division by 0","ERROR");s=p%u;break;case"add":s=p+u;break;case"subtract":s=p-u;break;case"multiply":s=p*u;break;case"divide":0===u&&t("math","Division by 0","ERROR");s=p/u;break;case"ceil":case"floor":case"round":case"abs":s=Math[c](p);break;case"toint":s=parseInt(p,10);break;default:t("math","Method `"+c+"` is not supported","ERROR")}return"undefined"!=typeof s&&(g&&(s=Math.round(s)),r&&r.block?(o=n(o,{key:s}),e=e.render(r.block,o),a(i(o))):e=e.write(s)),e},select:function(e,o,r,l){var s=r.block,p={};return l.hasOwnProperty("key")&&(p.key=o.resolve(l.key)),l.hasOwnProperty("type")&&(p.type=l.type),s?(o=n(o,p),e=e.render(s,o),a(i(o))):t("select","Missing body block","WARN"),e},eq:s("eq",function(e,t){return e===t}),ne:s("ne",function(e,t){return e!==t}),lt:s("lt",function(e,t){return t>e}),lte:s("lte",function(e,t){return t>=e}),gt:s("gt",function(e,t){return e>t}),gte:s("gte",function(e,t){return e>=t}),any:function(e,o,r){var n=i(o);return n?n.isDeferredComplete?t("any","Must not be nested inside {@any} or {@none} block","ERROR"):e=e.map(function(e){n.deferreds.push(function(){n.isResolved&&(e=e.render(r.block,o));e.end()})}):t("any","Must be used inside a {@select} block","ERROR"),e},none:function(e,o,r){var n=i(o);return n?n.isDeferredComplete?t("none","Must not be nested inside {@any} or {@none} block","ERROR"):e=e.map(function(e){n.deferreds.push(function(){n.isResolved||(e=e.render(r.block,o));e.end()})}):t("none","Must be used inside a {@select} block","ERROR"),e},size:function(t,o,r,i){var n,a,l=i.key;if(l=o.resolve(i.key),l&&l!==!0)if(e.isArray(l))n=l.length;else if(!isNaN(parseFloat(l))&&isFinite(l))n=l;else if("object"==typeof l){n=0;for(a in l)l.hasOwnProperty(a)&&n++}else n=(l+"").length;else n=0;return t.write(n)}};for(var d in g)e.helpers[d]=g[d];return e});!function(e,t){"function"==typeof define&&define.amd?define(["dustjs-linkedin"],function(o){return t(o,e)}):"object"==typeof module&&module.exports?module.exports=t(require("dustjs-linkedin"),this):e.dust=t(e.dust,e)}(this,function(e,t,o){"use strict";var r=Object.prototype.toString,i=typeof console!==o?console:{log:function(){}},n={isArray:Array.isArray||function(e){return"[object Array]"===r.call(e)},isAvailable:function(e){return l[e]!==o},log:i.log},a={selected:o,languages:{},filters:{}},l=a.languages;return typeof String.prototype.trim===o&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),e.i18n={resetContext:function(){a.selected=o,Object.keys(l).forEach(function(e){delete l[e]})},setLanguage:function(e){if(!n.isAvailable(e))throw new Error("language '"+e+"' not available!");a.selected=e},setLanguages:function(e){n.isArray(e)&&e.forEach(function(e){n.isAvailable(e)||(l[e]={}),a.selected===o&&(a.selected=e)})},add:function(e,t){if(n.isAvailable(e)){var o=l[e];Object.keys(t).forEach(function(e){o[e]=t[e]})}},addFilter:function(e,t){e in a.filters||(a.filters[e]=t)}},e.helpers.i18n=function(t,r,i,s){if(s&&s.$key!==o){var p,c,u,g,d,h=a.selected,f=l[h],y=/\{(\s*[\w]+\s*)\}/g;g=e.helpers.tap(s.$key,t,r).split("|");var m=e.helpers.tap(g.shift(),t,r);for(d=f!==o&&f[m]!==o?f[m]:null;null!==(p=y.exec(d));)u=p[1].trim(),"$key"===u?(c="",n.log("$key can't be used as a parameter")):c=e.helpers.tap(s[p[1].trim()],t,r),d=d.replace(p[0],c);g.forEach(function(e){e in a.filters&&(d=a.filters[e](d))}),t.write(d)}else n.log("No key given in the i18n helper");return t},e});!function(){dust.helpers.iterate=function(e,t,o,r){r=r||{};var i=r.on||t.current(),n=null!=r.excludedKeys?r.excludedKeys.split(","):null;for(var a in i)(null==n||n.indexOf(a)<0)&&(e=e.render(o.block,t.push({key:a,value:i[a]})));return e}}();!function(){var e,t,o,r;!function(){var i={},n={};e=function(e,t,o){i[e]={deps:t,callback:o}},r=o=t=function(e){function o(t){if("."!==t.charAt(0))return t;for(var o=t.split("/"),r=e.split("/").slice(0,-1),i=0,n=o.length;n>i;i++){var a=o[i];if(".."===a)r.pop();else{if("."===a)continue;r.push(a)}}return r.join("/")}if(r._eak_seen=i,n[e])return n[e];if(n[e]={},!i[e])throw new Error("Could not find module "+e);for(var a,l=i[e],s=l.deps,p=l.callback,c=[],u=0,g=s.length;g>u;u++)c.push("exports"===s[u]?a={}:t(o(s[u])));var d=p.apply(this,c);return n[e]=a||d}}(),e("promise/all",["./utils","exports"],function(e,t){"use strict";function o(e){var t=this;if(!r(e))throw new TypeError("You must pass an array to all.");return new t(function(t,o){function r(e){return function(t){n(e,t)}}function n(e,o){l[e]=o,0===--s&&t(l)}var a,l=[],s=e.length;0===s&&t([]);for(var p=0;p<e.length;p++)a=e[p],a&&i(a.then)?a.then(r(p),o):n(p,a)})}var r=e.isArray,i=e.isFunction;t.all=o}),e("promise/asap",["exports"],function(e){"use strict";function t(){return function(){process.nextTick(i)}}function o(){var e=0,t=new s(i),o=document.createTextNode("");return t.observe(o,{characterData:!0}),function(){o.data=e=++e%2}}function r(){return function(){p.setTimeout(i,1)}}function i(){for(var e=0;e<c.length;e++){var t=c[e],o=t[0],r=t[1];o(r)}c=[]}function n(e,t){var o=c.push([e,t]);1===o&&a()}var a,l="undefined"!=typeof window?window:{},s=l.MutationObserver||l.WebKitMutationObserver,p="undefined"!=typeof global?global:void 0===this?window:this,c=[];a="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?t():s?o():r(),e.asap=n}),e("promise/config",["exports"],function(e){"use strict";function t(e,t){return 2!==arguments.length?o[e]:void(o[e]=t)}var o={instrument:!1};e.config=o,e.configure=t}),e("promise/polyfill",["./promise","./utils","exports"],function(e,t,o){"use strict";function r(){var e;e="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;var t="Promise"in e&&"resolve"in e.Promise&&"reject"in e.Promise&&"all"in e.Promise&&"race"in e.Promise&&function(){var t;return new e.Promise(function(e){t=e}),n(t)}();t||(e.Promise=i)}var i=e.Promise,n=t.isFunction;o.polyfill=r}),e("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(e,t,o,r,i,n,a,l){"use strict";function s(e){if(!_(e))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof s))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],p(e,this)}function p(e,t){function o(e){h(t,e)}function r(e){y(t,e)}try{e(o,r)}catch(i){r(i)}}function c(e,t,o,r){var i,n,a,l,s=_(o);if(s)try{i=o(r),a=!0}catch(p){l=!0,n=p}else i=r,a=!0;d(t,i)||(s&&a?h(t,i):l?y(t,n):e===A?h(t,i):e===b&&y(t,i))}function u(e,t,o,r){var i=e._subscribers,n=i.length;i[n]=t,i[n+A]=o,i[n+b]=r}function g(e,t){for(var o,r,i=e._subscribers,n=e._detail,a=0;a<i.length;a+=3)o=i[a],r=i[a+t],c(t,o,r,n);e._subscribers=null}function d(e,t){var o,r=null;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(T(t)&&(r=t.then,_(r)))return r.call(t,function(r){return o?!0:(o=!0,void(t!==r?h(e,r):f(e,r)))},function(t){return o?!0:(o=!0,void y(e,t))}),!0}catch(i){return o?!0:(y(e,i),!0)}return!1}function h(e,t){e===t?f(e,t):d(e,t)||f(e,t)}function f(e,t){e._state===w&&(e._state=R,e._detail=t,C.async(m,e))}function y(e,t){e._state===w&&(e._state=R,e._detail=t,C.async(v,e))}function m(e){g(e,e._state=A)}function v(e){g(e,e._state=b)}var C=e.config,T=(e.configure,t.objectOrFunction),_=t.isFunction,S=(t.now,o.all),E=r.race,x=i.resolve,P=n.reject,L=a.asap;C.async=L;var w=void 0,R=0,A=1,b=2;s.prototype={constructor:s,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(e,t){var o=this,r=new this.constructor(function(){});if(this._state){var i=arguments;C.async(function(){c(o._state,r,i[o._state-1],o._detail)})}else u(this,r,e,t);return r},"catch":function(e){return this.then(null,e)}},s.all=S,s.race=E,s.resolve=x,s.reject=P,l.Promise=s}),e("promise/race",["./utils","exports"],function(e,t){"use strict";function o(e){var t=this;if(!r(e))throw new TypeError("You must pass an array to race.");return new t(function(t,o){for(var r,i=0;i<e.length;i++)r=e[i],r&&"function"==typeof r.then?r.then(t,o):t(r)})}var r=e.isArray;t.race=o}),e("promise/reject",["exports"],function(e){"use strict";function t(e){var t=this;return new t(function(t,o){o(e)})}e.reject=t}),e("promise/resolve",["exports"],function(e){"use strict";function t(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=this;return new t(function(t){t(e)})}e.resolve=t}),e("promise/utils",["exports"],function(e){"use strict";function t(e){return o(e)||"object"==typeof e&&null!==e}function o(e){return"function"==typeof e}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}var i=Date.now||function(){return(new Date).getTime()};e.objectOrFunction=t,e.isFunction=o,e.isArray=r,e.now=i}),t("promise/polyfill").polyfill()}(),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.localforage=t():e.localforage=t()}(this,function(){return function(e){function t(r){if(o[r])return o[r].exports;var i=o[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(e){function t(e,t){e[t]=function(){var o=arguments;return e.ready().then(function(){return e[t].apply(e,o)})}}function i(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var o in t)t.hasOwnProperty(o)&&(arguments[0][o]=g(t[o])?t[o].slice():t[o])}return arguments[0]}function n(e){for(var t in l)if(l.hasOwnProperty(t)&&l[t]===e)return!0;return!1}var a={},l={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},s=[l.INDEXEDDB,l.WEBSQL,l.LOCALSTORAGE],p=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],c={description:"",driver:s.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},u=function(e){var t={};return t[l.INDEXEDDB]=!!function(){try{var t=t||e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.OIndexedDB||e.msIndexedDB;return"undefined"!=typeof e.openDatabase&&e.navigator&&e.navigator.userAgent&&/Safari/.test(e.navigator.userAgent)&&!/Chrome/.test(e.navigator.userAgent)?!1:t&&"function"==typeof t.open&&"undefined"!=typeof e.IDBKeyRange}catch(o){return!1}}(),t[l.WEBSQL]=!!function(){try{return e.openDatabase}catch(t){return!1}}(),t[l.LOCALSTORAGE]=!!function(){try{return e.localStorage&&"setItem"in e.localStorage&&e.localStorage.setItem}catch(t){return!1}}(),t}(e),g=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},d=function(){function e(t){r(this,e),this.INDEXEDDB=l.INDEXEDDB,this.LOCALSTORAGE=l.LOCALSTORAGE,this.WEBSQL=l.WEBSQL,this._defaultConfig=i({},c),this._config=i({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)}return e.prototype.config=function(e){if("object"==typeof e){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e)"storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),this._config[t]=e[t];return"driver"in e&&e.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,o){var r=new Promise(function(t,o){try{var r=e._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),l=new Error("Custom driver name already in use: "+e._driver);if(!e._driver)return void o(i);if(n(e._driver))return void o(l);for(var s=p.concat("_initStorage"),c=0;c<s.length;c++){var g=s[c];if(!g||!e[g]||"function"!=typeof e[g])return void o(i)}var d=Promise.resolve(!0);"_support"in e&&(d=e._support&&"function"==typeof e._support?e._support():Promise.resolve(!!e._support)),d.then(function(o){u[r]=o,a[r]=e,t()},o)}catch(h){o(h)}});return r.then(t,o),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,r){var i=this,l=function(){if(n(e))switch(e){case i.INDEXEDDB:return new Promise(function(e,t){e(o(1))});case i.LOCALSTORAGE:return new Promise(function(e,t){
e(o(2))});case i.WEBSQL:return new Promise(function(e,t){e(o(4))})}else if(a[e])return Promise.resolve(a[e]);return Promise.reject(new Error("Driver not found."))}();return l.then(t,r),l},e.prototype.getSerializer=function(e){var t=new Promise(function(e,t){e(o(3))});return e&&"function"==typeof e&&t.then(function(t){e(t)}),t},e.prototype.ready=function(e){var t=this,o=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return o.then(e,e),o},e.prototype.setDriver=function(e,t,o){function r(){n._config.driver=n.driver()}function i(e){return function(){function t(){for(;o<e.length;){var i=e[o];return o++,n._dbInfo=null,n._ready=null,n.getDriver(i).then(function(e){return n._extend(e),r(),n._ready=n._initStorage(n._config),n._ready})["catch"](t)}r();var a=new Error("No available storage method found.");return n._driverSet=Promise.reject(a),n._driverSet}var o=0;return t()}}var n=this;g(e)||(e=[e]);var a=this._getSupportedDrivers(e),l=null!==this._driverSet?this._driverSet["catch"](function(){return Promise.resolve()}):Promise.resolve();return this._driverSet=l.then(function(){var e=a[0];return n._dbInfo=null,n._ready=null,n.getDriver(e).then(function(e){n._driver=e._driver,r(),n._wrapLibraryMethodsWithReady(),n._initDriver=i(a)})})["catch"](function(){r();var e=new Error("No available storage method found.");return n._driverSet=Promise.reject(e),n._driverSet}),this._driverSet.then(t,o),this._driverSet},e.prototype.supports=function(e){return!!u[e]},e.prototype._extend=function(e){i(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],o=0,r=e.length;r>o;o++){var i=e[o];this.supports(i)&&t.push(i)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0;e<p.length;e++)t(this,p[e])},e.prototype.createInstance=function(t){return new e(t)},e}();return new d}("undefined"!=typeof window?window:self);t["default"]=i,e.exports=t["default"]},function(e,t){"use strict";t.__esModule=!0;var o=function(e){function t(t,o){t=t||[],o=o||{};try{return new Blob(t,o)}catch(r){if("TypeError"!==r.name)throw r;for(var i=e.BlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder||e.WebKitBlobBuilder,n=new i,a=0;a<t.length;a+=1)n.append(t[a]);return n.getBlob(o.type)}}function o(e){for(var t=e.length,o=new ArrayBuffer(t),r=new Uint8Array(o),i=0;t>i;i++)r[i]=e.charCodeAt(i);return o}function r(e){return new Promise(function(t,o){var r=new XMLHttpRequest;r.open("GET",e),r.withCredentials=!0,r.responseType="arraybuffer",r.onreadystatechange=function(){return 4===r.readyState?200===r.status?t({response:r.response,type:r.getResponseHeader("Content-Type")}):void o({status:r.status,response:r.response}):void 0},r.send()})}function i(e){return new Promise(function(o,i){var n=t([""],{type:"image/png"}),a=e.transaction([A],"readwrite");a.objectStore(A).put(n,"key"),a.oncomplete=function(){var t=e.transaction([A],"readwrite"),n=t.objectStore(A).get("key");n.onerror=i,n.onsuccess=function(e){var t=e.target.result,i=URL.createObjectURL(t);r(i).then(function(e){o(!(!e||"image/png"!==e.type))},function(){o(!1)}).then(function(){URL.revokeObjectURL(i)})}},a.onerror=a.onabort=i})["catch"](function(){return!1})}function n(e){return"boolean"==typeof w?Promise.resolve(w):i(e).then(function(e){return w=e})}function a(e){return new Promise(function(t,o){var r=new FileReader;r.onerror=o,r.onloadend=function(o){var r=btoa(o.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)})}function l(e){var r=o(atob(e.data));return t([r],{type:e.type})}function s(e){return e&&e.__local_forage_encoded_blob}function p(e){var t=this,o=t._initReady().then(function(){var e=R[t._dbInfo.name];return e&&e.dbReady?e.dbReady:void 0});return o.then(e,e),o}function c(e){var t=R[e.name],o={};o.promise=new Promise(function(e){o.resolve=e}),t.deferredOperations.push(o),t.dbReady=t.dbReady?t.dbReady.then(function(){return o.promise}):o.promise}function u(e){var t=R[e.name],o=t.deferredOperations.pop();o&&o.resolve()}function g(e){function t(){return Promise.resolve()}var o=this,r={db:null};if(e)for(var i in e)r[i]=e[i];R||(R={});var n=R[r.name];n||(n={forages:[],db:null,dbReady:null,deferredOperations:[]},R[r.name]=n),n.forages.push(o),o._initReady||(o._initReady=o.ready,o.ready=p);for(var a=[],l=0;l<n.forages.length;l++){var s=n.forages[l];s!==o&&a.push(s._initReady()["catch"](t))}var c=n.forages.slice(0);return Promise.all(a).then(function(){return r.db=n.db,d(r)}).then(function(e){return r.db=e,y(r,o._defaultConfig.version)?h(r):e}).then(function(e){r.db=n.db=e,o._dbInfo=r;for(var t=0;t<c.length;t++){var i=c[t];i!==o&&(i._dbInfo.db=r.db,i._dbInfo.version=r.version)}})}function d(e){return f(e,!1)}function h(e){return f(e,!0)}function f(t,o){return new Promise(function(r,i){if(t.db){if(!o)return r(t.db);c(t),t.db.close()}var n=[t.name];o&&n.push(t.version);var a=L.open.apply(L,n);o&&(a.onupgradeneeded=function(o){var r=a.result;try{r.createObjectStore(t.storeName),o.oldVersion<=1&&r.createObjectStore(A)}catch(i){if("ConstraintError"!==i.name)throw i;e.console.warn('The database "'+t.name+'" has been upgraded from version '+o.oldVersion+" to version "+o.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),a.onerror=function(){i(a.error)},a.onsuccess=function(){r(a.result),u(t)}})}function y(t,o){if(!t.db)return!0;var r=!t.db.objectStoreNames.contains(t.storeName),i=t.version<t.db.version,n=t.version>t.db.version;if(i&&(t.version!==o&&e.console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),n||r){if(r){var a=t.db.version+1;a>t.version&&(t.version=a)}return!0}return!1}function m(t,o){var r=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var i=new Promise(function(e,o){r.ready().then(function(){var i=r._dbInfo,n=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),a=n.get(t);a.onsuccess=function(){var t=a.result;void 0===t&&(t=null),s(t)&&(t=l(t)),e(t)},a.onerror=function(){o(a.error)}})["catch"](o)});return P(i,o),i}function v(e,t){var o=this,r=new Promise(function(t,r){o.ready().then(function(){var i=o._dbInfo,n=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),a=n.openCursor(),p=1;a.onsuccess=function(){var o=a.result;if(o){var r=o.value;s(r)&&(r=l(r));var i=e(r,o.key,p++);void 0!==i?t(i):o["continue"]()}else t()},a.onerror=function(){r(a.error)}})["catch"](r)});return P(r,t),r}function C(t,o,r){var i=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var l=new Promise(function(e,r){var l;i.ready().then(function(){return l=i._dbInfo,o instanceof Blob?n(l.db).then(function(e){return e?o:a(o)}):o}).then(function(o){var i=l.db.transaction(l.storeName,"readwrite"),n=i.objectStore(l.storeName);null===o&&(o=void 0),i.oncomplete=function(){void 0===o&&(o=null),e(o)},i.onabort=i.onerror=function(){var e=a.error?a.error:a.transaction.error;r(e)};var a=n.put(o,t)})["catch"](r)});return P(l,r),l}function T(t,o){var r=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var i=new Promise(function(e,o){r.ready().then(function(){var i=r._dbInfo,n=i.db.transaction(i.storeName,"readwrite"),a=n.objectStore(i.storeName),l=a["delete"](t);n.oncomplete=function(){e()},n.onerror=function(){o(l.error)},n.onabort=function(){var e=l.error?l.error:l.transaction.error;o(e)}})["catch"](o)});return P(i,o),i}function _(e){var t=this,o=new Promise(function(e,o){t.ready().then(function(){var r=t._dbInfo,i=r.db.transaction(r.storeName,"readwrite"),n=i.objectStore(r.storeName),a=n.clear();i.oncomplete=function(){e()},i.onabort=i.onerror=function(){var e=a.error?a.error:a.transaction.error;o(e)}})["catch"](o)});return P(o,e),o}function S(e){var t=this,o=new Promise(function(e,o){t.ready().then(function(){var r=t._dbInfo,i=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),n=i.count();n.onsuccess=function(){e(n.result)},n.onerror=function(){o(n.error)}})["catch"](o)});return P(o,e),o}function E(e,t){var o=this,r=new Promise(function(t,r){return 0>e?void t(null):void o.ready().then(function(){var i=o._dbInfo,n=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),a=!1,l=n.openCursor();l.onsuccess=function(){var o=l.result;return o?void(0===e?t(o.key):a?t(o.key):(a=!0,o.advance(e))):void t(null)},l.onerror=function(){r(l.error)}})["catch"](r)});return P(r,t),r}function x(e){var t=this,o=new Promise(function(e,o){t.ready().then(function(){var r=t._dbInfo,i=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),n=i.openCursor(),a=[];n.onsuccess=function(){var t=n.result;return t?(a.push(t.key),void t["continue"]()):void e(a)},n.onerror=function(){o(n.error)}})["catch"](o)});return P(o,e),o}function P(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}var L=L||e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.OIndexedDB||e.msIndexedDB;if(L){var w,R,A="local-forage-detect-blob-support",b={_driver:"asyncStorage",_initStorage:g,iterate:v,getItem:m,setItem:C,removeItem:T,clear:_,length:S,key:E,keys:x};return b}}("undefined"!=typeof window?window:self);t["default"]=o,e.exports=t["default"]},function(e,t,o){"use strict";t.__esModule=!0;var r=function(e){function t(e){var t=this,r={};if(e)for(var i in e)r[i]=e[i];return r.keyPrefix=r.name+"/",r.storeName!==t._defaultConfig.storeName&&(r.keyPrefix+=r.storeName+"/"),t._dbInfo=r,new Promise(function(e,t){e(o(3))}).then(function(e){return r.serializer=e,Promise.resolve()})}function r(e){var t=this,o=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,o=g.length-1;o>=0;o--){var r=g.key(o);0===r.indexOf(e)&&g.removeItem(r)}});return u(o,e),o}function i(t,o){var r=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var i=r.ready().then(function(){var e=r._dbInfo,o=g.getItem(e.keyPrefix+t);return o&&(o=e.serializer.deserialize(o)),o});return u(i,o),i}function n(e,t){var o=this,r=o.ready().then(function(){for(var t=o._dbInfo,r=t.keyPrefix,i=r.length,n=g.length,a=1,l=0;n>l;l++){var s=g.key(l);if(0===s.indexOf(r)){var p=g.getItem(s);if(p&&(p=t.serializer.deserialize(p)),p=e(p,s.substring(i),a++),void 0!==p)return p}}});return u(r,t),r}function a(e,t){var o=this,r=o.ready().then(function(){var t,r=o._dbInfo;try{t=g.key(e)}catch(i){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t});return u(r,t),r}function l(e){var t=this,o=t.ready().then(function(){for(var e=t._dbInfo,o=g.length,r=[],i=0;o>i;i++)0===g.key(i).indexOf(e.keyPrefix)&&r.push(g.key(i).substring(e.keyPrefix.length));return r});return u(o,e),o}function s(e){var t=this,o=t.keys().then(function(e){return e.length});return u(o,e),o}function p(t,o){var r=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var i=r.ready().then(function(){var e=r._dbInfo;g.removeItem(e.keyPrefix+t)});return u(i,o),i}function c(t,o,r){var i=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var n=i.ready().then(function(){void 0===o&&(o=null);var e=o;return new Promise(function(r,n){var a=i._dbInfo;a.serializer.serialize(o,function(o,i){if(i)n(i);else try{g.setItem(a.keyPrefix+t,o),r(e)}catch(l){("QuotaExceededError"===l.name||"NS_ERROR_DOM_QUOTA_REACHED"===l.name)&&n(l),n(l)}})})});return u(n,r),n}function u(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}var g=null;try{if(!(e.localStorage&&"setItem"in e.localStorage))return;g=e.localStorage}catch(d){return}var h={_driver:"localStorageWrapper",_initStorage:t,iterate:n,getItem:i,setItem:c,removeItem:p,clear:r,length:s,key:a,keys:l};return h}("undefined"!=typeof window?window:self);t["default"]=r,e.exports=t["default"]},function(e,t){"use strict";t.__esModule=!0;var o=function(e){function t(t,o){t=t||[],o=o||{};try{return new Blob(t,o)}catch(r){if("TypeError"!==r.name)throw r;for(var i=e.BlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder||e.WebKitBlobBuilder,n=new i,a=0;a<t.length;a+=1)n.append(t[a]);return n.getBlob(o.type)}}function o(e,t){var o="";if(e&&(o=e.toString()),e&&("[object ArrayBuffer]"===e.toString()||e.buffer&&"[object ArrayBuffer]"===e.buffer.toString())){var r,i=p;e instanceof ArrayBuffer?(r=e,i+=u):(r=e.buffer,"[object Int8Array]"===o?i+=d:"[object Uint8Array]"===o?i+=h:"[object Uint8ClampedArray]"===o?i+=f:"[object Int16Array]"===o?i+=y:"[object Uint16Array]"===o?i+=v:"[object Int32Array]"===o?i+=m:"[object Uint32Array]"===o?i+=C:"[object Float32Array]"===o?i+=T:"[object Float64Array]"===o?i+=_:t(new Error("Failed to get type for BinaryArray"))),t(i+n(r))}else if("[object Blob]"===o){var a=new FileReader;a.onload=function(){var o=l+e.type+"~"+n(this.result);t(p+g+o)},a.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(s){console.error("Couldn't convert value into a JSON string: ",e),t(null,s)}}function r(e){if(e.substring(0,c)!==p)return JSON.parse(e);var o,r=e.substring(S),n=e.substring(c,S);if(n===g&&s.test(r)){var a=r.match(s);o=a[1],r=r.substring(a[0].length)}var l=i(r);switch(n){case u:return l;case g:return t([l],{type:o});case d:return new Int8Array(l);case h:return new Uint8Array(l);case f:return new Uint8ClampedArray(l);case y:return new Int16Array(l);case v:return new Uint16Array(l);case m:return new Int32Array(l);case C:return new Uint32Array(l);case T:return new Float32Array(l);case _:return new Float64Array(l);default:throw new Error("Unkown type: "+n)}}function i(e){var t,o,r,i,n,l=.75*e.length,s=e.length,p=0;"="===e[e.length-1]&&(l--,"="===e[e.length-2]&&l--);var c=new ArrayBuffer(l),u=new Uint8Array(c);for(t=0;s>t;t+=4)o=a.indexOf(e[t]),r=a.indexOf(e[t+1]),i=a.indexOf(e[t+2]),n=a.indexOf(e[t+3]),u[p++]=o<<2|r>>4,u[p++]=(15&r)<<4|i>>2,u[p++]=(3&i)<<6|63&n;return c}function n(e){var t,o=new Uint8Array(e),r="";for(t=0;t<o.length;t+=3)r+=a[o[t]>>2],r+=a[(3&o[t])<<4|o[t+1]>>4],r+=a[(15&o[t+1])<<2|o[t+2]>>6],r+=a[63&o[t+2]];return o.length%3===2?r=r.substring(0,r.length-1)+"=":o.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l="~~local_forage_type~",s=/^~~local_forage_type~([^~]+)~/,p="__lfsc__:",c=p.length,u="arbf",g="blob",d="si08",h="ui08",f="uic8",y="si16",m="si32",v="ur16",C="ui32",T="fl32",_="fl64",S=c+u.length,E={serialize:o,deserialize:r,stringToBuffer:i,bufferToString:n};return E}("undefined"!=typeof window?window:self);t["default"]=o,e.exports=t["default"]},function(e,t,o){"use strict";t.__esModule=!0;var r=function(e){function t(e){var t=this,r={db:null};if(e)for(var i in e)r[i]="string"!=typeof e[i]?e[i].toString():e[i];var n=new Promise(function(e,o){try{r.db=g(r.name,String(r.version),r.description,r.size)}catch(i){return o(i)}r.db.transaction(function(i){i.executeSql("CREATE TABLE IF NOT EXISTS "+r.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){t._dbInfo=r,e()},function(e,t){o(t)})})});return new Promise(function(e,t){e(o(3))}).then(function(e){return r.serializer=e,n})}function r(t,o){var r=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var i=new Promise(function(e,o){r.ready().then(function(){var i=r._dbInfo;i.db.transaction(function(r){r.executeSql("SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[t],function(t,o){var r=o.rows.length?o.rows.item(0).value:null;r&&(r=i.serializer.deserialize(r)),e(r)},function(e,t){o(t)})})})["catch"](o)});return u(i,o),i}function i(e,t){var o=this,r=new Promise(function(t,r){o.ready().then(function(){var i=o._dbInfo;i.db.transaction(function(o){o.executeSql("SELECT * FROM "+i.storeName,[],function(o,r){for(var n=r.rows,a=n.length,l=0;a>l;l++){var s=n.item(l),p=s.value;if(p&&(p=i.serializer.deserialize(p)),p=e(p,s.key,l+1),void 0!==p)return void t(p)}t()},function(e,t){r(t)})})})["catch"](r)});return u(r,t),r}function n(t,o,r){var i=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var n=new Promise(function(e,r){i.ready().then(function(){void 0===o&&(o=null);var n=o,a=i._dbInfo;a.serializer.serialize(o,function(o,i){i?r(i):a.db.transaction(function(i){i.executeSql("INSERT OR REPLACE INTO "+a.storeName+" (key, value) VALUES (?, ?)",[t,o],function(){e(n)},function(e,t){r(t)})},function(e){e.code===e.QUOTA_ERR&&r(e)})})})["catch"](r)});return u(n,r),n}function a(t,o){var r=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var i=new Promise(function(e,o){r.ready().then(function(){var i=r._dbInfo;i.db.transaction(function(r){r.executeSql("DELETE FROM "+i.storeName+" WHERE key = ?",[t],function(){e()},function(e,t){o(t)})})})["catch"](o)});return u(i,o),i}function l(e){var t=this,o=new Promise(function(e,o){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("DELETE FROM "+r.storeName,[],function(){e()},function(e,t){o(t)})})})["catch"](o)});return u(o,e),o}function s(e){var t=this,o=new Promise(function(e,o){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("SELECT COUNT(key) as c FROM "+r.storeName,[],function(t,o){var r=o.rows.item(0).c;e(r)},function(e,t){o(t)})})})["catch"](o)});return u(o,e),o}function p(e,t){var o=this,r=new Promise(function(t,r){o.ready().then(function(){var i=o._dbInfo;i.db.transaction(function(o){o.executeSql("SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,o){var r=o.rows.length?o.rows.item(0).key:null;t(r)},function(e,t){r(t)})})})["catch"](r)});return u(r,t),r}function c(e){var t=this,o=new Promise(function(e,o){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("SELECT key FROM "+r.storeName,[],function(t,o){for(var r=[],i=0;i<o.rows.length;i++)r.push(o.rows.item(i).key);e(r)},function(e,t){o(t)})})})["catch"](o)});return u(o,e),o}function u(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}var g=e.openDatabase;if(g){var d={_driver:"webSQLStorage",_initStorage:t,iterate:i,getItem:r,setItem:n,removeItem:a,clear:l,length:s,key:p,keys:c};return d}}("undefined"!=typeof window?window:self);t["default"]=r,e.exports=t["default"]}])});var __extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);o.prototype=t.prototype;e.prototype=new o};!function(e){function t(e,t,o){void 0!==t[e]&&(null===t[e]?delete o[e]:o[e]=t[e])}function o(t){if(null!=e.enabled&&!e.enabled||null!=e.maxMessages&&1>e.maxMessages)return!1;try{if(t.userAgentRegex&&!RegExp(t.userAgentRegex).test(navigator.userAgent))return!1}catch(o){}try{if(t.ipRegex&&e.clientIP&&!RegExp(t.ipRegex).test(e.clientIP))return!1}catch(r){}return!0}function r(e,t){try{if(e.disallow&&RegExp(e.disallow).test(t))return!1}catch(o){}return!0}function i(e){return"function"==typeof e?e instanceof RegExp?e.toString():e():e}function n(e){e=i(e);switch(typeof e){case"string":return new a(e,null,e);case"number":return e=e.toString(),new a(e,null,e);case"boolean":return e=e.toString(),new a(e,null,e);case"undefined":return new a("undefined",null,"undefined");case"object":return e instanceof RegExp||e instanceof String||e instanceof Number||e instanceof Boolean?(e=e.toString(),new a(e,null,e)):new a(null,e,JSON.stringify(e));default:return new a("unknown",null,"unknown")}}e.enabled;e.maxMessages;e.defaultAjaxUrl;e.clientIP;e.defaultBeforeSend;e.requestId="";var a=function(){return function(e,t,o){this.msg=e;this.meta=t;this.finalString=o}}();e.setOptions=function(e){t("enabled",e,this);t("maxMessages",e,this);t("defaultAjaxUrl",e,this);t("clientIP",e,this);t("requestId",e,this);t("defaultBeforeSend",e,this);return this};e.getAllLevel=function(){return-2147483648};e.getTraceLevel=function(){return 1e3};e.getDebugLevel=function(){return 2e3};e.getInfoLevel=function(){return 3e3};e.getWarnLevel=function(){return 4e3};e.getErrorLevel=function(){return 5e3};e.getFatalLevel=function(){return 6e3};e.getOffLevel=function(){return 2147483647};var l=function(){return function(e,t){this.inner=t;this.name="JL.Exception";this.message=n(e).finalString}}();e.Exception=l;l.prototype=Error();var s=function(){return function(e,t,o,r){this.l=e;this.m=t;this.n=o;this.t=r}}();e.LogItem=s;l=function(){function i(t,o){this.appenderName=t;this.sendLogItems=o;this.level=e.getTraceLevel();this.sendWithBufferLevel=2147483647;this.storeInBufferLevel=-2147483648;this.bufferSize=0;this.batchSize=1;this.buffer=[];this.batchBuffer=[]}i.prototype.setOptions=function(e){t("level",e,this);t("ipRegex",e,this);t("userAgentRegex",e,this);t("disallow",e,this);t("sendWithBufferLevel",e,this);t("storeInBufferLevel",e,this);t("bufferSize",e,this);t("batchSize",e,this);this.bufferSize<this.buffer.length&&(this.buffer.length=this.bufferSize);return this};i.prototype.log=function(e,t,i,n,a,l,p){!o(this)||!r(this,l)||a<this.storeInBufferLevel||(e=new s(a,l,p,(new Date).getTime()),a<this.level?0<this.bufferSize&&(this.buffer.push(e),this.buffer.length>this.bufferSize&&this.buffer.shift()):(a<this.sendWithBufferLevel||!this.buffer.length||(this.batchBuffer=this.batchBuffer.concat(this.buffer),this.buffer.length=0),this.batchBuffer.push(e),this.batchBuffer.length>=this.batchSize&&this.sendBatch()))};i.prototype.sendBatch=function(){0==this.batchBuffer.length||null!=e.maxMessages&&1>e.maxMessages||(null!=e.maxMessages&&(e.maxMessages-=this.batchBuffer.length),this.sendLogItems(this.batchBuffer),this.batchBuffer.length=0)};return i}();e.Appender=l;var p=function(o){function r(e){o.call(this,e,r.prototype.sendLogItemsAjax)}__extends(r,o);r.prototype.setOptions=function(e){t("url",e,this);t("beforeSend",e,this);o.prototype.setOptions.call(this,e);return this};r.prototype.sendLogItemsAjax=function(t){try{var o="/jsnlog.logger";null!=e.defaultAjaxUrl&&(o=e.defaultAjaxUrl);this.url&&(o=this.url);var r=JSON.stringify({r:e.requestId,lg:t}),i=this.getXhr(o);"function"==typeof this.beforeSend?this.beforeSend.call(this,i):"function"==typeof e.defaultBeforeSend&&e.defaultBeforeSend.call(this,i);i.send(r)}catch(n){}};r.prototype.getXhr=function(t){var o=new XMLHttpRequest;if(!("withCredentials"in o)&&"undefined"!=typeof XDomainRequest)return o=new XDomainRequest,o.open("POST",t),o;o.open("POST",t);o.setRequestHeader("Content-Type","application/json");o.setRequestHeader("JSNLog-RequestId",e.requestId);return o};return r}(l);e.AjaxAppender=p;var c=function(t){function o(e){t.call(this,e,o.prototype.sendLogItemsConsole)}__extends(o,t);o.prototype.clog=function(e){console.log(e)};o.prototype.cerror=function(e){console.error?console.error(e):this.clog(e)};o.prototype.cwarn=function(e){console.warn?console.warn(e):this.clog(e)};o.prototype.cinfo=function(e){console.info?console.info(e):this.clog(e)};o.prototype.cdebug=function(e){console.debug?console.debug(e):this.cinfo(e)};o.prototype.sendLogItemsConsole=function(t){try{if(console){var o;for(o=0;o<t.length;++o){var r=t[o],i=r.n+": "+r.m;"undefined"==typeof window&&(i=new Date(r.t)+" | "+i);r.l<=e.getDebugLevel()?this.cdebug(i):r.l<=e.getInfoLevel()?this.cinfo(i):r.l<=e.getWarnLevel()?this.cwarn(i):this.cerror(i)}}}catch(n){}};return o}(l);e.ConsoleAppender=c;l=function(){function e(e){this.loggerName=e;this.seenRegexes=[]}e.prototype.setOptions=function(e){t("level",e,this);t("userAgentRegex",e,this);t("disallow",e,this);t("ipRegex",e,this);t("appenders",e,this);t("onceOnly",e,this);this.seenRegexes=[];return this};e.prototype.buildExceptionObject=function(e){var t={};e.stack?t.stack=e.stack:t.e=e;e.message&&(t.message=e.message);e.name&&(t.name=e.name);e.data&&(t.data=e.data);e.inner&&(t.inner=this.buildExceptionObject(e.inner));return t};e.prototype.log=function(e,t,a){var l=0;if(!this.appenders)return this;if(e>=this.level&&o(this)&&(a?(l=this.buildExceptionObject(a),l.logData=i(t)):l=t,t=n(l),r(this,t.finalString))){if(this.onceOnly)for(l=this.onceOnly.length-1;l>=0;){if(RegExp(this.onceOnly[l]).test(t.finalString)){if(this.seenRegexes[l])return this;this.seenRegexes[l]=!0}l--}t.meta=t.meta||{};t.meta.loggerName=this.loggerName;for(l=this.appenders.length-1;l>=0;)this.appenders[l].log(1e3>=e?"trace":2e3>=e?"debug":3e3>=e?"info":4e3>=e?"warn":5e3>=e?"error":"fatal",t.msg,t.meta,function(){},e,t.finalString,this.loggerName),l--}return this};e.prototype.trace=function(e){return this.log(1e3,e)};e.prototype.debug=function(e){return this.log(2e3,e)};e.prototype.info=function(e){return this.log(3e3,e)};e.prototype.warn=function(e){return this.log(4e3,e)};e.prototype.error=function(e){return this.log(5e3,e)};e.prototype.fatal=function(e){return this.log(6e3,e)};e.prototype.fatalException=function(e,t){return this.log(6e3,e,t)};return e}();e.Logger=l;e.createAjaxAppender=function(e){return new p(e)};e.createConsoleAppender=function(e){return new c(e)};l=new p("");"undefined"==typeof window&&(l=new c(""));e.__=new e.Logger("");e.__.setOptions({level:e.getDebugLevel(),appenders:[l]})}(JL||(JL={}));var exports;"undefined"!=typeof exports&&(exports.JL=JL);var define;"function"==typeof define&&define.amd&&define("jsnlog",[],function(){return JL});"function"==typeof __jsnlog_configure&&__jsnlog_configure(JL);!function(e,t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):e.ol=t()}(this,function(){var OPENLAYERS={},goog=this.goog={};this.CLOSURE_NO_DEPS=!0;var COMPILED=!1,goog=goog||{};goog.global=this;goog.global.CLOSURE_UNCOMPILED_DEFINES;goog.global.CLOSURE_DEFINES;goog.isDef=function(e){return void 0!==e};goog.exportPath_=function(e,t,o){var r=e.split("."),i=o||goog.global;r[0]in i||!i.execScript||i.execScript("var "+r[0]);for(var n;r.length&&(n=r.shift());)!r.length&&goog.isDef(t)?i[n]=t:i=i[n]&&Object.prototype.hasOwnProperty.call(i,n)?i[n]:i[n]={}};goog.define=function(e,t){var o=t;COMPILED||(goog.global.CLOSURE_UNCOMPILED_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES,e)?o=goog.global.CLOSURE_UNCOMPILED_DEFINES[e]:goog.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,e)&&(o=goog.global.CLOSURE_DEFINES[e]));goog.exportPath_(e,o)};goog.define("goog.DEBUG",!0);goog.define("goog.LOCALE","en");goog.define("goog.TRUSTED_SITE",!0);goog.define("goog.STRICT_MODE_COMPATIBLE",!1);goog.define("goog.DISALLOW_TEST_ONLY_CODE",COMPILED&&!goog.DEBUG);goog.define("goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING",!1);goog.provide=function(e){if(goog.isInModuleLoader_())throw Error("goog.provide can not be used within a goog.module.");if(!COMPILED&&goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');goog.constructNamespace_(e)};goog.constructNamespace_=function(e,t){if(!COMPILED){delete goog.implicitNamespaces_[e];for(var o=e;(o=o.substring(0,o.lastIndexOf(".")))&&!goog.getObjectByName(o);)goog.implicitNamespaces_[o]=!0}goog.exportPath_(e,t)};goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/;goog.module=function(e){if(!goog.isString(e)||!e||-1==e.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInModuleLoader_())throw Error("Module "+e+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");goog.moduleLoaderState_.moduleName=e;if(!COMPILED){if(goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');delete goog.implicitNamespaces_[e]}};goog.module.get=function(e){return goog.module.getInternal_(e)};goog.module.getInternal_=function(e){if(!COMPILED){if(e in goog.loadedModules_)return goog.loadedModules_[e];if(!goog.implicitNamespaces_[e]){var t=goog.getObjectByName(e);return null!=t?t:null}}return null};goog.moduleLoaderState_=null;goog.isInModuleLoader_=function(){return null!=goog.moduleLoaderState_};goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInModuleLoader_())throw new Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0};goog.setTestOnly=function(e){if(goog.DISALLOW_TEST_ONLY_CODE){e=e||"";throw Error("Importing test-only code into non-debug environment"+(e?": "+e:"."))}};goog.forwardDeclare=function(e){};goog.forwardDeclare("Document");goog.forwardDeclare("HTMLScriptElement");goog.forwardDeclare("XMLHttpRequest");if(!COMPILED){goog.isProvided_=function(e){return e in goog.loadedModules_||!goog.implicitNamespaces_[e]&&goog.isDefAndNotNull(goog.getObjectByName(e))};goog.implicitNamespaces_={"goog.module":!0}}goog.getObjectByName=function(e,t){for(var o,r=e.split("."),i=t||goog.global;o=r.shift();){if(!goog.isDefAndNotNull(i[o]))return null;i=i[o]}return i};goog.globalize=function(e,t){var o=t||goog.global;for(var r in e)o[r]=e[r]};goog.addDependency=function(e,t,o,r){if(goog.DEPENDENCIES_ENABLED){var i,n,a=e.replace(/\\/g,"/"),l=goog.dependencies_;r&&"boolean"!=typeof r||(r=r?{module:"goog"}:{});for(var s=0;i=t[s];s++){l.nameToPath[i]=a;l.loadFlags[a]=r}for(var p=0;n=o[p];p++){a in l.requires||(l.requires[a]={});l.requires[a][n]=!0}}};goog.define("goog.ENABLE_DEBUG_LOADER",!0);goog.logToConsole_=function(e){goog.global.console&&goog.global.console.error(e)};goog.require=function(e){if(!COMPILED){goog.ENABLE_DEBUG_LOADER&&goog.IS_OLD_IE_&&goog.maybeProcessDeferredDep_(e);if(goog.isProvided_(e)){if(goog.isInModuleLoader_())return goog.module.getInternal_(e)}else if(goog.ENABLE_DEBUG_LOADER){var t=goog.getPathFromDeps_(e);if(!t){var o="goog.require could not find: "+e;goog.logToConsole_(o);throw Error(o)}goog.writeScripts_(t)}return null}};goog.basePath="";goog.global.CLOSURE_BASE_PATH;goog.global.CLOSURE_NO_DEPS;goog.global.CLOSURE_IMPORT_SCRIPT;goog.nullFunction=function(){};goog.abstractMethod=function(){throw Error("unimplemented abstract method")};goog.addSingletonGetter=function(e){e.instance_=void 0;e.getInstance=function(){if(e.instance_)return e.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=e);return e.instance_=new e}};goog.instantiatedSingletons_=[];goog.define("goog.LOAD_MODULE_USING_EVAL",!0);goog.define("goog.SEAL_MODULE_EXPORTS",goog.DEBUG);goog.loadedModules_={};goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;goog.define("goog.TRANSPILE","detect");goog.define("goog.TRANSPILER","transpile.js");if(goog.DEPENDENCIES_ENABLED){goog.dependencies_={loadFlags:{},nameToPath:{},requires:{},visited:{},written:{},deferred:{}};goog.inHtmlDocument_=function(){var e=goog.global.document;return null!=e&&"write"in e};goog.findBasePath_=function(){if(goog.isDef(goog.global.CLOSURE_BASE_PATH))goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var e=goog.global.document,t=e.getElementsByTagName("SCRIPT"),o=t.length-1;o>=0;--o){var r=t[o],i=r.src,n=i.lastIndexOf("?"),a=-1==n?i.length:n;if("base.js"==i.substr(a-7,7)){goog.basePath=i.substr(0,a-7);return}}};goog.importScript_=function(e,t){var o=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;o(e,t)&&(goog.dependencies_.written[e]=!0)};goog.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all);goog.importProcessedScript_=function(e,t,o){var r='goog.retrieveAndExec_("'+e+'", '+t+", "+o+");";goog.importScript_("",r)};goog.queuedModules_=[];goog.wrapModule_=function(e,t){return goog.LOAD_MODULE_USING_EVAL&&goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(t+"\n//# sourceURL="+e+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+t+"\n;return exports});\n//# sourceURL="+e+"\n";

};goog.loadQueuedModules_=function(){var e=goog.queuedModules_.length;if(e>0){var t=goog.queuedModules_;goog.queuedModules_=[];for(var o=0;e>o;o++){var r=t[o];goog.maybeProcessDeferredPath_(r)}}};goog.maybeProcessDeferredDep_=function(e){if(goog.isDeferredModule_(e)&&goog.allDepsAreAvailable_(e)){var t=goog.getPathFromDeps_(e);goog.maybeProcessDeferredPath_(goog.basePath+t)}};goog.isDeferredModule_=function(e){var t=goog.getPathFromDeps_(e),o=t&&goog.dependencies_.loadFlags[t]||{},r=o.lang||"es3";if(t&&("goog"==o.module||goog.needsTranspile_(r))){var i=goog.basePath+t;return i in goog.dependencies_.deferred}return!1};goog.allDepsAreAvailable_=function(e){var t=goog.getPathFromDeps_(e);if(t&&t in goog.dependencies_.requires)for(var o in goog.dependencies_.requires[t])if(!goog.isProvided_(o)&&!goog.isDeferredModule_(o))return!1;return!0};goog.maybeProcessDeferredPath_=function(e){if(e in goog.dependencies_.deferred){var t=goog.dependencies_.deferred[e];delete goog.dependencies_.deferred[e];goog.globalEval(t)}};goog.loadModuleFromUrl=function(e){goog.retrieveAndExec_(e,!0,!1)};goog.writeScriptSrcNode_=function(e){goog.global.document.write('<script type="text/javascript" src="'+e+'"></script>')};goog.appendScriptSrcNode_=function(e){var t=goog.global.document,o=t.createElement("script");o.type="text/javascript";o.src=e;o.defer=!1;o.async=!1;t.head.appendChild(o)};goog.writeScriptTag_=function(e,t){if(goog.inHtmlDocument_()){var o=goog.global.document;if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&"complete"==o.readyState){var r=/\bdeps.js$/.test(e);if(r)return!1;throw Error('Cannot write "'+e+'" after document load')}if(void 0===t)if(goog.IS_OLD_IE_){var i=" onreadystatechange='goog.onScriptLoad_(this, "+ ++goog.lastNonModuleScriptIndex_+")' ";o.write('<script type="text/javascript" src="'+e+'"'+i+"></script>")}else goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING?goog.appendScriptSrcNode_(e):goog.writeScriptSrcNode_(e);else o.write('<script type="text/javascript">'+goog.protectScriptTag_(t)+"</script>");return!0}return!1};goog.protectScriptTag_=function(e){return e.replace(/<\/(SCRIPT)/gi,"\\x3c\\$1")};goog.needsTranspile_=function(e){if("always"==goog.TRANSPILE)return!0;if("never"==goog.TRANSPILE)return!1;goog.requiresTranspilation_||(goog.requiresTranspilation_=goog.createRequiresTranspilation_());if(e in goog.requiresTranspilation_)return goog.requiresTranspilation_[e];throw new Error("Unknown language mode: "+e)};goog.requiresTranspilation_=null;goog.lastNonModuleScriptIndex_=0;goog.onScriptLoad_=function(e,t){"complete"==e.readyState&&goog.lastNonModuleScriptIndex_==t&&goog.loadQueuedModules_();return!0};goog.writeScripts_=function(e){function t(e){if(!(e in i.written||e in i.visited)){i.visited[e]=!0;if(e in i.requires)for(var n in i.requires[e])if(!goog.isProvided_(n)){if(!(n in i.nameToPath))throw Error("Undefined nameToPath for "+n);t(i.nameToPath[n])}if(!(e in r)){r[e]=!0;o.push(e)}}}var o=[],r={},i=goog.dependencies_;t(e);for(var n=0;n<o.length;n++){var a=o[n];goog.dependencies_.written[a]=!0}var l=goog.moduleLoaderState_;goog.moduleLoaderState_=null;for(var n=0;n<o.length;n++){var a=o[n];if(!a){goog.moduleLoaderState_=l;throw Error("Undefined script input")}var s=i.loadFlags[a]||{},p=s.lang||"es3",c=goog.needsTranspile_(p);"goog"==s.module||c?goog.importProcessedScript_(goog.basePath+a,"goog"==s.module,c):goog.importScript_(goog.basePath+a)}goog.moduleLoaderState_=l};goog.getPathFromDeps_=function(e){return e in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[e]:null};goog.findBasePath_();goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js")}goog.hasBadLetScoping=null;goog.useSafari10Workaround=function(){if(null==goog.hasBadLetScoping){var hasBadLetScoping;try{hasBadLetScoping=!eval('"use strict";let x = 1; function f() { return typeof x; };f() == "number";')}catch(e){hasBadLetScoping=!1}goog.hasBadLetScoping=hasBadLetScoping}return goog.hasBadLetScoping};goog.workaroundSafari10EvalBug=function(e){return"(function(){"+e+"\n;})();\n"};goog.loadModule=function(e){var t=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:void 0,declareLegacyNamespace:!1};var o;if(goog.isFunction(e))o=e.call(void 0,{});else{if(!goog.isString(e))throw Error("Invalid module definition");goog.useSafari10Workaround()&&(e=goog.workaroundSafari10EvalBug(e));o=goog.loadModuleFromSource_.call(void 0,e)}var r=goog.moduleLoaderState_.moduleName;if(!goog.isString(r)||!r)throw Error('Invalid module name "'+r+'"');goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(r,o):goog.SEAL_MODULE_EXPORTS&&Object.seal&&"object"==typeof o&&null!=o&&Object.seal(o);goog.loadedModules_[r]=o}finally{goog.moduleLoaderState_=t}};goog.loadModuleFromSource_=function(){"use strict";var exports={};eval(arguments[0]);return exports};goog.normalizePath_=function(e){for(var t=e.split("/"),o=0;o<t.length;)"."==t[o]?t.splice(o,1):o&&".."==t[o]&&t[o-1]&&".."!=t[o-1]?t.splice(--o,2):o++;return t.join("/")};goog.loadFileSync_=function(e){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(e);try{var t=new goog.global.XMLHttpRequest;t.open("get",e,!1);t.send();return 0==t.status||200==t.status?t.responseText:null}catch(o){return null}};goog.retrieveAndExec_=function(e,t,o){if(!COMPILED){var r=e;e=goog.normalizePath_(e);var i=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_,n=goog.loadFileSync_(e);if(null==n)throw new Error('Load of "'+e+'" failed');o&&(n=goog.transpile_.call(goog.global,n,e));t?n=goog.wrapModule_(e,n):n+="\n//# sourceURL="+e;var a=goog.IS_OLD_IE_;if(a){goog.dependencies_.deferred[r]=n;goog.queuedModules_.push(r)}else i(e,n)}};goog.transpile_=function(code,path){var jscomp=goog.global.$jscomp;jscomp||(goog.global.$jscomp=jscomp={});var transpile=jscomp.transpile;if(!transpile){var transpilerPath=goog.basePath+goog.TRANSPILER,transpilerCode=goog.loadFileSync_(transpilerPath);if(transpilerCode){eval(transpilerCode+"\n//# sourceURL="+transpilerPath);if(goog.global.$gwtExport&&goog.global.$gwtExport.$jscomp&&!goog.global.$gwtExport.$jscomp.transpile)throw new Error('The transpiler did not properly export the "transpile" method. $gwtExport: '+JSON.stringify(goog.global.$gwtExport));goog.global.$jscomp.transpile=goog.global.$gwtExport.$jscomp.transpile;jscomp=goog.global.$jscomp;transpile=jscomp.transpile}}if(!transpile){var suffix=" requires transpilation but no transpiler was found.";transpile=jscomp.transpile=function(e,t){goog.logToConsole_(t+suffix);return e}}return transpile(code,path)};goog.typeOf=function(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var o=Object.prototype.toString.call(e);if("[object Window]"==o)return"object";if("[object Array]"==o||"number"==typeof e.length&&"undefined"!=typeof e.splice&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==o||"undefined"!=typeof e.call&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&"undefined"==typeof e.call)return"object";return t};goog.isNull=function(e){return null===e};goog.isDefAndNotNull=function(e){return null!=e};goog.isArray=function(e){return"array"==goog.typeOf(e)};goog.isArrayLike=function(e){var t=goog.typeOf(e);return"array"==t||"object"==t&&"number"==typeof e.length};goog.isDateLike=function(e){return goog.isObject(e)&&"function"==typeof e.getFullYear};goog.isString=function(e){return"string"==typeof e};goog.isBoolean=function(e){return"boolean"==typeof e};goog.isNumber=function(e){return"number"==typeof e};goog.isFunction=function(e){return"function"==goog.typeOf(e)};goog.isObject=function(e){var t=typeof e;return"object"==t&&null!=e||"function"==t};goog.getUid=function(e){return e[goog.UID_PROPERTY_]||(e[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(e){return!!e[goog.UID_PROPERTY_]};goog.removeUid=function(e){null!==e&&"removeAttribute"in e&&e.removeAttribute(goog.UID_PROPERTY_);try{delete e[goog.UID_PROPERTY_]}catch(t){}};goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(e){var t=goog.typeOf(e);if("object"==t||"array"==t){if(e.clone)return e.clone();var o="array"==t?[]:{};for(var r in e)o[r]=goog.cloneObject(e[r]);return o}return e};goog.bindNative_=function(e,t,o){return e.call.apply(e.bind,arguments)};goog.bindJs_=function(e,t,o){if(!e)throw new Error;if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return function(){var o=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(o,r);return e.apply(t,o)}}return function(){return e.apply(t,arguments)}};goog.bind=function(e,t,o){goog.bind=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bindNative_:goog.bindJs_;return goog.bind.apply(null,arguments)};goog.partial=function(e,t){var o=Array.prototype.slice.call(arguments,1);return function(){var t=o.slice();t.push.apply(t,arguments);return e.apply(this,t)}};goog.mixin=function(e,t){for(var o in t)e[o]=t[o]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};goog.globalEval=function(e){if(goog.global.execScript)goog.global.execScript(e,"JavaScript");else{if(!goog.global.eval)throw Error("goog.globalEval not available");if(null==goog.evalWorksForGlobals_){goog.global.eval("var _evalTest_ = 1;");if("undefined"!=typeof goog.global._evalTest_){try{delete goog.global._evalTest_}catch(t){}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1}if(goog.evalWorksForGlobals_)goog.global.eval(e);else{var o=goog.global.document,r=o.createElement("SCRIPT");r.type="text/javascript";r.defer=!1;r.appendChild(o.createTextNode(e));o.body.appendChild(r);o.body.removeChild(r)}}};goog.evalWorksForGlobals_=null;goog.cssNameMapping_;goog.cssNameMappingStyle_;goog.getCssName=function(e,t){if("."==String(e).charAt(0))throw new Error('className passed in goog.getCssName must not start with ".". You passed: '+e);var o,r=function(e){return goog.cssNameMapping_[e]||e},i=function(e){for(var t=e.split("-"),o=[],i=0;i<t.length;i++)o.push(r(t[i]));return o.join("-")};o=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?r:i:function(e){return e};var n=t?e+"-"+o(t):o(e);return goog.global.CLOSURE_CSS_NAME_MAP_FN?goog.global.CLOSURE_CSS_NAME_MAP_FN(n):n};goog.setCssNameMapping=function(e,t){goog.cssNameMapping_=e;goog.cssNameMappingStyle_=t};goog.global.CLOSURE_CSS_NAME_MAPPING;!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(e,t){t&&(e=e.replace(/\{\$([^}]+)}/g,function(e,o){return null!=t&&o in t?t[o]:e}));return e};goog.getMsgWithFallback=function(e,t){return e};goog.exportSymbol=function(e,t,o){goog.exportPath_(e,t,o)};goog.exportProperty=function(e,t,o){e[t]=o};goog.inherits=function(e,t){function o(){}o.prototype=t.prototype;e.superClass_=t.prototype;e.prototype=new o;e.prototype.constructor=e;e.base=function(e,o,r){for(var i=new Array(arguments.length-2),n=2;n<arguments.length;n++)i[n-2]=arguments[n];return t.prototype[o].apply(e,i)}};goog.base=function(e,t,o){var r=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!r)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(r.superClass_){for(var i=new Array(arguments.length-1),n=1;n<arguments.length;n++)i[n-1]=arguments[n];return r.superClass_.constructor.apply(e,i)}for(var a=new Array(arguments.length-2),n=2;n<arguments.length;n++)a[n-2]=arguments[n];for(var l=!1,s=e.constructor;s;s=s.superClass_&&s.superClass_.constructor)if(s.prototype[t]===r)l=!0;else if(l)return s.prototype[t].apply(e,a);if(e[t]===r)return e.constructor.prototype[t].apply(e,a);throw Error("goog.base called from a method of one name to a method of a different name")};goog.scope=function(e){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a goog.module.");e.call(goog.global)};COMPILED||(goog.global.COMPILED=COMPILED);goog.defineClass=function(e,t){var o=t.constructor,r=t.statics;o&&o!=Object.prototype.constructor||(o=function(){throw Error("cannot instantiate an interface (no constructor defined).")});var i=goog.defineClass.createSealingConstructor_(o,e);e&&goog.inherits(i,e);delete t.constructor;delete t.statics;goog.defineClass.applyProperties_(i.prototype,t);null!=r&&(r instanceof Function?r(i):goog.defineClass.applyProperties_(i,r));return i};goog.defineClass.ClassDescriptor;goog.define("goog.defineClass.SEAL_CLASS_INSTANCES",goog.DEBUG);goog.defineClass.createSealingConstructor_=function(e,t){if(!goog.defineClass.SEAL_CLASS_INSTANCES)return e;var o=!goog.defineClass.isUnsealable_(t),r=function(){var t=e.apply(this,arguments)||this;t[goog.UID_PROPERTY_]=t[goog.UID_PROPERTY_];this.constructor===r&&o&&Object.seal instanceof Function&&Object.seal(t);return t};return r};goog.defineClass.isUnsealable_=function(e){return e&&e.prototype&&e.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]};goog.defineClass.OBJECT_PROTOTYPE_FIELDS_=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];goog.defineClass.applyProperties_=function(e,t){var o;for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);for(var r=0;r<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;r++){o=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[r];Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}};goog.tagUnsealableClass=function(e){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(e.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)};goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable";goog.createRequiresTranspilation_=function(){function addNewerLanguageTranspilationCheck(e,t){if(transpilationRequiredForAllLaterModes)requiresTranspilation[e]=!0;else if(t())requiresTranspilation[e]=!1;else{requiresTranspilation[e]=!0;transpilationRequiredForAllLaterModes=!0}}function evalCheck(code){try{return!!eval(code)}catch(ignored){return!1}}var requiresTranspilation={es3:!1},transpilationRequiredForAllLaterModes=!1;addNewerLanguageTranspilationCheck("es5",function(){return evalCheck("[1,].length==1")});addNewerLanguageTranspilationCheck("es6",function(){var e="class X{constructor(){if(new.target!=String)throw 1;this.x=42}}let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof String))throw 1;for(const a of[2,3]){if(a==2)continue;function f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()==3}";return evalCheck('(()=>{"use strict";'+e+"})()")});addNewerLanguageTranspilationCheck("es6-impl",function(){return!0});addNewerLanguageTranspilationCheck("es7",function(){return evalCheck("2 ** 2 == 4")});addNewerLanguageTranspilationCheck("es8",function(){return evalCheck("async () => 1, true")});return requiresTranspilation};goog.provide("ol.array");ol.array.binarySearch=function(e,t,o){for(var r,i,n=o||ol.array.numberSafeCompareFunction,a=0,l=e.length,s=!1;l>a;){r=a+(l-a>>1);i=+n(e[r],t);if(0>i)a=r+1;else{l=r;s=!i}}return s?a:~a};ol.array.numberSafeCompareFunction=function(e,t){return e>t?1:t>e?-1:0};ol.array.includes=function(e,t){return e.indexOf(t)>=0};ol.array.linearFindNearest=function(e,t,o){var r=e.length;if(e[0]<=t)return 0;if(t<=e[r-1])return r-1;var i;if(o>0){for(i=1;r>i;++i)if(e[i]<t)return i-1}else if(0>o){for(i=1;r>i;++i)if(e[i]<=t)return i}else for(i=1;r>i;++i){if(e[i]==t)return i;if(e[i]<t)return e[i-1]-t<t-e[i]?i-1:i}return r-1};ol.array.reverseSubArray=function(e,t,o){for(;o>t;){var r=e[t];e[t]=e[o];e[o]=r;++t;--o}};ol.array.extend=function(e,t){var o,r=Array.isArray(t)?t:[t],i=r.length;for(o=0;i>o;o++)e[e.length]=r[o]};ol.array.remove=function(e,t){var o=e.indexOf(t),r=o>-1;r&&e.splice(o,1);return r};ol.array.find=function(e,t){for(var o,r=e.length>>>0,i=0;r>i;i++){o=e[i];if(t(o,i,e))return o}return null};ol.array.equals=function(e,t){var o=e.length;if(o!==t.length)return!1;for(var r=0;o>r;r++)if(e[r]!==t[r])return!1;return!0};ol.array.stableSort=function(e,t){var o,r=e.length,i=Array(e.length);for(o=0;r>o;o++)i[o]={index:o,value:e[o]};i.sort(function(e,o){return t(e.value,o.value)||e.index-o.index});for(o=0;o<e.length;o++)e[o]=i[o].value};ol.array.findIndex=function(e,t){var o,r=!e.every(function(r,i){o=i;return!t(r,i,e)});return r?o:-1};ol.array.isSorted=function(e,t,o){var r=t||ol.array.numberSafeCompareFunction;return e.every(function(t,i){if(0===i)return!0;var n=r(e[i-1],t);return!(n>0||o&&0===n)})};goog.provide("ol");ol.ASSUME_TOUCH=!1;ol.DEFAULT_MAX_ZOOM=42;ol.DEFAULT_MIN_ZOOM=0;ol.DEFAULT_RASTER_REPROJECTION_ERROR_THRESHOLD=.5;ol.DEFAULT_TILE_SIZE=256;ol.DEFAULT_WMS_VERSION="1.3.0";ol.ENABLE_CANVAS=!0;ol.ENABLE_PROJ4JS=!0;ol.ENABLE_RASTER_REPROJECTION=!0;ol.ENABLE_WEBGL=!0;ol.DEBUG_WEBGL=!0;ol.INITIAL_ATLAS_SIZE=256;ol.MAX_ATLAS_SIZE=-1;ol.MOUSEWHEELZOOM_MAXDELTA=1;ol.OVERVIEWMAP_MAX_RATIO=.75;ol.OVERVIEWMAP_MIN_RATIO=.1;ol.RASTER_REPROJECTION_MAX_SOURCE_TILES=100;ol.RASTER_REPROJECTION_MAX_SUBDIVISION=10;ol.RASTER_REPROJECTION_MAX_TRIANGLE_WIDTH=.25;ol.SIMPLIFY_TOLERANCE=.5;ol.WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK=1024;ol.VERSION="";ol.WEBGL_MAX_TEXTURE_SIZE;ol.WEBGL_EXTENSIONS;ol.inherits=function(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e};ol.nullFunction=function(){};ol.getUid=function(e){return e.ol_uid||(e.ol_uid=++ol.uidCounter_)};ol.uidCounter_=0;goog.provide("ol.AssertionError");goog.require("ol");ol.AssertionError=function(e){var t=ol.VERSION?ol.VERSION.split("-")[0]:"latest";this.message="Assertion failed. See https://openlayers.org/en/"+t+"/doc/errors/#"+e+" for details.";this.code=e;this.name="AssertionError"};ol.inherits(ol.AssertionError,Error);goog.provide("ol.asserts");goog.require("ol.AssertionError");ol.asserts.assert=function(e,t){if(!e)throw new ol.AssertionError(t)};goog.provide("ol.TileRange");ol.TileRange=function(e,t,o,r){this.minX=e;this.maxX=t;this.minY=o;this.maxY=r};ol.TileRange.createOrUpdate=function(e,t,o,r,i){if(void 0!==i){i.minX=e;i.maxX=t;i.minY=o;i.maxY=r;return i}return new ol.TileRange(e,t,o,r)};ol.TileRange.prototype.contains=function(e){return this.containsXY(e[1],e[2])};ol.TileRange.prototype.containsTileRange=function(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY};ol.TileRange.prototype.containsXY=function(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY};ol.TileRange.prototype.equals=function(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY};ol.TileRange.prototype.extend=function(e){e.minX<this.minX&&(this.minX=e.minX);e.maxX>this.maxX&&(this.maxX=e.maxX);e.minY<this.minY&&(this.minY=e.minY);e.maxY>this.maxY&&(this.maxY=e.maxY)};ol.TileRange.prototype.getHeight=function(){return this.maxY-this.minY+1};ol.TileRange.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]};ol.TileRange.prototype.getWidth=function(){return this.maxX-this.minX+1};ol.TileRange.prototype.intersects=function(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY};goog.provide("ol.math");goog.require("ol.asserts");ol.math.clamp=function(e,t,o){return Math.min(Math.max(e,t),o)};ol.math.cosh=function(){var e;e="cosh"in Math?Math.cosh:function(e){var t=Math.exp(e);return(t+1/t)/2};return e}();ol.math.roundUpToPowerOfTwo=function(e){ol.asserts.assert(e>0,29);return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))};ol.math.squaredSegmentDistance=function(e,t,o,r,i,n){var a=i-o,l=n-r;if(0!==a||0!==l){var s=((e-o)*a+(t-r)*l)/(a*a+l*l);if(s>1){o=i;r=n}else if(s>0){o+=a*s;r+=l*s}}return ol.math.squaredDistance(e,t,o,r)};ol.math.squaredDistance=function(e,t,o,r){var i=o-e,n=r-t;return i*i+n*n};ol.math.solveLinearSystem=function(e){for(var t=e.length,o=0;t>o;o++){for(var r=o,i=Math.abs(e[o][o]),n=o+1;t>n;n++){var a=Math.abs(e[n][o]);if(a>i){i=a;r=n}}if(0===i)return null;var l=e[r];e[r]=e[o];e[o]=l;for(var s=o+1;t>s;s++)for(var p=-e[s][o]/e[o][o],c=o;t+1>c;c++)o==c?e[s][c]=0:e[s][c]+=p*e[o][c]}for(var u=new Array(t),g=t-1;g>=0;g--){u[g]=e[g][t]/e[g][g];for(var d=g-1;d>=0;d--)e[d][t]-=e[d][g]*u[g]}return u};ol.math.toDegrees=function(e){return 180*e/Math.PI};ol.math.toRadians=function(e){return e*Math.PI/180};ol.math.modulo=function(e,t){var o=e%t;return 0>o*t?o+t:o};ol.math.lerp=function(e,t,o){return e+o*(t-e)};goog.provide("ol.size");ol.size.buffer=function(e,t,o){void 0===o&&(o=[0,0]);o[0]=e[0]+2*t;o[1]=e[1]+2*t;return o};ol.size.hasArea=function(e){return e[0]>0&&e[1]>0};ol.size.scale=function(e,t,o){void 0===o&&(o=[0,0]);o[0]=e[0]*t+.5|0;o[1]=e[1]*t+.5|0;return o};ol.size.toSize=function(e,t){if(Array.isArray(e))return e;void 0===t?t=[e,e]:t[0]=t[1]=e;return t};goog.provide("ol.extent.Corner");ol.extent.Corner={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};goog.provide("ol.extent.Relationship");ol.extent.Relationship={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};goog.provide("ol.extent");goog.require("ol.asserts");goog.require("ol.extent.Corner");goog.require("ol.extent.Relationship");ol.extent.boundingExtent=function(e){for(var t=ol.extent.createEmpty(),o=0,r=e.length;r>o;++o)ol.extent.extendCoordinate(t,e[o]);return t};ol.extent.boundingExtentXYs_=function(e,t,o){var r=Math.min.apply(null,e),i=Math.min.apply(null,t),n=Math.max.apply(null,e),a=Math.max.apply(null,t);return ol.extent.createOrUpdate(r,i,n,a,o)};ol.extent.buffer=function(e,t,o){if(o){o[0]=e[0]-t;o[1]=e[1]-t;o[2]=e[2]+t;o[3]=e[3]+t;return o}return[e[0]-t,e[1]-t,e[2]+t,e[3]+t]};ol.extent.clone=function(e,t){if(t){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];return t}return e.slice()};ol.extent.closestSquaredDistanceXY=function(e,t,o){var r,i;r=t<e[0]?e[0]-t:e[2]<t?t-e[2]:0;i=o<e[1]?e[1]-o:e[3]<o?o-e[3]:0;return r*r+i*i};ol.extent.containsCoordinate=function(e,t){return ol.extent.containsXY(e,t[0],t[1])};ol.extent.containsExtent=function(e,t){return e[0]<=t[0]&&t[2]<=e[2]&&e[1]<=t[1]&&t[3]<=e[3]};ol.extent.containsXY=function(e,t,o){return e[0]<=t&&t<=e[2]&&e[1]<=o&&o<=e[3]};ol.extent.coordinateRelationship=function(e,t){var o=e[0],r=e[1],i=e[2],n=e[3],a=t[0],l=t[1],s=ol.extent.Relationship.UNKNOWN;o>a?s|=ol.extent.Relationship.LEFT:a>i&&(s|=ol.extent.Relationship.RIGHT);r>l?s|=ol.extent.Relationship.BELOW:l>n&&(s|=ol.extent.Relationship.ABOVE);s===ol.extent.Relationship.UNKNOWN&&(s=ol.extent.Relationship.INTERSECTING);return s};ol.extent.createEmpty=function(){return[1/0,1/0,-(1/0),-(1/0)]};ol.extent.createOrUpdate=function(e,t,o,r,i){if(i){i[0]=e;i[1]=t;i[2]=o;i[3]=r;return i}return[e,t,o,r]};ol.extent.createOrUpdateEmpty=function(e){return ol.extent.createOrUpdate(1/0,1/0,-(1/0),-(1/0),e)};ol.extent.createOrUpdateFromCoordinate=function(e,t){var o=e[0],r=e[1];return ol.extent.createOrUpdate(o,r,o,r,t)};ol.extent.createOrUpdateFromCoordinates=function(e,t){var o=ol.extent.createOrUpdateEmpty(t);return ol.extent.extendCoordinates(o,e)};ol.extent.createOrUpdateFromFlatCoordinates=function(e,t,o,r,i){var n=ol.extent.createOrUpdateEmpty(i);return ol.extent.extendFlatCoordinates(n,e,t,o,r)};ol.extent.createOrUpdateFromRings=function(e,t){var o=ol.extent.createOrUpdateEmpty(t);return ol.extent.extendRings(o,e)};ol.extent.equals=function(e,t){return e[0]==t[0]&&e[2]==t[2]&&e[1]==t[1]&&e[3]==t[3]};ol.extent.extend=function(e,t){t[0]<e[0]&&(e[0]=t[0]);t[2]>e[2]&&(e[2]=t[2]);t[1]<e[1]&&(e[1]=t[1]);t[3]>e[3]&&(e[3]=t[3]);return e};ol.extent.extendCoordinate=function(e,t){t[0]<e[0]&&(e[0]=t[0]);t[0]>e[2]&&(e[2]=t[0]);t[1]<e[1]&&(e[1]=t[1]);t[1]>e[3]&&(e[3]=t[1])};ol.extent.extendCoordinates=function(e,t){var o,r;for(o=0,r=t.length;r>o;++o)ol.extent.extendCoordinate(e,t[o]);return e};ol.extent.extendFlatCoordinates=function(e,t,o,r,i){for(;r>o;o+=i)ol.extent.extendXY(e,t[o],t[o+1]);return e};ol.extent.extendRings=function(e,t){var o,r;for(o=0,r=t.length;r>o;++o)ol.extent.extendCoordinates(e,t[o]);return e};ol.extent.extendXY=function(e,t,o){e[0]=Math.min(e[0],t);e[1]=Math.min(e[1],o);e[2]=Math.max(e[2],t);e[3]=Math.max(e[3],o)};ol.extent.forEachCorner=function(e,t,o){var r;r=t.call(o,ol.extent.getBottomLeft(e));if(r)return r;r=t.call(o,ol.extent.getBottomRight(e));if(r)return r;r=t.call(o,ol.extent.getTopRight(e));if(r)return r;r=t.call(o,ol.extent.getTopLeft(e));return r?r:!1};ol.extent.getArea=function(e){var t=0;ol.extent.isEmpty(e)||(t=ol.extent.getWidth(e)*ol.extent.getHeight(e));return t};ol.extent.getBottomLeft=function(e){return[e[0],e[1]]};ol.extent.getBottomRight=function(e){return[e[2],e[1]]};ol.extent.getCenter=function(e){return[(e[0]+e[2])/2,(e[1]+e[3])/2]};ol.extent.getCorner=function(e,t){var o;t===ol.extent.Corner.BOTTOM_LEFT?o=ol.extent.getBottomLeft(e):t===ol.extent.Corner.BOTTOM_RIGHT?o=ol.extent.getBottomRight(e):t===ol.extent.Corner.TOP_LEFT?o=ol.extent.getTopLeft(e):t===ol.extent.Corner.TOP_RIGHT?o=ol.extent.getTopRight(e):ol.asserts.assert(!1,13);return o};ol.extent.getEnlargedArea=function(e,t){var o=Math.min(e[0],t[0]),r=Math.min(e[1],t[1]),i=Math.max(e[2],t[2]),n=Math.max(e[3],t[3]);return(i-o)*(n-r)};ol.extent.getForViewAndSize=function(e,t,o,r,i){var n=t*r[0]/2,a=t*r[1]/2,l=Math.cos(o),s=Math.sin(o),p=n*l,c=n*s,u=a*l,g=a*s,d=e[0],h=e[1],f=d-p+g,y=d-p-g,m=d+p-g,v=d+p+g,C=h-c-u,T=h-c+u,_=h+c+u,S=h+c-u;return ol.extent.createOrUpdate(Math.min(f,y,m,v),Math.min(C,T,_,S),Math.max(f,y,m,v),Math.max(C,T,_,S),i)};ol.extent.getHeight=function(e){return e[3]-e[1]};ol.extent.getIntersectionArea=function(e,t){var o=ol.extent.getIntersection(e,t);return ol.extent.getArea(o)};ol.extent.getIntersection=function(e,t,o){var r=o?o:ol.extent.createEmpty();if(ol.extent.intersects(e,t)){r[0]=e[0]>t[0]?e[0]:t[0];r[1]=e[1]>t[1]?e[1]:t[1];r[2]=e[2]<t[2]?e[2]:t[2];r[3]=e[3]<t[3]?e[3]:t[3]}return r};ol.extent.getMargin=function(e){return ol.extent.getWidth(e)+ol.extent.getHeight(e)};ol.extent.getSize=function(e){return[e[2]-e[0],e[3]-e[1]]};ol.extent.getTopLeft=function(e){return[e[0],e[3]]};ol.extent.getTopRight=function(e){return[e[2],e[3]]};ol.extent.getWidth=function(e){return e[2]-e[0]};ol.extent.intersects=function(e,t){return e[0]<=t[2]&&e[2]>=t[0]&&e[1]<=t[3]&&e[3]>=t[1]};ol.extent.isEmpty=function(e){return e[2]<e[0]||e[3]<e[1]};ol.extent.returnOrUpdate=function(e,t){if(t){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];return t}return e};ol.extent.scaleFromCenter=function(e,t){var o=(e[2]-e[0])/2*(t-1),r=(e[3]-e[1])/2*(t-1);e[0]-=o;e[2]+=o;e[1]-=r;e[3]+=r};ol.extent.intersectsSegment=function(e,t,o){var r=!1,i=ol.extent.coordinateRelationship(e,t),n=ol.extent.coordinateRelationship(e,o);if(i===ol.extent.Relationship.INTERSECTING||n===ol.extent.Relationship.INTERSECTING)r=!0;else{var a,l,s=e[0],p=e[1],c=e[2],u=e[3],g=t[0],d=t[1],h=o[0],f=o[1],y=(f-d)/(h-g);if(n&ol.extent.Relationship.ABOVE&&!(i&ol.extent.Relationship.ABOVE)){a=h-(f-u)/y;r=a>=s&&c>=a}if(!r&&n&ol.extent.Relationship.RIGHT&&!(i&ol.extent.Relationship.RIGHT)){l=f-(h-c)*y;r=l>=p&&u>=l}if(!r&&n&ol.extent.Relationship.BELOW&&!(i&ol.extent.Relationship.BELOW)){a=h-(f-p)/y;r=a>=s&&c>=a}if(!r&&n&ol.extent.Relationship.LEFT&&!(i&ol.extent.Relationship.LEFT)){l=f-(h-s)*y;r=l>=p&&u>=l}}return r};ol.extent.applyTransform=function(e,t,o){var r=[e[0],e[1],e[0],e[3],e[2],e[1],e[2],e[3]];t(r,r,2);var i=[r[0],r[2],r[4],r[6]],n=[r[1],r[3],r[5],r[7]];return ol.extent.boundingExtentXYs_(i,n,o)};goog.provide("ol.obj");ol.obj.assign="function"==typeof Object.assign?Object.assign:function(e,t){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(e),r=1,i=arguments.length;i>r;++r){var n=arguments[r];if(void 0!==n&&null!==n)for(var a in n)n.hasOwnProperty(a)&&(o[a]=n[a])}return o};ol.obj.clear=function(e){for(var t in e)delete e[t]};ol.obj.getValues=function(e){var t=[];for(var o in e)t.push(e[o]);return t};ol.obj.isEmpty=function(e){var t;for(t in e)return!1;return!t};goog.provide("ol.Sphere");goog.require("ol.math");ol.Sphere=function(e){this.radius=e};ol.Sphere.prototype.geodesicArea=function(e){for(var t=0,o=e.length,r=e[o-1][0],i=e[o-1][1],n=0;o>n;n++){var a=e[n][0],l=e[n][1];t+=ol.math.toRadians(a-r)*(2+Math.sin(ol.math.toRadians(i))+Math.sin(ol.math.toRadians(l)));r=a;i=l}return t*this.radius*this.radius/2};ol.Sphere.prototype.haversineDistance=function(e,t){var o=ol.math.toRadians(e[1]),r=ol.math.toRadians(t[1]),i=(r-o)/2,n=ol.math.toRadians(t[0]-e[0])/2,a=Math.sin(i)*Math.sin(i)+Math.sin(n)*Math.sin(n)*Math.cos(o)*Math.cos(r);return 2*this.radius*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))};ol.Sphere.prototype.offset=function(e,t,o){var r=ol.math.toRadians(e[1]),i=ol.math.toRadians(e[0]),n=t/this.radius,a=Math.asin(Math.sin(r)*Math.cos(n)+Math.cos(r)*Math.sin(n)*Math.cos(o)),l=i+Math.atan2(Math.sin(o)*Math.sin(n)*Math.cos(r),Math.cos(n)-Math.sin(r)*Math.sin(a));return[ol.math.toDegrees(l),ol.math.toDegrees(a)]};goog.provide("ol.sphere.NORMAL");goog.require("ol.Sphere");ol.sphere.NORMAL=new ol.Sphere(6370997);goog.provide("ol.proj.Units");goog.require("ol.sphere.NORMAL");ol.proj.Units={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"};ol.proj.Units.METERS_PER_UNIT={};ol.proj.Units.METERS_PER_UNIT[ol.proj.Units.DEGREES]=2*Math.PI*ol.sphere.NORMAL.radius/360;ol.proj.Units.METERS_PER_UNIT[ol.proj.Units.FEET]=.3048;ol.proj.Units.METERS_PER_UNIT[ol.proj.Units.METERS]=1;ol.proj.Units.METERS_PER_UNIT[ol.proj.Units.USFEET]=1200/3937;goog.provide("ol.proj.proj4");ol.proj.proj4.cache_=null;ol.proj.proj4.set=function(e){ol.proj.proj4.cache_=e};ol.proj.proj4.get=function(){return ol.proj.proj4.cache_||window.proj4};goog.provide("ol.proj.Projection");goog.require("ol");goog.require("ol.proj.Units");goog.require("ol.proj.proj4");ol.proj.Projection=function(e){this.code_=e.code;this.units_=e.units;this.extent_=void 0!==e.extent?e.extent:null;this.worldExtent_=void 0!==e.worldExtent?e.worldExtent:null;this.axisOrientation_=void 0!==e.axisOrientation?e.axisOrientation:"enu";this.global_=void 0!==e.global?e.global:!1;this.canWrapX_=!(!this.global_||!this.extent_);this.getPointResolutionFunc_=e.getPointResolution;this.defaultTileGrid_=null;this.metersPerUnit_=e.metersPerUnit;var t=e.code;if(ol.ENABLE_PROJ4JS){var o=ol.proj.proj4.get();if("function"==typeof o){var r=o.defs(t);if(void 0!==r){void 0!==r.axis&&void 0===e.axisOrientation&&(this.axisOrientation_=r.axis);void 0===e.metersPerUnit&&(this.metersPerUnit_=r.to_meter);void 0===e.units&&(this.units_=r.units)}}}};ol.proj.Projection.prototype.canWrapX=function(){return this.canWrapX_};ol.proj.Projection.prototype.getCode=function(){return this.code_};ol.proj.Projection.prototype.getExtent=function(){return this.extent_};ol.proj.Projection.prototype.getUnits=function(){return this.units_};ol.proj.Projection.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||ol.proj.Units.METERS_PER_UNIT[this.units_]};ol.proj.Projection.prototype.getWorldExtent=function(){return this.worldExtent_};ol.proj.Projection.prototype.getAxisOrientation=function(){return this.axisOrientation_};ol.proj.Projection.prototype.isGlobal=function(){return this.global_};ol.proj.Projection.prototype.setGlobal=function(e){this.global_=e;this.canWrapX_=!(!e||!this.extent_)};ol.proj.Projection.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_};ol.proj.Projection.prototype.setDefaultTileGrid=function(e){this.defaultTileGrid_=e};ol.proj.Projection.prototype.setExtent=function(e){this.extent_=e;this.canWrapX_=!(!this.global_||!e)};ol.proj.Projection.prototype.setWorldExtent=function(e){this.worldExtent_=e};ol.proj.Projection.prototype.setGetPointResolution=function(e){this.getPointResolutionFunc_=e};ol.proj.Projection.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};goog.provide("ol.proj.EPSG3857");goog.require("ol");goog.require("ol.math");goog.require("ol.proj.Projection");

goog.require("ol.proj.Units");ol.proj.EPSG3857.Projection_=function(e){ol.proj.Projection.call(this,{code:e,units:ol.proj.Units.METERS,extent:ol.proj.EPSG3857.EXTENT,global:!0,worldExtent:ol.proj.EPSG3857.WORLD_EXTENT,getPointResolution:function(e,t){return e/ol.math.cosh(t[1]/ol.proj.EPSG3857.RADIUS)}})};ol.inherits(ol.proj.EPSG3857.Projection_,ol.proj.Projection);ol.proj.EPSG3857.RADIUS=6378137;ol.proj.EPSG3857.HALF_SIZE=Math.PI*ol.proj.EPSG3857.RADIUS;ol.proj.EPSG3857.EXTENT=[-ol.proj.EPSG3857.HALF_SIZE,-ol.proj.EPSG3857.HALF_SIZE,ol.proj.EPSG3857.HALF_SIZE,ol.proj.EPSG3857.HALF_SIZE];ol.proj.EPSG3857.WORLD_EXTENT=[-180,-85,180,85];ol.proj.EPSG3857.CODES=["EPSG:3857","EPSG:102100","EPSG:102113","EPSG:900913","urn:ogc:def:crs:EPSG:6.18:3:3857","urn:ogc:def:crs:EPSG::3857","http://www.opengis.net/gml/srs/epsg.xml#3857"];ol.proj.EPSG3857.PROJECTIONS=ol.proj.EPSG3857.CODES.map(function(e){return new ol.proj.EPSG3857.Projection_(e)});ol.proj.EPSG3857.fromEPSG4326=function(e,t,o){var r=e.length,i=o>1?o:2,n=t;void 0===n&&(n=i>2?e.slice():new Array(r));for(var a=ol.proj.EPSG3857.HALF_SIZE,l=0;r>l;l+=i){n[l]=a*e[l]/180;var s=ol.proj.EPSG3857.RADIUS*Math.log(Math.tan(Math.PI*(e[l+1]+90)/360));s>a?s=a:-a>s&&(s=-a);n[l+1]=s}return n};ol.proj.EPSG3857.toEPSG4326=function(e,t,o){var r=e.length,i=o>1?o:2,n=t;void 0===n&&(n=i>2?e.slice():new Array(r));for(var a=0;r>a;a+=i){n[a]=180*e[a]/ol.proj.EPSG3857.HALF_SIZE;n[a+1]=360*Math.atan(Math.exp(e[a+1]/ol.proj.EPSG3857.RADIUS))/Math.PI-90}return n};goog.provide("ol.sphere.WGS84");goog.require("ol.Sphere");ol.sphere.WGS84=new ol.Sphere(6378137);goog.provide("ol.proj.EPSG4326");goog.require("ol");goog.require("ol.proj.Projection");goog.require("ol.proj.Units");goog.require("ol.sphere.WGS84");ol.proj.EPSG4326.Projection_=function(e,t){ol.proj.Projection.call(this,{code:e,units:ol.proj.Units.DEGREES,extent:ol.proj.EPSG4326.EXTENT,axisOrientation:t,global:!0,metersPerUnit:ol.proj.EPSG4326.METERS_PER_UNIT,worldExtent:ol.proj.EPSG4326.EXTENT})};ol.inherits(ol.proj.EPSG4326.Projection_,ol.proj.Projection);ol.proj.EPSG4326.EXTENT=[-180,-90,180,90];ol.proj.EPSG4326.METERS_PER_UNIT=Math.PI*ol.sphere.WGS84.radius/180;ol.proj.EPSG4326.PROJECTIONS=[new ol.proj.EPSG4326.Projection_("CRS:84"),new ol.proj.EPSG4326.Projection_("EPSG:4326","neu"),new ol.proj.EPSG4326.Projection_("urn:ogc:def:crs:EPSG::4326","neu"),new ol.proj.EPSG4326.Projection_("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new ol.proj.EPSG4326.Projection_("urn:ogc:def:crs:OGC:1.3:CRS84"),new ol.proj.EPSG4326.Projection_("urn:ogc:def:crs:OGC:2:84"),new ol.proj.EPSG4326.Projection_("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ol.proj.EPSG4326.Projection_("urn:x-ogc:def:crs:EPSG:4326","neu")];goog.provide("ol.proj.projections");ol.proj.projections.cache_={};ol.proj.projections.clear=function(){ol.proj.projections.cache_={}};ol.proj.projections.get=function(e){var t=ol.proj.projections.cache_;return t[e]||null};ol.proj.projections.add=function(e,t){var o=ol.proj.projections.cache_;o[e]=t};goog.provide("ol.proj.transforms");goog.require("ol.obj");ol.proj.transforms.cache_={};ol.proj.transforms.clear=function(){ol.proj.transforms.cache_={}};ol.proj.transforms.add=function(e,t,o){var r=e.getCode(),i=t.getCode(),n=ol.proj.transforms.cache_;r in n||(n[r]={});n[r][i]=o};ol.proj.transforms.remove=function(e,t){var o=e.getCode(),r=t.getCode(),i=ol.proj.transforms.cache_,n=i[o][r];delete i[o][r];ol.obj.isEmpty(i[o])&&delete i[o];return n};ol.proj.transforms.get=function(e,t){var o,r=ol.proj.transforms.cache_;e in r&&t in r[e]&&(o=r[e][t]);return o};goog.provide("ol.proj");goog.require("ol");goog.require("ol.extent");goog.require("ol.proj.EPSG3857");goog.require("ol.proj.EPSG4326");goog.require("ol.proj.Projection");goog.require("ol.proj.Units");goog.require("ol.proj.proj4");goog.require("ol.proj.projections");goog.require("ol.proj.transforms");goog.require("ol.sphere.NORMAL");ol.proj.METERS_PER_UNIT=ol.proj.Units.METERS_PER_UNIT;ol.ENABLE_PROJ4JS&&(ol.proj.setProj4=function(e){ol.proj.proj4.set(e)});ol.proj.getPointResolution=function(e,t,o){var r,i=e.getPointResolutionFunc();if(i)r=i(t,o);else{var n=e.getUnits();if(n==ol.proj.Units.DEGREES)r=t;else{var a=ol.proj.getTransformFromProjections(e,ol.proj.get("EPSG:4326")),l=[o[0]-t/2,o[1],o[0]+t/2,o[1],o[0],o[1]-t/2,o[0],o[1]+t/2];l=a(l,l,2);var s=ol.sphere.NORMAL.haversineDistance(l.slice(0,2),l.slice(2,4)),p=ol.sphere.NORMAL.haversineDistance(l.slice(4,6),l.slice(6,8));r=(s+p)/2;var c=e.getMetersPerUnit();void 0!==c&&(r/=c)}}return r};ol.proj.addEquivalentProjections=function(e){ol.proj.addProjections(e);e.forEach(function(t){e.forEach(function(e){t!==e&&ol.proj.transforms.add(t,e,ol.proj.cloneTransform)})})};ol.proj.addEquivalentTransforms=function(e,t,o,r){e.forEach(function(e){t.forEach(function(t){ol.proj.transforms.add(e,t,o);ol.proj.transforms.add(t,e,r)})})};ol.proj.addProjection=function(e){ol.proj.projections.add(e.getCode(),e);ol.proj.transforms.add(e,e,ol.proj.cloneTransform)};ol.proj.addProjections=function(e){var t=[];e.forEach(function(e){t.push(ol.proj.addProjection(e))})};ol.proj.clearAllProjections=function(){ol.proj.projections.clear();ol.proj.transforms.clear()};ol.proj.createProjection=function(e,t){return e?"string"==typeof e?ol.proj.get(e):e:ol.proj.get(t)};ol.proj.addCoordinateTransforms=function(e,t,o,r){var i=ol.proj.get(e),n=ol.proj.get(t);ol.proj.transforms.add(i,n,ol.proj.createTransformFromCoordinateTransform(o));ol.proj.transforms.add(n,i,ol.proj.createTransformFromCoordinateTransform(r))};ol.proj.createTransformFromCoordinateTransform=function(e){return function(t,o,r){var i,n,a,l=t.length,s=void 0!==r?r:2,p=void 0!==o?o:new Array(l);for(n=0;l>n;n+=s){i=e([t[n],t[n+1]]);p[n]=i[0];p[n+1]=i[1];for(a=s-1;a>=2;--a)p[n+a]=t[n+a]}return p}};ol.proj.fromLonLat=function(e,t){return ol.proj.transform(e,"EPSG:4326",void 0!==t?t:"EPSG:3857")};ol.proj.toLonLat=function(e,t){return ol.proj.transform(e,void 0!==t?t:"EPSG:3857","EPSG:4326")};ol.proj.get=function(e){var t=null;if(e instanceof ol.proj.Projection)t=e;else if("string"==typeof e){var o=e;t=ol.proj.projections.get(o);if(ol.ENABLE_PROJ4JS){var r=ol.proj.proj4.get();if(!t&&"function"==typeof r&&void 0!==r.defs(o)){t=new ol.proj.Projection({code:o});ol.proj.addProjection(t)}}}return t};ol.proj.equivalent=function(e,t){if(e===t)return!0;var o=e.getUnits()===t.getUnits();if(e.getCode()===t.getCode())return o;var r=ol.proj.getTransformFromProjections(e,t);return r===ol.proj.cloneTransform&&o};ol.proj.getTransform=function(e,t){var o=ol.proj.get(e),r=ol.proj.get(t);return ol.proj.getTransformFromProjections(o,r)};ol.proj.getTransformFromProjections=function(e,t){var o=e.getCode(),r=t.getCode(),i=ol.proj.transforms.get(o,r);if(ol.ENABLE_PROJ4JS&&!i){var n=ol.proj.proj4.get();if("function"==typeof n){var a=n.defs(o),l=n.defs(r);if(void 0!==a&&void 0!==l){if(a===l)ol.proj.addEquivalentProjections([t,e]);else{var s=n(r,o);ol.proj.addCoordinateTransforms(t,e,s.forward,s.inverse)}i=ol.proj.transforms.get(o,r)}}}i||(i=ol.proj.identityTransform);return i};ol.proj.identityTransform=function(e,t,o){if(void 0!==t&&e!==t){for(var r=0,i=e.length;i>r;++r)t[r]=e[r];e=t}return e};ol.proj.cloneTransform=function(e,t,o){var r;if(void 0!==t){for(var i=0,n=e.length;n>i;++i)t[i]=e[i];r=t}else r=e.slice();return r};ol.proj.transform=function(e,t,o){var r=ol.proj.getTransform(t,o);return r(e,void 0,e.length)};ol.proj.transformExtent=function(e,t,o){var r=ol.proj.getTransform(t,o);return ol.extent.applyTransform(e,r)};ol.proj.transformWithProjections=function(e,t,o){var r=ol.proj.getTransformFromProjections(t,o);return r(e)};ol.proj.addCommon=function(){ol.proj.addEquivalentProjections(ol.proj.EPSG3857.PROJECTIONS);ol.proj.addEquivalentProjections(ol.proj.EPSG4326.PROJECTIONS);ol.proj.addEquivalentTransforms(ol.proj.EPSG4326.PROJECTIONS,ol.proj.EPSG3857.PROJECTIONS,ol.proj.EPSG3857.fromEPSG4326,ol.proj.EPSG3857.toEPSG4326)};ol.proj.addCommon();goog.provide("ol.tilecoord");ol.tilecoord.createOrUpdate=function(e,t,o,r){if(void 0!==r){r[0]=e;r[1]=t;r[2]=o;return r}return[e,t,o]};ol.tilecoord.getKeyZXY=function(e,t,o){return e+"/"+t+"/"+o};ol.tilecoord.hash=function(e){return(e[1]<<e[0])+e[2]};ol.tilecoord.quadKey=function(e){var t,o,r=e[0],i=new Array(r),n=1<<r-1;for(t=0;r>t;++t){o=48;e[1]&n&&(o+=1);e[2]&n&&(o+=2);i[t]=String.fromCharCode(o);n>>=1}return i.join("")};ol.tilecoord.withinExtentAndZ=function(e,t){var o=e[0],r=e[1],i=e[2];if(t.getMinZoom()>o||o>t.getMaxZoom())return!1;var n,a=t.getExtent();n=a?t.getTileRangeForExtentAndZ(a,o):t.getFullTileRange(o);return n?n.containsXY(r,i):!0};goog.provide("ol.tilegrid.TileGrid");goog.require("ol");goog.require("ol.asserts");goog.require("ol.TileRange");goog.require("ol.array");goog.require("ol.extent");goog.require("ol.math");goog.require("ol.size");goog.require("ol.tilecoord");ol.tilegrid.TileGrid=function(e){this.minZoom=void 0!==e.minZoom?e.minZoom:0;this.resolutions_=e.resolutions;ol.asserts.assert(ol.array.isSorted(this.resolutions_,function(e,t){return t-e},!0),17);this.maxZoom=this.resolutions_.length-1;this.origin_=void 0!==e.origin?e.origin:null;this.origins_=null;if(void 0!==e.origins){this.origins_=e.origins;ol.asserts.assert(this.origins_.length==this.resolutions_.length,20)}var t=e.extent;void 0===t||this.origin_||this.origins_||(this.origin_=ol.extent.getTopLeft(t));ol.asserts.assert(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18);this.tileSizes_=null;if(void 0!==e.tileSizes){this.tileSizes_=e.tileSizes;ol.asserts.assert(this.tileSizes_.length==this.resolutions_.length,19)}this.tileSize_=void 0!==e.tileSize?e.tileSize:this.tileSizes_?null:ol.DEFAULT_TILE_SIZE;ol.asserts.assert(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22);this.extent_=void 0!==t?t:null;this.fullTileRanges_=null;this.tmpSize_=[0,0];void 0!==e.sizes?this.fullTileRanges_=e.sizes.map(function(e,t){var o=new ol.TileRange(Math.min(0,e[0]),Math.max(e[0]-1,-1),Math.min(0,e[1]),Math.max(e[1]-1,-1));return o},this):t&&this.calculateTileRanges_(t)};ol.tilegrid.TileGrid.tmpTileCoord_=[0,0,0];ol.tilegrid.TileGrid.prototype.forEachTileCoord=function(e,t,o){for(var r=this.getTileRangeForExtentAndZ(e,t),i=r.minX,n=r.maxX;n>=i;++i)for(var a=r.minY,l=r.maxY;l>=a;++a)o([t,i,a])};ol.tilegrid.TileGrid.prototype.forEachTileCoordParentTileRange=function(e,t,o,r,i){for(var n=this.getTileCoordExtent(e,i),a=e[0]-1;a>=this.minZoom;){if(t.call(o,a,this.getTileRangeForExtentAndZ(n,a,r)))return!0;--a}return!1};ol.tilegrid.TileGrid.prototype.getExtent=function(){return this.extent_};ol.tilegrid.TileGrid.prototype.getMaxZoom=function(){return this.maxZoom};ol.tilegrid.TileGrid.prototype.getMinZoom=function(){return this.minZoom};ol.tilegrid.TileGrid.prototype.getOrigin=function(e){return this.origin_?this.origin_:this.origins_[e]};ol.tilegrid.TileGrid.prototype.getResolution=function(e){return this.resolutions_[e]};ol.tilegrid.TileGrid.prototype.getResolutions=function(){return this.resolutions_};ol.tilegrid.TileGrid.prototype.getTileCoordChildTileRange=function(e,t,o){if(e[0]<this.maxZoom){var r=this.getTileCoordExtent(e,o);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null};ol.tilegrid.TileGrid.prototype.getTileRangeExtent=function(e,t,o){var r=this.getOrigin(e),i=this.getResolution(e),n=ol.size.toSize(this.getTileSize(e),this.tmpSize_),a=r[0]+t.minX*n[0]*i,l=r[0]+(t.maxX+1)*n[0]*i,s=r[1]+t.minY*n[1]*i,p=r[1]+(t.maxY+1)*n[1]*i;return ol.extent.createOrUpdate(a,s,l,p,o)};ol.tilegrid.TileGrid.prototype.getTileRangeForExtentAndResolution=function(e,t,o){var r=ol.tilegrid.TileGrid.tmpTileCoord_;this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,r);var i=r[1],n=r[2];this.getTileCoordForXYAndResolution_(e[2],e[3],t,!0,r);return ol.TileRange.createOrUpdate(i,r[1],n,r[2],o)};ol.tilegrid.TileGrid.prototype.getTileRangeForExtentAndZ=function(e,t,o){var r=this.getResolution(t);return this.getTileRangeForExtentAndResolution(e,r,o)};ol.tilegrid.TileGrid.prototype.getTileCoordCenter=function(e){var t=this.getOrigin(e[0]),o=this.getResolution(e[0]),r=ol.size.toSize(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*o,t[1]+(e[2]+.5)*r[1]*o]};ol.tilegrid.TileGrid.prototype.getTileCoordExtent=function(e,t){var o=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=ol.size.toSize(this.getTileSize(e[0]),this.tmpSize_),n=o[0]+e[1]*i[0]*r,a=o[1]+e[2]*i[1]*r,l=n+i[0]*r,s=a+i[1]*r;return ol.extent.createOrUpdate(n,a,l,s,t)};ol.tilegrid.TileGrid.prototype.getTileCoordForCoordAndResolution=function(e,t,o){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,o)};ol.tilegrid.TileGrid.prototype.getTileCoordForXYAndResolution_=function(e,t,o,r,i){var n=this.getZForResolution(o),a=o/this.getResolution(n),l=this.getOrigin(n),s=ol.size.toSize(this.getTileSize(n),this.tmpSize_),p=r?.5:0,c=r?0:.5,u=Math.floor((e-l[0])/o+p),g=Math.floor((t-l[1])/o+c),d=a*u/s[0],h=a*g/s[1];if(r){d=Math.ceil(d)-1;h=Math.ceil(h)-1}else{d=Math.floor(d);h=Math.floor(h)}return ol.tilecoord.createOrUpdate(n,d,h,i)};ol.tilegrid.TileGrid.prototype.getTileCoordForCoordAndZ=function(e,t,o){var r=this.getResolution(t);return this.getTileCoordForXYAndResolution_(e[0],e[1],r,!1,o)};ol.tilegrid.TileGrid.prototype.getTileCoordResolution=function(e){return this.resolutions_[e[0]]};ol.tilegrid.TileGrid.prototype.getTileSize=function(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]};ol.tilegrid.TileGrid.prototype.getFullTileRange=function(e){return this.fullTileRanges_?this.fullTileRanges_[e]:null};ol.tilegrid.TileGrid.prototype.getZForResolution=function(e,t){var o=ol.array.linearFindNearest(this.resolutions_,e,t||0);return ol.math.clamp(o,this.minZoom,this.maxZoom)};ol.tilegrid.TileGrid.prototype.calculateTileRanges_=function(e){for(var t=this.resolutions_.length,o=new Array(t),r=this.minZoom;t>r;++r)o[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=o};goog.provide("ol.tilegrid");goog.require("ol");goog.require("ol.size");goog.require("ol.extent");goog.require("ol.extent.Corner");goog.require("ol.obj");goog.require("ol.proj");goog.require("ol.proj.Units");goog.require("ol.tilegrid.TileGrid");ol.tilegrid.getForProjection=function(e){var t=e.getDefaultTileGrid();if(!t){t=ol.tilegrid.createForProjection(e);e.setDefaultTileGrid(t)}return t};ol.tilegrid.wrapX=function(e,t,o){var r=t[0],i=e.getTileCoordCenter(t),n=ol.tilegrid.extentFromProjection(o);if(ol.extent.containsCoordinate(n,i))return t;var a=ol.extent.getWidth(n),l=Math.ceil((n[0]-i[0])/a);i[0]+=a*l;return e.getTileCoordForCoordAndZ(i,r)};ol.tilegrid.createForExtent=function(e,t,o,r){var i=void 0!==r?r:ol.extent.Corner.TOP_LEFT,n=ol.tilegrid.resolutionsFromExtent(e,t,o);return new ol.tilegrid.TileGrid({extent:e,origin:ol.extent.getCorner(e,i),resolutions:n,tileSize:o})};ol.tilegrid.createXYZ=function(e){var t={};ol.obj.assign(t,void 0!==e?e:{});void 0===t.extent&&(t.extent=ol.proj.get("EPSG:3857").getExtent());t.resolutions=ol.tilegrid.resolutionsFromExtent(t.extent,t.maxZoom,t.tileSize);delete t.maxZoom;return new ol.tilegrid.TileGrid(t)};ol.tilegrid.resolutionsFromExtent=function(e,t,o){for(var r=void 0!==t?t:ol.DEFAULT_MAX_ZOOM,i=ol.extent.getHeight(e),n=ol.extent.getWidth(e),a=ol.size.toSize(void 0!==o?o:ol.DEFAULT_TILE_SIZE),l=Math.max(n/a[0],i/a[1]),s=r+1,p=new Array(s),c=0;s>c;++c)p[c]=l/Math.pow(2,c);return p};ol.tilegrid.createForProjection=function(e,t,o,r){var i=ol.tilegrid.extentFromProjection(e);return ol.tilegrid.createForExtent(i,t,o,r)};ol.tilegrid.extentFromProjection=function(e){e=ol.proj.get(e);var t=e.getExtent();if(!t){var o=180*ol.proj.METERS_PER_UNIT[ol.proj.Units.DEGREES]/e.getMetersPerUnit();t=ol.extent.createOrUpdate(-o,-o,o,o)}return t};goog.provide("ol.Attribution");goog.require("ol.TileRange");goog.require("ol.math");goog.require("ol.tilegrid");ol.Attribution=function(e){this.html_=e.html;this.tileRanges_=e.tileRanges?e.tileRanges:null};ol.Attribution.prototype.getHTML=function(){return this.html_};ol.Attribution.prototype.intersectsAnyTileRange=function(e,t,o){if(!this.tileRanges_)return!0;var r,i,n,a;for(a in e)if(a in this.tileRanges_){n=e[a];var l;for(r=0,i=this.tileRanges_[a].length;i>r;++r){l=this.tileRanges_[a][r];if(l.intersects(n))return!0;var s=t.getTileRangeForExtentAndZ(ol.tilegrid.extentFromProjection(o),parseInt(a,10)),p=s.getWidth();if(n.minX<s.minX||n.maxX>s.maxX){if(l.intersects(new ol.TileRange(ol.math.modulo(n.minX,p),ol.math.modulo(n.maxX,p),n.minY,n.maxY)))return!0;if(n.getWidth()>p&&l.intersects(s))return!0}}}return!1};goog.provide("ol.CenterConstraint");goog.require("ol.math");ol.CenterConstraint.createExtent=function(e){return function(t){return t?[ol.math.clamp(t[0],e[0],e[2]),ol.math.clamp(t[1],e[1],e[3])]:void 0}};ol.CenterConstraint.none=function(e){return e};goog.provide("ol.CollectionEventType");ol.CollectionEventType={ADD:"add",REMOVE:"remove"};goog.provide("ol.ObjectEventType");ol.ObjectEventType={PROPERTYCHANGE:"propertychange"};goog.provide("ol.events");goog.require("ol.obj");ol.events.bindListener_=function(e){var t=function(t){var o=e.listener,r=e.bindTo||e.target;e.callOnce&&ol.events.unlistenByKey(e);return o.call(r,t)};e.boundListener=t;return t};ol.events.findListener_=function(e,t,o,r){for(var i,n=0,a=e.length;a>n;++n){i=e[n];if(i.listener===t&&i.bindTo===o){r&&(i.deleteIndex=n);return i}}return void 0};ol.events.getListeners=function(e,t){var o=e.ol_lm;return o?o[t]:void 0};ol.events.getListenerMap_=function(e){var t=e.ol_lm;t||(t=e.ol_lm={});return t};ol.events.removeListeners_=function(e,t){var o=ol.events.getListeners(e,t);if(o){for(var r=0,i=o.length;i>r;++r){e.removeEventListener(t,o[r].boundListener);ol.obj.clear(o[r])}o.length=0;var n=e.ol_lm;if(n){delete n[t];0===Object.keys(n).length&&delete e.ol_lm}}};ol.events.listen=function(e,t,o,r,i){var n=ol.events.getListenerMap_(e),a=n[t];a||(a=n[t]=[]);var l=ol.events.findListener_(a,o,r,!1);if(l)i||(l.callOnce=!1);else{l={bindTo:r,callOnce:!!i,listener:o,target:e,type:t};e.addEventListener(t,ol.events.bindListener_(l));a.push(l)}return l};ol.events.listenOnce=function(e,t,o,r){return ol.events.listen(e,t,o,r,!0)};ol.events.unlisten=function(e,t,o,r){var i=ol.events.getListeners(e,t);if(i){var n=ol.events.findListener_(i,o,r,!0);n&&ol.events.unlistenByKey(n)}};ol.events.unlistenByKey=function(e){if(e&&e.target){e.target.removeEventListener(e.type,e.boundListener);var t=ol.events.getListeners(e.target,e.type);if(t){var o="deleteIndex"in e?e.deleteIndex:t.indexOf(e);-1!==o&&t.splice(o,1);0===t.length&&ol.events.removeListeners_(e.target,e.type)}ol.obj.clear(e)}};ol.events.unlistenAll=function(e){var t=ol.events.getListenerMap_(e);for(var o in t)ol.events.removeListeners_(e,o)};goog.provide("ol.Disposable");goog.require("ol");ol.Disposable=function(){};ol.Disposable.prototype.disposed_=!1;ol.Disposable.prototype.dispose=function(){if(!this.disposed_){this.disposed_=!0;this.disposeInternal()}};ol.Disposable.prototype.disposeInternal=ol.nullFunction;goog.provide("ol.events.Event");ol.events.Event=function(e){this.propagationStopped;this.type=e;this.target=null};ol.events.Event.prototype.preventDefault=ol.events.Event.prototype.stopPropagation=function(){this.propagationStopped=!0};ol.events.Event.stopPropagation=function(e){e.stopPropagation()};ol.events.Event.preventDefault=function(e){e.preventDefault()};goog.provide("ol.events.EventTarget");goog.require("ol");goog.require("ol.Disposable");goog.require("ol.events");goog.require("ol.events.Event");ol.events.EventTarget=function(){ol.Disposable.call(this);this.pendingRemovals_={};this.dispatching_={};this.listeners_={}};ol.inherits(ol.events.EventTarget,ol.Disposable);ol.events.EventTarget.prototype.addEventListener=function(e,t){var o=this.listeners_[e];o||(o=this.listeners_[e]=[]);-1===o.indexOf(t)&&o.push(t)};ol.events.EventTarget.prototype.dispatchEvent=function(e){var t="string"==typeof e?new ol.events.Event(e):e,o=t.type;t.target=this;var r,i=this.listeners_[o];if(i){if(!(o in this.dispatching_)){this.dispatching_[o]=0;this.pendingRemovals_[o]=0}++this.dispatching_[o];for(var n=0,a=i.length;a>n;++n)if(i[n].call(this,t)===!1||t.propagationStopped){r=!1;break}--this.dispatching_[o];if(0===this.dispatching_[o]){var l=this.pendingRemovals_[o];delete this.pendingRemovals_[o];for(;l--;)this.removeEventListener(o,ol.nullFunction);delete this.dispatching_[o]}return r}};ol.events.EventTarget.prototype.disposeInternal=function(){ol.events.unlistenAll(this)};ol.events.EventTarget.prototype.getListeners=function(e){return this.listeners_[e]};ol.events.EventTarget.prototype.hasListener=function(e){return e?e in this.listeners_:Object.keys(this.listeners_).length>0};ol.events.EventTarget.prototype.removeEventListener=function(e,t){var o=this.listeners_[e];if(o){var r=o.indexOf(t);if(e in this.pendingRemovals_){o[r]=ol.nullFunction;++this.pendingRemovals_[e]}else{o.splice(r,1);0===o.length&&delete this.listeners_[e]}}};goog.provide("ol.events.EventType");ol.events.EventType={CHANGE:"change",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",ERROR:"error",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout",MOUSEUP:"mouseup",MOUSEWHEEL:"mousewheel",MSPOINTERDOWN:"MSPointerDown",RESIZE:"resize",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",WHEEL:"wheel"};goog.provide("ol.Observable");goog.require("ol");goog.require("ol.events");goog.require("ol.events.EventTarget");goog.require("ol.events.EventType");ol.Observable=function(){ol.events.EventTarget.call(this);this.revision_=0};ol.inherits(ol.Observable,ol.events.EventTarget);ol.Observable.unByKey=function(e){if(Array.isArray(e))for(var t=0,o=e.length;o>t;++t)ol.events.unlistenByKey(e[t]);else ol.events.unlistenByKey(e)};ol.Observable.prototype.changed=function(){++this.revision_;this.dispatchEvent(ol.events.EventType.CHANGE)};ol.Observable.prototype.dispatchEvent;ol.Observable.prototype.getRevision=function(){return this.revision_};ol.Observable.prototype.on=function(e,t,o){if(Array.isArray(e)){for(var r=e.length,i=new Array(r),n=0;r>n;++n)i[n]=ol.events.listen(this,e[n],t,o);return i}return ol.events.listen(this,e,t,o)};ol.Observable.prototype.once=function(e,t,o){if(Array.isArray(e)){for(var r=e.length,i=new Array(r),n=0;r>n;++n)i[n]=ol.events.listenOnce(this,e[n],t,o);return i}return ol.events.listenOnce(this,e,t,o)};ol.Observable.prototype.un=function(e,t,o){if(Array.isArray(e))for(var r=0,i=e.length;i>r;++r)ol.events.unlisten(this,e[r],t,o);else ol.events.unlisten(this,e,t,o)};goog.provide("ol.Object");goog.require("ol");goog.require("ol.ObjectEventType");goog.require("ol.Observable");goog.require("ol.events.Event");goog.require("ol.obj");ol.Object=function(e){ol.Observable.call(this);ol.getUid(this);this.values_={};void 0!==e&&this.setProperties(e)};ol.inherits(ol.Object,ol.Observable);ol.Object.changeEventTypeCache_={};ol.Object.getChangeEventType=function(e){return ol.Object.changeEventTypeCache_.hasOwnProperty(e)?ol.Object.changeEventTypeCache_[e]:ol.Object.changeEventTypeCache_[e]="change:"+e};ol.Object.prototype.get=function(e){var t;this.values_.hasOwnProperty(e)&&(t=this.values_[e]);return t};ol.Object.prototype.getKeys=function(){return Object.keys(this.values_)};ol.Object.prototype.getProperties=function(){return ol.obj.assign({},this.values_)};ol.Object.prototype.notify=function(e,t){var o;o=ol.Object.getChangeEventType(e);this.dispatchEvent(new ol.Object.Event(o,e,t));o=ol.ObjectEventType.PROPERTYCHANGE;this.dispatchEvent(new ol.Object.Event(o,e,t))};ol.Object.prototype.set=function(e,t,o){if(o)this.values_[e]=t;else{var r=this.values_[e];this.values_[e]=t;r!==t&&this.notify(e,r)}};ol.Object.prototype.setProperties=function(e,t){var o;for(o in e)this.set(o,e[o],t)};ol.Object.prototype.unset=function(e,t){if(e in this.values_){var o=this.values_[e];delete this.values_[e];t||this.notify(e,o)}};ol.Object.Event=function(e,t,o){ol.events.Event.call(this,e);this.key=t;this.oldValue=o};ol.inherits(ol.Object.Event,ol.events.Event);goog.provide("ol.Collection");goog.require("ol");goog.require("ol.AssertionError");goog.require("ol.CollectionEventType");goog.require("ol.Object");goog.require("ol.events.Event");ol.Collection=function(e,t){ol.Object.call(this);var o=t||{};this.unique_=!!o.unique;this.array_=e?e:[];if(this.unique_)for(var r=0,i=this.array_.length;i>r;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()};ol.inherits(ol.Collection,ol.Object);ol.Collection.prototype.clear=function(){for(;this.getLength()>0;)this.pop()};ol.Collection.prototype.extend=function(e){var t,o;for(t=0,o=e.length;o>t;++t)this.push(e[t]);return this};ol.Collection.prototype.forEach=function(e,t){this.array_.forEach(e,t)};ol.Collection.prototype.getArray=function(){return this.array_};ol.Collection.prototype.item=function(e){return this.array_[e]};ol.Collection.prototype.getLength=function(){return this.get(ol.Collection.Property_.LENGTH)};ol.Collection.prototype.insertAt=function(e,t){this.unique_&&this.assertUnique_(t);this.array_.splice(e,0,t);this.updateLength_();this.dispatchEvent(new ol.Collection.Event(ol.CollectionEventType.ADD,t))};ol.Collection.prototype.pop=function(){return this.removeAt(this.getLength()-1)};ol.Collection.prototype.push=function(e){this.unique_&&this.assertUnique_(e);var t=this.getLength();this.insertAt(t,e);return this.getLength()};ol.Collection.prototype.remove=function(e){var t,o,r=this.array_;for(t=0,o=r.length;o>t;++t)if(r[t]===e)return this.removeAt(t);return void 0};ol.Collection.prototype.removeAt=function(e){var t=this.array_[e];this.array_.splice(e,1);this.updateLength_();this.dispatchEvent(new ol.Collection.Event(ol.CollectionEventType.REMOVE,t));return t};ol.Collection.prototype.setAt=function(e,t){var o=this.getLength();if(o>e){this.unique_&&this.assertUnique_(t,e);var r=this.array_[e];this.array_[e]=t;this.dispatchEvent(new ol.Collection.Event(ol.CollectionEventType.REMOVE,r));this.dispatchEvent(new ol.Collection.Event(ol.CollectionEventType.ADD,t))}else{var i;for(i=o;e>i;++i)this.insertAt(i,void 0);this.insertAt(e,t)}};ol.Collection.prototype.updateLength_=function(){this.set(ol.Collection.Property_.LENGTH,this.array_.length)};ol.Collection.prototype.assertUnique_=function(e,t){for(var o=0,r=this.array_.length;r>o;++o)if(this.array_[o]===e&&o!==t)throw new ol.AssertionError(58)};ol.Collection.Property_={LENGTH:"length"};ol.Collection.Event=function(e,t){ol.events.Event.call(this,e);this.element=t};ol.inherits(ol.Collection.Event,ol.events.Event);goog.provide("ol.color");goog.require("ol.asserts");goog.require("ol.math");ol.color.HEX_COLOR_RE_=/^#(?:[0-9a-f]{3}){1,2}$/i;ol.color.NAMED_COLOR_RE_=/^([a-z]*)$/i;ol.color.asArray=function(e){return Array.isArray(e)?e:ol.color.fromString(e)};ol.color.asString=function(e){return"string"==typeof e?e:ol.color.toString(e)};ol.color.fromNamed=function(e){var t=document.createElement("div");t.style.color=e;document.body.appendChild(t);var o=getComputedStyle(t).color;document.body.removeChild(t);return o};ol.color.fromString=function(){var e=1024,t={},o=0;return function(r){var i;if(t.hasOwnProperty(r))i=t[r];else{if(o>=e){var n,a=0;for(n in t)if(0===(3&a++)){delete t[n];--o}}i=ol.color.fromStringInternal_(r);t[r]=i;++o}return i}}();ol.color.fromStringInternal_=function(e){var t,o,r,i,n,a;ol.color.NAMED_COLOR_RE_.exec(e)&&(e=ol.color.fromNamed(e));if(ol.color.HEX_COLOR_RE_.exec(e)){var l=e.length-1;ol.asserts.assert(3==l||6==l,54);var s=3==l?1:2;t=parseInt(e.substr(1+0*s,s),16);o=parseInt(e.substr(1+1*s,s),16);r=parseInt(e.substr(1+2*s,s),16);if(1==s){t=(t<<4)+t;o=(o<<4)+o;r=(r<<4)+r}i=1;n=[t,o,r,i]}else if(0==e.indexOf("rgba(")){a=e.slice(5,-1).split(",").map(Number);n=ol.color.normalize(a)}else if(0==e.indexOf("rgb(")){a=e.slice(4,-1).split(",").map(Number);a.push(1);n=ol.color.normalize(a)}else ol.asserts.assert(!1,14);return n};ol.color.normalize=function(e,t){var o=t||[];o[0]=ol.math.clamp(e[0]+.5|0,0,255);o[1]=ol.math.clamp(e[1]+.5|0,0,255);o[2]=ol.math.clamp(e[2]+.5|0,0,255);o[3]=ol.math.clamp(e[3],0,1);return o};ol.color.toString=function(e){var t=e[0];t!=(0|t)&&(t=t+.5|0);var o=e[1];o!=(0|o)&&(o=o+.5|0);var r=e[2];r!=(0|r)&&(r=r+.5|0);var i=void 0===e[3]?1:e[3];return"rgba("+t+","+o+","+r+","+i+")"};goog.provide("ol.colorlike");goog.require("ol.color");ol.colorlike.asColorLike=function(e){return ol.colorlike.isColorLike(e)?e:ol.color.asString(e)};ol.colorlike.isColorLike=function(e){return"string"==typeof e||e instanceof CanvasPattern||e instanceof CanvasGradient};goog.provide("ol.Constraints");ol.Constraints=function(e,t,o){this.center=e;this.resolution=t;this.rotation=o};goog.provide("ol.dom");ol.dom.createCanvasContext2D=function(e,t){var o=document.createElement("CANVAS");e&&(o.width=e);t&&(o.height=t);return o.getContext("2d")};ol.dom.outerWidth=function(e){var t=e.offsetWidth,o=getComputedStyle(e);t+=parseInt(o.marginLeft,10)+parseInt(o.marginRight,10);return t};ol.dom.outerHeight=function(e){var t=e.offsetHeight,o=getComputedStyle(e);t+=parseInt(o.marginTop,10)+parseInt(o.marginBottom,10);return t};ol.dom.replaceNode=function(e,t){var o=t.parentNode;o&&o.replaceChild(e,t)};ol.dom.removeNode=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null};ol.dom.removeChildren=function(e){for(;e.lastChild;)e.removeChild(e.lastChild)};goog.provide("ol.MapEventType");ol.MapEventType={POSTRENDER:"postrender",MOVEEND:"moveend"};goog.provide("ol.control.Control");goog.require("ol");goog.require("ol.MapEventType");goog.require("ol.Object");goog.require("ol.dom");goog.require("ol.events");ol.control.Control=function(e){ol.Object.call(this);this.element=e.element?e.element:null;this.target_=null;this.map_=null;this.listenerKeys=[];this.render=e.render?e.render:ol.nullFunction;e.target&&this.setTarget(e.target)};ol.inherits(ol.control.Control,ol.Object);ol.control.Control.prototype.disposeInternal=function(){ol.dom.removeNode(this.element);ol.Object.prototype.disposeInternal.call(this)};ol.control.Control.prototype.getMap=function(){return this.map_};ol.control.Control.prototype.setMap=function(e){this.map_&&ol.dom.removeNode(this.element);for(var t=0,o=this.listenerKeys.length;o>t;++t)ol.events.unlistenByKey(this.listenerKeys[t]);this.listenerKeys.length=0;this.map_=e;if(this.map_){var r=this.target_?this.target_:e.getOverlayContainerStopEvent();r.appendChild(this.element);this.render!==ol.nullFunction&&this.listenerKeys.push(ol.events.listen(e,ol.MapEventType.POSTRENDER,this.render,this));e.render()}};ol.control.Control.prototype.setTarget=function(e){this.target_="string"==typeof e?document.getElementById(e):e};goog.provide("ol.css");ol.css.CLASS_HIDDEN="ol-hidden";ol.css.CLASS_UNSELECTABLE="ol-unselectable";ol.css.CLASS_UNSUPPORTED="ol-unsupported";ol.css.CLASS_CONTROL="ol-control";goog.provide("ol.control.Attribution");goog.require("ol");goog.require("ol.dom");goog.require("ol.control.Control");goog.require("ol.css");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.obj");ol.control.Attribution=function(e){var t=e?e:{};this.ulElement_=document.createElement("UL");this.logoLi_=document.createElement("LI");this.ulElement_.appendChild(this.logoLi_);this.logoLi_.style.display="none";this.collapsed_=void 0!==t.collapsed?t.collapsed:!0;this.collapsible_=void 0!==t.collapsible?t.collapsible:!0;this.collapsible_||(this.collapsed_=!1);var o=void 0!==t.className?t.className:"ol-attribution",r=void 0!==t.tipLabel?t.tipLabel:"Attributions",i=void 0!==t.collapseLabel?t.collapseLabel:"\xbb";if("string"==typeof i){this.collapseLabel_=document.createElement("span");this.collapseLabel_.textContent=i}else this.collapseLabel_=i;var n=void 0!==t.label?t.label:"i";if("string"==typeof n){this.label_=document.createElement("span");this.label_.textContent=n}else this.label_=n;var a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,l=document.createElement("button");l.setAttribute("type","button");l.title=r;

l.appendChild(a);ol.events.listen(l,ol.events.EventType.CLICK,this.handleClick_,this);var s=o+" "+ol.css.CLASS_UNSELECTABLE+" "+ol.css.CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" ol-collapsed":"")+(this.collapsible_?"":" ol-uncollapsible"),p=document.createElement("div");p.className=s;p.appendChild(this.ulElement_);p.appendChild(l);var c=t.render?t.render:ol.control.Attribution.render;ol.control.Control.call(this,{element:p,render:c,target:t.target});this.renderedVisible_=!0;this.attributionElements_={};this.attributionElementRenderedVisible_={};this.logoElements_={}};ol.inherits(ol.control.Attribution,ol.control.Control);ol.control.Attribution.prototype.getSourceAttributions=function(e){var t,o,r,i,n,a,l,s,p,c,u,g=e.layerStatesArray,d=ol.obj.assign({},e.attributions),h={},f={},y=e.viewState.projection;for(t=0,o=g.length;o>t;t++){a=g[t].layer.getSource();if(a){c=ol.getUid(a).toString();p=a.getAttributions();if(p)for(r=0,i=p.length;i>r;r++){l=p[r];s=ol.getUid(l).toString();if(!(s in d)){n=e.usedTiles[c];if(n){var m=a.getTileGridForProjection(y);u=l.intersectsAnyTileRange(n,m,y)}else u=!1;if(u){s in h&&delete h[s];var v=l.getHTML();if(!(v in f)){f[v]=!0;d[s]=l}}else h[s]=l}}}}return[d,h]};ol.control.Attribution.render=function(e){this.updateElement_(e.frameState)};ol.control.Attribution.prototype.updateElement_=function(e){if(e){var t,o,r=this.getSourceAttributions(e),i=r[0],n=r[1];for(o in this.attributionElements_)if(o in i){if(!this.attributionElementRenderedVisible_[o]){this.attributionElements_[o].style.display="";this.attributionElementRenderedVisible_[o]=!0}delete i[o]}else if(o in n){if(this.attributionElementRenderedVisible_[o]){this.attributionElements_[o].style.display="none";delete this.attributionElementRenderedVisible_[o]}delete n[o]}else{ol.dom.removeNode(this.attributionElements_[o]);delete this.attributionElements_[o];delete this.attributionElementRenderedVisible_[o]}for(o in i){t=document.createElement("LI");t.innerHTML=i[o].getHTML();this.ulElement_.appendChild(t);this.attributionElements_[o]=t;this.attributionElementRenderedVisible_[o]=!0}for(o in n){t=document.createElement("LI");t.innerHTML=n[o].getHTML();t.style.display="none";this.ulElement_.appendChild(t);this.attributionElements_[o]=t}var a=!ol.obj.isEmpty(this.attributionElementRenderedVisible_)||!ol.obj.isEmpty(e.logos);if(this.renderedVisible_!=a){this.element.style.display=a?"":"none";this.renderedVisible_=a}a&&ol.obj.isEmpty(this.attributionElementRenderedVisible_)?this.element.classList.add("ol-logo-only"):this.element.classList.remove("ol-logo-only");this.insertLogos_(e)}else if(this.renderedVisible_){this.element.style.display="none";this.renderedVisible_=!1}};ol.control.Attribution.prototype.insertLogos_=function(e){var t,o=e.logos,r=this.logoElements_;for(t in r)if(!(t in o)){ol.dom.removeNode(r[t]);delete r[t]}var i,n,a;for(a in o){var l=o[a];if(l instanceof HTMLElement){this.logoLi_.appendChild(l);r[a]=l}if(!(a in r)){i=new Image;i.src=a;if(""===l)n=i;else{n=document.createElement("a");n.href=l;n.appendChild(i)}this.logoLi_.appendChild(n);r[a]=n}}this.logoLi_.style.display=ol.obj.isEmpty(o)?"none":""};ol.control.Attribution.prototype.handleClick_=function(e){e.preventDefault();this.handleToggle_()};ol.control.Attribution.prototype.handleToggle_=function(){this.element.classList.toggle("ol-collapsed");this.collapsed_?ol.dom.replaceNode(this.collapseLabel_,this.label_):ol.dom.replaceNode(this.label_,this.collapseLabel_);this.collapsed_=!this.collapsed_};ol.control.Attribution.prototype.getCollapsible=function(){return this.collapsible_};ol.control.Attribution.prototype.setCollapsible=function(e){if(this.collapsible_!==e){this.collapsible_=e;this.element.classList.toggle("ol-uncollapsible");!e&&this.collapsed_&&this.handleToggle_()}};ol.control.Attribution.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()};ol.control.Attribution.prototype.getCollapsed=function(){return this.collapsed_};goog.provide("ol.easing");ol.easing.easeIn=function(e){return Math.pow(e,3)};ol.easing.easeOut=function(e){return 1-ol.easing.easeIn(1-e)};ol.easing.inAndOut=function(e){return 3*e*e-2*e*e*e};ol.easing.linear=function(e){return e};ol.easing.upAndDown=function(e){return.5>e?ol.easing.inAndOut(2*e):1-ol.easing.inAndOut(2*(e-.5))};goog.provide("ol.control.Rotate");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol");goog.require("ol.control.Control");goog.require("ol.css");goog.require("ol.easing");ol.control.Rotate=function(e){var t=e?e:{},o=void 0!==t.className?t.className:"ol-rotate",r=void 0!==t.label?t.label:"\u21e7";this.label_=null;if("string"==typeof r){this.label_=document.createElement("span");this.label_.className="ol-compass";this.label_.textContent=r}else{this.label_=r;this.label_.classList.add("ol-compass")}var i=t.tipLabel?t.tipLabel:"Reset rotation",n=document.createElement("button");n.className=o+"-reset";n.setAttribute("type","button");n.title=i;n.appendChild(this.label_);ol.events.listen(n,ol.events.EventType.CLICK,ol.control.Rotate.prototype.handleClick_,this);var a=o+" "+ol.css.CLASS_UNSELECTABLE+" "+ol.css.CLASS_CONTROL,l=document.createElement("div");l.className=a;l.appendChild(n);var s=t.render?t.render:ol.control.Rotate.render;this.callResetNorth_=t.resetNorth?t.resetNorth:void 0;ol.control.Control.call(this,{element:l,render:s,target:t.target});this.duration_=void 0!==t.duration?t.duration:250;this.autoHide_=void 0!==t.autoHide?t.autoHide:!0;this.rotation_=void 0;this.autoHide_&&this.element.classList.add(ol.css.CLASS_HIDDEN)};ol.inherits(ol.control.Rotate,ol.control.Control);ol.control.Rotate.prototype.handleClick_=function(e){e.preventDefault();void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()};ol.control.Rotate.prototype.resetNorth_=function(){var e=this.getMap(),t=e.getView();t&&void 0!==t.getRotation()&&(this.duration_>0?t.animate({rotation:0,duration:this.duration_,easing:ol.easing.easeOut}):t.setRotation(0))};ol.control.Rotate.render=function(e){var t=e.frameState;if(t){var o=t.viewState.rotation;if(o!=this.rotation_){var r="rotate("+o+"rad)";if(this.autoHide_){var i=this.element.classList.contains(ol.css.CLASS_HIDDEN);i||0!==o?i&&0!==o&&this.element.classList.remove(ol.css.CLASS_HIDDEN):this.element.classList.add(ol.css.CLASS_HIDDEN)}this.label_.style.msTransform=r;this.label_.style.webkitTransform=r;this.label_.style.transform=r}this.rotation_=o}};goog.provide("ol.control.Zoom");goog.require("ol");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.control.Control");goog.require("ol.css");goog.require("ol.easing");ol.control.Zoom=function(e){var t=e?e:{},o=void 0!==t.className?t.className:"ol-zoom",r=void 0!==t.delta?t.delta:1,i=void 0!==t.zoomInLabel?t.zoomInLabel:"+",n=void 0!==t.zoomOutLabel?t.zoomOutLabel:"\u2212",a=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",l=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",s=document.createElement("button");s.className=o+"-in";s.setAttribute("type","button");s.title=a;s.appendChild("string"==typeof i?document.createTextNode(i):i);ol.events.listen(s,ol.events.EventType.CLICK,ol.control.Zoom.prototype.handleClick_.bind(this,r));var p=document.createElement("button");p.className=o+"-out";p.setAttribute("type","button");p.title=l;p.appendChild("string"==typeof n?document.createTextNode(n):n);ol.events.listen(p,ol.events.EventType.CLICK,ol.control.Zoom.prototype.handleClick_.bind(this,-r));var c=o+" "+ol.css.CLASS_UNSELECTABLE+" "+ol.css.CLASS_CONTROL,u=document.createElement("div");u.className=c;u.appendChild(s);u.appendChild(p);ol.control.Control.call(this,{element:u,target:t.target});this.duration_=void 0!==t.duration?t.duration:250};ol.inherits(ol.control.Zoom,ol.control.Control);ol.control.Zoom.prototype.handleClick_=function(e,t){t.preventDefault();this.zoomByDelta_(e)};ol.control.Zoom.prototype.zoomByDelta_=function(e){var t=this.getMap(),o=t.getView();if(o){var r=o.getResolution();if(r){var i=o.constrainResolution(r,e);if(this.duration_>0){o.getAnimating()&&o.cancelAnimations();o.animate({resolution:i,duration:this.duration_,easing:ol.easing.easeOut})}else o.setResolution(i)}}};goog.provide("ol.control");goog.require("ol.Collection");goog.require("ol.control.Attribution");goog.require("ol.control.Rotate");goog.require("ol.control.Zoom");ol.control.defaults=function(e){var t=e?e:{},o=new ol.Collection,r=void 0!==t.zoom?t.zoom:!0;r&&o.push(new ol.control.Zoom(t.zoomOptions));var i=void 0!==t.rotate?t.rotate:!0;i&&o.push(new ol.control.Rotate(t.rotateOptions));var n=void 0!==t.attribution?t.attribution:!0;n&&o.push(new ol.control.Attribution(t.attributionOptions));return o};goog.provide("ol.control.FullScreen");goog.require("ol");goog.require("ol.control.Control");goog.require("ol.css");goog.require("ol.dom");goog.require("ol.events");goog.require("ol.events.EventType");ol.control.FullScreen=function(e){var t=e?e:{};this.cssClassName_=void 0!==t.className?t.className:"ol-full-screen";var o=void 0!==t.label?t.label:"\u2922";this.labelNode_="string"==typeof o?document.createTextNode(o):o;var r=void 0!==t.labelActive?t.labelActive:"\xd7";this.labelActiveNode_="string"==typeof r?document.createTextNode(r):r;var i=t.tipLabel?t.tipLabel:"Toggle full-screen",n=document.createElement("button");n.className=this.cssClassName_+"-"+ol.control.FullScreen.isFullScreen();n.setAttribute("type","button");n.title=i;n.appendChild(this.labelNode_);ol.events.listen(n,ol.events.EventType.CLICK,this.handleClick_,this);var a=this.cssClassName_+" "+ol.css.CLASS_UNSELECTABLE+" "+ol.css.CLASS_CONTROL+" "+(ol.control.FullScreen.isFullScreenSupported()?"":ol.css.CLASS_UNSUPPORTED),l=document.createElement("div");l.className=a;l.appendChild(n);ol.control.Control.call(this,{element:l,target:t.target});this.keys_=void 0!==t.keys?t.keys:!1;this.source_=t.source};ol.inherits(ol.control.FullScreen,ol.control.Control);ol.control.FullScreen.prototype.handleClick_=function(e){e.preventDefault();this.handleFullScreen_()};ol.control.FullScreen.prototype.handleFullScreen_=function(){if(ol.control.FullScreen.isFullScreenSupported()){var e=this.getMap();if(e)if(ol.control.FullScreen.isFullScreen())ol.control.FullScreen.exitFullScreen();else{var t;t=this.source_?"string"==typeof this.source_?document.getElementById(this.source_):this.source_:e.getTargetElement();this.keys_?ol.control.FullScreen.requestFullScreenWithKeys(t):ol.control.FullScreen.requestFullScreen(t)}}};ol.control.FullScreen.prototype.handleFullScreenChange_=function(){var e=this.element.firstElementChild,t=this.getMap();if(ol.control.FullScreen.isFullScreen()){e.className=this.cssClassName_+"-true";ol.dom.replaceNode(this.labelActiveNode_,this.labelNode_)}else{e.className=this.cssClassName_+"-false";ol.dom.replaceNode(this.labelNode_,this.labelActiveNode_)}t&&t.updateSize()};ol.control.FullScreen.prototype.setMap=function(e){ol.control.Control.prototype.setMap.call(this,e);e&&this.listenerKeys.push(ol.events.listen(document,ol.control.FullScreen.getChangeType_(),this.handleFullScreenChange_,this))};ol.control.FullScreen.isFullScreenSupported=function(){var e=document.body;return!!(e.webkitRequestFullscreen||e.mozRequestFullScreen&&document.mozFullScreenEnabled||e.msRequestFullscreen&&document.msFullscreenEnabled||e.requestFullscreen&&document.fullscreenEnabled)};ol.control.FullScreen.isFullScreen=function(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)};ol.control.FullScreen.requestFullScreen=function(e){e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()};ol.control.FullScreen.requestFullScreenWithKeys=function(e){e.mozRequestFullScreenWithKeys?e.mozRequestFullScreenWithKeys():e.webkitRequestFullscreen?e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):ol.control.FullScreen.requestFullScreen(e)};ol.control.FullScreen.exitFullScreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()};ol.control.FullScreen.getChangeType_=function(){var e;return function(){if(!e){var t=document.body;t.webkitRequestFullscreen?e="webkitfullscreenchange":t.mozRequestFullScreen?e="mozfullscreenchange":t.msRequestFullscreen?e="MSFullscreenChange":t.requestFullscreen&&(e="fullscreenchange")}return e}}();goog.provide("ol.control.MousePosition");goog.require("ol");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.Object");goog.require("ol.control.Control");goog.require("ol.proj");ol.control.MousePosition=function(e){var t=e?e:{},o=document.createElement("DIV");o.className=void 0!==t.className?t.className:"ol-mouse-position";var r=t.render?t.render:ol.control.MousePosition.render;ol.control.Control.call(this,{element:o,render:r,target:t.target});ol.events.listen(this,ol.Object.getChangeEventType(ol.control.MousePosition.Property_.PROJECTION),this.handleProjectionChanged_,this);t.coordinateFormat&&this.setCoordinateFormat(t.coordinateFormat);t.projection&&this.setProjection(ol.proj.get(t.projection));this.undefinedHTML_=void 0!==t.undefinedHTML?t.undefinedHTML:"";this.renderedHTML_=o.innerHTML;this.mapProjection_=null;this.transform_=null;this.lastMouseMovePixel_=null};ol.inherits(ol.control.MousePosition,ol.control.Control);ol.control.MousePosition.render=function(e){var t=e.frameState;if(t){if(this.mapProjection_!=t.viewState.projection){this.mapProjection_=t.viewState.projection;this.transform_=null}}else this.mapProjection_=null;this.updateHTML_(this.lastMouseMovePixel_)};ol.control.MousePosition.prototype.handleProjectionChanged_=function(){this.transform_=null};ol.control.MousePosition.prototype.getCoordinateFormat=function(){return this.get(ol.control.MousePosition.Property_.COORDINATE_FORMAT)};ol.control.MousePosition.prototype.getProjection=function(){return this.get(ol.control.MousePosition.Property_.PROJECTION)};ol.control.MousePosition.prototype.handleMouseMove=function(e){var t=this.getMap();this.lastMouseMovePixel_=t.getEventPixel(e);this.updateHTML_(this.lastMouseMovePixel_)};ol.control.MousePosition.prototype.handleMouseOut=function(e){this.updateHTML_(null);this.lastMouseMovePixel_=null};ol.control.MousePosition.prototype.setMap=function(e){ol.control.Control.prototype.setMap.call(this,e);if(e){var t=e.getViewport();this.listenerKeys.push(ol.events.listen(t,ol.events.EventType.MOUSEMOVE,this.handleMouseMove,this),ol.events.listen(t,ol.events.EventType.MOUSEOUT,this.handleMouseOut,this))}};ol.control.MousePosition.prototype.setCoordinateFormat=function(e){this.set(ol.control.MousePosition.Property_.COORDINATE_FORMAT,e)};ol.control.MousePosition.prototype.setProjection=function(e){this.set(ol.control.MousePosition.Property_.PROJECTION,e)};ol.control.MousePosition.prototype.updateHTML_=function(e){var t=this.undefinedHTML_;if(e&&this.mapProjection_){if(!this.transform_){var o=this.getProjection();this.transform_=o?ol.proj.getTransformFromProjections(this.mapProjection_,o):ol.proj.identityTransform}var r=this.getMap(),i=r.getCoordinateFromPixel(e);if(i){this.transform_(i,i);var n=this.getCoordinateFormat();t=n?n(i):i.toString()}}if(!this.renderedHTML_||t!=this.renderedHTML_){this.element.innerHTML=t;this.renderedHTML_=t}};ol.control.MousePosition.Property_={PROJECTION:"projection",COORDINATE_FORMAT:"coordinateFormat"};goog.provide("ol.MapEvent");goog.require("ol");goog.require("ol.events.Event");ol.MapEvent=function(e,t,o){ol.events.Event.call(this,e);this.map=t;this.frameState=void 0!==o?o:null};ol.inherits(ol.MapEvent,ol.events.Event);goog.provide("ol.MapBrowserEvent");goog.require("ol");goog.require("ol.MapEvent");ol.MapBrowserEvent=function(e,t,o,r,i){ol.MapEvent.call(this,e,t,i);this.originalEvent=o;this.pixel=t.getEventPixel(o);this.coordinate=t.getCoordinateFromPixel(this.pixel);this.dragging=void 0!==r?r:!1};ol.inherits(ol.MapBrowserEvent,ol.MapEvent);ol.MapBrowserEvent.prototype.preventDefault=function(){ol.MapEvent.prototype.preventDefault.call(this);this.originalEvent.preventDefault()};ol.MapBrowserEvent.prototype.stopPropagation=function(){ol.MapEvent.prototype.stopPropagation.call(this);this.originalEvent.stopPropagation()};goog.provide("ol.MapBrowserEventType");goog.require("ol.events.EventType");ol.MapBrowserEventType={SINGLECLICK:"singleclick",CLICK:ol.events.EventType.CLICK,DBLCLICK:ol.events.EventType.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};goog.provide("ol.MapBrowserPointerEvent");goog.require("ol");goog.require("ol.MapBrowserEvent");ol.MapBrowserPointerEvent=function(e,t,o,r,i){ol.MapBrowserEvent.call(this,e,t,o.originalEvent,r,i);this.pointerEvent=o};ol.inherits(ol.MapBrowserPointerEvent,ol.MapBrowserEvent);goog.provide("ol.pointer.EventType");ol.pointer.EventType={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};goog.provide("ol.webgl");goog.require("ol");if(ol.ENABLE_WEBGL){ol.webgl.ONE=1;ol.webgl.SRC_ALPHA=770;ol.webgl.COLOR_ATTACHMENT0=36064;ol.webgl.COLOR_BUFFER_BIT=16384;ol.webgl.TRIANGLES=4;ol.webgl.TRIANGLE_STRIP=5;ol.webgl.ONE_MINUS_SRC_ALPHA=771;ol.webgl.ARRAY_BUFFER=34962;ol.webgl.ELEMENT_ARRAY_BUFFER=34963;ol.webgl.STREAM_DRAW=35040;ol.webgl.STATIC_DRAW=35044;ol.webgl.DYNAMIC_DRAW=35048;ol.webgl.CULL_FACE=2884;ol.webgl.BLEND=3042;ol.webgl.STENCIL_TEST=2960;ol.webgl.DEPTH_TEST=2929;ol.webgl.SCISSOR_TEST=3089;ol.webgl.UNSIGNED_BYTE=5121;ol.webgl.UNSIGNED_SHORT=5123;ol.webgl.UNSIGNED_INT=5125;ol.webgl.FLOAT=5126;ol.webgl.RGBA=6408;ol.webgl.FRAGMENT_SHADER=35632;ol.webgl.VERTEX_SHADER=35633;ol.webgl.LINK_STATUS=35714;ol.webgl.LINEAR=9729;ol.webgl.TEXTURE_MAG_FILTER=10240;ol.webgl.TEXTURE_MIN_FILTER=10241;ol.webgl.TEXTURE_WRAP_S=10242;ol.webgl.TEXTURE_WRAP_T=10243;ol.webgl.TEXTURE_2D=3553;ol.webgl.TEXTURE0=33984;ol.webgl.CLAMP_TO_EDGE=33071;ol.webgl.COMPILE_STATUS=35713;ol.webgl.FRAMEBUFFER=36160;ol.webgl.CONTEXT_IDS_=["experimental-webgl","webgl","webkit-3d","moz-webgl"];ol.webgl.getContext=function(e,t){var o,r,i=ol.webgl.CONTEXT_IDS_.length;for(r=0;i>r;++r)try{o=e.getContext(ol.webgl.CONTEXT_IDS_[r],t);if(o)return o}catch(n){}return null}}goog.provide("ol.has");goog.require("ol");goog.require("ol.webgl");var ua="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"";ol.has.FIREFOX=-1!==ua.indexOf("firefox");ol.has.SAFARI=-1!==ua.indexOf("safari")&&-1==ua.indexOf("chrom");ol.has.WEBKIT=-1!==ua.indexOf("webkit")&&-1==ua.indexOf("edge");ol.has.MAC=-1!==ua.indexOf("macintosh");ol.has.DEVICE_PIXEL_RATIO=window.devicePixelRatio||1;ol.has.CANVAS_LINE_DASH=!1;ol.has.CANVAS=ol.ENABLE_CANVAS&&function(){if(!("HTMLCanvasElement"in window))return!1;try{var e=document.createElement("CANVAS").getContext("2d");if(e){void 0!==e.setLineDash&&(ol.has.CANVAS_LINE_DASH=!0);return!0}return!1}catch(t){return!1}}();ol.has.DEVICE_ORIENTATION="DeviceOrientationEvent"in window;ol.has.GEOLOCATION="geolocation"in navigator;ol.has.TOUCH=ol.ASSUME_TOUCH||"ontouchstart"in window;ol.has.POINTER="PointerEvent"in window;ol.has.MSPOINTER=!!navigator.msPointerEnabled;ol.has.WEBGL;!function(){if(ol.ENABLE_WEBGL){var e,t=!1,o=[];if("WebGLRenderingContext"in window)try{var r=document.createElement("CANVAS"),i=ol.webgl.getContext(r,{failIfMajorPerformanceCaveat:!0});if(i){t=!0;e=i.getParameter(i.MAX_TEXTURE_SIZE);o=i.getSupportedExtensions()}}catch(n){}ol.has.WEBGL=t;ol.WEBGL_EXTENSIONS=o;ol.WEBGL_MAX_TEXTURE_SIZE=e}}();goog.provide("ol.pointer.EventSource");ol.pointer.EventSource=function(e,t){this.dispatcher=e;this.mapping_=t};ol.pointer.EventSource.prototype.getEvents=function(){return Object.keys(this.mapping_)};ol.pointer.EventSource.prototype.getMapping=function(){return this.mapping_};ol.pointer.EventSource.prototype.getHandlerForEvent=function(e){return this.mapping_[e]};goog.provide("ol.pointer.MouseSource");goog.require("ol");goog.require("ol.pointer.EventSource");ol.pointer.MouseSource=function(e){var t={mousedown:this.mousedown,mousemove:this.mousemove,mouseup:this.mouseup,mouseover:this.mouseover,mouseout:this.mouseout};ol.pointer.EventSource.call(this,e,t);this.pointerMap=e.pointerMap;this.lastTouches=[]};ol.inherits(ol.pointer.MouseSource,ol.pointer.EventSource);ol.pointer.MouseSource.POINTER_ID=1;ol.pointer.MouseSource.POINTER_TYPE="mouse";ol.pointer.MouseSource.DEDUP_DIST=25;ol.pointer.MouseSource.prototype.isEventSimulatedFromTouch_=function(e){for(var t,o=this.lastTouches,r=e.clientX,i=e.clientY,n=0,a=o.length;a>n&&(t=o[n]);n++){var l=Math.abs(r-t[0]),s=Math.abs(i-t[1]);if(l<=ol.pointer.MouseSource.DEDUP_DIST&&s<=ol.pointer.MouseSource.DEDUP_DIST)return!0}return!1};ol.pointer.MouseSource.prepareEvent=function(e,t){var o=t.cloneEvent(e,e),r=o.preventDefault;o.preventDefault=function(){e.preventDefault();r()};o.pointerId=ol.pointer.MouseSource.POINTER_ID;o.isPrimary=!0;o.pointerType=ol.pointer.MouseSource.POINTER_TYPE;return o};ol.pointer.MouseSource.prototype.mousedown=function(e){if(!this.isEventSimulatedFromTouch_(e)){ol.pointer.MouseSource.POINTER_ID.toString()in this.pointerMap&&this.cancel(e);var t=ol.pointer.MouseSource.prepareEvent(e,this.dispatcher);this.pointerMap[ol.pointer.MouseSource.POINTER_ID.toString()]=e;this.dispatcher.down(t,e)}};ol.pointer.MouseSource.prototype.mousemove=function(e){if(!this.isEventSimulatedFromTouch_(e)){var t=ol.pointer.MouseSource.prepareEvent(e,this.dispatcher);this.dispatcher.move(t,e)}};ol.pointer.MouseSource.prototype.mouseup=function(e){if(!this.isEventSimulatedFromTouch_(e)){var t=this.pointerMap[ol.pointer.MouseSource.POINTER_ID.toString()];if(t&&t.button===e.button){var o=ol.pointer.MouseSource.prepareEvent(e,this.dispatcher);this.dispatcher.up(o,e);this.cleanupMouse()}}};ol.pointer.MouseSource.prototype.mouseover=function(e){if(!this.isEventSimulatedFromTouch_(e)){var t=ol.pointer.MouseSource.prepareEvent(e,this.dispatcher);this.dispatcher.enterOver(t,e)}};ol.pointer.MouseSource.prototype.mouseout=function(e){if(!this.isEventSimulatedFromTouch_(e)){var t=ol.pointer.MouseSource.prepareEvent(e,this.dispatcher);this.dispatcher.leaveOut(t,e)}};ol.pointer.MouseSource.prototype.cancel=function(e){var t=ol.pointer.MouseSource.prepareEvent(e,this.dispatcher);this.dispatcher.cancel(t,e);this.cleanupMouse()};ol.pointer.MouseSource.prototype.cleanupMouse=function(){delete this.pointerMap[ol.pointer.MouseSource.POINTER_ID.toString()]};goog.provide("ol.pointer.MsSource");goog.require("ol");goog.require("ol.pointer.EventSource");ol.pointer.MsSource=function(e){var t={MSPointerDown:this.msPointerDown,MSPointerMove:this.msPointerMove,MSPointerUp:this.msPointerUp,MSPointerOut:this.msPointerOut,MSPointerOver:this.msPointerOver,MSPointerCancel:this.msPointerCancel,MSGotPointerCapture:this.msGotPointerCapture,MSLostPointerCapture:this.msLostPointerCapture};ol.pointer.EventSource.call(this,e,t);this.pointerMap=e.pointerMap;this.POINTER_TYPES=["","unavailable","touch","pen","mouse"]};ol.inherits(ol.pointer.MsSource,ol.pointer.EventSource);ol.pointer.MsSource.prototype.prepareEvent_=function(e){var t=e;if("number"==typeof e.pointerType){t=this.dispatcher.cloneEvent(e,e);t.pointerType=this.POINTER_TYPES[e.pointerType]}return t};ol.pointer.MsSource.prototype.cleanup=function(e){delete this.pointerMap[e.toString()]};ol.pointer.MsSource.prototype.msPointerDown=function(e){this.pointerMap[e.pointerId.toString()]=e;var t=this.prepareEvent_(e);this.dispatcher.down(t,e)};ol.pointer.MsSource.prototype.msPointerMove=function(e){var t=this.prepareEvent_(e);this.dispatcher.move(t,e)};ol.pointer.MsSource.prototype.msPointerUp=function(e){var t=this.prepareEvent_(e);this.dispatcher.up(t,e);this.cleanup(e.pointerId)};ol.pointer.MsSource.prototype.msPointerOut=function(e){var t=this.prepareEvent_(e);this.dispatcher.leaveOut(t,e)};ol.pointer.MsSource.prototype.msPointerOver=function(e){var t=this.prepareEvent_(e);this.dispatcher.enterOver(t,e)};ol.pointer.MsSource.prototype.msPointerCancel=function(e){var t=this.prepareEvent_(e);this.dispatcher.cancel(t,e);this.cleanup(e.pointerId)};ol.pointer.MsSource.prototype.msLostPointerCapture=function(e){var t=this.dispatcher.makeEvent("lostpointercapture",e,e);this.dispatcher.dispatchEvent(t)};ol.pointer.MsSource.prototype.msGotPointerCapture=function(e){var t=this.dispatcher.makeEvent("gotpointercapture",e,e);this.dispatcher.dispatchEvent(t)};goog.provide("ol.pointer.NativeSource");goog.require("ol");goog.require("ol.pointer.EventSource");ol.pointer.NativeSource=function(e){var t={pointerdown:this.pointerDown,pointermove:this.pointerMove,pointerup:this.pointerUp,pointerout:this.pointerOut,pointerover:this.pointerOver,pointercancel:this.pointerCancel,gotpointercapture:this.gotPointerCapture,lostpointercapture:this.lostPointerCapture};ol.pointer.EventSource.call(this,e,t)};ol.inherits(ol.pointer.NativeSource,ol.pointer.EventSource);ol.pointer.NativeSource.prototype.pointerDown=function(e){this.dispatcher.fireNativeEvent(e)};ol.pointer.NativeSource.prototype.pointerMove=function(e){this.dispatcher.fireNativeEvent(e)};ol.pointer.NativeSource.prototype.pointerUp=function(e){this.dispatcher.fireNativeEvent(e)};ol.pointer.NativeSource.prototype.pointerOut=function(e){this.dispatcher.fireNativeEvent(e)};ol.pointer.NativeSource.prototype.pointerOver=function(e){this.dispatcher.fireNativeEvent(e)};ol.pointer.NativeSource.prototype.pointerCancel=function(e){this.dispatcher.fireNativeEvent(e)};ol.pointer.NativeSource.prototype.lostPointerCapture=function(e){this.dispatcher.fireNativeEvent(e)};ol.pointer.NativeSource.prototype.gotPointerCapture=function(e){this.dispatcher.fireNativeEvent(e)};goog.provide("ol.pointer.PointerEvent");goog.require("ol");goog.require("ol.events.Event");ol.pointer.PointerEvent=function(e,t,o){ol.events.Event.call(this,e);this.originalEvent=t;var r=o?o:{};this.buttons=this.getButtons_(r);this.pressure=this.getPressure_(r,this.buttons);this.bubbles="bubbles"in r?r.bubbles:!1;this.cancelable="cancelable"in r?r.cancelable:!1;this.view="view"in r?r.view:null;this.detail="detail"in r?r.detail:null;this.screenX="screenX"in r?r.screenX:0;this.screenY="screenY"in r?r.screenY:0;this.clientX="clientX"in r?r.clientX:0;this.clientY="clientY"in r?r.clientY:0;this.ctrlKey="ctrlKey"in r?r.ctrlKey:!1;this.altKey="altKey"in r?r.altKey:!1;this.shiftKey="shiftKey"in r?r.shiftKey:!1;this.metaKey="metaKey"in r?r.metaKey:!1;this.button="button"in r?r.button:0;this.relatedTarget="relatedTarget"in r?r.relatedTarget:null;this.pointerId="pointerId"in r?r.pointerId:0;this.width="width"in r?r.width:0;this.height="height"in r?r.height:0;this.tiltX="tiltX"in r?r.tiltX:0;this.tiltY="tiltY"in r?r.tiltY:0;this.pointerType="pointerType"in r?r.pointerType:"";this.hwTimestamp="hwTimestamp"in r?r.hwTimestamp:0;this.isPrimary="isPrimary"in r?r.isPrimary:!1;t.preventDefault&&(this.preventDefault=function(){t.preventDefault()})};ol.inherits(ol.pointer.PointerEvent,ol.events.Event);ol.pointer.PointerEvent.prototype.getButtons_=function(e){var t;if(e.buttons||ol.pointer.PointerEvent.HAS_BUTTONS)t=e.buttons;else switch(e.which){case 1:t=1;break;case 2:t=4;break;case 3:t=2;break;default:t=0}return t};ol.pointer.PointerEvent.prototype.getPressure_=function(e,t){var o=0;o=e.pressure?e.pressure:t?.5:0;return o};ol.pointer.PointerEvent.HAS_BUTTONS=!1;!function(){try{var e=new MouseEvent("click",{buttons:1});ol.pointer.PointerEvent.HAS_BUTTONS=1===e.buttons}catch(t){}}();goog.provide("ol.pointer.TouchSource");goog.require("ol");goog.require("ol.array");goog.require("ol.pointer.EventSource");goog.require("ol.pointer.MouseSource");ol.pointer.TouchSource=function(e,t){var o={touchstart:this.touchstart,touchmove:this.touchmove,touchend:this.touchend,touchcancel:this.touchcancel};ol.pointer.EventSource.call(this,e,o);this.pointerMap=e.pointerMap;this.mouseSource=t;this.firstTouchId_=void 0;this.clickCount_=0;this.resetId_=void 0};ol.inherits(ol.pointer.TouchSource,ol.pointer.EventSource);ol.pointer.TouchSource.DEDUP_TIMEOUT=2500;ol.pointer.TouchSource.CLICK_COUNT_TIMEOUT=200;ol.pointer.TouchSource.POINTER_TYPE="touch";ol.pointer.TouchSource.prototype.isPrimaryTouch_=function(e){return this.firstTouchId_===e.identifier};ol.pointer.TouchSource.prototype.setPrimaryTouch_=function(e){var t=Object.keys(this.pointerMap).length;if(0===t||1===t&&ol.pointer.MouseSource.POINTER_ID.toString()in this.pointerMap){this.firstTouchId_=e.identifier;this.cancelResetClickCount_()}};ol.pointer.TouchSource.prototype.removePrimaryPointer_=function(e){if(e.isPrimary){this.firstTouchId_=void 0;this.resetClickCount_()}};ol.pointer.TouchSource.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),ol.pointer.TouchSource.CLICK_COUNT_TIMEOUT)};ol.pointer.TouchSource.prototype.resetClickCountHandler_=function(){this.clickCount_=0;this.resetId_=void 0};ol.pointer.TouchSource.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)};ol.pointer.TouchSource.prototype.touchToPointer_=function(e,t){var o=this.dispatcher.cloneEvent(e,t);o.pointerId=t.identifier+2;o.bubbles=!0;o.cancelable=!0;o.detail=this.clickCount_;o.button=0;o.buttons=1;o.width=t.webkitRadiusX||t.radiusX||0;o.height=t.webkitRadiusY||t.radiusY||0;o.pressure=t.webkitForce||t.force||.5;o.isPrimary=this.isPrimaryTouch_(t);o.pointerType=ol.pointer.TouchSource.POINTER_TYPE;o.clientX=t.clientX;o.clientY=t.clientY;o.screenX=t.screenX;o.screenY=t.screenY;return o};ol.pointer.TouchSource.prototype.processTouches_=function(e,t){function o(){e.preventDefault()}var r,i,n=Array.prototype.slice.call(e.changedTouches),a=n.length;for(r=0;a>r;++r){i=this.touchToPointer_(e,n[r]);i.preventDefault=o;t.call(this,e,i)}};ol.pointer.TouchSource.prototype.findTouch_=function(e,t){for(var o,r=e.length,i=0;r>i;i++){o=e[i];if(o.identifier===t)return!0}return!1};ol.pointer.TouchSource.prototype.vacuumTouches_=function(e){var t=e.touches,o=Object.keys(this.pointerMap),r=o.length;if(r>=t.length){var i,n,a,l=[];for(i=0;r>i;++i){n=o[i];a=this.pointerMap[n];n==ol.pointer.MouseSource.POINTER_ID||this.findTouch_(t,n-2)||l.push(a.out)}for(i=0;i<l.length;++i)this.cancelOut_(e,l[i])}};ol.pointer.TouchSource.prototype.touchstart=function(e){this.vacuumTouches_(e);this.setPrimaryTouch_(e.changedTouches[0]);this.dedupSynthMouse_(e);this.clickCount_++;this.processTouches_(e,this.overDown_)};ol.pointer.TouchSource.prototype.overDown_=function(e,t){this.pointerMap[t.pointerId]={target:t.target,out:t,outTarget:t.target};this.dispatcher.over(t,e);this.dispatcher.enter(t,e);this.dispatcher.down(t,e)};ol.pointer.TouchSource.prototype.touchmove=function(e){e.preventDefault();this.processTouches_(e,this.moveOverOut_)};ol.pointer.TouchSource.prototype.moveOverOut_=function(e,t){var o=t,r=this.pointerMap[o.pointerId];if(r){var i=r.out,n=r.outTarget;this.dispatcher.move(o,e);if(i&&n!==o.target){i.relatedTarget=o.target;o.relatedTarget=n;i.target=n;if(o.target){this.dispatcher.leaveOut(i,e);this.dispatcher.enterOver(o,e)}else{o.target=n;o.relatedTarget=null;this.cancelOut_(e,o)}}r.out=o;r.outTarget=o.target}};ol.pointer.TouchSource.prototype.touchend=function(e){this.dedupSynthMouse_(e);this.processTouches_(e,this.upOut_)};ol.pointer.TouchSource.prototype.upOut_=function(e,t){this.dispatcher.up(t,e);this.dispatcher.out(t,e);this.dispatcher.leave(t,e);this.cleanUpPointer_(t)};ol.pointer.TouchSource.prototype.touchcancel=function(e){this.processTouches_(e,this.cancelOut_)};ol.pointer.TouchSource.prototype.cancelOut_=function(e,t){
this.dispatcher.cancel(t,e);this.dispatcher.out(t,e);this.dispatcher.leave(t,e);this.cleanUpPointer_(t)};ol.pointer.TouchSource.prototype.cleanUpPointer_=function(e){delete this.pointerMap[e.pointerId];this.removePrimaryPointer_(e)};ol.pointer.TouchSource.prototype.dedupSynthMouse_=function(e){var t=this.mouseSource.lastTouches,o=e.changedTouches[0];if(this.isPrimaryTouch_(o)){var r=[o.clientX,o.clientY];t.push(r);setTimeout(function(){ol.array.remove(t,r)},ol.pointer.TouchSource.DEDUP_TIMEOUT)}};goog.provide("ol.pointer.PointerEventHandler");goog.require("ol");goog.require("ol.events");goog.require("ol.events.EventTarget");goog.require("ol.has");goog.require("ol.pointer.EventType");goog.require("ol.pointer.MouseSource");goog.require("ol.pointer.MsSource");goog.require("ol.pointer.NativeSource");goog.require("ol.pointer.PointerEvent");goog.require("ol.pointer.TouchSource");ol.pointer.PointerEventHandler=function(e){ol.events.EventTarget.call(this);this.element_=e;this.pointerMap={};this.eventMap_={};this.eventSourceList_=[];this.registerSources()};ol.inherits(ol.pointer.PointerEventHandler,ol.events.EventTarget);ol.pointer.PointerEventHandler.prototype.registerSources=function(){if(ol.has.POINTER)this.registerSource("native",new ol.pointer.NativeSource(this));else if(ol.has.MSPOINTER)this.registerSource("ms",new ol.pointer.MsSource(this));else{var e=new ol.pointer.MouseSource(this);this.registerSource("mouse",e);ol.has.TOUCH&&this.registerSource("touch",new ol.pointer.TouchSource(this,e))}this.register_()};ol.pointer.PointerEventHandler.prototype.registerSource=function(e,t){var o=t,r=o.getEvents();if(r){r.forEach(function(e){var t=o.getHandlerForEvent(e);t&&(this.eventMap_[e]=t.bind(o))},this);this.eventSourceList_.push(o)}};ol.pointer.PointerEventHandler.prototype.register_=function(){for(var e,t=this.eventSourceList_.length,o=0;t>o;o++){e=this.eventSourceList_[o];this.addEvents_(e.getEvents())}};ol.pointer.PointerEventHandler.prototype.unregister_=function(){for(var e,t=this.eventSourceList_.length,o=0;t>o;o++){e=this.eventSourceList_[o];this.removeEvents_(e.getEvents())}};ol.pointer.PointerEventHandler.prototype.eventHandler_=function(e){var t=e.type,o=this.eventMap_[t];o&&o(e)};ol.pointer.PointerEventHandler.prototype.addEvents_=function(e){e.forEach(function(e){ol.events.listen(this.element_,e,this.eventHandler_,this)},this)};ol.pointer.PointerEventHandler.prototype.removeEvents_=function(e){e.forEach(function(e){ol.events.unlisten(this.element_,e,this.eventHandler_,this)},this)};ol.pointer.PointerEventHandler.prototype.cloneEvent=function(e,t){for(var o,r={},i=0,n=ol.pointer.PointerEventHandler.CLONE_PROPS.length;n>i;i++){o=ol.pointer.PointerEventHandler.CLONE_PROPS[i][0];r[o]=e[o]||t[o]||ol.pointer.PointerEventHandler.CLONE_PROPS[i][1]}return r};ol.pointer.PointerEventHandler.prototype.down=function(e,t){this.fireEvent(ol.pointer.EventType.POINTERDOWN,e,t)};ol.pointer.PointerEventHandler.prototype.move=function(e,t){this.fireEvent(ol.pointer.EventType.POINTERMOVE,e,t)};ol.pointer.PointerEventHandler.prototype.up=function(e,t){this.fireEvent(ol.pointer.EventType.POINTERUP,e,t)};ol.pointer.PointerEventHandler.prototype.enter=function(e,t){e.bubbles=!1;this.fireEvent(ol.pointer.EventType.POINTERENTER,e,t)};ol.pointer.PointerEventHandler.prototype.leave=function(e,t){e.bubbles=!1;this.fireEvent(ol.pointer.EventType.POINTERLEAVE,e,t)};ol.pointer.PointerEventHandler.prototype.over=function(e,t){e.bubbles=!0;this.fireEvent(ol.pointer.EventType.POINTEROVER,e,t)};ol.pointer.PointerEventHandler.prototype.out=function(e,t){e.bubbles=!0;this.fireEvent(ol.pointer.EventType.POINTEROUT,e,t)};ol.pointer.PointerEventHandler.prototype.cancel=function(e,t){this.fireEvent(ol.pointer.EventType.POINTERCANCEL,e,t)};ol.pointer.PointerEventHandler.prototype.leaveOut=function(e,t){this.out(e,t);this.contains_(e.target,e.relatedTarget)||this.leave(e,t)};ol.pointer.PointerEventHandler.prototype.enterOver=function(e,t){this.over(e,t);this.contains_(e.target,e.relatedTarget)||this.enter(e,t)};ol.pointer.PointerEventHandler.prototype.contains_=function(e,t){return e&&t?e.contains(t):!1};ol.pointer.PointerEventHandler.prototype.makeEvent=function(e,t,o){return new ol.pointer.PointerEvent(e,o,t)};ol.pointer.PointerEventHandler.prototype.fireEvent=function(e,t,o){var r=this.makeEvent(e,t,o);this.dispatchEvent(r)};ol.pointer.PointerEventHandler.prototype.fireNativeEvent=function(e){var t=this.makeEvent(e.type,e,e);this.dispatchEvent(t)};ol.pointer.PointerEventHandler.prototype.wrapMouseEvent=function(e,t){var o=this.makeEvent(e,ol.pointer.MouseSource.prepareEvent(t,this),t);return o};ol.pointer.PointerEventHandler.prototype.disposeInternal=function(){this.unregister_();ol.events.EventTarget.prototype.disposeInternal.call(this)};ol.pointer.PointerEventHandler.CLONE_PROPS=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]];goog.provide("ol.MapBrowserEventHandler");goog.require("ol");goog.require("ol.MapBrowserEventType");goog.require("ol.MapBrowserPointerEvent");goog.require("ol.events");goog.require("ol.events.EventTarget");goog.require("ol.pointer.EventType");goog.require("ol.pointer.PointerEventHandler");ol.MapBrowserEventHandler=function(e){ol.events.EventTarget.call(this);this.map_=e;this.clickTimeoutId_=0;this.dragging_=!1;this.dragListenerKeys_=[];this.down_=null;var t=this.map_.getViewport();this.activePointers_=0;this.trackedTouches_={};this.pointerEventHandler_=new ol.pointer.PointerEventHandler(t);this.documentPointerEventHandler_=null;this.pointerdownListenerKey_=ol.events.listen(this.pointerEventHandler_,ol.pointer.EventType.POINTERDOWN,this.handlePointerDown_,this);this.relayedListenerKey_=ol.events.listen(this.pointerEventHandler_,ol.pointer.EventType.POINTERMOVE,this.relayEvent_,this)};ol.inherits(ol.MapBrowserEventHandler,ol.events.EventTarget);ol.MapBrowserEventHandler.prototype.emulateClick_=function(e){var t=new ol.MapBrowserPointerEvent(ol.MapBrowserEventType.CLICK,this.map_,e);this.dispatchEvent(t);if(0!==this.clickTimeoutId_){clearTimeout(this.clickTimeoutId_);this.clickTimeoutId_=0;t=new ol.MapBrowserPointerEvent(ol.MapBrowserEventType.DBLCLICK,this.map_,e);this.dispatchEvent(t)}else this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=0;var t=new ol.MapBrowserPointerEvent(ol.MapBrowserEventType.SINGLECLICK,this.map_,e);this.dispatchEvent(t)}.bind(this),250)};ol.MapBrowserEventHandler.prototype.updateActivePointers_=function(e){var t=e;t.type==ol.MapBrowserEventType.POINTERUP||t.type==ol.MapBrowserEventType.POINTERCANCEL?delete this.trackedTouches_[t.pointerId]:t.type==ol.MapBrowserEventType.POINTERDOWN&&(this.trackedTouches_[t.pointerId]=!0);this.activePointers_=Object.keys(this.trackedTouches_).length};ol.MapBrowserEventHandler.prototype.handlePointerUp_=function(e){this.updateActivePointers_(e);var t=new ol.MapBrowserPointerEvent(ol.MapBrowserEventType.POINTERUP,this.map_,e);this.dispatchEvent(t);!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_);if(0===this.activePointers_){this.dragListenerKeys_.forEach(ol.events.unlistenByKey);this.dragListenerKeys_.length=0;this.dragging_=!1;this.down_=null;this.documentPointerEventHandler_.dispose();this.documentPointerEventHandler_=null}};ol.MapBrowserEventHandler.prototype.isMouseActionButton_=function(e){return 0===e.button};ol.MapBrowserEventHandler.prototype.handlePointerDown_=function(e){this.updateActivePointers_(e);var t=new ol.MapBrowserPointerEvent(ol.MapBrowserEventType.POINTERDOWN,this.map_,e);this.dispatchEvent(t);this.down_=e;if(0===this.dragListenerKeys_.length){this.documentPointerEventHandler_=new ol.pointer.PointerEventHandler(document);this.dragListenerKeys_.push(ol.events.listen(this.documentPointerEventHandler_,ol.MapBrowserEventType.POINTERMOVE,this.handlePointerMove_,this),ol.events.listen(this.documentPointerEventHandler_,ol.MapBrowserEventType.POINTERUP,this.handlePointerUp_,this),ol.events.listen(this.pointerEventHandler_,ol.MapBrowserEventType.POINTERCANCEL,this.handlePointerUp_,this))}};ol.MapBrowserEventHandler.prototype.handlePointerMove_=function(e){if(this.isMoving_(e)){this.dragging_=!0;var t=new ol.MapBrowserPointerEvent(ol.MapBrowserEventType.POINTERDRAG,this.map_,e,this.dragging_);this.dispatchEvent(t)}e.preventDefault()};ol.MapBrowserEventHandler.prototype.relayEvent_=function(e){var t=!(!this.down_||!this.isMoving_(e));this.dispatchEvent(new ol.MapBrowserPointerEvent(e.type,this.map_,e,t))};ol.MapBrowserEventHandler.prototype.isMoving_=function(e){return e.clientX!=this.down_.clientX||e.clientY!=this.down_.clientY};ol.MapBrowserEventHandler.prototype.disposeInternal=function(){if(this.relayedListenerKey_){ol.events.unlistenByKey(this.relayedListenerKey_);this.relayedListenerKey_=null}if(this.pointerdownListenerKey_){ol.events.unlistenByKey(this.pointerdownListenerKey_);this.pointerdownListenerKey_=null}this.dragListenerKeys_.forEach(ol.events.unlistenByKey);this.dragListenerKeys_.length=0;if(this.documentPointerEventHandler_){this.documentPointerEventHandler_.dispose();this.documentPointerEventHandler_=null}if(this.pointerEventHandler_){this.pointerEventHandler_.dispose();this.pointerEventHandler_=null}ol.events.EventTarget.prototype.disposeInternal.call(this)};goog.provide("ol.MapProperty");ol.MapProperty={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};goog.provide("ol.TileState");ol.TileState={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5};goog.provide("ol.structs.PriorityQueue");goog.require("ol.asserts");goog.require("ol.obj");ol.structs.PriorityQueue=function(e,t){this.priorityFunction_=e;this.keyFunction_=t;this.elements_=[];this.priorities_=[];this.queuedElements_={}};ol.structs.PriorityQueue.DROP=1/0;ol.structs.PriorityQueue.prototype.clear=function(){this.elements_.length=0;this.priorities_.length=0;ol.obj.clear(this.queuedElements_)};ol.structs.PriorityQueue.prototype.dequeue=function(){var e=this.elements_,t=this.priorities_,o=e[0];if(1==e.length){e.length=0;t.length=0}else{e[0]=e.pop();t[0]=t.pop();this.siftUp_(0)}var r=this.keyFunction_(o);delete this.queuedElements_[r];return o};ol.structs.PriorityQueue.prototype.enqueue=function(e){ol.asserts.assert(!(this.keyFunction_(e)in this.queuedElements_),31);var t=this.priorityFunction_(e);if(t!=ol.structs.PriorityQueue.DROP){this.elements_.push(e);this.priorities_.push(t);this.queuedElements_[this.keyFunction_(e)]=!0;this.siftDown_(0,this.elements_.length-1);return!0}return!1};ol.structs.PriorityQueue.prototype.getCount=function(){return this.elements_.length};ol.structs.PriorityQueue.prototype.getLeftChildIndex_=function(e){return 2*e+1};ol.structs.PriorityQueue.prototype.getRightChildIndex_=function(e){return 2*e+2};ol.structs.PriorityQueue.prototype.getParentIndex_=function(e){return e-1>>1};ol.structs.PriorityQueue.prototype.heapify_=function(){var e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)};ol.structs.PriorityQueue.prototype.isEmpty=function(){return 0===this.elements_.length};ol.structs.PriorityQueue.prototype.isKeyQueued=function(e){return e in this.queuedElements_};ol.structs.PriorityQueue.prototype.isQueued=function(e){return this.isKeyQueued(this.keyFunction_(e))};ol.structs.PriorityQueue.prototype.siftUp_=function(e){for(var t=this.elements_,o=this.priorities_,r=t.length,i=t[e],n=o[e],a=e;r>>1>e;){var l=this.getLeftChildIndex_(e),s=this.getRightChildIndex_(e),p=r>s&&o[s]<o[l]?s:l;t[e]=t[p];o[e]=o[p];e=p}t[e]=i;o[e]=n;this.siftDown_(a,e)};ol.structs.PriorityQueue.prototype.siftDown_=function(e,t){for(var o=this.elements_,r=this.priorities_,i=o[t],n=r[t];t>e;){var a=this.getParentIndex_(t);if(!(r[a]>n))break;o[t]=o[a];r[t]=r[a];t=a}o[t]=i;r[t]=n};ol.structs.PriorityQueue.prototype.reprioritize=function(){var e,t,o,r=this.priorityFunction_,i=this.elements_,n=this.priorities_,a=0,l=i.length;for(t=0;l>t;++t){e=i[t];o=r(e);if(o==ol.structs.PriorityQueue.DROP)delete this.queuedElements_[this.keyFunction_(e)];else{n[a]=o;i[a++]=e}}i.length=a;n.length=a;this.heapify_()};goog.provide("ol.TileQueue");goog.require("ol");goog.require("ol.TileState");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.structs.PriorityQueue");ol.TileQueue=function(e,t){ol.structs.PriorityQueue.call(this,function(t){return e.apply(null,t)},function(e){return e[0].getKey()});this.tileChangeCallback_=t;this.tilesLoading_=0;this.tilesLoadingKeys_={}};ol.inherits(ol.TileQueue,ol.structs.PriorityQueue);ol.TileQueue.prototype.enqueue=function(e){var t=ol.structs.PriorityQueue.prototype.enqueue.call(this,e);if(t){var o=e[0];ol.events.listen(o,ol.events.EventType.CHANGE,this.handleTileChange,this)}return t};ol.TileQueue.prototype.getTilesLoading=function(){return this.tilesLoading_};ol.TileQueue.prototype.handleTileChange=function(e){var t=e.target,o=t.getState();if(o===ol.TileState.LOADED||o===ol.TileState.ERROR||o===ol.TileState.EMPTY||o===ol.TileState.ABORT){ol.events.unlisten(t,ol.events.EventType.CHANGE,this.handleTileChange,this);var r=t.getKey();if(r in this.tilesLoadingKeys_){delete this.tilesLoadingKeys_[r];--this.tilesLoading_}this.tileChangeCallback_()}};ol.TileQueue.prototype.loadMoreTiles=function(e,t){for(var o,r,i=0;this.tilesLoading_<e&&t>i&&this.getCount()>0;){o=this.dequeue()[0];r=o.getKey();if(o.getState()===ol.TileState.IDLE&&!(r in this.tilesLoadingKeys_)){this.tilesLoadingKeys_[r]=!0;++this.tilesLoading_;++i;o.load()}}};goog.provide("ol.ResolutionConstraint");goog.require("ol.array");goog.require("ol.math");ol.ResolutionConstraint.createSnapToResolutions=function(e){return function(t,o,r){if(void 0!==t){var i=ol.array.linearFindNearest(e,t,r);i=ol.math.clamp(i+o,0,e.length-1);var n=Math.floor(i);if(i!=n&&n<e.length-1){var a=e[n]/e[n+1];return e[n]/Math.pow(a,i-n)}return e[n]}return void 0}};ol.ResolutionConstraint.createSnapToPower=function(e,t,o){return function(r,i,n){if(void 0!==r){var a=-n/2+.5,l=Math.floor(Math.log(t/r)/Math.log(e)+a),s=Math.max(l+i,0);void 0!==o&&(s=Math.min(s,o));return t/Math.pow(e,s)}return void 0}};goog.provide("ol.RotationConstraint");goog.require("ol.math");ol.RotationConstraint.disable=function(e,t){return void 0!==e?0:void 0};ol.RotationConstraint.none=function(e,t){return void 0!==e?e+t:void 0};ol.RotationConstraint.createSnapToN=function(e){var t=2*Math.PI/e;return function(e,o){if(void 0!==e){e=Math.floor((e+o)/t+.5)*t;return e}return void 0}};ol.RotationConstraint.createSnapToZero=function(e){var t=e||ol.math.toRadians(5);return function(e,o){return void 0!==e?Math.abs(e+o)<=t?0:e+o:void 0}};goog.provide("ol.ViewHint");ol.ViewHint={ANIMATING:0,INTERACTING:1};goog.provide("ol.ViewProperty");ol.ViewProperty={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};goog.provide("ol.string");ol.string.padNumber=function(e,t,o){var r=void 0!==o?e.toFixed(o):""+e,i=r.indexOf(".");i=-1===i?r.length:i;return i>t?r:new Array(1+t-i).join("0")+r};ol.string.compareVersions=function(e,t){for(var o=(""+e).split("."),r=(""+t).split("."),i=0;i<Math.max(o.length,r.length);i++){var n=parseInt(o[i]||"0",10),a=parseInt(r[i]||"0",10);if(n>a)return 1;if(a>n)return-1}return 0};goog.provide("ol.coordinate");goog.require("ol.math");goog.require("ol.string");ol.coordinate.add=function(e,t){e[0]+=t[0];e[1]+=t[1];return e};ol.coordinate.closestOnSegment=function(e,t){var o,r,i=e[0],n=e[1],a=t[0],l=t[1],s=a[0],p=a[1],c=l[0],u=l[1],g=c-s,d=u-p,h=0===g&&0===d?0:(g*(i-s)+d*(n-p))/(g*g+d*d||0);if(0>=h){o=s;r=p}else if(h>=1){o=c;r=u}else{o=s+h*g;r=p+h*d}return[o,r]};ol.coordinate.createStringXY=function(e){return function(t){return ol.coordinate.toStringXY(t,e)}};ol.coordinate.degreesToStringHDMS_=function(e,t,o){var r=ol.math.modulo(e+180,360)-180,i=Math.abs(3600*r),n=o||0,a=Math.pow(10,n),l=Math.floor(i/3600),s=Math.floor((i-3600*l)/60),p=i-3600*l-60*s;p=Math.ceil(p*a)/a;if(p>=60){p=0;s+=1}if(s>=60){s=0;l+=1}return l+"\xb0 "+ol.string.padNumber(s,2)+"\u2032 "+ol.string.padNumber(p,2,n)+"\u2033 "+t.charAt(0>r?1:0)};ol.coordinate.format=function(e,t,o){return e?t.replace("{x}",e[0].toFixed(o)).replace("{y}",e[1].toFixed(o)):""};ol.coordinate.equals=function(e,t){for(var o=!0,r=e.length-1;r>=0;--r)if(e[r]!=t[r]){o=!1;break}return o};ol.coordinate.rotate=function(e,t){var o=Math.cos(t),r=Math.sin(t),i=e[0]*o-e[1]*r,n=e[1]*o+e[0]*r;e[0]=i;e[1]=n;return e};ol.coordinate.scale=function(e,t){e[0]*=t;e[1]*=t;return e};ol.coordinate.sub=function(e,t){e[0]-=t[0];e[1]-=t[1];return e};ol.coordinate.squaredDistance=function(e,t){var o=e[0]-t[0],r=e[1]-t[1];return o*o+r*r};ol.coordinate.distance=function(e,t){return Math.sqrt(ol.coordinate.squaredDistance(e,t))};ol.coordinate.squaredDistanceToSegment=function(e,t){return ol.coordinate.squaredDistance(e,ol.coordinate.closestOnSegment(e,t))};ol.coordinate.toStringHDMS=function(e,t){return e?ol.coordinate.degreesToStringHDMS_(e[1],"NS",t)+" "+ol.coordinate.degreesToStringHDMS_(e[0],"EW",t):""};ol.coordinate.toStringXY=function(e,t){return ol.coordinate.format(e,"{x}, {y}",t)};goog.provide("ol.geom.GeometryType");ol.geom.GeometryType={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};goog.provide("ol.geom.GeometryLayout");ol.geom.GeometryLayout={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};goog.provide("ol.functions");ol.functions.TRUE=function(){return!0};ol.functions.FALSE=function(){return!1};goog.provide("ol.geom.Geometry");goog.require("ol");goog.require("ol.Object");goog.require("ol.extent");goog.require("ol.functions");goog.require("ol.proj");ol.geom.Geometry=function(){ol.Object.call(this);this.extent_=ol.extent.createEmpty();this.extentRevision_=-1;this.simplifiedGeometryCache={};this.simplifiedGeometryMaxMinSquaredTolerance=0;this.simplifiedGeometryRevision=0};ol.inherits(ol.geom.Geometry,ol.Object);ol.geom.Geometry.prototype.clone=function(){};ol.geom.Geometry.prototype.closestPointXY=function(e,t,o,r){};ol.geom.Geometry.prototype.getClosestPoint=function(e,t){var o=t?t:[0/0,0/0];this.closestPointXY(e[0],e[1],o,1/0);return o};ol.geom.Geometry.prototype.intersectsCoordinate=function(e){return this.containsXY(e[0],e[1])};ol.geom.Geometry.prototype.computeExtent=function(e){};ol.geom.Geometry.prototype.containsXY=ol.functions.FALSE;ol.geom.Geometry.prototype.getExtent=function(e){if(this.extentRevision_!=this.getRevision()){this.extent_=this.computeExtent(this.extent_);this.extentRevision_=this.getRevision()}return ol.extent.returnOrUpdate(this.extent_,e)};ol.geom.Geometry.prototype.rotate=function(e,t){};ol.geom.Geometry.prototype.scale=function(e,t,o){};ol.geom.Geometry.prototype.simplify=function(e){return this.getSimplifiedGeometry(e*e)};ol.geom.Geometry.prototype.getSimplifiedGeometry=function(e){};ol.geom.Geometry.prototype.getType=function(){};ol.geom.Geometry.prototype.applyTransform=function(e){};ol.geom.Geometry.prototype.intersectsExtent=function(e){};ol.geom.Geometry.prototype.translate=function(e,t){};ol.geom.Geometry.prototype.transform=function(e,t){this.applyTransform(ol.proj.getTransform(e,t));return this};goog.provide("ol.geom.flat.transform");ol.geom.flat.transform.transform2D=function(e,t,o,r,i,n){var a,l=n?n:[],s=0;for(a=t;o>a;a+=r){var p=e[a],c=e[a+1];l[s++]=i[0]*p+i[2]*c+i[4];l[s++]=i[1]*p+i[3]*c+i[5]}n&&l.length!=s&&(l.length=s);return l};ol.geom.flat.transform.rotate=function(e,t,o,r,i,n,a){for(var l=a?a:[],s=Math.cos(i),p=Math.sin(i),c=n[0],u=n[1],g=0,d=t;o>d;d+=r){var h=e[d]-c,f=e[d+1]-u;l[g++]=c+h*s-f*p;l[g++]=u+h*p+f*s;for(var y=d+2;d+r>y;++y)l[g++]=e[y]}a&&l.length!=g&&(l.length=g);return l};ol.geom.flat.transform.scale=function(e,t,o,r,i,n,a,l){for(var s=l?l:[],p=a[0],c=a[1],u=0,g=t;o>g;g+=r){var d=e[g]-p,h=e[g+1]-c;s[u++]=p+i*d;s[u++]=c+n*h;for(var f=g+2;g+r>f;++f)s[u++]=e[f]}l&&s.length!=u&&(s.length=u);return s};ol.geom.flat.transform.translate=function(e,t,o,r,i,n,a){var l,s,p=a?a:[],c=0;for(l=t;o>l;l+=r){p[c++]=e[l]+i;p[c++]=e[l+1]+n;for(s=l+2;l+r>s;++s)p[c++]=e[s]}a&&p.length!=c&&(p.length=c);return p};goog.provide("ol.geom.SimpleGeometry");goog.require("ol");goog.require("ol.functions");goog.require("ol.extent");goog.require("ol.geom.Geometry");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.flat.transform");goog.require("ol.obj");ol.geom.SimpleGeometry=function(){ol.geom.Geometry.call(this);this.layout=ol.geom.GeometryLayout.XY;this.stride=2;this.flatCoordinates=null};ol.inherits(ol.geom.SimpleGeometry,ol.geom.Geometry);ol.geom.SimpleGeometry.getLayoutForStride_=function(e){var t;2==e?t=ol.geom.GeometryLayout.XY:3==e?t=ol.geom.GeometryLayout.XYZ:4==e&&(t=ol.geom.GeometryLayout.XYZM);return t};ol.geom.SimpleGeometry.getStrideForLayout=function(e){var t;e==ol.geom.GeometryLayout.XY?t=2:e==ol.geom.GeometryLayout.XYZ||e==ol.geom.GeometryLayout.XYM?t=3:e==ol.geom.GeometryLayout.XYZM&&(t=4);return t};ol.geom.SimpleGeometry.prototype.containsXY=ol.functions.FALSE;ol.geom.SimpleGeometry.prototype.computeExtent=function(e){return ol.extent.createOrUpdateFromFlatCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)};ol.geom.SimpleGeometry.prototype.getCoordinates=function(){};ol.geom.SimpleGeometry.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)};ol.geom.SimpleGeometry.prototype.getFlatCoordinates=function(){return this.flatCoordinates};ol.geom.SimpleGeometry.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)};ol.geom.SimpleGeometry.prototype.getLayout=function(){return this.layout};ol.geom.SimpleGeometry.prototype.getSimplifiedGeometry=function(e){if(this.simplifiedGeometryRevision!=this.getRevision()){ol.obj.clear(this.simplifiedGeometryCache);this.simplifiedGeometryMaxMinSquaredTolerance=0;this.simplifiedGeometryRevision=this.getRevision()}if(0>e||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var t=e.toString();if(this.simplifiedGeometryCache.hasOwnProperty(t))return this.simplifiedGeometryCache[t];var o=this.getSimplifiedGeometryInternal(e),r=o.getFlatCoordinates();if(r.length<this.flatCoordinates.length){this.simplifiedGeometryCache[t]=o;return o}this.simplifiedGeometryMaxMinSquaredTolerance=e;return this};ol.geom.SimpleGeometry.prototype.getSimplifiedGeometryInternal=function(e){return this};ol.geom.SimpleGeometry.prototype.getStride=function(){return this.stride};ol.geom.SimpleGeometry.prototype.setFlatCoordinatesInternal=function(e,t){this.stride=ol.geom.SimpleGeometry.getStrideForLayout(e);this.layout=e;this.flatCoordinates=t};ol.geom.SimpleGeometry.prototype.setCoordinates=function(e,t){};ol.geom.SimpleGeometry.prototype.setLayout=function(e,t,o){var r;if(e)r=ol.geom.SimpleGeometry.getStrideForLayout(e);else{var i;for(i=0;o>i;++i){if(0===t.length){this.layout=ol.geom.GeometryLayout.XY;this.stride=2;return}t=t[0]}r=t.length;e=ol.geom.SimpleGeometry.getLayoutForStride_(r)}this.layout=e;this.stride=r};ol.geom.SimpleGeometry.prototype.applyTransform=function(e){if(this.flatCoordinates){e(this.flatCoordinates,this.flatCoordinates,this.stride);this.changed()}};ol.geom.SimpleGeometry.prototype.rotate=function(e,t){var o=this.getFlatCoordinates();if(o){var r=this.getStride();ol.geom.flat.transform.rotate(o,0,o.length,r,e,t,o);this.changed()}};ol.geom.SimpleGeometry.prototype.scale=function(e,t,o){var r=t;void 0===r&&(r=e);var i=o;i||(i=ol.extent.getCenter(this.getExtent()));var n=this.getFlatCoordinates();if(n){var a=this.getStride();ol.geom.flat.transform.scale(n,0,n.length,a,e,r,i,n);this.changed()}};ol.geom.SimpleGeometry.prototype.translate=function(e,t){var o=this.getFlatCoordinates();if(o){var r=this.getStride();ol.geom.flat.transform.translate(o,0,o.length,r,e,t,o);this.changed()}};ol.geom.SimpleGeometry.transform2D=function(e,t,o){var r=e.getFlatCoordinates();if(r){var i=e.getStride();return ol.geom.flat.transform.transform2D(r,0,r.length,i,t,o)}return null};goog.provide("ol.geom.flat.area");ol.geom.flat.area.linearRing=function(e,t,o,r){for(var i=0,n=e[o-r],a=e[o-r+1];o>t;t+=r){var l=e[t],s=e[t+1];i+=a*l-n*s;n=l;a=s}return i/2};ol.geom.flat.area.linearRings=function(e,t,o,r){var i,n,a=0;for(i=0,n=o.length;n>i;++i){var l=o[i];a+=ol.geom.flat.area.linearRing(e,t,l,r);t=l}return a};ol.geom.flat.area.linearRingss=function(e,t,o,r){var i,n,a=0;for(i=0,n=o.length;n>i;++i){var l=o[i];a+=ol.geom.flat.area.linearRings(e,t,l,r);t=l[l.length-1]}return a};goog.provide("ol.geom.flat.closest");goog.require("ol.math");ol.geom.flat.closest.point=function(e,t,o,r,i,n,a){var l,s,p=e[t],c=e[t+1],u=e[o]-p,g=e[o+1]-c;if(0===u&&0===g)s=t;else{var d=((i-p)*u+(n-c)*g)/(u*u+g*g);if(d>1)s=o;else{if(d>0){for(l=0;r>l;++l)a[l]=ol.math.lerp(e[t+l],e[o+l],d);a.length=r;return}s=t}}for(l=0;r>l;++l)a[l]=e[s+l];a.length=r};ol.geom.flat.closest.getMaxSquaredDelta=function(e,t,o,r,i){var n=e[t],a=e[t+1];for(t+=r;o>t;t+=r){var l=e[t],s=e[t+1],p=ol.math.squaredDistance(n,a,l,s);p>i&&(i=p);n=l;a=s}return i};ol.geom.flat.closest.getsMaxSquaredDelta=function(e,t,o,r,i){var n,a;for(n=0,a=o.length;a>n;++n){var l=o[n];i=ol.geom.flat.closest.getMaxSquaredDelta(e,t,l,r,i);t=l}return i};ol.geom.flat.closest.getssMaxSquaredDelta=function(e,t,o,r,i){var n,a;for(n=0,a=o.length;a>n;++n){var l=o[n];i=ol.geom.flat.closest.getsMaxSquaredDelta(e,t,l,r,i);t=l[l.length-1]}return i};ol.geom.flat.closest.getClosestPoint=function(e,t,o,r,i,n,a,l,s,p,c){if(t==o)return p;var u,g;if(0===i){g=ol.math.squaredDistance(a,l,e[t],e[t+1]);if(p>g){for(u=0;r>u;++u)s[u]=e[t+u];s.length=r;return g}return p}for(var d=c?c:[0/0,0/0],h=t+r;o>h;){ol.geom.flat.closest.point(e,h-r,h,r,a,l,d);g=ol.math.squaredDistance(a,l,d[0],d[1]);if(p>g){p=g;for(u=0;r>u;++u)s[u]=d[u];s.length=r;h+=r}else h+=r*Math.max((Math.sqrt(g)-Math.sqrt(p))/i|0,1)}if(n){ol.geom.flat.closest.point(e,o-r,t,r,a,l,d);g=ol.math.squaredDistance(a,l,d[0],d[1]);if(p>g){p=g;for(u=0;r>u;++u)s[u]=d[u];s.length=r}}return p};ol.geom.flat.closest.getsClosestPoint=function(e,t,o,r,i,n,a,l,s,p,c){var u,g,d=c?c:[0/0,0/0];for(u=0,g=o.length;g>u;++u){var h=o[u];p=ol.geom.flat.closest.getClosestPoint(e,t,h,r,i,n,a,l,s,p,d);t=h}return p};ol.geom.flat.closest.getssClosestPoint=function(e,t,o,r,i,n,a,l,s,p,c){var u,g,d=c?c:[0/0,0/0];for(u=0,g=o.length;g>u;++u){var h=o[u];p=ol.geom.flat.closest.getsClosestPoint(e,t,h,r,i,n,a,l,s,p,d);t=h[h.length-1]}return p};goog.provide("ol.geom.flat.deflate");ol.geom.flat.deflate.coordinate=function(e,t,o,r){var i,n;for(i=0,n=o.length;n>i;++i)e[t++]=o[i];return t};ol.geom.flat.deflate.coordinates=function(e,t,o,r){var i,n;for(i=0,n=o.length;n>i;++i){var a,l=o[i];for(a=0;r>a;++a)e[t++]=l[a]}return t};ol.geom.flat.deflate.coordinatess=function(e,t,o,r,i){var n,a,l=i?i:[],s=0;for(n=0,a=o.length;a>n;++n){var p=ol.geom.flat.deflate.coordinates(e,t,o[n],r);l[s++]=p;t=p}l.length=s;return l};ol.geom.flat.deflate.coordinatesss=function(e,t,o,r,i){var n,a,l=i?i:[],s=0;for(n=0,a=o.length;a>n;++n){var p=ol.geom.flat.deflate.coordinatess(e,t,o[n],r,l[s]);l[s++]=p;t=p[p.length-1]}l.length=s;return l};goog.provide("ol.geom.flat.inflate");ol.geom.flat.inflate.coordinates=function(e,t,o,r,i){var n,a=void 0!==i?i:[],l=0;for(n=t;o>n;n+=r)a[l++]=e.slice(n,n+r);a.length=l;return a};ol.geom.flat.inflate.coordinatess=function(e,t,o,r,i){var n,a,l=void 0!==i?i:[],s=0;for(n=0,a=o.length;a>n;++n){var p=o[n];l[s++]=ol.geom.flat.inflate.coordinates(e,t,p,r,l[s]);t=p}l.length=s;return l};ol.geom.flat.inflate.coordinatesss=function(e,t,o,r,i){var n,a,l=void 0!==i?i:[],s=0;for(n=0,a=o.length;a>n;++n){var p=o[n];l[s++]=ol.geom.flat.inflate.coordinatess(e,t,p,r,l[s]);t=p[p.length-1]}l.length=s;return l};goog.provide("ol.geom.flat.simplify");goog.require("ol.math");ol.geom.flat.simplify.lineString=function(e,t,o,r,i,n,a){var l=void 0!==a?a:[];if(!n){o=ol.geom.flat.simplify.radialDistance(e,t,o,r,i,l,0);e=l;t=0;r=2}l.length=ol.geom.flat.simplify.douglasPeucker(e,t,o,r,i,l,0);return l};ol.geom.flat.simplify.douglasPeucker=function(e,t,o,r,i,n,a){var l=(o-t)/r;if(3>l){for(;o>t;t+=r){n[a++]=e[t];n[a++]=e[t+1]}return a}var s=new Array(l);s[0]=1;s[l-1]=1;for(var p,c=[t,o-r],u=0;c.length>0;){var g=c.pop(),d=c.pop(),h=0,f=e[d],y=e[d+1],m=e[g],v=e[g+1];for(p=d+r;g>p;p+=r){var C=e[p],T=e[p+1],_=ol.math.squaredSegmentDistance(C,T,f,y,m,v);if(_>h){u=p;h=_}}if(h>i){s[(u-t)/r]=1;u>d+r&&c.push(d,u);g>u+r&&c.push(u,g)}}for(p=0;l>p;++p)if(s[p]){n[a++]=e[t+p*r];n[a++]=e[t+p*r+1]}return a};ol.geom.flat.simplify.douglasPeuckers=function(e,t,o,r,i,n,a,l){var s,p;for(s=0,p=o.length;p>s;++s){var c=o[s];a=ol.geom.flat.simplify.douglasPeucker(e,t,c,r,i,n,a);l.push(a);t=c}return a};ol.geom.flat.simplify.douglasPeuckerss=function(e,t,o,r,i,n,a,l){var s,p;for(s=0,p=o.length;p>s;++s){var c=o[s],u=[];a=ol.geom.flat.simplify.douglasPeuckers(e,t,c,r,i,n,a,u);l.push(u);t=c[c.length-1]}return a};ol.geom.flat.simplify.radialDistance=function(e,t,o,r,i,n,a){if(t+r>=o){for(;o>t;t+=r){n[a++]=e[t];n[a++]=e[t+1]}return a}var l=e[t],s=e[t+1];n[a++]=l;n[a++]=s;var p=l,c=s;for(t+=r;o>t;t+=r){p=e[t];c=e[t+1];if(ol.math.squaredDistance(l,s,p,c)>i){n[a++]=p;n[a++]=c;l=p;s=c}}if(p!=l||c!=s){n[a++]=p;n[a++]=c}return a};ol.geom.flat.simplify.snap=function(e,t){return t*Math.round(e/t)};ol.geom.flat.simplify.quantize=function(e,t,o,r,i,n,a){if(t==o)return a;var l=ol.geom.flat.simplify.snap(e[t],i),s=ol.geom.flat.simplify.snap(e[t+1],i);t+=r;n[a++]=l;n[a++]=s;var p,c;do{p=ol.geom.flat.simplify.snap(e[t],i);c=ol.geom.flat.simplify.snap(e[t+1],i);t+=r;if(t==o){n[a++]=p;n[a++]=c;return a}}while(p==l&&c==s);for(;o>t;){var u,g;u=ol.geom.flat.simplify.snap(e[t],i);g=ol.geom.flat.simplify.snap(e[t+1],i);t+=r;if(u!=p||g!=c){var d=p-l,h=c-s,f=u-l,y=g-s;if(d*y==h*f&&(0>d&&d>f||d==f||d>0&&f>d)&&(0>h&&h>y||h==y||h>0&&y>h)){p=u;c=g}else{n[a++]=p;n[a++]=c;l=p;s=c;p=u;c=g}}}n[a++]=p;n[a++]=c;return a};ol.geom.flat.simplify.quantizes=function(e,t,o,r,i,n,a,l){var s,p;for(s=0,p=o.length;p>s;++s){var c=o[s];a=ol.geom.flat.simplify.quantize(e,t,c,r,i,n,a);l.push(a);t=c}return a};ol.geom.flat.simplify.quantizess=function(e,t,o,r,i,n,a,l){var s,p;for(s=0,p=o.length;p>s;++s){var c=o[s],u=[];a=ol.geom.flat.simplify.quantizes(e,t,c,r,i,n,a,u);l.push(u);t=c[c.length-1]}return a};goog.provide("ol.geom.LinearRing");goog.require("ol");goog.require("ol.extent");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.GeometryType");goog.require("ol.geom.SimpleGeometry");goog.require("ol.geom.flat.area");goog.require("ol.geom.flat.closest");goog.require("ol.geom.flat.deflate");goog.require("ol.geom.flat.inflate");goog.require("ol.geom.flat.simplify");ol.geom.LinearRing=function(e,t){ol.geom.SimpleGeometry.call(this);this.maxDelta_=-1;this.maxDeltaRevision_=-1;this.setCoordinates(e,t)};ol.inherits(ol.geom.LinearRing,ol.geom.SimpleGeometry);ol.geom.LinearRing.prototype.clone=function(){var e=new ol.geom.LinearRing(null);e.setFlatCoordinates(this.layout,this.flatCoordinates.slice());return e};ol.geom.LinearRing.prototype.closestPointXY=function(e,t,o,r){if(r<ol.extent.closestSquaredDistanceXY(this.getExtent(),e,t))return r;if(this.maxDeltaRevision_!=this.getRevision()){this.maxDelta_=Math.sqrt(ol.geom.flat.closest.getMaxSquaredDelta(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0));this.maxDeltaRevision_=this.getRevision()}return ol.geom.flat.closest.getClosestPoint(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,o,r)};ol.geom.LinearRing.prototype.getArea=function(){return ol.geom.flat.area.linearRing(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};ol.geom.LinearRing.prototype.getCoordinates=function(){
return ol.geom.flat.inflate.coordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};ol.geom.LinearRing.prototype.getSimplifiedGeometryInternal=function(e){var t=[];t.length=ol.geom.flat.simplify.douglasPeucker(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0);var o=new ol.geom.LinearRing(null);o.setFlatCoordinates(ol.geom.GeometryLayout.XY,t);return o};ol.geom.LinearRing.prototype.getType=function(){return ol.geom.GeometryType.LINEAR_RING};ol.geom.LinearRing.prototype.intersectsExtent=function(e){};ol.geom.LinearRing.prototype.setCoordinates=function(e,t){if(e){this.setLayout(t,e,1);this.flatCoordinates||(this.flatCoordinates=[]);this.flatCoordinates.length=ol.geom.flat.deflate.coordinates(this.flatCoordinates,0,e,this.stride);this.changed()}else this.setFlatCoordinates(ol.geom.GeometryLayout.XY,null)};ol.geom.LinearRing.prototype.setFlatCoordinates=function(e,t){this.setFlatCoordinatesInternal(e,t);this.changed()};goog.provide("ol.geom.Point");goog.require("ol");goog.require("ol.extent");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.GeometryType");goog.require("ol.geom.SimpleGeometry");goog.require("ol.geom.flat.deflate");goog.require("ol.math");ol.geom.Point=function(e,t){ol.geom.SimpleGeometry.call(this);this.setCoordinates(e,t)};ol.inherits(ol.geom.Point,ol.geom.SimpleGeometry);ol.geom.Point.prototype.clone=function(){var e=new ol.geom.Point(null);e.setFlatCoordinates(this.layout,this.flatCoordinates.slice());return e};ol.geom.Point.prototype.closestPointXY=function(e,t,o,r){var i=this.flatCoordinates,n=ol.math.squaredDistance(e,t,i[0],i[1]);if(r>n){var a,l=this.stride;for(a=0;l>a;++a)o[a]=i[a];o.length=l;return n}return r};ol.geom.Point.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]};ol.geom.Point.prototype.computeExtent=function(e){return ol.extent.createOrUpdateFromCoordinate(this.flatCoordinates,e)};ol.geom.Point.prototype.getType=function(){return ol.geom.GeometryType.POINT};ol.geom.Point.prototype.intersectsExtent=function(e){return ol.extent.containsXY(e,this.flatCoordinates[0],this.flatCoordinates[1])};ol.geom.Point.prototype.setCoordinates=function(e,t){if(e){this.setLayout(t,e,0);this.flatCoordinates||(this.flatCoordinates=[]);this.flatCoordinates.length=ol.geom.flat.deflate.coordinate(this.flatCoordinates,0,e,this.stride);this.changed()}else this.setFlatCoordinates(ol.geom.GeometryLayout.XY,null)};ol.geom.Point.prototype.setFlatCoordinates=function(e,t){this.setFlatCoordinatesInternal(e,t);this.changed()};goog.provide("ol.geom.flat.contains");goog.require("ol.extent");ol.geom.flat.contains.linearRingContainsExtent=function(e,t,o,r,i){var n=ol.extent.forEachCorner(i,function(i){return!ol.geom.flat.contains.linearRingContainsXY(e,t,o,r,i[0],i[1])});return!n};ol.geom.flat.contains.linearRingContainsXY=function(e,t,o,r,i,n){for(var a=0,l=e[o-r],s=e[o-r+1];o>t;t+=r){var p=e[t],c=e[t+1];n>=s?c>n&&(p-l)*(n-s)-(i-l)*(c-s)>0&&a++:n>=c&&0>(p-l)*(n-s)-(i-l)*(c-s)&&a--;l=p;s=c}return 0!==a};ol.geom.flat.contains.linearRingsContainsXY=function(e,t,o,r,i,n){if(0===o.length)return!1;if(!ol.geom.flat.contains.linearRingContainsXY(e,t,o[0],r,i,n))return!1;var a,l;for(a=1,l=o.length;l>a;++a)if(ol.geom.flat.contains.linearRingContainsXY(e,o[a-1],o[a],r,i,n))return!1;return!0};ol.geom.flat.contains.linearRingssContainsXY=function(e,t,o,r,i,n){if(0===o.length)return!1;var a,l;for(a=0,l=o.length;l>a;++a){var s=o[a];if(ol.geom.flat.contains.linearRingsContainsXY(e,t,s,r,i,n))return!0;t=s[s.length-1]}return!1};goog.provide("ol.geom.flat.interiorpoint");goog.require("ol.array");goog.require("ol.geom.flat.contains");ol.geom.flat.interiorpoint.linearRings=function(e,t,o,r,i,n,a){var l,s,p,c,u,g,d,h=i[n+1],f=[],y=o[0];c=e[y-r];g=e[y-r+1];for(l=t;y>l;l+=r){u=e[l];d=e[l+1];if(g>=h&&h>=d||h>=g&&d>=h){p=(h-g)/(d-g)*(u-c)+c;f.push(p)}c=u;g=d}var m=0/0,v=-(1/0);f.sort(ol.array.numberSafeCompareFunction);c=f[0];for(l=1,s=f.length;s>l;++l){u=f[l];var C=Math.abs(u-c);if(C>v){p=(c+u)/2;if(ol.geom.flat.contains.linearRingsContainsXY(e,t,o,r,p,h)){m=p;v=C}}c=u}isNaN(m)&&(m=i[n]);if(a){a.push(m,h);return a}return[m,h]};ol.geom.flat.interiorpoint.linearRingss=function(e,t,o,r,i){var n,a,l=[];for(n=0,a=o.length;a>n;++n){var s=o[n];l=ol.geom.flat.interiorpoint.linearRings(e,t,s,r,i,2*n,l);t=s[s.length-1]}return l};goog.provide("ol.geom.flat.segments");ol.geom.flat.segments.forEach=function(e,t,o,r,i,n){for(var a,l=[e[t],e[t+1]],s=[];o>t+r;t+=r){s[0]=e[t+r];s[1]=e[t+r+1];a=i.call(n,l,s);if(a)return a;l[0]=s[0];l[1]=s[1]}return!1};goog.provide("ol.geom.flat.intersectsextent");goog.require("ol.extent");goog.require("ol.geom.flat.contains");goog.require("ol.geom.flat.segments");ol.geom.flat.intersectsextent.lineString=function(e,t,o,r,i){var n=ol.extent.extendFlatCoordinates(ol.extent.createEmpty(),e,t,o,r);return ol.extent.intersects(i,n)?ol.extent.containsExtent(i,n)?!0:n[0]>=i[0]&&n[2]<=i[2]?!0:n[1]>=i[1]&&n[3]<=i[3]?!0:ol.geom.flat.segments.forEach(e,t,o,r,function(e,t){return ol.extent.intersectsSegment(i,e,t)}):!1};ol.geom.flat.intersectsextent.lineStrings=function(e,t,o,r,i){var n,a;for(n=0,a=o.length;a>n;++n){if(ol.geom.flat.intersectsextent.lineString(e,t,o[n],r,i))return!0;t=o[n]}return!1};ol.geom.flat.intersectsextent.linearRing=function(e,t,o,r,i){return ol.geom.flat.intersectsextent.lineString(e,t,o,r,i)?!0:ol.geom.flat.contains.linearRingContainsXY(e,t,o,r,i[0],i[1])?!0:ol.geom.flat.contains.linearRingContainsXY(e,t,o,r,i[0],i[3])?!0:ol.geom.flat.contains.linearRingContainsXY(e,t,o,r,i[2],i[1])?!0:ol.geom.flat.contains.linearRingContainsXY(e,t,o,r,i[2],i[3])?!0:!1};ol.geom.flat.intersectsextent.linearRings=function(e,t,o,r,i){if(!ol.geom.flat.intersectsextent.linearRing(e,t,o[0],r,i))return!1;if(1===o.length)return!0;var n,a;for(n=1,a=o.length;a>n;++n)if(ol.geom.flat.contains.linearRingContainsExtent(e,o[n-1],o[n],r,i))return!1;return!0};ol.geom.flat.intersectsextent.linearRingss=function(e,t,o,r,i){var n,a;for(n=0,a=o.length;a>n;++n){var l=o[n];if(ol.geom.flat.intersectsextent.linearRings(e,t,l,r,i))return!0;t=l[l.length-1]}return!1};goog.provide("ol.geom.flat.reverse");ol.geom.flat.reverse.coordinates=function(e,t,o,r){for(;o-r>t;){var i;for(i=0;r>i;++i){var n=e[t+i];e[t+i]=e[o-r+i];e[o-r+i]=n}t+=r;o-=r}};goog.provide("ol.geom.flat.orient");goog.require("ol.geom.flat.reverse");ol.geom.flat.orient.linearRingIsClockwise=function(e,t,o,r){for(var i=0,n=e[o-r],a=e[o-r+1];o>t;t+=r){var l=e[t],s=e[t+1];i+=(l-n)*(s+a);n=l;a=s}return i>0};ol.geom.flat.orient.linearRingsAreOriented=function(e,t,o,r,i){var n,a,l=void 0!==i?i:!1;for(n=0,a=o.length;a>n;++n){var s=o[n],p=ol.geom.flat.orient.linearRingIsClockwise(e,t,s,r);if(0===n){if(l&&p||!l&&!p)return!1}else if(l&&!p||!l&&p)return!1;t=s}return!0};ol.geom.flat.orient.linearRingssAreOriented=function(e,t,o,r,i){var n,a;for(n=0,a=o.length;a>n;++n)if(!ol.geom.flat.orient.linearRingsAreOriented(e,t,o[n],r,i))return!1;return!0};ol.geom.flat.orient.orientLinearRings=function(e,t,o,r,i){var n,a,l=void 0!==i?i:!1;for(n=0,a=o.length;a>n;++n){var s=o[n],p=ol.geom.flat.orient.linearRingIsClockwise(e,t,s,r),c=0===n?l&&p||!l&&!p:l&&!p||!l&&p;c&&ol.geom.flat.reverse.coordinates(e,t,s,r);t=s}return t};ol.geom.flat.orient.orientLinearRingss=function(e,t,o,r,i){var n,a;for(n=0,a=o.length;a>n;++n)t=ol.geom.flat.orient.orientLinearRings(e,t,o[n],r,i);return t};goog.provide("ol.geom.Polygon");goog.require("ol");goog.require("ol.array");goog.require("ol.extent");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.GeometryType");goog.require("ol.geom.LinearRing");goog.require("ol.geom.Point");goog.require("ol.geom.SimpleGeometry");goog.require("ol.geom.flat.area");goog.require("ol.geom.flat.closest");goog.require("ol.geom.flat.contains");goog.require("ol.geom.flat.deflate");goog.require("ol.geom.flat.inflate");goog.require("ol.geom.flat.interiorpoint");goog.require("ol.geom.flat.intersectsextent");goog.require("ol.geom.flat.orient");goog.require("ol.geom.flat.simplify");goog.require("ol.math");ol.geom.Polygon=function(e,t){ol.geom.SimpleGeometry.call(this);this.ends_=[];this.flatInteriorPointRevision_=-1;this.flatInteriorPoint_=null;this.maxDelta_=-1;this.maxDeltaRevision_=-1;this.orientedRevision_=-1;this.orientedFlatCoordinates_=null;this.setCoordinates(e,t)};ol.inherits(ol.geom.Polygon,ol.geom.SimpleGeometry);ol.geom.Polygon.prototype.appendLinearRing=function(e){this.flatCoordinates?ol.array.extend(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice();this.ends_.push(this.flatCoordinates.length);this.changed()};ol.geom.Polygon.prototype.clone=function(){var e=new ol.geom.Polygon(null);e.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),this.ends_.slice());return e};ol.geom.Polygon.prototype.closestPointXY=function(e,t,o,r){if(r<ol.extent.closestSquaredDistanceXY(this.getExtent(),e,t))return r;if(this.maxDeltaRevision_!=this.getRevision()){this.maxDelta_=Math.sqrt(ol.geom.flat.closest.getsMaxSquaredDelta(this.flatCoordinates,0,this.ends_,this.stride,0));this.maxDeltaRevision_=this.getRevision()}return ol.geom.flat.closest.getsClosestPoint(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,o,r)};ol.geom.Polygon.prototype.containsXY=function(e,t){return ol.geom.flat.contains.linearRingsContainsXY(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)};ol.geom.Polygon.prototype.getArea=function(){return ol.geom.flat.area.linearRings(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)};ol.geom.Polygon.prototype.getCoordinates=function(e){var t;if(void 0!==e){t=this.getOrientedFlatCoordinates().slice();ol.geom.flat.orient.orientLinearRings(t,0,this.ends_,this.stride,e)}else t=this.flatCoordinates;return ol.geom.flat.inflate.coordinatess(t,0,this.ends_,this.stride)};ol.geom.Polygon.prototype.getEnds=function(){return this.ends_};ol.geom.Polygon.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var e=ol.extent.getCenter(this.getExtent());this.flatInteriorPoint_=ol.geom.flat.interiorpoint.linearRings(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0);this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_};ol.geom.Polygon.prototype.getInteriorPoint=function(){return new ol.geom.Point(this.getFlatInteriorPoint())};ol.geom.Polygon.prototype.getLinearRingCount=function(){return this.ends_.length};ol.geom.Polygon.prototype.getLinearRing=function(e){if(0>e||this.ends_.length<=e)return null;var t=new ol.geom.LinearRing(null);t.setFlatCoordinates(this.layout,this.flatCoordinates.slice(0===e?0:this.ends_[e-1],this.ends_[e]));return t};ol.geom.Polygon.prototype.getLinearRings=function(){var e,t,o=this.layout,r=this.flatCoordinates,i=this.ends_,n=[],a=0;for(e=0,t=i.length;t>e;++e){var l=i[e],s=new ol.geom.LinearRing(null);s.setFlatCoordinates(o,r.slice(a,l));n.push(s);a=l}return n};ol.geom.Polygon.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var e=this.flatCoordinates;if(ol.geom.flat.orient.linearRingsAreOriented(e,0,this.ends_,this.stride))this.orientedFlatCoordinates_=e;else{this.orientedFlatCoordinates_=e.slice();this.orientedFlatCoordinates_.length=ol.geom.flat.orient.orientLinearRings(this.orientedFlatCoordinates_,0,this.ends_,this.stride)}this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_};ol.geom.Polygon.prototype.getSimplifiedGeometryInternal=function(e){var t=[],o=[];t.length=ol.geom.flat.simplify.quantizes(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,o);var r=new ol.geom.Polygon(null);r.setFlatCoordinates(ol.geom.GeometryLayout.XY,t,o);return r};ol.geom.Polygon.prototype.getType=function(){return ol.geom.GeometryType.POLYGON};ol.geom.Polygon.prototype.intersectsExtent=function(e){return ol.geom.flat.intersectsextent.linearRings(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)};ol.geom.Polygon.prototype.setCoordinates=function(e,t){if(e){this.setLayout(t,e,2);this.flatCoordinates||(this.flatCoordinates=[]);var o=ol.geom.flat.deflate.coordinatess(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=0===o.length?0:o[o.length-1];this.changed()}else this.setFlatCoordinates(ol.geom.GeometryLayout.XY,null,this.ends_)};ol.geom.Polygon.prototype.setFlatCoordinates=function(e,t,o){this.setFlatCoordinatesInternal(e,t);this.ends_=o;this.changed()};ol.geom.Polygon.circular=function(e,t,o,r){var i,n=r?r:32,a=[];for(i=0;n>i;++i)ol.array.extend(a,e.offset(t,o,2*Math.PI*i/n));a.push(a[0],a[1]);var l=new ol.geom.Polygon(null);l.setFlatCoordinates(ol.geom.GeometryLayout.XY,a,[a.length]);return l};ol.geom.Polygon.fromExtent=function(e){var t=e[0],o=e[1],r=e[2],i=e[3],n=[t,o,t,i,r,i,r,o,t,o],a=new ol.geom.Polygon(null);a.setFlatCoordinates(ol.geom.GeometryLayout.XY,n,[n.length]);return a};ol.geom.Polygon.fromCircle=function(e,t,o){for(var r=t?t:32,i=e.getStride(),n=e.getLayout(),a=new ol.geom.Polygon(null,n),l=i*(r+1),s=new Array(l),p=0;l>p;p++)s[p]=0;var c=[s.length];a.setFlatCoordinates(n,s,c);ol.geom.Polygon.makeRegular(a,e.getCenter(),e.getRadius(),o);return a};ol.geom.Polygon.makeRegular=function(e,t,o,r){for(var i,n,a=e.getFlatCoordinates(),l=e.getLayout(),s=e.getStride(),p=e.getEnds(),c=a.length/s-1,u=r?r:0,g=0;c>=g;++g){n=g*s;i=u+2*ol.math.modulo(g,c)*Math.PI/c;a[n]=t[0]+o*Math.cos(i);a[n+1]=t[1]+o*Math.sin(i)}e.setFlatCoordinates(l,a,p)};goog.provide("ol.View");goog.require("ol");goog.require("ol.CenterConstraint");goog.require("ol.Constraints");goog.require("ol.Object");goog.require("ol.ResolutionConstraint");goog.require("ol.RotationConstraint");goog.require("ol.ViewHint");goog.require("ol.ViewProperty");goog.require("ol.array");goog.require("ol.asserts");goog.require("ol.coordinate");goog.require("ol.easing");goog.require("ol.extent");goog.require("ol.geom.GeometryType");goog.require("ol.geom.Polygon");goog.require("ol.geom.SimpleGeometry");goog.require("ol.obj");goog.require("ol.proj");goog.require("ol.proj.Units");ol.View=function(e){ol.Object.call(this);var t=ol.obj.assign({},e);this.hints_=[0,0];this.animations_=[];this.updateAnimationKey_;this.updateAnimations_=this.updateAnimations_.bind(this);this.projection_=ol.proj.createProjection(t.projection,"EPSG:3857");this.applyOptions_(t)};ol.inherits(ol.View,ol.Object);ol.View.prototype.applyOptions_=function(e){var t={};t[ol.ViewProperty.CENTER]=void 0!==e.center?e.center:null;var o=ol.View.createResolutionConstraint_(e);this.maxResolution_=o.maxResolution;this.minResolution_=o.minResolution;this.zoomFactor_=o.zoomFactor;this.resolutions_=e.resolutions;this.minZoom_=o.minZoom;var r=ol.View.createCenterConstraint_(e),i=o.constraint,n=ol.View.createRotationConstraint_(e);this.constraints_=new ol.Constraints(r,i,n);void 0!==e.resolution?t[ol.ViewProperty.RESOLUTION]=e.resolution:void 0!==e.zoom&&(t[ol.ViewProperty.RESOLUTION]=this.constrainResolution(this.maxResolution_,e.zoom-this.minZoom_));t[ol.ViewProperty.ROTATION]=void 0!==e.rotation?e.rotation:0;this.setProperties(t);this.options_=e};ol.View.prototype.getUpdatedOptions_=function(e){var t=ol.obj.assign({},this.options_);void 0!==t.resolution?t.resolution=this.getResolution():t.zoom=this.getZoom();t.center=this.getCenter();t.rotation=this.getRotation();return ol.obj.assign({},t,e)};ol.View.prototype.animate=function(e){var t,o=Date.now(),r=this.getCenter().slice(),i=this.getResolution(),n=this.getRotation(),a=arguments.length;if(a>1&&"function"==typeof arguments[a-1]){t=arguments[a-1];--a}for(var l=[],s=0;a>s;++s){var p=arguments[s],c={start:o,complete:!1,anchor:p.anchor,duration:void 0!==p.duration?p.duration:1e3,easing:p.easing||ol.easing.inAndOut};if(p.center){c.sourceCenter=r;c.targetCenter=p.center;r=c.targetCenter}if(void 0!==p.zoom){c.sourceResolution=i;c.targetResolution=this.constrainResolution(this.maxResolution_,p.zoom-this.minZoom_,0);i=c.targetResolution}else if(p.resolution){c.sourceResolution=i;c.targetResolution=p.resolution;i=c.targetResolution}if(void 0!==p.rotation){c.sourceRotation=n;c.targetRotation=p.rotation;n=c.targetRotation}c.callback=t;o+=c.duration;l.push(c)}this.animations_.push(l);this.setHint(ol.ViewHint.ANIMATING,1);this.updateAnimations_()};ol.View.prototype.getAnimating=function(){return this.getHints()[ol.ViewHint.ANIMATING]>0};ol.View.prototype.cancelAnimations=function(){this.setHint(ol.ViewHint.ANIMATING,-this.getHints()[ol.ViewHint.ANIMATING]);for(var e=0,t=this.animations_.length;t>e;++e){var o=this.animations_[e];o[0].callback&&o[0].callback(!1)}this.animations_.length=0};ol.View.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_){cancelAnimationFrame(this.updateAnimationKey_);this.updateAnimationKey_=void 0}if(this.getAnimating()){for(var e=Date.now(),t=!1,o=this.animations_.length-1;o>=0;--o){for(var r=this.animations_[o],i=!0,n=0,a=r.length;a>n;++n){var l=r[n];if(!l.complete){var s=e-l.start,p=l.duration>0?s/l.duration:1;if(p>=1){l.complete=!0;p=1}else i=!1;var c=l.easing(p);if(l.sourceCenter){var u=l.sourceCenter[0],g=l.sourceCenter[1],d=l.targetCenter[0],h=l.targetCenter[1],f=u+c*(d-u),y=g+c*(h-g);this.set(ol.ViewProperty.CENTER,[f,y])}if(l.sourceResolution&&l.targetResolution){var m=1===c?l.targetResolution:l.sourceResolution+c*(l.targetResolution-l.sourceResolution);l.anchor&&this.set(ol.ViewProperty.CENTER,this.calculateCenterZoom(m,l.anchor));this.set(ol.ViewProperty.RESOLUTION,m)}if(void 0!==l.sourceRotation&&void 0!==l.targetRotation){var v=1===c?l.targetRotation:l.sourceRotation+c*(l.targetRotation-l.sourceRotation);l.anchor&&this.set(ol.ViewProperty.CENTER,this.calculateCenterRotate(v,l.anchor));this.set(ol.ViewProperty.ROTATION,v)}t=!0;if(!l.complete)break}}if(i){this.animations_[o]=null;this.setHint(ol.ViewHint.ANIMATING,-1);var C=r[0].callback;C&&C(!0)}}this.animations_=this.animations_.filter(Boolean);t&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_))}};ol.View.prototype.calculateCenterRotate=function(e,t){var o,r=this.getCenter();if(void 0!==r){o=[r[0]-t[0],r[1]-t[1]];ol.coordinate.rotate(o,e-this.getRotation());ol.coordinate.add(o,t)}return o};ol.View.prototype.calculateCenterZoom=function(e,t){var o,r=this.getCenter(),i=this.getResolution();if(void 0!==r&&void 0!==i){var n=t[0]-e*(t[0]-r[0])/i,a=t[1]-e*(t[1]-r[1])/i;o=[n,a]}return o};ol.View.prototype.getSizeFromViewport_=function(){var e=[100,100],t='.ol-viewport[data-view="'+ol.getUid(this)+'"]',o=document.querySelector(t);if(o){var r=getComputedStyle(o);e[0]=parseInt(r.width,10);e[1]=parseInt(r.height,10)}return e};ol.View.prototype.constrainCenter=function(e){return this.constraints_.center(e)};ol.View.prototype.constrainResolution=function(e,t,o){var r=t||0,i=o||0;return this.constraints_.resolution(e,r,i)};ol.View.prototype.constrainRotation=function(e,t){var o=t||0;return this.constraints_.rotation(e,o)};ol.View.prototype.getCenter=function(){return this.get(ol.ViewProperty.CENTER)};ol.View.prototype.getHints=function(e){if(void 0!==e){e[0]=this.hints_[0];e[1]=this.hints_[1];return e}return this.hints_.slice()};ol.View.prototype.calculateExtent=function(e){var t=e||this.getSizeFromViewport_(),o=this.getCenter();ol.asserts.assert(o,1);var r=this.getResolution();ol.asserts.assert(void 0!==r,2);var i=this.getRotation();ol.asserts.assert(void 0!==i,3);return ol.extent.getForViewAndSize(o,r,i,t)};ol.View.prototype.getMaxResolution=function(){return this.maxResolution_};ol.View.prototype.getMinResolution=function(){return this.minResolution_};ol.View.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)};ol.View.prototype.setMaxZoom=function(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))};ol.View.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)};ol.View.prototype.setMinZoom=function(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))};ol.View.prototype.getProjection=function(){return this.projection_};ol.View.prototype.getResolution=function(){return this.get(ol.ViewProperty.RESOLUTION)};ol.View.prototype.getResolutions=function(){return this.resolutions_};ol.View.prototype.getResolutionForExtent=function(e,t){var o=ol.extent.getWidth(e)/t[0],r=ol.extent.getHeight(e)/t[1];return Math.max(o,r)};ol.View.prototype.getResolutionForValueFunction=function(e){var t=e||2,o=this.maxResolution_,r=this.minResolution_,i=Math.log(o/r)/Math.log(t);return function(e){var r=o/Math.pow(t,e*i);return r}};ol.View.prototype.getRotation=function(){return this.get(ol.ViewProperty.ROTATION)};ol.View.prototype.getValueForResolutionFunction=function(e){var t=e||2,o=this.maxResolution_,r=this.minResolution_,i=Math.log(o/r)/Math.log(t);return function(e){var r=Math.log(o/e)/Math.log(t)/i;return r}};ol.View.prototype.getState=function(){var e=this.getCenter(),t=this.getProjection(),o=this.getResolution(),r=this.getRotation();return{center:e.slice(),projection:void 0!==t?t:null,resolution:o,rotation:r}};ol.View.prototype.getZoom=function(){var e,t=this.getResolution();void 0!==t&&(e=this.getZoomForResolution(t));return e};ol.View.prototype.getZoomForResolution=function(e){var t;if(e>=this.minResolution_&&e<=this.maxResolution_){var o,r,i=this.minZoom_||0;if(this.resolutions_){var n=ol.array.linearFindNearest(this.resolutions_,e,1);i+=n;if(n==this.resolutions_.length-1)return i;o=this.resolutions_[n];r=o/this.resolutions_[n+1]}else{o=this.maxResolution_;r=this.zoomFactor_}t=i+Math.log(o/e)/Math.log(r)}return t};ol.View.prototype.fit=function(e,t){var o=t||{},r=o.size;r||(r=this.getSizeFromViewport_());var i;if(e instanceof ol.geom.SimpleGeometry)if(e.getType()===ol.geom.GeometryType.CIRCLE){e=e.getExtent();i=ol.geom.Polygon.fromExtent(e);i.rotate(this.getRotation(),ol.extent.getCenter(e))}else i=e;else{ol.asserts.assert(Array.isArray(e),24);ol.asserts.assert(!ol.extent.isEmpty(e),25);i=ol.geom.Polygon.fromExtent(e)}var n,a=void 0!==o.padding?o.padding:[0,0,0,0],l=void 0!==o.constrainResolution?o.constrainResolution:!0,s=void 0!==o.nearest?o.nearest:!1;n=void 0!==o.minResolution?o.minResolution:void 0!==o.maxZoom?this.constrainResolution(this.maxResolution_,o.maxZoom-this.minZoom_,0):0;for(var p=i.getFlatCoordinates(),c=this.getRotation(),u=Math.cos(-c),g=Math.sin(-c),d=+(1/0),h=+(1/0),f=-(1/0),y=-(1/0),m=i.getStride(),v=0,C=p.length;C>v;v+=m){var T=p[v]*u-p[v+1]*g,_=p[v]*g+p[v+1]*u;d=Math.min(d,T);h=Math.min(h,_);f=Math.max(f,T);y=Math.max(y,_)}var S=this.getResolutionForExtent([d,h,f,y],[r[0]-a[1]-a[3],r[1]-a[0]-a[2]]);S=isNaN(S)?n:Math.max(S,n);if(l){var E=this.constrainResolution(S,0,0);!s&&S>E&&(E=this.constrainResolution(E,-1,0));S=E}g=-g;var x=(d+f)/2,P=(h+y)/2;x+=(a[1]-a[3])/2*S;P+=(a[0]-a[2])/2*S;var L=x*u-P*g,w=P*u+x*g,R=[L,w];if(void 0!==o.duration)this.animate({resolution:S,center:R,duration:o.duration,easing:o.easing});else{this.setResolution(S);this.setCenter(R)}};ol.View.prototype.centerOn=function(e,t,o){var r=this.getRotation(),i=Math.cos(-r),n=Math.sin(-r),a=e[0]*i-e[1]*n,l=e[1]*i+e[0]*n,s=this.getResolution();a+=(t[0]/2-o[0])*s;l+=(o[1]-t[1]/2)*s;n=-n;var p=a*i-l*n,c=l*i+a*n;this.setCenter([p,c])};ol.View.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()};ol.View.prototype.rotate=function(e,t){if(void 0!==t){var o=this.calculateCenterRotate(e,t);this.setCenter(o)}this.setRotation(e)};ol.View.prototype.setCenter=function(e){this.set(ol.ViewProperty.CENTER,e);this.getAnimating()&&this.cancelAnimations()};ol.View.prototype.setHint=function(e,t){this.hints_[e]+=t;this.changed();return this.hints_[e]};ol.View.prototype.setResolution=function(e){this.set(ol.ViewProperty.RESOLUTION,e);this.getAnimating()&&this.cancelAnimations()};ol.View.prototype.setRotation=function(e){this.set(ol.ViewProperty.ROTATION,e);this.getAnimating()&&this.cancelAnimations()};ol.View.prototype.setZoom=function(e){var t=this.constrainResolution(this.maxResolution_,e-this.minZoom_,0);this.setResolution(t)};ol.View.createCenterConstraint_=function(e){return void 0!==e.extent?ol.CenterConstraint.createExtent(e.extent):ol.CenterConstraint.none};ol.View.createResolutionConstraint_=function(e){var t,o,r,i=28,n=2,a=void 0!==e.minZoom?e.minZoom:ol.DEFAULT_MIN_ZOOM,l=void 0!==e.maxZoom?e.maxZoom:i,s=void 0!==e.zoomFactor?e.zoomFactor:n;if(void 0!==e.resolutions){var p=e.resolutions;o=p[0];r=p[p.length-1];t=ol.ResolutionConstraint.createSnapToResolutions(p)}else{var c=ol.proj.createProjection(e.projection,"EPSG:3857"),u=c.getExtent(),g=u?Math.max(ol.extent.getWidth(u),ol.extent.getHeight(u)):360*ol.proj.METERS_PER_UNIT[ol.proj.Units.DEGREES]/c.getMetersPerUnit(),d=g/ol.DEFAULT_TILE_SIZE/Math.pow(n,ol.DEFAULT_MIN_ZOOM),h=d/Math.pow(n,i-ol.DEFAULT_MIN_ZOOM);o=e.maxResolution;void 0!==o?a=0:o=d/Math.pow(s,a);r=e.minResolution;void 0===r&&(r=void 0!==e.maxZoom?void 0!==e.maxResolution?o/Math.pow(s,l):d/Math.pow(s,l):h);l=a+Math.floor(Math.log(o/r)/Math.log(s));r=o/Math.pow(s,l-a);t=ol.ResolutionConstraint.createSnapToPower(s,o,l-a)}return{constraint:t,maxResolution:o,minResolution:r,minZoom:a,zoomFactor:s}};ol.View.createRotationConstraint_=function(e){var t=void 0!==e.enableRotation?e.enableRotation:!0;if(t){var o=e.constrainRotation;return void 0===o||o===!0?ol.RotationConstraint.createSnapToZero():o===!1?ol.RotationConstraint.none:"number"==typeof o?ol.RotationConstraint.createSnapToN(o):ol.RotationConstraint.none}return ol.RotationConstraint.disable};goog.provide("ol.Kinetic");ol.Kinetic=function(e,t,o){this.decay_=e;this.minVelocity_=t;this.delay_=o;this.points_=[];this.angle_=0;this.initialVelocity_=0};ol.Kinetic.prototype.begin=function(){this.points_.length=0;this.angle_=0;this.initialVelocity_=0};ol.Kinetic.prototype.update=function(e,t){this.points_.push(e,t,Date.now())};ol.Kinetic.prototype.end=function(){if(this.points_.length<6)return!1;var e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;for(var o=t-3;o>0&&this.points_[o+2]>e;)o-=3;var r=this.points_[t+2]-this.points_[o+2],i=this.points_[t]-this.points_[o],n=this.points_[t+1]-this.points_[o+1];this.angle_=Math.atan2(n,i);this.initialVelocity_=Math.sqrt(i*i+n*n)/r;return this.initialVelocity_>this.minVelocity_};ol.Kinetic.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_};ol.Kinetic.prototype.getAngle=function(){return this.angle_};goog.provide("ol.interaction.Property");ol.interaction.Property={ACTIVE:"active"};goog.provide("ol.interaction.Interaction");goog.require("ol");goog.require("ol.Object");goog.require("ol.easing");goog.require("ol.interaction.Property");ol.interaction.Interaction=function(e){ol.Object.call(this);this.map_=null;this.setActive(!0);this.handleEvent=e.handleEvent};ol.inherits(ol.interaction.Interaction,ol.Object);ol.interaction.Interaction.prototype.getActive=function(){return this.get(ol.interaction.Property.ACTIVE)};ol.interaction.Interaction.prototype.getMap=function(){return this.map_};ol.interaction.Interaction.prototype.setActive=function(e){this.set(ol.interaction.Property.ACTIVE,e)};ol.interaction.Interaction.prototype.setMap=function(e){this.map_=e};ol.interaction.Interaction.pan=function(e,t,o){var r=e.getCenter();if(r){var i=e.constrainCenter([r[0]+t[0],r[1]+t[1]]);o?e.animate({duration:o,easing:ol.easing.linear,center:i}):e.setCenter(i)}};ol.interaction.Interaction.rotate=function(e,t,o,r){t=e.constrainRotation(t,0);ol.interaction.Interaction.rotateWithoutConstraints(e,t,o,r)};ol.interaction.Interaction.rotateWithoutConstraints=function(e,t,o,r){if(void 0!==t){var i=e.getRotation(),n=e.getCenter();void 0!==i&&n&&r>0?e.animate({rotation:t,anchor:o,duration:r,easing:ol.easing.easeOut}):e.rotate(t,o)}};ol.interaction.Interaction.zoom=function(e,t,o,r,i){t=e.constrainResolution(t,0,i);ol.interaction.Interaction.zoomWithoutConstraints(e,t,o,r)};ol.interaction.Interaction.zoomByDelta=function(e,t,o,r){var i=e.getResolution(),n=e.constrainResolution(i,t,0);if(o&&void 0!==n&&n!==i){var a=e.getCenter(),l=e.calculateCenterZoom(n,o);l=e.constrainCenter(l);o=[(n*a[0]-i*l[0])/(n-i),(n*a[1]-i*l[1])/(n-i)]}ol.interaction.Interaction.zoomWithoutConstraints(e,n,o,r)};ol.interaction.Interaction.zoomWithoutConstraints=function(e,t,o,r){if(t){var i=e.getResolution(),n=e.getCenter();if(void 0!==i&&n&&t!==i&&r)e.animate({resolution:t,anchor:o,duration:r,easing:ol.easing.easeOut});else{if(o){var a=e.calculateCenterZoom(t,o);e.setCenter(a)}e.setResolution(t)}}};goog.provide("ol.interaction.DoubleClickZoom");goog.require("ol");goog.require("ol.MapBrowserEventType");goog.require("ol.interaction.Interaction");ol.interaction.DoubleClickZoom=function(e){var t=e?e:{};this.delta_=t.delta?t.delta:1;ol.interaction.Interaction.call(this,{handleEvent:ol.interaction.DoubleClickZoom.handleEvent});this.duration_=void 0!==t.duration?t.duration:250};ol.inherits(ol.interaction.DoubleClickZoom,ol.interaction.Interaction);ol.interaction.DoubleClickZoom.handleEvent=function(e){var t=!1,o=e.originalEvent;if(e.type==ol.MapBrowserEventType.DBLCLICK){var r=e.map,i=e.coordinate,n=o.shiftKey?-this.delta_:this.delta_,a=r.getView();ol.interaction.Interaction.zoomByDelta(a,n,i,this.duration_);e.preventDefault();t=!0}return!t};goog.provide("ol.events.condition");goog.require("ol.MapBrowserEventType");goog.require("ol.asserts");goog.require("ol.functions");goog.require("ol.has");ol.events.condition.altKeyOnly=function(e){var t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey};ol.events.condition.altShiftKeysOnly=function(e){var t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey};ol.events.condition.always=ol.functions.TRUE;ol.events.condition.click=function(e){return e.type==ol.MapBrowserEventType.CLICK};ol.events.condition.mouseActionButton=function(e){var t=e.originalEvent;return 0==t.button&&!(ol.has.WEBKIT&&ol.has.MAC&&t.ctrlKey)};ol.events.condition.never=ol.functions.FALSE;ol.events.condition.pointerMove=function(e){return"pointermove"==e.type};ol.events.condition.singleClick=function(e){return e.type==ol.MapBrowserEventType.SINGLECLICK};ol.events.condition.doubleClick=function(e){return e.type==ol.MapBrowserEventType.DBLCLICK};ol.events.condition.noModifierKeys=function(e){var t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey};ol.events.condition.platformModifierKeyOnly=function(e){var t=e.originalEvent;return!t.altKey&&(ol.has.MAC?t.metaKey:t.ctrlKey)&&!t.shiftKey};ol.events.condition.shiftKeyOnly=function(e){var t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey};ol.events.condition.targetNotEditable=function(e){var t=e.originalEvent.target,o=t.tagName;return"INPUT"!==o&&"SELECT"!==o&&"TEXTAREA"!==o};ol.events.condition.mouseOnly=function(e){ol.asserts.assert(e.pointerEvent,56);return"mouse"==e.pointerEvent.pointerType};ol.events.condition.primaryAction=function(e){var t=e.pointerEvent;return t.isPrimary&&0===t.button};goog.provide("ol.interaction.Pointer");goog.require("ol");goog.require("ol.functions");goog.require("ol.MapBrowserEventType");goog.require("ol.MapBrowserPointerEvent");goog.require("ol.interaction.Interaction");goog.require("ol.obj");ol.interaction.Pointer=function(e){var t=e?e:{},o=t.handleEvent?t.handleEvent:ol.interaction.Pointer.handleEvent;ol.interaction.Interaction.call(this,{handleEvent:o});this.handleDownEvent_=t.handleDownEvent?t.handleDownEvent:ol.interaction.Pointer.handleDownEvent;this.handleDragEvent_=t.handleDragEvent?t.handleDragEvent:ol.interaction.Pointer.handleDragEvent;this.handleMoveEvent_=t.handleMoveEvent?t.handleMoveEvent:ol.interaction.Pointer.handleMoveEvent;this.handleUpEvent_=t.handleUpEvent?t.handleUpEvent:ol.interaction.Pointer.handleUpEvent;this.handlingDownUpSequence=!1;this.trackedPointers_={};this.targetPointers=[]};ol.inherits(ol.interaction.Pointer,ol.interaction.Interaction);ol.interaction.Pointer.centroid=function(e){for(var t=e.length,o=0,r=0,i=0;t>i;i++){o+=e[i].clientX;

r+=e[i].clientY}return[o/t,r/t]};ol.interaction.Pointer.prototype.isPointerDraggingEvent_=function(e){var t=e.type;return t===ol.MapBrowserEventType.POINTERDOWN||t===ol.MapBrowserEventType.POINTERDRAG||t===ol.MapBrowserEventType.POINTERUP};ol.interaction.Pointer.prototype.updateTrackedPointers_=function(e){if(this.isPointerDraggingEvent_(e)){var t=e.pointerEvent;e.type==ol.MapBrowserEventType.POINTERUP?delete this.trackedPointers_[t.pointerId]:e.type==ol.MapBrowserEventType.POINTERDOWN?this.trackedPointers_[t.pointerId]=t:t.pointerId in this.trackedPointers_&&(this.trackedPointers_[t.pointerId]=t);this.targetPointers=ol.obj.getValues(this.trackedPointers_)}};ol.interaction.Pointer.handleDragEvent=ol.nullFunction;ol.interaction.Pointer.handleUpEvent=ol.functions.FALSE;ol.interaction.Pointer.handleDownEvent=ol.functions.FALSE;ol.interaction.Pointer.handleMoveEvent=ol.nullFunction;ol.interaction.Pointer.handleEvent=function(e){if(!(e instanceof ol.MapBrowserPointerEvent))return!0;var t=!1;this.updateTrackedPointers_(e);if(this.handlingDownUpSequence){if(e.type==ol.MapBrowserEventType.POINTERDRAG)this.handleDragEvent_(e);else if(e.type==ol.MapBrowserEventType.POINTERUP){var o=this.handleUpEvent_(e);this.handlingDownUpSequence=o&&this.targetPointers.length>0}}else if(e.type==ol.MapBrowserEventType.POINTERDOWN){var r=this.handleDownEvent_(e);this.handlingDownUpSequence=r;t=this.shouldStopEvent(r)}else e.type==ol.MapBrowserEventType.POINTERMOVE&&this.handleMoveEvent_(e);return!t};ol.interaction.Pointer.prototype.shouldStopEvent=function(e){return e};goog.provide("ol.interaction.DragPan");goog.require("ol");goog.require("ol.ViewHint");goog.require("ol.coordinate");goog.require("ol.easing");goog.require("ol.events.condition");goog.require("ol.functions");goog.require("ol.interaction.Pointer");ol.interaction.DragPan=function(e){ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.DragPan.handleDownEvent_,handleDragEvent:ol.interaction.DragPan.handleDragEvent_,handleUpEvent:ol.interaction.DragPan.handleUpEvent_});var t=e?e:{};this.kinetic_=t.kinetic;this.lastCentroid=null;this.lastPointersCount_;this.condition_=t.condition?t.condition:ol.events.condition.noModifierKeys;this.noKinetic_=!1};ol.inherits(ol.interaction.DragPan,ol.interaction.Pointer);ol.interaction.DragPan.handleDragEvent_=function(e){var t=this.targetPointers,o=ol.interaction.Pointer.centroid(t);if(t.length==this.lastPointersCount_){this.kinetic_&&this.kinetic_.update(o[0],o[1]);if(this.lastCentroid){var r=this.lastCentroid[0]-o[0],i=o[1]-this.lastCentroid[1],n=e.map,a=n.getView(),l=a.getState(),s=[r,i];ol.coordinate.scale(s,l.resolution);ol.coordinate.rotate(s,l.rotation);ol.coordinate.add(s,l.center);s=a.constrainCenter(s);a.setCenter(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=o;this.lastPointersCount_=t.length};ol.interaction.DragPan.handleUpEvent_=function(e){var t=e.map,o=t.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var r=this.kinetic_.getDistance(),i=this.kinetic_.getAngle(),n=o.getCenter(),a=t.getPixelFromCoordinate(n),l=t.getCoordinateFromPixel([a[0]-r*Math.cos(i),a[1]-r*Math.sin(i)]);o.animate({center:o.constrainCenter(l),duration:500,easing:ol.easing.easeOut})}o.setHint(ol.ViewHint.INTERACTING,-1);return!1}this.kinetic_&&this.kinetic_.begin();this.lastCentroid=null;return!0};ol.interaction.DragPan.handleDownEvent_=function(e){if(this.targetPointers.length>0&&this.condition_(e)){var t=e.map,o=t.getView();this.lastCentroid=null;this.handlingDownUpSequence||o.setHint(ol.ViewHint.INTERACTING,1);o.getHints()[ol.ViewHint.ANIMATING]&&o.setCenter(e.frameState.viewState.center);this.kinetic_&&this.kinetic_.begin();this.noKinetic_=this.targetPointers.length>1;return!0}return!1};ol.interaction.DragPan.prototype.shouldStopEvent=ol.functions.FALSE;goog.provide("ol.interaction.DragRotate");goog.require("ol");goog.require("ol.ViewHint");goog.require("ol.events.condition");goog.require("ol.functions");goog.require("ol.interaction.Interaction");goog.require("ol.interaction.Pointer");ol.interaction.DragRotate=function(e){var t=e?e:{};ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.DragRotate.handleDownEvent_,handleDragEvent:ol.interaction.DragRotate.handleDragEvent_,handleUpEvent:ol.interaction.DragRotate.handleUpEvent_});this.condition_=t.condition?t.condition:ol.events.condition.altShiftKeysOnly;this.lastAngle_=void 0;this.duration_=void 0!==t.duration?t.duration:250};ol.inherits(ol.interaction.DragRotate,ol.interaction.Pointer);ol.interaction.DragRotate.handleDragEvent_=function(e){if(ol.events.condition.mouseOnly(e)){var t=e.map,o=t.getSize(),r=e.pixel,i=Math.atan2(o[1]/2-r[1],r[0]-o[0]/2);if(void 0!==this.lastAngle_){var n=i-this.lastAngle_,a=t.getView(),l=a.getRotation();ol.interaction.Interaction.rotateWithoutConstraints(a,l-n)}this.lastAngle_=i}};ol.interaction.DragRotate.handleUpEvent_=function(e){if(!ol.events.condition.mouseOnly(e))return!0;var t=e.map,o=t.getView();o.setHint(ol.ViewHint.INTERACTING,-1);var r=o.getRotation();ol.interaction.Interaction.rotate(o,r,void 0,this.duration_);return!1};ol.interaction.DragRotate.handleDownEvent_=function(e){if(!ol.events.condition.mouseOnly(e))return!1;if(ol.events.condition.mouseActionButton(e)&&this.condition_(e)){var t=e.map;t.getView().setHint(ol.ViewHint.INTERACTING,1);this.lastAngle_=void 0;return!0}return!1};ol.interaction.DragRotate.prototype.shouldStopEvent=ol.functions.FALSE;goog.provide("ol.render.Box");goog.require("ol");goog.require("ol.Disposable");goog.require("ol.geom.Polygon");ol.render.Box=function(e){this.geometry_=null;this.element_=document.createElement("div");this.element_.style.position="absolute";this.element_.className="ol-box "+e;this.map_=null;this.startPixel_=null;this.endPixel_=null};ol.inherits(ol.render.Box,ol.Disposable);ol.render.Box.prototype.disposeInternal=function(){this.setMap(null)};ol.render.Box.prototype.render_=function(){var e=this.startPixel_,t=this.endPixel_,o="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+o;r.top=Math.min(e[1],t[1])+o;r.width=Math.abs(t[0]-e[0])+o;r.height=Math.abs(t[1]-e[1])+o};ol.render.Box.prototype.setMap=function(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var t=this.element_.style;t.left=t.top=t.width=t.height="inherit"}this.map_=e;this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)};ol.render.Box.prototype.setPixels=function(e,t){this.startPixel_=e;this.endPixel_=t;this.createOrUpdateGeometry();this.render_()};ol.render.Box.prototype.createOrUpdateGeometry=function(){var e=this.startPixel_,t=this.endPixel_,o=[e,[e[0],t[1]],t,[t[0],e[1]]],r=o.map(this.map_.getCoordinateFromPixel,this.map_);r[4]=r[0].slice();this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new ol.geom.Polygon([r])};ol.render.Box.prototype.getGeometry=function(){return this.geometry_};goog.provide("ol.interaction.DragBox");goog.require("ol.events.Event");goog.require("ol");goog.require("ol.events.condition");goog.require("ol.interaction.Pointer");goog.require("ol.render.Box");ol.interaction.DragBox=function(e){ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.DragBox.handleDownEvent_,handleDragEvent:ol.interaction.DragBox.handleDragEvent_,handleUpEvent:ol.interaction.DragBox.handleUpEvent_});var t=e?e:{};this.box_=new ol.render.Box(t.className||"ol-dragbox");this.minArea_=void 0!==t.minArea?t.minArea:64;this.startPixel_=null;this.condition_=t.condition?t.condition:ol.events.condition.always;this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:ol.interaction.DragBox.defaultBoxEndCondition};ol.inherits(ol.interaction.DragBox,ol.interaction.Pointer);ol.interaction.DragBox.defaultBoxEndCondition=function(e,t,o){var r=o[0]-t[0],i=o[1]-t[1];return r*r+i*i>=this.minArea_};ol.interaction.DragBox.handleDragEvent_=function(e){if(ol.events.condition.mouseOnly(e)){this.box_.setPixels(this.startPixel_,e.pixel);this.dispatchEvent(new ol.interaction.DragBox.Event(ol.interaction.DragBox.EventType_.BOXDRAG,e.coordinate,e))}};ol.interaction.DragBox.prototype.getGeometry=function(){return this.box_.getGeometry()};ol.interaction.DragBox.prototype.onBoxEnd=ol.nullFunction;ol.interaction.DragBox.handleUpEvent_=function(e){if(!ol.events.condition.mouseOnly(e))return!0;this.box_.setMap(null);if(this.boxEndCondition_(e,this.startPixel_,e.pixel)){this.onBoxEnd(e);this.dispatchEvent(new ol.interaction.DragBox.Event(ol.interaction.DragBox.EventType_.BOXEND,e.coordinate,e))}return!1};ol.interaction.DragBox.handleDownEvent_=function(e){if(!ol.events.condition.mouseOnly(e))return!1;if(ol.events.condition.mouseActionButton(e)&&this.condition_(e)){this.startPixel_=e.pixel;this.box_.setMap(e.map);this.box_.setPixels(this.startPixel_,this.startPixel_);this.dispatchEvent(new ol.interaction.DragBox.Event(ol.interaction.DragBox.EventType_.BOXSTART,e.coordinate,e));return!0}return!1};ol.interaction.DragBox.EventType_={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend"};ol.interaction.DragBox.Event=function(e,t,o){ol.events.Event.call(this,e);this.coordinate=t;this.mapBrowserEvent=o};ol.inherits(ol.interaction.DragBox.Event,ol.events.Event);goog.provide("ol.interaction.DragZoom");goog.require("ol");goog.require("ol.easing");goog.require("ol.events.condition");goog.require("ol.extent");goog.require("ol.interaction.DragBox");ol.interaction.DragZoom=function(e){var t=e?e:{},o=t.condition?t.condition:ol.events.condition.shiftKeyOnly;this.duration_=void 0!==t.duration?t.duration:200;this.out_=void 0!==t.out?t.out:!1;ol.interaction.DragBox.call(this,{condition:o,className:t.className||"ol-dragzoom"})};ol.inherits(ol.interaction.DragZoom,ol.interaction.DragBox);ol.interaction.DragZoom.prototype.onBoxEnd=function(){var e=this.getMap(),t=e.getView(),o=e.getSize(),r=this.getGeometry().getExtent();if(this.out_){var i=t.calculateExtent(o),n=ol.extent.createOrUpdateFromCoordinates([e.getPixelFromCoordinate(ol.extent.getBottomLeft(r)),e.getPixelFromCoordinate(ol.extent.getTopRight(r))]),a=t.getResolutionForExtent(n,o);ol.extent.scaleFromCenter(i,1/a);r=i}var l=t.constrainResolution(t.getResolutionForExtent(r,o)),s=ol.extent.getCenter(r);s=t.constrainCenter(s);t.animate({resolution:l,center:s,duration:this.duration_,easing:ol.easing.easeOut})};goog.provide("ol.events.KeyCode");ol.events.KeyCode={LEFT:37,UP:38,RIGHT:39,DOWN:40};goog.provide("ol.interaction.KeyboardPan");goog.require("ol");goog.require("ol.coordinate");goog.require("ol.events.EventType");goog.require("ol.events.KeyCode");goog.require("ol.events.condition");goog.require("ol.interaction.Interaction");ol.interaction.KeyboardPan=function(e){ol.interaction.Interaction.call(this,{handleEvent:ol.interaction.KeyboardPan.handleEvent});var t=e||{};this.defaultCondition_=function(e){return ol.events.condition.noModifierKeys(e)&&ol.events.condition.targetNotEditable(e)};this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_;this.duration_=void 0!==t.duration?t.duration:100;this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128};ol.inherits(ol.interaction.KeyboardPan,ol.interaction.Interaction);ol.interaction.KeyboardPan.handleEvent=function(e){var t=!1;if(e.type==ol.events.EventType.KEYDOWN){var o=e.originalEvent,r=o.keyCode;if(this.condition_(e)&&(r==ol.events.KeyCode.DOWN||r==ol.events.KeyCode.LEFT||r==ol.events.KeyCode.RIGHT||r==ol.events.KeyCode.UP)){var i=e.map,n=i.getView(),a=n.getResolution()*this.pixelDelta_,l=0,s=0;r==ol.events.KeyCode.DOWN?s=-a:r==ol.events.KeyCode.LEFT?l=-a:r==ol.events.KeyCode.RIGHT?l=a:s=a;var p=[l,s];ol.coordinate.rotate(p,n.getRotation());ol.interaction.Interaction.pan(n,p,this.duration_);e.preventDefault();t=!0}}return!t};goog.provide("ol.interaction.KeyboardZoom");goog.require("ol");goog.require("ol.events.EventType");goog.require("ol.events.condition");goog.require("ol.interaction.Interaction");ol.interaction.KeyboardZoom=function(e){ol.interaction.Interaction.call(this,{handleEvent:ol.interaction.KeyboardZoom.handleEvent});var t=e?e:{};this.condition_=t.condition?t.condition:ol.events.condition.targetNotEditable;this.delta_=t.delta?t.delta:1;this.duration_=void 0!==t.duration?t.duration:100};ol.inherits(ol.interaction.KeyboardZoom,ol.interaction.Interaction);ol.interaction.KeyboardZoom.handleEvent=function(e){var t=!1;if(e.type==ol.events.EventType.KEYDOWN||e.type==ol.events.EventType.KEYPRESS){var o=e.originalEvent,r=o.charCode;if(this.condition_(e)&&(r=="+".charCodeAt(0)||r=="-".charCodeAt(0))){var i=e.map,n=r=="+".charCodeAt(0)?this.delta_:-this.delta_,a=i.getView();ol.interaction.Interaction.zoomByDelta(a,n,void 0,this.duration_);e.preventDefault();t=!0}}return!t};goog.provide("ol.interaction.MouseWheelZoom");goog.require("ol");goog.require("ol.ViewHint");goog.require("ol.easing");goog.require("ol.events.EventType");goog.require("ol.has");goog.require("ol.interaction.Interaction");goog.require("ol.math");ol.interaction.MouseWheelZoom=function(e){ol.interaction.Interaction.call(this,{handleEvent:ol.interaction.MouseWheelZoom.handleEvent});var t=e||{};this.delta_=0;this.duration_=void 0!==t.duration?t.duration:250;this.timeout_=void 0!==t.timeout?t.timeout:80;this.useAnchor_=void 0!==t.useAnchor?t.useAnchor:!0;this.constrainResolution_=t.constrainResolution||!1;this.lastAnchor_=null;this.startTime_=void 0;this.timeoutId_=void 0;this.mode_=void 0;this.trackpadEventGap_=400;this.trackpadTimeoutId_=void 0;this.trackpadDeltaPerZoom_=300;this.trackpadZoomBuffer_=1.5};ol.inherits(ol.interaction.MouseWheelZoom,ol.interaction.Interaction);ol.interaction.MouseWheelZoom.handleEvent=function(e){var t=e.type;if(t!==ol.events.EventType.WHEEL&&t!==ol.events.EventType.MOUSEWHEEL)return!0;e.preventDefault();var o=e.map,r=e.originalEvent;this.useAnchor_&&(this.lastAnchor_=e.coordinate);var i;if(e.type==ol.events.EventType.WHEEL){i=r.deltaY;ol.has.FIREFOX&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(i/=ol.has.DEVICE_PIXEL_RATIO);r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(i*=40)}else if(e.type==ol.events.EventType.MOUSEWHEEL){i=-r.wheelDeltaY;ol.has.SAFARI&&(i/=3)}if(0===i)return!1;var n=Date.now();void 0===this.startTime_&&(this.startTime_=n);(!this.mode_||n-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(i)<4?ol.interaction.MouseWheelZoom.Mode_.TRACKPAD:ol.interaction.MouseWheelZoom.Mode_.WHEEL);if(this.mode_===ol.interaction.MouseWheelZoom.Mode_.TRACKPAD){var a=o.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):a.setHint(ol.ViewHint.INTERACTING,1);this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);var l=a.getResolution()*Math.pow(2,i/this.trackpadDeltaPerZoom_),s=a.getMinResolution(),p=a.getMaxResolution(),c=0;if(s>l){l=Math.max(l,s/this.trackpadZoomBuffer_);c=1}else if(l>p){l=Math.min(l,p*this.trackpadZoomBuffer_);c=-1}if(this.lastAnchor_){var u=a.calculateCenterZoom(l,this.lastAnchor_);a.setCenter(a.constrainCenter(u))}a.setResolution(l);0===c&&this.constrainResolution_&&a.animate({resolution:a.constrainResolution(l,i>0?-1:1),easing:ol.easing.easeOut,anchor:this.lastAnchor_,duration:this.duration_});c>0?a.animate({resolution:s,easing:ol.easing.easeOut,anchor:this.lastAnchor_,duration:500}):0>c&&a.animate({resolution:p,easing:ol.easing.easeOut,anchor:this.lastAnchor_,duration:500});this.startTime_=n;return!1}this.delta_+=i;var g=Math.max(this.timeout_-(n-this.startTime_),0);clearTimeout(this.timeoutId_);this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,o),g);return!1};ol.interaction.MouseWheelZoom.prototype.decrementInteractingHint_=function(){this.trackpadTimeoutId_=void 0;var e=this.getMap().getView();e.setHint(ol.ViewHint.INTERACTING,-1)};ol.interaction.MouseWheelZoom.prototype.handleWheelZoom_=function(e){var t=e.getView();t.getAnimating()&&t.cancelAnimations();var o=ol.MOUSEWHEELZOOM_MAXDELTA,r=ol.math.clamp(this.delta_,-o,o);ol.interaction.Interaction.zoomByDelta(t,-r,this.lastAnchor_,this.duration_);this.mode_=void 0;this.delta_=0;this.lastAnchor_=null;this.startTime_=void 0;this.timeoutId_=void 0};ol.interaction.MouseWheelZoom.prototype.setMouseAnchor=function(e){this.useAnchor_=e;e||(this.lastAnchor_=null)};ol.interaction.MouseWheelZoom.Mode_={TRACKPAD:"trackpad",WHEEL:"wheel"};goog.provide("ol.interaction.PinchRotate");goog.require("ol");goog.require("ol.ViewHint");goog.require("ol.functions");goog.require("ol.interaction.Interaction");goog.require("ol.interaction.Pointer");ol.interaction.PinchRotate=function(e){ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.PinchRotate.handleDownEvent_,handleDragEvent:ol.interaction.PinchRotate.handleDragEvent_,handleUpEvent:ol.interaction.PinchRotate.handleUpEvent_});var t=e||{};this.anchor_=null;this.lastAngle_=void 0;this.rotating_=!1;this.rotationDelta_=0;this.threshold_=void 0!==t.threshold?t.threshold:.3;this.duration_=void 0!==t.duration?t.duration:250};ol.inherits(ol.interaction.PinchRotate,ol.interaction.Pointer);ol.interaction.PinchRotate.handleDragEvent_=function(e){var t=0,o=this.targetPointers[0],r=this.targetPointers[1],i=Math.atan2(r.clientY-o.clientY,r.clientX-o.clientX);if(void 0!==this.lastAngle_){var n=i-this.lastAngle_;this.rotationDelta_+=n;!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0);t=n}this.lastAngle_=i;var a=e.map,l=a.getViewport().getBoundingClientRect(),s=ol.interaction.Pointer.centroid(this.targetPointers);s[0]-=l.left;s[1]-=l.top;this.anchor_=a.getCoordinateFromPixel(s);if(this.rotating_){var p=a.getView(),c=p.getRotation();a.render();ol.interaction.Interaction.rotateWithoutConstraints(p,c+t,this.anchor_)}};ol.interaction.PinchRotate.handleUpEvent_=function(e){if(this.targetPointers.length<2){var t=e.map,o=t.getView();o.setHint(ol.ViewHint.INTERACTING,-1);if(this.rotating_){var r=o.getRotation();ol.interaction.Interaction.rotate(o,r,this.anchor_,this.duration_)}return!1}return!0};ol.interaction.PinchRotate.handleDownEvent_=function(e){if(this.targetPointers.length>=2){var t=e.map;this.anchor_=null;this.lastAngle_=void 0;this.rotating_=!1;this.rotationDelta_=0;this.handlingDownUpSequence||t.getView().setHint(ol.ViewHint.INTERACTING,1);return!0}return!1};ol.interaction.PinchRotate.prototype.shouldStopEvent=ol.functions.FALSE;goog.provide("ol.interaction.PinchZoom");goog.require("ol");goog.require("ol.ViewHint");goog.require("ol.functions");goog.require("ol.interaction.Interaction");goog.require("ol.interaction.Pointer");ol.interaction.PinchZoom=function(e){ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.PinchZoom.handleDownEvent_,handleDragEvent:ol.interaction.PinchZoom.handleDragEvent_,handleUpEvent:ol.interaction.PinchZoom.handleUpEvent_});var t=e?e:{};this.constrainResolution_=t.constrainResolution||!1;this.anchor_=null;this.duration_=void 0!==t.duration?t.duration:400;this.lastDistance_=void 0;this.lastScaleDelta_=1};ol.inherits(ol.interaction.PinchZoom,ol.interaction.Pointer);ol.interaction.PinchZoom.handleDragEvent_=function(e){var t=1,o=this.targetPointers[0],r=this.targetPointers[1],i=o.clientX-r.clientX,n=o.clientY-r.clientY,a=Math.sqrt(i*i+n*n);void 0!==this.lastDistance_&&(t=this.lastDistance_/a);this.lastDistance_=a;var l=e.map,s=l.getView(),p=s.getResolution(),c=s.getMaxResolution(),u=s.getMinResolution(),g=p*t;if(g>c){t=c/p;g=c}else if(u>g){t=u/p;g=u}1!=t&&(this.lastScaleDelta_=t);var d=l.getViewport().getBoundingClientRect(),h=ol.interaction.Pointer.centroid(this.targetPointers);h[0]-=d.left;h[1]-=d.top;this.anchor_=l.getCoordinateFromPixel(h);l.render();ol.interaction.Interaction.zoomWithoutConstraints(s,g,this.anchor_)};ol.interaction.PinchZoom.handleUpEvent_=function(e){if(this.targetPointers.length<2){var t=e.map,o=t.getView();o.setHint(ol.ViewHint.INTERACTING,-1);var r=o.getResolution();if(this.constrainResolution_||r<o.getMinResolution()||r>o.getMaxResolution()){var i=this.lastScaleDelta_-1;ol.interaction.Interaction.zoom(o,r,this.anchor_,this.duration_,i)}return!1}return!0};ol.interaction.PinchZoom.handleDownEvent_=function(e){if(this.targetPointers.length>=2){var t=e.map;this.anchor_=null;this.lastDistance_=void 0;this.lastScaleDelta_=1;this.handlingDownUpSequence||t.getView().setHint(ol.ViewHint.INTERACTING,1);return!0}return!1};ol.interaction.PinchZoom.prototype.shouldStopEvent=ol.functions.FALSE;goog.provide("ol.interaction");goog.require("ol.Collection");goog.require("ol.Kinetic");goog.require("ol.interaction.DoubleClickZoom");goog.require("ol.interaction.DragPan");goog.require("ol.interaction.DragRotate");goog.require("ol.interaction.DragZoom");goog.require("ol.interaction.KeyboardPan");goog.require("ol.interaction.KeyboardZoom");goog.require("ol.interaction.MouseWheelZoom");goog.require("ol.interaction.PinchRotate");goog.require("ol.interaction.PinchZoom");ol.interaction.defaults=function(e){var t=e?e:{},o=new ol.Collection,r=new ol.Kinetic(-.005,.05,100),i=void 0!==t.altShiftDragRotate?t.altShiftDragRotate:!0;i&&o.push(new ol.interaction.DragRotate);var n=void 0!==t.doubleClickZoom?t.doubleClickZoom:!0;n&&o.push(new ol.interaction.DoubleClickZoom({delta:t.zoomDelta,duration:t.zoomDuration}));var a=void 0!==t.dragPan?t.dragPan:!0;a&&o.push(new ol.interaction.DragPan({kinetic:r}));var l=void 0!==t.pinchRotate?t.pinchRotate:!0;l&&o.push(new ol.interaction.PinchRotate);var s=void 0!==t.pinchZoom?t.pinchZoom:!0;s&&o.push(new ol.interaction.PinchZoom({constrainResolution:t.constrainResolution,duration:t.zoomDuration}));var p=void 0!==t.keyboard?t.keyboard:!0;if(p){o.push(new ol.interaction.KeyboardPan);o.push(new ol.interaction.KeyboardZoom({delta:t.zoomDelta,duration:t.zoomDuration}))}var c=void 0!==t.mouseWheelZoom?t.mouseWheelZoom:!0;c&&o.push(new ol.interaction.MouseWheelZoom({constrainResolution:t.constrainResolution,duration:t.zoomDuration}));var u=void 0!==t.shiftDragZoom?t.shiftDragZoom:!0;u&&o.push(new ol.interaction.DragZoom({duration:t.zoomDuration}));return o};goog.provide("ol.layer.Property");ol.layer.Property={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",SOURCE:"source"};goog.provide("ol.layer.Base");goog.require("ol");goog.require("ol.Object");goog.require("ol.layer.Property");goog.require("ol.math");goog.require("ol.obj");ol.layer.Base=function(e){ol.Object.call(this);var t=ol.obj.assign({},e);t[ol.layer.Property.OPACITY]=void 0!==e.opacity?e.opacity:1;t[ol.layer.Property.VISIBLE]=void 0!==e.visible?e.visible:!0;t[ol.layer.Property.Z_INDEX]=void 0!==e.zIndex?e.zIndex:0;t[ol.layer.Property.MAX_RESOLUTION]=void 0!==e.maxResolution?e.maxResolution:1/0;t[ol.layer.Property.MIN_RESOLUTION]=void 0!==e.minResolution?e.minResolution:0;this.setProperties(t);this.state_={layer:this,managed:!0}};ol.inherits(ol.layer.Base,ol.Object);ol.layer.Base.prototype.createRenderer=function(e){};ol.layer.Base.prototype.getLayerState=function(){this.state_.opacity=ol.math.clamp(this.getOpacity(),0,1);this.state_.sourceState=this.getSourceState();this.state_.visible=this.getVisible();this.state_.extent=this.getExtent();this.state_.zIndex=this.getZIndex();this.state_.maxResolution=this.getMaxResolution();this.state_.minResolution=Math.max(this.getMinResolution(),0);return this.state_};ol.layer.Base.prototype.getLayersArray=function(e){};ol.layer.Base.prototype.getLayerStatesArray=function(e){};ol.layer.Base.prototype.getExtent=function(){return this.get(ol.layer.Property.EXTENT)};ol.layer.Base.prototype.getMaxResolution=function(){return this.get(ol.layer.Property.MAX_RESOLUTION)};ol.layer.Base.prototype.getMinResolution=function(){return this.get(ol.layer.Property.MIN_RESOLUTION)};ol.layer.Base.prototype.getOpacity=function(){return this.get(ol.layer.Property.OPACITY)};ol.layer.Base.prototype.getSourceState=function(){};ol.layer.Base.prototype.getVisible=function(){return this.get(ol.layer.Property.VISIBLE)};ol.layer.Base.prototype.getZIndex=function(){return this.get(ol.layer.Property.Z_INDEX)};ol.layer.Base.prototype.setExtent=function(e){this.set(ol.layer.Property.EXTENT,e)};ol.layer.Base.prototype.setMaxResolution=function(e){this.set(ol.layer.Property.MAX_RESOLUTION,e)};ol.layer.Base.prototype.setMinResolution=function(e){this.set(ol.layer.Property.MIN_RESOLUTION,e)};ol.layer.Base.prototype.setOpacity=function(e){this.set(ol.layer.Property.OPACITY,e)};ol.layer.Base.prototype.setVisible=function(e){this.set(ol.layer.Property.VISIBLE,e)};ol.layer.Base.prototype.setZIndex=function(e){this.set(ol.layer.Property.Z_INDEX,e)};goog.provide("ol.source.State");ol.source.State={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"};goog.provide("ol.layer.Group");goog.require("ol");goog.require("ol.Collection");goog.require("ol.CollectionEventType");goog.require("ol.Object");goog.require("ol.ObjectEventType");goog.require("ol.asserts");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.extent");goog.require("ol.layer.Base");goog.require("ol.obj");goog.require("ol.source.State");ol.layer.Group=function(e){var t=e||{},o=ol.obj.assign({},t);delete o.layers;var r=t.layers;ol.layer.Base.call(this,o);this.layersListenerKeys_=[];this.listenerKeys_={};ol.events.listen(this,ol.Object.getChangeEventType(ol.layer.Group.Property_.LAYERS),this.handleLayersChanged_,this);if(r)if(Array.isArray(r))r=new ol.Collection(r.slice(),{unique:!0});else{ol.asserts.assert(r instanceof ol.Collection,43);r=r}else r=new ol.Collection(void 0,{unique:!0});this.setLayers(r)};ol.inherits(ol.layer.Group,ol.layer.Base);ol.layer.Group.prototype.createRenderer=function(e){};ol.layer.Group.prototype.handleLayerChange_=function(){this.getVisible()&&this.changed()};ol.layer.Group.prototype.handleLayersChanged_=function(e){this.layersListenerKeys_.forEach(ol.events.unlistenByKey);this.layersListenerKeys_.length=0;var t=this.getLayers();this.layersListenerKeys_.push(ol.events.listen(t,ol.CollectionEventType.ADD,this.handleLayersAdd_,this),ol.events.listen(t,ol.CollectionEventType.REMOVE,this.handleLayersRemove_,this));for(var o in this.listenerKeys_)this.listenerKeys_[o].forEach(ol.events.unlistenByKey);ol.obj.clear(this.listenerKeys_);var r,i,n,a=t.getArray();for(r=0,i=a.length;i>r;r++){n=a[r];this.listenerKeys_[ol.getUid(n).toString()]=[ol.events.listen(n,ol.ObjectEventType.PROPERTYCHANGE,this.handleLayerChange_,this),ol.events.listen(n,ol.events.EventType.CHANGE,this.handleLayerChange_,this)]}this.changed()};ol.layer.Group.prototype.handleLayersAdd_=function(e){var t=e.element,o=ol.getUid(t).toString();this.listenerKeys_[o]=[ol.events.listen(t,ol.ObjectEventType.PROPERTYCHANGE,this.handleLayerChange_,this),ol.events.listen(t,ol.events.EventType.CHANGE,this.handleLayerChange_,this)];this.changed()};ol.layer.Group.prototype.handleLayersRemove_=function(e){var t=e.element,o=ol.getUid(t).toString();this.listenerKeys_[o].forEach(ol.events.unlistenByKey);delete this.listenerKeys_[o];this.changed()};ol.layer.Group.prototype.getLayers=function(){return this.get(ol.layer.Group.Property_.LAYERS)};ol.layer.Group.prototype.setLayers=function(e){this.set(ol.layer.Group.Property_.LAYERS,e)};ol.layer.Group.prototype.getLayersArray=function(e){var t=void 0!==e?e:[];this.getLayers().forEach(function(e){e.getLayersArray(t)});return t};ol.layer.Group.prototype.getLayerStatesArray=function(e){var t=void 0!==e?e:[],o=t.length;this.getLayers().forEach(function(e){e.getLayerStatesArray(t)});var r,i,n,a=this.getLayerState();for(r=o,i=t.length;i>r;r++){n=t[r];n.opacity*=a.opacity;n.visible=n.visible&&a.visible;n.maxResolution=Math.min(n.maxResolution,a.maxResolution);n.minResolution=Math.max(n.minResolution,a.minResolution);void 0!==a.extent&&(n.extent=void 0!==n.extent?ol.extent.getIntersection(n.extent,a.extent):a.extent)}return t};ol.layer.Group.prototype.getSourceState=function(){return ol.source.State.READY};ol.layer.Group.Property_={LAYERS:"layers"};goog.provide("ol.render.EventType");ol.render.EventType={POSTCOMPOSE:"postcompose",PRECOMPOSE:"precompose",RENDER:"render"};goog.provide("ol.layer.Layer");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol");goog.require("ol.Object");goog.require("ol.layer.Base");goog.require("ol.layer.Property");goog.require("ol.obj");goog.require("ol.render.EventType");goog.require("ol.source.State");ol.layer.Layer=function(e){var t=ol.obj.assign({},e);delete t.source;ol.layer.Base.call(this,t);this.mapPrecomposeKey_=null;this.mapRenderKey_=null;this.sourceChangeKey_=null;e.map&&this.setMap(e.map);ol.events.listen(this,ol.Object.getChangeEventType(ol.layer.Property.SOURCE),this.handleSourcePropertyChange_,this);var o=e.source?e.source:null;this.setSource(o)};ol.inherits(ol.layer.Layer,ol.layer.Base);ol.layer.Layer.visibleAtResolution=function(e,t){return e.visible&&t>=e.minResolution&&t<e.maxResolution};ol.layer.Layer.prototype.getLayersArray=function(e){var t=e?e:[];t.push(this);return t};ol.layer.Layer.prototype.getLayerStatesArray=function(e){var t=e?e:[];t.push(this.getLayerState());return t};ol.layer.Layer.prototype.getSource=function(){var e=this.get(ol.layer.Property.SOURCE);return e||null};ol.layer.Layer.prototype.getSourceState=function(){var e=this.getSource();return e?e.getState():ol.source.State.UNDEFINED};ol.layer.Layer.prototype.handleSourceChange_=function(){this.changed()};ol.layer.Layer.prototype.handleSourcePropertyChange_=function(){if(this.sourceChangeKey_){ol.events.unlistenByKey(this.sourceChangeKey_);this.sourceChangeKey_=null}var e=this.getSource();e&&(this.sourceChangeKey_=ol.events.listen(e,ol.events.EventType.CHANGE,this.handleSourceChange_,this));this.changed()};ol.layer.Layer.prototype.setMap=function(e){if(this.mapPrecomposeKey_){ol.events.unlistenByKey(this.mapPrecomposeKey_);this.mapPrecomposeKey_=null}e||this.changed();if(this.mapRenderKey_){ol.events.unlistenByKey(this.mapRenderKey_);this.mapRenderKey_=null}if(e){this.mapPrecomposeKey_=ol.events.listen(e,ol.render.EventType.PRECOMPOSE,function(e){var t=this.getLayerState();t.managed=!1;t.zIndex=1/0;e.frameState.layerStatesArray.push(t);e.frameState.layerStates[ol.getUid(this)]=t},this);this.mapRenderKey_=ol.events.listen(this,ol.events.EventType.CHANGE,e.render,e);this.changed()}};ol.layer.Layer.prototype.setSource=function(e){this.set(ol.layer.Property.SOURCE,e)};goog.provide("ol.style.IconImageCache");goog.require("ol.color");ol.style.IconImageCache=function(){this.cache_={};this.cacheSize_=0;this.maxCacheSize_=32};ol.style.IconImageCache.getKey=function(e,t,o){var r=o?ol.color.asString(o):"null";return t+":"+e+":"+r};ol.style.IconImageCache.prototype.clear=function(){this.cache_={};this.cacheSize_=0};ol.style.IconImageCache.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){var e,t,o=0;for(e in this.cache_){t=this.cache_[e];if(0===(3&o++)&&!t.hasListener()){delete this.cache_[e];--this.cacheSize_}}}};ol.style.IconImageCache.prototype.get=function(e,t,o){var r=ol.style.IconImageCache.getKey(e,t,o);return r in this.cache_?this.cache_[r]:null};ol.style.IconImageCache.prototype.set=function(e,t,o,r){var i=ol.style.IconImageCache.getKey(e,t,o);this.cache_[i]=r;++this.cacheSize_};goog.provide("ol.style");goog.require("ol.style.IconImageCache");ol.style.iconImageCache=new ol.style.IconImageCache;goog.provide("ol.transform");goog.require("ol.asserts");ol.transform.tmp_=new Array(6);ol.transform.create=function(){return[1,0,0,1,0,0]};ol.transform.reset=function(e){return ol.transform.set(e,1,0,0,1,0,0)};ol.transform.multiply=function(e,t){var o=e[0],r=e[1],i=e[2],n=e[3],a=e[4],l=e[5],s=t[0],p=t[1],c=t[2],u=t[3],g=t[4],d=t[5];e[0]=o*s+i*p;e[1]=r*s+n*p;e[2]=o*c+i*u;e[3]=r*c+n*u;e[4]=o*g+i*d+a;e[5]=r*g+n*d+l;return e};ol.transform.set=function(e,t,o,r,i,n,a){e[0]=t;e[1]=o;e[2]=r;e[3]=i;e[4]=n;e[5]=a;return e};ol.transform.setFromArray=function(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];return e};ol.transform.apply=function(e,t){var o=t[0],r=t[1];t[0]=e[0]*o+e[2]*r+e[4];t[1]=e[1]*o+e[3]*r+e[5];return t};ol.transform.rotate=function(e,t){
var o=Math.cos(t),r=Math.sin(t);return ol.transform.multiply(e,ol.transform.set(ol.transform.tmp_,o,r,-r,o,0,0))};ol.transform.scale=function(e,t,o){return ol.transform.multiply(e,ol.transform.set(ol.transform.tmp_,t,0,0,o,0,0))};ol.transform.translate=function(e,t,o){return ol.transform.multiply(e,ol.transform.set(ol.transform.tmp_,1,0,0,1,t,o))};ol.transform.compose=function(e,t,o,r,i,n,a,l){var s=Math.sin(n),p=Math.cos(n);e[0]=r*p;e[1]=i*s;e[2]=-r*s;e[3]=i*p;e[4]=a*r*p-l*r*s+t;e[5]=a*i*s+l*i*p+o;return e};ol.transform.invert=function(e){var t=ol.transform.determinant(e);ol.asserts.assert(0!==t,32);var o=e[0],r=e[1],i=e[2],n=e[3],a=e[4],l=e[5];e[0]=n/t;e[1]=-r/t;e[2]=-i/t;e[3]=o/t;e[4]=(i*l-n*a)/t;e[5]=-(o*l-r*a)/t;return e};ol.transform.determinant=function(e){return e[0]*e[3]-e[1]*e[2]};goog.provide("ol.renderer.Map");goog.require("ol");goog.require("ol.Disposable");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.extent");goog.require("ol.functions");goog.require("ol.layer.Layer");goog.require("ol.style");goog.require("ol.transform");ol.renderer.Map=function(e,t){ol.Disposable.call(this);this.map_=t;this.layerRenderers_={};this.layerRendererListeners_={}};ol.inherits(ol.renderer.Map,ol.Disposable);ol.renderer.Map.prototype.calculateMatrices2D=function(e){var t=e.viewState,o=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;ol.transform.compose(o,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]);ol.transform.invert(ol.transform.setFromArray(r,o))};ol.renderer.Map.prototype.disposeInternal=function(){for(var e in this.layerRenderers_)this.layerRenderers_[e].dispose()};ol.renderer.Map.expireIconCache_=function(e,t){var o=ol.style.iconImageCache;o.expire()};ol.renderer.Map.prototype.forEachFeatureAtCoordinate=function(e,t,o,r,i,n,a){function l(e,o){var n=ol.getUid(e).toString(),a=t.layerStates[ol.getUid(o)].managed;return n in t.skippedFeatureUids&&!a?void 0:r.call(i,e,a?o:null)}var s,p=t.viewState,c=p.resolution,u=p.projection,g=e;if(u.canWrapX()){var d=u.getExtent(),h=ol.extent.getWidth(d),f=e[0];if(f<d[0]||f>d[2]){var y=Math.ceil((d[0]-f)/h);g=[f+h*y,e[1]]}}var m,v=t.layerStatesArray,C=v.length;for(m=C-1;m>=0;--m){var T=v[m],_=T.layer;if(ol.layer.Layer.visibleAtResolution(T,c)&&n.call(a,_)){var S=this.getLayerRenderer(_);_.getSource()&&(s=S.forEachFeatureAtCoordinate(_.getSource().getWrapX()?g:e,t,o,l,i));if(s)return s}}return void 0};ol.renderer.Map.prototype.forEachLayerAtPixel=function(e,t,o,r,i,n){};ol.renderer.Map.prototype.hasFeatureAtCoordinate=function(e,t,o,r,i){var n=this.forEachFeatureAtCoordinate(e,t,o,ol.functions.TRUE,this,r,i);return void 0!==n};ol.renderer.Map.prototype.getLayerRenderer=function(e){var t=ol.getUid(e).toString();if(t in this.layerRenderers_)return this.layerRenderers_[t];var o=e.createRenderer(this);this.layerRenderers_[t]=o;this.layerRendererListeners_[t]=ol.events.listen(o,ol.events.EventType.CHANGE,this.handleLayerRendererChange_,this);return o};ol.renderer.Map.prototype.getLayerRendererByKey=function(e){return this.layerRenderers_[e]};ol.renderer.Map.prototype.getLayerRenderers=function(){return this.layerRenderers_};ol.renderer.Map.prototype.getMap=function(){return this.map_};ol.renderer.Map.prototype.getType=function(){};ol.renderer.Map.prototype.handleLayerRendererChange_=function(){this.map_.render()};ol.renderer.Map.prototype.removeLayerRendererByKey_=function(e){var t=this.layerRenderers_[e];delete this.layerRenderers_[e];ol.events.unlistenByKey(this.layerRendererListeners_[e]);delete this.layerRendererListeners_[e];return t};ol.renderer.Map.prototype.renderFrame=ol.nullFunction;ol.renderer.Map.prototype.removeUnusedLayerRenderers_=function(e,t){var o;for(o in this.layerRenderers_)t&&o in t.layerStates||this.removeLayerRendererByKey_(o).dispose()};ol.renderer.Map.prototype.scheduleExpireIconCache=function(e){e.postRenderFunctions.push(ol.renderer.Map.expireIconCache_)};ol.renderer.Map.prototype.scheduleRemoveUnusedLayerRenderers=function(e){var t;for(t in this.layerRenderers_)if(!(t in e.layerStates)){e.postRenderFunctions.push(this.removeUnusedLayerRenderers_.bind(this));return}};ol.renderer.Map.sortByZIndex=function(e,t){return e.zIndex-t.zIndex};goog.provide("ol.renderer.Type");ol.renderer.Type={CANVAS:"canvas",WEBGL:"webgl"};goog.provide("ol.render.Event");goog.require("ol");goog.require("ol.events.Event");ol.render.Event=function(e,t,o,r,i){ol.events.Event.call(this,e);this.vectorContext=t;this.frameState=o;this.context=r;this.glContext=i};ol.inherits(ol.render.Event,ol.events.Event);goog.provide("ol.render.canvas");ol.render.canvas.defaultFont="10px sans-serif";ol.render.canvas.defaultFillStyle=[0,0,0,1];ol.render.canvas.defaultLineCap="round";ol.render.canvas.defaultLineDash=[];ol.render.canvas.defaultLineDashOffset=0;ol.render.canvas.defaultLineJoin="round";ol.render.canvas.defaultMiterLimit=10;ol.render.canvas.defaultStrokeStyle=[0,0,0,1];ol.render.canvas.defaultTextAlign="center";ol.render.canvas.defaultTextBaseline="middle";ol.render.canvas.defaultLineWidth=1;ol.render.canvas.rotateAtOffset=function(e,t,o,r){if(0!==t){e.translate(o,r);e.rotate(t);e.translate(-o,-r)}};goog.provide("ol.render.VectorContext");ol.render.VectorContext=function(){};ol.render.VectorContext.prototype.drawGeometry=function(e){};ol.render.VectorContext.prototype.setStyle=function(e){};ol.render.VectorContext.prototype.drawCircle=function(e,t){};ol.render.VectorContext.prototype.drawFeature=function(e,t){};ol.render.VectorContext.prototype.drawGeometryCollection=function(e,t){};ol.render.VectorContext.prototype.drawLineString=function(e,t){};ol.render.VectorContext.prototype.drawMultiLineString=function(e,t){};ol.render.VectorContext.prototype.drawMultiPoint=function(e,t){};ol.render.VectorContext.prototype.drawMultiPolygon=function(e,t){};ol.render.VectorContext.prototype.drawPoint=function(e,t){};ol.render.VectorContext.prototype.drawPolygon=function(e,t){};ol.render.VectorContext.prototype.drawText=function(e,t,o,r,i,n){};ol.render.VectorContext.prototype.setFillStrokeStyle=function(e,t){};ol.render.VectorContext.prototype.setImageStyle=function(e){};ol.render.VectorContext.prototype.setTextStyle=function(e){};goog.provide("ol.render.canvas.Immediate");goog.require("ol");goog.require("ol.array");goog.require("ol.colorlike");goog.require("ol.extent");goog.require("ol.geom.GeometryType");goog.require("ol.geom.SimpleGeometry");goog.require("ol.geom.flat.transform");goog.require("ol.has");goog.require("ol.render.VectorContext");goog.require("ol.render.canvas");goog.require("ol.transform");ol.render.canvas.Immediate=function(e,t,o,r,i){ol.render.VectorContext.call(this);this.context_=e;this.pixelRatio_=t;this.extent_=o;this.transform_=r;this.viewRotation_=i;this.contextFillState_=null;this.contextStrokeState_=null;this.contextTextState_=null;this.fillState_=null;this.strokeState_=null;this.image_=null;this.imageAnchorX_=0;this.imageAnchorY_=0;this.imageHeight_=0;this.imageOpacity_=0;this.imageOriginX_=0;this.imageOriginY_=0;this.imageRotateWithView_=!1;this.imageRotation_=0;this.imageScale_=0;this.imageSnapToPixel_=!1;this.imageWidth_=0;this.text_="";this.textOffsetX_=0;this.textOffsetY_=0;this.textRotateWithView_=!1;this.textRotation_=0;this.textScale_=0;this.textFillState_=null;this.textStrokeState_=null;this.textState_=null;this.pixelCoordinates_=[];this.tmpLocalTransform_=ol.transform.create()};ol.inherits(ol.render.canvas.Immediate,ol.render.VectorContext);ol.render.canvas.Immediate.prototype.drawImages_=function(e,t,o,r){if(this.image_){var i=ol.geom.flat.transform.transform2D(e,t,o,2,this.transform_,this.pixelCoordinates_),n=this.context_,a=this.tmpLocalTransform_,l=n.globalAlpha;1!=this.imageOpacity_&&(n.globalAlpha=l*this.imageOpacity_);var s=this.imageRotation_;this.imageRotateWithView_&&(s+=this.viewRotation_);var p,c;for(p=0,c=i.length;c>p;p+=2){var u=i[p]-this.imageAnchorX_,g=i[p+1]-this.imageAnchorY_;if(this.imageSnapToPixel_){u=Math.round(u);g=Math.round(g)}if(0!==s||1!=this.imageScale_){var d=u+this.imageAnchorX_,h=g+this.imageAnchorY_;ol.transform.compose(a,d,h,this.imageScale_,this.imageScale_,s,-d,-h);n.setTransform.apply(n,a)}n.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,u,g,this.imageWidth_,this.imageHeight_)}(0!==s||1!=this.imageScale_)&&n.setTransform(1,0,0,1,0,0);1!=this.imageOpacity_&&(n.globalAlpha=l)}};ol.render.canvas.Immediate.prototype.drawText_=function(e,t,o,r){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_);this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_);this.setContextTextState_(this.textState_);var i=ol.geom.flat.transform.transform2D(e,t,o,r,this.transform_,this.pixelCoordinates_),n=this.context_,a=this.textRotation_;this.textRotateWithView_&&(a+=this.viewRotation_);for(;o>t;t+=r){var l=i[t]+this.textOffsetX_,s=i[t+1]+this.textOffsetY_;if(0!==a||1!=this.textScale_){var p=ol.transform.compose(this.tmpLocalTransform_,l,s,this.textScale_,this.textScale_,a,-l,-s);n.setTransform.apply(n,p)}this.textStrokeState_&&n.strokeText(this.text_,l,s);this.textFillState_&&n.fillText(this.text_,l,s)}(0!==a||1!=this.textScale_)&&n.setTransform(1,0,0,1,0,0)}};ol.render.canvas.Immediate.prototype.moveToLineTo_=function(e,t,o,r,i){var n=this.context_,a=ol.geom.flat.transform.transform2D(e,t,o,r,this.transform_,this.pixelCoordinates_);n.moveTo(a[0],a[1]);var l=a.length;i&&(l-=2);for(var s=2;l>s;s+=2)n.lineTo(a[s],a[s+1]);i&&n.closePath();return o};ol.render.canvas.Immediate.prototype.drawRings_=function(e,t,o,r){var i,n;for(i=0,n=o.length;n>i;++i)t=this.moveToLineTo_(e,t,o[i],r,!0);return t};ol.render.canvas.Immediate.prototype.drawCircle=function(e){if(ol.extent.intersects(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_);this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var t=ol.geom.SimpleGeometry.transform2D(e,this.transform_,this.pixelCoordinates_),o=t[2]-t[0],r=t[3]-t[1],i=Math.sqrt(o*o+r*r),n=this.context_;n.beginPath();n.arc(t[0],t[1],i,0,2*Math.PI);this.fillState_&&n.fill();this.strokeState_&&n.stroke()}""!==this.text_&&this.drawText_(e.getCenter(),0,2,2)}};ol.render.canvas.Immediate.prototype.setStyle=function(e){this.setFillStrokeStyle(e.getFill(),e.getStroke());this.setImageStyle(e.getImage());this.setTextStyle(e.getText())};ol.render.canvas.Immediate.prototype.drawGeometry=function(e){var t=e.getType();switch(t){case ol.geom.GeometryType.POINT:this.drawPoint(e);break;case ol.geom.GeometryType.LINE_STRING:this.drawLineString(e);break;case ol.geom.GeometryType.POLYGON:this.drawPolygon(e);break;case ol.geom.GeometryType.MULTI_POINT:this.drawMultiPoint(e);break;case ol.geom.GeometryType.MULTI_LINE_STRING:this.drawMultiLineString(e);break;case ol.geom.GeometryType.MULTI_POLYGON:this.drawMultiPolygon(e);break;case ol.geom.GeometryType.GEOMETRY_COLLECTION:this.drawGeometryCollection(e);break;case ol.geom.GeometryType.CIRCLE:this.drawCircle(e)}};ol.render.canvas.Immediate.prototype.drawFeature=function(e,t){var o=t.getGeometryFunction()(e);if(o&&ol.extent.intersects(this.extent_,o.getExtent())){this.setStyle(t);this.drawGeometry(o)}};ol.render.canvas.Immediate.prototype.drawGeometryCollection=function(e){var t,o,r=e.getGeometriesArray();for(t=0,o=r.length;o>t;++t)this.drawGeometry(r[t])};ol.render.canvas.Immediate.prototype.drawPoint=function(e){var t=e.getFlatCoordinates(),o=e.getStride();this.image_&&this.drawImages_(t,0,t.length,o);""!==this.text_&&this.drawText_(t,0,t.length,o)};ol.render.canvas.Immediate.prototype.drawMultiPoint=function(e){var t=e.getFlatCoordinates(),o=e.getStride();this.image_&&this.drawImages_(t,0,t.length,o);""!==this.text_&&this.drawText_(t,0,t.length,o)};ol.render.canvas.Immediate.prototype.drawLineString=function(e){if(ol.extent.intersects(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var t=this.context_,o=e.getFlatCoordinates();t.beginPath();this.moveToLineTo_(o,0,o.length,e.getStride(),!1);t.stroke()}if(""!==this.text_){var r=e.getFlatMidpoint();this.drawText_(r,0,2,2)}}};ol.render.canvas.Immediate.prototype.drawMultiLineString=function(e){var t=e.getExtent();if(ol.extent.intersects(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var o=this.context_,r=e.getFlatCoordinates(),i=0,n=e.getEnds(),a=e.getStride();o.beginPath();var l,s;for(l=0,s=n.length;s>l;++l)i=this.moveToLineTo_(r,i,n[l],a,!1);o.stroke()}if(""!==this.text_){var p=e.getFlatMidpoints();this.drawText_(p,0,p.length,2)}}};ol.render.canvas.Immediate.prototype.drawPolygon=function(e){if(ol.extent.intersects(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_);this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var t=this.context_;t.beginPath();this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride());this.fillState_&&t.fill();this.strokeState_&&t.stroke()}if(""!==this.text_){var o=e.getFlatInteriorPoint();this.drawText_(o,0,2,2)}}};ol.render.canvas.Immediate.prototype.drawMultiPolygon=function(e){if(ol.extent.intersects(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_);this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var t,o,r=this.context_,i=e.getOrientedFlatCoordinates(),n=0,a=e.getEndss(),l=e.getStride();r.beginPath();for(t=0,o=a.length;o>t;++t){var s=a[t];n=this.drawRings_(i,n,s,l)}this.fillState_&&r.fill();this.strokeState_&&r.stroke()}if(""!==this.text_){var p=e.getFlatInteriorPoints();this.drawText_(p,0,p.length,2)}}};ol.render.canvas.Immediate.prototype.setContextFillState_=function(e){var t=this.context_,o=this.contextFillState_;if(o)o.fillStyle!=e.fillStyle&&(o.fillStyle=t.fillStyle=e.fillStyle);else{t.fillStyle=e.fillStyle;this.contextFillState_={fillStyle:e.fillStyle}}};ol.render.canvas.Immediate.prototype.setContextStrokeState_=function(e){var t=this.context_,o=this.contextStrokeState_;if(o){o.lineCap!=e.lineCap&&(o.lineCap=t.lineCap=e.lineCap);ol.has.CANVAS_LINE_DASH&&(ol.array.equals(o.lineDash,e.lineDash)||t.setLineDash(o.lineDash=e.lineDash));o.lineJoin!=e.lineJoin&&(o.lineJoin=t.lineJoin=e.lineJoin);o.lineWidth!=e.lineWidth&&(o.lineWidth=t.lineWidth=e.lineWidth);o.miterLimit!=e.miterLimit&&(o.miterLimit=t.miterLimit=e.miterLimit);o.strokeStyle!=e.strokeStyle&&(o.strokeStyle=t.strokeStyle=e.strokeStyle)}else{t.lineCap=e.lineCap;ol.has.CANVAS_LINE_DASH&&t.setLineDash(e.lineDash);t.lineJoin=e.lineJoin;t.lineWidth=e.lineWidth;t.miterLimit=e.miterLimit;t.strokeStyle=e.strokeStyle;this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle}}};ol.render.canvas.Immediate.prototype.setContextTextState_=function(e){var t=this.context_,o=this.contextTextState_;if(o){o.font!=e.font&&(o.font=t.font=e.font);o.textAlign!=e.textAlign&&(o.textAlign=t.textAlign=e.textAlign);o.textBaseline!=e.textBaseline&&(o.textBaseline=t.textBaseline=e.textBaseline)}else{t.font=e.font;t.textAlign=e.textAlign;t.textBaseline=e.textBaseline;this.contextTextState_={font:e.font,textAlign:e.textAlign,textBaseline:e.textBaseline}}};ol.render.canvas.Immediate.prototype.setFillStrokeStyle=function(e,t){if(e){var o=e.getColor();this.fillState_={fillStyle:ol.colorlike.asColorLike(o?o:ol.render.canvas.defaultFillStyle)}}else this.fillState_=null;if(t){var r=t.getColor(),i=t.getLineCap(),n=t.getLineDash(),a=t.getLineDashOffset(),l=t.getLineJoin(),s=t.getWidth(),p=t.getMiterLimit();this.strokeState_={lineCap:void 0!==i?i:ol.render.canvas.defaultLineCap,lineDash:n?n:ol.render.canvas.defaultLineDash,lineDashOffset:a?a:ol.render.canvas.defaultLineDashOffset,lineJoin:void 0!==l?l:ol.render.canvas.defaultLineJoin,lineWidth:this.pixelRatio_*(void 0!==s?s:ol.render.canvas.defaultLineWidth),miterLimit:void 0!==p?p:ol.render.canvas.defaultMiterLimit,strokeStyle:ol.colorlike.asColorLike(r?r:ol.render.canvas.defaultStrokeStyle)}}else this.strokeState_=null};ol.render.canvas.Immediate.prototype.setImageStyle=function(e){if(e){var t=e.getAnchor(),o=e.getImage(1),r=e.getOrigin(),i=e.getSize();this.imageAnchorX_=t[0];this.imageAnchorY_=t[1];this.imageHeight_=i[1];this.image_=o;this.imageOpacity_=e.getOpacity();this.imageOriginX_=r[0];this.imageOriginY_=r[1];this.imageRotateWithView_=e.getRotateWithView();this.imageRotation_=e.getRotation();this.imageScale_=e.getScale();this.imageSnapToPixel_=e.getSnapToPixel();this.imageWidth_=i[0]}else this.image_=null};ol.render.canvas.Immediate.prototype.setTextStyle=function(e){if(e){var t=e.getFill();if(t){var o=t.getColor();this.textFillState_={fillStyle:ol.colorlike.asColorLike(o?o:ol.render.canvas.defaultFillStyle)}}else this.textFillState_=null;var r=e.getStroke();if(r){var i=r.getColor(),n=r.getLineCap(),a=r.getLineDash(),l=r.getLineDashOffset(),s=r.getLineJoin(),p=r.getWidth(),c=r.getMiterLimit();this.textStrokeState_={lineCap:void 0!==n?n:ol.render.canvas.defaultLineCap,lineDash:a?a:ol.render.canvas.defaultLineDash,lineDashOffset:l?l:ol.render.canvas.defaultLineDashOffset,lineJoin:void 0!==s?s:ol.render.canvas.defaultLineJoin,lineWidth:void 0!==p?p:ol.render.canvas.defaultLineWidth,miterLimit:void 0!==c?c:ol.render.canvas.defaultMiterLimit,strokeStyle:ol.colorlike.asColorLike(i?i:ol.render.canvas.defaultStrokeStyle)}}else this.textStrokeState_=null;var u=e.getFont(),g=e.getOffsetX(),d=e.getOffsetY(),h=e.getRotateWithView(),f=e.getRotation(),y=e.getScale(),m=e.getText(),v=e.getTextAlign(),C=e.getTextBaseline();this.textState_={font:void 0!==u?u:ol.render.canvas.defaultFont,textAlign:void 0!==v?v:ol.render.canvas.defaultTextAlign,textBaseline:void 0!==C?C:ol.render.canvas.defaultTextBaseline};this.text_=void 0!==m?m:"";this.textOffsetX_=void 0!==g?this.pixelRatio_*g:0;this.textOffsetY_=void 0!==d?this.pixelRatio_*d:0;this.textRotateWithView_=void 0!==h?h:!1;this.textRotation_=void 0!==f?f:0;this.textScale_=this.pixelRatio_*(void 0!==y?y:1)}else this.text_=""};goog.provide("ol.renderer.canvas.Map");goog.require("ol.transform");goog.require("ol");goog.require("ol.array");goog.require("ol.css");goog.require("ol.dom");goog.require("ol.layer.Layer");goog.require("ol.render.Event");goog.require("ol.render.EventType");goog.require("ol.render.canvas");goog.require("ol.render.canvas.Immediate");goog.require("ol.renderer.Map");goog.require("ol.renderer.Type");goog.require("ol.source.State");ol.renderer.canvas.Map=function(e,t){ol.renderer.Map.call(this,e,t);this.context_=ol.dom.createCanvasContext2D();this.canvas_=this.context_.canvas;this.canvas_.style.width="100%";this.canvas_.style.height="100%";this.canvas_.style.display="block";this.canvas_.className=ol.css.CLASS_UNSELECTABLE;e.insertBefore(this.canvas_,e.childNodes[0]||null);this.renderedVisible_=!0;this.transform_=ol.transform.create()};ol.inherits(ol.renderer.canvas.Map,ol.renderer.Map);ol.renderer.canvas.Map.prototype.dispatchComposeEvent_=function(e,t){var o=this.getMap(),r=this.context_;if(o.hasListener(e)){var i=t.extent,n=t.pixelRatio,a=t.viewState,l=a.rotation,s=this.getTransform(t),p=new ol.render.canvas.Immediate(r,n,i,s,l),c=new ol.render.Event(e,p,t,r,null);o.dispatchEvent(c)}};ol.renderer.canvas.Map.prototype.getTransform=function(e){var t=e.viewState,o=this.canvas_.width/2,r=this.canvas_.height/2,i=e.pixelRatio/t.resolution,n=-i,a=-t.rotation,l=-t.center[0],s=-t.center[1];return ol.transform.compose(this.transform_,o,r,i,n,a,l,s)};ol.renderer.canvas.Map.prototype.getType=function(){return ol.renderer.Type.CANVAS};ol.renderer.canvas.Map.prototype.renderFrame=function(e){if(e){var t=this.context_,o=e.pixelRatio,r=Math.round(e.size[0]*o),i=Math.round(e.size[1]*o);if(this.canvas_.width!=r||this.canvas_.height!=i){this.canvas_.width=r;this.canvas_.height=i}else t.clearRect(0,0,r,i);var n=e.viewState.rotation;this.calculateMatrices2D(e);this.dispatchComposeEvent_(ol.render.EventType.PRECOMPOSE,e);var a=e.layerStatesArray;ol.array.stableSort(a,ol.renderer.Map.sortByZIndex);if(n){t.save();ol.render.canvas.rotateAtOffset(t,n,r/2,i/2)}var l,s,p,c,u,g=e.viewState.resolution;for(l=0,s=a.length;s>l;++l){u=a[l];p=u.layer;c=this.getLayerRenderer(p);ol.layer.Layer.visibleAtResolution(u,g)&&u.sourceState==ol.source.State.READY&&c.prepareFrame(e,u)&&c.composeFrame(e,u,t)}n&&t.restore();this.dispatchComposeEvent_(ol.render.EventType.POSTCOMPOSE,e);if(!this.renderedVisible_){this.canvas_.style.display="";this.renderedVisible_=!0}this.scheduleRemoveUnusedLayerRenderers(e);this.scheduleExpireIconCache(e)}else if(this.renderedVisible_){this.canvas_.style.display="none";this.renderedVisible_=!1}};ol.renderer.canvas.Map.prototype.forEachLayerAtPixel=function(e,t,o,r,i,n){var a,l,s=t.viewState,p=s.resolution,c=t.layerStatesArray,u=c.length,g=ol.transform.apply(t.pixelToCoordinateTransform,e.slice());for(l=u-1;l>=0;--l){var d=c[l],h=d.layer;if(ol.layer.Layer.visibleAtResolution(d,p)&&i.call(n,h)){var f=this.getLayerRenderer(h);a=f.forEachLayerAtCoordinate(g,t,o,r);if(a)return a}}return void 0};goog.provide("ol.render.ReplayType");ol.render.ReplayType={CIRCLE:"Circle",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};goog.provide("ol.render.replay");goog.require("ol.render.ReplayType");ol.render.replay.ORDER=[ol.render.ReplayType.POLYGON,ol.render.ReplayType.CIRCLE,ol.render.ReplayType.LINE_STRING,ol.render.ReplayType.IMAGE,ol.render.ReplayType.TEXT];goog.provide("ol.render.ReplayGroup");ol.render.ReplayGroup=function(){};ol.render.ReplayGroup.prototype.getReplay=function(e,t){};ol.render.ReplayGroup.prototype.isEmpty=function(){};goog.provide("ol.webgl.Shader");goog.require("ol");goog.require("ol.functions");if(ol.ENABLE_WEBGL){ol.webgl.Shader=function(e){this.source_=e};ol.webgl.Shader.prototype.getType=function(){};ol.webgl.Shader.prototype.getSource=function(){return this.source_};ol.webgl.Shader.prototype.isAnimated=ol.functions.FALSE}goog.provide("ol.webgl.Fragment");goog.require("ol");goog.require("ol.webgl");goog.require("ol.webgl.Shader");if(ol.ENABLE_WEBGL){ol.webgl.Fragment=function(e){ol.webgl.Shader.call(this,e)};ol.inherits(ol.webgl.Fragment,ol.webgl.Shader);ol.webgl.Fragment.prototype.getType=function(){return ol.webgl.FRAGMENT_SHADER}}goog.provide("ol.webgl.Vertex");goog.require("ol");goog.require("ol.webgl");goog.require("ol.webgl.Shader");if(ol.ENABLE_WEBGL){ol.webgl.Vertex=function(e){ol.webgl.Shader.call(this,e)};ol.inherits(ol.webgl.Vertex,ol.webgl.Shader);ol.webgl.Vertex.prototype.getType=function(){return ol.webgl.VERTEX_SHADER}}goog.provide("ol.render.webgl.circlereplay.defaultshader");goog.require("ol");goog.require("ol.webgl.Fragment");goog.require("ol.webgl.Vertex");if(ol.ENABLE_WEBGL){ol.render.webgl.circlereplay.defaultshader.Fragment=function(){ol.webgl.Fragment.call(this,ol.render.webgl.circlereplay.defaultshader.Fragment.SOURCE)};ol.inherits(ol.render.webgl.circlereplay.defaultshader.Fragment,ol.webgl.Fragment);ol.render.webgl.circlereplay.defaultshader.Fragment.DEBUG_SOURCE="precision mediump float;\nvarying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_fillColor;\nuniform vec4 u_strokeColor;\nuniform vec2 u_size;\n\nvoid main(void) {\n  vec2 windowCenter = vec2((v_center.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_center.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  vec2 windowOffset = vec2((v_offset.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_offset.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  float radius = length(windowCenter - windowOffset);\n  float dist = length(windowCenter - gl_FragCoord.xy);\n  if (dist > radius + v_halfWidth) {\n    if (u_strokeColor.a == 0.0) {\n      gl_FragColor = u_fillColor;\n    } else {\n      gl_FragColor = u_strokeColor;\n    }\n    gl_FragColor.a = gl_FragColor.a - (dist - (radius + v_halfWidth));\n  } else if (u_fillColor.a == 0.0) {\n    // Hooray, no fill, just stroke. We can use real antialiasing.\n    gl_FragColor = u_strokeColor;\n    if (dist < radius - v_halfWidth) {\n      gl_FragColor.a = gl_FragColor.a - (radius - v_halfWidth - dist);\n    }\n  } else {\n    gl_FragColor = u_fillColor;\n    float strokeDist = radius - v_halfWidth;\n    float antialias = 2.0 * v_pixelRatio;\n    if (dist > strokeDist) {\n      gl_FragColor = u_strokeColor;\n    } else if (dist >= strokeDist - antialias) {\n      float step = smoothstep(strokeDist - antialias, strokeDist, dist);\n      gl_FragColor = mix(u_fillColor, u_strokeColor, step);\n    }\n  }\n  gl_FragColor.a = gl_FragColor.a * u_opacity;\n  if (gl_FragColor.a <= 0.0) {\n    discard;\n  }\n}\n";ol.render.webgl.circlereplay.defaultshader.Fragment.OPTIMIZED_SOURCE="precision mediump float;varying vec2 a;varying vec2 b;varying float c;varying float d;uniform float m;uniform vec4 n;uniform vec4 o;uniform vec2 p;void main(void){vec2 windowCenter=vec2((a.x+1.0)/2.0*p.x*d,(a.y+1.0)/2.0*p.y*d);vec2 windowOffset=vec2((b.x+1.0)/2.0*p.x*d,(b.y+1.0)/2.0*p.y*d);float radius=length(windowCenter-windowOffset);float dist=length(windowCenter-gl_FragCoord.xy);if(dist>radius+c){if(o.a==0.0){gl_FragColor=n;}else{gl_FragColor=o;}gl_FragColor.a=gl_FragColor.a-(dist-(radius+c));}else if(n.a==0.0){gl_FragColor=o;if(dist<radius-c){gl_FragColor.a=gl_FragColor.a-(radius-c-dist);}} else{gl_FragColor=n;float strokeDist=radius-c;float antialias=2.0*d;if(dist>strokeDist){gl_FragColor=o;}else if(dist>=strokeDist-antialias){float step=smoothstep(strokeDist-antialias,strokeDist,dist);gl_FragColor=mix(n,o,step);}} gl_FragColor.a=gl_FragColor.a*m;if(gl_FragColor.a<=0.0){discard;}}";ol.render.webgl.circlereplay.defaultshader.Fragment.SOURCE=ol.DEBUG_WEBGL?ol.render.webgl.circlereplay.defaultshader.Fragment.DEBUG_SOURCE:ol.render.webgl.circlereplay.defaultshader.Fragment.OPTIMIZED_SOURCE;ol.render.webgl.circlereplay.defaultshader.fragment=new ol.render.webgl.circlereplay.defaultshader.Fragment;ol.render.webgl.circlereplay.defaultshader.Vertex=function(){ol.webgl.Vertex.call(this,ol.render.webgl.circlereplay.defaultshader.Vertex.SOURCE)};ol.inherits(ol.render.webgl.circlereplay.defaultshader.Vertex,ol.webgl.Vertex);ol.render.webgl.circlereplay.defaultshader.Vertex.DEBUG_SOURCE="varying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\nattribute vec2 a_position;\nattribute float a_instruction;\nattribute float a_radius;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  v_center = vec4(u_projectionMatrix * vec4(a_position, 0.0, 1.0)).xy;\n  v_pixelRatio = u_pixelRatio;\n  float lineWidth = u_lineWidth * u_pixelRatio;\n  v_halfWidth = lineWidth / 2.0;\n  if (lineWidth == 0.0) {\n    lineWidth = 2.0 * u_pixelRatio;\n  }\n  vec2 offset;\n  // Radius with anitaliasing (roughly).\n  float radius = a_radius + 3.0 * u_pixelRatio;\n  // Until we get gl_VertexID in WebGL, we store an instruction.\n  if (a_instruction == 0.0) {\n    // Offsetting the edges of the triangle by lineWidth / 2 is necessary, however\n    // we should also leave some space for the antialiasing, thus we offset by lineWidth.\n    offset = vec2(-1.0, 1.0);\n  } else if (a_instruction == 1.0) {\n    offset = vec2(-1.0, -1.0);\n  } else if (a_instruction == 2.0) {\n    offset = vec2(1.0, -1.0);\n  } else {\n    offset = vec2(1.0, 1.0);\n  }\n\n  gl_Position = u_projectionMatrix * vec4(a_position + offset * radius, 0.0, 1.0) +\n      offsetMatrix * vec4(offset * lineWidth, 0.0, 0.0);\n  v_offset = vec4(u_projectionMatrix * vec4(a_position.x + a_radius, a_position.y,\n      0.0, 1.0)).xy;\n\n  if (distance(v_center, v_offset) > 20000.0) {\n    gl_Position = vec4(v_center, 0.0, 1.0);\n  }\n}\n\n\n";ol.render.webgl.circlereplay.defaultshader.Vertex.OPTIMIZED_SOURCE="varying vec2 a;varying vec2 b;varying float c;varying float d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;void main(void){mat4 offsetMatrix=i*j;a=vec4(h*vec4(e,0.0,1.0)).xy;d=l;float lineWidth=k*l;c=lineWidth/2.0;if(lineWidth==0.0){lineWidth=2.0*l;}vec2 offset;float radius=g+3.0*l;if(f==0.0){offset=vec2(-1.0,1.0);}else if(f==1.0){offset=vec2(-1.0,-1.0);}else if(f==2.0){offset=vec2(1.0,-1.0);}else{offset=vec2(1.0,1.0);}gl_Position=h*vec4(e+offset*radius,0.0,1.0)+offsetMatrix*vec4(offset*lineWidth,0.0,0.0);b=vec4(h*vec4(e.x+g,e.y,0.0,1.0)).xy;if(distance(a,b)>20000.0){gl_Position=vec4(a,0.0,1.0);}}";ol.render.webgl.circlereplay.defaultshader.Vertex.SOURCE=ol.DEBUG_WEBGL?ol.render.webgl.circlereplay.defaultshader.Vertex.DEBUG_SOURCE:ol.render.webgl.circlereplay.defaultshader.Vertex.OPTIMIZED_SOURCE;ol.render.webgl.circlereplay.defaultshader.vertex=new ol.render.webgl.circlereplay.defaultshader.Vertex;ol.render.webgl.circlereplay.defaultshader.Locations=function(e,t){this.u_fillColor=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_fillColor":"n");this.u_lineWidth=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_lineWidth":"k");this.u_offsetRotateMatrix=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_offsetRotateMatrix":"j");this.u_offsetScaleMatrix=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_offsetScaleMatrix":"i");this.u_opacity=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_opacity":"m");this.u_pixelRatio=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_pixelRatio":"l");this.u_projectionMatrix=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_projectionMatrix":"h");this.u_size=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_size":"p");this.u_strokeColor=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_strokeColor":"o");this.a_instruction=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_instruction":"f");this.a_position=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_position":"e");this.a_radius=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_radius":"g")}}goog.provide("ol.vec.Mat4");ol.vec.Mat4.create=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};ol.vec.Mat4.fromTransform=function(e,t){e[0]=t[0];e[1]=t[1];e[4]=t[2];e[5]=t[3];e[12]=t[4];e[13]=t[5];return e};goog.provide("ol.render.webgl.Replay");goog.require("ol");goog.require("ol.extent");goog.require("ol.render.VectorContext");goog.require("ol.transform");goog.require("ol.vec.Mat4");goog.require("ol.webgl");if(ol.ENABLE_WEBGL){ol.render.webgl.Replay=function(e,t){ol.render.VectorContext.call(this);this.tolerance=e;this.maxExtent=t;this.origin=ol.extent.getCenter(t);this.projectionMatrix_=ol.transform.create();this.offsetRotateMatrix_=ol.transform.create();this.offsetScaleMatrix_=ol.transform.create();this.tmpMat4_=ol.vec.Mat4.create();this.indices=[];this.indicesBuffer=null;this.startIndices=[];this.startIndicesFeature=[];this.vertices=[];this.verticesBuffer=null;this.lineStringReplay=void 0};ol.inherits(ol.render.webgl.Replay,ol.render.VectorContext);ol.render.webgl.Replay.prototype.getDeleteResourcesFunction=function(e){};ol.render.webgl.Replay.prototype.finish=function(e){};ol.render.webgl.Replay.prototype.setUpProgram=function(e,t,o,r){};ol.render.webgl.Replay.prototype.shutDownProgram=function(e,t){};ol.render.webgl.Replay.prototype.drawReplay=function(e,t,o,r){};ol.render.webgl.Replay.prototype.drawHitDetectionReplayOneByOne=function(e,t,o,r,i){};ol.render.webgl.Replay.prototype.drawHitDetectionReplay=function(e,t,o,r,i,n){return i?this.drawHitDetectionReplayOneByOne(e,t,o,r,n):this.drawHitDetectionReplayAll(e,t,o,r)};ol.render.webgl.Replay.prototype.drawHitDetectionReplayAll=function(e,t,o,r){e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);this.drawReplay(e,t,o,!0);var i=r(null);return i?i:void 0};ol.render.webgl.Replay.prototype.replay=function(e,t,o,r,i,n,a,l,s,p,c){var u,g,d,h,f,y,m,v,C=e.getGL();

if(this.lineStringReplay){u=C.isEnabled(C.STENCIL_TEST);g=C.getParameter(C.STENCIL_FUNC);d=C.getParameter(C.STENCIL_VALUE_MASK);h=C.getParameter(C.STENCIL_REF);f=C.getParameter(C.STENCIL_WRITEMASK);y=C.getParameter(C.STENCIL_FAIL);m=C.getParameter(C.STENCIL_PASS_DEPTH_PASS);v=C.getParameter(C.STENCIL_PASS_DEPTH_FAIL);C.enable(C.STENCIL_TEST);C.clear(C.STENCIL_BUFFER_BIT);C.stencilMask(255);C.stencilFunc(C.ALWAYS,1,255);C.stencilOp(C.KEEP,C.KEEP,C.REPLACE);this.lineStringReplay.replay(e,t,o,r,i,n,a,l,s,p,c);C.stencilMask(0);C.stencilFunc(C.NOTEQUAL,1,255)}e.bindBuffer(ol.webgl.ARRAY_BUFFER,this.verticesBuffer);e.bindBuffer(ol.webgl.ELEMENT_ARRAY_BUFFER,this.indicesBuffer);var T=this.setUpProgram(C,e,i,n),_=ol.transform.reset(this.projectionMatrix_);ol.transform.scale(_,2/(o*i[0]),2/(o*i[1]));ol.transform.rotate(_,-r);ol.transform.translate(_,-(t[0]-this.origin[0]),-(t[1]-this.origin[1]));var S=ol.transform.reset(this.offsetScaleMatrix_);ol.transform.scale(S,2/i[0],2/i[1]);var E=ol.transform.reset(this.offsetRotateMatrix_);0!==r&&ol.transform.rotate(E,-r);C.uniformMatrix4fv(T.u_projectionMatrix,!1,ol.vec.Mat4.fromTransform(this.tmpMat4_,_));C.uniformMatrix4fv(T.u_offsetScaleMatrix,!1,ol.vec.Mat4.fromTransform(this.tmpMat4_,S));C.uniformMatrix4fv(T.u_offsetRotateMatrix,!1,ol.vec.Mat4.fromTransform(this.tmpMat4_,E));C.uniform1f(T.u_opacity,a);var x;void 0===s?this.drawReplay(C,e,l,!1):x=this.drawHitDetectionReplay(C,e,l,s,p,c);this.shutDownProgram(C,T);if(this.lineStringReplay){u||C.disable(C.STENCIL_TEST);C.clear(C.STENCIL_BUFFER_BIT);C.stencilFunc(g,h,d);C.stencilMask(f);C.stencilOp(y,v,m)}return x};ol.render.webgl.Replay.prototype.drawElements=function(e,t,o,r){var i=t.hasOESElementIndexUint?ol.webgl.UNSIGNED_INT:ol.webgl.UNSIGNED_SHORT,n=t.hasOESElementIndexUint?4:2,a=r-o,l=o*n;e.drawElements(ol.webgl.TRIANGLES,a,i,l)}}goog.provide("ol.render.webgl");goog.require("ol");if(ol.ENABLE_WEBGL){ol.render.webgl.defaultFillStyle=[0,0,0,1];ol.render.webgl.defaultLineCap="round";ol.render.webgl.defaultLineDash=[];ol.render.webgl.defaultLineDashOffset=0;ol.render.webgl.defaultLineJoin="round";ol.render.webgl.defaultMiterLimit=10;ol.render.webgl.defaultStrokeStyle=[0,0,0,1];ol.render.webgl.defaultLineWidth=1;ol.render.webgl.triangleIsCounterClockwise=function(e,t,o,r,i,n){var a=(o-e)*(n-t)-(i-e)*(r-t);return a<=ol.render.webgl.EPSILON&&a>=-ol.render.webgl.EPSILON?void 0:a>0};ol.render.webgl.EPSILON=Number.EPSILON||2.220446049250313e-16}goog.provide("ol.webgl.Buffer");goog.require("ol");goog.require("ol.webgl");if(ol.ENABLE_WEBGL){ol.webgl.Buffer=function(e,t){this.arr_=void 0!==e?e:[];this.usage_=void 0!==t?t:ol.webgl.Buffer.Usage_.STATIC_DRAW};ol.webgl.Buffer.prototype.getArray=function(){return this.arr_};ol.webgl.Buffer.prototype.getUsage=function(){return this.usage_};ol.webgl.Buffer.Usage_={STATIC_DRAW:ol.webgl.STATIC_DRAW,STREAM_DRAW:ol.webgl.STREAM_DRAW,DYNAMIC_DRAW:ol.webgl.DYNAMIC_DRAW}}goog.provide("ol.render.webgl.CircleReplay");goog.require("ol");goog.require("ol.array");goog.require("ol.color");goog.require("ol.extent");goog.require("ol.obj");goog.require("ol.geom.flat.transform");goog.require("ol.render.webgl.circlereplay.defaultshader");goog.require("ol.render.webgl.Replay");goog.require("ol.render.webgl");goog.require("ol.webgl");goog.require("ol.webgl.Buffer");if(ol.ENABLE_WEBGL){ol.render.webgl.CircleReplay=function(e,t){ol.render.webgl.Replay.call(this,e,t);this.defaultLocations_=null;this.styles_=[];this.styleIndices_=[];this.radius_=0;this.state_={fillColor:null,strokeColor:null,lineDash:null,lineDashOffset:void 0,lineWidth:void 0,changed:!1}};ol.inherits(ol.render.webgl.CircleReplay,ol.render.webgl.Replay);ol.render.webgl.CircleReplay.prototype.drawCoordinates_=function(e,t,o,r){var i,n,a=this.vertices.length,l=this.indices.length,s=a/4;for(i=t,n=o;n>i;i+=r){this.vertices[a++]=e[i];this.vertices[a++]=e[i+1];this.vertices[a++]=0;this.vertices[a++]=this.radius_;this.vertices[a++]=e[i];this.vertices[a++]=e[i+1];this.vertices[a++]=1;this.vertices[a++]=this.radius_;this.vertices[a++]=e[i];this.vertices[a++]=e[i+1];this.vertices[a++]=2;this.vertices[a++]=this.radius_;this.vertices[a++]=e[i];this.vertices[a++]=e[i+1];this.vertices[a++]=3;this.vertices[a++]=this.radius_;this.indices[l++]=s;this.indices[l++]=s+1;this.indices[l++]=s+2;this.indices[l++]=s+2;this.indices[l++]=s+3;this.indices[l++]=s;s+=4}};ol.render.webgl.CircleReplay.prototype.drawCircle=function(e,t){var o=e.getRadius(),r=e.getStride();if(o){this.startIndices.push(this.indices.length);this.startIndicesFeature.push(t);if(this.state_.changed){this.styleIndices_.push(this.indices.length);this.state_.changed=!1}this.radius_=o;var i=e.getFlatCoordinates();i=ol.geom.flat.transform.translate(i,0,2,r,-this.origin[0],-this.origin[1]);this.drawCoordinates_(i,0,2,r)}else if(this.state_.changed){this.styles_.pop();if(this.styles_.length){var n=this.styles_[this.styles_.length-1];this.state_.fillColor=n[0];this.state_.strokeColor=n[1];this.state_.lineWidth=n[2];this.state_.changed=!1}}};ol.render.webgl.CircleReplay.prototype.finish=function(e){this.verticesBuffer=new ol.webgl.Buffer(this.vertices);this.indicesBuffer=new ol.webgl.Buffer(this.indices);this.startIndices.push(this.indices.length);0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]);this.vertices=null;this.indices=null};ol.render.webgl.CircleReplay.prototype.getDeleteResourcesFunction=function(e){var t=this.verticesBuffer,o=this.indicesBuffer;return function(){e.deleteBuffer(t);e.deleteBuffer(o)}};ol.render.webgl.CircleReplay.prototype.setUpProgram=function(e,t,o,r){var i,n;i=ol.render.webgl.circlereplay.defaultshader.fragment;n=ol.render.webgl.circlereplay.defaultshader.vertex;var a,l=t.getProgram(i,n);if(this.defaultLocations_)a=this.defaultLocations_;else{a=new ol.render.webgl.circlereplay.defaultshader.Locations(e,l);this.defaultLocations_=a}t.useProgram(l);e.enableVertexAttribArray(a.a_position);e.vertexAttribPointer(a.a_position,2,ol.webgl.FLOAT,!1,16,0);e.enableVertexAttribArray(a.a_instruction);e.vertexAttribPointer(a.a_instruction,1,ol.webgl.FLOAT,!1,16,8);e.enableVertexAttribArray(a.a_radius);e.vertexAttribPointer(a.a_radius,1,ol.webgl.FLOAT,!1,16,12);e.uniform2fv(a.u_size,o);e.uniform1f(a.u_pixelRatio,r);return a};ol.render.webgl.CircleReplay.prototype.shutDownProgram=function(e,t){e.disableVertexAttribArray(t.a_position);e.disableVertexAttribArray(t.a_instruction);e.disableVertexAttribArray(t.a_radius)};ol.render.webgl.CircleReplay.prototype.drawReplay=function(e,t,o,r){if(ol.obj.isEmpty(o)){var i,n,a,l;a=this.startIndices[this.startIndices.length-1];for(i=this.styleIndices_.length-1;i>=0;--i){n=this.styleIndices_[i];l=this.styles_[i];this.setFillStyle_(e,l[0]);this.setStrokeStyle_(e,l[1],l[2]);this.drawElements(e,t,n,a);a=n}}else this.drawReplaySkipping_(e,t,o)};ol.render.webgl.CircleReplay.prototype.drawHitDetectionReplayOneByOne=function(e,t,o,r,i){var n,a,l,s,p,c,u,g;g=this.startIndices.length-2;l=this.startIndices[g+1];for(n=this.styleIndices_.length-1;n>=0;--n){s=this.styles_[n];this.setFillStyle_(e,s[0]);this.setStrokeStyle_(e,s[1],s[2]);p=this.styleIndices_[n];for(;g>=0&&this.startIndices[g]>=p;){a=this.startIndices[g];c=this.startIndicesFeature[g];u=ol.getUid(c).toString();if(void 0===o[u]&&c.getGeometry()&&(void 0===i||ol.extent.intersects(i,c.getGeometry().getExtent()))){e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);this.drawElements(e,t,a,l);var d=r(c);if(d)return d}g--;l=a}}return void 0};ol.render.webgl.CircleReplay.prototype.drawReplaySkipping_=function(e,t,o){var r,i,n,a,l,s,p,c,u;c=this.startIndices.length-2;n=i=this.startIndices[c+1];for(r=this.styleIndices_.length-1;r>=0;--r){a=this.styles_[r];this.setFillStyle_(e,a[0]);this.setStrokeStyle_(e,a[1],a[2]);l=this.styleIndices_[r];for(;c>=0&&this.startIndices[c]>=l;){u=this.startIndices[c];s=this.startIndicesFeature[c];p=ol.getUid(s).toString();if(o[p]){i!==n&&this.drawElements(e,t,i,n);n=u}c--;i=u}i!==n&&this.drawElements(e,t,i,n);i=n=l}};ol.render.webgl.CircleReplay.prototype.setFillStyle_=function(e,t){e.uniform4fv(this.defaultLocations_.u_fillColor,t)};ol.render.webgl.CircleReplay.prototype.setStrokeStyle_=function(e,t,o){e.uniform4fv(this.defaultLocations_.u_strokeColor,t);e.uniform1f(this.defaultLocations_.u_lineWidth,o)};ol.render.webgl.CircleReplay.prototype.setFillStrokeStyle=function(e,t){var o,r;if(t){var i=t.getLineDash();this.state_.lineDash=i?i:ol.render.webgl.defaultLineDash;var n=t.getLineDashOffset();this.state_.lineDashOffset=n?n:ol.render.webgl.defaultLineDashOffset;o=t.getColor();o=o instanceof CanvasGradient||o instanceof CanvasPattern?ol.render.webgl.defaultStrokeStyle:ol.color.asArray(o).map(function(e,t){return 3!=t?e/255:e})||ol.render.webgl.defaultStrokeStyle;r=t.getWidth();r=void 0!==r?r:ol.render.webgl.defaultLineWidth}else{o=[0,0,0,0];r=0}var a=e?e.getColor():[0,0,0,0];a=a instanceof CanvasGradient||a instanceof CanvasPattern?ol.render.webgl.defaultFillStyle:ol.color.asArray(a).map(function(e,t){return 3!=t?e/255:e})||ol.render.webgl.defaultFillStyle;if(!(this.state_.strokeColor&&ol.array.equals(this.state_.strokeColor,o)&&this.state_.fillColor&&ol.array.equals(this.state_.fillColor,a)&&this.state_.lineWidth===r)){this.state_.changed=!0;this.state_.fillColor=a;this.state_.strokeColor=o;this.state_.lineWidth=r;this.styles_.push([a,o,r])}}}goog.provide("ol.render.webgl.imagereplay.defaultshader");goog.require("ol");goog.require("ol.webgl.Fragment");goog.require("ol.webgl.Vertex");if(ol.ENABLE_WEBGL){ol.render.webgl.imagereplay.defaultshader.Fragment=function(){ol.webgl.Fragment.call(this,ol.render.webgl.imagereplay.defaultshader.Fragment.SOURCE)};ol.inherits(ol.render.webgl.imagereplay.defaultshader.Fragment,ol.webgl.Fragment);ol.render.webgl.imagereplay.defaultshader.Fragment.DEBUG_SOURCE="precision mediump float;\nvarying vec2 v_texCoord;\nvarying float v_opacity;\n\nuniform float u_opacity;\nuniform sampler2D u_image;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  float alpha = texColor.a * v_opacity * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n";ol.render.webgl.imagereplay.defaultshader.Fragment.OPTIMIZED_SOURCE="precision mediump float;varying vec2 a;varying float b;uniform float k;uniform sampler2D l;void main(void){vec4 texColor=texture2D(l,a);gl_FragColor.rgb=texColor.rgb;float alpha=texColor.a*b*k;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}";ol.render.webgl.imagereplay.defaultshader.Fragment.SOURCE=ol.DEBUG_WEBGL?ol.render.webgl.imagereplay.defaultshader.Fragment.DEBUG_SOURCE:ol.render.webgl.imagereplay.defaultshader.Fragment.OPTIMIZED_SOURCE;ol.render.webgl.imagereplay.defaultshader.fragment=new ol.render.webgl.imagereplay.defaultshader.Fragment;ol.render.webgl.imagereplay.defaultshader.Vertex=function(){ol.webgl.Vertex.call(this,ol.render.webgl.imagereplay.defaultshader.Vertex.SOURCE)};ol.inherits(ol.render.webgl.imagereplay.defaultshader.Vertex,ol.webgl.Vertex);ol.render.webgl.imagereplay.defaultshader.Vertex.DEBUG_SOURCE="varying vec2 v_texCoord;\nvarying float v_opacity;\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec2 a_offsets;\nattribute float a_opacity;\nattribute float a_rotateWithView;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix;\n  if (a_rotateWithView == 1.0) {\n    offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  }\n  vec4 offsets = offsetMatrix * vec4(a_offsets, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  v_texCoord = a_texCoord;\n  v_opacity = a_opacity;\n}\n\n\n";ol.render.webgl.imagereplay.defaultshader.Vertex.OPTIMIZED_SOURCE="varying vec2 a;varying float b;attribute vec2 c;attribute vec2 d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;void main(void){mat4 offsetMatrix=i;if(g==1.0){offsetMatrix=i*j;}vec4 offsets=offsetMatrix*vec4(e,0.0,0.0);gl_Position=h*vec4(c,0.0,1.0)+offsets;a=d;b=f;}";ol.render.webgl.imagereplay.defaultshader.Vertex.SOURCE=ol.DEBUG_WEBGL?ol.render.webgl.imagereplay.defaultshader.Vertex.DEBUG_SOURCE:ol.render.webgl.imagereplay.defaultshader.Vertex.OPTIMIZED_SOURCE;ol.render.webgl.imagereplay.defaultshader.vertex=new ol.render.webgl.imagereplay.defaultshader.Vertex;ol.render.webgl.imagereplay.defaultshader.Locations=function(e,t){this.u_image=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_image":"l");this.u_offsetRotateMatrix=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_offsetRotateMatrix":"j");this.u_offsetScaleMatrix=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_offsetScaleMatrix":"i");this.u_opacity=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_opacity":"k");this.u_projectionMatrix=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_projectionMatrix":"h");this.a_offsets=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_offsets":"e");this.a_opacity=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_opacity":"f");this.a_position=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_position":"c");this.a_rotateWithView=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_rotateWithView":"g");this.a_texCoord=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_texCoord":"d")}}goog.provide("ol.webgl.ContextEventType");ol.webgl.ContextEventType={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};goog.provide("ol.webgl.Context");goog.require("ol");goog.require("ol.Disposable");goog.require("ol.array");goog.require("ol.events");goog.require("ol.obj");goog.require("ol.webgl");goog.require("ol.webgl.ContextEventType");if(ol.ENABLE_WEBGL){ol.webgl.Context=function(e,t){this.canvas_=e;this.gl_=t;this.bufferCache_={};this.shaderCache_={};this.programCache_={};this.currentProgram_=null;this.hitDetectionFramebuffer_=null;this.hitDetectionTexture_=null;this.hitDetectionRenderbuffer_=null;this.hasOESElementIndexUint=ol.array.includes(ol.WEBGL_EXTENSIONS,"OES_element_index_uint");this.hasOESElementIndexUint&&t.getExtension("OES_element_index_uint");ol.events.listen(this.canvas_,ol.webgl.ContextEventType.LOST,this.handleWebGLContextLost,this);ol.events.listen(this.canvas_,ol.webgl.ContextEventType.RESTORED,this.handleWebGLContextRestored,this)};ol.inherits(ol.webgl.Context,ol.Disposable);ol.webgl.Context.prototype.bindBuffer=function(e,t){var o=this.getGL(),r=t.getArray(),i=String(ol.getUid(t));if(i in this.bufferCache_){var n=this.bufferCache_[i];o.bindBuffer(e,n.buffer)}else{var a=o.createBuffer();o.bindBuffer(e,a);var l;e==ol.webgl.ARRAY_BUFFER?l=new Float32Array(r):e==ol.webgl.ELEMENT_ARRAY_BUFFER&&(l=this.hasOESElementIndexUint?new Uint32Array(r):new Uint16Array(r));o.bufferData(e,l,t.getUsage());this.bufferCache_[i]={buf:t,buffer:a}}};ol.webgl.Context.prototype.deleteBuffer=function(e){var t=this.getGL(),o=String(ol.getUid(e)),r=this.bufferCache_[o];t.isContextLost()||t.deleteBuffer(r.buffer);delete this.bufferCache_[o]};ol.webgl.Context.prototype.disposeInternal=function(){ol.events.unlistenAll(this.canvas_);var e=this.getGL();if(!e.isContextLost()){var t;for(t in this.bufferCache_)e.deleteBuffer(this.bufferCache_[t].buffer);for(t in this.programCache_)e.deleteProgram(this.programCache_[t]);for(t in this.shaderCache_)e.deleteShader(this.shaderCache_[t]);e.deleteFramebuffer(this.hitDetectionFramebuffer_);e.deleteRenderbuffer(this.hitDetectionRenderbuffer_);e.deleteTexture(this.hitDetectionTexture_)}};ol.webgl.Context.prototype.getCanvas=function(){return this.canvas_};ol.webgl.Context.prototype.getGL=function(){return this.gl_};ol.webgl.Context.prototype.getHitDetectionFramebuffer=function(){this.hitDetectionFramebuffer_||this.initHitDetectionFramebuffer_();return this.hitDetectionFramebuffer_};ol.webgl.Context.prototype.getShader=function(e){var t=String(ol.getUid(e));if(t in this.shaderCache_)return this.shaderCache_[t];var o=this.getGL(),r=o.createShader(e.getType());o.shaderSource(r,e.getSource());o.compileShader(r);this.shaderCache_[t]=r;return r};ol.webgl.Context.prototype.getProgram=function(e,t){var o=ol.getUid(e)+"/"+ol.getUid(t);if(o in this.programCache_)return this.programCache_[o];var r=this.getGL(),i=r.createProgram();r.attachShader(i,this.getShader(e));r.attachShader(i,this.getShader(t));r.linkProgram(i);this.programCache_[o]=i;return i};ol.webgl.Context.prototype.handleWebGLContextLost=function(){ol.obj.clear(this.bufferCache_);ol.obj.clear(this.shaderCache_);ol.obj.clear(this.programCache_);this.currentProgram_=null;this.hitDetectionFramebuffer_=null;this.hitDetectionTexture_=null;this.hitDetectionRenderbuffer_=null};ol.webgl.Context.prototype.handleWebGLContextRestored=function(){};ol.webgl.Context.prototype.initHitDetectionFramebuffer_=function(){var e=this.gl_,t=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,t);var o=ol.webgl.Context.createEmptyTexture(e,1,1),r=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,r);e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,1,1);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,o,0);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,r);e.bindTexture(e.TEXTURE_2D,null);e.bindRenderbuffer(e.RENDERBUFFER,null);e.bindFramebuffer(e.FRAMEBUFFER,null);this.hitDetectionFramebuffer_=t;this.hitDetectionTexture_=o;this.hitDetectionRenderbuffer_=r};ol.webgl.Context.prototype.useProgram=function(e){if(e==this.currentProgram_)return!1;var t=this.getGL();t.useProgram(e);this.currentProgram_=e;return!0};ol.webgl.Context.createTexture_=function(e,t,o){var r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR);void 0!==t&&e.texParameteri(ol.webgl.TEXTURE_2D,ol.webgl.TEXTURE_WRAP_S,t);void 0!==o&&e.texParameteri(ol.webgl.TEXTURE_2D,ol.webgl.TEXTURE_WRAP_T,o);return r};ol.webgl.Context.createEmptyTexture=function(e,t,o,r,i){var n=ol.webgl.Context.createTexture_(e,r,i);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,o,0,e.RGBA,e.UNSIGNED_BYTE,null);return n};ol.webgl.Context.createTexture=function(e,t,o,r){var i=ol.webgl.Context.createTexture_(e,o,r);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);return i}}goog.provide("ol.render.webgl.ImageReplay");goog.require("ol");goog.require("ol.extent");goog.require("ol.obj");goog.require("ol.render.webgl.imagereplay.defaultshader");goog.require("ol.render.webgl.Replay");goog.require("ol.webgl");goog.require("ol.webgl.Buffer");goog.require("ol.webgl.Context");if(ol.ENABLE_WEBGL){ol.render.webgl.ImageReplay=function(e,t){ol.render.webgl.Replay.call(this,e,t);this.anchorX_=void 0;this.anchorY_=void 0;this.groupIndices_=[];this.hitDetectionGroupIndices_=[];this.height_=void 0;this.images_=[];this.hitDetectionImages_=[];this.imageHeight_=void 0;this.imageWidth_=void 0;this.defaultLocations_=null;this.opacity_=void 0;this.originX_=void 0;this.originY_=void 0;this.rotateWithView_=void 0;this.rotation_=void 0;this.scale_=void 0;this.textures_=[];this.hitDetectionTextures_=[];this.width_=void 0};ol.inherits(ol.render.webgl.ImageReplay,ol.render.webgl.Replay);ol.render.webgl.ImageReplay.prototype.getDeleteResourcesFunction=function(e){var t=this.verticesBuffer,o=this.indicesBuffer,r=this.textures_,i=this.hitDetectionTextures_,n=e.getGL();return function(){if(!n.isContextLost()){var a,l;for(a=0,l=r.length;l>a;++a)n.deleteTexture(r[a]);for(a=0,l=i.length;l>a;++a)n.deleteTexture(i[a])}e.deleteBuffer(t);e.deleteBuffer(o)}};ol.render.webgl.ImageReplay.prototype.drawCoordinates_=function(e,t,o,r){var i,n,a,l,s,p,c=this.anchorX_,u=this.anchorY_,g=this.height_,d=this.imageHeight_,h=this.imageWidth_,f=this.opacity_,y=this.originX_,m=this.originY_,v=this.rotateWithView_?1:0,C=-this.rotation_,T=this.scale_,_=this.width_,S=Math.cos(C),E=Math.sin(C),x=this.indices.length,P=this.vertices.length;for(i=t;o>i;i+=r){s=e[i]-this.origin[0];p=e[i+1]-this.origin[1];n=P/8;a=-T*c;l=-T*(g-u);this.vertices[P++]=s;this.vertices[P++]=p;this.vertices[P++]=a*S-l*E;this.vertices[P++]=a*E+l*S;this.vertices[P++]=y/h;this.vertices[P++]=(m+g)/d;this.vertices[P++]=f;this.vertices[P++]=v;a=T*(_-c);l=-T*(g-u);this.vertices[P++]=s;this.vertices[P++]=p;this.vertices[P++]=a*S-l*E;this.vertices[P++]=a*E+l*S;this.vertices[P++]=(y+_)/h;this.vertices[P++]=(m+g)/d;this.vertices[P++]=f;this.vertices[P++]=v;a=T*(_-c);l=T*u;this.vertices[P++]=s;this.vertices[P++]=p;this.vertices[P++]=a*S-l*E;this.vertices[P++]=a*E+l*S;this.vertices[P++]=(y+_)/h;this.vertices[P++]=m/d;this.vertices[P++]=f;this.vertices[P++]=v;a=-T*c;l=T*u;this.vertices[P++]=s;this.vertices[P++]=p;this.vertices[P++]=a*S-l*E;this.vertices[P++]=a*E+l*S;this.vertices[P++]=y/h;this.vertices[P++]=m/d;this.vertices[P++]=f;this.vertices[P++]=v;this.indices[x++]=n;this.indices[x++]=n+1;this.indices[x++]=n+2;this.indices[x++]=n;this.indices[x++]=n+2;this.indices[x++]=n+3}return P};ol.render.webgl.ImageReplay.prototype.drawMultiPoint=function(e,t){this.startIndices.push(this.indices.length);this.startIndicesFeature.push(t);var o=e.getFlatCoordinates(),r=e.getStride();this.drawCoordinates_(o,0,o.length,r)};ol.render.webgl.ImageReplay.prototype.drawPoint=function(e,t){this.startIndices.push(this.indices.length);this.startIndicesFeature.push(t);var o=e.getFlatCoordinates(),r=e.getStride();this.drawCoordinates_(o,0,o.length,r)};ol.render.webgl.ImageReplay.prototype.finish=function(e){var t=e.getGL();this.groupIndices_.push(this.indices.length);this.hitDetectionGroupIndices_.push(this.indices.length);this.verticesBuffer=new ol.webgl.Buffer(this.vertices);var o=this.indices;this.indicesBuffer=new ol.webgl.Buffer(o);var r={};this.createTextures_(this.textures_,this.images_,r,t);this.createTextures_(this.hitDetectionTextures_,this.hitDetectionImages_,r,t);this.anchorX_=void 0;this.anchorY_=void 0;this.height_=void 0;this.images_=null;this.hitDetectionImages_=null;this.imageHeight_=void 0;this.imageWidth_=void 0;this.indices=null;this.opacity_=void 0;this.originX_=void 0;this.originY_=void 0;this.rotateWithView_=void 0;this.rotation_=void 0;this.scale_=void 0;this.vertices=null;this.width_=void 0};ol.render.webgl.ImageReplay.prototype.createTextures_=function(e,t,o,r){var i,n,a,l,s=t.length;for(l=0;s>l;++l){n=t[l];a=ol.getUid(n).toString();if(a in o)i=o[a];else{i=ol.webgl.Context.createTexture(r,n,ol.webgl.CLAMP_TO_EDGE,ol.webgl.CLAMP_TO_EDGE);o[a]=i}e[l]=i}};ol.render.webgl.ImageReplay.prototype.setUpProgram=function(e,t,o,r){var i,n=ol.render.webgl.imagereplay.defaultshader.fragment,a=ol.render.webgl.imagereplay.defaultshader.vertex,l=t.getProgram(n,a);if(this.defaultLocations_)i=this.defaultLocations_;else{i=new ol.render.webgl.imagereplay.defaultshader.Locations(e,l);this.defaultLocations_=i}t.useProgram(l);e.enableVertexAttribArray(i.a_position);e.vertexAttribPointer(i.a_position,2,ol.webgl.FLOAT,!1,32,0);e.enableVertexAttribArray(i.a_offsets);e.vertexAttribPointer(i.a_offsets,2,ol.webgl.FLOAT,!1,32,8);e.enableVertexAttribArray(i.a_texCoord);e.vertexAttribPointer(i.a_texCoord,2,ol.webgl.FLOAT,!1,32,16);e.enableVertexAttribArray(i.a_opacity);e.vertexAttribPointer(i.a_opacity,1,ol.webgl.FLOAT,!1,32,24);e.enableVertexAttribArray(i.a_rotateWithView);e.vertexAttribPointer(i.a_rotateWithView,1,ol.webgl.FLOAT,!1,32,28);return i};ol.render.webgl.ImageReplay.prototype.shutDownProgram=function(e,t){e.disableVertexAttribArray(t.a_position);e.disableVertexAttribArray(t.a_offsets);e.disableVertexAttribArray(t.a_texCoord);e.disableVertexAttribArray(t.a_opacity);e.disableVertexAttribArray(t.a_rotateWithView)};ol.render.webgl.ImageReplay.prototype.drawReplay=function(e,t,o,r){var i=r?this.hitDetectionTextures_:this.textures_,n=r?this.hitDetectionGroupIndices_:this.groupIndices_;if(ol.obj.isEmpty(o)){var a,l,s;for(a=0,l=i.length,s=0;l>a;++a){e.bindTexture(ol.webgl.TEXTURE_2D,i[a]);var p=n[a];this.drawElements(e,t,s,p);s=p}}else this.drawReplaySkipping_(e,t,o,i,n)};ol.render.webgl.ImageReplay.prototype.drawReplaySkipping_=function(e,t,o,r,i){var n,a,l=0;for(n=0,a=r.length;a>n;++n){e.bindTexture(ol.webgl.TEXTURE_2D,r[n]);for(var s=n>0?i[n-1]:0,p=i[n],c=s,u=s;l<this.startIndices.length&&this.startIndices[l]<=p;){var g=this.startIndicesFeature[l],d=ol.getUid(g).toString();if(void 0!==o[d]){c!==u&&this.drawElements(e,t,c,u);c=l===this.startIndices.length-1?p:this.startIndices[l+1];u=c}else u=l===this.startIndices.length-1?p:this.startIndices[l+1];l++}c!==u&&this.drawElements(e,t,c,u)}};ol.render.webgl.ImageReplay.prototype.drawHitDetectionReplayOneByOne=function(e,t,o,r,i){var n,a,l,s,p,c,u=this.startIndices.length-1;for(n=this.hitDetectionTextures_.length-1;n>=0;--n){e.bindTexture(ol.webgl.TEXTURE_2D,this.hitDetectionTextures_[n]);a=n>0?this.hitDetectionGroupIndices_[n-1]:0;s=this.hitDetectionGroupIndices_[n];for(;u>=0&&this.startIndices[u]>=a;){l=this.startIndices[u];p=this.startIndicesFeature[u];c=ol.getUid(p).toString();if(void 0===o[c]&&p.getGeometry()&&(void 0===i||ol.extent.intersects(i,p.getGeometry().getExtent()))){e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);this.drawElements(e,t,l,s);var g=r(p);if(g)return g}s=l;u--}}return void 0};ol.render.webgl.ImageReplay.prototype.setImageStyle=function(e){var t,o=e.getAnchor(),r=e.getImage(1),i=e.getImageSize(),n=e.getHitDetectionImage(1),a=e.getOpacity(),l=e.getOrigin(),s=e.getRotateWithView(),p=e.getRotation(),c=e.getSize(),u=e.getScale();if(0===this.images_.length)this.images_.push(r);else{t=this.images_[this.images_.length-1];if(ol.getUid(t)!=ol.getUid(r)){this.groupIndices_.push(this.indices.length);this.images_.push(r)}}if(0===this.hitDetectionImages_.length)this.hitDetectionImages_.push(n);else{t=this.hitDetectionImages_[this.hitDetectionImages_.length-1];if(ol.getUid(t)!=ol.getUid(n)){this.hitDetectionGroupIndices_.push(this.indices.length);this.hitDetectionImages_.push(n)}}this.anchorX_=o[0];this.anchorY_=o[1];this.height_=c[1];this.imageHeight_=i[1];this.imageWidth_=i[0];this.opacity_=a;this.originX_=l[0];this.originY_=l[1];this.rotation_=p;this.rotateWithView_=s;this.scale_=u;this.width_=c[0]}}goog.provide("ol.geom.flat.topology");goog.require("ol.geom.flat.area");ol.geom.flat.topology.lineStringIsClosed=function(e,t,o,r){var i=o-r;return e[t]===e[i]&&e[t+1]===e[i+1]&&(o-t)/r>3?!!ol.geom.flat.area.linearRing(e,t,o,r):!1};goog.provide("ol.render.webgl.linestringreplay.defaultshader");goog.require("ol");goog.require("ol.webgl.Fragment");goog.require("ol.webgl.Vertex");if(ol.ENABLE_WEBGL){ol.render.webgl.linestringreplay.defaultshader.Fragment=function(){ol.webgl.Fragment.call(this,ol.render.webgl.linestringreplay.defaultshader.Fragment.SOURCE)};ol.inherits(ol.render.webgl.linestringreplay.defaultshader.Fragment,ol.webgl.Fragment);ol.render.webgl.linestringreplay.defaultshader.Fragment.DEBUG_SOURCE="precision mediump float;\nvarying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_color;\nuniform vec2 u_size;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  if (v_round > 0.0) {\n    vec2 windowCoords = vec2((v_roundVertex.x + 1.0) / 2.0 * u_size.x * u_pixelRatio,\n        (v_roundVertex.y + 1.0) / 2.0 * u_size.y * u_pixelRatio);\n    if (length(windowCoords - gl_FragCoord.xy) > v_halfWidth * u_pixelRatio) {\n      discard;\n    }\n  }\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n";ol.render.webgl.linestringreplay.defaultshader.Fragment.OPTIMIZED_SOURCE="precision mediump float;varying float a;varying vec2 b;varying float c;uniform float m;uniform vec4 n;uniform vec2 o;uniform float p;void main(void){if(a>0.0){vec2 windowCoords=vec2((b.x+1.0)/2.0*o.x*p,(b.y+1.0)/2.0*o.y*p);if(length(windowCoords-gl_FragCoord.xy)>c*p){discard;}} gl_FragColor=n;float alpha=n.a*m;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}";ol.render.webgl.linestringreplay.defaultshader.Fragment.SOURCE=ol.DEBUG_WEBGL?ol.render.webgl.linestringreplay.defaultshader.Fragment.DEBUG_SOURCE:ol.render.webgl.linestringreplay.defaultshader.Fragment.OPTIMIZED_SOURCE;ol.render.webgl.linestringreplay.defaultshader.fragment=new ol.render.webgl.linestringreplay.defaultshader.Fragment;ol.render.webgl.linestringreplay.defaultshader.Vertex=function(){ol.webgl.Vertex.call(this,ol.render.webgl.linestringreplay.defaultshader.Vertex.SOURCE)};ol.inherits(ol.render.webgl.linestringreplay.defaultshader.Vertex,ol.webgl.Vertex);ol.render.webgl.linestringreplay.defaultshader.Vertex.DEBUG_SOURCE="varying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\nattribute vec2 a_lastPos;\nattribute vec2 a_position;\nattribute vec2 a_nextPos;\nattribute float a_direction;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_miterLimit;\n\nbool nearlyEquals(in float value, in float ref) {\n  float epsilon = 0.000000000001;\n  return value >= ref - epsilon && value <= ref + epsilon;\n}\n\nvoid alongNormal(out vec2 offset, in vec2 nextP, in float turnDir, in float direction) {\n  vec2 dirVect = nextP - a_position;\n  vec2 normal = normalize(vec2(-turnDir * dirVect.y, turnDir * dirVect.x));\n  offset = u_lineWidth / 2.0 * normal * direction;\n}\n\nvoid miterUp(out vec2 offset, out float round, in bool isRound, in float direction) {\n  float halfWidth = u_lineWidth / 2.0;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_nextPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n  offset = normal * direction * miterLength;\n  round = 0.0;\n  if (isRound) {\n    round = 1.0;\n  } else if (miterLength > u_miterLimit + u_lineWidth) {\n    offset = halfWidth * tmpNormal * direction;\n  }\n}\n\nbool miterDown(out vec2 offset, in vec4 projPos, in mat4 offsetMatrix, in float direction) {\n  bool degenerate = false;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_lastPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  vec2 longOffset, shortOffset, longVertex;\n  vec4 shortProjVertex;\n  float halfWidth = u_lineWidth / 2.0;\n  if (length(a_nextPos - a_position) > length(a_lastPos - a_position)) {\n    longOffset = tmpNormal * direction * halfWidth;\n    shortOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_nextPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_lastPos, 0.0, 1.0);\n  } else {\n    shortOffset = tmpNormal * direction * halfWidth;\n    longOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_lastPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_nextPos, 0.0, 1.0);\n  }\n  //Intersection algorithm based on theory by Paul Bourke (http://paulbourke.net/geometry/pointlineplane/).\n  vec4 p1 = u_projectionMatrix * vec4(longVertex, 0.0, 1.0) + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p2 = projPos + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p3 = shortProjVertex + offsetMatrix * vec4(-shortOffset, 0.0, 0.0);\n  vec4 p4 = shortProjVertex + offsetMatrix * vec4(shortOffset, 0.0, 0.0);\n  float denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\n  float firstU = ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\n  float secondU = ((p2.x - p1.x) * (p1.y - p3.y) - (p2.y - p1.y) * (p1.x - p3.x)) / denom;\n  float epsilon = 0.000000000001;\n  if (firstU > epsilon && firstU < 1.0 - epsilon && secondU > epsilon && secondU < 1.0 - epsilon) {\n    shortProjVertex.x = p1.x + firstU * (p2.x - p1.x);\n    shortProjVertex.y = p1.y + firstU * (p2.y - p1.y);\n    offset = shortProjVertex.xy;\n    degenerate = true;\n  } else {\n    float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n    offset = normal * direction * miterLength;\n  }\n  return degenerate;\n}\n\nvoid squareCap(out vec2 offset, out float round, in bool isRound, in vec2 nextP,\n    in float turnDir, in float direction) {\n  round = 0.0;\n  vec2 dirVect = a_position - nextP;\n  vec2 firstNormal = normalize(dirVect);\n  vec2 secondNormal = vec2(turnDir * firstNormal.y * direction, -turnDir * firstNormal.x * direction);\n  vec2 hypotenuse = normalize(firstNormal - secondNormal);\n  vec2 normal = vec2(turnDir * hypotenuse.y * direction, -turnDir * hypotenuse.x * direction);\n  float length = sqrt(v_halfWidth * v_halfWidth * 2.0);\n  offset = normal * length;\n  if (isRound) {\n    round = 1.0;\n  }\n}\n\nvoid main(void) {\n  bool degenerate = false;\n  float direction = float(sign(a_direction));\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  vec2 offset;\n  vec4 projPos = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n  bool round = nearlyEquals(mod(a_direction, 2.0), 0.0);\n\n  v_round = 0.0;\n  v_halfWidth = u_lineWidth / 2.0;\n  v_roundVertex = projPos.xy;\n\n  if (nearlyEquals(mod(a_direction, 3.0), 0.0) || nearlyEquals(mod(a_direction, 17.0), 0.0)) {\n    alongNormal(offset, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 5.0), 0.0) || nearlyEquals(mod(a_direction, 13.0), 0.0)) {\n    alongNormal(offset, a_lastPos, -1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 23.0), 0.0)) {\n    miterUp(offset, v_round, round, direction);\n  } else if (nearlyEquals(mod(a_direction, 19.0), 0.0)) {\n    degenerate = miterDown(offset, projPos, offsetMatrix, direction);\n  } else if (nearlyEquals(mod(a_direction, 7.0), 0.0)) {\n    squareCap(offset, v_round, round, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 11.0), 0.0)) {\n    squareCap(offset, v_round, round, a_lastPos, -1.0, direction);\n  }\n  if (!degenerate) {\n    vec4 offsets = offsetMatrix * vec4(offset, 0.0, 0.0);\n    gl_Position = projPos + offsets;\n  } else {\n    gl_Position = vec4(offset, 0.0, 1.0);\n  }\n}\n\n\n";

ol.render.webgl.linestringreplay.defaultshader.Vertex.OPTIMIZED_SOURCE="varying float a;varying vec2 b;varying float c;attribute vec2 d;attribute vec2 e;attribute vec2 f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;bool nearlyEquals(in float value,in float ref){float epsilon=0.000000000001;return value>=ref-epsilon&&value<=ref+epsilon;}void alongNormal(out vec2 offset,in vec2 nextP,in float turnDir,in float direction){vec2 dirVect=nextP-e;vec2 normal=normalize(vec2(-turnDir*dirVect.y,turnDir*dirVect.x));offset=k/2.0*normal*direction;}void miterUp(out vec2 offset,out float round,in bool isRound,in float direction){float halfWidth=k/2.0;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=f-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;round=0.0;if(isRound){round=1.0;}else if(miterLength>l+k){offset=halfWidth*tmpNormal*direction;}} bool miterDown(out vec2 offset,in vec4 projPos,in mat4 offsetMatrix,in float direction){bool degenerate=false;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=d-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));vec2 longOffset,shortOffset,longVertex;vec4 shortProjVertex;float halfWidth=k/2.0;if(length(f-e)>length(d-e)){longOffset=tmpNormal*direction*halfWidth;shortOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=f;shortProjVertex=h*vec4(d,0.0,1.0);}else{shortOffset=tmpNormal*direction*halfWidth;longOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=d;shortProjVertex=h*vec4(f,0.0,1.0);}vec4 p1=h*vec4(longVertex,0.0,1.0)+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p2=projPos+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p3=shortProjVertex+offsetMatrix*vec4(-shortOffset,0.0,0.0);vec4 p4=shortProjVertex+offsetMatrix*vec4(shortOffset,0.0,0.0);float denom=(p4.y-p3.y)*(p2.x-p1.x)-(p4.x-p3.x)*(p2.y-p1.y);float firstU=((p4.x-p3.x)*(p1.y-p3.y)-(p4.y-p3.y)*(p1.x-p3.x))/denom;float secondU=((p2.x-p1.x)*(p1.y-p3.y)-(p2.y-p1.y)*(p1.x-p3.x))/denom;float epsilon=0.000000000001;if(firstU>epsilon&&firstU<1.0-epsilon&&secondU>epsilon&&secondU<1.0-epsilon){shortProjVertex.x=p1.x+firstU*(p2.x-p1.x);shortProjVertex.y=p1.y+firstU*(p2.y-p1.y);offset=shortProjVertex.xy;degenerate=true;}else{float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;}return degenerate;}void squareCap(out vec2 offset,out float round,in bool isRound,in vec2 nextP,in float turnDir,in float direction){round=0.0;vec2 dirVect=e-nextP;vec2 firstNormal=normalize(dirVect);vec2 secondNormal=vec2(turnDir*firstNormal.y*direction,-turnDir*firstNormal.x*direction);vec2 hypotenuse=normalize(firstNormal-secondNormal);vec2 normal=vec2(turnDir*hypotenuse.y*direction,-turnDir*hypotenuse.x*direction);float length=sqrt(c*c*2.0);offset=normal*length;if(isRound){round=1.0;}} void main(void){bool degenerate=false;float direction=float(sign(g));mat4 offsetMatrix=i*j;vec2 offset;vec4 projPos=h*vec4(e,0.0,1.0);bool round=nearlyEquals(mod(g,2.0),0.0);a=0.0;c=k/2.0;b=projPos.xy;if(nearlyEquals(mod(g,3.0),0.0)||nearlyEquals(mod(g,17.0),0.0)){alongNormal(offset,f,1.0,direction);}else if(nearlyEquals(mod(g,5.0),0.0)||nearlyEquals(mod(g,13.0),0.0)){alongNormal(offset,d,-1.0,direction);}else if(nearlyEquals(mod(g,23.0),0.0)){miterUp(offset,a,round,direction);}else if(nearlyEquals(mod(g,19.0),0.0)){degenerate=miterDown(offset,projPos,offsetMatrix,direction);}else if(nearlyEquals(mod(g,7.0),0.0)){squareCap(offset,a,round,f,1.0,direction);}else if(nearlyEquals(mod(g,11.0),0.0)){squareCap(offset,a,round,d,-1.0,direction);}if(!degenerate){vec4 offsets=offsetMatrix*vec4(offset,0.0,0.0);gl_Position=projPos+offsets;}else{gl_Position=vec4(offset,0.0,1.0);}}";ol.render.webgl.linestringreplay.defaultshader.Vertex.SOURCE=ol.DEBUG_WEBGL?ol.render.webgl.linestringreplay.defaultshader.Vertex.DEBUG_SOURCE:ol.render.webgl.linestringreplay.defaultshader.Vertex.OPTIMIZED_SOURCE;ol.render.webgl.linestringreplay.defaultshader.vertex=new ol.render.webgl.linestringreplay.defaultshader.Vertex;ol.render.webgl.linestringreplay.defaultshader.Locations=function(e,t){this.u_color=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_color":"n");this.u_lineWidth=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_lineWidth":"k");this.u_miterLimit=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_miterLimit":"l");this.u_offsetRotateMatrix=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_offsetRotateMatrix":"j");this.u_offsetScaleMatrix=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_offsetScaleMatrix":"i");this.u_opacity=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_opacity":"m");this.u_pixelRatio=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_pixelRatio":"p");this.u_projectionMatrix=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_projectionMatrix":"h");this.u_size=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_size":"o");this.a_direction=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_direction":"g");this.a_lastPos=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_lastPos":"d");this.a_nextPos=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_nextPos":"f");this.a_position=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_position":"e")}}goog.provide("ol.render.webgl.LineStringReplay");goog.require("ol");goog.require("ol.array");goog.require("ol.color");goog.require("ol.extent");goog.require("ol.geom.flat.orient");goog.require("ol.geom.flat.transform");goog.require("ol.geom.flat.topology");goog.require("ol.obj");goog.require("ol.render.webgl");goog.require("ol.render.webgl.Replay");goog.require("ol.render.webgl.linestringreplay.defaultshader");goog.require("ol.webgl");goog.require("ol.webgl.Buffer");if(ol.ENABLE_WEBGL){ol.render.webgl.LineStringReplay=function(e,t){ol.render.webgl.Replay.call(this,e,t);this.defaultLocations_=null;this.styles_=[];this.styleIndices_=[];this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0,changed:!1}};ol.inherits(ol.render.webgl.LineStringReplay,ol.render.webgl.Replay);ol.render.webgl.LineStringReplay.prototype.drawCoordinates_=function(e,t,o,r){var i,n,a,l,s,p,c,u,g=this.vertices.length,d=this.indices.length,h="bevel"===this.state_.lineJoin?0:"miter"===this.state_.lineJoin?1:2,f="butt"===this.state_.lineCap?0:"square"===this.state_.lineCap?1:2,y=ol.geom.flat.topology.lineStringIsClosed(e,t,o,r),m=d,v=1;for(i=t,n=o;n>i;i+=r){s=g/7;p=c;c=u||[e[i],e[i+1]];if(i===t){u=[e[i+r],e[i+r+1]];if(o-t===2*r&&ol.array.equals(c,u))break;if(!y){if(f){g=this.addVertices_([0,0],c,u,v*ol.render.webgl.LineStringReplay.Instruction_.BEGIN_LINE_CAP*f,g);g=this.addVertices_([0,0],c,u,-v*ol.render.webgl.LineStringReplay.Instruction_.BEGIN_LINE_CAP*f,g);this.indices[d++]=s+2;this.indices[d++]=s;this.indices[d++]=s+1;this.indices[d++]=s+1;this.indices[d++]=s+3;this.indices[d++]=s+2}g=this.addVertices_([0,0],c,u,v*ol.render.webgl.LineStringReplay.Instruction_.BEGIN_LINE*(f||1),g);g=this.addVertices_([0,0],c,u,-v*ol.render.webgl.LineStringReplay.Instruction_.BEGIN_LINE*(f||1),g);m=g/7-1;continue}p=[e[o-2*r],e[o-2*r+1]];a=u}else{if(i===o-r){if(y){u=a;break}p=p||[0,0];g=this.addVertices_(p,c,[0,0],v*ol.render.webgl.LineStringReplay.Instruction_.END_LINE*(f||1),g);g=this.addVertices_(p,c,[0,0],-v*ol.render.webgl.LineStringReplay.Instruction_.END_LINE*(f||1),g);this.indices[d++]=s;this.indices[d++]=m-1;this.indices[d++]=m;this.indices[d++]=m;this.indices[d++]=s+1;this.indices[d++]=s;if(f){g=this.addVertices_(p,c,[0,0],v*ol.render.webgl.LineStringReplay.Instruction_.END_LINE_CAP*f,g);g=this.addVertices_(p,c,[0,0],-v*ol.render.webgl.LineStringReplay.Instruction_.END_LINE_CAP*f,g);this.indices[d++]=s+2;this.indices[d++]=s;this.indices[d++]=s+1;this.indices[d++]=s+1;this.indices[d++]=s+3;this.indices[d++]=s+2}break}u=[e[i+r],e[i+r+1]]}l=ol.render.webgl.triangleIsCounterClockwise(p[0],p[1],c[0],c[1],u[0],u[1])?-1:1;g=this.addVertices_(p,c,u,l*ol.render.webgl.LineStringReplay.Instruction_.BEVEL_FIRST*(h||1),g);g=this.addVertices_(p,c,u,l*ol.render.webgl.LineStringReplay.Instruction_.BEVEL_SECOND*(h||1),g);g=this.addVertices_(p,c,u,-l*ol.render.webgl.LineStringReplay.Instruction_.MITER_BOTTOM*(h||1),g);if(i>t){this.indices[d++]=s;this.indices[d++]=m-1;this.indices[d++]=m;this.indices[d++]=s+2;this.indices[d++]=s;this.indices[d++]=v*l>0?m:m-1}this.indices[d++]=s;this.indices[d++]=s+2;this.indices[d++]=s+1;m=s+2;v=l;if(h){g=this.addVertices_(p,c,u,l*ol.render.webgl.LineStringReplay.Instruction_.MITER_TOP*h,g);this.indices[d++]=s+1;this.indices[d++]=s+3;this.indices[d++]=s}}if(y){s=s||g/7;l=ol.geom.flat.orient.linearRingIsClockwise([p[0],p[1],c[0],c[1],u[0],u[1]],0,6,2)?1:-1;g=this.addVertices_(p,c,u,l*ol.render.webgl.LineStringReplay.Instruction_.BEVEL_FIRST*(h||1),g);g=this.addVertices_(p,c,u,-l*ol.render.webgl.LineStringReplay.Instruction_.MITER_BOTTOM*(h||1),g);this.indices[d++]=s;this.indices[d++]=m-1;this.indices[d++]=m;this.indices[d++]=s+1;this.indices[d++]=s;this.indices[d++]=v*l>0?m:m-1}};ol.render.webgl.LineStringReplay.prototype.addVertices_=function(e,t,o,r,i){this.vertices[i++]=e[0];this.vertices[i++]=e[1];this.vertices[i++]=t[0];this.vertices[i++]=t[1];this.vertices[i++]=o[0];this.vertices[i++]=o[1];this.vertices[i++]=r;return i};ol.render.webgl.LineStringReplay.prototype.isValid_=function(e,t,o,r){var i=o-t;if(2*r>i)return!1;if(i===2*r){var n=[e[t],e[t+1]],a=[e[t+r],e[t+r+1]];return!ol.array.equals(n,a)}return!0};ol.render.webgl.LineStringReplay.prototype.drawLineString=function(e,t){var o=e.getFlatCoordinates(),r=e.getStride();if(this.isValid_(o,0,o.length,r)){o=ol.geom.flat.transform.translate(o,0,o.length,r,-this.origin[0],-this.origin[1]);if(this.state_.changed){this.styleIndices_.push(this.indices.length);this.state_.changed=!1}this.startIndices.push(this.indices.length);this.startIndicesFeature.push(t);this.drawCoordinates_(o,0,o.length,r)}};ol.render.webgl.LineStringReplay.prototype.drawMultiLineString=function(e,t){var o,r,i=this.indices.length,n=e.getLineStrings();for(o=0,r=n.length;r>o;++o){var a=n[o].getFlatCoordinates(),l=n[o].getStride();if(this.isValid_(a,0,a.length,l)){a=ol.geom.flat.transform.translate(a,0,a.length,l,-this.origin[0],-this.origin[1]);this.drawCoordinates_(a,0,a.length,l)}}if(this.indices.length>i){this.startIndices.push(i);this.startIndicesFeature.push(t);if(this.state_.changed){this.styleIndices_.push(i);this.state_.changed=!1}}};ol.render.webgl.LineStringReplay.prototype.drawPolygonCoordinates=function(e,t,o){if(!ol.geom.flat.topology.lineStringIsClosed(e,0,e.length,o)){e.push(e[0]);e.push(e[1])}this.drawCoordinates_(e,0,e.length,o);if(t.length){var r,i;for(r=0,i=t.length;i>r;++r){if(!ol.geom.flat.topology.lineStringIsClosed(t[r],0,t[r].length,o)){t[r].push(t[r][0]);t[r].push(t[r][1])}this.drawCoordinates_(t[r],0,t[r].length,o)}}};ol.render.webgl.LineStringReplay.prototype.setPolygonStyle=function(e,t){var o=void 0===t?this.indices.length:t;this.startIndices.push(o);this.startIndicesFeature.push(e);if(this.state_.changed){this.styleIndices_.push(o);this.state_.changed=!1}};ol.render.webgl.LineStringReplay.prototype.getCurrentIndex=function(){return this.indices.length};ol.render.webgl.LineStringReplay.prototype.finish=function(e){this.verticesBuffer=new ol.webgl.Buffer(this.vertices);this.indicesBuffer=new ol.webgl.Buffer(this.indices);this.startIndices.push(this.indices.length);0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]);this.vertices=null;this.indices=null};ol.render.webgl.LineStringReplay.prototype.getDeleteResourcesFunction=function(e){var t=this.verticesBuffer,o=this.indicesBuffer;return function(){e.deleteBuffer(t);e.deleteBuffer(o)}};ol.render.webgl.LineStringReplay.prototype.setUpProgram=function(e,t,o,r){var i,n;i=ol.render.webgl.linestringreplay.defaultshader.fragment;n=ol.render.webgl.linestringreplay.defaultshader.vertex;var a,l=t.getProgram(i,n);if(this.defaultLocations_)a=this.defaultLocations_;else{a=new ol.render.webgl.linestringreplay.defaultshader.Locations(e,l);this.defaultLocations_=a}t.useProgram(l);e.enableVertexAttribArray(a.a_lastPos);e.vertexAttribPointer(a.a_lastPos,2,ol.webgl.FLOAT,!1,28,0);e.enableVertexAttribArray(a.a_position);e.vertexAttribPointer(a.a_position,2,ol.webgl.FLOAT,!1,28,8);e.enableVertexAttribArray(a.a_nextPos);e.vertexAttribPointer(a.a_nextPos,2,ol.webgl.FLOAT,!1,28,16);e.enableVertexAttribArray(a.a_direction);e.vertexAttribPointer(a.a_direction,1,ol.webgl.FLOAT,!1,28,24);e.uniform2fv(a.u_size,o);e.uniform1f(a.u_pixelRatio,r);return a};ol.render.webgl.LineStringReplay.prototype.shutDownProgram=function(e,t){e.disableVertexAttribArray(t.a_lastPos);e.disableVertexAttribArray(t.a_position);e.disableVertexAttribArray(t.a_nextPos);e.disableVertexAttribArray(t.a_direction)};ol.render.webgl.LineStringReplay.prototype.drawReplay=function(e,t,o,r){var i=e.getParameter(e.DEPTH_FUNC),n=e.getParameter(e.DEPTH_WRITEMASK);if(!r){e.enable(e.DEPTH_TEST);e.depthMask(!0);e.depthFunc(e.NOTEQUAL)}if(ol.obj.isEmpty(o)){var a,l,s,p;s=this.startIndices[this.startIndices.length-1];for(a=this.styleIndices_.length-1;a>=0;--a){l=this.styleIndices_[a];p=this.styles_[a];this.setStrokeStyle_(e,p[0],p[1],p[2]);this.drawElements(e,t,l,s);e.clear(e.DEPTH_BUFFER_BIT);s=l}}else this.drawReplaySkipping_(e,t,o);if(!r){e.disable(e.DEPTH_TEST);e.clear(e.DEPTH_BUFFER_BIT);e.depthMask(n);e.depthFunc(i)}};ol.render.webgl.LineStringReplay.prototype.drawReplaySkipping_=function(e,t,o){var r,i,n,a,l,s,p,c,u;c=this.startIndices.length-2;n=i=this.startIndices[c+1];for(r=this.styleIndices_.length-1;r>=0;--r){a=this.styles_[r];this.setStrokeStyle_(e,a[0],a[1],a[2]);l=this.styleIndices_[r];for(;c>=0&&this.startIndices[c]>=l;){u=this.startIndices[c];s=this.startIndicesFeature[c];p=ol.getUid(s).toString();if(o[p]){if(i!==n){this.drawElements(e,t,i,n);e.clear(e.DEPTH_BUFFER_BIT)}n=u}c--;i=u}if(i!==n){this.drawElements(e,t,i,n);e.clear(e.DEPTH_BUFFER_BIT)}i=n=l}};ol.render.webgl.LineStringReplay.prototype.drawHitDetectionReplayOneByOne=function(e,t,o,r,i){var n,a,l,s,p,c,u,g;g=this.startIndices.length-2;l=this.startIndices[g+1];for(n=this.styleIndices_.length-1;n>=0;--n){s=this.styles_[n];this.setStrokeStyle_(e,s[0],s[1],s[2]);p=this.styleIndices_[n];for(;g>=0&&this.startIndices[g]>=p;){a=this.startIndices[g];c=this.startIndicesFeature[g];u=ol.getUid(c).toString();if(void 0===o[u]&&c.getGeometry()&&(void 0===i||ol.extent.intersects(i,c.getGeometry().getExtent()))){e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);this.drawElements(e,t,a,l);var d=r(c);if(d)return d}g--;l=a}}return void 0};ol.render.webgl.LineStringReplay.prototype.setStrokeStyle_=function(e,t,o,r){e.uniform4fv(this.defaultLocations_.u_color,t);e.uniform1f(this.defaultLocations_.u_lineWidth,o);e.uniform1f(this.defaultLocations_.u_miterLimit,r)};ol.render.webgl.LineStringReplay.prototype.setFillStrokeStyle=function(e,t){var o=t.getLineCap();this.state_.lineCap=void 0!==o?o:ol.render.webgl.defaultLineCap;var r=t.getLineDash();this.state_.lineDash=r?r:ol.render.webgl.defaultLineDash;var i=t.getLineDashOffset();this.state_.lineDashOffset=i?i:ol.render.webgl.defaultLineDashOffset;var n=t.getLineJoin();this.state_.lineJoin=void 0!==n?n:ol.render.webgl.defaultLineJoin;var a=t.getColor();a=a instanceof CanvasGradient||a instanceof CanvasPattern?ol.render.webgl.defaultStrokeStyle:ol.color.asArray(a).map(function(e,t){return 3!=t?e/255:e})||ol.render.webgl.defaultStrokeStyle;var l=t.getWidth();l=void 0!==l?l:ol.render.webgl.defaultLineWidth;var s=t.getMiterLimit();s=void 0!==s?s:ol.render.webgl.defaultMiterLimit;if(!this.state_.strokeColor||!ol.array.equals(this.state_.strokeColor,a)||this.state_.lineWidth!==l||this.state_.miterLimit!==s){this.state_.changed=!0;this.state_.strokeColor=a;this.state_.lineWidth=l;this.state_.miterLimit=s;this.styles_.push([a,l,s])}};ol.render.webgl.LineStringReplay.Instruction_={ROUND:2,BEGIN_LINE:3,END_LINE:5,BEGIN_LINE_CAP:7,END_LINE_CAP:11,BEVEL_FIRST:13,BEVEL_SECOND:17,MITER_BOTTOM:19,MITER_TOP:23}}goog.provide("ol.render.webgl.polygonreplay.defaultshader");goog.require("ol");goog.require("ol.webgl.Fragment");goog.require("ol.webgl.Vertex");if(ol.ENABLE_WEBGL){ol.render.webgl.polygonreplay.defaultshader.Fragment=function(){ol.webgl.Fragment.call(this,ol.render.webgl.polygonreplay.defaultshader.Fragment.SOURCE)};ol.inherits(ol.render.webgl.polygonreplay.defaultshader.Fragment,ol.webgl.Fragment);ol.render.webgl.polygonreplay.defaultshader.Fragment.DEBUG_SOURCE="precision mediump float;\n\n\n\nuniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main(void) {\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n";ol.render.webgl.polygonreplay.defaultshader.Fragment.OPTIMIZED_SOURCE="precision mediump float;uniform vec4 e;uniform float f;void main(void){gl_FragColor=e;float alpha=e.a*f;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}";ol.render.webgl.polygonreplay.defaultshader.Fragment.SOURCE=ol.DEBUG_WEBGL?ol.render.webgl.polygonreplay.defaultshader.Fragment.DEBUG_SOURCE:ol.render.webgl.polygonreplay.defaultshader.Fragment.OPTIMIZED_SOURCE;ol.render.webgl.polygonreplay.defaultshader.fragment=new ol.render.webgl.polygonreplay.defaultshader.Fragment;ol.render.webgl.polygonreplay.defaultshader.Vertex=function(){ol.webgl.Vertex.call(this,ol.render.webgl.polygonreplay.defaultshader.Vertex.SOURCE)};ol.inherits(ol.render.webgl.polygonreplay.defaultshader.Vertex,ol.webgl.Vertex);ol.render.webgl.polygonreplay.defaultshader.Vertex.DEBUG_SOURCE="\n\nattribute vec2 a_position;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n}\n\n\n";ol.render.webgl.polygonreplay.defaultshader.Vertex.OPTIMIZED_SOURCE="attribute vec2 a;uniform mat4 b;uniform mat4 c;uniform mat4 d;void main(void){gl_Position=b*vec4(a,0.0,1.0);}";ol.render.webgl.polygonreplay.defaultshader.Vertex.SOURCE=ol.DEBUG_WEBGL?ol.render.webgl.polygonreplay.defaultshader.Vertex.DEBUG_SOURCE:ol.render.webgl.polygonreplay.defaultshader.Vertex.OPTIMIZED_SOURCE;ol.render.webgl.polygonreplay.defaultshader.vertex=new ol.render.webgl.polygonreplay.defaultshader.Vertex;ol.render.webgl.polygonreplay.defaultshader.Locations=function(e,t){this.u_color=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_color":"e");this.u_offsetRotateMatrix=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_offsetRotateMatrix":"d");this.u_offsetScaleMatrix=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_offsetScaleMatrix":"c");this.u_opacity=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_opacity":"f");this.u_projectionMatrix=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_projectionMatrix":"b");this.a_position=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_position":"a")}}goog.provide("ol.style.Stroke");goog.require("ol");ol.style.Stroke=function(e){var t=e||{};this.color_=void 0!==t.color?t.color:null;this.lineCap_=t.lineCap;this.lineDash_=void 0!==t.lineDash?t.lineDash:null;this.lineDashOffset_=t.lineDashOffset;this.lineJoin_=t.lineJoin;this.miterLimit_=t.miterLimit;this.width_=t.width;this.checksum_=void 0};ol.style.Stroke.prototype.clone=function(){var e=this.getColor();return new ol.style.Stroke({color:e&&e.slice?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})};ol.style.Stroke.prototype.getColor=function(){return this.color_};ol.style.Stroke.prototype.getLineCap=function(){return this.lineCap_};ol.style.Stroke.prototype.getLineDash=function(){return this.lineDash_};ol.style.Stroke.prototype.getLineDashOffset=function(){return this.lineDashOffset_};ol.style.Stroke.prototype.getLineJoin=function(){return this.lineJoin_};ol.style.Stroke.prototype.getMiterLimit=function(){return this.miterLimit_};ol.style.Stroke.prototype.getWidth=function(){return this.width_};ol.style.Stroke.prototype.setColor=function(e){this.color_=e;this.checksum_=void 0};ol.style.Stroke.prototype.setLineCap=function(e){this.lineCap_=e;this.checksum_=void 0};ol.style.Stroke.prototype.setLineDash=function(e){this.lineDash_=e;this.checksum_=void 0};ol.style.Stroke.prototype.setLineDashOffset=function(e){this.lineDashOffset_=e;this.checksum_=void 0};ol.style.Stroke.prototype.setLineJoin=function(e){this.lineJoin_=e;this.checksum_=void 0};ol.style.Stroke.prototype.setMiterLimit=function(e){this.miterLimit_=e;this.checksum_=void 0};ol.style.Stroke.prototype.setWidth=function(e){this.width_=e;this.checksum_=void 0};ol.style.Stroke.prototype.getChecksum=function(){if(void 0===this.checksum_){this.checksum_="s";this.checksum_+=this.color_?"string"==typeof this.color_?this.color_:ol.getUid(this.color_).toString():"-";this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")}return this.checksum_};goog.provide("ol.structs.LinkedList");ol.structs.LinkedList=function(e){this.first_=void 0;this.last_=void 0;this.head_=void 0;this.circular_=void 0===e?!0:e;this.length_=0};ol.structs.LinkedList.prototype.insertItem=function(e){var t={prev:void 0,next:void 0,data:e},o=this.head_;if(o){var r=o.next;t.prev=o;t.next=r;o.next=t;r&&(r.prev=t);o===this.last_&&(this.last_=t)}else{this.first_=t;this.last_=t;if(this.circular_){t.next=t;t.prev=t}}this.head_=t;this.length_++};ol.structs.LinkedList.prototype.removeItem=function(){var e=this.head_;if(e){var t=e.next,o=e.prev;t&&(t.prev=o);o&&(o.next=t);this.head_=t||o;if(this.first_===this.last_){this.head_=void 0;this.first_=void 0;this.last_=void 0}else this.first_===e?this.first_=this.head_:this.last_===e&&(this.last_=o?this.head_.prev:this.head_);this.length_--}};ol.structs.LinkedList.prototype.firstItem=function(){this.head_=this.first_;return this.head_?this.head_.data:void 0};ol.structs.LinkedList.prototype.lastItem=function(){this.head_=this.last_;return this.head_?this.head_.data:void 0};ol.structs.LinkedList.prototype.nextItem=function(){if(this.head_&&this.head_.next){this.head_=this.head_.next;return this.head_.data}return void 0};ol.structs.LinkedList.prototype.getNextItem=function(){return this.head_&&this.head_.next?this.head_.next.data:void 0};ol.structs.LinkedList.prototype.prevItem=function(){if(this.head_&&this.head_.prev){this.head_=this.head_.prev;return this.head_.data}return void 0};ol.structs.LinkedList.prototype.getPrevItem=function(){return this.head_&&this.head_.prev?this.head_.prev.data:void 0};ol.structs.LinkedList.prototype.getCurrItem=function(){return this.head_?this.head_.data:void 0};ol.structs.LinkedList.prototype.setFirstItem=function(){if(this.circular_&&this.head_){this.first_=this.head_;this.last_=this.head_.prev}};ol.structs.LinkedList.prototype.concat=function(e){if(e.head_){if(this.head_){var t=this.head_.next;this.head_.next=e.first_;e.first_.prev=this.head_;t.prev=e.last_;e.last_.next=t;this.length_+=e.length_}else{this.head_=e.head_;this.first_=e.first_;this.last_=e.last_;this.length_=e.length_}e.head_=void 0;e.first_=void 0;e.last_=void 0;e.length_=0}};ol.structs.LinkedList.prototype.getLength=function(){return this.length_};goog.provide("ol.ext.rbush");ol.ext.rbush;!function(){var e,t={},o={exports:t};!function(r){if("object"==typeof t&&"undefined"!=typeof o)o.exports=r();else if("function"==typeof e&&e.amd)e([],r);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this;i.rbush=r()}}(function(){return function e(t,o,r){function i(a,l){if(!o[a]){if(!t[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(n)return n(a,!0);var p=new Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var c=o[a]={exports:{}};t[a][0].call(c.exports,function(e){var o=t[a][1][e];return i(o?o:e)},c,c.exports,e,t,o,r)}return o[a].exports}for(var n="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,o){"use strict";function r(e,t,o,a,l){o=o||0;a=a||e.length-1;l=l||n;for(;a>o;){if(a-o>600){var s=a-o+1,p=t-o+1,c=Math.log(s),u=.5*Math.exp(2*c/3),g=.5*Math.sqrt(c*u*(s-u)/s)*(0>p-s/2?-1:1),d=Math.max(o,Math.floor(t-p*u/s+g)),h=Math.min(a,Math.floor(t+(s-p)*u/s+g));r(e,t,d,h,l)}var f=e[t],y=o,m=a;i(e,o,t);l(e[a],f)>0&&i(e,o,a);for(;m>y;){i(e,y,m);y++;m--;for(;l(e[y],f)<0;)y++;for(;l(e[m],f)>0;)m--}if(0===l(e[o],f))i(e,o,m);else{m++;i(e,m,a)}t>=m&&(o=m+1);m>=t&&(a=m-1)}}function i(e,t,o){var r=e[t];e[t]=e[o];e[o]=r}function n(e,t){return t>e?-1:e>t?1:0}t.exports=r},{}],2:[function(e,t,o){"use strict";function r(e,t){if(!(this instanceof r))return new r(e,t);this._maxEntries=Math.max(4,e||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));t&&this._initFormat(t);this.clear()}function i(e,t,o){if(!o)return t.indexOf(e);for(var r=0;r<t.length;r++)if(o(e,t[r]))return r;return-1}function n(e,t){a(e,0,e.children.length,t,e)}function a(e,t,o,r,i){i||(i=y(null));i.minX=1/0;i.minY=1/0;i.maxX=-(1/0);i.maxY=-(1/0);for(var n,a=t;o>a;a++){n=e.children[a];l(i,e.leaf?r(n):n)}return i}function l(e,t){e.minX=Math.min(e.minX,t.minX);e.minY=Math.min(e.minY,t.minY);e.maxX=Math.max(e.maxX,t.maxX);e.maxY=Math.max(e.maxY,t.maxY);return e}function s(e,t){return e.minX-t.minX}function p(e,t){return e.minY-t.minY}function c(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function u(e){return e.maxX-e.minX+(e.maxY-e.minY)}function g(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function d(e,t){var o=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),n=Math.min(e.maxY,t.maxY);return Math.max(0,i-o)*Math.max(0,n-r)}function h(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function f(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function y(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-(1/0),maxY:-(1/0)}}function m(e,t,o,r,i){for(var n,a=[t,o];a.length;){o=a.pop();t=a.pop();if(!(r>=o-t)){n=t+Math.ceil((o-t)/r/2)*r;v(e,n,t,o,i);a.push(t,n,n,o)}}}t.exports=r;var v=e("quickselect");r.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,o=[],r=this.toBBox;if(!f(e,t))return o;for(var i,n,a,l,s=[];t;){for(i=0,n=t.children.length;n>i;i++){a=t.children[i];l=t.leaf?r(a):a;f(e,l)&&(t.leaf?o.push(a):h(e,l)?this._all(a,o):s.push(a))}t=s.pop()}return o},collides:function(e){var t=this.data,o=this.toBBox;if(!f(e,t))return!1;for(var r,i,n,a,l=[];t;){for(r=0,i=t.children.length;i>r;r++){n=t.children[r];a=t.leaf?o(n):n;if(f(e,a)){if(t.leaf||h(e,a))return!0;l.push(n)}}t=l.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,o=e.length;o>t;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r;r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(e){e&&this._insert(e,this.data.height-1);return this},clear:function(){this.data=y([]);return this},remove:function(e,t){if(!e)return this;for(var o,r,n,a,l=this.data,s=this.toBBox(e),p=[],c=[];l||p.length;){if(!l){l=p.pop();r=p[p.length-1];o=c.pop();a=!0}if(l.leaf){n=i(e,l.children,t);if(-1!==n){l.children.splice(n,1);p.push(l);this._condense(p);return this}}if(a||l.leaf||!h(l,s))if(r){o++;l=r.children[o];a=!1}else l=null;else{p.push(l);c.push(o);o=0;r=l;l=l.children[0]}}return this},toBBox:function(e){return e},compareMinX:s,compareMinY:p,toJSON:function(){return this.data},fromJSON:function(e){this.data=e;return this},_all:function(e,t){for(var o=[];e;){e.leaf?t.push.apply(t,e.children):o.push.apply(o,e.children);e=o.pop()}return t},_build:function(e,t,o,r){var i,a=o-t+1,l=this._maxEntries;if(l>=a){i=y(e.slice(t,o+1));n(i,this.toBBox);return i}if(!r){r=Math.ceil(Math.log(a)/Math.log(l));l=Math.ceil(a/Math.pow(l,r-1))}i=y([]);i.leaf=!1;i.height=r;var s,p,c,u,g=Math.ceil(a/l),d=g*Math.ceil(Math.sqrt(l));m(e,t,o,d,this.compareMinX);for(s=t;o>=s;s+=d){c=Math.min(s+d-1,o);m(e,s,c,g,this.compareMinY);for(p=s;c>=p;p+=g){u=Math.min(p+g-1,c);i.children.push(this._build(e,p,u,r-1))}}n(i,this.toBBox);return i},_chooseSubtree:function(e,t,o,r){for(var i,n,a,l,s,p,u,d;;){r.push(t);if(t.leaf||r.length-1===o)break;u=d=1/0;for(i=0,n=t.children.length;n>i;i++){a=t.children[i];s=c(a);p=g(e,a)-s;if(d>p){d=p;u=u>s?s:u;l=a}else if(p===d&&u>s){u=s;l=a}}t=l||t.children[0]}return t},_insert:function(e,t,o){var r=this.toBBox,i=o?e:r(e),n=[],a=this._chooseSubtree(i,this.data,t,n);a.children.push(e);l(a,i);for(;t>=0&&n[t].children.length>this._maxEntries;){this._split(n,t);t--}this._adjustParentBBoxes(i,n,t)},_split:function(e,t){var o=e[t],r=o.children.length,i=this._minEntries;this._chooseSplitAxis(o,i,r);var a=this._chooseSplitIndex(o,i,r),l=y(o.children.splice(a,o.children.length-a));l.height=o.height;l.leaf=o.leaf;n(o,this.toBBox);n(l,this.toBBox);t?e[t-1].children.push(l):this._splitRoot(o,l)},_splitRoot:function(e,t){this.data=y([e,t]);this.data.height=e.height+1;this.data.leaf=!1;n(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,o){var r,i,n,l,s,p,u,g;p=u=1/0;for(r=t;o-t>=r;r++){i=a(e,0,r,this.toBBox);n=a(e,r,o,this.toBBox);l=d(i,n);s=c(i)+c(n);if(p>l){p=l;g=r;u=u>s?s:u}else if(l===p&&u>s){u=s;g=r}}return g},_chooseSplitAxis:function(e,t,o){var r=e.leaf?this.compareMinX:s,i=e.leaf?this.compareMinY:p,n=this._allDistMargin(e,t,o,r),a=this._allDistMargin(e,t,o,i);a>n&&e.children.sort(r)},_allDistMargin:function(e,t,o,r){e.children.sort(r);var i,n,s=this.toBBox,p=a(e,0,t,s),c=a(e,o-t,o,s),g=u(p)+u(c);for(i=t;o-t>i;i++){n=e.children[i];l(p,e.leaf?s(n):n);g+=u(p)}for(i=o-t-1;i>=t;i--){n=e.children[i];l(c,e.leaf?s(n):n);g+=u(c)}return g},_adjustParentBBoxes:function(e,t,o){for(var r=o;r>=0;r--)l(t[r],e)},_condense:function(e){for(var t,o=e.length-1;o>=0;o--)if(0===e[o].children.length)if(o>0){t=e[o-1].children;t.splice(t.indexOf(e[o]),1)}else this.clear();else n(e[o],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0]));this.compareMinY=new Function("a","b",t.join(e[1]));this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}},{quickselect:1}]},{},[2])(2)});ol.ext.rbush=o.exports}();goog.provide("ol.structs.RBush");goog.require("ol");goog.require("ol.ext.rbush");goog.require("ol.extent");goog.require("ol.obj");ol.structs.RBush=function(e){this.rbush_=ol.ext.rbush(e);this.items_={}};ol.structs.RBush.prototype.insert=function(e,t){var o={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(o);this.items_[ol.getUid(t)]=o};ol.structs.RBush.prototype.load=function(e,t){for(var o=new Array(t.length),r=0,i=t.length;i>r;r++){var n=e[r],a=t[r],l={minX:n[0],minY:n[1],maxX:n[2],maxY:n[3],value:a};o[r]=l;this.items_[ol.getUid(a)]=l}this.rbush_.load(o)};ol.structs.RBush.prototype.remove=function(e){var t=ol.getUid(e),o=this.items_[t];delete this.items_[t];return null!==this.rbush_.remove(o)};ol.structs.RBush.prototype.update=function(e,t){var o=this.items_[ol.getUid(t)],r=[o.minX,o.minY,o.maxX,o.maxY];if(!ol.extent.equals(r,e)){this.remove(t);this.insert(e,t)}};ol.structs.RBush.prototype.getAll=function(){var e=this.rbush_.all();return e.map(function(e){return e.value})};ol.structs.RBush.prototype.getInExtent=function(e){var t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]},o=this.rbush_.search(t);return o.map(function(e){return e.value})};ol.structs.RBush.prototype.forEach=function(e,t){
return this.forEach_(this.getAll(),e,t)};ol.structs.RBush.prototype.forEachInExtent=function(e,t,o){return this.forEach_(this.getInExtent(e),t,o)};ol.structs.RBush.prototype.forEach_=function(e,t,o){for(var r,i=0,n=e.length;n>i;i++){r=t.call(o,e[i]);if(r)return r}return r};ol.structs.RBush.prototype.isEmpty=function(){return ol.obj.isEmpty(this.items_)};ol.structs.RBush.prototype.clear=function(){this.rbush_.clear();this.items_={}};ol.structs.RBush.prototype.getExtent=function(e){var t=this.rbush_.data;return ol.extent.createOrUpdate(t.minX,t.minY,t.maxX,t.maxY,e)};goog.provide("ol.render.webgl.PolygonReplay");goog.require("ol");goog.require("ol.array");goog.require("ol.color");goog.require("ol.extent");goog.require("ol.obj");goog.require("ol.geom.flat.contains");goog.require("ol.geom.flat.orient");goog.require("ol.geom.flat.transform");goog.require("ol.render.webgl.polygonreplay.defaultshader");goog.require("ol.render.webgl.LineStringReplay");goog.require("ol.render.webgl.Replay");goog.require("ol.render.webgl");goog.require("ol.style.Stroke");goog.require("ol.structs.LinkedList");goog.require("ol.structs.RBush");goog.require("ol.webgl");goog.require("ol.webgl.Buffer");if(ol.ENABLE_WEBGL){ol.render.webgl.PolygonReplay=function(e,t){ol.render.webgl.Replay.call(this,e,t);this.lineStringReplay=new ol.render.webgl.LineStringReplay(e,t);this.defaultLocations_=null;this.styles_=[];this.styleIndices_=[];this.state_={fillColor:null,changed:!1}};ol.inherits(ol.render.webgl.PolygonReplay,ol.render.webgl.Replay);ol.render.webgl.PolygonReplay.prototype.drawCoordinates_=function(e,t,o){var r=new ol.structs.LinkedList,i=new ol.structs.RBush,n=this.processFlatCoordinates_(e,o,r,i,!0);if(t.length){var a,l,s=[];for(a=0,l=t.length;l>a;++a){var p={list:new ol.structs.LinkedList,maxX:void 0};s.push(p);p.maxX=this.processFlatCoordinates_(t[a],o,p.list,i,!1)}s.sort(function(e,t){return t.maxX-e.maxX});for(a=0;a<s.length;++a)this.bridgeHole_(s[a].list,s[a].maxX,r,n,i)}this.classifyPoints_(r,i,!1);this.triangulate_(r,i)};ol.render.webgl.PolygonReplay.prototype.processFlatCoordinates_=function(e,t,o,r,i){var n,a,l,s,p,c,u=ol.geom.flat.orient.linearRingIsClockwise(e,0,e.length,t),g=this.vertices.length/2,d=[],h=[];if(i===u){s=this.createPoint_(e[0],e[1],g++);p=s;l=e[0];for(n=t,a=e.length;a>n;n+=t){c=this.createPoint_(e[n],e[n+1],g++);h.push(this.insertItem_(p,c,o));d.push([Math.min(p.x,c.x),Math.min(p.y,c.y),Math.max(p.x,c.x),Math.max(p.y,c.y)]);l=e[n]>l?e[n]:l;p=c}h.push(this.insertItem_(c,s,o));d.push([Math.min(p.x,c.x),Math.min(p.y,c.y),Math.max(p.x,c.x),Math.max(p.y,c.y)])}else{var f=e.length-t;s=this.createPoint_(e[f],e[f+1],g++);p=s;l=e[f];for(n=f-t,a=0;n>=a;n-=t){c=this.createPoint_(e[n],e[n+1],g++);h.push(this.insertItem_(p,c,o));d.push([Math.min(p.x,c.x),Math.min(p.y,c.y),Math.max(p.x,c.x),Math.max(p.y,c.y)]);l=e[n]>l?e[n]:l;p=c}h.push(this.insertItem_(c,s,o));d.push([Math.min(p.x,c.x),Math.min(p.y,c.y),Math.max(p.x,c.x),Math.max(p.y,c.y)])}r.load(d,h);return l};ol.render.webgl.PolygonReplay.prototype.classifyPoints_=function(e,t,o){var r=e.firstItem(),i=r,n=e.nextItem(),a=!1;do{var l=o?ol.render.webgl.triangleIsCounterClockwise(n.p1.x,n.p1.y,i.p1.x,i.p1.y,i.p0.x,i.p0.y):ol.render.webgl.triangleIsCounterClockwise(i.p0.x,i.p0.y,i.p1.x,i.p1.y,n.p1.x,n.p1.y);if(void 0===l){this.removeItem_(i,n,e,t);a=!0;n===r&&(r=e.getNextItem());n=i;e.prevItem()}else if(i.p1.reflex!==l){i.p1.reflex=l;a=!0}i=n;n=e.nextItem()}while(i!==r);return a};ol.render.webgl.PolygonReplay.prototype.bridgeHole_=function(e,t,o,r,i){this.classifyPoints_(e,i,!0);for(var n=e.firstItem();n.p1.x!==t;)n=e.nextItem();var a,l,s,p,c=n.p1,u={x:r,y:c.y,i:-1},g=1/0,d=this.getIntersections_({p0:c,p1:u},i,!0);for(a=0,l=d.length;l>a;++a){var h=d[a];if(void 0===h.p0.reflex){var f=this.calculateIntersection_(c,u,h.p0,h.p1,!0),y=Math.abs(c.x-f[0]);if(g>y){g=y;p={x:f[0],y:f[1],i:-1};n=h}}}if(g!==1/0){s=n.p1;if(g>0){var m=this.getPointsInTriangle_(c,p,n.p1,i);if(m.length){var v=1/0;for(a=0,l=m.length;l>a;++a){var C=m[a],T=Math.atan2(c.y-C.y,u.x-C.x);if(v>T||T===v&&C.x<s.x){v=T;s=C}}}}n=o.firstItem();for(;n.p1!==s;)n=o.nextItem();var _={x:c.x,y:c.y,i:c.i,reflex:void 0},S={x:n.p1.x,y:n.p1.y,i:n.p1.i,reflex:void 0};e.getNextItem().p0=_;this.insertItem_(c,n.p1,e,i);this.insertItem_(S,_,e,i);n.p1=S;e.setFirstItem();o.concat(e)}};ol.render.webgl.PolygonReplay.prototype.triangulate_=function(e,t){for(var o=!1,r=this.isSimple_(e,t);e.getLength()>3;)if(r){if(!this.clipEars_(e,t,r,o)&&!this.classifyPoints_(e,t,o)&&!this.resolveLocalSelfIntersections_(e,t,!0))break}else if(!this.clipEars_(e,t,r,o)&&!this.classifyPoints_(e,t,o)&&!this.resolveLocalSelfIntersections_(e,t)){r=this.isSimple_(e,t);if(!r){this.splitPolygon_(e,t);break}o=!this.isClockwise_(e);this.classifyPoints_(e,t,o)}if(3===e.getLength()){var i=this.indices.length;this.indices[i++]=e.getPrevItem().p0.i;this.indices[i++]=e.getCurrItem().p0.i;this.indices[i++]=e.getNextItem().p0.i}};ol.render.webgl.PolygonReplay.prototype.clipEars_=function(e,t,o,r){var i,n,a,l=this.indices.length,s=e.firstItem(),p=e.getPrevItem(),c=s,u=e.nextItem(),g=e.getNextItem(),d=!1;do{i=c.p0;n=c.p1;a=u.p1;if(n.reflex===!1){var h=r?this.diagonalIsInside_(g.p1,a,n,i,p.p0):this.diagonalIsInside_(p.p0,i,n,a,g.p1);if((o||0===this.getIntersections_({p0:i,p1:a},t).length)&&h&&0===this.getPointsInTriangle_(i,n,a,t,!0).length&&(o||i.reflex===!1||a.reflex===!1||ol.geom.flat.orient.linearRingIsClockwise([p.p0.x,p.p0.y,i.x,i.y,n.x,n.y,a.x,a.y,g.p1.x,g.p1.y],0,10,2)===!r)){this.indices[l++]=i.i;this.indices[l++]=n.i;this.indices[l++]=a.i;this.removeItem_(c,u,e,t);u===s&&(s=g);d=!0}}p=e.getPrevItem();c=e.getCurrItem();u=e.nextItem();g=e.getNextItem()}while(c!==s&&e.getLength()>3);return d};ol.render.webgl.PolygonReplay.prototype.resolveLocalSelfIntersections_=function(e,t,o){var r=e.firstItem();e.nextItem();var i=r,n=e.nextItem(),a=!1;do{var l=this.calculateIntersection_(i.p0,i.p1,n.p0,n.p1,o);if(l){var s=!1,p=this.vertices.length,c=this.indices.length,u=p/2,g=e.prevItem();e.removeItem();t.remove(g);s=g===r;var d;if(o){if(l[0]===i.p0.x&&l[1]===i.p0.y){e.prevItem();d=i.p0;n.p0=d;t.remove(i);s=s||i===r}else{d=n.p1;i.p1=d;t.remove(n);s=s||n===r}e.removeItem()}else{d=this.createPoint_(l[0],l[1],u);i.p1=d;n.p0=d;t.update([Math.min(i.p0.x,i.p1.x),Math.min(i.p0.y,i.p1.y),Math.max(i.p0.x,i.p1.x),Math.max(i.p0.y,i.p1.y)],i);t.update([Math.min(n.p0.x,n.p1.x),Math.min(n.p0.y,n.p1.y),Math.max(n.p0.x,n.p1.x),Math.max(n.p0.y,n.p1.y)],n)}this.indices[c++]=g.p0.i;this.indices[c++]=g.p1.i;this.indices[c++]=d.i;a=!0;if(s)break}i=e.getPrevItem();n=e.nextItem()}while(i!==r);return a};ol.render.webgl.PolygonReplay.prototype.isSimple_=function(e,t){var o=e.firstItem(),r=o;do{if(this.getIntersections_(r,t).length)return!1;r=e.nextItem()}while(r!==o);return!0};ol.render.webgl.PolygonReplay.prototype.isClockwise_=function(e){var t=2*e.getLength(),o=new Array(t),r=e.firstItem(),i=r,n=0;do{o[n++]=i.p0.x;o[n++]=i.p0.y;i=e.nextItem()}while(i!==r);return ol.geom.flat.orient.linearRingIsClockwise(o,0,t,2)};ol.render.webgl.PolygonReplay.prototype.splitPolygon_=function(e,t){var o=e.firstItem(),r=o;do{var i=this.getIntersections_(r,t);if(i.length){var n=i[0],a=this.vertices.length/2,l=this.calculateIntersection_(r.p0,r.p1,n.p0,n.p1),s=this.createPoint_(l[0],l[1],a),p=new ol.structs.LinkedList,c=new ol.structs.RBush;this.insertItem_(s,r.p1,p,c);r.p1=s;t.update([Math.min(r.p0.x,s.x),Math.min(r.p0.y,s.y),Math.max(r.p0.x,s.x),Math.max(r.p0.y,s.y)],r);for(var u=e.nextItem();u!==n;){this.insertItem_(u.p0,u.p1,p,c);t.remove(u);e.removeItem();u=e.getCurrItem()}this.insertItem_(n.p0,s,p,c);n.p0=s;t.update([Math.min(n.p1.x,s.x),Math.min(n.p1.y,s.y),Math.max(n.p1.x,s.x),Math.max(n.p1.y,s.y)],n);this.classifyPoints_(e,t,!1);this.triangulate_(e,t);this.classifyPoints_(p,c,!1);this.triangulate_(p,c);break}r=e.nextItem()}while(r!==o)};ol.render.webgl.PolygonReplay.prototype.createPoint_=function(e,t,o){var r=this.vertices.length;this.vertices[r++]=e;this.vertices[r++]=t;var i={x:e,y:t,i:o,reflex:void 0};return i};ol.render.webgl.PolygonReplay.prototype.insertItem_=function(e,t,o,r){var i={p0:e,p1:t};o.insertItem(i);r&&r.insert([Math.min(e.x,t.x),Math.min(e.y,t.y),Math.max(e.x,t.x),Math.max(e.y,t.y)],i);return i};ol.render.webgl.PolygonReplay.prototype.removeItem_=function(e,t,o,r){if(o.getCurrItem()===t){o.removeItem();e.p1=t.p1;r.remove(t);r.update([Math.min(e.p0.x,e.p1.x),Math.min(e.p0.y,e.p1.y),Math.max(e.p0.x,e.p1.x),Math.max(e.p0.y,e.p1.y)],e)}};ol.render.webgl.PolygonReplay.prototype.getPointsInTriangle_=function(e,t,o,r,i){var n,a,l,s,p=[],c=r.getInExtent([Math.min(e.x,t.x,o.x),Math.min(e.y,t.y,o.y),Math.max(e.x,t.x,o.x),Math.max(e.y,t.y,o.y)]);for(n=0,a=c.length;a>n;++n)for(l in c[n]){s=c[n][l];"object"!=typeof s||i&&!s.reflex||s.x===e.x&&s.y===e.y||s.x===t.x&&s.y===t.y||s.x===o.x&&s.y===o.y||-1!==p.indexOf(s)||!ol.geom.flat.contains.linearRingContainsXY([e.x,e.y,t.x,t.y,o.x,o.y],0,6,2,s.x,s.y)||p.push(s)}return p};ol.render.webgl.PolygonReplay.prototype.getIntersections_=function(e,t,o){var r,i,n=e.p0,a=e.p1,l=t.getInExtent([Math.min(n.x,a.x),Math.min(n.y,a.y),Math.max(n.x,a.x),Math.max(n.y,a.y)]),s=[];for(r=0,i=l.length;i>r;++r){var p=l[r];e!==p&&(o||p.p0!==a||p.p1!==n)&&this.calculateIntersection_(n,a,p.p0,p.p1,o)&&s.push(p)}return s};ol.render.webgl.PolygonReplay.prototype.calculateIntersection_=function(e,t,o,r,i){var n=(r.y-o.y)*(t.x-e.x)-(r.x-o.x)*(t.y-e.y);if(0!==n){var a=((r.x-o.x)*(e.y-o.y)-(r.y-o.y)*(e.x-o.x))/n,l=((t.x-e.x)*(e.y-o.y)-(t.y-e.y)*(e.x-o.x))/n;if(!i&&a>ol.render.webgl.EPSILON&&a<1-ol.render.webgl.EPSILON&&l>ol.render.webgl.EPSILON&&l<1-ol.render.webgl.EPSILON||i&&a>=0&&1>=a&&l>=0&&1>=l)return[e.x+a*(t.x-e.x),e.y+a*(t.y-e.y)]}return void 0};ol.render.webgl.PolygonReplay.prototype.diagonalIsInside_=function(e,t,o,r,i){if(void 0===t.reflex||void 0===r.reflex)return!1;var n=(o.x-r.x)*(t.y-r.y)>(o.y-r.y)*(t.x-r.x),a=(i.x-r.x)*(t.y-r.y)<(i.y-r.y)*(t.x-r.x),l=(e.x-t.x)*(r.y-t.y)>(e.y-t.y)*(r.x-t.x),s=(o.x-t.x)*(r.y-t.y)<(o.y-t.y)*(r.x-t.x),p=r.reflex?a||n:a&&n,c=t.reflex?s||l:s&&l;return p&&c};ol.render.webgl.PolygonReplay.prototype.drawMultiPolygon=function(e,t){var o,r,i,n,a=e.getPolygons(),l=e.getStride(),s=this.indices.length,p=this.lineStringReplay.getCurrentIndex();for(o=0,r=a.length;r>o;++o){var c=a[o].getLinearRings();if(c.length>0){var u=c[0].getFlatCoordinates();u=ol.geom.flat.transform.translate(u,0,u.length,l,-this.origin[0],-this.origin[1]);var g,d=[];for(i=1,n=c.length;n>i;++i){g=c[i].getFlatCoordinates();g=ol.geom.flat.transform.translate(g,0,g.length,l,-this.origin[0],-this.origin[1]);d.push(g)}this.lineStringReplay.drawPolygonCoordinates(u,d,l);this.drawCoordinates_(u,d,l)}}if(this.indices.length>s){this.startIndices.push(s);this.startIndicesFeature.push(t);if(this.state_.changed){this.styleIndices_.push(s);this.state_.changed=!1}}this.lineStringReplay.getCurrentIndex()>p&&this.lineStringReplay.setPolygonStyle(t,p)};ol.render.webgl.PolygonReplay.prototype.drawPolygon=function(e,t){var o=e.getLinearRings(),r=e.getStride();if(o.length>0){this.startIndices.push(this.indices.length);this.startIndicesFeature.push(t);if(this.state_.changed){this.styleIndices_.push(this.indices.length);this.state_.changed=!1}this.lineStringReplay.setPolygonStyle(t);var i=o[0].getFlatCoordinates();i=ol.geom.flat.transform.translate(i,0,i.length,r,-this.origin[0],-this.origin[1]);var n,a,l,s=[];for(n=1,a=o.length;a>n;++n){l=o[n].getFlatCoordinates();l=ol.geom.flat.transform.translate(l,0,l.length,r,-this.origin[0],-this.origin[1]);s.push(l)}this.lineStringReplay.drawPolygonCoordinates(i,s,r);this.drawCoordinates_(i,s,r)}};ol.render.webgl.PolygonReplay.prototype.finish=function(e){this.verticesBuffer=new ol.webgl.Buffer(this.vertices);this.indicesBuffer=new ol.webgl.Buffer(this.indices);this.startIndices.push(this.indices.length);this.lineStringReplay.finish(e);0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]);this.vertices=null;this.indices=null};ol.render.webgl.PolygonReplay.prototype.getDeleteResourcesFunction=function(e){var t=this.verticesBuffer,o=this.indicesBuffer,r=this.lineStringReplay.getDeleteResourcesFunction(e);return function(){e.deleteBuffer(t);e.deleteBuffer(o);r()}};ol.render.webgl.PolygonReplay.prototype.setUpProgram=function(e,t,o,r){var i,n;i=ol.render.webgl.polygonreplay.defaultshader.fragment;n=ol.render.webgl.polygonreplay.defaultshader.vertex;var a,l=t.getProgram(i,n);if(this.defaultLocations_)a=this.defaultLocations_;else{a=new ol.render.webgl.polygonreplay.defaultshader.Locations(e,l);this.defaultLocations_=a}t.useProgram(l);e.enableVertexAttribArray(a.a_position);e.vertexAttribPointer(a.a_position,2,ol.webgl.FLOAT,!1,8,0);return a};ol.render.webgl.PolygonReplay.prototype.shutDownProgram=function(e,t){e.disableVertexAttribArray(t.a_position)};ol.render.webgl.PolygonReplay.prototype.drawReplay=function(e,t,o,r){var i=e.getParameter(e.DEPTH_FUNC),n=e.getParameter(e.DEPTH_WRITEMASK);if(!r){e.enable(e.DEPTH_TEST);e.depthMask(!0);e.depthFunc(e.NOTEQUAL)}if(ol.obj.isEmpty(o)){var a,l,s,p;s=this.startIndices[this.startIndices.length-1];for(a=this.styleIndices_.length-1;a>=0;--a){l=this.styleIndices_[a];p=this.styles_[a];this.setFillStyle_(e,p);this.drawElements(e,t,l,s);s=l}}else this.drawReplaySkipping_(e,t,o);if(!r){e.disable(e.DEPTH_TEST);e.clear(e.DEPTH_BUFFER_BIT);e.depthMask(n);e.depthFunc(i)}};ol.render.webgl.PolygonReplay.prototype.drawHitDetectionReplayOneByOne=function(e,t,o,r,i){var n,a,l,s,p,c,u,g;g=this.startIndices.length-2;l=this.startIndices[g+1];for(n=this.styleIndices_.length-1;n>=0;--n){s=this.styles_[n];this.setFillStyle_(e,s);p=this.styleIndices_[n];for(;g>=0&&this.startIndices[g]>=p;){a=this.startIndices[g];c=this.startIndicesFeature[g];u=ol.getUid(c).toString();if(void 0===o[u]&&c.getGeometry()&&(void 0===i||ol.extent.intersects(i,c.getGeometry().getExtent()))){e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);this.drawElements(e,t,a,l);var d=r(c);if(d)return d}g--;l=a}}return void 0};ol.render.webgl.PolygonReplay.prototype.drawReplaySkipping_=function(e,t,o){var r,i,n,a,l,s,p,c,u;c=this.startIndices.length-2;n=i=this.startIndices[c+1];for(r=this.styleIndices_.length-1;r>=0;--r){a=this.styles_[r];this.setFillStyle_(e,a);l=this.styleIndices_[r];for(;c>=0&&this.startIndices[c]>=l;){u=this.startIndices[c];s=this.startIndicesFeature[c];p=ol.getUid(s).toString();if(o[p]){if(i!==n){this.drawElements(e,t,i,n);e.clear(e.DEPTH_BUFFER_BIT)}n=u}c--;i=u}if(i!==n){this.drawElements(e,t,i,n);e.clear(e.DEPTH_BUFFER_BIT)}i=n=l}};ol.render.webgl.PolygonReplay.prototype.setFillStyle_=function(e,t){e.uniform4fv(this.defaultLocations_.u_color,t)};ol.render.webgl.PolygonReplay.prototype.setFillStrokeStyle=function(e,t){var o=e?e.getColor():[0,0,0,0];o=o instanceof CanvasGradient||o instanceof CanvasPattern?ol.render.webgl.defaultFillStyle:ol.color.asArray(o).map(function(e,t){return 3!=t?e/255:e})||ol.render.webgl.defaultFillStyle;if(!this.state_.fillColor||!ol.array.equals(o,this.state_.fillColor)){this.state_.fillColor=o;this.state_.changed=!0;this.styles_.push(o)}if(t)this.lineStringReplay.setFillStrokeStyle(null,t);else{var r=new ol.style.Stroke({color:[0,0,0,0],lineWidth:0});this.lineStringReplay.setFillStrokeStyle(null,r)}}}goog.provide("ol.render.webgl.TextReplay");goog.require("ol");if(ol.ENABLE_WEBGL){ol.render.webgl.TextReplay=function(e,t){};ol.render.webgl.TextReplay.prototype.setTextStyle=function(e){};ol.render.webgl.TextReplay.prototype.replay=function(e,t,o,r,i,n,a,l,s,p,c){return void 0};ol.render.webgl.TextReplay.prototype.drawText=function(e,t,o,r,i,n){};ol.render.webgl.TextReplay.prototype.finish=function(e){};ol.render.webgl.TextReplay.prototype.getDeleteResourcesFunction=function(e){return ol.nullFunction}}goog.provide("ol.render.webgl.ReplayGroup");goog.require("ol");goog.require("ol.array");goog.require("ol.extent");goog.require("ol.obj");goog.require("ol.render.replay");goog.require("ol.render.ReplayGroup");goog.require("ol.render.webgl.CircleReplay");goog.require("ol.render.webgl.ImageReplay");goog.require("ol.render.webgl.LineStringReplay");goog.require("ol.render.webgl.PolygonReplay");goog.require("ol.render.webgl.TextReplay");if(ol.ENABLE_WEBGL){ol.render.webgl.ReplayGroup=function(e,t,o){ol.render.ReplayGroup.call(this);this.maxExtent_=t;this.tolerance_=e;this.renderBuffer_=o;this.replaysByZIndex_={}};ol.inherits(ol.render.webgl.ReplayGroup,ol.render.ReplayGroup);ol.render.webgl.ReplayGroup.prototype.getDeleteResourcesFunction=function(e){var t,o=[];for(t in this.replaysByZIndex_){var r,i=this.replaysByZIndex_[t];for(r in i)o.push(i[r].getDeleteResourcesFunction(e))}return function(){for(var e,t=o.length,r=0;t>r;r++)e=o[r].apply(this,arguments);return e}};ol.render.webgl.ReplayGroup.prototype.finish=function(e){var t;for(t in this.replaysByZIndex_){var o,r=this.replaysByZIndex_[t];for(o in r)r[o].finish(e)}};ol.render.webgl.ReplayGroup.prototype.getReplay=function(e,t){var o=void 0!==e?e.toString():"0",r=this.replaysByZIndex_[o];if(void 0===r){r={};this.replaysByZIndex_[o]=r}var i=r[t];if(void 0===i){var n=ol.render.webgl.ReplayGroup.BATCH_CONSTRUCTORS_[t];i=new n(this.tolerance_,this.maxExtent_);r[t]=i}return i};ol.render.webgl.ReplayGroup.prototype.isEmpty=function(){return ol.obj.isEmpty(this.replaysByZIndex_)};ol.render.webgl.ReplayGroup.prototype.replay=function(e,t,o,r,i,n,a,l){var s=Object.keys(this.replaysByZIndex_).map(Number);s.sort(ol.array.numberSafeCompareFunction);var p,c,u,g,d,h;for(p=0,c=s.length;c>p;++p){d=this.replaysByZIndex_[s[p].toString()];for(u=0,g=ol.render.replay.ORDER.length;g>u;++u){h=d[ol.render.replay.ORDER[u]];void 0!==h&&h.replay(e,t,o,r,i,n,a,l,void 0,!1)}}};ol.render.webgl.ReplayGroup.prototype.replayHitDetection_=function(e,t,o,r,i,n,a,l,s,p,c){var u=Object.keys(this.replaysByZIndex_).map(Number);u.sort(function(e,t){return t-e});var g,d,h,f,y,m;for(g=0,d=u.length;d>g;++g){f=this.replaysByZIndex_[u[g].toString()];for(h=ol.render.replay.ORDER.length-1;h>=0;--h){y=f[ol.render.replay.ORDER[h]];if(void 0!==y){m=y.replay(e,t,o,r,i,n,a,l,s,p,c);if(m)return m}}}return void 0};ol.render.webgl.ReplayGroup.prototype.forEachFeatureAtCoordinate=function(e,t,o,r,i,n,a,l,s,p){var c=t.getGL();c.bindFramebuffer(c.FRAMEBUFFER,t.getHitDetectionFramebuffer());var u;void 0!==this.renderBuffer_&&(u=ol.extent.buffer(ol.extent.createOrUpdateFromCoordinate(e),r*this.renderBuffer_));return this.replayHitDetection_(t,e,r,i,ol.render.webgl.ReplayGroup.HIT_DETECTION_SIZE_,a,l,s,function(e){var t=new Uint8Array(4);c.readPixels(0,0,1,1,c.RGBA,c.UNSIGNED_BYTE,t);if(t[3]>0){var o=p(e);if(o)return o}},!0,u)};ol.render.webgl.ReplayGroup.prototype.hasFeatureAtCoordinate=function(e,t,o,r,i,n,a,l,s){var p=t.getGL();p.bindFramebuffer(p.FRAMEBUFFER,t.getHitDetectionFramebuffer());var c=this.replayHitDetection_(t,e,r,i,ol.render.webgl.ReplayGroup.HIT_DETECTION_SIZE_,a,l,s,function(e){var t=new Uint8Array(4);p.readPixels(0,0,1,1,p.RGBA,p.UNSIGNED_BYTE,t);return t[3]>0},!1);return void 0!==c};ol.render.webgl.ReplayGroup.HIT_DETECTION_SIZE_=[1,1];ol.render.webgl.ReplayGroup.BATCH_CONSTRUCTORS_={Circle:ol.render.webgl.CircleReplay,Image:ol.render.webgl.ImageReplay,LineString:ol.render.webgl.LineStringReplay,Polygon:ol.render.webgl.PolygonReplay,Text:ol.render.webgl.TextReplay}}goog.provide("ol.render.webgl.Immediate");goog.require("ol");goog.require("ol.extent");goog.require("ol.geom.GeometryType");goog.require("ol.render.ReplayType");goog.require("ol.render.VectorContext");goog.require("ol.render.webgl.ReplayGroup");if(ol.ENABLE_WEBGL){ol.render.webgl.Immediate=function(e,t,o,r,i,n,a){ol.render.VectorContext.call(this);this.context_=e;this.center_=t;this.extent_=n;this.pixelRatio_=a;this.size_=i;this.rotation_=r;this.resolution_=o;this.imageStyle_=null;this.fillStyle_=null;this.strokeStyle_=null};ol.inherits(ol.render.webgl.Immediate,ol.render.VectorContext);ol.render.webgl.Immediate.prototype.setStyle=function(e){this.setFillStrokeStyle(e.getFill(),e.getStroke());this.setImageStyle(e.getImage())};ol.render.webgl.Immediate.prototype.drawGeometry=function(e){var t=e.getType();switch(t){case ol.geom.GeometryType.POINT:this.drawPoint(e,null);break;case ol.geom.GeometryType.LINE_STRING:this.drawLineString(e,null);break;case ol.geom.GeometryType.POLYGON:this.drawPolygon(e,null);break;case ol.geom.GeometryType.MULTI_POINT:this.drawMultiPoint(e,null);break;case ol.geom.GeometryType.MULTI_LINE_STRING:this.drawMultiLineString(e,null);break;case ol.geom.GeometryType.MULTI_POLYGON:this.drawMultiPolygon(e,null);break;case ol.geom.GeometryType.GEOMETRY_COLLECTION:this.drawGeometryCollection(e,null);break;case ol.geom.GeometryType.CIRCLE:this.drawCircle(e,null)}};ol.render.webgl.Immediate.prototype.drawFeature=function(e,t){var o=t.getGeometryFunction()(e);if(o&&ol.extent.intersects(this.extent_,o.getExtent())){this.setStyle(t);this.drawGeometry(o)}};ol.render.webgl.Immediate.prototype.drawGeometryCollection=function(e,t){var o,r,i=e.getGeometriesArray();for(o=0,r=i.length;r>o;++o)this.drawGeometry(i[o])};ol.render.webgl.Immediate.prototype.drawPoint=function(e,t){var o=this.context_,r=new ol.render.webgl.ReplayGroup(1,this.extent_),i=r.getReplay(0,ol.render.ReplayType.IMAGE);i.setImageStyle(this.imageStyle_);i.drawPoint(e,t);i.finish(o);var n,a=1,l={},s=!1;i.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,a,l,n,s);i.getDeleteResourcesFunction(o)()};ol.render.webgl.Immediate.prototype.drawMultiPoint=function(e,t){var o=this.context_,r=new ol.render.webgl.ReplayGroup(1,this.extent_),i=r.getReplay(0,ol.render.ReplayType.IMAGE);i.setImageStyle(this.imageStyle_);i.drawMultiPoint(e,t);i.finish(o);var n,a=1,l={},s=!1;i.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,a,l,n,s);i.getDeleteResourcesFunction(o)()};ol.render.webgl.Immediate.prototype.drawLineString=function(e,t){var o=this.context_,r=new ol.render.webgl.ReplayGroup(1,this.extent_),i=r.getReplay(0,ol.render.ReplayType.LINE_STRING);i.setFillStrokeStyle(null,this.strokeStyle_);i.drawLineString(e,t);i.finish(o);var n,a=1,l={},s=!1;i.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,a,l,n,s);i.getDeleteResourcesFunction(o)()};ol.render.webgl.Immediate.prototype.drawMultiLineString=function(e,t){var o=this.context_,r=new ol.render.webgl.ReplayGroup(1,this.extent_),i=r.getReplay(0,ol.render.ReplayType.LINE_STRING);i.setFillStrokeStyle(null,this.strokeStyle_);i.drawMultiLineString(e,t);i.finish(o);var n,a=1,l={},s=!1;i.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,a,l,n,s);i.getDeleteResourcesFunction(o)()};ol.render.webgl.Immediate.prototype.drawPolygon=function(e,t){var o=this.context_,r=new ol.render.webgl.ReplayGroup(1,this.extent_),i=r.getReplay(0,ol.render.ReplayType.POLYGON);i.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_);i.drawPolygon(e,t);i.finish(o);var n,a=1,l={},s=!1;i.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,a,l,n,s);i.getDeleteResourcesFunction(o)()};ol.render.webgl.Immediate.prototype.drawMultiPolygon=function(e,t){var o=this.context_,r=new ol.render.webgl.ReplayGroup(1,this.extent_),i=r.getReplay(0,ol.render.ReplayType.POLYGON);i.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_);i.drawMultiPolygon(e,t);i.finish(o);var n,a=1,l={},s=!1;i.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,a,l,n,s);i.getDeleteResourcesFunction(o)()};ol.render.webgl.Immediate.prototype.drawCircle=function(e,t){var o=this.context_,r=new ol.render.webgl.ReplayGroup(1,this.extent_),i=r.getReplay(0,ol.render.ReplayType.CIRCLE);i.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_);i.drawCircle(e,t);i.finish(o);var n,a=1,l={},s=!1;i.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,a,l,n,s);i.getDeleteResourcesFunction(o)()};ol.render.webgl.Immediate.prototype.setImageStyle=function(e){this.imageStyle_=e};ol.render.webgl.Immediate.prototype.setFillStrokeStyle=function(e,t){this.fillStyle_=e;this.strokeStyle_=t}}goog.provide("ol.structs.LRUCache");goog.require("ol.asserts");ol.structs.LRUCache=function(){this.count_=0;this.entries_={};this.oldest_=null;this.newest_=null};ol.structs.LRUCache.prototype.clear=function(){this.count_=0;this.entries_={};this.oldest_=null;this.newest_=null};ol.structs.LRUCache.prototype.containsKey=function(e){return this.entries_.hasOwnProperty(e)};ol.structs.LRUCache.prototype.forEach=function(e,t){for(var o=this.oldest_;o;){e.call(t,o.value_,o.key_,this);o=o.newer}};ol.structs.LRUCache.prototype.get=function(e){var t=this.entries_[e];ol.asserts.assert(void 0!==t,15);if(t===this.newest_)return t.value_;if(t===this.oldest_){this.oldest_=this.oldest_.newer;this.oldest_.older=null}else{t.newer.older=t.older;t.older.newer=t.newer}t.newer=null;t.older=this.newest_;this.newest_.newer=t;this.newest_=t;return t.value_};ol.structs.LRUCache.prototype.getCount=function(){return this.count_};ol.structs.LRUCache.prototype.getKeys=function(){var e,t=new Array(this.count_),o=0;for(e=this.newest_;e;e=e.older)t[o++]=e.key_;return t};ol.structs.LRUCache.prototype.getValues=function(){var e,t=new Array(this.count_),o=0;for(e=this.newest_;e;e=e.older)t[o++]=e.value_;return t};ol.structs.LRUCache.prototype.peekLast=function(){return this.oldest_.value_};ol.structs.LRUCache.prototype.peekLastKey=function(){return this.oldest_.key_};ol.structs.LRUCache.prototype.pop=function(){var e=this.oldest_;delete this.entries_[e.key_];e.newer&&(e.newer.older=null);this.oldest_=e.newer;this.oldest_||(this.newest_=null);--this.count_;return e.value_};ol.structs.LRUCache.prototype.replace=function(e,t){this.get(e);this.entries_[e].value_=t};ol.structs.LRUCache.prototype.set=function(e,t){ol.asserts.assert(!(e in this.entries_),16);var o={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=o:this.oldest_=o;this.newest_=o;this.entries_[e]=o;++this.count_};goog.provide("ol.renderer.webgl.Map");goog.require("ol");goog.require("ol.array");goog.require("ol.css");goog.require("ol.dom");goog.require("ol.events");goog.require("ol.layer.Layer");goog.require("ol.render.Event");goog.require("ol.render.EventType");goog.require("ol.render.webgl.Immediate");goog.require("ol.renderer.Map");goog.require("ol.renderer.Type");goog.require("ol.source.State");goog.require("ol.structs.LRUCache");goog.require("ol.structs.PriorityQueue");goog.require("ol.webgl");goog.require("ol.webgl.Context");goog.require("ol.webgl.ContextEventType");if(ol.ENABLE_WEBGL){ol.renderer.webgl.Map=function(e,t){ol.renderer.Map.call(this,e,t);this.canvas_=document.createElement("CANVAS");this.canvas_.style.width="100%";this.canvas_.style.height="100%";this.canvas_.style.display="block";this.canvas_.className=ol.css.CLASS_UNSELECTABLE;e.insertBefore(this.canvas_,e.childNodes[0]||null);this.clipTileCanvasWidth_=0;this.clipTileCanvasHeight_=0;this.clipTileContext_=ol.dom.createCanvasContext2D();this.renderedVisible_=!0;this.gl_=ol.webgl.getContext(this.canvas_,{antialias:!0,depth:!0,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!1,stencil:!0});this.context_=new ol.webgl.Context(this.canvas_,this.gl_);ol.events.listen(this.canvas_,ol.webgl.ContextEventType.LOST,this.handleWebGLContextLost,this);ol.events.listen(this.canvas_,ol.webgl.ContextEventType.RESTORED,this.handleWebGLContextRestored,this);this.textureCache_=new ol.structs.LRUCache;this.focus_=null;this.tileTextureQueue_=new ol.structs.PriorityQueue(function(e){var t=e[1],o=e[2],r=t[0]-this.focus_[0],i=t[1]-this.focus_[1];return 65536*Math.log(o)+Math.sqrt(r*r+i*i)/o}.bind(this),function(e){return e[0].getKey()});this.loadNextTileTexture_=function(e,t){if(!this.tileTextureQueue_.isEmpty()){this.tileTextureQueue_.reprioritize();var o=this.tileTextureQueue_.dequeue(),r=o[0],i=o[3],n=o[4];this.bindTileTexture(r,i,n,ol.webgl.LINEAR,ol.webgl.LINEAR)}return!1}.bind(this);this.textureCacheFrameMarkerCount_=0;this.initializeGL_()};ol.inherits(ol.renderer.webgl.Map,ol.renderer.Map);ol.renderer.webgl.Map.prototype.bindTileTexture=function(e,t,o,r,i){var n=this.getGL(),a=e.getKey();if(this.textureCache_.containsKey(a)){var l=this.textureCache_.get(a);n.bindTexture(ol.webgl.TEXTURE_2D,l.texture);if(l.magFilter!=r){n.texParameteri(ol.webgl.TEXTURE_2D,ol.webgl.TEXTURE_MAG_FILTER,r);l.magFilter=r}if(l.minFilter!=i){n.texParameteri(ol.webgl.TEXTURE_2D,ol.webgl.TEXTURE_MIN_FILTER,i);l.minFilter=i}}else{var s=n.createTexture();n.bindTexture(ol.webgl.TEXTURE_2D,s);if(o>0){var p=this.clipTileContext_.canvas,c=this.clipTileContext_;if(this.clipTileCanvasWidth_!==t[0]||this.clipTileCanvasHeight_!==t[1]){p.width=t[0];p.height=t[1];this.clipTileCanvasWidth_=t[0];this.clipTileCanvasHeight_=t[1]}else c.clearRect(0,0,t[0],t[1]);c.drawImage(e.getImage(),o,o,t[0],t[1],0,0,t[0],t[1]);n.texImage2D(ol.webgl.TEXTURE_2D,0,ol.webgl.RGBA,ol.webgl.RGBA,ol.webgl.UNSIGNED_BYTE,p)}else n.texImage2D(ol.webgl.TEXTURE_2D,0,ol.webgl.RGBA,ol.webgl.RGBA,ol.webgl.UNSIGNED_BYTE,e.getImage());n.texParameteri(ol.webgl.TEXTURE_2D,ol.webgl.TEXTURE_MAG_FILTER,r);n.texParameteri(ol.webgl.TEXTURE_2D,ol.webgl.TEXTURE_MIN_FILTER,i);n.texParameteri(ol.webgl.TEXTURE_2D,ol.webgl.TEXTURE_WRAP_S,ol.webgl.CLAMP_TO_EDGE);n.texParameteri(ol.webgl.TEXTURE_2D,ol.webgl.TEXTURE_WRAP_T,ol.webgl.CLAMP_TO_EDGE);this.textureCache_.set(a,{texture:s,magFilter:r,minFilter:i})}};ol.renderer.webgl.Map.prototype.dispatchComposeEvent_=function(e,t){var o=this.getMap();if(o.hasListener(e)){var r=this.context_,i=t.extent,n=t.size,a=t.viewState,l=t.pixelRatio,s=a.resolution,p=a.center,c=a.rotation,u=new ol.render.webgl.Immediate(r,p,s,c,n,i,l),g=new ol.render.Event(e,u,t,null,r);o.dispatchEvent(g)}};ol.renderer.webgl.Map.prototype.disposeInternal=function(){var e=this.getGL();e.isContextLost()||this.textureCache_.forEach(function(t){t&&e.deleteTexture(t.texture)});this.context_.dispose();ol.renderer.Map.prototype.disposeInternal.call(this)};ol.renderer.webgl.Map.prototype.expireCache_=function(e,t){for(var o,r=this.getGL();this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>ol.WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK;){o=this.textureCache_.peekLast();if(o)r.deleteTexture(o.texture);else{if(+this.textureCache_.peekLastKey()==t.index)break;--this.textureCacheFrameMarkerCount_}this.textureCache_.pop()}};ol.renderer.webgl.Map.prototype.getContext=function(){return this.context_};ol.renderer.webgl.Map.prototype.getGL=function(){return this.gl_};ol.renderer.webgl.Map.prototype.getTileTextureQueue=function(){return this.tileTextureQueue_};ol.renderer.webgl.Map.prototype.getType=function(){return ol.renderer.Type.WEBGL};ol.renderer.webgl.Map.prototype.handleWebGLContextLost=function(e){e.preventDefault();this.textureCache_.clear();this.textureCacheFrameMarkerCount_=0;var t=this.getLayerRenderers();for(var o in t){var r=t[o];r.handleWebGLContextLost()}};ol.renderer.webgl.Map.prototype.handleWebGLContextRestored=function(){this.initializeGL_();this.getMap().render()};ol.renderer.webgl.Map.prototype.initializeGL_=function(){var e=this.gl_;e.activeTexture(ol.webgl.TEXTURE0);e.blendFuncSeparate(ol.webgl.SRC_ALPHA,ol.webgl.ONE_MINUS_SRC_ALPHA,ol.webgl.ONE,ol.webgl.ONE_MINUS_SRC_ALPHA);e.disable(ol.webgl.CULL_FACE);e.disable(ol.webgl.DEPTH_TEST);e.disable(ol.webgl.SCISSOR_TEST);e.disable(ol.webgl.STENCIL_TEST)};ol.renderer.webgl.Map.prototype.isTileTextureLoaded=function(e){return this.textureCache_.containsKey(e.getKey())};ol.renderer.webgl.Map.prototype.renderFrame=function(e){var t=this.getContext(),o=this.getGL();if(o.isContextLost())return!1;if(!e){if(this.renderedVisible_){this.canvas_.style.display="none";this.renderedVisible_=!1}return!1}this.focus_=e.focus;this.textureCache_.set((-e.index).toString(),null);++this.textureCacheFrameMarkerCount_;this.dispatchComposeEvent_(ol.render.EventType.PRECOMPOSE,e);var r=[],i=e.layerStatesArray;

ol.array.stableSort(i,ol.renderer.Map.sortByZIndex);var n,a,l,s,p=e.viewState.resolution;for(n=0,a=i.length;a>n;++n){s=i[n];if(ol.layer.Layer.visibleAtResolution(s,p)&&s.sourceState==ol.source.State.READY){l=this.getLayerRenderer(s.layer);l.prepareFrame(e,s,t)&&r.push(s)}}var c=e.size[0]*e.pixelRatio,u=e.size[1]*e.pixelRatio;if(this.canvas_.width!=c||this.canvas_.height!=u){this.canvas_.width=c;this.canvas_.height=u}o.bindFramebuffer(ol.webgl.FRAMEBUFFER,null);o.clearColor(0,0,0,0);o.clear(ol.webgl.COLOR_BUFFER_BIT);o.enable(ol.webgl.BLEND);o.viewport(0,0,this.canvas_.width,this.canvas_.height);for(n=0,a=r.length;a>n;++n){s=r[n];l=this.getLayerRenderer(s.layer);l.composeFrame(e,s,t)}if(!this.renderedVisible_){this.canvas_.style.display="";this.renderedVisible_=!0}this.calculateMatrices2D(e);this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>ol.WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK&&e.postRenderFunctions.push(this.expireCache_.bind(this));if(!this.tileTextureQueue_.isEmpty()){e.postRenderFunctions.push(this.loadNextTileTexture_);e.animate=!0}this.dispatchComposeEvent_(ol.render.EventType.POSTCOMPOSE,e);this.scheduleRemoveUnusedLayerRenderers(e);this.scheduleExpireIconCache(e)};ol.renderer.webgl.Map.prototype.forEachFeatureAtCoordinate=function(e,t,o,r,i,n,a){var l;if(this.getGL().isContextLost())return!1;var s,p=t.viewState,c=t.layerStatesArray,u=c.length;for(s=u-1;s>=0;--s){var g=c[s],d=g.layer;if(ol.layer.Layer.visibleAtResolution(g,p.resolution)&&n.call(a,d)){var h=this.getLayerRenderer(d);l=h.forEachFeatureAtCoordinate(e,t,o,r,i);if(l)return l}}return void 0};ol.renderer.webgl.Map.prototype.hasFeatureAtCoordinate=function(e,t,o,r,i){var n=!1;if(this.getGL().isContextLost())return!1;var a,l=t.viewState,s=t.layerStatesArray,p=s.length;for(a=p-1;a>=0;--a){var c=s[a],u=c.layer;if(ol.layer.Layer.visibleAtResolution(c,l.resolution)&&r.call(i,u)){var g=this.getLayerRenderer(u);n=g.hasFeatureAtCoordinate(e,t);if(n)return!0}}return n};ol.renderer.webgl.Map.prototype.forEachLayerAtPixel=function(e,t,o,r,i,n){if(this.getGL().isContextLost())return!1;var a,l,s=t.viewState,p=t.layerStatesArray,c=p.length;for(l=c-1;l>=0;--l){var u=p[l],g=u.layer;if(ol.layer.Layer.visibleAtResolution(u,s.resolution)&&i.call(r,g)){var d=this.getLayerRenderer(g);a=d.forEachLayerAtPixel(e,t,o,r);if(a)return a}}return void 0}}goog.provide("ol.Map");goog.require("ol");goog.require("ol.Collection");goog.require("ol.CollectionEventType");goog.require("ol.MapBrowserEvent");goog.require("ol.MapBrowserEventHandler");goog.require("ol.MapBrowserEventType");goog.require("ol.MapEvent");goog.require("ol.MapEventType");goog.require("ol.MapProperty");goog.require("ol.Object");goog.require("ol.ObjectEventType");goog.require("ol.TileQueue");goog.require("ol.View");goog.require("ol.ViewHint");goog.require("ol.asserts");goog.require("ol.control");goog.require("ol.dom");goog.require("ol.events");goog.require("ol.events.Event");goog.require("ol.events.EventType");goog.require("ol.extent");goog.require("ol.functions");goog.require("ol.has");goog.require("ol.interaction");goog.require("ol.layer.Group");goog.require("ol.obj");goog.require("ol.renderer.Map");goog.require("ol.renderer.Type");goog.require("ol.renderer.canvas.Map");goog.require("ol.renderer.webgl.Map");goog.require("ol.size");goog.require("ol.structs.PriorityQueue");goog.require("ol.transform");ol.OL_URL="https://openlayers.org/";ol.OL_LOGO_URL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAHGAAABxgEXwfpGAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAhNQTFRF////AP//AICAgP//AFVVQECA////K1VVSbbbYL/fJ05idsTYJFtbbcjbJllmZszWWMTOIFhoHlNiZszTa9DdUcHNHlNlV8XRIVdiasrUHlZjIVZjaMnVH1RlIFRkH1RkH1ZlasvYasvXVsPQH1VkacnVa8vWIVZjIFRjVMPQa8rXIVVkXsXRsNveIFVkIFZlIVVj3eDeh6GmbMvXH1ZkIFRka8rWbMvXIFVkIFVjIFVkbMvWH1VjbMvWIFVlbcvWIFVla8vVIFVkbMvWbMvVH1VkbMvWIFVlbcvWIFVkbcvVbMvWjNPbIFVkU8LPwMzNIFVkbczWIFVkbsvWbMvXIFVkRnB8bcvW2+TkW8XRIFVkIlZlJVloJlpoKlxrLl9tMmJwOWd0Omh1RXF8TneCT3iDUHiDU8LPVMLPVcLPVcPQVsPPVsPQV8PQWMTQWsTQW8TQXMXSXsXRX4SNX8bSYMfTYcfTYsfTY8jUZcfSZsnUaIqTacrVasrVa8jTa8rWbI2VbMvWbcvWdJObdcvUdszUd8vVeJaee87Yfc3WgJyjhqGnitDYjaarldPZnrK2oNbborW5o9bbo9fbpLa6q9ndrL3ArtndscDDutzfu8fJwN7gwt7gxc/QyuHhy+HizeHi0NfX0+Pj19zb1+Tj2uXk29/e3uLg3+Lh3+bl4uXj4ufl4+fl5Ofl5ufl5ujm5+jmySDnBAAAAFp0Uk5TAAECAgMEBAYHCA0NDg4UGRogIiMmKSssLzU7PkJJT1JTVFliY2hrdHZ3foSFhYeJjY2QkpugqbG1tre5w8zQ09XY3uXn6+zx8vT09vf4+Pj5+fr6/P39/f3+gz7SsAAAAVVJREFUOMtjYKA7EBDnwCPLrObS1BRiLoJLnte6CQy8FLHLCzs2QUG4FjZ5GbcmBDDjxJBXDWxCBrb8aM4zbkIDzpLYnAcE9VXlJSWlZRU13koIeW57mGx5XjoMZEUqwxWYQaQbSzLSkYGfKFSe0QMsX5WbjgY0YS4MBplemI4BdGBW+DQ11eZiymfqQuXZIjqwyadPNoSZ4L+0FVM6e+oGI6g8a9iKNT3o8kVzNkzRg5lgl7p4wyRUL9Yt2jAxVh6mQCogae6GmflI8p0r13VFWTHBQ0rWPW7ahgWVcPm+9cuLoyy4kCJDzCm6d8PSFoh0zvQNC5OjDJhQopPPJqph1doJBUD5tnkbZiUEqaCnB3bTqLTFG1bPn71kw4b+GFdpLElKIzRxxgYgWNYc5SCENVHKeUaltHdXx0dZ8uBI1hJ2UUDgq82CM2MwKeibqAvSO7MCABq0wXEPiqWEAAAAAElFTkSuQmCC";ol.DEFAULT_RENDERER_TYPES=[ol.renderer.Type.CANVAS,ol.renderer.Type.WEBGL];ol.Map=function(e){ol.Object.call(this);var t=ol.Map.createOptionsInternal(e);this.loadTilesWhileAnimating_=void 0!==e.loadTilesWhileAnimating?e.loadTilesWhileAnimating:!1;this.loadTilesWhileInteracting_=void 0!==e.loadTilesWhileInteracting?e.loadTilesWhileInteracting:!1;this.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:ol.has.DEVICE_PIXEL_RATIO;this.logos_=t.logos;this.animationDelayKey_;this.animationDelay_=function(){this.animationDelayKey_=void 0;this.renderFrame_.call(this,Date.now())}.bind(this);this.coordinateToPixelTransform_=ol.transform.create();this.pixelToCoordinateTransform_=ol.transform.create();this.frameIndex_=0;this.frameState_=null;this.previousExtent_=ol.extent.createEmpty();this.viewPropertyListenerKey_=null;this.viewChangeListenerKey_=null;this.layerGroupPropertyListenerKeys_=null;this.viewport_=document.createElement("DIV");this.viewport_.className="ol-viewport"+(ol.has.TOUCH?" ol-touch":"");this.viewport_.style.position="relative";this.viewport_.style.overflow="hidden";this.viewport_.style.width="100%";this.viewport_.style.height="100%";this.viewport_.style.msTouchAction="none";this.viewport_.style.touchAction="none";this.overlayContainer_=document.createElement("DIV");this.overlayContainer_.className="ol-overlaycontainer";this.viewport_.appendChild(this.overlayContainer_);this.overlayContainerStopEvent_=document.createElement("DIV");this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";for(var o=[ol.events.EventType.CLICK,ol.events.EventType.DBLCLICK,ol.events.EventType.MOUSEDOWN,ol.events.EventType.TOUCHSTART,ol.events.EventType.MSPOINTERDOWN,ol.MapBrowserEventType.POINTERDOWN,ol.events.EventType.MOUSEWHEEL,ol.events.EventType.WHEEL],r=0,i=o.length;i>r;++r)ol.events.listen(this.overlayContainerStopEvent_,o[r],ol.events.Event.stopPropagation);this.viewport_.appendChild(this.overlayContainerStopEvent_);this.mapBrowserEventHandler_=new ol.MapBrowserEventHandler(this);for(var n in ol.MapBrowserEventType)ol.events.listen(this.mapBrowserEventHandler_,ol.MapBrowserEventType[n],this.handleMapBrowserEvent,this);this.keyboardEventTarget_=t.keyboardEventTarget;this.keyHandlerKeys_=null;ol.events.listen(this.viewport_,ol.events.EventType.WHEEL,this.handleBrowserEvent,this);ol.events.listen(this.viewport_,ol.events.EventType.MOUSEWHEEL,this.handleBrowserEvent,this);this.controls_=t.controls;this.interactions_=t.interactions;this.overlays_=t.overlays;this.overlayIdIndex_={};this.renderer_=new t.rendererConstructor(this.viewport_,this);this.handleResize_;this.focus_=null;this.postRenderFunctions_=[];this.tileQueue_=new ol.TileQueue(this.getTilePriority.bind(this),this.handleTileChange_.bind(this));this.skippedFeatureUids_={};ol.events.listen(this,ol.Object.getChangeEventType(ol.MapProperty.LAYERGROUP),this.handleLayerGroupChanged_,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.MapProperty.VIEW),this.handleViewChanged_,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.MapProperty.SIZE),this.handleSizeChanged_,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.MapProperty.TARGET),this.handleTargetChanged_,this);this.setProperties(t.values);this.controls_.forEach(function(e){e.setMap(this)},this);ol.events.listen(this.controls_,ol.CollectionEventType.ADD,function(e){e.element.setMap(this)},this);ol.events.listen(this.controls_,ol.CollectionEventType.REMOVE,function(e){e.element.setMap(null)},this);this.interactions_.forEach(function(e){e.setMap(this)},this);ol.events.listen(this.interactions_,ol.CollectionEventType.ADD,function(e){e.element.setMap(this)},this);ol.events.listen(this.interactions_,ol.CollectionEventType.REMOVE,function(e){e.element.setMap(null)},this);this.overlays_.forEach(this.addOverlayInternal_,this);ol.events.listen(this.overlays_,ol.CollectionEventType.ADD,function(e){this.addOverlayInternal_(e.element)},this);ol.events.listen(this.overlays_,ol.CollectionEventType.REMOVE,function(e){var t=e.element,o=t.getId();void 0!==o&&delete this.overlayIdIndex_[o.toString()];e.element.setMap(null)},this)};ol.inherits(ol.Map,ol.Object);ol.Map.prototype.addControl=function(e){this.getControls().push(e)};ol.Map.prototype.addInteraction=function(e){this.getInteractions().push(e)};ol.Map.prototype.addLayer=function(e){var t=this.getLayerGroup().getLayers();t.push(e)};ol.Map.prototype.addOverlay=function(e){this.getOverlays().push(e)};ol.Map.prototype.addOverlayInternal_=function(e){var t=e.getId();void 0!==t&&(this.overlayIdIndex_[t.toString()]=e);e.setMap(this)};ol.Map.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose();this.renderer_.dispose();ol.events.unlisten(this.viewport_,ol.events.EventType.WHEEL,this.handleBrowserEvent,this);ol.events.unlisten(this.viewport_,ol.events.EventType.MOUSEWHEEL,this.handleBrowserEvent,this);if(void 0!==this.handleResize_){window.removeEventListener(ol.events.EventType.RESIZE,this.handleResize_,!1);this.handleResize_=void 0}if(this.animationDelayKey_){cancelAnimationFrame(this.animationDelayKey_);this.animationDelayKey_=void 0}this.setTarget(null);ol.Object.prototype.disposeInternal.call(this)};ol.Map.prototype.forEachFeatureAtPixel=function(e,t,o){if(this.frameState_){var r=this.getCoordinateFromPixel(e);o=void 0!==o?o:{};var i=void 0!==o.hitTolerance?o.hitTolerance*this.frameState_.pixelRatio:0,n=void 0!==o.layerFilter?o.layerFilter:ol.functions.TRUE;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,i,t,null,n,null)}};ol.Map.prototype.forEachLayerAtPixel=function(e,t,o,r,i){if(this.frameState_){var n=void 0!==o?o:null,a=void 0!==r?r:ol.functions.TRUE,l=void 0!==i?i:null;return this.renderer_.forEachLayerAtPixel(e,this.frameState_,t,n,a,l)}};ol.Map.prototype.hasFeatureAtPixel=function(e,t){if(!this.frameState_)return!1;var o=this.getCoordinateFromPixel(e);t=void 0!==t?t:{};var r=void 0!==t.layerFilter?t.layerFilter:ol.functions.TRUE,i=void 0!==t.hitTolerance?t.hitTolerance*this.frameState_.pixelRatio:0;return this.renderer_.hasFeatureAtCoordinate(o,this.frameState_,i,r,null)};ol.Map.prototype.getEventCoordinate=function(e){return this.getCoordinateFromPixel(this.getEventPixel(e))};ol.Map.prototype.getEventPixel=function(e){var t=this.viewport_.getBoundingClientRect(),o=e.changedTouches?e.changedTouches[0]:e;return[o.clientX-t.left,o.clientY-t.top]};ol.Map.prototype.getTarget=function(){return this.get(ol.MapProperty.TARGET)};ol.Map.prototype.getTargetElement=function(){var e=this.getTarget();return void 0!==e?"string"==typeof e?document.getElementById(e):e:null};ol.Map.prototype.getCoordinateFromPixel=function(e){var t=this.frameState_;return t?ol.transform.apply(t.pixelToCoordinateTransform,e.slice()):null};ol.Map.prototype.getControls=function(){return this.controls_};ol.Map.prototype.getOverlays=function(){return this.overlays_};ol.Map.prototype.getOverlayById=function(e){var t=this.overlayIdIndex_[e.toString()];return void 0!==t?t:null};ol.Map.prototype.getInteractions=function(){return this.interactions_};ol.Map.prototype.getLayerGroup=function(){return this.get(ol.MapProperty.LAYERGROUP)};ol.Map.prototype.getLayers=function(){var e=this.getLayerGroup().getLayers();return e};ol.Map.prototype.getPixelFromCoordinate=function(e){var t=this.frameState_;return t?ol.transform.apply(t.coordinateToPixelTransform,e.slice(0,2)):null};ol.Map.prototype.getRenderer=function(){return this.renderer_};ol.Map.prototype.getSize=function(){return this.get(ol.MapProperty.SIZE)};ol.Map.prototype.getView=function(){return this.get(ol.MapProperty.VIEW)};ol.Map.prototype.getViewport=function(){return this.viewport_};ol.Map.prototype.getOverlayContainer=function(){return this.overlayContainer_};ol.Map.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_};ol.Map.prototype.getTilePriority=function(e,t,o,r){var i=this.frameState_;if(!(i&&t in i.wantedTiles))return ol.structs.PriorityQueue.DROP;if(!i.wantedTiles[t][e.getKey()])return ol.structs.PriorityQueue.DROP;var n=o[0]-i.focus[0],a=o[1]-i.focus[1];return 65536*Math.log(r)+Math.sqrt(n*n+a*a)/r};ol.Map.prototype.handleBrowserEvent=function(e,t){var o=t||e.type,r=new ol.MapBrowserEvent(o,this,e);this.handleMapBrowserEvent(r)};ol.Map.prototype.handleMapBrowserEvent=function(e){if(this.frameState_){this.focus_=e.coordinate;e.frameState=this.frameState_;var t,o=this.getInteractions().getArray();if(this.dispatchEvent(e)!==!1)for(t=o.length-1;t>=0;t--){var r=o[t];if(r.getActive()){var i=r.handleEvent(e);if(!i)break}}}};ol.Map.prototype.handlePostRender=function(){var e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){var o=16,r=o;if(e){var i=e.viewHints;if(i[ol.ViewHint.ANIMATING]){o=this.loadTilesWhileAnimating_?8:0;r=2}if(i[ol.ViewHint.INTERACTING]){o=this.loadTilesWhileInteracting_?8:0;r=2}}if(t.getTilesLoading()<o){t.reprioritize();t.loadMoreTiles(o,r)}}var n,a,l=this.postRenderFunctions_;for(n=0,a=l.length;a>n;++n)l[n](this,e);l.length=0};ol.Map.prototype.handleSizeChanged_=function(){this.render()};ol.Map.prototype.handleTargetChanged_=function(){var e;this.getTarget()&&(e=this.getTargetElement());if(this.keyHandlerKeys_){for(var t=0,o=this.keyHandlerKeys_.length;o>t;++t)ol.events.unlistenByKey(this.keyHandlerKeys_[t]);this.keyHandlerKeys_=null}if(e){e.appendChild(this.viewport_);var r=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.keyHandlerKeys_=[ol.events.listen(r,ol.events.EventType.KEYDOWN,this.handleBrowserEvent,this),ol.events.listen(r,ol.events.EventType.KEYPRESS,this.handleBrowserEvent,this)];if(!this.handleResize_){this.handleResize_=this.updateSize.bind(this);window.addEventListener(ol.events.EventType.RESIZE,this.handleResize_,!1)}}else{ol.dom.removeNode(this.viewport_);if(void 0!==this.handleResize_){window.removeEventListener(ol.events.EventType.RESIZE,this.handleResize_,!1);this.handleResize_=void 0}}this.updateSize()};ol.Map.prototype.handleTileChange_=function(){this.render()};ol.Map.prototype.handleViewPropertyChanged_=function(){this.render()};ol.Map.prototype.handleViewChanged_=function(){if(this.viewPropertyListenerKey_){ol.events.unlistenByKey(this.viewPropertyListenerKey_);this.viewPropertyListenerKey_=null}if(this.viewChangeListenerKey_){ol.events.unlistenByKey(this.viewChangeListenerKey_);this.viewChangeListenerKey_=null}var e=this.getView();if(e){this.viewport_.setAttribute("data-view",ol.getUid(e));this.viewPropertyListenerKey_=ol.events.listen(e,ol.ObjectEventType.PROPERTYCHANGE,this.handleViewPropertyChanged_,this);this.viewChangeListenerKey_=ol.events.listen(e,ol.events.EventType.CHANGE,this.handleViewPropertyChanged_,this)}this.render()};ol.Map.prototype.handleLayerGroupChanged_=function(){if(this.layerGroupPropertyListenerKeys_){this.layerGroupPropertyListenerKeys_.forEach(ol.events.unlistenByKey);this.layerGroupPropertyListenerKeys_=null}var e=this.getLayerGroup();e&&(this.layerGroupPropertyListenerKeys_=[ol.events.listen(e,ol.ObjectEventType.PROPERTYCHANGE,this.render,this),ol.events.listen(e,ol.events.EventType.CHANGE,this.render,this)]);this.render()};ol.Map.prototype.isRendered=function(){return!!this.frameState_};ol.Map.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_);this.animationDelay_()};ol.Map.prototype.render=function(){void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))};ol.Map.prototype.removeControl=function(e){return this.getControls().remove(e)};ol.Map.prototype.removeInteraction=function(e){return this.getInteractions().remove(e)};ol.Map.prototype.removeLayer=function(e){var t=this.getLayerGroup().getLayers();return t.remove(e)};ol.Map.prototype.removeOverlay=function(e){return this.getOverlays().remove(e)};ol.Map.prototype.renderFrame_=function(e){var t,o,r,i=this.getSize(),n=this.getView(),a=ol.extent.createEmpty(),l=null;if(void 0!==i&&ol.size.hasArea(i)&&n&&n.isDef()){var s=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),p=this.getLayerGroup().getLayerStatesArray(),c={};for(t=0,o=p.length;o>t;++t)c[ol.getUid(p[t].layer)]=p[t];r=n.getState();l={animate:!1,attributions:{},coordinateToPixelTransform:this.coordinateToPixelTransform_,extent:a,focus:this.focus_?this.focus_:r.center,index:this.frameIndex_++,layerStates:c,layerStatesArray:p,logos:ol.obj.assign({},this.logos_),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:i,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:r,viewHints:s,wantedTiles:{}}}l&&(l.extent=ol.extent.getForViewAndSize(r.center,r.resolution,r.rotation,l.size,a));this.frameState_=l;this.renderer_.renderFrame(l);if(l){l.animate&&this.render();Array.prototype.push.apply(this.postRenderFunctions_,l.postRenderFunctions);var u=!l.viewHints[ol.ViewHint.ANIMATING]&&!l.viewHints[ol.ViewHint.INTERACTING]&&!ol.extent.equals(l.extent,this.previousExtent_);if(u){this.dispatchEvent(new ol.MapEvent(ol.MapEventType.MOVEEND,this,l));ol.extent.clone(l.extent,this.previousExtent_)}}this.dispatchEvent(new ol.MapEvent(ol.MapEventType.POSTRENDER,this,l));setTimeout(this.handlePostRender.bind(this),0)};ol.Map.prototype.setLayerGroup=function(e){this.set(ol.MapProperty.LAYERGROUP,e)};ol.Map.prototype.setSize=function(e){this.set(ol.MapProperty.SIZE,e)};ol.Map.prototype.setTarget=function(e){this.set(ol.MapProperty.TARGET,e)};ol.Map.prototype.setView=function(e){this.set(ol.MapProperty.VIEW,e)};ol.Map.prototype.skipFeature=function(e){var t=ol.getUid(e).toString();this.skippedFeatureUids_[t]=!0;this.render()};ol.Map.prototype.updateSize=function(){var e=this.getTargetElement();if(e){var t=getComputedStyle(e);this.setSize([e.offsetWidth-parseFloat(t.borderLeftWidth)-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)-parseFloat(t.borderRightWidth),e.offsetHeight-parseFloat(t.borderTopWidth)-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom)-parseFloat(t.borderBottomWidth)])}else this.setSize(void 0)};ol.Map.prototype.unskipFeature=function(e){var t=ol.getUid(e).toString();delete this.skippedFeatureUids_[t];this.render()};ol.Map.createOptionsInternal=function(e){var t=null;void 0!==e.keyboardEventTarget&&(t="string"==typeof e.keyboardEventTarget?document.getElementById(e.keyboardEventTarget):e.keyboardEventTarget);var o={},r={};if(void 0===e.logo||"boolean"==typeof e.logo&&e.logo)r[ol.OL_LOGO_URL]=ol.OL_URL;else{var i=e.logo;if("string"==typeof i)r[i]="";else if(i instanceof HTMLElement)r[ol.getUid(i).toString()]=i;else if(i){ol.asserts.assert("string"==typeof i.href,44);ol.asserts.assert("string"==typeof i.src,45);r[i.src]=i.href}}var n=e.layers instanceof ol.layer.Group?e.layers:new ol.layer.Group({layers:e.layers});o[ol.MapProperty.LAYERGROUP]=n;o[ol.MapProperty.TARGET]=e.target;o[ol.MapProperty.VIEW]=void 0!==e.view?e.view:new ol.View;var a,l=ol.renderer.Map;if(void 0!==e.renderer){Array.isArray(e.renderer)?a=e.renderer:"string"==typeof e.renderer?a=[e.renderer]:ol.asserts.assert(!1,46);a.indexOf("dom")>=0&&(a=a.concat(ol.DEFAULT_RENDERER_TYPES))}else a=ol.DEFAULT_RENDERER_TYPES;var s,p;for(s=0,p=a.length;p>s;++s){var c=a[s];if(ol.ENABLE_CANVAS&&c==ol.renderer.Type.CANVAS){if(ol.has.CANVAS){l=ol.renderer.canvas.Map;break}}else if(ol.ENABLE_WEBGL&&c==ol.renderer.Type.WEBGL&&ol.has.WEBGL){l=ol.renderer.webgl.Map;break}}var u;if(void 0!==e.controls)if(Array.isArray(e.controls))u=new ol.Collection(e.controls.slice());else{ol.asserts.assert(e.controls instanceof ol.Collection,47);u=e.controls}else u=ol.control.defaults();var g;if(void 0!==e.interactions)if(Array.isArray(e.interactions))g=new ol.Collection(e.interactions.slice());else{ol.asserts.assert(e.interactions instanceof ol.Collection,48);g=e.interactions}else g=ol.interaction.defaults();var d;if(void 0!==e.overlays)if(Array.isArray(e.overlays))d=new ol.Collection(e.overlays.slice());else{ol.asserts.assert(e.overlays instanceof ol.Collection,49);d=e.overlays}else d=new ol.Collection;return{controls:u,interactions:g,keyboardEventTarget:t,logos:r,overlays:d,rendererConstructor:l,values:o}};goog.provide("ol.OverlayPositioning");ol.OverlayPositioning={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"};goog.provide("ol.Overlay");goog.require("ol");goog.require("ol.MapEventType");goog.require("ol.Object");goog.require("ol.OverlayPositioning");goog.require("ol.dom");goog.require("ol.events");goog.require("ol.extent");ol.Overlay=function(e){ol.Object.call(this);this.id_=e.id;this.insertFirst_=void 0!==e.insertFirst?e.insertFirst:!0;this.stopEvent_=void 0!==e.stopEvent?e.stopEvent:!0;this.element_=document.createElement("DIV");this.element_.className="ol-overlay-container";this.element_.style.position="absolute";this.autoPan=void 0!==e.autoPan?e.autoPan:!1;this.autoPanAnimation_=e.autoPanAnimation||{};this.autoPanMargin_=void 0!==e.autoPanMargin?e.autoPanMargin:20;this.rendered_={bottom_:"",left_:"",right_:"",top_:"",visible:!0};this.mapPostrenderListenerKey_=null;ol.events.listen(this,ol.Object.getChangeEventType(ol.Overlay.Property_.ELEMENT),this.handleElementChanged,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.Overlay.Property_.MAP),this.handleMapChanged,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.Overlay.Property_.OFFSET),this.handleOffsetChanged,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.Overlay.Property_.POSITION),this.handlePositionChanged,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.Overlay.Property_.POSITIONING),this.handlePositioningChanged,this);void 0!==e.element&&this.setElement(e.element);this.setOffset(void 0!==e.offset?e.offset:[0,0]);this.setPositioning(void 0!==e.positioning?e.positioning:ol.OverlayPositioning.TOP_LEFT);void 0!==e.position&&this.setPosition(e.position)};ol.inherits(ol.Overlay,ol.Object);ol.Overlay.prototype.getElement=function(){return this.get(ol.Overlay.Property_.ELEMENT)};ol.Overlay.prototype.getId=function(){return this.id_};ol.Overlay.prototype.getMap=function(){return this.get(ol.Overlay.Property_.MAP)};ol.Overlay.prototype.getOffset=function(){return this.get(ol.Overlay.Property_.OFFSET)};ol.Overlay.prototype.getPosition=function(){return this.get(ol.Overlay.Property_.POSITION)};ol.Overlay.prototype.getPositioning=function(){return this.get(ol.Overlay.Property_.POSITIONING)};ol.Overlay.prototype.handleElementChanged=function(){ol.dom.removeChildren(this.element_);var e=this.getElement();e&&this.element_.appendChild(e)};ol.Overlay.prototype.handleMapChanged=function(){if(this.mapPostrenderListenerKey_){ol.dom.removeNode(this.element_);ol.events.unlistenByKey(this.mapPostrenderListenerKey_);this.mapPostrenderListenerKey_=null}var e=this.getMap();if(e){this.mapPostrenderListenerKey_=ol.events.listen(e,ol.MapEventType.POSTRENDER,this.render,this);this.updatePixelPosition();var t=this.stopEvent_?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst_?t.insertBefore(this.element_,t.childNodes[0]||null):t.appendChild(this.element_)}};ol.Overlay.prototype.render=function(){this.updatePixelPosition()};ol.Overlay.prototype.handleOffsetChanged=function(){this.updatePixelPosition()};ol.Overlay.prototype.handlePositionChanged=function(){this.updatePixelPosition();this.get(ol.Overlay.Property_.POSITION)&&this.autoPan&&this.panIntoView_()};ol.Overlay.prototype.handlePositioningChanged=function(){this.updatePixelPosition()};ol.Overlay.prototype.setElement=function(e){this.set(ol.Overlay.Property_.ELEMENT,e)};ol.Overlay.prototype.setMap=function(e){this.set(ol.Overlay.Property_.MAP,e)};ol.Overlay.prototype.setOffset=function(e){this.set(ol.Overlay.Property_.OFFSET,e)};ol.Overlay.prototype.setPosition=function(e){this.set(ol.Overlay.Property_.POSITION,e)};ol.Overlay.prototype.panIntoView_=function(){var e=this.getMap();if(e&&e.getTargetElement()){var t=this.getRect_(e.getTargetElement(),e.getSize()),o=this.getElement(),r=this.getRect_(o,[ol.dom.outerWidth(o),ol.dom.outerHeight(o)]),i=this.autoPanMargin_;if(!ol.extent.containsExtent(t,r)){var n=r[0]-t[0],a=t[2]-r[2],l=r[1]-t[1],s=t[3]-r[3],p=[0,0];0>n?p[0]=n-i:0>a&&(p[0]=Math.abs(a)+i);0>l?p[1]=l-i:0>s&&(p[1]=Math.abs(s)+i);if(0!==p[0]||0!==p[1]){var c=e.getView().getCenter(),u=e.getPixelFromCoordinate(c),g=[u[0]+p[0],u[1]+p[1]];e.getView().animate({center:e.getCoordinateFromPixel(g),duration:this.autoPanAnimation_.duration,easing:this.autoPanAnimation_.easing})}}}};ol.Overlay.prototype.getRect_=function(e,t){var o=e.getBoundingClientRect(),r=o.left+window.pageXOffset,i=o.top+window.pageYOffset;return[r,i,r+t[0],i+t[1]]};ol.Overlay.prototype.setPositioning=function(e){this.set(ol.Overlay.Property_.POSITIONING,e)};ol.Overlay.prototype.setVisible=function(e){if(this.rendered_.visible!==e){this.element_.style.display=e?"":"none";this.rendered_.visible=e}};ol.Overlay.prototype.updatePixelPosition=function(){var e=this.getMap(),t=this.getPosition();if(e&&e.isRendered()&&t){var o=e.getPixelFromCoordinate(t),r=e.getSize();this.updateRenderedPosition(o,r)}else this.setVisible(!1)};ol.Overlay.prototype.updateRenderedPosition=function(e,t){var o=this.element_.style,r=this.getOffset(),i=this.getPositioning();this.setVisible(!0);var n=r[0],a=r[1];if(i==ol.OverlayPositioning.BOTTOM_RIGHT||i==ol.OverlayPositioning.CENTER_RIGHT||i==ol.OverlayPositioning.TOP_RIGHT){""!==this.rendered_.left_&&(this.rendered_.left_=o.left="");var l=Math.round(t[0]-e[0]-n)+"px";this.rendered_.right_!=l&&(this.rendered_.right_=o.right=l)}else{""!==this.rendered_.right_&&(this.rendered_.right_=o.right="");(i==ol.OverlayPositioning.BOTTOM_CENTER||i==ol.OverlayPositioning.CENTER_CENTER||i==ol.OverlayPositioning.TOP_CENTER)&&(n-=this.element_.offsetWidth/2);var s=Math.round(e[0]+n)+"px";this.rendered_.left_!=s&&(this.rendered_.left_=o.left=s)}if(i==ol.OverlayPositioning.BOTTOM_LEFT||i==ol.OverlayPositioning.BOTTOM_CENTER||i==ol.OverlayPositioning.BOTTOM_RIGHT){""!==this.rendered_.top_&&(this.rendered_.top_=o.top="");var p=Math.round(t[1]-e[1]-a)+"px";this.rendered_.bottom_!=p&&(this.rendered_.bottom_=o.bottom=p)}else{""!==this.rendered_.bottom_&&(this.rendered_.bottom_=o.bottom="");(i==ol.OverlayPositioning.CENTER_LEFT||i==ol.OverlayPositioning.CENTER_CENTER||i==ol.OverlayPositioning.CENTER_RIGHT)&&(a-=this.element_.offsetHeight/2);var c=Math.round(e[1]+a)+"px";this.rendered_.top_!=c&&(this.rendered_.top_=o.top=c)}};ol.Overlay.Property_={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};goog.provide("ol.control.OverviewMap");goog.require("ol");goog.require("ol.Collection");goog.require("ol.Map");goog.require("ol.MapEventType");goog.require("ol.MapProperty");goog.require("ol.Object");goog.require("ol.ObjectEventType");goog.require("ol.Overlay");goog.require("ol.OverlayPositioning");goog.require("ol.ViewProperty");goog.require("ol.control.Control");goog.require("ol.coordinate");goog.require("ol.css");goog.require("ol.dom");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.extent");ol.control.OverviewMap=function(e){var t=e?e:{};this.collapsed_=void 0!==t.collapsed?t.collapsed:!0;this.collapsible_=void 0!==t.collapsible?t.collapsible:!0;this.collapsible_||(this.collapsed_=!1);var o=void 0!==t.className?t.className:"ol-overviewmap",r=void 0!==t.tipLabel?t.tipLabel:"Overview map",i=void 0!==t.collapseLabel?t.collapseLabel:"\xab";if("string"==typeof i){this.collapseLabel_=document.createElement("span");this.collapseLabel_.textContent=i}else this.collapseLabel_=i;var n=void 0!==t.label?t.label:"\xbb";if("string"==typeof n){this.label_=document.createElement("span");this.label_.textContent=n}else this.label_=n;var a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,l=document.createElement("button");l.setAttribute("type","button");l.title=r;l.appendChild(a);ol.events.listen(l,ol.events.EventType.CLICK,this.handleClick_,this);this.ovmapDiv_=document.createElement("DIV");this.ovmapDiv_.className="ol-overviewmap-map";this.ovmap_=new ol.Map({controls:new ol.Collection,interactions:new ol.Collection,view:t.view});var s=this.ovmap_;t.layers&&t.layers.forEach(function(e){s.addLayer(e)},this);var p=document.createElement("DIV");p.className="ol-overviewmap-box";p.style.boxSizing="border-box";this.boxOverlay_=new ol.Overlay({position:[0,0],positioning:ol.OverlayPositioning.BOTTOM_LEFT,element:p});this.ovmap_.addOverlay(this.boxOverlay_);var c=o+" "+ol.css.CLASS_UNSELECTABLE+" "+ol.css.CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" ol-collapsed":"")+(this.collapsible_?"":" ol-uncollapsible"),u=document.createElement("div");u.className=c;u.appendChild(this.ovmapDiv_);u.appendChild(l);var g=t.render?t.render:ol.control.OverviewMap.render;ol.control.Control.call(this,{element:u,render:g,target:t.target});var d=this,h=this.boxOverlay_,f=this.boxOverlay_.getElement(),y=function(e){return{clientX:e.clientX-f.offsetWidth/2,clientY:e.clientY+f.offsetHeight/2}},m=function(e){var t=s.getEventCoordinate(y(e));h.setPosition(t)},v=function(e){var t=s.getEventCoordinate(e);d.getMap().getView().setCenter(t);window.removeEventListener("mousemove",m);window.removeEventListener("mouseup",v)};f.addEventListener("mousedown",function(){window.addEventListener("mousemove",m);window.addEventListener("mouseup",v)})};ol.inherits(ol.control.OverviewMap,ol.control.Control);ol.control.OverviewMap.prototype.setMap=function(e){var t=this.getMap();if(e!==t){if(t){var o=t.getView();o&&this.unbindView_(o);this.ovmap_.setTarget(null)}ol.control.Control.prototype.setMap.call(this,e);if(e){this.ovmap_.setTarget(this.ovmapDiv_);this.listenerKeys.push(ol.events.listen(e,ol.ObjectEventType.PROPERTYCHANGE,this.handleMapPropertyChange_,this));0===this.ovmap_.getLayers().getLength()&&this.ovmap_.setLayerGroup(e.getLayerGroup());var r=e.getView();if(r){this.bindView_(r);if(r.isDef()){this.ovmap_.updateSize();this.resetExtent_()}}}}};ol.control.OverviewMap.prototype.handleMapPropertyChange_=function(e){if(e.key===ol.MapProperty.VIEW){var t=e.oldValue;t&&this.unbindView_(t);var o=this.getMap().getView();this.bindView_(o)}};ol.control.OverviewMap.prototype.bindView_=function(e){ol.events.listen(e,ol.Object.getChangeEventType(ol.ViewProperty.ROTATION),this.handleRotationChanged_,this)};ol.control.OverviewMap.prototype.unbindView_=function(e){ol.events.unlisten(e,ol.Object.getChangeEventType(ol.ViewProperty.ROTATION),this.handleRotationChanged_,this)};ol.control.OverviewMap.prototype.handleRotationChanged_=function(){this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())};ol.control.OverviewMap.render=function(e){this.validateExtent_();this.updateBox_()};ol.control.OverviewMap.prototype.validateExtent_=function(){var e=this.getMap(),t=this.ovmap_;if(e.isRendered()&&t.isRendered()){var o=e.getSize(),r=e.getView(),i=r.calculateExtent(o),n=t.getSize(),a=t.getView(),l=a.calculateExtent(n),s=t.getPixelFromCoordinate(ol.extent.getTopLeft(i)),p=t.getPixelFromCoordinate(ol.extent.getBottomRight(i)),c=Math.abs(s[0]-p[0]),u=Math.abs(s[1]-p[1]),g=n[0],d=n[1];

c<g*ol.OVERVIEWMAP_MIN_RATIO||u<d*ol.OVERVIEWMAP_MIN_RATIO||c>g*ol.OVERVIEWMAP_MAX_RATIO||u>d*ol.OVERVIEWMAP_MAX_RATIO?this.resetExtent_():ol.extent.containsExtent(l,i)||this.recenter_()}};ol.control.OverviewMap.prototype.resetExtent_=function(){if(0!==ol.OVERVIEWMAP_MAX_RATIO&&0!==ol.OVERVIEWMAP_MIN_RATIO){var e=this.getMap(),t=this.ovmap_,o=e.getSize(),r=e.getView(),i=r.calculateExtent(o),n=t.getView(),a=Math.log(ol.OVERVIEWMAP_MAX_RATIO/ol.OVERVIEWMAP_MIN_RATIO)/Math.LN2,l=1/(Math.pow(2,a/2)*ol.OVERVIEWMAP_MIN_RATIO);ol.extent.scaleFromCenter(i,l);n.fit(i)}};ol.control.OverviewMap.prototype.recenter_=function(){var e=this.getMap(),t=this.ovmap_,o=e.getView(),r=t.getView();r.setCenter(o.getCenter())};ol.control.OverviewMap.prototype.updateBox_=function(){var e=this.getMap(),t=this.ovmap_;if(e.isRendered()&&t.isRendered()){var o=e.getSize(),r=e.getView(),i=t.getView(),n=r.getRotation(),a=this.boxOverlay_,l=this.boxOverlay_.getElement(),s=r.calculateExtent(o),p=i.getResolution(),c=ol.extent.getBottomLeft(s),u=ol.extent.getTopRight(s),g=this.calculateCoordinateRotate_(n,c);a.setPosition(g);if(l){l.style.width=Math.abs((c[0]-u[0])/p)+"px";l.style.height=Math.abs((u[1]-c[1])/p)+"px"}}};ol.control.OverviewMap.prototype.calculateCoordinateRotate_=function(e,t){var o,r=this.getMap(),i=r.getView(),n=i.getCenter();if(n){o=[t[0]-n[0],t[1]-n[1]];ol.coordinate.rotate(o,e);ol.coordinate.add(o,n)}return o};ol.control.OverviewMap.prototype.handleClick_=function(e){e.preventDefault();this.handleToggle_()};ol.control.OverviewMap.prototype.handleToggle_=function(){this.element.classList.toggle("ol-collapsed");this.collapsed_?ol.dom.replaceNode(this.collapseLabel_,this.label_):ol.dom.replaceNode(this.label_,this.collapseLabel_);this.collapsed_=!this.collapsed_;var e=this.ovmap_;if(!this.collapsed_&&!e.isRendered()){e.updateSize();this.resetExtent_();ol.events.listenOnce(e,ol.MapEventType.POSTRENDER,function(e){this.updateBox_()},this)}};ol.control.OverviewMap.prototype.getCollapsible=function(){return this.collapsible_};ol.control.OverviewMap.prototype.setCollapsible=function(e){if(this.collapsible_!==e){this.collapsible_=e;this.element.classList.toggle("ol-uncollapsible");!e&&this.collapsed_&&this.handleToggle_()}};ol.control.OverviewMap.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()};ol.control.OverviewMap.prototype.getCollapsed=function(){return this.collapsed_};ol.control.OverviewMap.prototype.getOverviewMap=function(){return this.ovmap_};goog.provide("ol.control.ScaleLineUnits");ol.control.ScaleLineUnits={DEGREES:"degrees",IMPERIAL:"imperial",NAUTICAL:"nautical",METRIC:"metric",US:"us"};goog.provide("ol.control.ScaleLine");goog.require("ol");goog.require("ol.Object");goog.require("ol.asserts");goog.require("ol.control.Control");goog.require("ol.control.ScaleLineUnits");goog.require("ol.css");goog.require("ol.events");goog.require("ol.proj");goog.require("ol.proj.Units");ol.control.ScaleLine=function(e){var t=e?e:{},o=void 0!==t.className?t.className:"ol-scale-line";this.innerElement_=document.createElement("DIV");this.innerElement_.className=o+"-inner";this.element_=document.createElement("DIV");this.element_.className=o+" "+ol.css.CLASS_UNSELECTABLE;this.element_.appendChild(this.innerElement_);this.viewState_=null;this.minWidth_=void 0!==t.minWidth?t.minWidth:64;this.renderedVisible_=!1;this.renderedWidth_=void 0;this.renderedHTML_="";var r=t.render?t.render:ol.control.ScaleLine.render;ol.control.Control.call(this,{element:this.element_,render:r,target:t.target});ol.events.listen(this,ol.Object.getChangeEventType(ol.control.ScaleLine.Property_.UNITS),this.handleUnitsChanged_,this);this.setUnits(t.units||ol.control.ScaleLineUnits.METRIC)};ol.inherits(ol.control.ScaleLine,ol.control.Control);ol.control.ScaleLine.LEADING_DIGITS=[1,2,5];ol.control.ScaleLine.prototype.getUnits=function(){return this.get(ol.control.ScaleLine.Property_.UNITS)};ol.control.ScaleLine.render=function(e){var t=e.frameState;this.viewState_=t?t.viewState:null;this.updateElement_()};ol.control.ScaleLine.prototype.handleUnitsChanged_=function(){this.updateElement_()};ol.control.ScaleLine.prototype.setUnits=function(e){this.set(ol.control.ScaleLine.Property_.UNITS,e)};ol.control.ScaleLine.prototype.updateElement_=function(){var e=this.viewState_;if(e){var t=e.center,o=e.projection,r=o.getMetersPerUnit(),i=ol.proj.getPointResolution(o,e.resolution,t)*r,n=this.minWidth_*i,a="",l=this.getUnits();if(l==ol.control.ScaleLineUnits.DEGREES){var s=ol.proj.METERS_PER_UNIT[ol.proj.Units.DEGREES];i/=s;if(s/60>n){a="\u2033";i*=3600}else if(s>n){a="\u2032";i*=60}else a="\xb0"}else if(l==ol.control.ScaleLineUnits.IMPERIAL)if(.9144>n){a="in";i/=.0254}else if(1609.344>n){a="ft";i/=.3048}else{a="mi";i/=1609.344}else if(l==ol.control.ScaleLineUnits.NAUTICAL){i/=1852;a="nm"}else if(l==ol.control.ScaleLineUnits.METRIC)if(.001>n){a="\u03bcm";i*=1e6}else if(1>n){a="mm";i*=1e3}else if(1e3>n)a="m";else{a="km";i/=1e3}else if(l==ol.control.ScaleLineUnits.US)if(.9144>n){a="in";i*=39.37}else if(1609.344>n){a="ft";i/=.30480061}else{a="mi";i/=1609.3472}else ol.asserts.assert(!1,33);for(var p,c,u=3*Math.floor(Math.log(this.minWidth_*i)/Math.log(10));;){p=ol.control.ScaleLine.LEADING_DIGITS[(u%3+3)%3]*Math.pow(10,Math.floor(u/3));c=Math.round(p/i);if(isNaN(c)){this.element_.style.display="none";this.renderedVisible_=!1;return}if(c>=this.minWidth_)break;++u}var g=p+" "+a;if(this.renderedHTML_!=g){this.innerElement_.innerHTML=g;this.renderedHTML_=g}if(this.renderedWidth_!=c){this.innerElement_.style.width=c+"px";this.renderedWidth_=c}if(!this.renderedVisible_){this.element_.style.display="";this.renderedVisible_=!0}}else if(this.renderedVisible_){this.element_.style.display="none";this.renderedVisible_=!1}};ol.control.ScaleLine.Property_={UNITS:"units"};goog.provide("ol.control.ZoomSlider");goog.require("ol");goog.require("ol.ViewHint");goog.require("ol.control.Control");goog.require("ol.css");goog.require("ol.easing");goog.require("ol.events");goog.require("ol.events.Event");goog.require("ol.events.EventType");goog.require("ol.math");goog.require("ol.pointer.EventType");goog.require("ol.pointer.PointerEventHandler");ol.control.ZoomSlider=function(e){var t=e?e:{};this.currentResolution_=void 0;this.direction_=ol.control.ZoomSlider.Direction_.VERTICAL;this.dragging_;this.heightLimit_=0;this.widthLimit_=0;this.previousX_;this.previousY_;this.thumbSize_=null;this.sliderInitialized_=!1;this.duration_=void 0!==t.duration?t.duration:200;var o=void 0!==t.className?t.className:"ol-zoomslider",r=document.createElement("button");r.setAttribute("type","button");r.className=o+"-thumb "+ol.css.CLASS_UNSELECTABLE;var i=document.createElement("div");i.className=o+" "+ol.css.CLASS_UNSELECTABLE+" "+ol.css.CLASS_CONTROL;i.appendChild(r);this.dragger_=new ol.pointer.PointerEventHandler(i);ol.events.listen(this.dragger_,ol.pointer.EventType.POINTERDOWN,this.handleDraggerStart_,this);ol.events.listen(this.dragger_,ol.pointer.EventType.POINTERMOVE,this.handleDraggerDrag_,this);ol.events.listen(this.dragger_,ol.pointer.EventType.POINTERUP,this.handleDraggerEnd_,this);ol.events.listen(i,ol.events.EventType.CLICK,this.handleContainerClick_,this);ol.events.listen(r,ol.events.EventType.CLICK,ol.events.Event.stopPropagation);var n=t.render?t.render:ol.control.ZoomSlider.render;ol.control.Control.call(this,{element:i,render:n})};ol.inherits(ol.control.ZoomSlider,ol.control.Control);ol.control.ZoomSlider.prototype.disposeInternal=function(){this.dragger_.dispose();ol.control.Control.prototype.disposeInternal.call(this)};ol.control.ZoomSlider.Direction_={VERTICAL:0,HORIZONTAL:1};ol.control.ZoomSlider.prototype.setMap=function(e){ol.control.Control.prototype.setMap.call(this,e);e&&e.render()};ol.control.ZoomSlider.prototype.initSlider_=function(){var e=this.element,t={width:e.offsetWidth,height:e.offsetHeight},o=e.firstElementChild,r=getComputedStyle(o),i=o.offsetWidth+parseFloat(r.marginRight)+parseFloat(r.marginLeft),n=o.offsetHeight+parseFloat(r.marginTop)+parseFloat(r.marginBottom);this.thumbSize_=[i,n];if(t.width>t.height){this.direction_=ol.control.ZoomSlider.Direction_.HORIZONTAL;this.widthLimit_=t.width-i}else{this.direction_=ol.control.ZoomSlider.Direction_.VERTICAL;this.heightLimit_=t.height-n}this.sliderInitialized_=!0};ol.control.ZoomSlider.render=function(e){if(e.frameState){this.sliderInitialized_||this.initSlider_();var t=e.frameState.viewState.resolution;if(t!==this.currentResolution_){this.currentResolution_=t;this.setThumbPosition_(t)}}};ol.control.ZoomSlider.prototype.handleContainerClick_=function(e){var t=this.getMap().getView(),o=this.getRelativePosition_(e.offsetX-this.thumbSize_[0]/2,e.offsetY-this.thumbSize_[1]/2),r=this.getResolutionForPosition_(o);t.animate({resolution:t.constrainResolution(r),duration:this.duration_,easing:ol.easing.easeOut})};ol.control.ZoomSlider.prototype.handleDraggerStart_=function(e){if(!this.dragging_&&e.originalEvent.target===this.element.firstElementChild){this.getMap().getView().setHint(ol.ViewHint.INTERACTING,1);this.previousX_=e.clientX;this.previousY_=e.clientY;this.dragging_=!0}};ol.control.ZoomSlider.prototype.handleDraggerDrag_=function(e){if(this.dragging_){var t=this.element.firstElementChild,o=e.clientX-this.previousX_+parseInt(t.style.left,10),r=e.clientY-this.previousY_+parseInt(t.style.top,10),i=this.getRelativePosition_(o,r);this.currentResolution_=this.getResolutionForPosition_(i);this.getMap().getView().setResolution(this.currentResolution_);this.setThumbPosition_(this.currentResolution_);this.previousX_=e.clientX;this.previousY_=e.clientY}};ol.control.ZoomSlider.prototype.handleDraggerEnd_=function(e){if(this.dragging_){var t=this.getMap().getView();t.setHint(ol.ViewHint.INTERACTING,-1);t.animate({resolution:t.constrainResolution(this.currentResolution_),duration:this.duration_,easing:ol.easing.easeOut});this.dragging_=!1;this.previousX_=void 0;this.previousY_=void 0}};ol.control.ZoomSlider.prototype.setThumbPosition_=function(e){var t=this.getPositionForResolution_(e),o=this.element.firstElementChild;this.direction_==ol.control.ZoomSlider.Direction_.HORIZONTAL?o.style.left=this.widthLimit_*t+"px":o.style.top=this.heightLimit_*t+"px"};ol.control.ZoomSlider.prototype.getRelativePosition_=function(e,t){var o;o=this.direction_===ol.control.ZoomSlider.Direction_.HORIZONTAL?e/this.widthLimit_:t/this.heightLimit_;return ol.math.clamp(o,0,1)};ol.control.ZoomSlider.prototype.getResolutionForPosition_=function(e){var t=this.getMap().getView().getResolutionForValueFunction();return t(1-e)};ol.control.ZoomSlider.prototype.getPositionForResolution_=function(e){var t=this.getMap().getView().getValueForResolutionFunction();return 1-t(e)};goog.provide("ol.control.ZoomToExtent");goog.require("ol");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.control.Control");goog.require("ol.css");ol.control.ZoomToExtent=function(e){var t=e?e:{};this.extent_=t.extent?t.extent:null;var o=void 0!==t.className?t.className:"ol-zoom-extent",r=void 0!==t.label?t.label:"E",i=void 0!==t.tipLabel?t.tipLabel:"Fit to extent",n=document.createElement("button");n.setAttribute("type","button");n.title=i;n.appendChild("string"==typeof r?document.createTextNode(r):r);ol.events.listen(n,ol.events.EventType.CLICK,this.handleClick_,this);var a=o+" "+ol.css.CLASS_UNSELECTABLE+" "+ol.css.CLASS_CONTROL,l=document.createElement("div");l.className=a;l.appendChild(n);ol.control.Control.call(this,{element:l,target:t.target})};ol.inherits(ol.control.ZoomToExtent,ol.control.Control);ol.control.ZoomToExtent.prototype.handleClick_=function(e){e.preventDefault();this.handleZoomToExtent_()};ol.control.ZoomToExtent.prototype.handleZoomToExtent_=function(){var e=this.getMap(),t=e.getView(),o=this.extent_?this.extent_:t.getProjection().getExtent();t.fit(o)};goog.provide("ol.DeviceOrientation");goog.require("ol.events");goog.require("ol");goog.require("ol.Object");goog.require("ol.has");goog.require("ol.math");ol.DeviceOrientation=function(e){ol.Object.call(this);var t=e?e:{};this.listenerKey_=null;ol.events.listen(this,ol.Object.getChangeEventType(ol.DeviceOrientation.Property_.TRACKING),this.handleTrackingChanged_,this);this.setTracking(void 0!==t.tracking?t.tracking:!1)};ol.inherits(ol.DeviceOrientation,ol.Object);ol.DeviceOrientation.prototype.disposeInternal=function(){this.setTracking(!1);ol.Object.prototype.disposeInternal.call(this)};ol.DeviceOrientation.prototype.orientationChange_=function(e){var t=e;if(null!==t.alpha){var o=ol.math.toRadians(t.alpha);this.set(ol.DeviceOrientation.Property_.ALPHA,o);if("boolean"==typeof t.absolute&&t.absolute)this.set(ol.DeviceOrientation.Property_.HEADING,o);else if("number"==typeof t.webkitCompassHeading&&-1!=t.webkitCompassAccuracy){var r=ol.math.toRadians(t.webkitCompassHeading);this.set(ol.DeviceOrientation.Property_.HEADING,r)}}null!==t.beta&&this.set(ol.DeviceOrientation.Property_.BETA,ol.math.toRadians(t.beta));null!==t.gamma&&this.set(ol.DeviceOrientation.Property_.GAMMA,ol.math.toRadians(t.gamma));this.changed()};ol.DeviceOrientation.prototype.getAlpha=function(){return this.get(ol.DeviceOrientation.Property_.ALPHA)};ol.DeviceOrientation.prototype.getBeta=function(){return this.get(ol.DeviceOrientation.Property_.BETA)};ol.DeviceOrientation.prototype.getGamma=function(){return this.get(ol.DeviceOrientation.Property_.GAMMA)};ol.DeviceOrientation.prototype.getHeading=function(){return this.get(ol.DeviceOrientation.Property_.HEADING)};ol.DeviceOrientation.prototype.getTracking=function(){return this.get(ol.DeviceOrientation.Property_.TRACKING)};ol.DeviceOrientation.prototype.handleTrackingChanged_=function(){if(ol.has.DEVICE_ORIENTATION){var e=this.getTracking();if(e&&!this.listenerKey_)this.listenerKey_=ol.events.listen(window,"deviceorientation",this.orientationChange_,this);else if(!e&&null!==this.listenerKey_){ol.events.unlistenByKey(this.listenerKey_);this.listenerKey_=null}}};ol.DeviceOrientation.prototype.setTracking=function(e){this.set(ol.DeviceOrientation.Property_.TRACKING,e)};ol.DeviceOrientation.Property_={ALPHA:"alpha",BETA:"beta",GAMMA:"gamma",HEADING:"heading",TRACKING:"tracking"};goog.provide("ol.ImageState");ol.ImageState={IDLE:0,LOADING:1,LOADED:2,ERROR:3};goog.provide("ol.style.Image");ol.style.Image=function(e){this.opacity_=e.opacity;this.rotateWithView_=e.rotateWithView;this.rotation_=e.rotation;this.scale_=e.scale;this.snapToPixel_=e.snapToPixel};ol.style.Image.prototype.getOpacity=function(){return this.opacity_};ol.style.Image.prototype.getRotateWithView=function(){return this.rotateWithView_};ol.style.Image.prototype.getRotation=function(){return this.rotation_};ol.style.Image.prototype.getScale=function(){return this.scale_};ol.style.Image.prototype.getSnapToPixel=function(){return this.snapToPixel_};ol.style.Image.prototype.getAnchor=function(){};ol.style.Image.prototype.getImage=function(e){};ol.style.Image.prototype.getHitDetectionImage=function(e){};ol.style.Image.prototype.getImageState=function(){};ol.style.Image.prototype.getImageSize=function(){};ol.style.Image.prototype.getHitDetectionImageSize=function(){};ol.style.Image.prototype.getOrigin=function(){};ol.style.Image.prototype.getSize=function(){};ol.style.Image.prototype.setOpacity=function(e){this.opacity_=e};ol.style.Image.prototype.setRotateWithView=function(e){this.rotateWithView_=e};ol.style.Image.prototype.setRotation=function(e){this.rotation_=e};ol.style.Image.prototype.setScale=function(e){this.scale_=e};ol.style.Image.prototype.setSnapToPixel=function(e){this.snapToPixel_=e};ol.style.Image.prototype.listenImageChange=function(e,t){};ol.style.Image.prototype.load=function(){};ol.style.Image.prototype.unlistenImageChange=function(e,t){};goog.provide("ol.style.RegularShape");goog.require("ol");goog.require("ol.colorlike");goog.require("ol.dom");goog.require("ol.has");goog.require("ol.ImageState");goog.require("ol.render.canvas");goog.require("ol.style.Image");ol.style.RegularShape=function(e){this.checksums_=null;this.canvas_=null;this.hitDetectionCanvas_=null;this.fill_=void 0!==e.fill?e.fill:null;this.origin_=[0,0];this.points_=e.points;this.radius_=void 0!==e.radius?e.radius:e.radius1;this.radius2_=void 0!==e.radius2?e.radius2:this.radius_;this.angle_=void 0!==e.angle?e.angle:0;this.stroke_=void 0!==e.stroke?e.stroke:null;this.anchor_=null;this.size_=null;this.imageSize_=null;this.hitDetectionImageSize_=null;this.atlasManager_=e.atlasManager;this.render_(this.atlasManager_);var t=void 0!==e.snapToPixel?e.snapToPixel:!0,o=void 0!==e.rotateWithView?e.rotateWithView:!1;ol.style.Image.call(this,{opacity:1,rotateWithView:o,rotation:void 0!==e.rotation?e.rotation:0,scale:1,snapToPixel:t})};ol.inherits(ol.style.RegularShape,ol.style.Image);ol.style.RegularShape.prototype.clone=function(){var e=new ol.style.RegularShape({fill:this.getFill()?this.getFill().clone():void 0,points:this.getRadius2()!==this.getRadius()?this.getPoints()/2:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),snapToPixel:this.getSnapToPixel(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});e.setOpacity(this.getOpacity());e.setScale(this.getScale());return e};ol.style.RegularShape.prototype.getAnchor=function(){return this.anchor_};ol.style.RegularShape.prototype.getAngle=function(){return this.angle_};ol.style.RegularShape.prototype.getFill=function(){return this.fill_};ol.style.RegularShape.prototype.getHitDetectionImage=function(e){return this.hitDetectionCanvas_};ol.style.RegularShape.prototype.getImage=function(e){return this.canvas_};ol.style.RegularShape.prototype.getImageSize=function(){return this.imageSize_};ol.style.RegularShape.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_};ol.style.RegularShape.prototype.getImageState=function(){return ol.ImageState.LOADED};ol.style.RegularShape.prototype.getOrigin=function(){return this.origin_};ol.style.RegularShape.prototype.getPoints=function(){return this.points_};ol.style.RegularShape.prototype.getRadius=function(){return this.radius_};ol.style.RegularShape.prototype.getRadius2=function(){return this.radius2_};ol.style.RegularShape.prototype.getSize=function(){return this.size_};ol.style.RegularShape.prototype.getStroke=function(){return this.stroke_};ol.style.RegularShape.prototype.listenImageChange=function(e,t){};ol.style.RegularShape.prototype.load=function(){};ol.style.RegularShape.prototype.unlistenImageChange=function(e,t){};ol.style.RegularShape.prototype.render_=function(e){var t,o,r="",i="",n=0,a=null,l=0;if(this.stroke_){o=this.stroke_.getColor();null===o&&(o=ol.render.canvas.defaultStrokeStyle);o=ol.colorlike.asColorLike(o);l=this.stroke_.getWidth();void 0===l&&(l=ol.render.canvas.defaultLineWidth);a=this.stroke_.getLineDash();ol.has.CANVAS_LINE_DASH||(a=null);i=this.stroke_.getLineJoin();void 0===i&&(i=ol.render.canvas.defaultLineJoin);r=this.stroke_.getLineCap();void 0===r&&(r=ol.render.canvas.defaultLineCap);n=this.stroke_.getMiterLimit();void 0===n&&(n=ol.render.canvas.defaultMiterLimit)}var s=2*(this.radius_+l)+1,p={strokeStyle:o,strokeWidth:l,size:s,lineCap:r,lineDash:a,lineJoin:i,miterLimit:n};if(void 0===e){var c=ol.dom.createCanvasContext2D(s,s);this.canvas_=c.canvas;s=this.canvas_.width;t=s;this.draw_(p,c,0,0);this.createHitDetectionCanvas_(p)}else{s=Math.round(s);var u,g=!this.fill_;g&&(u=this.drawHitDetectionCanvas_.bind(this,p));var d=this.getChecksum(),h=e.add(d,s,s,this.draw_.bind(this,p),u);this.canvas_=h.image;this.origin_=[h.offsetX,h.offsetY];t=h.image.width;if(g){this.hitDetectionCanvas_=h.hitImage;this.hitDetectionImageSize_=[h.hitImage.width,h.hitImage.height]}else{this.hitDetectionCanvas_=this.canvas_;this.hitDetectionImageSize_=[t,t]}}this.anchor_=[s/2,s/2];this.size_=[s,s];this.imageSize_=[t,t]};ol.style.RegularShape.prototype.draw_=function(e,t,o,r){var i,n,a;t.setTransform(1,0,0,1,0,0);t.translate(o,r);t.beginPath();if(this.points_===1/0)t.arc(e.size/2,e.size/2,this.radius_,0,2*Math.PI,!0);else{this.radius2_!==this.radius_&&(this.points_=2*this.points_);for(i=0;i<=this.points_;i++){n=2*i*Math.PI/this.points_-Math.PI/2+this.angle_;a=i%2===0?this.radius_:this.radius2_;t.lineTo(e.size/2+a*Math.cos(n),e.size/2+a*Math.sin(n))}}if(this.fill_){var l=this.fill_.getColor();null===l&&(l=ol.render.canvas.defaultFillStyle);t.fillStyle=ol.colorlike.asColorLike(l);t.fill()}if(this.stroke_){t.strokeStyle=e.strokeStyle;t.lineWidth=e.strokeWidth;e.lineDash&&t.setLineDash(e.lineDash);t.lineCap=e.lineCap;t.lineJoin=e.lineJoin;t.miterLimit=e.miterLimit;t.stroke()}t.closePath()};ol.style.RegularShape.prototype.createHitDetectionCanvas_=function(e){this.hitDetectionImageSize_=[e.size,e.size];if(this.fill_)this.hitDetectionCanvas_=this.canvas_;else{var t=ol.dom.createCanvasContext2D(e.size,e.size);this.hitDetectionCanvas_=t.canvas;this.drawHitDetectionCanvas_(e,t,0,0)}};ol.style.RegularShape.prototype.drawHitDetectionCanvas_=function(e,t,o,r){t.setTransform(1,0,0,1,0,0);t.translate(o,r);t.beginPath();if(this.points_===1/0)t.arc(e.size/2,e.size/2,this.radius_,0,2*Math.PI,!0);else{this.radius2_!==this.radius_&&(this.points_=2*this.points_);var i,n,a;for(i=0;i<=this.points_;i++){a=2*i*Math.PI/this.points_-Math.PI/2+this.angle_;n=i%2===0?this.radius_:this.radius2_;t.lineTo(e.size/2+n*Math.cos(a),e.size/2+n*Math.sin(a))}}t.fillStyle=ol.render.canvas.defaultFillStyle;t.fill();if(this.stroke_){t.strokeStyle=e.strokeStyle;t.lineWidth=e.strokeWidth;e.lineDash&&t.setLineDash(e.lineDash);t.stroke()}t.closePath()};ol.style.RegularShape.prototype.getChecksum=function(){var e=this.stroke_?this.stroke_.getChecksum():"-",t=this.fill_?this.fill_.getChecksum():"-",o=!this.checksums_||e!=this.checksums_[1]||t!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6];if(o){var r="r"+e+t+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[r,e,t,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]};goog.provide("ol.style.Circle");goog.require("ol");goog.require("ol.style.RegularShape");ol.style.Circle=function(e){var t=e||{};ol.style.RegularShape.call(this,{points:1/0,fill:t.fill,radius:t.radius,snapToPixel:t.snapToPixel,stroke:t.stroke,atlasManager:t.atlasManager})};ol.inherits(ol.style.Circle,ol.style.RegularShape);ol.style.Circle.prototype.clone=function(){var e=new ol.style.Circle({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),snapToPixel:this.getSnapToPixel(),atlasManager:this.atlasManager_});e.setOpacity(this.getOpacity());e.setScale(this.getScale());return e};ol.style.Circle.prototype.setRadius=function(e){this.radius_=e;this.render_(this.atlasManager_)};goog.provide("ol.style.Fill");goog.require("ol");goog.require("ol.color");ol.style.Fill=function(e){var t=e||{};this.color_=void 0!==t.color?t.color:null;this.checksum_=void 0};ol.style.Fill.prototype.clone=function(){var e=this.getColor();return new ol.style.Fill({color:e&&e.slice?e.slice():e||void 0})};ol.style.Fill.prototype.getColor=function(){return this.color_};ol.style.Fill.prototype.setColor=function(e){this.color_=e;this.checksum_=void 0};ol.style.Fill.prototype.getChecksum=function(){void 0===this.checksum_&&(this.checksum_=this.color_ instanceof CanvasPattern||this.color_ instanceof CanvasGradient?ol.getUid(this.color_).toString():"f"+(this.color_?ol.color.asString(this.color_):"-"));return this.checksum_};goog.provide("ol.style.Style");goog.require("ol.asserts");goog.require("ol.geom.GeometryType");goog.require("ol.style.Circle");goog.require("ol.style.Fill");goog.require("ol.style.Stroke");ol.style.Style=function(e){var t=e||{};this.geometry_=null;this.geometryFunction_=ol.style.Style.defaultGeometryFunction;void 0!==t.geometry&&this.setGeometry(t.geometry);this.fill_=void 0!==t.fill?t.fill:null;this.image_=void 0!==t.image?t.image:null;this.stroke_=void 0!==t.stroke?t.stroke:null;this.text_=void 0!==t.text?t.text:null;this.zIndex_=t.zIndex};ol.style.Style.prototype.clone=function(){var e=this.getGeometry();e&&e.clone&&(e=e.clone());return new ol.style.Style({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})};ol.style.Style.prototype.getGeometry=function(){return this.geometry_};ol.style.Style.prototype.getGeometryFunction=function(){return this.geometryFunction_};ol.style.Style.prototype.getFill=function(){return this.fill_};ol.style.Style.prototype.setFill=function(e){this.fill_=e};ol.style.Style.prototype.getImage=function(){return this.image_};ol.style.Style.prototype.setImage=function(e){this.image_=e};ol.style.Style.prototype.getStroke=function(){return this.stroke_};ol.style.Style.prototype.setStroke=function(e){this.stroke_=e};ol.style.Style.prototype.getText=function(){return this.text_};ol.style.Style.prototype.setText=function(e){this.text_=e};ol.style.Style.prototype.getZIndex=function(){return this.zIndex_};ol.style.Style.prototype.setGeometry=function(e){"function"==typeof e?this.geometryFunction_=e:"string"==typeof e?this.geometryFunction_=function(t){return t.get(e)}:e?void 0!==e&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=ol.style.Style.defaultGeometryFunction;this.geometry_=e};ol.style.Style.prototype.setZIndex=function(e){this.zIndex_=e};ol.style.Style.createFunction=function(e){var t;if("function"==typeof e)t=e;else{var o;if(Array.isArray(e))o=e;else{ol.asserts.assert(e instanceof ol.style.Style,41);o=[e]}t=function(){return o}}return t};ol.style.Style.default_=null;ol.style.Style.defaultFunction=function(e,t){if(!ol.style.Style.default_){var o=new ol.style.Fill({color:"rgba(255,255,255,0.4)"}),r=new ol.style.Stroke({color:"#3399CC",width:1.25});ol.style.Style.default_=[new ol.style.Style({image:new ol.style.Circle({fill:o,stroke:r,radius:5}),fill:o,stroke:r})]}return ol.style.Style.default_};ol.style.Style.createDefaultEditing=function(){var e={},t=[255,255,255,1],o=[0,153,255,1],r=3;e[ol.geom.GeometryType.POLYGON]=[new ol.style.Style({fill:new ol.style.Fill({color:[255,255,255,.5]})})];e[ol.geom.GeometryType.MULTI_POLYGON]=e[ol.geom.GeometryType.POLYGON];e[ol.geom.GeometryType.LINE_STRING]=[new ol.style.Style({stroke:new ol.style.Stroke({color:t,width:r+2})}),new ol.style.Style({stroke:new ol.style.Stroke({color:o,width:r})})];e[ol.geom.GeometryType.MULTI_LINE_STRING]=e[ol.geom.GeometryType.LINE_STRING];e[ol.geom.GeometryType.CIRCLE]=e[ol.geom.GeometryType.POLYGON].concat(e[ol.geom.GeometryType.LINE_STRING]);e[ol.geom.GeometryType.POINT]=[new ol.style.Style({image:new ol.style.Circle({radius:2*r,fill:new ol.style.Fill({color:o}),stroke:new ol.style.Stroke({color:t,width:r/2})}),zIndex:1/0})];e[ol.geom.GeometryType.MULTI_POINT]=e[ol.geom.GeometryType.POINT];e[ol.geom.GeometryType.GEOMETRY_COLLECTION]=e[ol.geom.GeometryType.POLYGON].concat(e[ol.geom.GeometryType.LINE_STRING],e[ol.geom.GeometryType.POINT]);return e};ol.style.Style.defaultGeometryFunction=function(e){return e.getGeometry()};goog.provide("ol.Feature");goog.require("ol.asserts");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol");goog.require("ol.Object");goog.require("ol.geom.Geometry");goog.require("ol.style.Style");ol.Feature=function(e){ol.Object.call(this);this.id_=void 0;this.geometryName_="geometry";this.style_=null;this.styleFunction_=void 0;this.geometryChangeKey_=null;ol.events.listen(this,ol.Object.getChangeEventType(this.geometryName_),this.handleGeometryChanged_,this);if(void 0!==e)if(e instanceof ol.geom.Geometry||!e){var t=e;this.setGeometry(t)}else{var o=e;this.setProperties(o)}};ol.inherits(ol.Feature,ol.Object);ol.Feature.prototype.clone=function(){var e=new ol.Feature(this.getProperties());e.setGeometryName(this.getGeometryName());var t=this.getGeometry();t&&e.setGeometry(t.clone());var o=this.getStyle();o&&e.setStyle(o);return e};ol.Feature.prototype.getGeometry=function(){return this.get(this.geometryName_)};ol.Feature.prototype.getId=function(){return this.id_};ol.Feature.prototype.getGeometryName=function(){return this.geometryName_};ol.Feature.prototype.getStyle=function(){return this.style_};ol.Feature.prototype.getStyleFunction=function(){return this.styleFunction_};ol.Feature.prototype.handleGeometryChange_=function(){this.changed()};ol.Feature.prototype.handleGeometryChanged_=function(){if(this.geometryChangeKey_){ol.events.unlistenByKey(this.geometryChangeKey_);this.geometryChangeKey_=null}var e=this.getGeometry();e&&(this.geometryChangeKey_=ol.events.listen(e,ol.events.EventType.CHANGE,this.handleGeometryChange_,this));this.changed()};ol.Feature.prototype.setGeometry=function(e){this.set(this.geometryName_,e)};ol.Feature.prototype.setStyle=function(e){this.style_=e;this.styleFunction_=e?ol.Feature.createStyleFunction(e):void 0;this.changed()};ol.Feature.prototype.setId=function(e){this.id_=e;this.changed()};ol.Feature.prototype.setGeometryName=function(e){ol.events.unlisten(this,ol.Object.getChangeEventType(this.geometryName_),this.handleGeometryChanged_,this);this.geometryName_=e;ol.events.listen(this,ol.Object.getChangeEventType(this.geometryName_),this.handleGeometryChanged_,this);this.handleGeometryChanged_()};ol.Feature.createStyleFunction=function(e){var t;if("function"==typeof e)t=2==e.length?function(t){return e(this,t)}:e;else{var o;if(Array.isArray(e))o=e;else{ol.asserts.assert(e instanceof ol.style.Style,41);o=[e]}t=function(){return o}}return t};goog.provide("ol.format.FormatType");ol.format.FormatType={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};goog.provide("ol.xml");goog.require("ol.array");ol.xml.DOCUMENT=document.implementation.createDocument("","",null);ol.xml.createElementNS=function(e,t){return ol.xml.DOCUMENT.createElementNS(e,t)};ol.xml.getAllTextContent=function(e,t){return ol.xml.getAllTextContent_(e,t,[]).join("")};ol.xml.getAllTextContent_=function(e,t,o){if(e.nodeType==Node.CDATA_SECTION_NODE||e.nodeType==Node.TEXT_NODE)o.push(t?String(e.nodeValue).replace(/(\r\n|\r|\n)/g,""):e.nodeValue);else{var r;for(r=e.firstChild;r;r=r.nextSibling)ol.xml.getAllTextContent_(r,t,o)}return o};ol.xml.isDocument=function(e){return e instanceof Document};ol.xml.isNode=function(e){return e instanceof Node};ol.xml.getAttributeNS=function(e,t,o){return e.getAttributeNS(t,o)||""};ol.xml.setAttributeNS=function(e,t,o,r){e.setAttributeNS(t,o,r)};ol.xml.parse=function(e){return(new DOMParser).parseFromString(e,"application/xml")};ol.xml.makeArrayExtender=function(e,t){return function(o,r){var i=e.call(t,o,r);if(void 0!==i){var n=r[r.length-1];ol.array.extend(n,i)}}};ol.xml.makeArrayPusher=function(e,t){return function(o,r){var i=e.call(void 0!==t?t:this,o,r);if(void 0!==i){var n=r[r.length-1];n.push(i)}}};ol.xml.makeReplacer=function(e,t){return function(o,r){var i=e.call(void 0!==t?t:this,o,r);void 0!==i&&(r[r.length-1]=i)}};ol.xml.makeObjectPropertyPusher=function(e,t,o){return function(r,i){var n=e.call(void 0!==o?o:this,r,i);if(void 0!==n){var a,l=i[i.length-1],s=void 0!==t?t:r.localName;a=s in l?l[s]:l[s]=[];a.push(n)}}};ol.xml.makeObjectPropertySetter=function(e,t,o){return function(r,i){var n=e.call(void 0!==o?o:this,r,i);if(void 0!==n){var a=i[i.length-1],l=void 0!==t?t:r.localName;a[l]=n}}};ol.xml.makeChildAppender=function(e,t){return function(o,r,i){e.call(void 0!==t?t:this,o,r,i);var n=i[i.length-1],a=n.node;a.appendChild(o)}};ol.xml.makeArraySerializer=function(e,t){var o,r;return function(t,i,n){if(void 0===o){o={};var a={};a[t.localName]=e;

o[t.namespaceURI]=a;r=ol.xml.makeSimpleNodeFactory(t.localName)}ol.xml.serialize(o,r,i,n)}};ol.xml.makeSimpleNodeFactory=function(e,t){var o=e;return function(e,r,i){var n=r[r.length-1],a=n.node,l=o;void 0===l&&(l=i);var s=t;void 0===t&&(s=a.namespaceURI);return ol.xml.createElementNS(s,l)}};ol.xml.OBJECT_PROPERTY_NODE_FACTORY=ol.xml.makeSimpleNodeFactory();ol.xml.makeSequence=function(e,t){for(var o=t.length,r=new Array(o),i=0;o>i;++i)r[i]=e[t[i]];return r};ol.xml.makeStructureNS=function(e,t,o){var r,i,n=void 0!==o?o:{};for(r=0,i=e.length;i>r;++r)n[e[r]]=t;return n};ol.xml.parseNode=function(e,t,o,r){var i;for(i=t.firstElementChild;i;i=i.nextElementSibling){var n=e[i.namespaceURI];if(void 0!==n){var a=n[i.localName];void 0!==a&&a.call(r,i,o)}}};ol.xml.pushParseAndPop=function(e,t,o,r,i){r.push(e);ol.xml.parseNode(t,o,r,i);return r.pop()};ol.xml.serialize=function(e,t,o,r,i,n){for(var a,l,s=(void 0!==i?i:o).length,p=0;s>p;++p){a=o[p];if(void 0!==a){l=t.call(n,a,r,void 0!==i?i[p]:void 0);void 0!==l&&e[l.namespaceURI][l.localName].call(n,l,a,r)}}};ol.xml.pushSerializeAndPop=function(e,t,o,r,i,n,a){i.push(e);ol.xml.serialize(t,o,r,i,n,a);return i.pop()};goog.provide("ol.featureloader");goog.require("ol");goog.require("ol.format.FormatType");goog.require("ol.xml");ol.featureloader.loadFeaturesXhr=function(e,t,o,r){return function(i,n,a){var l=new XMLHttpRequest;l.open("GET","function"==typeof e?e(i,n,a):e,!0);t.getType()==ol.format.FormatType.ARRAY_BUFFER&&(l.responseType="arraybuffer");l.onload=function(e){if(!l.status||l.status>=200&&l.status<300){var i,n=t.getType();if(n==ol.format.FormatType.JSON||n==ol.format.FormatType.TEXT)i=l.responseText;else if(n==ol.format.FormatType.XML){i=l.responseXML;i||(i=ol.xml.parse(l.responseText))}else n==ol.format.FormatType.ARRAY_BUFFER&&(i=l.response);i?o.call(this,t.readFeatures(i,{featureProjection:a}),t.readProjection(i)):r.call(this)}else r.call(this)}.bind(this);l.onerror=function(){r.call(this)}.bind(this);l.send()}};ol.featureloader.xhr=function(e,t){return ol.featureloader.loadFeaturesXhr(e,t,function(e,t){this.addFeatures(e)},ol.nullFunction)};goog.provide("ol.format.Feature");goog.require("ol.geom.Geometry");goog.require("ol.obj");goog.require("ol.proj");ol.format.Feature=function(){this.defaultDataProjection=null;this.defaultFeatureProjection=null};ol.format.Feature.prototype.getReadOptions=function(e,t){var o;t&&(o={dataProjection:t.dataProjection?t.dataProjection:this.readProjection(e),featureProjection:t.featureProjection});return this.adaptOptions(o)};ol.format.Feature.prototype.adaptOptions=function(e){return ol.obj.assign({dataProjection:this.defaultDataProjection,featureProjection:this.defaultFeatureProjection},e)};ol.format.Feature.prototype.getType=function(){};ol.format.Feature.prototype.readFeature=function(e,t){};ol.format.Feature.prototype.readFeatures=function(e,t){};ol.format.Feature.prototype.readGeometry=function(e,t){};ol.format.Feature.prototype.readProjection=function(e){};ol.format.Feature.prototype.writeFeature=function(e,t){};ol.format.Feature.prototype.writeFeatures=function(e,t){};ol.format.Feature.prototype.writeGeometry=function(e,t){};ol.format.Feature.transformWithOptions=function(e,t,o){var r,i=o?ol.proj.get(o.featureProjection):null,n=o?ol.proj.get(o.dataProjection):null;r=i&&n&&!ol.proj.equivalent(i,n)?e instanceof ol.geom.Geometry?(t?e.clone():e).transform(t?i:n,t?n:i):ol.proj.transformExtent(t?e.slice():e,t?i:n,t?n:i):e;if(t&&o&&o.decimals){var a=Math.pow(10,o.decimals),l=function(e){for(var t=0,o=e.length;o>t;++t)e[t]=Math.round(e[t]*a)/a;return e};Array.isArray(r)?l(r):r.applyTransform(l)}return r};goog.provide("ol.format.JSONFeature");goog.require("ol");goog.require("ol.format.Feature");goog.require("ol.format.FormatType");ol.format.JSONFeature=function(){ol.format.Feature.call(this)};ol.inherits(ol.format.JSONFeature,ol.format.Feature);ol.format.JSONFeature.prototype.getObject_=function(e){if("string"==typeof e){var t=JSON.parse(e);return t?t:null}return null!==e?e:null};ol.format.JSONFeature.prototype.getType=function(){return ol.format.FormatType.JSON};ol.format.JSONFeature.prototype.readFeature=function(e,t){return this.readFeatureFromObject(this.getObject_(e),this.getReadOptions(e,t))};ol.format.JSONFeature.prototype.readFeatures=function(e,t){return this.readFeaturesFromObject(this.getObject_(e),this.getReadOptions(e,t))};ol.format.JSONFeature.prototype.readFeatureFromObject=function(e,t){};ol.format.JSONFeature.prototype.readFeaturesFromObject=function(e,t){};ol.format.JSONFeature.prototype.readGeometry=function(e,t){return this.readGeometryFromObject(this.getObject_(e),this.getReadOptions(e,t))};ol.format.JSONFeature.prototype.readGeometryFromObject=function(e,t){};ol.format.JSONFeature.prototype.readProjection=function(e){return this.readProjectionFromObject(this.getObject_(e))};ol.format.JSONFeature.prototype.readProjectionFromObject=function(e){};ol.format.JSONFeature.prototype.writeFeature=function(e,t){return JSON.stringify(this.writeFeatureObject(e,t))};ol.format.JSONFeature.prototype.writeFeatureObject=function(e,t){};ol.format.JSONFeature.prototype.writeFeatures=function(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))};ol.format.JSONFeature.prototype.writeFeaturesObject=function(e,t){};ol.format.JSONFeature.prototype.writeGeometry=function(e,t){return JSON.stringify(this.writeGeometryObject(e,t))};ol.format.JSONFeature.prototype.writeGeometryObject=function(e,t){};goog.provide("ol.geom.flat.interpolate");goog.require("ol.array");goog.require("ol.math");ol.geom.flat.interpolate.lineString=function(e,t,o,r,i,n){var a=0/0,l=0/0,s=(o-t)/r;if(1===s){a=e[t];l=e[t+1]}else if(2==s){a=(1-i)*e[t]+i*e[t+r];l=(1-i)*e[t+1]+i*e[t+r+1]}else if(0!==s){var p,c=e[t],u=e[t+1],g=0,d=[0];for(p=t+r;o>p;p+=r){var h=e[p],f=e[p+1];g+=Math.sqrt((h-c)*(h-c)+(f-u)*(f-u));d.push(g);c=h;u=f}var y=i*g,m=ol.array.binarySearch(d,y);if(0>m){var v=(y-d[-m-2])/(d[-m-1]-d[-m-2]),C=t+(-m-2)*r;a=ol.math.lerp(e[C],e[C+r],v);l=ol.math.lerp(e[C+1],e[C+r+1],v)}else{a=e[t+m*r];l=e[t+m*r+1]}}if(n){n[0]=a;n[1]=l;return n}return[a,l]};ol.geom.flat.interpolate.lineStringCoordinateAtM=function(e,t,o,r,i,n){if(o==t)return null;var a;if(i<e[t+r-1]){if(n){a=e.slice(t,t+r);a[r-1]=i;return a}return null}if(e[o-1]<i){if(n){a=e.slice(o-r,o);a[r-1]=i;return a}return null}if(i==e[t+r-1])return e.slice(t,t+r);for(var l=t/r,s=o/r;s>l;){var p=l+s>>1;i<e[(p+1)*r-1]?s=p:l=p+1}var c=e[l*r-1];if(i==c)return e.slice((l-1)*r,(l-1)*r+r);var u=e[(l+1)*r-1],g=(i-c)/(u-c);a=[];var d;for(d=0;r-1>d;++d)a.push(ol.math.lerp(e[(l-1)*r+d],e[l*r+d],g));a.push(i);return a};ol.geom.flat.interpolate.lineStringsCoordinateAtM=function(e,t,o,r,i,n,a){if(a)return ol.geom.flat.interpolate.lineStringCoordinateAtM(e,t,o[o.length-1],r,i,n);var l;if(i<e[r-1]){if(n){l=e.slice(0,r);l[r-1]=i;return l}return null}if(e[e.length-1]<i){if(n){l=e.slice(e.length-r);l[r-1]=i;return l}return null}var s,p;for(s=0,p=o.length;p>s;++s){var c=o[s];if(t!=c){if(i<e[t+r-1])return null;if(i<=e[c-1])return ol.geom.flat.interpolate.lineStringCoordinateAtM(e,t,c,r,i,!1);t=c}}return null};goog.provide("ol.geom.flat.length");ol.geom.flat.length.lineString=function(e,t,o,r){var i,n=e[t],a=e[t+1],l=0;for(i=t+r;o>i;i+=r){var s=e[i],p=e[i+1];l+=Math.sqrt((s-n)*(s-n)+(p-a)*(p-a));n=s;a=p}return l};ol.geom.flat.length.linearRing=function(e,t,o,r){var i=ol.geom.flat.length.lineString(e,t,o,r),n=e[o-r]-e[t],a=e[o-r+1]-e[t+1];i+=Math.sqrt(n*n+a*a);return i};goog.provide("ol.geom.LineString");goog.require("ol");goog.require("ol.array");goog.require("ol.extent");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.GeometryType");goog.require("ol.geom.SimpleGeometry");goog.require("ol.geom.flat.closest");goog.require("ol.geom.flat.deflate");goog.require("ol.geom.flat.inflate");goog.require("ol.geom.flat.interpolate");goog.require("ol.geom.flat.intersectsextent");goog.require("ol.geom.flat.length");goog.require("ol.geom.flat.segments");goog.require("ol.geom.flat.simplify");ol.geom.LineString=function(e,t){ol.geom.SimpleGeometry.call(this);this.flatMidpoint_=null;this.flatMidpointRevision_=-1;this.maxDelta_=-1;this.maxDeltaRevision_=-1;this.setCoordinates(e,t)};ol.inherits(ol.geom.LineString,ol.geom.SimpleGeometry);ol.geom.LineString.prototype.appendCoordinate=function(e){this.flatCoordinates?ol.array.extend(this.flatCoordinates,e):this.flatCoordinates=e.slice();this.changed()};ol.geom.LineString.prototype.clone=function(){var e=new ol.geom.LineString(null);e.setFlatCoordinates(this.layout,this.flatCoordinates.slice());return e};ol.geom.LineString.prototype.closestPointXY=function(e,t,o,r){if(r<ol.extent.closestSquaredDistanceXY(this.getExtent(),e,t))return r;if(this.maxDeltaRevision_!=this.getRevision()){this.maxDelta_=Math.sqrt(ol.geom.flat.closest.getMaxSquaredDelta(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0));this.maxDeltaRevision_=this.getRevision()}return ol.geom.flat.closest.getClosestPoint(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,o,r)};ol.geom.LineString.prototype.forEachSegment=function(e,t){return ol.geom.flat.segments.forEach(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t)};ol.geom.LineString.prototype.getCoordinateAtM=function(e,t){if(this.layout!=ol.geom.GeometryLayout.XYM&&this.layout!=ol.geom.GeometryLayout.XYZM)return null;var o=void 0!==t?t:!1;return ol.geom.flat.interpolate.lineStringCoordinateAtM(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,o)};ol.geom.LineString.prototype.getCoordinates=function(){return ol.geom.flat.inflate.coordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};ol.geom.LineString.prototype.getCoordinateAt=function(e,t){return ol.geom.flat.interpolate.lineString(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t)};ol.geom.LineString.prototype.getLength=function(){return ol.geom.flat.length.lineString(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};ol.geom.LineString.prototype.getFlatMidpoint=function(){if(this.flatMidpointRevision_!=this.getRevision()){this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_);this.flatMidpointRevision_=this.getRevision()}return this.flatMidpoint_};ol.geom.LineString.prototype.getSimplifiedGeometryInternal=function(e){var t=[];t.length=ol.geom.flat.simplify.douglasPeucker(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0);var o=new ol.geom.LineString(null);o.setFlatCoordinates(ol.geom.GeometryLayout.XY,t);return o};ol.geom.LineString.prototype.getType=function(){return ol.geom.GeometryType.LINE_STRING};ol.geom.LineString.prototype.intersectsExtent=function(e){return ol.geom.flat.intersectsextent.lineString(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)};ol.geom.LineString.prototype.setCoordinates=function(e,t){if(e){this.setLayout(t,e,1);this.flatCoordinates||(this.flatCoordinates=[]);this.flatCoordinates.length=ol.geom.flat.deflate.coordinates(this.flatCoordinates,0,e,this.stride);this.changed()}else this.setFlatCoordinates(ol.geom.GeometryLayout.XY,null)};ol.geom.LineString.prototype.setFlatCoordinates=function(e,t){this.setFlatCoordinatesInternal(e,t);this.changed()};goog.provide("ol.geom.MultiLineString");goog.require("ol");goog.require("ol.array");goog.require("ol.extent");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.GeometryType");goog.require("ol.geom.LineString");goog.require("ol.geom.SimpleGeometry");goog.require("ol.geom.flat.closest");goog.require("ol.geom.flat.deflate");goog.require("ol.geom.flat.inflate");goog.require("ol.geom.flat.interpolate");goog.require("ol.geom.flat.intersectsextent");goog.require("ol.geom.flat.simplify");ol.geom.MultiLineString=function(e,t){ol.geom.SimpleGeometry.call(this);this.ends_=[];this.maxDelta_=-1;this.maxDeltaRevision_=-1;this.setCoordinates(e,t)};ol.inherits(ol.geom.MultiLineString,ol.geom.SimpleGeometry);ol.geom.MultiLineString.prototype.appendLineString=function(e){this.flatCoordinates?ol.array.extend(this.flatCoordinates,e.getFlatCoordinates().slice()):this.flatCoordinates=e.getFlatCoordinates().slice();this.ends_.push(this.flatCoordinates.length);this.changed()};ol.geom.MultiLineString.prototype.clone=function(){var e=new ol.geom.MultiLineString(null);e.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),this.ends_.slice());return e};ol.geom.MultiLineString.prototype.closestPointXY=function(e,t,o,r){if(r<ol.extent.closestSquaredDistanceXY(this.getExtent(),e,t))return r;if(this.maxDeltaRevision_!=this.getRevision()){this.maxDelta_=Math.sqrt(ol.geom.flat.closest.getsMaxSquaredDelta(this.flatCoordinates,0,this.ends_,this.stride,0));this.maxDeltaRevision_=this.getRevision()}return ol.geom.flat.closest.getsClosestPoint(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,o,r)};ol.geom.MultiLineString.prototype.getCoordinateAtM=function(e,t,o){if(this.layout!=ol.geom.GeometryLayout.XYM&&this.layout!=ol.geom.GeometryLayout.XYZM||0===this.flatCoordinates.length)return null;var r=void 0!==t?t:!1,i=void 0!==o?o:!1;return ol.geom.flat.interpolate.lineStringsCoordinateAtM(this.flatCoordinates,0,this.ends_,this.stride,e,r,i)};ol.geom.MultiLineString.prototype.getCoordinates=function(){return ol.geom.flat.inflate.coordinatess(this.flatCoordinates,0,this.ends_,this.stride)};ol.geom.MultiLineString.prototype.getEnds=function(){return this.ends_};ol.geom.MultiLineString.prototype.getLineString=function(e){if(0>e||this.ends_.length<=e)return null;var t=new ol.geom.LineString(null);t.setFlatCoordinates(this.layout,this.flatCoordinates.slice(0===e?0:this.ends_[e-1],this.ends_[e]));return t};ol.geom.MultiLineString.prototype.getLineStrings=function(){var e,t,o=this.flatCoordinates,r=this.ends_,i=this.layout,n=[],a=0;for(e=0,t=r.length;t>e;++e){var l=r[e],s=new ol.geom.LineString(null);s.setFlatCoordinates(i,o.slice(a,l));n.push(s);a=l}return n};ol.geom.MultiLineString.prototype.getFlatMidpoints=function(){var e,t,o=[],r=this.flatCoordinates,i=0,n=this.ends_,a=this.stride;for(e=0,t=n.length;t>e;++e){var l=n[e],s=ol.geom.flat.interpolate.lineString(r,i,l,a,.5);ol.array.extend(o,s);i=l}return o};ol.geom.MultiLineString.prototype.getSimplifiedGeometryInternal=function(e){var t=[],o=[];t.length=ol.geom.flat.simplify.douglasPeuckers(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,o);var r=new ol.geom.MultiLineString(null);r.setFlatCoordinates(ol.geom.GeometryLayout.XY,t,o);return r};ol.geom.MultiLineString.prototype.getType=function(){return ol.geom.GeometryType.MULTI_LINE_STRING};ol.geom.MultiLineString.prototype.intersectsExtent=function(e){return ol.geom.flat.intersectsextent.lineStrings(this.flatCoordinates,0,this.ends_,this.stride,e)};ol.geom.MultiLineString.prototype.setCoordinates=function(e,t){if(e){this.setLayout(t,e,2);this.flatCoordinates||(this.flatCoordinates=[]);var o=ol.geom.flat.deflate.coordinatess(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=0===o.length?0:o[o.length-1];this.changed()}else this.setFlatCoordinates(ol.geom.GeometryLayout.XY,null,this.ends_)};ol.geom.MultiLineString.prototype.setFlatCoordinates=function(e,t,o){this.setFlatCoordinatesInternal(e,t);this.ends_=o;this.changed()};ol.geom.MultiLineString.prototype.setLineStrings=function(e){var t,o,r=this.getLayout(),i=[],n=[];for(t=0,o=e.length;o>t;++t){var a=e[t];0===t&&(r=a.getLayout());ol.array.extend(i,a.getFlatCoordinates());n.push(i.length)}this.setFlatCoordinates(r,i,n)};goog.provide("ol.geom.MultiPoint");goog.require("ol");goog.require("ol.array");goog.require("ol.extent");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.GeometryType");goog.require("ol.geom.Point");goog.require("ol.geom.SimpleGeometry");goog.require("ol.geom.flat.deflate");goog.require("ol.geom.flat.inflate");goog.require("ol.math");ol.geom.MultiPoint=function(e,t){ol.geom.SimpleGeometry.call(this);this.setCoordinates(e,t)};ol.inherits(ol.geom.MultiPoint,ol.geom.SimpleGeometry);ol.geom.MultiPoint.prototype.appendPoint=function(e){this.flatCoordinates?ol.array.extend(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice();this.changed()};ol.geom.MultiPoint.prototype.clone=function(){var e=new ol.geom.MultiPoint(null);e.setFlatCoordinates(this.layout,this.flatCoordinates.slice());return e};ol.geom.MultiPoint.prototype.closestPointXY=function(e,t,o,r){if(r<ol.extent.closestSquaredDistanceXY(this.getExtent(),e,t))return r;var i,n,a,l=this.flatCoordinates,s=this.stride;for(i=0,n=l.length;n>i;i+=s){var p=ol.math.squaredDistance(e,t,l[i],l[i+1]);if(r>p){r=p;for(a=0;s>a;++a)o[a]=l[i+a];o.length=s}}return r};ol.geom.MultiPoint.prototype.getCoordinates=function(){return ol.geom.flat.inflate.coordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};ol.geom.MultiPoint.prototype.getPoint=function(e){var t=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;if(0>e||e>=t)return null;var o=new ol.geom.Point(null);o.setFlatCoordinates(this.layout,this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride));return o};ol.geom.MultiPoint.prototype.getPoints=function(){var e,t,o=this.flatCoordinates,r=this.layout,i=this.stride,n=[];for(e=0,t=o.length;t>e;e+=i){var a=new ol.geom.Point(null);a.setFlatCoordinates(r,o.slice(e,e+i));n.push(a)}return n};ol.geom.MultiPoint.prototype.getType=function(){return ol.geom.GeometryType.MULTI_POINT};ol.geom.MultiPoint.prototype.intersectsExtent=function(e){var t,o,r,i,n=this.flatCoordinates,a=this.stride;for(t=0,o=n.length;o>t;t+=a){r=n[t];i=n[t+1];if(ol.extent.containsXY(e,r,i))return!0}return!1};ol.geom.MultiPoint.prototype.setCoordinates=function(e,t){if(e){this.setLayout(t,e,1);this.flatCoordinates||(this.flatCoordinates=[]);this.flatCoordinates.length=ol.geom.flat.deflate.coordinates(this.flatCoordinates,0,e,this.stride);this.changed()}else this.setFlatCoordinates(ol.geom.GeometryLayout.XY,null)};ol.geom.MultiPoint.prototype.setFlatCoordinates=function(e,t){this.setFlatCoordinatesInternal(e,t);this.changed()};goog.provide("ol.geom.flat.center");goog.require("ol.extent");ol.geom.flat.center.linearRingss=function(e,t,o,r){var i,n,a=[],l=ol.extent.createEmpty();for(i=0,n=o.length;n>i;++i){var s=o[i];l=ol.extent.createOrUpdateFromFlatCoordinates(e,t,s[0],r);a.push((l[0]+l[2])/2,(l[1]+l[3])/2);t=s[s.length-1]}return a};goog.provide("ol.geom.MultiPolygon");goog.require("ol");goog.require("ol.array");goog.require("ol.extent");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.GeometryType");goog.require("ol.geom.MultiPoint");goog.require("ol.geom.Polygon");goog.require("ol.geom.SimpleGeometry");goog.require("ol.geom.flat.area");goog.require("ol.geom.flat.center");goog.require("ol.geom.flat.closest");goog.require("ol.geom.flat.contains");goog.require("ol.geom.flat.deflate");goog.require("ol.geom.flat.inflate");goog.require("ol.geom.flat.interiorpoint");goog.require("ol.geom.flat.intersectsextent");goog.require("ol.geom.flat.orient");goog.require("ol.geom.flat.simplify");ol.geom.MultiPolygon=function(e,t){ol.geom.SimpleGeometry.call(this);this.endss_=[];this.flatInteriorPointsRevision_=-1;this.flatInteriorPoints_=null;this.maxDelta_=-1;this.maxDeltaRevision_=-1;this.orientedRevision_=-1;this.orientedFlatCoordinates_=null;this.setCoordinates(e,t)};ol.inherits(ol.geom.MultiPolygon,ol.geom.SimpleGeometry);ol.geom.MultiPolygon.prototype.appendPolygon=function(e){var t;if(this.flatCoordinates){var o=this.flatCoordinates.length;ol.array.extend(this.flatCoordinates,e.getFlatCoordinates());t=e.getEnds().slice();var r,i;for(r=0,i=t.length;i>r;++r)t[r]+=o}else{this.flatCoordinates=e.getFlatCoordinates().slice();t=e.getEnds().slice();this.endss_.push()}this.endss_.push(t);this.changed()};ol.geom.MultiPolygon.prototype.clone=function(){for(var e=new ol.geom.MultiPolygon(null),t=this.endss_.length,o=new Array(t),r=0;t>r;++r)o[r]=this.endss_[r].slice();e.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),o);return e};ol.geom.MultiPolygon.prototype.closestPointXY=function(e,t,o,r){if(r<ol.extent.closestSquaredDistanceXY(this.getExtent(),e,t))return r;if(this.maxDeltaRevision_!=this.getRevision()){this.maxDelta_=Math.sqrt(ol.geom.flat.closest.getssMaxSquaredDelta(this.flatCoordinates,0,this.endss_,this.stride,0));this.maxDeltaRevision_=this.getRevision()}return ol.geom.flat.closest.getssClosestPoint(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,o,r)};ol.geom.MultiPolygon.prototype.containsXY=function(e,t){return ol.geom.flat.contains.linearRingssContainsXY(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)};ol.geom.MultiPolygon.prototype.getArea=function(){return ol.geom.flat.area.linearRingss(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)};ol.geom.MultiPolygon.prototype.getCoordinates=function(e){var t;if(void 0!==e){t=this.getOrientedFlatCoordinates().slice();ol.geom.flat.orient.orientLinearRingss(t,0,this.endss_,this.stride,e)}else t=this.flatCoordinates;return ol.geom.flat.inflate.coordinatesss(t,0,this.endss_,this.stride)};ol.geom.MultiPolygon.prototype.getEndss=function(){return this.endss_};ol.geom.MultiPolygon.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var e=ol.geom.flat.center.linearRingss(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=ol.geom.flat.interiorpoint.linearRingss(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e);this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_};ol.geom.MultiPolygon.prototype.getInteriorPoints=function(){var e=new ol.geom.MultiPoint(null);e.setFlatCoordinates(ol.geom.GeometryLayout.XY,this.getFlatInteriorPoints().slice());return e};ol.geom.MultiPolygon.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var e=this.flatCoordinates;if(ol.geom.flat.orient.linearRingssAreOriented(e,0,this.endss_,this.stride))this.orientedFlatCoordinates_=e;else{this.orientedFlatCoordinates_=e.slice();this.orientedFlatCoordinates_.length=ol.geom.flat.orient.orientLinearRingss(this.orientedFlatCoordinates_,0,this.endss_,this.stride)}this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_};ol.geom.MultiPolygon.prototype.getSimplifiedGeometryInternal=function(e){var t=[],o=[];t.length=ol.geom.flat.simplify.quantizess(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,o);var r=new ol.geom.MultiPolygon(null);r.setFlatCoordinates(ol.geom.GeometryLayout.XY,t,o);return r};ol.geom.MultiPolygon.prototype.getPolygon=function(e){if(0>e||this.endss_.length<=e)return null;var t;if(0===e)t=0;else{var o=this.endss_[e-1];t=o[o.length-1]}var r=this.endss_[e].slice(),i=r[r.length-1];if(0!==t){var n,a;for(n=0,a=r.length;a>n;++n)r[n]-=t}var l=new ol.geom.Polygon(null);l.setFlatCoordinates(this.layout,this.flatCoordinates.slice(t,i),r);return l};ol.geom.MultiPolygon.prototype.getPolygons=function(){var e,t,o,r,i=this.layout,n=this.flatCoordinates,a=this.endss_,l=[],s=0;for(e=0,t=a.length;t>e;++e){var p=a[e].slice(),c=p[p.length-1];if(0!==s)for(o=0,r=p.length;r>o;++o)p[o]-=s;var u=new ol.geom.Polygon(null);u.setFlatCoordinates(i,n.slice(s,c),p);l.push(u);s=c}return l};ol.geom.MultiPolygon.prototype.getType=function(){return ol.geom.GeometryType.MULTI_POLYGON};ol.geom.MultiPolygon.prototype.intersectsExtent=function(e){return ol.geom.flat.intersectsextent.linearRingss(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)};ol.geom.MultiPolygon.prototype.setCoordinates=function(e,t){if(e){this.setLayout(t,e,3);this.flatCoordinates||(this.flatCoordinates=[]);var o=ol.geom.flat.deflate.coordinatesss(this.flatCoordinates,0,e,this.stride,this.endss_);if(0===o.length)this.flatCoordinates.length=0;else{var r=o[o.length-1];this.flatCoordinates.length=0===r.length?0:r[r.length-1]}this.changed()}else this.setFlatCoordinates(ol.geom.GeometryLayout.XY,null,this.endss_)};ol.geom.MultiPolygon.prototype.setFlatCoordinates=function(e,t,o){this.setFlatCoordinatesInternal(e,t);this.endss_=o;this.changed()};ol.geom.MultiPolygon.prototype.setPolygons=function(e){var t,o,r,i=this.getLayout(),n=[],a=[];for(t=0,o=e.length;o>t;++t){var l=e[t];0===t&&(i=l.getLayout());var s=n.length;r=l.getEnds();var p,c;for(p=0,c=r.length;c>p;++p)r[p]+=s;ol.array.extend(n,l.getFlatCoordinates());a.push(r)}this.setFlatCoordinates(i,n,a)};goog.provide("ol.format.EsriJSON");goog.require("ol");goog.require("ol.Feature");goog.require("ol.asserts");goog.require("ol.extent");goog.require("ol.format.Feature");goog.require("ol.format.JSONFeature");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.GeometryType");goog.require("ol.geom.LineString");goog.require("ol.geom.LinearRing");goog.require("ol.geom.MultiLineString");goog.require("ol.geom.MultiPoint");goog.require("ol.geom.MultiPolygon");goog.require("ol.geom.Point");goog.require("ol.geom.Polygon");goog.require("ol.geom.flat.deflate");goog.require("ol.geom.flat.orient");goog.require("ol.obj");goog.require("ol.proj");ol.format.EsriJSON=function(e){var t=e?e:{};ol.format.JSONFeature.call(this);this.geometryName_=t.geometryName};ol.inherits(ol.format.EsriJSON,ol.format.JSONFeature);ol.format.EsriJSON.readGeometry_=function(e,t){if(!e)return null;var o;if("number"==typeof e.x&&"number"==typeof e.y)o=ol.geom.GeometryType.POINT;else if(e.points)o=ol.geom.GeometryType.MULTI_POINT;else if(e.paths)o=1===e.paths.length?ol.geom.GeometryType.LINE_STRING:ol.geom.GeometryType.MULTI_LINE_STRING;else if(e.rings){var r=ol.format.EsriJSON.getGeometryLayout_(e),i=ol.format.EsriJSON.convertRings_(e.rings,r);e=ol.obj.assign({},e);if(1===i.length){o=ol.geom.GeometryType.POLYGON;e.rings=i[0]}else{o=ol.geom.GeometryType.MULTI_POLYGON;e.rings=i}}var n=ol.format.EsriJSON.GEOMETRY_READERS_[o];return ol.format.Feature.transformWithOptions(n(e),!1,t)};ol.format.EsriJSON.convertRings_=function(e,t){var o,r,i=[],n=[],a=[];for(o=0,r=e.length;r>o;++o){i.length=0;ol.geom.flat.deflate.coordinates(i,0,e[o],t.length);var l=ol.geom.flat.orient.linearRingIsClockwise(i,0,i.length,t.length);l?n.push([e[o]]):a.push(e[o])}for(;a.length;){var s=a.shift(),p=!1;for(o=n.length-1;o>=0;o--){var c=n[o][0];if(ol.extent.containsExtent(new ol.geom.LinearRing(c).getExtent(),new ol.geom.LinearRing(s).getExtent())){n[o].push(s);p=!0;break}}p||n.push([s.reverse()])}return n};ol.format.EsriJSON.readPointGeometry_=function(e){var t;t=void 0!==e.m&&void 0!==e.z?new ol.geom.Point([e.x,e.y,e.z,e.m],ol.geom.GeometryLayout.XYZM):void 0!==e.z?new ol.geom.Point([e.x,e.y,e.z],ol.geom.GeometryLayout.XYZ):void 0!==e.m?new ol.geom.Point([e.x,e.y,e.m],ol.geom.GeometryLayout.XYM):new ol.geom.Point([e.x,e.y]);return t};ol.format.EsriJSON.readLineStringGeometry_=function(e){var t=ol.format.EsriJSON.getGeometryLayout_(e);return new ol.geom.LineString(e.paths[0],t)};ol.format.EsriJSON.readMultiLineStringGeometry_=function(e){var t=ol.format.EsriJSON.getGeometryLayout_(e);return new ol.geom.MultiLineString(e.paths,t)};ol.format.EsriJSON.getGeometryLayout_=function(e){var t=ol.geom.GeometryLayout.XY;e.hasZ===!0&&e.hasM===!0?t=ol.geom.GeometryLayout.XYZM:e.hasZ===!0?t=ol.geom.GeometryLayout.XYZ:e.hasM===!0&&(t=ol.geom.GeometryLayout.XYM);return t};ol.format.EsriJSON.readMultiPointGeometry_=function(e){var t=ol.format.EsriJSON.getGeometryLayout_(e);return new ol.geom.MultiPoint(e.points,t)};ol.format.EsriJSON.readMultiPolygonGeometry_=function(e){var t=ol.format.EsriJSON.getGeometryLayout_(e);return new ol.geom.MultiPolygon(e.rings,t)};ol.format.EsriJSON.readPolygonGeometry_=function(e){var t=ol.format.EsriJSON.getGeometryLayout_(e);return new ol.geom.Polygon(e.rings,t)};ol.format.EsriJSON.writePointGeometry_=function(e,t){var o,r=e.getCoordinates(),i=e.getLayout();i===ol.geom.GeometryLayout.XYZ?o={x:r[0],y:r[1],z:r[2]}:i===ol.geom.GeometryLayout.XYM?o={x:r[0],y:r[1],m:r[2]}:i===ol.geom.GeometryLayout.XYZM?o={x:r[0],y:r[1],z:r[2],m:r[3]}:i===ol.geom.GeometryLayout.XY?o={x:r[0],y:r[1]}:ol.asserts.assert(!1,34);return o};ol.format.EsriJSON.getHasZM_=function(e){var t=e.getLayout();return{hasZ:t===ol.geom.GeometryLayout.XYZ||t===ol.geom.GeometryLayout.XYZM,hasM:t===ol.geom.GeometryLayout.XYM||t===ol.geom.GeometryLayout.XYZM}};ol.format.EsriJSON.writeLineStringGeometry_=function(e,t){var o=ol.format.EsriJSON.getHasZM_(e);return{hasZ:o.hasZ,hasM:o.hasM,paths:[e.getCoordinates()]}};ol.format.EsriJSON.writePolygonGeometry_=function(e,t){var o=ol.format.EsriJSON.getHasZM_(e);return{hasZ:o.hasZ,hasM:o.hasM,rings:e.getCoordinates(!1)}};ol.format.EsriJSON.writeMultiLineStringGeometry_=function(e,t){var o=ol.format.EsriJSON.getHasZM_(e);return{hasZ:o.hasZ,hasM:o.hasM,paths:e.getCoordinates()}};ol.format.EsriJSON.writeMultiPointGeometry_=function(e,t){var o=ol.format.EsriJSON.getHasZM_(e);return{hasZ:o.hasZ,hasM:o.hasM,points:e.getCoordinates()}};ol.format.EsriJSON.writeMultiPolygonGeometry_=function(e,t){for(var o=ol.format.EsriJSON.getHasZM_(e),r=e.getCoordinates(!1),i=[],n=0;n<r.length;n++)for(var a=r[n].length-1;a>=0;a--)i.push(r[n][a]);return{hasZ:o.hasZ,hasM:o.hasM,rings:i}};ol.format.EsriJSON.GEOMETRY_READERS_={};ol.format.EsriJSON.GEOMETRY_READERS_[ol.geom.GeometryType.POINT]=ol.format.EsriJSON.readPointGeometry_;ol.format.EsriJSON.GEOMETRY_READERS_[ol.geom.GeometryType.LINE_STRING]=ol.format.EsriJSON.readLineStringGeometry_;ol.format.EsriJSON.GEOMETRY_READERS_[ol.geom.GeometryType.POLYGON]=ol.format.EsriJSON.readPolygonGeometry_;ol.format.EsriJSON.GEOMETRY_READERS_[ol.geom.GeometryType.MULTI_POINT]=ol.format.EsriJSON.readMultiPointGeometry_;ol.format.EsriJSON.GEOMETRY_READERS_[ol.geom.GeometryType.MULTI_LINE_STRING]=ol.format.EsriJSON.readMultiLineStringGeometry_;ol.format.EsriJSON.GEOMETRY_READERS_[ol.geom.GeometryType.MULTI_POLYGON]=ol.format.EsriJSON.readMultiPolygonGeometry_;ol.format.EsriJSON.GEOMETRY_WRITERS_={};ol.format.EsriJSON.GEOMETRY_WRITERS_[ol.geom.GeometryType.POINT]=ol.format.EsriJSON.writePointGeometry_;ol.format.EsriJSON.GEOMETRY_WRITERS_[ol.geom.GeometryType.LINE_STRING]=ol.format.EsriJSON.writeLineStringGeometry_;ol.format.EsriJSON.GEOMETRY_WRITERS_[ol.geom.GeometryType.POLYGON]=ol.format.EsriJSON.writePolygonGeometry_;ol.format.EsriJSON.GEOMETRY_WRITERS_[ol.geom.GeometryType.MULTI_POINT]=ol.format.EsriJSON.writeMultiPointGeometry_;ol.format.EsriJSON.GEOMETRY_WRITERS_[ol.geom.GeometryType.MULTI_LINE_STRING]=ol.format.EsriJSON.writeMultiLineStringGeometry_;ol.format.EsriJSON.GEOMETRY_WRITERS_[ol.geom.GeometryType.MULTI_POLYGON]=ol.format.EsriJSON.writeMultiPolygonGeometry_;ol.format.EsriJSON.prototype.readFeature;ol.format.EsriJSON.prototype.readFeatures;ol.format.EsriJSON.prototype.readFeatureFromObject=function(e,t){var o=e,r=ol.format.EsriJSON.readGeometry_(o.geometry,t),i=new ol.Feature;this.geometryName_&&i.setGeometryName(this.geometryName_);i.setGeometry(r);t&&t.idField&&o.attributes[t.idField]&&i.setId(o.attributes[t.idField]);o.attributes&&i.setProperties(o.attributes);return i};ol.format.EsriJSON.prototype.readFeaturesFromObject=function(e,t){var o=e,r=t?t:{};if(o.features){var i,n,a=e,l=[],s=a.features;r.idField=e.objectIdFieldName;for(i=0,n=s.length;n>i;++i)l.push(this.readFeatureFromObject(s[i],r));return l}return[this.readFeatureFromObject(e,r)]};ol.format.EsriJSON.prototype.readGeometry;ol.format.EsriJSON.prototype.readGeometryFromObject=function(e,t){return ol.format.EsriJSON.readGeometry_(e,t)};ol.format.EsriJSON.prototype.readProjection;ol.format.EsriJSON.prototype.readProjectionFromObject=function(e){var t=e;if(t.spatialReference&&t.spatialReference.wkid){var o=t.spatialReference.wkid;return ol.proj.get("EPSG:"+o)}return null};ol.format.EsriJSON.writeGeometry_=function(e,t){var o=ol.format.EsriJSON.GEOMETRY_WRITERS_[e.getType()];return o(ol.format.Feature.transformWithOptions(e,!0,t),t)};ol.format.EsriJSON.prototype.writeGeometry;ol.format.EsriJSON.prototype.writeGeometryObject=function(e,t){return ol.format.EsriJSON.writeGeometry_(e,this.adaptOptions(t));

};ol.format.EsriJSON.prototype.writeFeature;ol.format.EsriJSON.prototype.writeFeatureObject=function(e,t){t=this.adaptOptions(t);var o={},r=e.getGeometry();r&&(o.geometry=ol.format.EsriJSON.writeGeometry_(r,t));var i=e.getProperties();delete i[e.getGeometryName()];o.attributes=ol.obj.isEmpty(i)?{}:i;t&&t.featureProjection&&(o.spatialReference={wkid:ol.proj.get(t.featureProjection).getCode().split(":").pop()});return o};ol.format.EsriJSON.prototype.writeFeatures;ol.format.EsriJSON.prototype.writeFeaturesObject=function(e,t){t=this.adaptOptions(t);var o,r,i=[];for(o=0,r=e.length;r>o;++o)i.push(this.writeFeatureObject(e[o],t));return{features:i}};goog.provide("ol.format.filter.Filter");ol.format.filter.Filter=function(e){this.tagName_=e};ol.format.filter.Filter.prototype.getTagName=function(){return this.tagName_};goog.provide("ol.format.filter.LogicalNary");goog.require("ol");goog.require("ol.asserts");goog.require("ol.format.filter.Filter");ol.format.filter.LogicalNary=function(e,t){ol.format.filter.Filter.call(this,e);this.conditions=Array.prototype.slice.call(arguments,1);ol.asserts.assert(this.conditions.length>=2,57)};ol.inherits(ol.format.filter.LogicalNary,ol.format.filter.Filter);goog.provide("ol.format.filter.And");goog.require("ol");goog.require("ol.format.filter.LogicalNary");ol.format.filter.And=function(e){var t=["And"].concat(Array.prototype.slice.call(arguments));ol.format.filter.LogicalNary.apply(this,t)};ol.inherits(ol.format.filter.And,ol.format.filter.LogicalNary);goog.provide("ol.format.filter.Bbox");goog.require("ol");goog.require("ol.format.filter.Filter");ol.format.filter.Bbox=function(e,t,o){ol.format.filter.Filter.call(this,"BBOX");this.geometryName=e;this.extent=t;this.srsName=o};ol.inherits(ol.format.filter.Bbox,ol.format.filter.Filter);goog.provide("ol.format.filter.Comparison");goog.require("ol");goog.require("ol.format.filter.Filter");ol.format.filter.Comparison=function(e,t){ol.format.filter.Filter.call(this,e);this.propertyName=t};ol.inherits(ol.format.filter.Comparison,ol.format.filter.Filter);goog.provide("ol.format.filter.ComparisonBinary");goog.require("ol");goog.require("ol.format.filter.Comparison");ol.format.filter.ComparisonBinary=function(e,t,o,r){ol.format.filter.Comparison.call(this,e,t);this.expression=o;this.matchCase=r};ol.inherits(ol.format.filter.ComparisonBinary,ol.format.filter.Comparison);goog.provide("ol.format.filter.EqualTo");goog.require("ol");goog.require("ol.format.filter.ComparisonBinary");ol.format.filter.EqualTo=function(e,t,o){ol.format.filter.ComparisonBinary.call(this,"PropertyIsEqualTo",e,t,o)};ol.inherits(ol.format.filter.EqualTo,ol.format.filter.ComparisonBinary);goog.provide("ol.format.filter.GreaterThan");goog.require("ol");goog.require("ol.format.filter.ComparisonBinary");ol.format.filter.GreaterThan=function(e,t){ol.format.filter.ComparisonBinary.call(this,"PropertyIsGreaterThan",e,t)};ol.inherits(ol.format.filter.GreaterThan,ol.format.filter.ComparisonBinary);goog.provide("ol.format.filter.GreaterThanOrEqualTo");goog.require("ol");goog.require("ol.format.filter.ComparisonBinary");ol.format.filter.GreaterThanOrEqualTo=function(e,t){ol.format.filter.ComparisonBinary.call(this,"PropertyIsGreaterThanOrEqualTo",e,t)};ol.inherits(ol.format.filter.GreaterThanOrEqualTo,ol.format.filter.ComparisonBinary);goog.provide("ol.format.filter.Spatial");goog.require("ol");goog.require("ol.format.filter.Filter");ol.format.filter.Spatial=function(e,t,o,r){ol.format.filter.Filter.call(this,e);this.geometryName=t||"the_geom";this.geometry=o;this.srsName=r};ol.inherits(ol.format.filter.Spatial,ol.format.filter.Filter);goog.provide("ol.format.filter.Intersects");goog.require("ol");goog.require("ol.format.filter.Spatial");ol.format.filter.Intersects=function(e,t,o){ol.format.filter.Spatial.call(this,"Intersects",e,t,o)};ol.inherits(ol.format.filter.Intersects,ol.format.filter.Spatial);goog.provide("ol.format.filter.IsBetween");goog.require("ol");goog.require("ol.format.filter.Comparison");ol.format.filter.IsBetween=function(e,t,o){ol.format.filter.Comparison.call(this,"PropertyIsBetween",e);this.lowerBoundary=t;this.upperBoundary=o};ol.inherits(ol.format.filter.IsBetween,ol.format.filter.Comparison);goog.provide("ol.format.filter.IsLike");goog.require("ol");goog.require("ol.format.filter.Comparison");ol.format.filter.IsLike=function(e,t,o,r,i,n){ol.format.filter.Comparison.call(this,"PropertyIsLike",e);this.pattern=t;this.wildCard=void 0!==o?o:"*";this.singleChar=void 0!==r?r:".";this.escapeChar=void 0!==i?i:"!";this.matchCase=n};ol.inherits(ol.format.filter.IsLike,ol.format.filter.Comparison);goog.provide("ol.format.filter.IsNull");goog.require("ol");goog.require("ol.format.filter.Comparison");ol.format.filter.IsNull=function(e){ol.format.filter.Comparison.call(this,"PropertyIsNull",e)};ol.inherits(ol.format.filter.IsNull,ol.format.filter.Comparison);goog.provide("ol.format.filter.LessThan");goog.require("ol");goog.require("ol.format.filter.ComparisonBinary");ol.format.filter.LessThan=function(e,t){ol.format.filter.ComparisonBinary.call(this,"PropertyIsLessThan",e,t)};ol.inherits(ol.format.filter.LessThan,ol.format.filter.ComparisonBinary);goog.provide("ol.format.filter.LessThanOrEqualTo");goog.require("ol");goog.require("ol.format.filter.ComparisonBinary");ol.format.filter.LessThanOrEqualTo=function(e,t){ol.format.filter.ComparisonBinary.call(this,"PropertyIsLessThanOrEqualTo",e,t)};ol.inherits(ol.format.filter.LessThanOrEqualTo,ol.format.filter.ComparisonBinary);goog.provide("ol.format.filter.Not");goog.require("ol");goog.require("ol.format.filter.Filter");ol.format.filter.Not=function(e){ol.format.filter.Filter.call(this,"Not");this.condition=e};ol.inherits(ol.format.filter.Not,ol.format.filter.Filter);goog.provide("ol.format.filter.NotEqualTo");goog.require("ol");goog.require("ol.format.filter.ComparisonBinary");ol.format.filter.NotEqualTo=function(e,t,o){ol.format.filter.ComparisonBinary.call(this,"PropertyIsNotEqualTo",e,t,o)};ol.inherits(ol.format.filter.NotEqualTo,ol.format.filter.ComparisonBinary);goog.provide("ol.format.filter.Or");goog.require("ol");goog.require("ol.format.filter.LogicalNary");ol.format.filter.Or=function(e){var t=["Or"].concat(Array.prototype.slice.call(arguments));ol.format.filter.LogicalNary.apply(this,t)};ol.inherits(ol.format.filter.Or,ol.format.filter.LogicalNary);goog.provide("ol.format.filter.Within");goog.require("ol");goog.require("ol.format.filter.Spatial");ol.format.filter.Within=function(e,t,o){ol.format.filter.Spatial.call(this,"Within",e,t,o)};ol.inherits(ol.format.filter.Within,ol.format.filter.Spatial);goog.provide("ol.format.filter");goog.require("ol.format.filter.And");goog.require("ol.format.filter.Bbox");goog.require("ol.format.filter.EqualTo");goog.require("ol.format.filter.GreaterThan");goog.require("ol.format.filter.GreaterThanOrEqualTo");goog.require("ol.format.filter.Intersects");goog.require("ol.format.filter.IsBetween");goog.require("ol.format.filter.IsLike");goog.require("ol.format.filter.IsNull");goog.require("ol.format.filter.LessThan");goog.require("ol.format.filter.LessThanOrEqualTo");goog.require("ol.format.filter.Not");goog.require("ol.format.filter.NotEqualTo");goog.require("ol.format.filter.Or");goog.require("ol.format.filter.Within");ol.format.filter.and=function(e){var t=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(ol.format.filter.And,t))};ol.format.filter.or=function(e){var t=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(ol.format.filter.Or,t))};ol.format.filter.not=function(e){return new ol.format.filter.Not(e)};ol.format.filter.bbox=function(e,t,o){return new ol.format.filter.Bbox(e,t,o)};ol.format.filter.intersects=function(e,t,o){return new ol.format.filter.Intersects(e,t,o)};ol.format.filter.within=function(e,t,o){return new ol.format.filter.Within(e,t,o)};ol.format.filter.equalTo=function(e,t,o){return new ol.format.filter.EqualTo(e,t,o)};ol.format.filter.notEqualTo=function(e,t,o){return new ol.format.filter.NotEqualTo(e,t,o)};ol.format.filter.lessThan=function(e,t){return new ol.format.filter.LessThan(e,t)};ol.format.filter.lessThanOrEqualTo=function(e,t){return new ol.format.filter.LessThanOrEqualTo(e,t)};ol.format.filter.greaterThan=function(e,t){return new ol.format.filter.GreaterThan(e,t)};ol.format.filter.greaterThanOrEqualTo=function(e,t){return new ol.format.filter.GreaterThanOrEqualTo(e,t)};ol.format.filter.isNull=function(e){return new ol.format.filter.IsNull(e)};ol.format.filter.between=function(e,t,o){return new ol.format.filter.IsBetween(e,t,o)};ol.format.filter.like=function(e,t,o,r,i,n){return new ol.format.filter.IsLike(e,t,o,r,i,n)};goog.provide("ol.geom.GeometryCollection");goog.require("ol");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.extent");goog.require("ol.geom.Geometry");goog.require("ol.geom.GeometryType");goog.require("ol.obj");ol.geom.GeometryCollection=function(e){ol.geom.Geometry.call(this);this.geometries_=e?e:null;this.listenGeometriesChange_()};ol.inherits(ol.geom.GeometryCollection,ol.geom.Geometry);ol.geom.GeometryCollection.cloneGeometries_=function(e){var t,o,r=[];for(t=0,o=e.length;o>t;++t)r.push(e[t].clone());return r};ol.geom.GeometryCollection.prototype.unlistenGeometriesChange_=function(){var e,t;if(this.geometries_)for(e=0,t=this.geometries_.length;t>e;++e)ol.events.unlisten(this.geometries_[e],ol.events.EventType.CHANGE,this.changed,this)};ol.geom.GeometryCollection.prototype.listenGeometriesChange_=function(){var e,t;if(this.geometries_)for(e=0,t=this.geometries_.length;t>e;++e)ol.events.listen(this.geometries_[e],ol.events.EventType.CHANGE,this.changed,this)};ol.geom.GeometryCollection.prototype.clone=function(){var e=new ol.geom.GeometryCollection(null);e.setGeometries(this.geometries_);return e};ol.geom.GeometryCollection.prototype.closestPointXY=function(e,t,o,r){if(r<ol.extent.closestSquaredDistanceXY(this.getExtent(),e,t))return r;var i,n,a=this.geometries_;for(i=0,n=a.length;n>i;++i)r=a[i].closestPointXY(e,t,o,r);return r};ol.geom.GeometryCollection.prototype.containsXY=function(e,t){var o,r,i=this.geometries_;for(o=0,r=i.length;r>o;++o)if(i[o].containsXY(e,t))return!0;return!1};ol.geom.GeometryCollection.prototype.computeExtent=function(e){ol.extent.createOrUpdateEmpty(e);for(var t=this.geometries_,o=0,r=t.length;r>o;++o)ol.extent.extend(e,t[o].getExtent());return e};ol.geom.GeometryCollection.prototype.getGeometries=function(){return ol.geom.GeometryCollection.cloneGeometries_(this.geometries_)};ol.geom.GeometryCollection.prototype.getGeometriesArray=function(){return this.geometries_};ol.geom.GeometryCollection.prototype.getSimplifiedGeometry=function(e){if(this.simplifiedGeometryRevision!=this.getRevision()){ol.obj.clear(this.simplifiedGeometryCache);this.simplifiedGeometryMaxMinSquaredTolerance=0;this.simplifiedGeometryRevision=this.getRevision()}if(0>e||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;var t=e.toString();if(this.simplifiedGeometryCache.hasOwnProperty(t))return this.simplifiedGeometryCache[t];var o,r,i=[],n=this.geometries_,a=!1;for(o=0,r=n.length;r>o;++o){var l=n[o],s=l.getSimplifiedGeometry(e);i.push(s);s!==l&&(a=!0)}if(a){var p=new ol.geom.GeometryCollection(null);p.setGeometriesArray(i);this.simplifiedGeometryCache[t]=p;return p}this.simplifiedGeometryMaxMinSquaredTolerance=e;return this};ol.geom.GeometryCollection.prototype.getType=function(){return ol.geom.GeometryType.GEOMETRY_COLLECTION};ol.geom.GeometryCollection.prototype.intersectsExtent=function(e){var t,o,r=this.geometries_;for(t=0,o=r.length;o>t;++t)if(r[t].intersectsExtent(e))return!0;return!1};ol.geom.GeometryCollection.prototype.isEmpty=function(){return 0===this.geometries_.length};ol.geom.GeometryCollection.prototype.rotate=function(e,t){for(var o=this.geometries_,r=0,i=o.length;i>r;++r)o[r].rotate(e,t);this.changed()};ol.geom.GeometryCollection.prototype.scale=function(e,t,o){var r=o;r||(r=ol.extent.getCenter(this.getExtent()));for(var i=this.geometries_,n=0,a=i.length;a>n;++n)i[n].scale(e,t,r);this.changed()};ol.geom.GeometryCollection.prototype.setGeometries=function(e){this.setGeometriesArray(ol.geom.GeometryCollection.cloneGeometries_(e))};ol.geom.GeometryCollection.prototype.setGeometriesArray=function(e){this.unlistenGeometriesChange_();this.geometries_=e;this.listenGeometriesChange_();this.changed()};ol.geom.GeometryCollection.prototype.applyTransform=function(e){var t,o,r=this.geometries_;for(t=0,o=r.length;o>t;++t)r[t].applyTransform(e);this.changed()};ol.geom.GeometryCollection.prototype.translate=function(e,t){var o,r,i=this.geometries_;for(o=0,r=i.length;r>o;++o)i[o].translate(e,t);this.changed()};ol.geom.GeometryCollection.prototype.disposeInternal=function(){this.unlistenGeometriesChange_();ol.geom.Geometry.prototype.disposeInternal.call(this)};goog.provide("ol.format.GeoJSON");goog.require("ol");goog.require("ol.asserts");goog.require("ol.Feature");goog.require("ol.format.Feature");goog.require("ol.format.JSONFeature");goog.require("ol.geom.GeometryCollection");goog.require("ol.geom.LineString");goog.require("ol.geom.MultiLineString");goog.require("ol.geom.MultiPoint");goog.require("ol.geom.MultiPolygon");goog.require("ol.geom.Point");goog.require("ol.geom.Polygon");goog.require("ol.obj");goog.require("ol.proj");ol.format.GeoJSON=function(e){var t=e?e:{};ol.format.JSONFeature.call(this);this.defaultDataProjection=ol.proj.get(t.defaultDataProjection?t.defaultDataProjection:"EPSG:4326");t.featureProjection&&(this.defaultFeatureProjection=ol.proj.get(t.featureProjection));this.geometryName_=t.geometryName};ol.inherits(ol.format.GeoJSON,ol.format.JSONFeature);ol.format.GeoJSON.readGeometry_=function(e,t){if(!e)return null;var o=ol.format.GeoJSON.GEOMETRY_READERS_[e.type];return ol.format.Feature.transformWithOptions(o(e),!1,t)};ol.format.GeoJSON.readGeometryCollectionGeometry_=function(e,t){var o=e.geometries.map(function(e){return ol.format.GeoJSON.readGeometry_(e,t)});return new ol.geom.GeometryCollection(o)};ol.format.GeoJSON.readPointGeometry_=function(e){return new ol.geom.Point(e.coordinates)};ol.format.GeoJSON.readLineStringGeometry_=function(e){return new ol.geom.LineString(e.coordinates)};ol.format.GeoJSON.readMultiLineStringGeometry_=function(e){return new ol.geom.MultiLineString(e.coordinates)};ol.format.GeoJSON.readMultiPointGeometry_=function(e){return new ol.geom.MultiPoint(e.coordinates)};ol.format.GeoJSON.readMultiPolygonGeometry_=function(e){return new ol.geom.MultiPolygon(e.coordinates)};ol.format.GeoJSON.readPolygonGeometry_=function(e){return new ol.geom.Polygon(e.coordinates)};ol.format.GeoJSON.writeGeometry_=function(e,t){var o=ol.format.GeoJSON.GEOMETRY_WRITERS_[e.getType()];return o(ol.format.Feature.transformWithOptions(e,!0,t),t)};ol.format.GeoJSON.writeEmptyGeometryCollectionGeometry_=function(e){return{type:"GeometryCollection",geometries:[]}};ol.format.GeoJSON.writeGeometryCollectionGeometry_=function(e,t){var o=e.getGeometriesArray().map(function(e){var o=ol.obj.assign({},t);delete o.featureProjection;return ol.format.GeoJSON.writeGeometry_(e,o)});return{type:"GeometryCollection",geometries:o}};ol.format.GeoJSON.writeLineStringGeometry_=function(e,t){return{type:"LineString",coordinates:e.getCoordinates()}};ol.format.GeoJSON.writeMultiLineStringGeometry_=function(e,t){return{type:"MultiLineString",coordinates:e.getCoordinates()}};ol.format.GeoJSON.writeMultiPointGeometry_=function(e,t){return{type:"MultiPoint",coordinates:e.getCoordinates()}};ol.format.GeoJSON.writeMultiPolygonGeometry_=function(e,t){var o;t&&(o=t.rightHanded);return{type:"MultiPolygon",coordinates:e.getCoordinates(o)}};ol.format.GeoJSON.writePointGeometry_=function(e,t){return{type:"Point",coordinates:e.getCoordinates()}};ol.format.GeoJSON.writePolygonGeometry_=function(e,t){var o;t&&(o=t.rightHanded);return{type:"Polygon",coordinates:e.getCoordinates(o)}};ol.format.GeoJSON.GEOMETRY_READERS_={Point:ol.format.GeoJSON.readPointGeometry_,LineString:ol.format.GeoJSON.readLineStringGeometry_,Polygon:ol.format.GeoJSON.readPolygonGeometry_,MultiPoint:ol.format.GeoJSON.readMultiPointGeometry_,MultiLineString:ol.format.GeoJSON.readMultiLineStringGeometry_,MultiPolygon:ol.format.GeoJSON.readMultiPolygonGeometry_,GeometryCollection:ol.format.GeoJSON.readGeometryCollectionGeometry_};ol.format.GeoJSON.GEOMETRY_WRITERS_={Point:ol.format.GeoJSON.writePointGeometry_,LineString:ol.format.GeoJSON.writeLineStringGeometry_,Polygon:ol.format.GeoJSON.writePolygonGeometry_,MultiPoint:ol.format.GeoJSON.writeMultiPointGeometry_,MultiLineString:ol.format.GeoJSON.writeMultiLineStringGeometry_,MultiPolygon:ol.format.GeoJSON.writeMultiPolygonGeometry_,GeometryCollection:ol.format.GeoJSON.writeGeometryCollectionGeometry_,Circle:ol.format.GeoJSON.writeEmptyGeometryCollectionGeometry_};ol.format.GeoJSON.prototype.readFeature;ol.format.GeoJSON.prototype.readFeatures;ol.format.GeoJSON.prototype.readFeatureFromObject=function(e,t){var o=null;o="Feature"===e.type?e:{type:"Feature",geometry:e};var r=ol.format.GeoJSON.readGeometry_(o.geometry,t),i=new ol.Feature;this.geometryName_&&i.setGeometryName(this.geometryName_);i.setGeometry(r);void 0!==o.id&&i.setId(o.id);o.properties&&i.setProperties(o.properties);return i};ol.format.GeoJSON.prototype.readFeaturesFromObject=function(e,t){var o=e,r=null;if("FeatureCollection"===o.type){var i=e;r=[];var n,a,l=i.features;for(n=0,a=l.length;a>n;++n)r.push(this.readFeatureFromObject(l[n],t))}else r=[this.readFeatureFromObject(e,t)];return r};ol.format.GeoJSON.prototype.readGeometry;ol.format.GeoJSON.prototype.readGeometryFromObject=function(e,t){return ol.format.GeoJSON.readGeometry_(e,t)};ol.format.GeoJSON.prototype.readProjection;ol.format.GeoJSON.prototype.readProjectionFromObject=function(e){var t,o=e,r=o.crs;r?"name"==r.type?t=ol.proj.get(r.properties.name):"EPSG"==r.type?t=ol.proj.get("EPSG:"+r.properties.code):ol.asserts.assert(!1,36):t=this.defaultDataProjection;return t};ol.format.GeoJSON.prototype.writeFeature;ol.format.GeoJSON.prototype.writeFeatureObject=function(e,t){t=this.adaptOptions(t);var o={type:"Feature"},r=e.getId();void 0!==r&&(o.id=r);var i=e.getGeometry();o.geometry=i?ol.format.GeoJSON.writeGeometry_(i,t):null;var n=e.getProperties();delete n[e.getGeometryName()];o.properties=ol.obj.isEmpty(n)?null:n;return o};ol.format.GeoJSON.prototype.writeFeatures;ol.format.GeoJSON.prototype.writeFeaturesObject=function(e,t){t=this.adaptOptions(t);var o,r,i=[];for(o=0,r=e.length;r>o;++o)i.push(this.writeFeatureObject(e[o],t));return{type:"FeatureCollection",features:i}};ol.format.GeoJSON.prototype.writeGeometry;ol.format.GeoJSON.prototype.writeGeometryObject=function(e,t){return ol.format.GeoJSON.writeGeometry_(e,this.adaptOptions(t))};goog.provide("ol.format.XMLFeature");goog.require("ol");goog.require("ol.array");goog.require("ol.format.Feature");goog.require("ol.format.FormatType");goog.require("ol.xml");ol.format.XMLFeature=function(){this.xmlSerializer_=new XMLSerializer;ol.format.Feature.call(this)};ol.inherits(ol.format.XMLFeature,ol.format.Feature);ol.format.XMLFeature.prototype.getType=function(){return ol.format.FormatType.XML};ol.format.XMLFeature.prototype.readFeature=function(e,t){if(ol.xml.isDocument(e))return this.readFeatureFromDocument(e,t);if(ol.xml.isNode(e))return this.readFeatureFromNode(e,t);if("string"==typeof e){var o=ol.xml.parse(e);return this.readFeatureFromDocument(o,t)}return null};ol.format.XMLFeature.prototype.readFeatureFromDocument=function(e,t){var o=this.readFeaturesFromDocument(e,t);return o.length>0?o[0]:null};ol.format.XMLFeature.prototype.readFeatureFromNode=function(e,t){return null};ol.format.XMLFeature.prototype.readFeatures=function(e,t){if(ol.xml.isDocument(e))return this.readFeaturesFromDocument(e,t);if(ol.xml.isNode(e))return this.readFeaturesFromNode(e,t);if("string"==typeof e){var o=ol.xml.parse(e);return this.readFeaturesFromDocument(o,t)}return[]};ol.format.XMLFeature.prototype.readFeaturesFromDocument=function(e,t){var o,r=[];for(o=e.firstChild;o;o=o.nextSibling)o.nodeType==Node.ELEMENT_NODE&&ol.array.extend(r,this.readFeaturesFromNode(o,t));return r};ol.format.XMLFeature.prototype.readFeaturesFromNode=function(e,t){};ol.format.XMLFeature.prototype.readGeometry=function(e,t){if(ol.xml.isDocument(e))return this.readGeometryFromDocument(e,t);if(ol.xml.isNode(e))return this.readGeometryFromNode(e,t);if("string"==typeof e){var o=ol.xml.parse(e);return this.readGeometryFromDocument(o,t)}return null};ol.format.XMLFeature.prototype.readGeometryFromDocument=function(e,t){return null};ol.format.XMLFeature.prototype.readGeometryFromNode=function(e,t){return null};ol.format.XMLFeature.prototype.readProjection=function(e){if(ol.xml.isDocument(e))return this.readProjectionFromDocument(e);if(ol.xml.isNode(e))return this.readProjectionFromNode(e);if("string"==typeof e){var t=ol.xml.parse(e);return this.readProjectionFromDocument(t)}return null};ol.format.XMLFeature.prototype.readProjectionFromDocument=function(e){return this.defaultDataProjection};ol.format.XMLFeature.prototype.readProjectionFromNode=function(e){return this.defaultDataProjection};ol.format.XMLFeature.prototype.writeFeature=function(e,t){var o=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(o)};ol.format.XMLFeature.prototype.writeFeatureNode=function(e,t){return null};ol.format.XMLFeature.prototype.writeFeatures=function(e,t){var o=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(o)};ol.format.XMLFeature.prototype.writeFeaturesNode=function(e,t){return null};ol.format.XMLFeature.prototype.writeGeometry=function(e,t){var o=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(o)};ol.format.XMLFeature.prototype.writeGeometryNode=function(e,t){return null};goog.provide("ol.format.GMLBase");goog.require("ol");goog.require("ol.array");goog.require("ol.Feature");goog.require("ol.format.Feature");goog.require("ol.format.XMLFeature");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.LineString");goog.require("ol.geom.LinearRing");goog.require("ol.geom.MultiLineString");goog.require("ol.geom.MultiPoint");goog.require("ol.geom.MultiPolygon");goog.require("ol.geom.Point");goog.require("ol.geom.Polygon");goog.require("ol.obj");goog.require("ol.proj");goog.require("ol.xml");ol.format.GMLBase=function(e){var t=e?e:{};this.featureType=t.featureType;this.featureNS=t.featureNS;this.srsName=t.srsName;this.schemaLocation="";this.FEATURE_COLLECTION_PARSERS={};this.FEATURE_COLLECTION_PARSERS[ol.format.GMLBase.GMLNS]={featureMember:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readFeaturesInternal),featureMembers:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readFeaturesInternal)};ol.format.XMLFeature.call(this)};ol.inherits(ol.format.GMLBase,ol.format.XMLFeature);ol.format.GMLBase.GMLNS="http://www.opengis.net/gml";ol.format.GMLBase.ONLY_WHITESPACE_RE_=/^[\s\xa0]*$/;ol.format.GMLBase.prototype.readFeaturesInternal=function(e,t){var o=e.localName,r=null;if("FeatureCollection"==o)r="http://www.opengis.net/wfs"===e.namespaceURI?ol.xml.pushParseAndPop([],this.FEATURE_COLLECTION_PARSERS,e,t,this):ol.xml.pushParseAndPop(null,this.FEATURE_COLLECTION_PARSERS,e,t,this);else if("featureMembers"==o||"featureMember"==o){var i,n,a=t[0],l=a.featureType,s=a.featureNS,p="p",c="p0";if(!l&&e.childNodes){l=[],s={};for(i=0,n=e.childNodes.length;n>i;++i){var u=e.childNodes[i];if(1===u.nodeType){var g=u.nodeName.split(":").pop();if(-1===l.indexOf(g)){var d="",h=0,f=u.namespaceURI;for(var y in s){if(s[y]===f){d=y;break}++h}if(!d){d=p+h;s[d]=f}l.push(d+":"+g)}}}if("featureMember"!=o){a.featureType=l;a.featureNS=s}}if("string"==typeof s){var m=s;s={};s[c]=m}var v={},C=Array.isArray(l)?l:[l];for(var T in s){var _={};for(i=0,n=C.length;n>i;++i){var S=-1===C[i].indexOf(":")?c:C[i].split(":")[0];S===T&&(_[C[i].split(":").pop()]="featureMembers"==o?ol.xml.makeArrayPusher(this.readFeatureElement,this):ol.xml.makeReplacer(this.readFeatureElement,this))}v[s[T]]=_}r="featureMember"==o?ol.xml.pushParseAndPop(void 0,v,e,t):ol.xml.pushParseAndPop([],v,e,t)}null===r&&(r=[]);return r};ol.format.GMLBase.prototype.readGeometryElement=function(e,t){var o=t[0];o.srsName=e.firstElementChild.getAttribute("srsName");var r=ol.xml.pushParseAndPop(null,this.GEOMETRY_PARSERS_,e,t,this);return r?ol.format.Feature.transformWithOptions(r,!1,o):void 0};ol.format.GMLBase.prototype.readFeatureElement=function(e,t){var o,r,i=e.getAttribute("fid")||ol.xml.getAttributeNS(e,ol.format.GMLBase.GMLNS,"id"),n={};for(o=e.firstElementChild;o;o=o.nextElementSibling){var a=o.localName;if(0===o.childNodes.length||1===o.childNodes.length&&(3===o.firstChild.nodeType||4===o.firstChild.nodeType)){var l=ol.xml.getAllTextContent(o,!1);ol.format.GMLBase.ONLY_WHITESPACE_RE_.test(l)&&(l=void 0);n[a]=l}else{"boundedBy"!==a&&(r=a);n[a]=this.readGeometryElement(o,t)}}var s=new ol.Feature(n);r&&s.setGeometryName(r);i&&s.setId(i);return s};ol.format.GMLBase.prototype.readPoint=function(e,t){var o=this.readFlatCoordinatesFromNode_(e,t);if(o){var r=new ol.geom.Point(null);r.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,o);return r}};ol.format.GMLBase.prototype.readMultiPoint=function(e,t){var o=ol.xml.pushParseAndPop([],this.MULTIPOINT_PARSERS_,e,t,this);return o?new ol.geom.MultiPoint(o):void 0};ol.format.GMLBase.prototype.readMultiLineString=function(e,t){var o=ol.xml.pushParseAndPop([],this.MULTILINESTRING_PARSERS_,e,t,this);if(o){var r=new ol.geom.MultiLineString(null);r.setLineStrings(o);return r}return void 0};ol.format.GMLBase.prototype.readMultiPolygon=function(e,t){var o=ol.xml.pushParseAndPop([],this.MULTIPOLYGON_PARSERS_,e,t,this);if(o){var r=new ol.geom.MultiPolygon(null);r.setPolygons(o);return r}return void 0};ol.format.GMLBase.prototype.pointMemberParser_=function(e,t){ol.xml.parseNode(this.POINTMEMBER_PARSERS_,e,t,this)};ol.format.GMLBase.prototype.lineStringMemberParser_=function(e,t){ol.xml.parseNode(this.LINESTRINGMEMBER_PARSERS_,e,t,this)};ol.format.GMLBase.prototype.polygonMemberParser_=function(e,t){ol.xml.parseNode(this.POLYGONMEMBER_PARSERS_,e,t,this)};ol.format.GMLBase.prototype.readLineString=function(e,t){var o=this.readFlatCoordinatesFromNode_(e,t);if(o){var r=new ol.geom.LineString(null);r.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,o);return r}return void 0};ol.format.GMLBase.prototype.readFlatLinearRing_=function(e,t){var o=ol.xml.pushParseAndPop(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS_,e,t,this);return o?o:void 0};ol.format.GMLBase.prototype.readLinearRing=function(e,t){var o=this.readFlatCoordinatesFromNode_(e,t);if(o){var r=new ol.geom.LinearRing(null);r.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,o);return r}return void 0};ol.format.GMLBase.prototype.readPolygon=function(e,t){var o=ol.xml.pushParseAndPop([null],this.FLAT_LINEAR_RINGS_PARSERS_,e,t,this);if(o&&o[0]){var r,i,n=new ol.geom.Polygon(null),a=o[0],l=[a.length];for(r=1,i=o.length;i>r;++r){ol.array.extend(a,o[r]);l.push(a.length)}n.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,a,l);return n}return void 0};ol.format.GMLBase.prototype.readFlatCoordinatesFromNode_=function(e,t){return ol.xml.pushParseAndPop(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS_,e,t,this)};ol.format.GMLBase.prototype.MULTIPOINT_PARSERS_={"http://www.opengis.net/gml":{pointMember:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.pointMemberParser_),pointMembers:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.pointMemberParser_)}};ol.format.GMLBase.prototype.MULTILINESTRING_PARSERS_={"http://www.opengis.net/gml":{lineStringMember:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.lineStringMemberParser_),lineStringMembers:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.lineStringMemberParser_)}};ol.format.GMLBase.prototype.MULTIPOLYGON_PARSERS_={"http://www.opengis.net/gml":{polygonMember:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.polygonMemberParser_),polygonMembers:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.polygonMemberParser_)}};ol.format.GMLBase.prototype.POINTMEMBER_PARSERS_={"http://www.opengis.net/gml":{Point:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.readFlatCoordinatesFromNode_)}};ol.format.GMLBase.prototype.LINESTRINGMEMBER_PARSERS_={"http://www.opengis.net/gml":{LineString:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.readLineString)}};ol.format.GMLBase.prototype.POLYGONMEMBER_PARSERS_={"http://www.opengis.net/gml":{Polygon:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.readPolygon)}};ol.format.GMLBase.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readFlatLinearRing_)}};ol.format.GMLBase.prototype.readGeometryFromNode=function(e,t){var o=this.readGeometryElement(e,[this.getReadOptions(e,t?t:{})]);return o?o:null};ol.format.GMLBase.prototype.readFeatures;ol.format.GMLBase.prototype.readFeaturesFromNode=function(e,t){var o={featureType:this.featureType,featureNS:this.featureNS};t&&ol.obj.assign(o,this.getReadOptions(e,t));var r=this.readFeaturesInternal(e,[o]);return r||[]};ol.format.GMLBase.prototype.readProjectionFromNode=function(e){return ol.proj.get(this.srsName?this.srsName:e.firstElementChild.getAttribute("srsName"))};goog.provide("ol.format.XSD");goog.require("ol.xml");goog.require("ol.string");ol.format.XSD.NAMESPACE_URI="http://www.w3.org/2001/XMLSchema";ol.format.XSD.readBoolean=function(e){var t=ol.xml.getAllTextContent(e,!1);return ol.format.XSD.readBooleanString(t)};ol.format.XSD.readBooleanString=function(e){var t=/^\s*(true|1)|(false|0)\s*$/.exec(e);return t?void 0!==t[1]||!1:void 0};ol.format.XSD.readDateTime=function(e){var t=ol.xml.getAllTextContent(e,!1),o=Date.parse(t);return isNaN(o)?void 0:o/1e3};ol.format.XSD.readDecimal=function(e){var t=ol.xml.getAllTextContent(e,!1);return ol.format.XSD.readDecimalString(t)};ol.format.XSD.readDecimalString=function(e){var t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(e);return t?parseFloat(t[1]):void 0};ol.format.XSD.readNonNegativeInteger=function(e){var t=ol.xml.getAllTextContent(e,!1);return ol.format.XSD.readNonNegativeIntegerString(t)};ol.format.XSD.readNonNegativeIntegerString=function(e){var t=/^\s*(\d+)\s*$/.exec(e);return t?parseInt(t[1],10):void 0};ol.format.XSD.readString=function(e){return ol.xml.getAllTextContent(e,!1).trim()};ol.format.XSD.writeBooleanTextNode=function(e,t){ol.format.XSD.writeStringTextNode(e,t?"1":"0")};ol.format.XSD.writeCDATASection=function(e,t){e.appendChild(ol.xml.DOCUMENT.createCDATASection(t))};ol.format.XSD.writeDateTimeTextNode=function(e,t){var o=new Date(1e3*t),r=o.getUTCFullYear()+"-"+ol.string.padNumber(o.getUTCMonth()+1,2)+"-"+ol.string.padNumber(o.getUTCDate(),2)+"T"+ol.string.padNumber(o.getUTCHours(),2)+":"+ol.string.padNumber(o.getUTCMinutes(),2)+":"+ol.string.padNumber(o.getUTCSeconds(),2)+"Z";e.appendChild(ol.xml.DOCUMENT.createTextNode(r))};ol.format.XSD.writeDecimalTextNode=function(e,t){var o=t.toPrecision();e.appendChild(ol.xml.DOCUMENT.createTextNode(o))};ol.format.XSD.writeNonNegativeIntegerTextNode=function(e,t){var o=t.toString();e.appendChild(ol.xml.DOCUMENT.createTextNode(o))};ol.format.XSD.writeStringTextNode=function(e,t){e.appendChild(ol.xml.DOCUMENT.createTextNode(t))};goog.provide("ol.format.GML3");goog.require("ol");goog.require("ol.array");goog.require("ol.extent");goog.require("ol.format.Feature");goog.require("ol.format.GMLBase");goog.require("ol.format.XSD");goog.require("ol.geom.Geometry");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.LineString");goog.require("ol.geom.MultiLineString");goog.require("ol.geom.MultiPolygon");goog.require("ol.geom.Polygon");goog.require("ol.obj");goog.require("ol.proj");goog.require("ol.xml");ol.format.GML3=function(e){var t=e?e:{};ol.format.GMLBase.call(this,t);this.surface_=void 0!==t.surface?t.surface:!1;this.curve_=void 0!==t.curve?t.curve:!1;this.multiCurve_=void 0!==t.multiCurve?t.multiCurve:!0;

this.multiSurface_=void 0!==t.multiSurface?t.multiSurface:!0;this.schemaLocation=t.schemaLocation?t.schemaLocation:ol.format.GML3.schemaLocation_};ol.inherits(ol.format.GML3,ol.format.GMLBase);ol.format.GML3.schemaLocation_=ol.format.GMLBase.GMLNS+" http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd";ol.format.GML3.prototype.readMultiCurve_=function(e,t){var o=ol.xml.pushParseAndPop([],this.MULTICURVE_PARSERS_,e,t,this);if(o){var r=new ol.geom.MultiLineString(null);r.setLineStrings(o);return r}return void 0};ol.format.GML3.prototype.readMultiSurface_=function(e,t){var o=ol.xml.pushParseAndPop([],this.MULTISURFACE_PARSERS_,e,t,this);if(o){var r=new ol.geom.MultiPolygon(null);r.setPolygons(o);return r}return void 0};ol.format.GML3.prototype.curveMemberParser_=function(e,t){ol.xml.parseNode(this.CURVEMEMBER_PARSERS_,e,t,this)};ol.format.GML3.prototype.surfaceMemberParser_=function(e,t){ol.xml.parseNode(this.SURFACEMEMBER_PARSERS_,e,t,this)};ol.format.GML3.prototype.readPatch_=function(e,t){return ol.xml.pushParseAndPop([null],this.PATCHES_PARSERS_,e,t,this)};ol.format.GML3.prototype.readSegment_=function(e,t){return ol.xml.pushParseAndPop([null],this.SEGMENTS_PARSERS_,e,t,this)};ol.format.GML3.prototype.readPolygonPatch_=function(e,t){return ol.xml.pushParseAndPop([null],this.FLAT_LINEAR_RINGS_PARSERS_,e,t,this)};ol.format.GML3.prototype.readLineStringSegment_=function(e,t){return ol.xml.pushParseAndPop([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS_,e,t,this)};ol.format.GML3.prototype.interiorParser_=function(e,t){var o=ol.xml.pushParseAndPop(void 0,this.RING_PARSERS,e,t,this);if(o){var r=t[t.length-1];r.push(o)}};ol.format.GML3.prototype.exteriorParser_=function(e,t){var o=ol.xml.pushParseAndPop(void 0,this.RING_PARSERS,e,t,this);if(o){var r=t[t.length-1];r[0]=o}};ol.format.GML3.prototype.readSurface_=function(e,t){var o=ol.xml.pushParseAndPop([null],this.SURFACE_PARSERS_,e,t,this);if(o&&o[0]){var r,i,n=new ol.geom.Polygon(null),a=o[0],l=[a.length];for(r=1,i=o.length;i>r;++r){ol.array.extend(a,o[r]);l.push(a.length)}n.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,a,l);return n}return void 0};ol.format.GML3.prototype.readCurve_=function(e,t){var o=ol.xml.pushParseAndPop([null],this.CURVE_PARSERS_,e,t,this);if(o){var r=new ol.geom.LineString(null);r.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,o);return r}return void 0};ol.format.GML3.prototype.readEnvelope_=function(e,t){var o=ol.xml.pushParseAndPop([null],this.ENVELOPE_PARSERS_,e,t,this);return ol.extent.createOrUpdate(o[1][0],o[1][1],o[2][0],o[2][1])};ol.format.GML3.prototype.readFlatPos_=function(e,t){for(var o,r=ol.xml.getAllTextContent(e,!1),i=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,n=[];o=i.exec(r);){n.push(parseFloat(o[1]));r=r.substr(o[0].length)}if(""!==r)return void 0;var a=t[0],l=a.srsName,s="enu";if(l){var p=ol.proj.get(l);s=p.getAxisOrientation()}if("neu"===s){var c,u;for(c=0,u=n.length;u>c;c+=3){var g=n[c],d=n[c+1];n[c]=d;n[c+1]=g}}var h=n.length;2==h&&n.push(0);return 0===h?void 0:n};ol.format.GML3.prototype.readFlatPosList_=function(e,t){var o=ol.xml.getAllTextContent(e,!1).replace(/^\s*|\s*$/g,""),r=t[0],i=r.srsName,n=e.parentNode.getAttribute("srsDimension"),a="enu";if(i){var l=ol.proj.get(i);a=l.getAxisOrientation()}var s=o.split(/\s+/),p=2;e.getAttribute("srsDimension")?p=ol.format.XSD.readNonNegativeIntegerString(e.getAttribute("srsDimension")):e.getAttribute("dimension")?p=ol.format.XSD.readNonNegativeIntegerString(e.getAttribute("dimension")):n&&(p=ol.format.XSD.readNonNegativeIntegerString(n));for(var c,u,g,d=[],h=0,f=s.length;f>h;h+=p){c=parseFloat(s[h]);u=parseFloat(s[h+1]);g=3===p?parseFloat(s[h+2]):0;"en"===a.substr(0,2)?d.push(c,u,g):d.push(u,c,g)}return d};ol.format.GML3.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS_={"http://www.opengis.net/gml":{pos:ol.xml.makeReplacer(ol.format.GML3.prototype.readFlatPos_),posList:ol.xml.makeReplacer(ol.format.GML3.prototype.readFlatPosList_)}};ol.format.GML3.prototype.FLAT_LINEAR_RINGS_PARSERS_={"http://www.opengis.net/gml":{interior:ol.format.GML3.prototype.interiorParser_,exterior:ol.format.GML3.prototype.exteriorParser_}};ol.format.GML3.prototype.GEOMETRY_PARSERS_={"http://www.opengis.net/gml":{Point:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readPoint),MultiPoint:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readMultiPoint),LineString:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readLineString),MultiLineString:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readMultiLineString),LinearRing:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readLinearRing),Polygon:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readPolygon),MultiPolygon:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readMultiPolygon),Surface:ol.xml.makeReplacer(ol.format.GML3.prototype.readSurface_),MultiSurface:ol.xml.makeReplacer(ol.format.GML3.prototype.readMultiSurface_),Curve:ol.xml.makeReplacer(ol.format.GML3.prototype.readCurve_),MultiCurve:ol.xml.makeReplacer(ol.format.GML3.prototype.readMultiCurve_),Envelope:ol.xml.makeReplacer(ol.format.GML3.prototype.readEnvelope_)}};ol.format.GML3.prototype.MULTICURVE_PARSERS_={"http://www.opengis.net/gml":{curveMember:ol.xml.makeArrayPusher(ol.format.GML3.prototype.curveMemberParser_),curveMembers:ol.xml.makeArrayPusher(ol.format.GML3.prototype.curveMemberParser_)}};ol.format.GML3.prototype.MULTISURFACE_PARSERS_={"http://www.opengis.net/gml":{surfaceMember:ol.xml.makeArrayPusher(ol.format.GML3.prototype.surfaceMemberParser_),surfaceMembers:ol.xml.makeArrayPusher(ol.format.GML3.prototype.surfaceMemberParser_)}};ol.format.GML3.prototype.CURVEMEMBER_PARSERS_={"http://www.opengis.net/gml":{LineString:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.readLineString),Curve:ol.xml.makeArrayPusher(ol.format.GML3.prototype.readCurve_)}};ol.format.GML3.prototype.SURFACEMEMBER_PARSERS_={"http://www.opengis.net/gml":{Polygon:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.readPolygon),Surface:ol.xml.makeArrayPusher(ol.format.GML3.prototype.readSurface_)}};ol.format.GML3.prototype.SURFACE_PARSERS_={"http://www.opengis.net/gml":{patches:ol.xml.makeReplacer(ol.format.GML3.prototype.readPatch_)}};ol.format.GML3.prototype.CURVE_PARSERS_={"http://www.opengis.net/gml":{segments:ol.xml.makeReplacer(ol.format.GML3.prototype.readSegment_)}};ol.format.GML3.prototype.ENVELOPE_PARSERS_={"http://www.opengis.net/gml":{lowerCorner:ol.xml.makeArrayPusher(ol.format.GML3.prototype.readFlatPosList_),upperCorner:ol.xml.makeArrayPusher(ol.format.GML3.prototype.readFlatPosList_)}};ol.format.GML3.prototype.PATCHES_PARSERS_={"http://www.opengis.net/gml":{PolygonPatch:ol.xml.makeReplacer(ol.format.GML3.prototype.readPolygonPatch_)}};ol.format.GML3.prototype.SEGMENTS_PARSERS_={"http://www.opengis.net/gml":{LineStringSegment:ol.xml.makeReplacer(ol.format.GML3.prototype.readLineStringSegment_)}};ol.format.GML3.prototype.writePos_=function(e,t,o){var r=o[o.length-1],i=r.srsName,n="enu";i&&(n=ol.proj.get(i).getAxisOrientation());var a,l=t.getCoordinates();a="en"===n.substr(0,2)?l[0]+" "+l[1]:l[1]+" "+l[0];ol.format.XSD.writeStringTextNode(e,a)};ol.format.GML3.prototype.getCoords_=function(e,t){var o="enu";t&&(o=ol.proj.get(t).getAxisOrientation());return"en"===o.substr(0,2)?e[0]+" "+e[1]:e[1]+" "+e[0]};ol.format.GML3.prototype.writePosList_=function(e,t,o){for(var r,i=o[o.length-1],n=i.srsName,a=t.getCoordinates(),l=a.length,s=new Array(l),p=0;l>p;++p){r=a[p];s[p]=this.getCoords_(r,n)}ol.format.XSD.writeStringTextNode(e,s.join(" "))};ol.format.GML3.prototype.writePoint_=function(e,t,o){var r=o[o.length-1],i=r.srsName;i&&e.setAttribute("srsName",i);var n=ol.xml.createElementNS(e.namespaceURI,"pos");e.appendChild(n);this.writePos_(n,t,o)};ol.format.GML3.ENVELOPE_SERIALIZERS_={"http://www.opengis.net/gml":{lowerCorner:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),upperCorner:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode)}};ol.format.GML3.prototype.writeEnvelope=function(e,t,o){var r=o[o.length-1],i=r.srsName;i&&e.setAttribute("srsName",i);var n=["lowerCorner","upperCorner"],a=[t[0]+" "+t[1],t[2]+" "+t[3]];ol.xml.pushSerializeAndPop({node:e},ol.format.GML3.ENVELOPE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,a,o,n,this)};ol.format.GML3.prototype.writeLinearRing_=function(e,t,o){var r=o[o.length-1],i=r.srsName;i&&e.setAttribute("srsName",i);var n=ol.xml.createElementNS(e.namespaceURI,"posList");e.appendChild(n);this.writePosList_(n,t,o)};ol.format.GML3.prototype.RING_NODE_FACTORY_=function(e,t,o){var r=t[t.length-1],i=r.node,n=r.exteriorWritten;void 0===n&&(r.exteriorWritten=!0);return ol.xml.createElementNS(i.namespaceURI,void 0!==n?"interior":"exterior")};ol.format.GML3.prototype.writeSurfaceOrPolygon_=function(e,t,o){var r=o[o.length-1],i=r.srsName;"PolygonPatch"!==e.nodeName&&i&&e.setAttribute("srsName",i);if("Polygon"===e.nodeName||"PolygonPatch"===e.nodeName){var n=t.getLinearRings();ol.xml.pushSerializeAndPop({node:e,srsName:i},ol.format.GML3.RING_SERIALIZERS_,this.RING_NODE_FACTORY_,n,o,void 0,this)}else if("Surface"===e.nodeName){var a=ol.xml.createElementNS(e.namespaceURI,"patches");e.appendChild(a);this.writeSurfacePatches_(a,t,o)}};ol.format.GML3.prototype.writeCurveOrLineString_=function(e,t,o){var r=o[o.length-1],i=r.srsName;"LineStringSegment"!==e.nodeName&&i&&e.setAttribute("srsName",i);if("LineString"===e.nodeName||"LineStringSegment"===e.nodeName){var n=ol.xml.createElementNS(e.namespaceURI,"posList");e.appendChild(n);this.writePosList_(n,t,o)}else if("Curve"===e.nodeName){var a=ol.xml.createElementNS(e.namespaceURI,"segments");e.appendChild(a);this.writeCurveSegments_(a,t,o)}};ol.format.GML3.prototype.writeMultiSurfaceOrPolygon_=function(e,t,o){var r=o[o.length-1],i=r.srsName,n=r.surface;i&&e.setAttribute("srsName",i);var a=t.getPolygons();ol.xml.pushSerializeAndPop({node:e,srsName:i,surface:n},ol.format.GML3.SURFACEORPOLYGONMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,o,void 0,this)};ol.format.GML3.prototype.writeMultiPoint_=function(e,t,o){var r=o[o.length-1],i=r.srsName;i&&e.setAttribute("srsName",i);var n=t.getPoints();ol.xml.pushSerializeAndPop({node:e,srsName:i},ol.format.GML3.POINTMEMBER_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("pointMember"),n,o,void 0,this)};ol.format.GML3.prototype.writeMultiCurveOrLineString_=function(e,t,o){var r=o[o.length-1],i=r.srsName,n=r.curve;i&&e.setAttribute("srsName",i);var a=t.getLineStrings();ol.xml.pushSerializeAndPop({node:e,srsName:i,curve:n},ol.format.GML3.LINESTRINGORCURVEMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,o,void 0,this)};ol.format.GML3.prototype.writeRing_=function(e,t,o){var r=ol.xml.createElementNS(e.namespaceURI,"LinearRing");e.appendChild(r);this.writeLinearRing_(r,t,o)};ol.format.GML3.prototype.writeSurfaceOrPolygonMember_=function(e,t,o){var r=this.GEOMETRY_NODE_FACTORY_(t,o);if(r){e.appendChild(r);this.writeSurfaceOrPolygon_(r,t,o)}};ol.format.GML3.prototype.writePointMember_=function(e,t,o){var r=ol.xml.createElementNS(e.namespaceURI,"Point");e.appendChild(r);this.writePoint_(r,t,o)};ol.format.GML3.prototype.writeLineStringOrCurveMember_=function(e,t,o){var r=this.GEOMETRY_NODE_FACTORY_(t,o);if(r){e.appendChild(r);this.writeCurveOrLineString_(r,t,o)}};ol.format.GML3.prototype.writeSurfacePatches_=function(e,t,o){var r=ol.xml.createElementNS(e.namespaceURI,"PolygonPatch");e.appendChild(r);this.writeSurfaceOrPolygon_(r,t,o)};ol.format.GML3.prototype.writeCurveSegments_=function(e,t,o){var r=ol.xml.createElementNS(e.namespaceURI,"LineStringSegment");e.appendChild(r);this.writeCurveOrLineString_(r,t,o)};ol.format.GML3.prototype.writeGeometryElement=function(e,t,o){var r=o[o.length-1],i=ol.obj.assign({},r);i.node=e;var n;n=Array.isArray(t)?r.dataProjection?ol.proj.transformExtent(t,r.featureProjection,r.dataProjection):t:ol.format.Feature.transformWithOptions(t,!0,r);ol.xml.pushSerializeAndPop(i,ol.format.GML3.GEOMETRY_SERIALIZERS_,this.GEOMETRY_NODE_FACTORY_,[n],o,void 0,this)};ol.format.GML3.prototype.writeFeatureElement=function(e,t,o){var r=t.getId();r&&e.setAttribute("fid",r);var i=o[o.length-1],n=i.featureNS,a=t.getGeometryName();if(!i.serializers){i.serializers={};i.serializers[n]={}}var l=t.getProperties(),s=[],p=[];for(var c in l){var u=l[c];if(null!==u){s.push(c);p.push(u);c==a||u instanceof ol.geom.Geometry?c in i.serializers[n]||(i.serializers[n][c]=ol.xml.makeChildAppender(this.writeGeometryElement,this)):c in i.serializers[n]||(i.serializers[n][c]=ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode))}}var g=ol.obj.assign({},i);g.node=e;ol.xml.pushSerializeAndPop(g,i.serializers,ol.xml.makeSimpleNodeFactory(void 0,n),p,o,s)};ol.format.GML3.prototype.writeFeatureMembers_=function(e,t,o){var r=o[o.length-1],i=r.featureType,n=r.featureNS,a={};a[n]={};a[n][i]=ol.xml.makeChildAppender(this.writeFeatureElement,this);var l=ol.obj.assign({},r);l.node=e;ol.xml.pushSerializeAndPop(l,a,ol.xml.makeSimpleNodeFactory(i,n),t,o)};ol.format.GML3.SURFACEORPOLYGONMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{surfaceMember:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeSurfaceOrPolygonMember_),polygonMember:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeSurfaceOrPolygonMember_)}};ol.format.GML3.POINTMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{pointMember:ol.xml.makeChildAppender(ol.format.GML3.prototype.writePointMember_)}};ol.format.GML3.LINESTRINGORCURVEMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{lineStringMember:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeLineStringOrCurveMember_),curveMember:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeLineStringOrCurveMember_)}};ol.format.GML3.RING_SERIALIZERS_={"http://www.opengis.net/gml":{exterior:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeRing_),interior:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeRing_)}};ol.format.GML3.GEOMETRY_SERIALIZERS_={"http://www.opengis.net/gml":{Curve:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeCurveOrLineString_),MultiCurve:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeMultiCurveOrLineString_),Point:ol.xml.makeChildAppender(ol.format.GML3.prototype.writePoint_),MultiPoint:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeMultiPoint_),LineString:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeCurveOrLineString_),MultiLineString:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeMultiCurveOrLineString_),LinearRing:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeLinearRing_),Polygon:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeSurfaceOrPolygon_),MultiPolygon:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeMultiSurfaceOrPolygon_),Surface:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeSurfaceOrPolygon_),MultiSurface:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeMultiSurfaceOrPolygon_),Envelope:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeEnvelope)}};ol.format.GML3.MULTIGEOMETRY_TO_MEMBER_NODENAME_={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};ol.format.GML3.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(e,t,o){var r=t[t.length-1].node;return ol.xml.createElementNS("http://www.opengis.net/gml",ol.format.GML3.MULTIGEOMETRY_TO_MEMBER_NODENAME_[r.nodeName])};ol.format.GML3.prototype.GEOMETRY_NODE_FACTORY_=function(e,t,o){var r,i=t[t.length-1],n=i.multiSurface,a=i.surface,l=i.curve,s=i.multiCurve;if(Array.isArray(e))r="Envelope";else{r=e.getType();"MultiPolygon"===r&&n===!0?r="MultiSurface":"Polygon"===r&&a===!0?r="Surface":"LineString"===r&&l===!0?r="Curve":"MultiLineString"===r&&s===!0&&(r="MultiCurve")}return ol.xml.createElementNS("http://www.opengis.net/gml",r)};ol.format.GML3.prototype.writeGeometryNode=function(e,t){t=this.adaptOptions(t);var o=ol.xml.createElementNS("http://www.opengis.net/gml","geom"),r={node:o,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};t&&ol.obj.assign(r,t);this.writeGeometryElement(o,e,[r]);return o};ol.format.GML3.prototype.writeFeatures;ol.format.GML3.prototype.writeFeaturesNode=function(e,t){t=this.adaptOptions(t);var o=ol.xml.createElementNS("http://www.opengis.net/gml","featureMembers");ol.xml.setAttributeNS(o,"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation",this.schemaLocation);var r={srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};t&&ol.obj.assign(r,t);this.writeFeatureMembers_(o,e,[r]);return o};goog.provide("ol.format.GML");goog.require("ol.format.GML3");ol.format.GML=ol.format.GML3;ol.format.GML.prototype.writeFeatures;ol.format.GML.prototype.writeFeaturesNode;goog.provide("ol.format.GML2");goog.require("ol");goog.require("ol.extent");goog.require("ol.format.Feature");goog.require("ol.format.GMLBase");goog.require("ol.format.XSD");goog.require("ol.obj");goog.require("ol.proj");goog.require("ol.xml");ol.format.GML2=function(e){var t=e?e:{};ol.format.GMLBase.call(this,t);this.FEATURE_COLLECTION_PARSERS[ol.format.GMLBase.GMLNS].featureMember=ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.readFeaturesInternal);this.schemaLocation=t.schemaLocation?t.schemaLocation:ol.format.GML2.schemaLocation_};ol.inherits(ol.format.GML2,ol.format.GMLBase);ol.format.GML2.schemaLocation_=ol.format.GMLBase.GMLNS+" http://schemas.opengis.net/gml/2.1.2/feature.xsd";ol.format.GML2.prototype.readFlatCoordinates_=function(e,t){var o=ol.xml.getAllTextContent(e,!1).replace(/^\s*|\s*$/g,""),r=t[0],i=r.srsName,n="enu";if(i){var a=ol.proj.get(i);a&&(n=a.getAxisOrientation())}for(var l,s,p,c=o.trim().split(/\s+/),u=[],g=0,d=c.length;d>g;g++){var h=c[g].split(/,+/);l=parseFloat(h[0]);s=parseFloat(h[1]);p=3===h.length?parseFloat(h[2]):0;"en"===n.substr(0,2)?u.push(l,s,p):u.push(s,l,p)}return u};ol.format.GML2.prototype.readBox_=function(e,t){var o=ol.xml.pushParseAndPop([null],this.BOX_PARSERS_,e,t,this);return ol.extent.createOrUpdate(o[1][0],o[1][1],o[1][3],o[1][4])};ol.format.GML2.prototype.innerBoundaryIsParser_=function(e,t){var o=ol.xml.pushParseAndPop(void 0,this.RING_PARSERS,e,t,this);if(o){var r=t[t.length-1];r.push(o)}};ol.format.GML2.prototype.outerBoundaryIsParser_=function(e,t){var o=ol.xml.pushParseAndPop(void 0,this.RING_PARSERS,e,t,this);if(o){var r=t[t.length-1];r[0]=o}};ol.format.GML2.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS_={"http://www.opengis.net/gml":{coordinates:ol.xml.makeReplacer(ol.format.GML2.prototype.readFlatCoordinates_)}};ol.format.GML2.prototype.FLAT_LINEAR_RINGS_PARSERS_={"http://www.opengis.net/gml":{innerBoundaryIs:ol.format.GML2.prototype.innerBoundaryIsParser_,outerBoundaryIs:ol.format.GML2.prototype.outerBoundaryIsParser_}};ol.format.GML2.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:ol.xml.makeArrayPusher(ol.format.GML2.prototype.readFlatCoordinates_)}};ol.format.GML2.prototype.GEOMETRY_PARSERS_={"http://www.opengis.net/gml":{Point:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readPoint),MultiPoint:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readMultiPoint),LineString:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readLineString),MultiLineString:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readMultiLineString),LinearRing:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readLinearRing),Polygon:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readPolygon),MultiPolygon:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readMultiPolygon),Box:ol.xml.makeReplacer(ol.format.GML2.prototype.readBox_)}};ol.format.GML2.prototype.GEOMETRY_NODE_FACTORY_=function(e,t,o){var r,i=t[t.length-1],n=i.multiSurface,a=i.surface,l=i.multiCurve;if(Array.isArray(e))r="Envelope";else{r=e.getType();"MultiPolygon"===r&&n===!0?r="MultiSurface":"Polygon"===r&&a===!0?r="Surface":"MultiLineString"===r&&l===!0&&(r="MultiCurve")}return ol.xml.createElementNS("http://www.opengis.net/gml",r)};ol.format.GML2.prototype.writeFeatureElement=function(e,t,o){var r=t.getId();r&&e.setAttribute("fid",r);var i=o[o.length-1],n=i.featureNS,a=t.getGeometryName();if(!i.serializers){i.serializers={};i.serializers[n]={}}var l=t.getProperties(),s=[],p=[];for(var c in l){var u=l[c];if(null!==u){s.push(c);p.push(u);c==a||u instanceof ol.geom.Geometry?c in i.serializers[n]||(i.serializers[n][c]=ol.xml.makeChildAppender(this.writeGeometryElement,this)):c in i.serializers[n]||(i.serializers[n][c]=ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode))}}var g=ol.obj.assign({},i);g.node=e;ol.xml.pushSerializeAndPop(g,i.serializers,ol.xml.makeSimpleNodeFactory(void 0,n),p,o,s)};ol.format.GML2.prototype.writeGeometryElement=function(e,t,o){var r=o[o.length-1],i=ol.obj.assign({},r);i.node=e;var n;n=Array.isArray(t)?r.dataProjection?ol.proj.transformExtent(t,r.featureProjection,r.dataProjection):t:ol.format.Feature.transformWithOptions(t,!0,r);ol.xml.pushSerializeAndPop(i,ol.format.GML2.GEOMETRY_SERIALIZERS_,this.GEOMETRY_NODE_FACTORY_,[n],o,void 0,this)};ol.format.GML2.prototype.writeCurveOrLineString_=function(e,t,o){var r=o[o.length-1],i=r.srsName;"LineStringSegment"!==e.nodeName&&i&&e.setAttribute("srsName",i);if("LineString"===e.nodeName||"LineStringSegment"===e.nodeName){var n=this.createCoordinatesNode_(e.namespaceURI);e.appendChild(n);this.writeCoordinates_(n,t,o)}else if("Curve"===e.nodeName){var a=ol.xml.createElementNS(e.namespaceURI,"segments");e.appendChild(a);this.writeCurveSegments_(a,t,o)}};ol.format.GML2.prototype.createCoordinatesNode_=function(e){var t=ol.xml.createElementNS(e,"coordinates");t.setAttribute("decimal",".");t.setAttribute("cs",",");t.setAttribute("ts"," ");return t};ol.format.GML2.prototype.writeCoordinates_=function(e,t,o){for(var r,i=o[o.length-1],n=i.srsName,a=t.getCoordinates(),l=a.length,s=new Array(l),p=0;l>p;++p){r=a[p];s[p]=this.getCoords_(r,n)}ol.format.XSD.writeStringTextNode(e,s.join(" "))};ol.format.GML2.prototype.writeCurveSegments_=function(e,t,o){var r=ol.xml.createElementNS(e.namespaceURI,"LineStringSegment");e.appendChild(r);this.writeCurveOrLineString_(r,t,o)};ol.format.GML2.prototype.writeSurfaceOrPolygon_=function(e,t,o){var r=o[o.length-1],i=r.srsName;"PolygonPatch"!==e.nodeName&&i&&e.setAttribute("srsName",i);if("Polygon"===e.nodeName||"PolygonPatch"===e.nodeName){var n=t.getLinearRings();ol.xml.pushSerializeAndPop({node:e,srsName:i},ol.format.GML2.RING_SERIALIZERS_,this.RING_NODE_FACTORY_,n,o,void 0,this)}else if("Surface"===e.nodeName){var a=ol.xml.createElementNS(e.namespaceURI,"patches");e.appendChild(a);this.writeSurfacePatches_(a,t,o)}};ol.format.GML2.prototype.RING_NODE_FACTORY_=function(e,t,o){var r=t[t.length-1],i=r.node,n=r.exteriorWritten;void 0===n&&(r.exteriorWritten=!0);return ol.xml.createElementNS(i.namespaceURI,void 0!==n?"innerBoundaryIs":"outerBoundaryIs")};ol.format.GML2.prototype.writeSurfacePatches_=function(e,t,o){var r=ol.xml.createElementNS(e.namespaceURI,"PolygonPatch");e.appendChild(r);this.writeSurfaceOrPolygon_(r,t,o)};ol.format.GML2.prototype.writeRing_=function(e,t,o){var r=ol.xml.createElementNS(e.namespaceURI,"LinearRing");e.appendChild(r);this.writeLinearRing_(r,t,o)};ol.format.GML2.prototype.getCoords_=function(e,t){var o="enu";t&&(o=ol.proj.get(t).getAxisOrientation());return"en"===o.substr(0,2)?e[0]+","+e[1]:e[1]+","+e[0]};ol.format.GML2.prototype.writeMultiCurveOrLineString_=function(e,t,o){var r=o[o.length-1],i=r.srsName,n=r.curve;i&&e.setAttribute("srsName",i);var a=t.getLineStrings();ol.xml.pushSerializeAndPop({node:e,srsName:i,curve:n},ol.format.GML2.LINESTRINGORCURVEMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,o,void 0,this)};ol.format.GML2.prototype.writePoint_=function(e,t,o){var r=o[o.length-1],i=r.srsName;i&&e.setAttribute("srsName",i);var n=this.createCoordinatesNode_(e.namespaceURI);e.appendChild(n);var a=t.getCoordinates(),l=this.getCoords_(a,i);ol.format.XSD.writeStringTextNode(n,l)};ol.format.GML2.prototype.writeMultiPoint_=function(e,t,o){var r=o[o.length-1],i=r.srsName;i&&e.setAttribute("srsName",i);var n=t.getPoints();ol.xml.pushSerializeAndPop({node:e,srsName:i},ol.format.GML2.POINTMEMBER_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("pointMember"),n,o,void 0,this)};ol.format.GML2.prototype.writePointMember_=function(e,t,o){var r=ol.xml.createElementNS(e.namespaceURI,"Point");e.appendChild(r);this.writePoint_(r,t,o)};ol.format.GML2.prototype.writeLineStringOrCurveMember_=function(e,t,o){var r=this.GEOMETRY_NODE_FACTORY_(t,o);if(r){e.appendChild(r);this.writeCurveOrLineString_(r,t,o)}};ol.format.GML2.prototype.writeLinearRing_=function(e,t,o){var r=o[o.length-1],i=r.srsName;i&&e.setAttribute("srsName",i);var n=this.createCoordinatesNode_(e.namespaceURI);e.appendChild(n);this.writeCoordinates_(n,t,o)};ol.format.GML2.prototype.writeMultiSurfaceOrPolygon_=function(e,t,o){var r=o[o.length-1],i=r.srsName,n=r.surface;i&&e.setAttribute("srsName",i);var a=t.getPolygons();ol.xml.pushSerializeAndPop({node:e,srsName:i,surface:n},ol.format.GML2.SURFACEORPOLYGONMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,o,void 0,this)};ol.format.GML2.prototype.writeSurfaceOrPolygonMember_=function(e,t,o){var r=this.GEOMETRY_NODE_FACTORY_(t,o);if(r){e.appendChild(r);this.writeSurfaceOrPolygon_(r,t,o)}};ol.format.GML2.prototype.writeEnvelope=function(e,t,o){var r=o[o.length-1],i=r.srsName;i&&e.setAttribute("srsName",i);var n=["lowerCorner","upperCorner"],a=[t[0]+" "+t[1],t[2]+" "+t[3]];ol.xml.pushSerializeAndPop({node:e},ol.format.GML2.ENVELOPE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,a,o,n,this)};ol.format.GML2.GEOMETRY_SERIALIZERS_={"http://www.opengis.net/gml":{Curve:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeCurveOrLineString_),MultiCurve:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeMultiCurveOrLineString_),Point:ol.xml.makeChildAppender(ol.format.GML2.prototype.writePoint_),MultiPoint:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeMultiPoint_),LineString:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeCurveOrLineString_),MultiLineString:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeMultiCurveOrLineString_),LinearRing:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeLinearRing_),Polygon:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeSurfaceOrPolygon_),MultiPolygon:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeMultiSurfaceOrPolygon_),Surface:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeSurfaceOrPolygon_),MultiSurface:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeMultiSurfaceOrPolygon_),Envelope:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeEnvelope)}};ol.format.GML2.RING_SERIALIZERS_={"http://www.opengis.net/gml":{outerBoundaryIs:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeRing_),innerBoundaryIs:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeRing_)}};ol.format.GML2.POINTMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{pointMember:ol.xml.makeChildAppender(ol.format.GML2.prototype.writePointMember_)}};ol.format.GML2.LINESTRINGORCURVEMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{lineStringMember:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeLineStringOrCurveMember_),curveMember:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeLineStringOrCurveMember_)}};ol.format.GML2.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(e,t,o){var r=t[t.length-1].node;return ol.xml.createElementNS("http://www.opengis.net/gml",ol.format.GML2.MULTIGEOMETRY_TO_MEMBER_NODENAME_[r.nodeName])};ol.format.GML2.MULTIGEOMETRY_TO_MEMBER_NODENAME_={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};ol.format.GML2.SURFACEORPOLYGONMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{surfaceMember:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeSurfaceOrPolygonMember_),polygonMember:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeSurfaceOrPolygonMember_)}};ol.format.GML2.ENVELOPE_SERIALIZERS_={"http://www.opengis.net/gml":{lowerCorner:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),upperCorner:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode)}};goog.provide("ol.format.GPX");goog.require("ol");goog.require("ol.Feature");goog.require("ol.array");goog.require("ol.format.Feature");goog.require("ol.format.XMLFeature");goog.require("ol.format.XSD");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.LineString");goog.require("ol.geom.MultiLineString");goog.require("ol.geom.Point");goog.require("ol.proj");goog.require("ol.xml");ol.format.GPX=function(e){var t=e?e:{};ol.format.XMLFeature.call(this);this.defaultDataProjection=ol.proj.get("EPSG:4326");this.readExtensions_=t.readExtensions};ol.inherits(ol.format.GPX,ol.format.XMLFeature);ol.format.GPX.NAMESPACE_URIS_=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"];ol.format.GPX.SCHEMA_LOCATION_="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd";ol.format.GPX.appendCoordinate_=function(e,t,o,r){e.push(parseFloat(o.getAttribute("lon")),parseFloat(o.getAttribute("lat")));if("ele"in r){e.push(r.ele);delete r.ele;t.hasZ=!0}else e.push(0);if("time"in r){e.push(r.time);delete r.time;t.hasM=!0}else e.push(0);return e};ol.format.GPX.applyLayoutOptions_=function(e,t,o){var r=ol.geom.GeometryLayout.XY,i=2;if(e.hasZ&&e.hasM){r=ol.geom.GeometryLayout.XYZM;i=4}else if(e.hasZ){r=ol.geom.GeometryLayout.XYZ;i=3}else if(e.hasM){r=ol.geom.GeometryLayout.XYM;i=3}if(4!==i){var n,a;for(n=0,a=t.length/4;a>n;n++){t[n*i]=t[4*n];t[n*i+1]=t[4*n+1];e.hasZ&&(t[n*i+2]=t[4*n+2]);e.hasM&&(t[n*i+2]=t[4*n+3])}t.length=t.length/4*i;if(o)for(n=0,a=o.length;a>n;n++)o[n]=o[n]/4*i}return r};ol.format.GPX.parseLink_=function(e,t){var o=t[t.length-1],r=e.getAttribute("href");null!==r&&(o.link=r);ol.xml.parseNode(ol.format.GPX.LINK_PARSERS_,e,t)};ol.format.GPX.parseExtensions_=function(e,t){var o=t[t.length-1];o.extensionsNode_=e};ol.format.GPX.parseRtePt_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.GPX.RTEPT_PARSERS_,e,t);if(o){var r=t[t.length-1],i=r.flatCoordinates,n=r.layoutOptions;ol.format.GPX.appendCoordinate_(i,n,e,o)}};ol.format.GPX.parseTrkPt_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.GPX.TRKPT_PARSERS_,e,t);if(o){var r=t[t.length-1],i=r.flatCoordinates,n=r.layoutOptions;ol.format.GPX.appendCoordinate_(i,n,e,o)}};ol.format.GPX.parseTrkSeg_=function(e,t){var o=t[t.length-1];ol.xml.parseNode(ol.format.GPX.TRKSEG_PARSERS_,e,t);var r=o.flatCoordinates,i=o.ends;i.push(r.length)};ol.format.GPX.readRte_=function(e,t){var o=t[0],r=ol.xml.pushParseAndPop({flatCoordinates:[],layoutOptions:{}},ol.format.GPX.RTE_PARSERS_,e,t);if(!r)return void 0;var i=r.flatCoordinates;delete r.flatCoordinates;var n=r.layoutOptions;delete r.layoutOptions;var a=ol.format.GPX.applyLayoutOptions_(n,i),l=new ol.geom.LineString(null);l.setFlatCoordinates(a,i);ol.format.Feature.transformWithOptions(l,!1,o);var s=new ol.Feature(l);s.setProperties(r);return s};ol.format.GPX.readTrk_=function(e,t){var o=t[0],r=ol.xml.pushParseAndPop({flatCoordinates:[],ends:[],layoutOptions:{}},ol.format.GPX.TRK_PARSERS_,e,t);if(!r)return void 0;var i=r.flatCoordinates;delete r.flatCoordinates;var n=r.ends;delete r.ends;var a=r.layoutOptions;delete r.layoutOptions;var l=ol.format.GPX.applyLayoutOptions_(a,i,n),s=new ol.geom.MultiLineString(null);s.setFlatCoordinates(l,i,n);ol.format.Feature.transformWithOptions(s,!1,o);var p=new ol.Feature(s);p.setProperties(r);return p};ol.format.GPX.readWpt_=function(e,t){var o=t[0],r=ol.xml.pushParseAndPop({},ol.format.GPX.WPT_PARSERS_,e,t);if(!r)return void 0;var i={},n=ol.format.GPX.appendCoordinate_([],i,e,r),a=ol.format.GPX.applyLayoutOptions_(i,n),l=new ol.geom.Point(n,a);ol.format.Feature.transformWithOptions(l,!1,o);var s=new ol.Feature(l);s.setProperties(r);return s};ol.format.GPX.FEATURE_READER_={rte:ol.format.GPX.readRte_,trk:ol.format.GPX.readTrk_,wpt:ol.format.GPX.readWpt_
};ol.format.GPX.GPX_PARSERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{rte:ol.xml.makeArrayPusher(ol.format.GPX.readRte_),trk:ol.xml.makeArrayPusher(ol.format.GPX.readTrk_),wpt:ol.xml.makeArrayPusher(ol.format.GPX.readWpt_)});ol.format.GPX.LINK_PARSERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{text:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString,"linkText"),type:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString,"linkType")});ol.format.GPX.RTE_PARSERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{name:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),cmt:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),desc:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),src:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),link:ol.format.GPX.parseLink_,number:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),extensions:ol.format.GPX.parseExtensions_,type:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),rtept:ol.format.GPX.parseRtePt_});ol.format.GPX.RTEPT_PARSERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{ele:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),time:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDateTime)});ol.format.GPX.TRK_PARSERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{name:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),cmt:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),desc:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),src:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),link:ol.format.GPX.parseLink_,number:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),type:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),extensions:ol.format.GPX.parseExtensions_,trkseg:ol.format.GPX.parseTrkSeg_});ol.format.GPX.TRKSEG_PARSERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{trkpt:ol.format.GPX.parseTrkPt_});ol.format.GPX.TRKPT_PARSERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{ele:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),time:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDateTime)});ol.format.GPX.WPT_PARSERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{ele:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),time:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDateTime),magvar:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),geoidheight:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),name:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),cmt:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),desc:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),src:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),link:ol.format.GPX.parseLink_,sym:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),type:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),fix:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),sat:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),hdop:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),vdop:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),pdop:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),ageofdgpsdata:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),dgpsid:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),extensions:ol.format.GPX.parseExtensions_});ol.format.GPX.prototype.handleReadExtensions_=function(e){e||(e=[]);for(var t=0,o=e.length;o>t;++t){var r=e[t];if(this.readExtensions_){var i=r.get("extensionsNode_")||null;this.readExtensions_(r,i)}r.set("extensionsNode_",void 0)}};ol.format.GPX.prototype.readFeature;ol.format.GPX.prototype.readFeatureFromNode=function(e,t){if(!ol.array.includes(ol.format.GPX.NAMESPACE_URIS_,e.namespaceURI))return null;var o=ol.format.GPX.FEATURE_READER_[e.localName];if(!o)return null;var r=o(e,[this.getReadOptions(e,t)]);if(!r)return null;this.handleReadExtensions_([r]);return r};ol.format.GPX.prototype.readFeatures;ol.format.GPX.prototype.readFeaturesFromNode=function(e,t){if(!ol.array.includes(ol.format.GPX.NAMESPACE_URIS_,e.namespaceURI))return[];if("gpx"==e.localName){var o=ol.xml.pushParseAndPop([],ol.format.GPX.GPX_PARSERS_,e,[this.getReadOptions(e,t)]);if(o){this.handleReadExtensions_(o);return o}return[]}return[]};ol.format.GPX.prototype.readProjection;ol.format.GPX.writeLink_=function(e,t,o){e.setAttribute("href",t);var r=o[o.length-1],i=r.properties,n=[i.linkText,i.linkType];ol.xml.pushSerializeAndPop({node:e},ol.format.GPX.LINK_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,n,o,ol.format.GPX.LINK_SEQUENCE_)};ol.format.GPX.writeWptType_=function(e,t,o){var r=o[o.length-1],i=r.node,n=i.namespaceURI,a=r.properties;ol.xml.setAttributeNS(e,null,"lat",t[1]);ol.xml.setAttributeNS(e,null,"lon",t[0]);var l=r.geometryLayout;switch(l){case ol.geom.GeometryLayout.XYZM:0!==t[3]&&(a.time=t[3]);case ol.geom.GeometryLayout.XYZ:0!==t[2]&&(a.ele=t[2]);break;case ol.geom.GeometryLayout.XYM:0!==t[2]&&(a.time=t[2])}var s="rtept"==e.nodeName?ol.format.GPX.RTEPT_TYPE_SEQUENCE_[n]:ol.format.GPX.WPT_TYPE_SEQUENCE_[n],p=ol.xml.makeSequence(a,s);ol.xml.pushSerializeAndPop({node:e,properties:a},ol.format.GPX.WPT_TYPE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,p,o,s)};ol.format.GPX.writeRte_=function(e,t,o){var r=o[0],i=t.getProperties(),n={node:e,properties:i},a=t.getGeometry();if(a){a=ol.format.Feature.transformWithOptions(a,!0,r);n.geometryLayout=a.getLayout();i.rtept=a.getCoordinates()}var l=o[o.length-1].node,s=ol.format.GPX.RTE_SEQUENCE_[l.namespaceURI],p=ol.xml.makeSequence(i,s);ol.xml.pushSerializeAndPop(n,ol.format.GPX.RTE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,p,o,s)};ol.format.GPX.writeTrk_=function(e,t,o){var r=o[0],i=t.getProperties(),n={node:e,properties:i},a=t.getGeometry();if(a){a=ol.format.Feature.transformWithOptions(a,!0,r);i.trkseg=a.getLineStrings()}var l=o[o.length-1].node,s=ol.format.GPX.TRK_SEQUENCE_[l.namespaceURI],p=ol.xml.makeSequence(i,s);ol.xml.pushSerializeAndPop(n,ol.format.GPX.TRK_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,p,o,s)};ol.format.GPX.writeTrkSeg_=function(e,t,o){var r={node:e,geometryLayout:t.getLayout(),properties:{}};ol.xml.pushSerializeAndPop(r,ol.format.GPX.TRKSEG_SERIALIZERS_,ol.format.GPX.TRKSEG_NODE_FACTORY_,t.getCoordinates(),o)};ol.format.GPX.writeWpt_=function(e,t,o){var r=o[0],i=o[o.length-1];i.properties=t.getProperties();var n=t.getGeometry();if(n){n=ol.format.Feature.transformWithOptions(n,!0,r);i.geometryLayout=n.getLayout();ol.format.GPX.writeWptType_(e,n.getCoordinates(),o)}};ol.format.GPX.LINK_SEQUENCE_=["text","type"];ol.format.GPX.LINK_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{text:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),type:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode)});ol.format.GPX.RTE_SEQUENCE_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,["name","cmt","desc","src","link","number","type","rtept"]);ol.format.GPX.RTE_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{name:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),cmt:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),desc:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),src:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),link:ol.xml.makeChildAppender(ol.format.GPX.writeLink_),number:ol.xml.makeChildAppender(ol.format.XSD.writeNonNegativeIntegerTextNode),type:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),rtept:ol.xml.makeArraySerializer(ol.xml.makeChildAppender(ol.format.GPX.writeWptType_))});ol.format.GPX.RTEPT_TYPE_SEQUENCE_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,["ele","time"]);ol.format.GPX.TRK_SEQUENCE_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,["name","cmt","desc","src","link","number","type","trkseg"]);ol.format.GPX.TRK_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{name:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),cmt:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),desc:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),src:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),link:ol.xml.makeChildAppender(ol.format.GPX.writeLink_),number:ol.xml.makeChildAppender(ol.format.XSD.writeNonNegativeIntegerTextNode),type:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),trkseg:ol.xml.makeArraySerializer(ol.xml.makeChildAppender(ol.format.GPX.writeTrkSeg_))});ol.format.GPX.TRKSEG_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("trkpt");ol.format.GPX.TRKSEG_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{trkpt:ol.xml.makeChildAppender(ol.format.GPX.writeWptType_)});ol.format.GPX.WPT_TYPE_SEQUENCE_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]);ol.format.GPX.WPT_TYPE_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{ele:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),time:ol.xml.makeChildAppender(ol.format.XSD.writeDateTimeTextNode),magvar:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),geoidheight:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),name:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),cmt:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),desc:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),src:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),link:ol.xml.makeChildAppender(ol.format.GPX.writeLink_),sym:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),type:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),fix:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),sat:ol.xml.makeChildAppender(ol.format.XSD.writeNonNegativeIntegerTextNode),hdop:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),vdop:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),pdop:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),ageofdgpsdata:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),dgpsid:ol.xml.makeChildAppender(ol.format.XSD.writeNonNegativeIntegerTextNode)});ol.format.GPX.GEOMETRY_TYPE_TO_NODENAME_={Point:"wpt",LineString:"rte",MultiLineString:"trk"};ol.format.GPX.GPX_NODE_FACTORY_=function(e,t,o){var r=e.getGeometry();if(r){var i=ol.format.GPX.GEOMETRY_TYPE_TO_NODENAME_[r.getType()];if(i){var n=t[t.length-1].node;return ol.xml.createElementNS(n.namespaceURI,i)}}};ol.format.GPX.GPX_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{rte:ol.xml.makeChildAppender(ol.format.GPX.writeRte_),trk:ol.xml.makeChildAppender(ol.format.GPX.writeTrk_),wpt:ol.xml.makeChildAppender(ol.format.GPX.writeWpt_)});ol.format.GPX.prototype.writeFeatures;ol.format.GPX.prototype.writeFeaturesNode=function(e,t){t=this.adaptOptions(t);var o=ol.xml.createElementNS("http://www.topografix.com/GPX/1/1","gpx"),r="http://www.w3.org/2000/xmlns/",i="http://www.w3.org/2001/XMLSchema-instance";ol.xml.setAttributeNS(o,r,"xmlns:xsi",i);ol.xml.setAttributeNS(o,i,"xsi:schemaLocation",ol.format.GPX.SCHEMA_LOCATION_);o.setAttribute("version","1.1");o.setAttribute("creator","OpenLayers");ol.xml.pushSerializeAndPop({node:o},ol.format.GPX.GPX_SERIALIZERS_,ol.format.GPX.GPX_NODE_FACTORY_,e,[t]);return o};goog.provide("ol.format.IGCZ");ol.format.IGCZ={BAROMETRIC:"barometric",GPS:"gps",NONE:"none"};goog.provide("ol.format.TextFeature");goog.require("ol");goog.require("ol.format.Feature");goog.require("ol.format.FormatType");ol.format.TextFeature=function(){ol.format.Feature.call(this)};ol.inherits(ol.format.TextFeature,ol.format.Feature);ol.format.TextFeature.prototype.getText_=function(e){return"string"==typeof e?e:""};ol.format.TextFeature.prototype.getType=function(){return ol.format.FormatType.TEXT};ol.format.TextFeature.prototype.readFeature=function(e,t){return this.readFeatureFromText(this.getText_(e),this.adaptOptions(t))};ol.format.TextFeature.prototype.readFeatureFromText=function(e,t){};ol.format.TextFeature.prototype.readFeatures=function(e,t){return this.readFeaturesFromText(this.getText_(e),this.adaptOptions(t))};ol.format.TextFeature.prototype.readFeaturesFromText=function(e,t){};ol.format.TextFeature.prototype.readGeometry=function(e,t){return this.readGeometryFromText(this.getText_(e),this.adaptOptions(t))};ol.format.TextFeature.prototype.readGeometryFromText=function(e,t){};ol.format.TextFeature.prototype.readProjection=function(e){return this.readProjectionFromText(this.getText_(e))};ol.format.TextFeature.prototype.readProjectionFromText=function(e){return this.defaultDataProjection};ol.format.TextFeature.prototype.writeFeature=function(e,t){return this.writeFeatureText(e,this.adaptOptions(t))};ol.format.TextFeature.prototype.writeFeatureText=function(e,t){};ol.format.TextFeature.prototype.writeFeatures=function(e,t){return this.writeFeaturesText(e,this.adaptOptions(t))};ol.format.TextFeature.prototype.writeFeaturesText=function(e,t){};ol.format.TextFeature.prototype.writeGeometry=function(e,t){return this.writeGeometryText(e,this.adaptOptions(t))};ol.format.TextFeature.prototype.writeGeometryText=function(e,t){};goog.provide("ol.format.IGC");goog.require("ol");goog.require("ol.Feature");goog.require("ol.format.Feature");goog.require("ol.format.IGCZ");goog.require("ol.format.TextFeature");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.LineString");goog.require("ol.proj");ol.format.IGC=function(e){var t=e?e:{};ol.format.TextFeature.call(this);this.defaultDataProjection=ol.proj.get("EPSG:4326");this.altitudeMode_=t.altitudeMode?t.altitudeMode:ol.format.IGCZ.NONE};ol.inherits(ol.format.IGC,ol.format.TextFeature);ol.format.IGC.B_RECORD_RE_=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/;ol.format.IGC.H_RECORD_RE_=/^H.([A-Z]{3}).*?:(.*)/;ol.format.IGC.HFDTE_RECORD_RE_=/^HFDTE(\d{2})(\d{2})(\d{2})/;ol.format.IGC.NEWLINE_RE_=/\r\n|\r|\n/;ol.format.IGC.prototype.readFeature;ol.format.IGC.prototype.readFeatureFromText=function(e,t){var o,r,i=this.altitudeMode_,n=e.split(ol.format.IGC.NEWLINE_RE_),a={},l=[],s=2e3,p=0,c=1,u=-1;for(o=0,r=n.length;r>o;++o){var g,d=n[o];if("B"==d.charAt(0)){g=ol.format.IGC.B_RECORD_RE_.exec(d);if(g){var h=parseInt(g[1],10),f=parseInt(g[2],10),y=parseInt(g[3],10),m=parseInt(g[4],10)+parseInt(g[5],10)/6e4;"S"==g[6]&&(m=-m);var v=parseInt(g[7],10)+parseInt(g[8],10)/6e4;"W"==g[9]&&(v=-v);l.push(v,m);if(i!=ol.format.IGCZ.NONE){var C;C=i==ol.format.IGCZ.GPS?parseInt(g[11],10):i==ol.format.IGCZ.BAROMETRIC?parseInt(g[12],10):0;l.push(C)}var T=Date.UTC(s,p,c,h,f,y);u>T&&(T=Date.UTC(s,p,c+1,h,f,y));l.push(T/1e3);u=T}}else if("H"==d.charAt(0)){g=ol.format.IGC.HFDTE_RECORD_RE_.exec(d);if(g){c=parseInt(g[1],10);p=parseInt(g[2],10)-1;s=2e3+parseInt(g[3],10)}else{g=ol.format.IGC.H_RECORD_RE_.exec(d);g&&(a[g[1]]=g[2].trim())}}}if(0===l.length)return null;var _=new ol.geom.LineString(null),S=i==ol.format.IGCZ.NONE?ol.geom.GeometryLayout.XYM:ol.geom.GeometryLayout.XYZM;_.setFlatCoordinates(S,l);var E=new ol.Feature(ol.format.Feature.transformWithOptions(_,!1,t));E.setProperties(a);return E};ol.format.IGC.prototype.readFeatures;ol.format.IGC.prototype.readFeaturesFromText=function(e,t){var o=this.readFeatureFromText(e,t);return o?[o]:[]};ol.format.IGC.prototype.readProjection;ol.format.IGC.prototype.writeFeatureText=function(e,t){};ol.format.IGC.prototype.writeFeaturesText=function(e,t){};ol.format.IGC.prototype.writeGeometryText=function(e,t){};ol.format.IGC.prototype.readGeometryFromText=function(e,t){};goog.provide("ol.style.IconAnchorUnits");ol.style.IconAnchorUnits={FRACTION:"fraction",PIXELS:"pixels"};goog.provide("ol.style.IconImage");goog.require("ol");goog.require("ol.dom");goog.require("ol.events");goog.require("ol.events.EventTarget");goog.require("ol.events.EventType");goog.require("ol.ImageState");goog.require("ol.style");ol.style.IconImage=function(e,t,o,r,i,n){ol.events.EventTarget.call(this);this.hitDetectionImage_=null;this.image_=e?e:new Image;null!==r&&(this.image_.crossOrigin=r);this.canvas_=n?document.createElement("CANVAS"):null;this.color_=n;this.imageListenerKeys_=null;this.imageState_=i;this.size_=o;this.src_=t;this.tainting_=!1;this.imageState_==ol.ImageState.LOADED&&this.determineTainting_()};ol.inherits(ol.style.IconImage,ol.events.EventTarget);ol.style.IconImage.get=function(e,t,o,r,i,n){var a=ol.style.iconImageCache,l=a.get(t,r,n);if(!l){l=new ol.style.IconImage(e,t,o,r,i,n);a.set(t,r,n,l)}return l};ol.style.IconImage.prototype.determineTainting_=function(){var e=ol.dom.createCanvasContext2D(1,1);try{e.drawImage(this.image_,0,0);e.getImageData(0,0,1,1)}catch(t){this.tainting_=!0}};ol.style.IconImage.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(ol.events.EventType.CHANGE)};ol.style.IconImage.prototype.handleImageError_=function(){this.imageState_=ol.ImageState.ERROR;this.unlistenImage_();this.dispatchChangeEvent_()};ol.style.IconImage.prototype.handleImageLoad_=function(){this.imageState_=ol.ImageState.LOADED;if(this.size_){this.image_.width=this.size_[0];this.image_.height=this.size_[1]}this.size_=[this.image_.width,this.image_.height];this.unlistenImage_();this.determineTainting_();this.replaceColor_();this.dispatchChangeEvent_()};ol.style.IconImage.prototype.getImage=function(e){return this.canvas_?this.canvas_:this.image_};ol.style.IconImage.prototype.getImageState=function(){return this.imageState_};ol.style.IconImage.prototype.getHitDetectionImage=function(e){if(!this.hitDetectionImage_)if(this.tainting_){var t=this.size_[0],o=this.size_[1],r=ol.dom.createCanvasContext2D(t,o);r.fillRect(0,0,t,o);this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_};ol.style.IconImage.prototype.getSize=function(){return this.size_};ol.style.IconImage.prototype.getSrc=function(){return this.src_};ol.style.IconImage.prototype.load=function(){if(this.imageState_==ol.ImageState.IDLE){this.imageState_=ol.ImageState.LOADING;this.imageListenerKeys_=[ol.events.listenOnce(this.image_,ol.events.EventType.ERROR,this.handleImageError_,this),ol.events.listenOnce(this.image_,ol.events.EventType.LOAD,this.handleImageLoad_,this)];try{this.image_.src=this.src_}catch(e){this.handleImageError_()}}};ol.style.IconImage.prototype.replaceColor_=function(){if(!this.tainting_&&null!==this.color_){this.canvas_.width=this.image_.width;this.canvas_.height=this.image_.height;var e=this.canvas_.getContext("2d");e.drawImage(this.image_,0,0);for(var t=e.getImageData(0,0,this.image_.width,this.image_.height),o=t.data,r=this.color_[0]/255,i=this.color_[1]/255,n=this.color_[2]/255,a=0,l=o.length;l>a;a+=4){o[a]*=r;o[a+1]*=i;o[a+2]*=n}e.putImageData(t,0,0)}};ol.style.IconImage.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(ol.events.unlistenByKey);this.imageListenerKeys_=null};goog.provide("ol.style.IconOrigin");ol.style.IconOrigin={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};goog.provide("ol.style.Icon");goog.require("ol");goog.require("ol.ImageState");goog.require("ol.asserts");goog.require("ol.color");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.style.IconAnchorUnits");goog.require("ol.style.IconImage");goog.require("ol.style.IconOrigin");goog.require("ol.style.Image");ol.style.Icon=function(e){var t=e||{};this.anchor_=void 0!==t.anchor?t.anchor:[.5,.5];this.normalizedAnchor_=null;this.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:ol.style.IconOrigin.TOP_LEFT;this.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:ol.style.IconAnchorUnits.FRACTION;this.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:ol.style.IconAnchorUnits.FRACTION;this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;var o=void 0!==t.img?t.img:null,r=void 0!==t.imgSize?t.imgSize:null,i=t.src;ol.asserts.assert(!(void 0!==i&&o),4);ol.asserts.assert(!o||o&&r,5);void 0!==i&&0!==i.length||!o||(i=o.src||ol.getUid(o).toString());ol.asserts.assert(void 0!==i&&i.length>0,6);var n=void 0!==t.src?ol.ImageState.IDLE:ol.ImageState.LOADED;this.color_=void 0!==t.color?ol.color.asArray(t.color):null;this.iconImage_=ol.style.IconImage.get(o,i,r,this.crossOrigin_,n,this.color_);this.offset_=void 0!==t.offset?t.offset:[0,0];this.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:ol.style.IconOrigin.TOP_LEFT;this.origin_=null;this.size_=void 0!==t.size?t.size:null;var a=void 0!==t.opacity?t.opacity:1,l=void 0!==t.rotateWithView?t.rotateWithView:!1,s=void 0!==t.rotation?t.rotation:0,p=void 0!==t.scale?t.scale:1,c=void 0!==t.snapToPixel?t.snapToPixel:!0;ol.style.Image.call(this,{opacity:a,rotation:s,scale:p,snapToPixel:c,rotateWithView:l})};ol.inherits(ol.style.Icon,ol.style.Image);ol.style.Icon.prototype.clone=function(){var e,t=this.getImage(1);if(this.iconImage_.getImageState()===ol.ImageState.LOADED)if("IMG"===t.tagName.toUpperCase())e=t.cloneNode(!0);else{e=document.createElement("canvas");var o=e.getContext("2d");e.width=t.width;e.height=t.height;o.drawImage(t,0,0)}return new ol.style.Icon({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,img:e?e:void 0,imgSize:e?this.iconImage_.getSize().slice():void 0,src:e?void 0:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),snapToPixel:this.getSnapToPixel(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})};ol.style.Icon.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var e=this.anchor_,t=this.getSize();if(this.anchorXUnits_==ol.style.IconAnchorUnits.FRACTION||this.anchorYUnits_==ol.style.IconAnchorUnits.FRACTION){if(!t)return null;e=this.anchor_.slice();this.anchorXUnits_==ol.style.IconAnchorUnits.FRACTION&&(e[0]*=t[0]);this.anchorYUnits_==ol.style.IconAnchorUnits.FRACTION&&(e[1]*=t[1])}if(this.anchorOrigin_!=ol.style.IconOrigin.TOP_LEFT){if(!t)return null;e===this.anchor_&&(e=this.anchor_.slice());(this.anchorOrigin_==ol.style.IconOrigin.TOP_RIGHT||this.anchorOrigin_==ol.style.IconOrigin.BOTTOM_RIGHT)&&(e[0]=-e[0]+t[0]);(this.anchorOrigin_==ol.style.IconOrigin.BOTTOM_LEFT||this.anchorOrigin_==ol.style.IconOrigin.BOTTOM_RIGHT)&&(e[1]=-e[1]+t[1])}this.normalizedAnchor_=e;return this.normalizedAnchor_};ol.style.Icon.prototype.getColor=function(){return this.color_};ol.style.Icon.prototype.getImage=function(e){return this.iconImage_.getImage(e)};ol.style.Icon.prototype.getImageSize=function(){return this.iconImage_.getSize()};ol.style.Icon.prototype.getHitDetectionImageSize=function(){return this.getImageSize()};ol.style.Icon.prototype.getImageState=function(){return this.iconImage_.getImageState()};ol.style.Icon.prototype.getHitDetectionImage=function(e){return this.iconImage_.getHitDetectionImage(e)};ol.style.Icon.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var e=this.offset_;if(this.offsetOrigin_!=ol.style.IconOrigin.TOP_LEFT){var t=this.getSize(),o=this.iconImage_.getSize();if(!t||!o)return null;e=e.slice();(this.offsetOrigin_==ol.style.IconOrigin.TOP_RIGHT||this.offsetOrigin_==ol.style.IconOrigin.BOTTOM_RIGHT)&&(e[0]=o[0]-t[0]-e[0]);(this.offsetOrigin_==ol.style.IconOrigin.BOTTOM_LEFT||this.offsetOrigin_==ol.style.IconOrigin.BOTTOM_RIGHT)&&(e[1]=o[1]-t[1]-e[1])}this.origin_=e;return this.origin_};ol.style.Icon.prototype.getSrc=function(){return this.iconImage_.getSrc()};ol.style.Icon.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()};ol.style.Icon.prototype.listenImageChange=function(e,t){return ol.events.listen(this.iconImage_,ol.events.EventType.CHANGE,e,t)};ol.style.Icon.prototype.load=function(){this.iconImage_.load()};ol.style.Icon.prototype.unlistenImageChange=function(e,t){ol.events.unlisten(this.iconImage_,ol.events.EventType.CHANGE,e,t)};goog.provide("ol.style.Text");goog.require("ol.style.Fill");ol.style.Text=function(e){var t=e||{};this.font_=t.font;this.rotation_=t.rotation;this.rotateWithView_=t.rotateWithView;this.scale_=t.scale;this.text_=t.text;this.textAlign_=t.textAlign;this.textBaseline_=t.textBaseline;this.fill_=void 0!==t.fill?t.fill:new ol.style.Fill({color:ol.style.Text.DEFAULT_FILL_COLOR_});this.stroke_=void 0!==t.stroke?t.stroke:null;this.offsetX_=void 0!==t.offsetX?t.offsetX:0;this.offsetY_=void 0!==t.offsetY?t.offsetY:0};ol.style.Text.DEFAULT_FILL_COLOR_="#333";ol.style.Text.prototype.clone=function(){return new ol.style.Text({font:this.getFont(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:this.getScale(),text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY()})};ol.style.Text.prototype.getFont=function(){return this.font_};ol.style.Text.prototype.getOffsetX=function(){return this.offsetX_};ol.style.Text.prototype.getOffsetY=function(){return this.offsetY_};ol.style.Text.prototype.getFill=function(){return this.fill_};ol.style.Text.prototype.getRotateWithView=function(){return this.rotateWithView_};ol.style.Text.prototype.getRotation=function(){return this.rotation_};ol.style.Text.prototype.getScale=function(){return this.scale_};ol.style.Text.prototype.getStroke=function(){return this.stroke_};ol.style.Text.prototype.getText=function(){return this.text_};ol.style.Text.prototype.getTextAlign=function(){return this.textAlign_};ol.style.Text.prototype.getTextBaseline=function(){return this.textBaseline_};ol.style.Text.prototype.setFont=function(e){this.font_=e};ol.style.Text.prototype.setOffsetX=function(e){this.offsetX_=e};ol.style.Text.prototype.setOffsetY=function(e){this.offsetY_=e};ol.style.Text.prototype.setFill=function(e){this.fill_=e};ol.style.Text.prototype.setRotation=function(e){this.rotation_=e};ol.style.Text.prototype.setScale=function(e){this.scale_=e};ol.style.Text.prototype.setStroke=function(e){this.stroke_=e};ol.style.Text.prototype.setText=function(e){this.text_=e};ol.style.Text.prototype.setTextAlign=function(e){this.textAlign_=e};ol.style.Text.prototype.setTextBaseline=function(e){this.textBaseline_=e};goog.provide("ol.format.KML");goog.require("ol");goog.require("ol.Feature");goog.require("ol.array");goog.require("ol.asserts");goog.require("ol.color");goog.require("ol.format.Feature");goog.require("ol.format.XMLFeature");goog.require("ol.format.XSD");goog.require("ol.geom.GeometryCollection");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.GeometryType");goog.require("ol.geom.LineString");goog.require("ol.geom.MultiLineString");goog.require("ol.geom.MultiPoint");goog.require("ol.geom.MultiPolygon");goog.require("ol.geom.Point");goog.require("ol.geom.Polygon");goog.require("ol.math");goog.require("ol.proj");goog.require("ol.style.Fill");goog.require("ol.style.Icon");goog.require("ol.style.IconAnchorUnits");goog.require("ol.style.IconOrigin");goog.require("ol.style.Stroke");goog.require("ol.style.Style");goog.require("ol.style.Text");goog.require("ol.xml");ol.format.KML=function(e){var t=e?e:{};ol.format.XMLFeature.call(this);ol.format.KML.DEFAULT_STYLE_ARRAY_||ol.format.KML.createStyleDefaults_();this.defaultDataProjection=ol.proj.get("EPSG:4326");this.defaultStyle_=t.defaultStyle?t.defaultStyle:ol.format.KML.DEFAULT_STYLE_ARRAY_;this.extractStyles_=void 0!==t.extractStyles?t.extractStyles:!0;this.writeStyles_=void 0!==t.writeStyles?t.writeStyles:!0;this.sharedStyles_={};this.showPointNames_=void 0!==t.showPointNames?t.showPointNames:!0};ol.inherits(ol.format.KML,ol.format.XMLFeature);ol.format.KML.GX_NAMESPACE_URIS_=["http://www.google.com/kml/ext/2.2"];ol.format.KML.NAMESPACE_URIS_=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"];ol.format.KML.SCHEMA_LOCATION_="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd";ol.format.KML.createStyleDefaults_=function(){ol.format.KML.DEFAULT_COLOR_=[255,255,255,1];ol.format.KML.DEFAULT_FILL_STYLE_=new ol.style.Fill({color:ol.format.KML.DEFAULT_COLOR_});ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_=[20,2];ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS_=ol.style.IconAnchorUnits.PIXELS;ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS_=ol.style.IconAnchorUnits.PIXELS;ol.format.KML.DEFAULT_IMAGE_STYLE_SIZE_=[64,64];ol.format.KML.DEFAULT_IMAGE_STYLE_SRC_="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png";ol.format.KML.DEFAULT_IMAGE_SCALE_MULTIPLIER_=.5;ol.format.KML.DEFAULT_IMAGE_STYLE_=new ol.style.Icon({anchor:ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_,anchorOrigin:ol.style.IconOrigin.BOTTOM_LEFT,anchorXUnits:ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS_,anchorYUnits:ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS_,crossOrigin:"anonymous",rotation:0,scale:ol.format.KML.DEFAULT_IMAGE_SCALE_MULTIPLIER_,size:ol.format.KML.DEFAULT_IMAGE_STYLE_SIZE_,src:ol.format.KML.DEFAULT_IMAGE_STYLE_SRC_});ol.format.KML.DEFAULT_NO_IMAGE_STYLE_="NO_IMAGE";ol.format.KML.DEFAULT_STROKE_STYLE_=new ol.style.Stroke({color:ol.format.KML.DEFAULT_COLOR_,width:1});ol.format.KML.DEFAULT_TEXT_STROKE_STYLE_=new ol.style.Stroke({color:[51,51,51,1],width:2});ol.format.KML.DEFAULT_TEXT_STYLE_=new ol.style.Text({font:"bold 16px Helvetica",fill:ol.format.KML.DEFAULT_FILL_STYLE_,stroke:ol.format.KML.DEFAULT_TEXT_STROKE_STYLE_,scale:.8});ol.format.KML.DEFAULT_STYLE_=new ol.style.Style({fill:ol.format.KML.DEFAULT_FILL_STYLE_,image:ol.format.KML.DEFAULT_IMAGE_STYLE_,text:ol.format.KML.DEFAULT_TEXT_STYLE_,stroke:ol.format.KML.DEFAULT_STROKE_STYLE_,zIndex:0});ol.format.KML.DEFAULT_STYLE_ARRAY_=[ol.format.KML.DEFAULT_STYLE_];return ol.format.KML.DEFAULT_STYLE_ARRAY_};ol.format.KML.ICON_ANCHOR_UNITS_MAP_={fraction:ol.style.IconAnchorUnits.FRACTION,pixels:ol.style.IconAnchorUnits.PIXELS};ol.format.KML.createNameStyleFunction_=function(e,t){var o=null,r=[0,0],i="start";if(e.getImage()){var n=e.getImage().getImageSize();null===n&&(n=ol.format.KML.DEFAULT_IMAGE_STYLE_SIZE_);if(2==n.length){var a=e.getImage().getScale();r[0]=a*n[0]/2;r[1]=-a*n[1]/2;i="left"}}if(null!==e.getText()){var l=e.getText();o=l.clone();o.setFont(l.getFont()||ol.format.KML.DEFAULT_TEXT_STYLE_.getFont());o.setScale(l.getScale()||ol.format.KML.DEFAULT_TEXT_STYLE_.getScale());o.setFill(l.getFill()||ol.format.KML.DEFAULT_TEXT_STYLE_.getFill());o.setStroke(l.getStroke()||ol.format.KML.DEFAULT_TEXT_STROKE_STYLE_)}else o=ol.format.KML.DEFAULT_TEXT_STYLE_.clone();o.setText(t);o.setOffsetX(r[0]);o.setOffsetY(r[1]);o.setTextAlign(i);var s=new ol.style.Style({text:o});return s};ol.format.KML.createFeatureStyleFunction_=function(e,t,o,r,i){return function(n){var a,l=i,s="";l&&this.getGeometry()&&(l=this.getGeometry().getType()===ol.geom.GeometryType.POINT);if(l){s=this.get("name");l=l&&s}if(e){if(l){a=ol.format.KML.createNameStyleFunction_(e[0],s);return e.concat(a)}return e}if(t){var p=ol.format.KML.findStyle_(t,o,r);if(l){a=ol.format.KML.createNameStyleFunction_(p[0],s);return p.concat(a)}return p}if(l){a=ol.format.KML.createNameStyleFunction_(o[0],s);return o.concat(a)}return o}};ol.format.KML.findStyle_=function(e,t,o){if(Array.isArray(e))return e;if("string"==typeof e){!(e in o)&&"#"+e in o&&(e="#"+e);return ol.format.KML.findStyle_(o[e],t,o)}return t};ol.format.KML.readColor_=function(e){var t=ol.xml.getAllTextContent(e,!1),o=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(t);if(o){var r=o[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}return void 0};ol.format.KML.readFlatCoordinates_=function(e){
for(var t,o=ol.xml.getAllTextContent(e,!1),r=[],i=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?))?\s*/i;t=i.exec(o);){var n=parseFloat(t[1]),a=parseFloat(t[2]),l=t[3]?parseFloat(t[3]):0;r.push(n,a,l);o=o.substr(t[0].length)}return""!==o?void 0:r};ol.format.KML.readURI_=function(e){var t=ol.xml.getAllTextContent(e,!1).trim();if(e.baseURI){var o=new URL(t,e.baseURI);return o.href}return t};ol.format.KML.readVec2_=function(e){var t=e.getAttribute("xunits"),o=e.getAttribute("yunits");return{x:parseFloat(e.getAttribute("x")),xunits:ol.format.KML.ICON_ANCHOR_UNITS_MAP_[t],y:parseFloat(e.getAttribute("y")),yunits:ol.format.KML.ICON_ANCHOR_UNITS_MAP_[o]}};ol.format.KML.readScale_=function(e){return ol.format.XSD.readDecimal(e)};ol.format.KML.readStyleMapValue_=function(e,t){return ol.xml.pushParseAndPop(void 0,ol.format.KML.STYLE_MAP_PARSERS_,e,t)};ol.format.KML.IconStyleParser_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.KML.ICON_STYLE_PARSERS_,e,t);if(o){var r,i=t[t.length-1],n="Icon"in o?o.Icon:{},a=!("Icon"in o)||Object.keys(n).length>0,l=n.href;l?r=l:a&&(r=ol.format.KML.DEFAULT_IMAGE_STYLE_SRC_);var s,p,c,u=o.hotSpot;if(u){s=[u.x,u.y];p=u.xunits;c=u.yunits}else if(r===ol.format.KML.DEFAULT_IMAGE_STYLE_SRC_){s=ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_;p=ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS_;c=ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS_}else if(/^http:\/\/maps\.(?:google|gstatic)\.com\//.test(r)){s=[.5,0];p=ol.style.IconAnchorUnits.FRACTION;c=ol.style.IconAnchorUnits.FRACTION}var g,d=n.x,h=n.y;void 0!==d&&void 0!==h&&(g=[d,h]);var f,y=n.w,m=n.h;void 0!==y&&void 0!==m&&(f=[y,m]);var v,C=o.heading;void 0!==C&&(v=ol.math.toRadians(C));var T=o.scale;if(a){if(r==ol.format.KML.DEFAULT_IMAGE_STYLE_SRC_){f=ol.format.KML.DEFAULT_IMAGE_STYLE_SIZE_;void 0===T&&(T=ol.format.KML.DEFAULT_IMAGE_SCALE_MULTIPLIER_)}var _=new ol.style.Icon({anchor:s,anchorOrigin:ol.style.IconOrigin.BOTTOM_LEFT,anchorXUnits:p,anchorYUnits:c,crossOrigin:"anonymous",offset:g,offsetOrigin:ol.style.IconOrigin.BOTTOM_LEFT,rotation:v,scale:T,size:f,src:r});i.imageStyle=_}else i.imageStyle=ol.format.KML.DEFAULT_NO_IMAGE_STYLE_}};ol.format.KML.LabelStyleParser_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.KML.LABEL_STYLE_PARSERS_,e,t);if(o){var r=t[t.length-1],i=new ol.style.Text({fill:new ol.style.Fill({color:"color"in o?o.color:ol.format.KML.DEFAULT_COLOR_}),scale:o.scale});r.textStyle=i}};ol.format.KML.LineStyleParser_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.KML.LINE_STYLE_PARSERS_,e,t);if(o){var r=t[t.length-1],i=new ol.style.Stroke({color:"color"in o?o.color:ol.format.KML.DEFAULT_COLOR_,width:"width"in o?o.width:1});r.strokeStyle=i}};ol.format.KML.PolyStyleParser_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.KML.POLY_STYLE_PARSERS_,e,t);if(o){var r=t[t.length-1],i=new ol.style.Fill({color:"color"in o?o.color:ol.format.KML.DEFAULT_COLOR_});r.fillStyle=i;var n=o.fill;void 0!==n&&(r.fill=n);var a=o.outline;void 0!==a&&(r.outline=a)}};ol.format.KML.readFlatLinearRing_=function(e,t){return ol.xml.pushParseAndPop(null,ol.format.KML.FLAT_LINEAR_RING_PARSERS_,e,t)};ol.format.KML.gxCoordParser_=function(e,t){var o=t[t.length-1],r=o.flatCoordinates,i=ol.xml.getAllTextContent(e,!1),n=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i,a=n.exec(i);if(a){var l=parseFloat(a[1]),s=parseFloat(a[2]),p=parseFloat(a[3]);r.push(l,s,p,0)}else r.push(0,0,0,0)};ol.format.KML.readGxMultiTrack_=function(e,t){var o=ol.xml.pushParseAndPop([],ol.format.KML.GX_MULTITRACK_GEOMETRY_PARSERS_,e,t);if(!o)return void 0;var r=new ol.geom.MultiLineString(null);r.setLineStrings(o);return r};ol.format.KML.readGxTrack_=function(e,t){var o=ol.xml.pushParseAndPop({flatCoordinates:[],whens:[]},ol.format.KML.GX_TRACK_PARSERS_,e,t);if(!o)return void 0;var r,i,n=o.flatCoordinates,a=o.whens;for(r=0,i=Math.min(n.length,a.length);i>r;++r)n[4*r+3]=a[r];var l=new ol.geom.LineString(null);l.setFlatCoordinates(ol.geom.GeometryLayout.XYZM,n);return l};ol.format.KML.readIcon_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.KML.ICON_PARSERS_,e,t);return o?o:null};ol.format.KML.readFlatCoordinatesFromNode_=function(e,t){return ol.xml.pushParseAndPop(null,ol.format.KML.GEOMETRY_FLAT_COORDINATES_PARSERS_,e,t)};ol.format.KML.readLineString_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.KML.EXTRUDE_AND_ALTITUDE_MODE_PARSERS_,e,t),r=ol.format.KML.readFlatCoordinatesFromNode_(e,t);if(r){var i=new ol.geom.LineString(null);i.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,r);i.setProperties(o);return i}return void 0};ol.format.KML.readLinearRing_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.KML.EXTRUDE_AND_ALTITUDE_MODE_PARSERS_,e,t),r=ol.format.KML.readFlatCoordinatesFromNode_(e,t);if(r){var i=new ol.geom.Polygon(null);i.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,r,[r.length]);i.setProperties(o);return i}return void 0};ol.format.KML.readMultiGeometry_=function(e,t){var o=ol.xml.pushParseAndPop([],ol.format.KML.MULTI_GEOMETRY_PARSERS_,e,t);if(!o)return null;if(0===o.length)return new ol.geom.GeometryCollection(o);var r,i,n,a,l=!0,s=o[0].getType();for(n=1,a=o.length;a>n;++n){i=o[n];if(i.getType()!=s){l=!1;break}}if(l){var p,c;if(s==ol.geom.GeometryType.POINT){var u=o[0];p=u.getLayout();c=u.getFlatCoordinates();for(n=1,a=o.length;a>n;++n){i=o[n];ol.array.extend(c,i.getFlatCoordinates())}r=new ol.geom.MultiPoint(null);r.setFlatCoordinates(p,c);ol.format.KML.setCommonGeometryProperties_(r,o)}else if(s==ol.geom.GeometryType.LINE_STRING){r=new ol.geom.MultiLineString(null);r.setLineStrings(o);ol.format.KML.setCommonGeometryProperties_(r,o)}else if(s==ol.geom.GeometryType.POLYGON){r=new ol.geom.MultiPolygon(null);r.setPolygons(o);ol.format.KML.setCommonGeometryProperties_(r,o)}else s==ol.geom.GeometryType.GEOMETRY_COLLECTION?r=new ol.geom.GeometryCollection(o):ol.asserts.assert(!1,37)}else r=new ol.geom.GeometryCollection(o);return r};ol.format.KML.readPoint_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.KML.EXTRUDE_AND_ALTITUDE_MODE_PARSERS_,e,t),r=ol.format.KML.readFlatCoordinatesFromNode_(e,t);if(r){var i=new ol.geom.Point(null);i.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,r);i.setProperties(o);return i}return void 0};ol.format.KML.readPolygon_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.KML.EXTRUDE_AND_ALTITUDE_MODE_PARSERS_,e,t),r=ol.xml.pushParseAndPop([null],ol.format.KML.FLAT_LINEAR_RINGS_PARSERS_,e,t);if(r&&r[0]){var i,n,a=new ol.geom.Polygon(null),l=r[0],s=[l.length];for(i=1,n=r.length;n>i;++i){ol.array.extend(l,r[i]);s.push(l.length)}a.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,l,s);a.setProperties(o);return a}return void 0};ol.format.KML.readStyle_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.KML.STYLE_PARSERS_,e,t);if(!o)return null;var r="fillStyle"in o?o.fillStyle:ol.format.KML.DEFAULT_FILL_STYLE_,i=o.fill;void 0===i||i||(r=null);var n="imageStyle"in o?o.imageStyle:ol.format.KML.DEFAULT_IMAGE_STYLE_;n==ol.format.KML.DEFAULT_NO_IMAGE_STYLE_&&(n=void 0);var a="textStyle"in o?o.textStyle:ol.format.KML.DEFAULT_TEXT_STYLE_,l="strokeStyle"in o?o.strokeStyle:ol.format.KML.DEFAULT_STROKE_STYLE_,s=o.outline;void 0===s||s||(l=null);return[new ol.style.Style({fill:r,image:n,stroke:l,text:a,zIndex:void 0})]};ol.format.KML.setCommonGeometryProperties_=function(e,t){var o,r,i,n,a=t.length,l=new Array(t.length),s=new Array(t.length);i=n=!1;for(r=0;a>r;++r){o=t[r];l[r]=o.get("extrude");s[r]=o.get("altitudeMode");i=i||void 0!==l[r];n=n||s[r]}i&&e.set("extrude",l);n&&e.set("altitudeMode",s)};ol.format.KML.DataParser_=function(e,t){var o=e.getAttribute("name");ol.xml.parseNode(ol.format.KML.DATA_PARSERS_,e,t);var r=t[t.length-1];null!==o?r[o]=r.value:null!==r.displayName&&(r[r.displayName]=r.value)};ol.format.KML.ExtendedDataParser_=function(e,t){ol.xml.parseNode(ol.format.KML.EXTENDED_DATA_PARSERS_,e,t)};ol.format.KML.RegionParser_=function(e,t){ol.xml.parseNode(ol.format.KML.REGION_PARSERS_,e,t)};ol.format.KML.PairDataParser_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.KML.PAIR_PARSERS_,e,t);if(o){var r=o.key;if(r&&"normal"==r){var i=o.styleUrl;i&&(t[t.length-1]=i);var n=o.Style;n&&(t[t.length-1]=n)}}};ol.format.KML.PlacemarkStyleMapParser_=function(e,t){var o=ol.format.KML.readStyleMapValue_(e,t);if(o){var r=t[t.length-1];Array.isArray(o)?r.Style=o:"string"==typeof o?r.styleUrl=o:ol.asserts.assert(!1,38)}};ol.format.KML.SchemaDataParser_=function(e,t){ol.xml.parseNode(ol.format.KML.SCHEMA_DATA_PARSERS_,e,t)};ol.format.KML.SimpleDataParser_=function(e,t){var o=e.getAttribute("name");if(null!==o){var r=ol.format.XSD.readString(e),i=t[t.length-1];i[o]=r}};ol.format.KML.LatLonAltBoxParser_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.KML.LAT_LON_ALT_BOX_PARSERS_,e,t);if(o){var r=t[t.length-1],i=[parseFloat(o.west),parseFloat(o.south),parseFloat(o.east),parseFloat(o.north)];r.extent=i;r.altitudeMode=o.altitudeMode;r.minAltitude=parseFloat(o.minAltitude);r.maxAltitude=parseFloat(o.maxAltitude)}};ol.format.KML.LodParser_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.KML.LOD_PARSERS_,e,t);if(o){var r=t[t.length-1];r.minLodPixels=parseFloat(o.minLodPixels);r.maxLodPixels=parseFloat(o.maxLodPixels);r.minFadeExtent=parseFloat(o.minFadeExtent);r.maxFadeExtent=parseFloat(o.maxFadeExtent)}};ol.format.KML.innerBoundaryIsParser_=function(e,t){var o=ol.xml.pushParseAndPop(void 0,ol.format.KML.INNER_BOUNDARY_IS_PARSERS_,e,t);if(o){var r=t[t.length-1];r.push(o)}};ol.format.KML.outerBoundaryIsParser_=function(e,t){var o=ol.xml.pushParseAndPop(void 0,ol.format.KML.OUTER_BOUNDARY_IS_PARSERS_,e,t);if(o){var r=t[t.length-1];r[0]=o}};ol.format.KML.LinkParser_=function(e,t){ol.xml.parseNode(ol.format.KML.LINK_PARSERS_,e,t)};ol.format.KML.whenParser_=function(e,t){var o=t[t.length-1],r=o.whens,i=ol.xml.getAllTextContent(e,!1),n=Date.parse(i);r.push(isNaN(n)?0:n)};ol.format.KML.DATA_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{displayName:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),value:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)});ol.format.KML.EXTENDED_DATA_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Data:ol.format.KML.DataParser_,SchemaData:ol.format.KML.SchemaDataParser_});ol.format.KML.REGION_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{LatLonAltBox:ol.format.KML.LatLonAltBoxParser_,Lod:ol.format.KML.LodParser_});ol.format.KML.LAT_LON_ALT_BOX_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{altitudeMode:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),minAltitude:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),maxAltitude:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),north:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),south:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),east:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),west:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal)});ol.format.KML.LOD_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{minLodPixels:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),maxLodPixels:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),minFadeExtent:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),maxFadeExtent:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal)});ol.format.KML.EXTRUDE_AND_ALTITUDE_MODE_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{extrude:ol.xml.makeObjectPropertySetter(ol.format.XSD.readBoolean),altitudeMode:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)});ol.format.KML.FLAT_LINEAR_RING_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{coordinates:ol.xml.makeReplacer(ol.format.KML.readFlatCoordinates_)});ol.format.KML.FLAT_LINEAR_RINGS_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{innerBoundaryIs:ol.format.KML.innerBoundaryIsParser_,outerBoundaryIs:ol.format.KML.outerBoundaryIsParser_});ol.format.KML.GX_TRACK_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{when:ol.format.KML.whenParser_},ol.xml.makeStructureNS(ol.format.KML.GX_NAMESPACE_URIS_,{coord:ol.format.KML.gxCoordParser_}));ol.format.KML.GEOMETRY_FLAT_COORDINATES_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{coordinates:ol.xml.makeReplacer(ol.format.KML.readFlatCoordinates_)});ol.format.KML.ICON_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{href:ol.xml.makeObjectPropertySetter(ol.format.KML.readURI_)},ol.xml.makeStructureNS(ol.format.KML.GX_NAMESPACE_URIS_,{x:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),y:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),w:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),h:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal)}));ol.format.KML.ICON_STYLE_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Icon:ol.xml.makeObjectPropertySetter(ol.format.KML.readIcon_),heading:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),hotSpot:ol.xml.makeObjectPropertySetter(ol.format.KML.readVec2_),scale:ol.xml.makeObjectPropertySetter(ol.format.KML.readScale_)});ol.format.KML.INNER_BOUNDARY_IS_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{LinearRing:ol.xml.makeReplacer(ol.format.KML.readFlatLinearRing_)});ol.format.KML.LABEL_STYLE_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{color:ol.xml.makeObjectPropertySetter(ol.format.KML.readColor_),scale:ol.xml.makeObjectPropertySetter(ol.format.KML.readScale_)});ol.format.KML.LINE_STYLE_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{color:ol.xml.makeObjectPropertySetter(ol.format.KML.readColor_),width:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal)});ol.format.KML.MULTI_GEOMETRY_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{LineString:ol.xml.makeArrayPusher(ol.format.KML.readLineString_),LinearRing:ol.xml.makeArrayPusher(ol.format.KML.readLinearRing_),MultiGeometry:ol.xml.makeArrayPusher(ol.format.KML.readMultiGeometry_),Point:ol.xml.makeArrayPusher(ol.format.KML.readPoint_),Polygon:ol.xml.makeArrayPusher(ol.format.KML.readPolygon_)});ol.format.KML.GX_MULTITRACK_GEOMETRY_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.GX_NAMESPACE_URIS_,{Track:ol.xml.makeArrayPusher(ol.format.KML.readGxTrack_)});ol.format.KML.NETWORK_LINK_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{ExtendedData:ol.format.KML.ExtendedDataParser_,Region:ol.format.KML.RegionParser_,Link:ol.format.KML.LinkParser_,address:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),description:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),name:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),open:ol.xml.makeObjectPropertySetter(ol.format.XSD.readBoolean),phoneNumber:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),visibility:ol.xml.makeObjectPropertySetter(ol.format.XSD.readBoolean)});ol.format.KML.LINK_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{href:ol.xml.makeObjectPropertySetter(ol.format.KML.readURI_)});ol.format.KML.OUTER_BOUNDARY_IS_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{LinearRing:ol.xml.makeReplacer(ol.format.KML.readFlatLinearRing_)});ol.format.KML.PAIR_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Style:ol.xml.makeObjectPropertySetter(ol.format.KML.readStyle_),key:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),styleUrl:ol.xml.makeObjectPropertySetter(ol.format.KML.readURI_)});ol.format.KML.PLACEMARK_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{ExtendedData:ol.format.KML.ExtendedDataParser_,Region:ol.format.KML.RegionParser_,MultiGeometry:ol.xml.makeObjectPropertySetter(ol.format.KML.readMultiGeometry_,"geometry"),LineString:ol.xml.makeObjectPropertySetter(ol.format.KML.readLineString_,"geometry"),LinearRing:ol.xml.makeObjectPropertySetter(ol.format.KML.readLinearRing_,"geometry"),Point:ol.xml.makeObjectPropertySetter(ol.format.KML.readPoint_,"geometry"),Polygon:ol.xml.makeObjectPropertySetter(ol.format.KML.readPolygon_,"geometry"),Style:ol.xml.makeObjectPropertySetter(ol.format.KML.readStyle_),StyleMap:ol.format.KML.PlacemarkStyleMapParser_,address:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),description:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),name:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),open:ol.xml.makeObjectPropertySetter(ol.format.XSD.readBoolean),phoneNumber:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),styleUrl:ol.xml.makeObjectPropertySetter(ol.format.KML.readURI_),visibility:ol.xml.makeObjectPropertySetter(ol.format.XSD.readBoolean)},ol.xml.makeStructureNS(ol.format.KML.GX_NAMESPACE_URIS_,{MultiTrack:ol.xml.makeObjectPropertySetter(ol.format.KML.readGxMultiTrack_,"geometry"),Track:ol.xml.makeObjectPropertySetter(ol.format.KML.readGxTrack_,"geometry")}));ol.format.KML.POLY_STYLE_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{color:ol.xml.makeObjectPropertySetter(ol.format.KML.readColor_),fill:ol.xml.makeObjectPropertySetter(ol.format.XSD.readBoolean),outline:ol.xml.makeObjectPropertySetter(ol.format.XSD.readBoolean)});ol.format.KML.SCHEMA_DATA_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{SimpleData:ol.format.KML.SimpleDataParser_});ol.format.KML.STYLE_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{IconStyle:ol.format.KML.IconStyleParser_,LabelStyle:ol.format.KML.LabelStyleParser_,LineStyle:ol.format.KML.LineStyleParser_,PolyStyle:ol.format.KML.PolyStyleParser_});ol.format.KML.STYLE_MAP_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Pair:ol.format.KML.PairDataParser_});ol.format.KML.prototype.readDocumentOrFolder_=function(e,t){var o=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Document:ol.xml.makeArrayExtender(this.readDocumentOrFolder_,this),Folder:ol.xml.makeArrayExtender(this.readDocumentOrFolder_,this),Placemark:ol.xml.makeArrayPusher(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),r=ol.xml.pushParseAndPop([],o,e,t,this);return r?r:void 0};ol.format.KML.prototype.readPlacemark_=function(e,t){var o=ol.xml.pushParseAndPop({geometry:null},ol.format.KML.PLACEMARK_PARSERS_,e,t);if(!o)return void 0;var r=new ol.Feature,i=e.getAttribute("id");null!==i&&r.setId(i);var n=t[0],a=o.geometry;a&&ol.format.Feature.transformWithOptions(a,!1,n);r.setGeometry(a);delete o.geometry;if(this.extractStyles_){var l=o.Style,s=o.styleUrl,p=ol.format.KML.createFeatureStyleFunction_(l,s,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);r.setStyle(p)}delete o.Style;r.setProperties(o);return r};ol.format.KML.prototype.readSharedStyle_=function(e,t){var o=e.getAttribute("id");if(null!==o){var r=ol.format.KML.readStyle_(e,t);if(r){var i;if(e.baseURI){var n=new URL("#"+o,e.baseURI);i=n.href}else i="#"+o;this.sharedStyles_[i]=r}}};ol.format.KML.prototype.readSharedStyleMap_=function(e,t){var o=e.getAttribute("id");if(null!==o){var r=ol.format.KML.readStyleMapValue_(e,t);if(r){var i;if(e.baseURI){var n=new URL("#"+o,e.baseURI);i=n.href}else i="#"+o;this.sharedStyles_[i]=r}}};ol.format.KML.prototype.readFeature;ol.format.KML.prototype.readFeatureFromNode=function(e,t){if(!ol.array.includes(ol.format.KML.NAMESPACE_URIS_,e.namespaceURI))return null;var o=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return o?o:null};ol.format.KML.prototype.readFeatures;ol.format.KML.prototype.readFeaturesFromNode=function(e,t){if(!ol.array.includes(ol.format.KML.NAMESPACE_URIS_,e.namespaceURI))return[];var o,r=e.localName;if("Document"==r||"Folder"==r){o=this.readDocumentOrFolder_(e,[this.getReadOptions(e,t)]);return o?o:[]}if("Placemark"==r){var i=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return i?[i]:[]}if("kml"==r){o=[];var n;for(n=e.firstElementChild;n;n=n.nextElementSibling){var a=this.readFeaturesFromNode(n,t);a&&ol.array.extend(o,a)}return o}return[]};ol.format.KML.prototype.readName=function(e){if(ol.xml.isDocument(e))return this.readNameFromDocument(e);if(ol.xml.isNode(e))return this.readNameFromNode(e);if("string"==typeof e){var t=ol.xml.parse(e);return this.readNameFromDocument(t)}return void 0};ol.format.KML.prototype.readNameFromDocument=function(e){var t;for(t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){var o=this.readNameFromNode(t);if(o)return o}return void 0};ol.format.KML.prototype.readNameFromNode=function(e){var t;for(t=e.firstElementChild;t;t=t.nextElementSibling)if(ol.array.includes(ol.format.KML.NAMESPACE_URIS_,t.namespaceURI)&&"name"==t.localName)return ol.format.XSD.readString(t);for(t=e.firstElementChild;t;t=t.nextElementSibling){var o=t.localName;if(ol.array.includes(ol.format.KML.NAMESPACE_URIS_,t.namespaceURI)&&("Document"==o||"Folder"==o||"Placemark"==o||"kml"==o)){var r=this.readNameFromNode(t);if(r)return r}}return void 0};ol.format.KML.prototype.readNetworkLinks=function(e){var t=[];if(ol.xml.isDocument(e))ol.array.extend(t,this.readNetworkLinksFromDocument(e));else if(ol.xml.isNode(e))ol.array.extend(t,this.readNetworkLinksFromNode(e));else if("string"==typeof e){var o=ol.xml.parse(e);ol.array.extend(t,this.readNetworkLinksFromDocument(o))}return t};ol.format.KML.prototype.readNetworkLinksFromDocument=function(e){var t,o=[];for(t=e.firstChild;t;t=t.nextSibling)t.nodeType==Node.ELEMENT_NODE&&ol.array.extend(o,this.readNetworkLinksFromNode(t));return o};ol.format.KML.prototype.readNetworkLinksFromNode=function(e){var t,o=[];for(t=e.firstElementChild;t;t=t.nextElementSibling)if(ol.array.includes(ol.format.KML.NAMESPACE_URIS_,t.namespaceURI)&&"NetworkLink"==t.localName){var r=ol.xml.pushParseAndPop({},ol.format.KML.NETWORK_LINK_PARSERS_,t,[]);o.push(r)}for(t=e.firstElementChild;t;t=t.nextElementSibling){var i=t.localName;!ol.array.includes(ol.format.KML.NAMESPACE_URIS_,t.namespaceURI)||"Document"!=i&&"Folder"!=i&&"kml"!=i||ol.array.extend(o,this.readNetworkLinksFromNode(t))}return o};ol.format.KML.prototype.readRegion=function(e){var t=[];if(ol.xml.isDocument(e))ol.array.extend(t,this.readRegionFromDocument(e));else if(ol.xml.isNode(e))ol.array.extend(t,this.readRegionFromNode(e));else if("string"==typeof e){var o=ol.xml.parse(e);ol.array.extend(t,this.readRegionFromDocument(o))}return t};ol.format.KML.prototype.readRegionFromDocument=function(e){var t,o=[];for(t=e.firstChild;t;t=t.nextSibling)t.nodeType==Node.ELEMENT_NODE&&ol.array.extend(o,this.readRegionFromNode(t));return o};ol.format.KML.prototype.readRegionFromNode=function(e){var t,o=[];for(t=e.firstElementChild;t;t=t.nextElementSibling)if(ol.array.includes(ol.format.KML.NAMESPACE_URIS_,t.namespaceURI)&&"Region"==t.localName){var r=ol.xml.pushParseAndPop({},ol.format.KML.REGION_PARSERS_,t,[]);o.push(r)}for(t=e.firstElementChild;t;t=t.nextElementSibling){var i=t.localName;!ol.array.includes(ol.format.KML.NAMESPACE_URIS_,t.namespaceURI)||"Document"!=i&&"Folder"!=i&&"kml"!=i||ol.array.extend(o,this.readRegionFromNode(t))}return o};ol.format.KML.prototype.readProjection;ol.format.KML.writeColorTextNode_=function(e,t){var o,r=ol.color.asArray(t),i=4==r.length?r[3]:1,n=[255*i,r[2],r[1],r[0]];for(o=0;4>o;++o){var a=parseInt(n[o],10).toString(16);n[o]=1==a.length?"0"+a:a}ol.format.XSD.writeStringTextNode(e,n.join(""))};ol.format.KML.writeCoordinatesTextNode_=function(e,t,o){var r,i=o[o.length-1],n=i.layout,a=i.stride;n==ol.geom.GeometryLayout.XY||n==ol.geom.GeometryLayout.XYM?r=2:n==ol.geom.GeometryLayout.XYZ||n==ol.geom.GeometryLayout.XYZM?r=3:ol.asserts.assert(!1,34);var l,s,p=t.length,c="";if(p>0){c+=t[0];for(l=1;r>l;++l)c+=","+t[l];for(s=a;p>s;s+=a){c+=" "+t[s];for(l=1;r>l;++l)c+=","+t[s+l]}}ol.format.XSD.writeStringTextNode(e,c)};ol.format.KML.writeDataNode_=function(e,t,o){e.setAttribute("name",t.name);var r={node:e},i=t.value;if("object"==typeof i){null!==i&&i.displayName&&ol.xml.pushSerializeAndPop(r,ol.format.KML.EXTENDEDDATA_NODE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,[i.displayName],o,["displayName"]);null!==i&&i.value&&ol.xml.pushSerializeAndPop(r,ol.format.KML.EXTENDEDDATA_NODE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,[i.value],o,["value"])}else ol.xml.pushSerializeAndPop(r,ol.format.KML.EXTENDEDDATA_NODE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,[i],o,["value"])};ol.format.KML.writeDataNodeName_=function(e,t){ol.format.XSD.writeCDATASection(e,t)};ol.format.KML.writeDataNodeValue_=function(e,t){ol.format.XSD.writeStringTextNode(e,t)};ol.format.KML.writeDocument_=function(e,t,o){var r={node:e};ol.xml.pushSerializeAndPop(r,ol.format.KML.DOCUMENT_SERIALIZERS_,ol.format.KML.DOCUMENT_NODE_FACTORY_,t,o,void 0,this)};ol.format.KML.writeExtendedData_=function(e,t,o){for(var r={node:e},i=t.names,n=t.values,a=i.length,l=0;a>l;l++)ol.xml.pushSerializeAndPop(r,ol.format.KML.EXTENDEDDATA_NODE_SERIALIZERS_,ol.format.KML.DATA_NODE_FACTORY_,[{name:i[l],value:n[l]}],o)};ol.format.KML.writeIcon_=function(e,t,o){var r={node:e},i=o[o.length-1].node,n=ol.format.KML.ICON_SEQUENCE_[i.namespaceURI],a=ol.xml.makeSequence(t,n);ol.xml.pushSerializeAndPop(r,ol.format.KML.ICON_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,a,o,n);n=ol.format.KML.ICON_SEQUENCE_[ol.format.KML.GX_NAMESPACE_URIS_[0]];a=ol.xml.makeSequence(t,n);ol.xml.pushSerializeAndPop(r,ol.format.KML.ICON_SERIALIZERS_,ol.format.KML.GX_NODE_FACTORY_,a,o,n)};ol.format.KML.writeIconStyle_=function(e,t,o){var r={node:e},i={},n=t.getSrc(),a=t.getSize(),l=t.getImageSize(),s={href:n};if(a){s.w=a[0];s.h=a[1];var p=t.getAnchor(),c=t.getOrigin();if(c&&l&&0!==c[0]&&c[1]!==a[1]){s.x=c[0];s.y=l[1]-(c[1]+a[1])}if(p&&0!==p[0]&&p[1]!==a[1]){var u={x:p[0],xunits:ol.style.IconAnchorUnits.PIXELS,y:a[1]-p[1],yunits:ol.style.IconAnchorUnits.PIXELS};i.hotSpot=u}}i.Icon=s;var g=t.getScale();1!==g&&(i.scale=g);var d=t.getRotation();0!==d&&(i.heading=d);var h=o[o.length-1].node,f=ol.format.KML.ICON_STYLE_SEQUENCE_[h.namespaceURI],y=ol.xml.makeSequence(i,f);ol.xml.pushSerializeAndPop(r,ol.format.KML.ICON_STYLE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,y,o,f)};ol.format.KML.writeLabelStyle_=function(e,t,o){var r={node:e},i={},n=t.getFill();n&&(i.color=n.getColor());var a=t.getScale();a&&1!==a&&(i.scale=a);var l=o[o.length-1].node,s=ol.format.KML.LABEL_STYLE_SEQUENCE_[l.namespaceURI],p=ol.xml.makeSequence(i,s);ol.xml.pushSerializeAndPop(r,ol.format.KML.LABEL_STYLE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,p,o,s)};ol.format.KML.writeLineStyle_=function(e,t,o){var r={node:e},i={color:t.getColor(),width:t.getWidth()},n=o[o.length-1].node,a=ol.format.KML.LINE_STYLE_SEQUENCE_[n.namespaceURI],l=ol.xml.makeSequence(i,a);ol.xml.pushSerializeAndPop(r,ol.format.KML.LINE_STYLE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,l,o,a)};ol.format.KML.writeMultiGeometry_=function(e,t,o){var r,i,n={node:e},a=t.getType();if(a==ol.geom.GeometryType.GEOMETRY_COLLECTION){r=t.getGeometries();i=ol.format.KML.GEOMETRY_NODE_FACTORY_}else if(a==ol.geom.GeometryType.MULTI_POINT){r=t.getPoints();i=ol.format.KML.POINT_NODE_FACTORY_}else if(a==ol.geom.GeometryType.MULTI_LINE_STRING){r=t.getLineStrings();i=ol.format.KML.LINE_STRING_NODE_FACTORY_}else if(a==ol.geom.GeometryType.MULTI_POLYGON){r=t.getPolygons();i=ol.format.KML.POLYGON_NODE_FACTORY_}else ol.asserts.assert(!1,39);ol.xml.pushSerializeAndPop(n,ol.format.KML.MULTI_GEOMETRY_SERIALIZERS_,i,r,o)};ol.format.KML.writeBoundaryIs_=function(e,t,o){var r={node:e};ol.xml.pushSerializeAndPop(r,ol.format.KML.BOUNDARY_IS_SERIALIZERS_,ol.format.KML.LINEAR_RING_NODE_FACTORY_,[t],o)};ol.format.KML.writePlacemark_=function(e,t,o){var r={node:e};t.getId()&&e.setAttribute("id",t.getId());var i=t.getProperties(),n={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};n[t.getGeometryName()]=1;var a=Object.keys(i||{}).sort().filter(function(e){return!n[e]});if(a.length>0){var l=ol.xml.makeSequence(i,a),s={names:a,values:l};ol.xml.pushSerializeAndPop(r,ol.format.KML.PLACEMARK_SERIALIZERS_,ol.format.KML.EXTENDEDDATA_NODE_FACTORY_,[s],o)}var p=t.getStyleFunction();if(p){var c=p.call(t,0);if(c){var u=Array.isArray(c)?c[0]:c;this.writeStyles_&&(i.Style=u);var g=u.getText();g&&(i.name=g.getText())}}var d=o[o.length-1].node,h=ol.format.KML.PLACEMARK_SEQUENCE_[d.namespaceURI],f=ol.xml.makeSequence(i,h);ol.xml.pushSerializeAndPop(r,ol.format.KML.PLACEMARK_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,f,o,h);var y=o[0],m=t.getGeometry();m&&(m=ol.format.Feature.transformWithOptions(m,!0,y));ol.xml.pushSerializeAndPop(r,ol.format.KML.PLACEMARK_SERIALIZERS_,ol.format.KML.GEOMETRY_NODE_FACTORY_,[m],o)};ol.format.KML.writePrimitiveGeometry_=function(e,t,o){var r=t.getFlatCoordinates(),i={node:e};i.layout=t.getLayout();i.stride=t.getStride();ol.xml.pushSerializeAndPop(i,ol.format.KML.PRIMITIVE_GEOMETRY_SERIALIZERS_,ol.format.KML.COORDINATES_NODE_FACTORY_,[r],o)};ol.format.KML.writePolygon_=function(e,t,o){var r=t.getLinearRings(),i=r.shift(),n={node:e};ol.xml.pushSerializeAndPop(n,ol.format.KML.POLYGON_SERIALIZERS_,ol.format.KML.INNER_BOUNDARY_NODE_FACTORY_,r,o);ol.xml.pushSerializeAndPop(n,ol.format.KML.POLYGON_SERIALIZERS_,ol.format.KML.OUTER_BOUNDARY_NODE_FACTORY_,[i],o)};ol.format.KML.writePolyStyle_=function(e,t,o){var r={node:e};ol.xml.pushSerializeAndPop(r,ol.format.KML.POLY_STYLE_SERIALIZERS_,ol.format.KML.COLOR_NODE_FACTORY_,[t.getColor()],o)};ol.format.KML.writeScaleTextNode_=function(e,t){ol.format.XSD.writeDecimalTextNode(e,Math.round(1e6*t)/1e6)};ol.format.KML.writeStyle_=function(e,t,o){var r={node:e},i={},n=t.getFill(),a=t.getStroke(),l=t.getImage(),s=t.getText();l instanceof ol.style.Icon&&(i.IconStyle=l);s&&(i.LabelStyle=s);a&&(i.LineStyle=a);n&&(i.PolyStyle=n);var p=o[o.length-1].node,c=ol.format.KML.STYLE_SEQUENCE_[p.namespaceURI],u=ol.xml.makeSequence(i,c);ol.xml.pushSerializeAndPop(r,ol.format.KML.STYLE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,u,o,c)};ol.format.KML.writeVec2_=function(e,t){e.setAttribute("x",t.x);e.setAttribute("y",t.y);e.setAttribute("xunits",t.xunits);e.setAttribute("yunits",t.yunits)};ol.format.KML.KML_SEQUENCE_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,["Document","Placemark"]);ol.format.KML.KML_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Document:ol.xml.makeChildAppender(ol.format.KML.writeDocument_),Placemark:ol.xml.makeChildAppender(ol.format.KML.writePlacemark_)});ol.format.KML.DOCUMENT_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Placemark:ol.xml.makeChildAppender(ol.format.KML.writePlacemark_)});ol.format.KML.EXTENDEDDATA_NODE_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Data:ol.xml.makeChildAppender(ol.format.KML.writeDataNode_),value:ol.xml.makeChildAppender(ol.format.KML.writeDataNodeValue_),displayName:ol.xml.makeChildAppender(ol.format.KML.writeDataNodeName_)});ol.format.KML.GEOMETRY_TYPE_TO_NODENAME_={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"};ol.format.KML.ICON_SEQUENCE_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,["href"],ol.xml.makeStructureNS(ol.format.KML.GX_NAMESPACE_URIS_,["x","y","w","h"]));ol.format.KML.ICON_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{href:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode)},ol.xml.makeStructureNS(ol.format.KML.GX_NAMESPACE_URIS_,{x:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),y:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),w:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),h:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode)}));ol.format.KML.ICON_STYLE_SEQUENCE_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,["scale","heading","Icon","hotSpot"]);ol.format.KML.ICON_STYLE_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{
Icon:ol.xml.makeChildAppender(ol.format.KML.writeIcon_),heading:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),hotSpot:ol.xml.makeChildAppender(ol.format.KML.writeVec2_),scale:ol.xml.makeChildAppender(ol.format.KML.writeScaleTextNode_)});ol.format.KML.LABEL_STYLE_SEQUENCE_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,["color","scale"]);ol.format.KML.LABEL_STYLE_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{color:ol.xml.makeChildAppender(ol.format.KML.writeColorTextNode_),scale:ol.xml.makeChildAppender(ol.format.KML.writeScaleTextNode_)});ol.format.KML.LINE_STYLE_SEQUENCE_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,["color","width"]);ol.format.KML.LINE_STYLE_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{color:ol.xml.makeChildAppender(ol.format.KML.writeColorTextNode_),width:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode)});ol.format.KML.BOUNDARY_IS_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{LinearRing:ol.xml.makeChildAppender(ol.format.KML.writePrimitiveGeometry_)});ol.format.KML.MULTI_GEOMETRY_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{LineString:ol.xml.makeChildAppender(ol.format.KML.writePrimitiveGeometry_),Point:ol.xml.makeChildAppender(ol.format.KML.writePrimitiveGeometry_),Polygon:ol.xml.makeChildAppender(ol.format.KML.writePolygon_),GeometryCollection:ol.xml.makeChildAppender(ol.format.KML.writeMultiGeometry_)});ol.format.KML.PLACEMARK_SEQUENCE_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]);ol.format.KML.PLACEMARK_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{ExtendedData:ol.xml.makeChildAppender(ol.format.KML.writeExtendedData_),MultiGeometry:ol.xml.makeChildAppender(ol.format.KML.writeMultiGeometry_),LineString:ol.xml.makeChildAppender(ol.format.KML.writePrimitiveGeometry_),LinearRing:ol.xml.makeChildAppender(ol.format.KML.writePrimitiveGeometry_),Point:ol.xml.makeChildAppender(ol.format.KML.writePrimitiveGeometry_),Polygon:ol.xml.makeChildAppender(ol.format.KML.writePolygon_),Style:ol.xml.makeChildAppender(ol.format.KML.writeStyle_),address:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),description:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),name:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),open:ol.xml.makeChildAppender(ol.format.XSD.writeBooleanTextNode),phoneNumber:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),styleUrl:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),visibility:ol.xml.makeChildAppender(ol.format.XSD.writeBooleanTextNode)});ol.format.KML.PRIMITIVE_GEOMETRY_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{coordinates:ol.xml.makeChildAppender(ol.format.KML.writeCoordinatesTextNode_)});ol.format.KML.POLYGON_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{outerBoundaryIs:ol.xml.makeChildAppender(ol.format.KML.writeBoundaryIs_),innerBoundaryIs:ol.xml.makeChildAppender(ol.format.KML.writeBoundaryIs_)});ol.format.KML.POLY_STYLE_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{color:ol.xml.makeChildAppender(ol.format.KML.writeColorTextNode_)});ol.format.KML.STYLE_SEQUENCE_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,["IconStyle","LabelStyle","LineStyle","PolyStyle"]);ol.format.KML.STYLE_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{IconStyle:ol.xml.makeChildAppender(ol.format.KML.writeIconStyle_),LabelStyle:ol.xml.makeChildAppender(ol.format.KML.writeLabelStyle_),LineStyle:ol.xml.makeChildAppender(ol.format.KML.writeLineStyle_),PolyStyle:ol.xml.makeChildAppender(ol.format.KML.writePolyStyle_)});ol.format.KML.GX_NODE_FACTORY_=function(e,t,o){return ol.xml.createElementNS(ol.format.KML.GX_NAMESPACE_URIS_[0],"gx:"+o)};ol.format.KML.DOCUMENT_NODE_FACTORY_=function(e,t,o){var r=t[t.length-1].node;return ol.xml.createElementNS(r.namespaceURI,"Placemark")};ol.format.KML.GEOMETRY_NODE_FACTORY_=function(e,t,o){if(e){var r=t[t.length-1].node;return ol.xml.createElementNS(r.namespaceURI,ol.format.KML.GEOMETRY_TYPE_TO_NODENAME_[e.getType()])}};ol.format.KML.COLOR_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("color");ol.format.KML.COORDINATES_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("coordinates");ol.format.KML.DATA_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("Data");ol.format.KML.EXTENDEDDATA_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("ExtendedData");ol.format.KML.INNER_BOUNDARY_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("innerBoundaryIs");ol.format.KML.POINT_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("Point");ol.format.KML.LINE_STRING_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("LineString");ol.format.KML.LINEAR_RING_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("LinearRing");ol.format.KML.POLYGON_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("Polygon");ol.format.KML.OUTER_BOUNDARY_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("outerBoundaryIs");ol.format.KML.prototype.writeFeatures;ol.format.KML.prototype.writeFeaturesNode=function(e,t){t=this.adaptOptions(t);var o=ol.xml.createElementNS(ol.format.KML.NAMESPACE_URIS_[4],"kml"),r="http://www.w3.org/2000/xmlns/",i="http://www.w3.org/2001/XMLSchema-instance";ol.xml.setAttributeNS(o,r,"xmlns:gx",ol.format.KML.GX_NAMESPACE_URIS_[0]);ol.xml.setAttributeNS(o,r,"xmlns:xsi",i);ol.xml.setAttributeNS(o,i,"xsi:schemaLocation",ol.format.KML.SCHEMA_LOCATION_);var n={node:o},a={};e.length>1?a.Document=e:1==e.length&&(a.Placemark=e[0]);var l=ol.format.KML.KML_SEQUENCE_[o.namespaceURI],s=ol.xml.makeSequence(a,l);ol.xml.pushSerializeAndPop(n,ol.format.KML.KML_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,s,[t],l,this);return o};goog.provide("ol.ext.pbf");ol.ext.pbf;!function(){var e,t={},o={exports:t};!function(r){if("object"==typeof t&&"undefined"!=typeof o)o.exports=r();else if("function"==typeof e&&e.amd)e([],r);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this;i.pbf=r()}}(function(){return function e(t,o,r){function i(a,l){if(!o[a]){if(!t[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(n)return n(a,!0);var p=new Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var c=o[a]={exports:{}};t[a][0].call(c.exports,function(e){var o=t[a][1][e];return i(o?o:e)},c,c.exports,e,t,o,r)}return o[a].exports}for(var n="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,o){o.read=function(e,t,o,r,i){var n,a,l=8*i-r-1,s=(1<<l)-1,p=s>>1,c=-7,u=o?i-1:0,g=o?-1:1,d=e[t+u];u+=g;n=d&(1<<-c)-1;d>>=-c;c+=l;for(;c>0;n=256*n+e[t+u],u+=g,c-=8);a=n&(1<<-c)-1;n>>=-c;c+=r;for(;c>0;a=256*a+e[t+u],u+=g,c-=8);if(0===n)n=1-p;else{if(n===s)return a?0/0:(d?-1:1)*(1/0);a+=Math.pow(2,r);n-=p}return(d?-1:1)*a*Math.pow(2,n-r)};o.write=function(e,t,o,r,i,n){var a,l,s,p=8*n-i-1,c=(1<<p)-1,u=c>>1,g=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:n-1,h=r?1:-1,f=0>t||0===t&&0>1/t?1:0;t=Math.abs(t);if(isNaN(t)||t===1/0){l=isNaN(t)?1:0;a=c}else{a=Math.floor(Math.log(t)/Math.LN2);if(t*(s=Math.pow(2,-a))<1){a--;s*=2}t+=a+u>=1?g/s:g*Math.pow(2,1-u);if(t*s>=2){a++;s/=2}if(a+u>=c){l=0;a=c}else if(a+u>=1){l=(t*s-1)*Math.pow(2,i);a+=u}else{l=t*Math.pow(2,u-1)*Math.pow(2,i);a=0}}for(;i>=8;e[o+d]=255&l,d+=h,l/=256,i-=8);a=a<<i|l;p+=i;for(;p>0;e[o+d]=255&a,d+=h,a/=256,p-=8);e[o+d-h]|=128*f}},{}],2:[function(e,t,o){"use strict";function r(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0);this.pos=0;this.type=0;this.length=this.buf.length}function i(e,t,o){var r,i,n=o.buf;i=n[o.pos++];r=(112&i)>>4;if(128>i)return a(e,r,t);i=n[o.pos++];r|=(127&i)<<3;if(128>i)return a(e,r,t);i=n[o.pos++];r|=(127&i)<<10;if(128>i)return a(e,r,t);i=n[o.pos++];r|=(127&i)<<17;if(128>i)return a(e,r,t);i=n[o.pos++];r|=(127&i)<<24;if(128>i)return a(e,r,t);i=n[o.pos++];r|=(1&i)<<31;if(128>i)return a(e,r,t);throw new Error("Expected varint not more than 10 bytes")}function n(e){return e.type===r.Bytes?e.readVarint()+e.pos:e.pos+1}function a(e,t,o){return o?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function l(e,t){var o,r;if(e>=0){o=e%4294967296|0;r=e/4294967296|0}else{o=~(-e%4294967296);r=~(-e/4294967296);if(4294967295^o)o=o+1|0;else{o=0;r=r+1|0}}if(e>=0x10000000000000000||-0x10000000000000000>e)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10);s(o,r,t);p(r,t)}function s(e,t,o){o.buf[o.pos++]=127&e|128;e>>>=7;o.buf[o.pos++]=127&e|128;e>>>=7;o.buf[o.pos++]=127&e|128;e>>>=7;o.buf[o.pos++]=127&e|128;e>>>=7;o.buf[o.pos]=127&e}function p(e,t){var o=(7&e)<<4;t.buf[t.pos++]|=o|((e>>>=3)?128:0);if(e){t.buf[t.pos++]=127&e|((e>>>=7)?128:0);if(e){t.buf[t.pos++]=127&e|((e>>>=7)?128:0);if(e){t.buf[t.pos++]=127&e|((e>>>=7)?128:0);if(e){t.buf[t.pos++]=127&e|((e>>>=7)?128:0);e&&(t.buf[t.pos++]=127&e)}}}}}function c(e,t,o){var r=16383>=t?1:2097151>=t?2:268435455>=t?3:Math.ceil(Math.log(t)/(7*Math.LN2));o.realloc(r);for(var i=o.pos-1;i>=e;i--)o.buf[i+r]=o.buf[i]}function u(e,t){for(var o=0;o<e.length;o++)t.writeVarint(e[o])}function g(e,t){for(var o=0;o<e.length;o++)t.writeSVarint(e[o])}function d(e,t){for(var o=0;o<e.length;o++)t.writeFloat(e[o])}function h(e,t){for(var o=0;o<e.length;o++)t.writeDouble(e[o])}function f(e,t){for(var o=0;o<e.length;o++)t.writeBoolean(e[o])}function y(e,t){for(var o=0;o<e.length;o++)t.writeFixed32(e[o])}function m(e,t){for(var o=0;o<e.length;o++)t.writeSFixed32(e[o])}function v(e,t){for(var o=0;o<e.length;o++)t.writeFixed64(e[o])}function C(e,t){for(var o=0;o<e.length;o++)t.writeSFixed64(e[o])}function T(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function _(e,t,o){e[o]=t;e[o+1]=t>>>8;e[o+2]=t>>>16;e[o+3]=t>>>24}function S(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function E(e,t,o){for(var r="",i=t;o>i;){var n=e[i],a=null,l=n>239?4:n>223?3:n>191?2:1;if(i+l>o)break;var s,p,c;if(1===l)128>n&&(a=n);else if(2===l){s=e[i+1];if(128===(192&s)){a=(31&n)<<6|63&s;127>=a&&(a=null)}}else if(3===l){s=e[i+1];p=e[i+2];if(128===(192&s)&&128===(192&p)){a=(15&n)<<12|(63&s)<<6|63&p;(2047>=a||a>=55296&&57343>=a)&&(a=null)}}else if(4===l){s=e[i+1];p=e[i+2];c=e[i+3];if(128===(192&s)&&128===(192&p)&&128===(192&c)){a=(15&n)<<18|(63&s)<<12|(63&p)<<6|63&c;(65535>=a||a>=1114112)&&(a=null)}}if(null===a){a=65533;l=1}else if(a>65535){a-=65536;r+=String.fromCharCode(a>>>10&1023|55296);a=56320|1023&a}r+=String.fromCharCode(a);i+=l}return r}function x(e,t,o){for(var r,i,n=0;n<t.length;n++){r=t.charCodeAt(n);if(r>55295&&57344>r){if(!i){if(r>56319||n+1===t.length){e[o++]=239;e[o++]=191;e[o++]=189}else i=r;continue}if(56320>r){e[o++]=239;e[o++]=191;e[o++]=189;i=r;continue}r=i-55296<<10|r-56320|65536;i=null}else if(i){e[o++]=239;e[o++]=191;e[o++]=189;i=null}if(128>r)e[o++]=r;else{if(2048>r)e[o++]=r>>6|192;else{if(65536>r)e[o++]=r>>12|224;else{e[o++]=r>>18|240;e[o++]=r>>12&63|128}e[o++]=r>>6&63|128}e[o++]=63&r|128}}return o}t.exports=r;var P=e("ieee754");r.Varint=0;r.Fixed64=1;r.Bytes=2;r.Fixed32=5;var L=4294967296,w=1/L;r.prototype={destroy:function(){this.buf=null},readFields:function(e,t,o){o=o||this.length;for(;this.pos<o;){var r=this.readVarint(),i=r>>3,n=this.pos;this.type=7&r;e(i,t,this);this.pos===n&&this.skip(r)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=T(this.buf,this.pos);this.pos+=4;return e},readSFixed32:function(){var e=S(this.buf,this.pos);this.pos+=4;return e},readFixed64:function(){var e=T(this.buf,this.pos)+T(this.buf,this.pos+4)*L;this.pos+=8;return e},readSFixed64:function(){var e=T(this.buf,this.pos)+S(this.buf,this.pos+4)*L;this.pos+=8;return e},readFloat:function(){var e=P.read(this.buf,this.pos,!0,23,4);this.pos+=4;return e},readDouble:function(){var e=P.read(this.buf,this.pos,!0,52,8);this.pos+=8;return e},readVarint:function(e){var t,o,r=this.buf;o=r[this.pos++];t=127&o;if(128>o)return t;o=r[this.pos++];t|=(127&o)<<7;if(128>o)return t;o=r[this.pos++];t|=(127&o)<<14;if(128>o)return t;o=r[this.pos++];t|=(127&o)<<21;if(128>o)return t;o=r[this.pos];t|=(15&o)<<28;return i(t,e,this)},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2===1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=E(this.buf,this.pos,e);this.pos=e;return t},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);this.pos=e;return t},readPackedVarint:function(e,t){var o=n(this);e=e||[];for(;this.pos<o;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){var t=n(this);e=e||[];for(;this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){var t=n(this);e=e||[];for(;this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){var t=n(this);e=e||[];for(;this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){var t=n(this);e=e||[];for(;this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){var t=n(this);e=e||[];for(;this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){var t=n(this);e=e||[];for(;this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){var t=n(this);e=e||[];for(;this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){var t=n(this);e=e||[];for(;this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===r.Varint)for(;this.buf[this.pos++]>127;);else if(t===r.Bytes)this.pos=this.readVarint()+this.pos;else if(t===r.Fixed32)this.pos+=4;else{if(t!==r.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var o=new Uint8Array(t);o.set(this.buf);this.buf=o;this.length=t}},finish:function(){this.length=this.pos;this.pos=0;return this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4);_(this.buf,e,this.pos);this.pos+=4},writeSFixed32:function(e){this.realloc(4);_(this.buf,e,this.pos);this.pos+=4},writeFixed64:function(e){this.realloc(8);_(this.buf,-1&e,this.pos);_(this.buf,Math.floor(e*w),this.pos+4);this.pos+=8},writeSFixed64:function(e){this.realloc(8);_(this.buf,-1&e,this.pos);_(this.buf,Math.floor(e*w),this.pos+4);this.pos+=8},writeVarint:function(e){e=+e||0;if(e>268435455||0>e)l(e,this);else{this.realloc(4);this.buf[this.pos++]=127&e|(e>127?128:0);if(!(127>=e)){this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0);if(!(127>=e)){this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0);127>=e||(this.buf[this.pos++]=e>>>7&127)}}}},writeSVarint:function(e){this.writeVarint(0>e?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e);this.realloc(4*e.length);this.pos++;var t=this.pos;this.pos=x(this.buf,e,this.pos);var o=this.pos-t;o>=128&&c(t,o,this);this.pos=t-1;this.writeVarint(o);this.pos+=o},writeFloat:function(e){this.realloc(4);P.write(this.buf,e,this.pos,!0,23,4);this.pos+=4},writeDouble:function(e){this.realloc(8);P.write(this.buf,e,this.pos,!0,52,8);this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t);this.realloc(t);for(var o=0;t>o;o++)this.buf[this.pos++]=e[o]},writeRawMessage:function(e,t){this.pos++;var o=this.pos;e(t,this);var r=this.pos-o;r>=128&&c(o,r,this);this.pos=o-1;this.writeVarint(r);this.pos+=r},writeMessage:function(e,t,o){this.writeTag(e,r.Bytes);this.writeRawMessage(t,o)},writePackedVarint:function(e,t){this.writeMessage(e,u,t)},writePackedSVarint:function(e,t){this.writeMessage(e,g,t)},writePackedBoolean:function(e,t){this.writeMessage(e,f,t)},writePackedFloat:function(e,t){this.writeMessage(e,d,t)},writePackedDouble:function(e,t){this.writeMessage(e,h,t)},writePackedFixed32:function(e,t){this.writeMessage(e,y,t)},writePackedSFixed32:function(e,t){this.writeMessage(e,m,t)},writePackedFixed64:function(e,t){this.writeMessage(e,v,t)},writePackedSFixed64:function(e,t){this.writeMessage(e,C,t)},writeBytesField:function(e,t){this.writeTag(e,r.Bytes);this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,r.Fixed32);this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,r.Fixed32);this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,r.Fixed64);this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,r.Fixed64);this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,r.Varint);this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,r.Varint);this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,r.Bytes);this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,r.Fixed32);this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,r.Fixed64);this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}}},{ieee754:1}]},{},[2])(2)});ol.ext.pbf=o.exports}();goog.provide("ol.ext.vectortile");ol.ext.vectortile;!function(){var e,t={},o={exports:t};!function(r){if("object"==typeof t&&"undefined"!=typeof o)o.exports=r();else if("function"==typeof e&&e.amd)e([],r);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this;i.vectortile=r()}}(function(){return function e(t,o,r){function i(a,l){if(!o[a]){if(!t[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(n)return n(a,!0);var p=new Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var c=o[a]={exports:{}};t[a][0].call(c.exports,function(e){var o=t[a][1][e];return i(o?o:e)},c,c.exports,e,t,o,r)}return o[a].exports}for(var n="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,o){"use strict";function r(e,t){this.x=e;this.y=t}t.exports=r;r.prototype={clone:function(){return new r(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,o=e.y-this.y;return t*t+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,o=e[2]*this.x+e[3]*this.y;this.x=t;this.y=o;return this},_add:function(e){this.x+=e.x;this.y+=e.y;return this},_sub:function(e){this.x-=e.x;this.y-=e.y;return this},_mult:function(e){this.x*=e;this.y*=e;return this},_div:function(e){this.x/=e;this.y/=e;return this},_unit:function(){this._div(this.mag());return this},_perp:function(){var e=this.y;this.y=this.x;this.x=-e;return this},_rotate:function(e){var t=Math.cos(e),o=Math.sin(e),r=t*this.x-o*this.y,i=o*this.x+t*this.y;this.x=r;this.y=i;return this},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}};r.convert=function(e){return e instanceof r?e:Array.isArray(e)?new r(e[0],e[1]):e}},{}],2:[function(e,t,o){t.exports.VectorTile=e("./lib/vectortile.js");t.exports.VectorTileFeature=e("./lib/vectortilefeature.js");t.exports.VectorTileLayer=e("./lib/vectortilelayer.js")},{"./lib/vectortile.js":3,"./lib/vectortilefeature.js":4,"./lib/vectortilelayer.js":5}],3:[function(e,t,o){"use strict";function r(e,t){this.layers=e.readFields(i,{},t)}function i(e,t,o){if(3===e){var r=new n(o,o.readVarint()+o.pos);r.length&&(t[r.name]=r)}}var n=e("./vectortilelayer");t.exports=r},{"./vectortilelayer":5}],4:[function(e,t,o){"use strict";function r(e,t,o,r,n){this.properties={};this.extent=o;this.type=0;this._pbf=e;this._geometry=-1;this._keys=r;this._values=n;e.readFields(i,this,t)}function i(e,t,o){1==e?t.id=o.readVarint():2==e?n(o,t):3==e?t.type=o.readVarint():4==e&&(t._geometry=o.pos)}function n(e,t){for(var o=e.readVarint()+e.pos;e.pos<o;){var r=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[r]=i}}function a(e){var t=e.length;if(1>=t)return[e];for(var o,r,i=[],n=0;t>n;n++){var a=l(e[n]);if(0!==a){void 0===r&&(r=0>a);if(r===0>a){o&&i.push(o);o=[e[n]]}else o.push(e[n])}}o&&i.push(o);return i}function l(e){for(var t,o,r=0,i=0,n=e.length,a=n-1;n>i;a=i++){t=e[i];o=e[a];r+=(o.x-t.x)*(t.y+o.y)}return r}var s=e("point-geometry");t.exports=r;r.types=["Unknown","Point","LineString","Polygon"];r.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,o=e.readVarint()+e.pos,r=1,i=0,n=0,a=0,l=[];e.pos<o;){if(!i){var p=e.readVarint();r=7&p;i=p>>3}i--;if(1===r||2===r){n+=e.readSVarint();a+=e.readSVarint();if(1===r){t&&l.push(t);t=[]}t.push(new s(n,a))}else{if(7!==r)throw new Error("unknown command "+r);t&&t.push(t[0].clone())}}t&&l.push(t);return l};r.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,o=1,r=0,i=0,n=0,a=1/0,l=-(1/0),s=1/0,p=-(1/0);e.pos<t;){if(!r){var c=e.readVarint();o=7&c;r=c>>3}r--;if(1===o||2===o){i+=e.readSVarint();n+=e.readSVarint();a>i&&(a=i);i>l&&(l=i);s>n&&(s=n);n>p&&(p=n)}else if(7!==o)throw new Error("unknown command "+o)}return[a,s,l,p]};r.prototype.toGeoJSON=function(e,t,o){function i(e){for(var t=0;t<e.length;t++){var o=e[t],r=180-360*(o.y+c)/s;e[t]=[360*(o.x+p)/s-180,360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90]}}var n,l,s=this.extent*Math.pow(2,o),p=this.extent*e,c=this.extent*t,u=this.loadGeometry(),g=r.types[this.type];switch(this.type){case 1:var d=[];for(n=0;n<u.length;n++)d[n]=u[n][0];u=d;i(u);break;case 2:for(n=0;n<u.length;n++)i(u[n]);break;case 3:u=a(u);for(n=0;n<u.length;n++)for(l=0;l<u[n].length;l++)i(u[n][l])}1===u.length?u=u[0]:g="Multi"+g;var h={type:"Feature",geometry:{type:g,coordinates:u},properties:this.properties};"id"in this&&(h.id=this.id);return h}},{"point-geometry":1}],5:[function(e,t,o){"use strict";function r(e,t){this.version=1;this.name=null;this.extent=4096;this.length=0;this._pbf=e;this._keys=[];this._values=[];this._features=[];e.readFields(i,this,t);this.length=this._features.length}function i(e,t,o){15===e?t.version=o.readVarint():1===e?t.name=o.readString():5===e?t.extent=o.readVarint():2===e?t._features.push(o.pos):3===e?t._keys.push(o.readString()):4===e&&t._values.push(n(o))}function n(e){for(var t=null,o=e.readVarint()+e.pos;e.pos<o;){var r=e.readVarint()>>3;t=1===r?e.readString():2===r?e.readFloat():3===r?e.readDouble():4===r?e.readVarint64():5===r?e.readVarint():6===r?e.readSVarint():7===r?e.readBoolean():null}return t}var a=e("./vectortilefeature.js");t.exports=r;r.prototype.feature=function(e){if(0>e||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new a(this._pbf,t,this.extent,this._keys,this._values)}},{"./vectortilefeature.js":4}]},{},[2])(2)});ol.ext.vectortile=o.exports}();goog.provide("ol.render.Feature");goog.require("ol");goog.require("ol.extent");goog.require("ol.geom.GeometryType");ol.render.Feature=function(e,t,o,r){this.extent_;this.type_=e;this.flatCoordinates_=t;this.ends_=o;this.properties_=r};ol.render.Feature.prototype.get=function(e){return this.properties_[e]};ol.render.Feature.prototype.getEnds=function(){return this.ends_};ol.render.Feature.prototype.getExtent=function(){this.extent_||(this.extent_=this.type_===ol.geom.GeometryType.POINT?ol.extent.createOrUpdateFromCoordinate(this.flatCoordinates_):ol.extent.createOrUpdateFromFlatCoordinates(this.flatCoordinates_,0,this.flatCoordinates_.length,2));return this.extent_};ol.render.Feature.prototype.getOrientedFlatCoordinates=function(){return this.flatCoordinates_};ol.render.Feature.prototype.getFlatCoordinates=ol.render.Feature.prototype.getOrientedFlatCoordinates;ol.render.Feature.prototype.getGeometry=function(){return this};ol.render.Feature.prototype.getProperties=function(){return this.properties_};ol.render.Feature.prototype.getSimplifiedGeometry=ol.render.Feature.prototype.getGeometry;ol.render.Feature.prototype.getStride=function(){return 2};ol.render.Feature.prototype.getStyleFunction=ol.nullFunction;ol.render.Feature.prototype.getType=function(){return this.type_};goog.provide("ol.format.MVT");goog.require("ol");goog.require("ol.ext.pbf");goog.require("ol.ext.vectortile");goog.require("ol.format.Feature");goog.require("ol.format.FormatType");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.GeometryType");goog.require("ol.geom.LineString");goog.require("ol.geom.MultiLineString");goog.require("ol.geom.MultiPoint");goog.require("ol.geom.Point");goog.require("ol.geom.Polygon");goog.require("ol.proj.Projection");goog.require("ol.proj.Units");goog.require("ol.render.Feature");ol.format.MVT=function(e){ol.format.Feature.call(this);var t=e?e:{};this.defaultDataProjection=new ol.proj.Projection({code:"",units:ol.proj.Units.TILE_PIXELS});this.featureClass_=t.featureClass?t.featureClass:ol.render.Feature;this.geometryName_=t.geometryName;this.layerName_=t.layerName?t.layerName:"layer";this.layers_=t.layers?t.layers:null};ol.inherits(ol.format.MVT,ol.format.Feature);ol.format.MVT.prototype.getType=function(){return ol.format.FormatType.ARRAY_BUFFER};ol.format.MVT.prototype.readFeature_=function(e,t,o){var r=new this.featureClass_,i=e.id,n=e.properties;n[this.layerName_]=t;this.geometryName_&&r.setGeometryName(this.geometryName_);var a=ol.format.Feature.transformWithOptions(ol.format.MVT.readGeometry_(e),!1,this.adaptOptions(o));r.setGeometry(a);r.setId(i);r.setProperties(n);return r};ol.format.MVT.prototype.readRenderFeature_=function(e,t){var o=e.loadGeometry(),r=[],i=[];ol.format.MVT.calculateFlatCoordinates_(o,i,r);var n,a=e.type;1===a?n=1===o.length?ol.geom.GeometryType.POINT:ol.geom.GeometryType.MULTI_POINT:2===a?n=1===o.length?ol.geom.GeometryType.LINE_STRING:ol.geom.GeometryType.MULTI_LINE_STRING:3===a&&(n=ol.geom.GeometryType.POLYGON);var l=e.properties;l[this.layerName_]=t;return new this.featureClass_(n,i,r,l)};ol.format.MVT.prototype.readFeatures=function(e,t){var o,r,i=this.layers_,n=new ol.ext.pbf(e),a=new ol.ext.vectortile.VectorTile(n),l=[],s=this.featureClass_;for(var p in a.layers)if(!i||-1!=i.indexOf(p)){o=a.layers[p];for(var c=0,u=o.length;u>c;++c){r=s===ol.render.Feature?this.readRenderFeature_(o.feature(c),p):this.readFeature_(o.feature(c),p,t);l.push(r)}}return l};ol.format.MVT.prototype.readProjection=function(e){return this.defaultDataProjection};ol.format.MVT.prototype.setLayers=function(e){this.layers_=e};ol.format.MVT.calculateFlatCoordinates_=function(e,t,o){for(var r=0,i=0,n=e.length;n>i;++i){var a,l,s=e[i];for(a=0,l=s.length;l>a;++a){var p=s[a];t.push(p.x,p.y)}r+=2*a;o.push(r)}};ol.format.MVT.readGeometry_=function(e){var t=e.type;if(0===t)return null;var o=e.loadGeometry(),r=[],i=[];ol.format.MVT.calculateFlatCoordinates_(o,i,r);var n;1===t?n=1===o.length?new ol.geom.Point(null):new ol.geom.MultiPoint(null):2===t?n=1===o.length?new ol.geom.LineString(null):new ol.geom.MultiLineString(null):3===t&&(n=new ol.geom.Polygon(null));n.setFlatCoordinates(ol.geom.GeometryLayout.XY,i,r);return n};ol.format.MVT.prototype.readFeature=function(){};ol.format.MVT.prototype.readGeometry=function(){};ol.format.MVT.prototype.writeFeature=function(){};ol.format.MVT.prototype.writeGeometry=function(){};ol.format.MVT.prototype.writeFeatures=function(){};goog.provide("ol.format.OSMXML");goog.require("ol");goog.require("ol.array");goog.require("ol.Feature");goog.require("ol.format.Feature");goog.require("ol.format.XMLFeature");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.LineString");goog.require("ol.geom.Point");goog.require("ol.geom.Polygon");goog.require("ol.obj");goog.require("ol.proj");goog.require("ol.xml");ol.format.OSMXML=function(){ol.format.XMLFeature.call(this);this.defaultDataProjection=ol.proj.get("EPSG:4326")};ol.inherits(ol.format.OSMXML,ol.format.XMLFeature);ol.format.OSMXML.readNode_=function(e,t){var o=t[0],r=t[t.length-1],i=e.getAttribute("id"),n=[parseFloat(e.getAttribute("lon")),parseFloat(e.getAttribute("lat"))];r.nodes[i]=n;var a=ol.xml.pushParseAndPop({tags:{}},ol.format.OSMXML.NODE_PARSERS_,e,t);if(!ol.obj.isEmpty(a.tags)){var l=new ol.geom.Point(n);ol.format.Feature.transformWithOptions(l,!1,o);var s=new ol.Feature(l);s.setId(i);s.setProperties(a.tags);r.features.push(s)}};ol.format.OSMXML.readWay_=function(e,t){for(var o=t[0],r=e.getAttribute("id"),i=ol.xml.pushParseAndPop({ndrefs:[],tags:{}},ol.format.OSMXML.WAY_PARSERS_,e,t),n=t[t.length-1],a=[],l=0,s=i.ndrefs.length;s>l;l++){var p=n.nodes[i.ndrefs[l]];ol.array.extend(a,p)}var c;if(i.ndrefs[0]==i.ndrefs[i.ndrefs.length-1]){c=new ol.geom.Polygon(null);c.setFlatCoordinates(ol.geom.GeometryLayout.XY,a,[a.length])}else{c=new ol.geom.LineString(null);c.setFlatCoordinates(ol.geom.GeometryLayout.XY,a)}ol.format.Feature.transformWithOptions(c,!1,o);var u=new ol.Feature(c);u.setId(r);u.setProperties(i.tags);n.features.push(u)};ol.format.OSMXML.readNd_=function(e,t){var o=t[t.length-1];o.ndrefs.push(e.getAttribute("ref"))};ol.format.OSMXML.readTag_=function(e,t){var o=t[t.length-1];o.tags[e.getAttribute("k")]=e.getAttribute("v")};ol.format.OSMXML.NAMESPACE_URIS_=[null];ol.format.OSMXML.WAY_PARSERS_=ol.xml.makeStructureNS(ol.format.OSMXML.NAMESPACE_URIS_,{nd:ol.format.OSMXML.readNd_,tag:ol.format.OSMXML.readTag_});ol.format.OSMXML.PARSERS_=ol.xml.makeStructureNS(ol.format.OSMXML.NAMESPACE_URIS_,{node:ol.format.OSMXML.readNode_,way:ol.format.OSMXML.readWay_});ol.format.OSMXML.NODE_PARSERS_=ol.xml.makeStructureNS(ol.format.OSMXML.NAMESPACE_URIS_,{tag:ol.format.OSMXML.readTag_});ol.format.OSMXML.prototype.readFeatures;ol.format.OSMXML.prototype.readFeaturesFromNode=function(e,t){var o=this.getReadOptions(e,t);if("osm"==e.localName){var r=ol.xml.pushParseAndPop({nodes:{},features:[]},ol.format.OSMXML.PARSERS_,e,[o]);if(r.features)return r.features}return[]};ol.format.OSMXML.prototype.readProjection;ol.format.OSMXML.prototype.writeFeatureNode=function(e,t){};ol.format.OSMXML.prototype.writeFeaturesNode=function(e,t){};ol.format.OSMXML.prototype.writeGeometryNode=function(e,t){};goog.provide("ol.format.XLink");ol.format.XLink.NAMESPACE_URI="http://www.w3.org/1999/xlink";ol.format.XLink.readHref=function(e){return e.getAttributeNS(ol.format.XLink.NAMESPACE_URI,"href")};goog.provide("ol.format.XML");goog.require("ol.xml");ol.format.XML=function(){};ol.format.XML.prototype.read=function(e){if(ol.xml.isDocument(e))return this.readFromDocument(e);if(ol.xml.isNode(e))return this.readFromNode(e);if("string"==typeof e){var t=ol.xml.parse(e);return this.readFromDocument(t)}return null};ol.format.XML.prototype.readFromDocument=function(e){};ol.format.XML.prototype.readFromNode=function(e){};goog.provide("ol.format.OWS");goog.require("ol");goog.require("ol.format.XLink");goog.require("ol.format.XML");goog.require("ol.format.XSD");goog.require("ol.xml");ol.format.OWS=function(){ol.format.XML.call(this)};ol.inherits(ol.format.OWS,ol.format.XML);ol.format.OWS.prototype.readFromDocument=function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFromNode(t);return null};ol.format.OWS.prototype.readFromNode=function(e){var t=ol.xml.pushParseAndPop({},ol.format.OWS.PARSERS_,e,[]);return t?t:null};ol.format.OWS.readAddress_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.OWS.ADDRESS_PARSERS_,e,t)};ol.format.OWS.readAllowedValues_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.OWS.ALLOWED_VALUES_PARSERS_,e,t)};ol.format.OWS.readConstraint_=function(e,t){
var o=e.getAttribute("name");return o?ol.xml.pushParseAndPop({name:o},ol.format.OWS.CONSTRAINT_PARSERS_,e,t):void 0};ol.format.OWS.readContactInfo_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.OWS.CONTACT_INFO_PARSERS_,e,t)};ol.format.OWS.readDcp_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.OWS.DCP_PARSERS_,e,t)};ol.format.OWS.readGet_=function(e,t){var o=ol.format.XLink.readHref(e);return o?ol.xml.pushParseAndPop({href:o},ol.format.OWS.REQUEST_METHOD_PARSERS_,e,t):void 0};ol.format.OWS.readHttp_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.OWS.HTTP_PARSERS_,e,t)};ol.format.OWS.readOperation_=function(e,t){var o=e.getAttribute("name"),r=ol.xml.pushParseAndPop({},ol.format.OWS.OPERATION_PARSERS_,e,t);if(!r)return void 0;var i=t[t.length-1];i[o]=r};ol.format.OWS.readOperationsMetadata_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.OWS.OPERATIONS_METADATA_PARSERS_,e,t)};ol.format.OWS.readPhone_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.OWS.PHONE_PARSERS_,e,t)};ol.format.OWS.readServiceIdentification_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.OWS.SERVICE_IDENTIFICATION_PARSERS_,e,t)};ol.format.OWS.readServiceContact_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.OWS.SERVICE_CONTACT_PARSERS_,e,t)};ol.format.OWS.readServiceProvider_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.OWS.SERVICE_PROVIDER_PARSERS_,e,t)};ol.format.OWS.readValue_=function(e,t){return ol.format.XSD.readString(e)};ol.format.OWS.NAMESPACE_URIS_=[null,"http://www.opengis.net/ows/1.1"];ol.format.OWS.PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{ServiceIdentification:ol.xml.makeObjectPropertySetter(ol.format.OWS.readServiceIdentification_),ServiceProvider:ol.xml.makeObjectPropertySetter(ol.format.OWS.readServiceProvider_),OperationsMetadata:ol.xml.makeObjectPropertySetter(ol.format.OWS.readOperationsMetadata_)});ol.format.OWS.ADDRESS_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{DeliveryPoint:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),City:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),AdministrativeArea:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),PostalCode:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Country:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ElectronicMailAddress:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)});ol.format.OWS.ALLOWED_VALUES_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{Value:ol.xml.makeObjectPropertyPusher(ol.format.OWS.readValue_)});ol.format.OWS.CONSTRAINT_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{AllowedValues:ol.xml.makeObjectPropertySetter(ol.format.OWS.readAllowedValues_)});ol.format.OWS.CONTACT_INFO_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{Phone:ol.xml.makeObjectPropertySetter(ol.format.OWS.readPhone_),Address:ol.xml.makeObjectPropertySetter(ol.format.OWS.readAddress_)});ol.format.OWS.DCP_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{HTTP:ol.xml.makeObjectPropertySetter(ol.format.OWS.readHttp_)});ol.format.OWS.HTTP_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{Get:ol.xml.makeObjectPropertyPusher(ol.format.OWS.readGet_),Post:void 0});ol.format.OWS.OPERATION_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{DCP:ol.xml.makeObjectPropertySetter(ol.format.OWS.readDcp_)});ol.format.OWS.OPERATIONS_METADATA_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{Operation:ol.format.OWS.readOperation_});ol.format.OWS.PHONE_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{Voice:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Facsimile:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)});ol.format.OWS.REQUEST_METHOD_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{Constraint:ol.xml.makeObjectPropertyPusher(ol.format.OWS.readConstraint_)});ol.format.OWS.SERVICE_CONTACT_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{IndividualName:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),PositionName:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ContactInfo:ol.xml.makeObjectPropertySetter(ol.format.OWS.readContactInfo_)});ol.format.OWS.SERVICE_IDENTIFICATION_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{Title:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ServiceTypeVersion:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ServiceType:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)});ol.format.OWS.SERVICE_PROVIDER_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{ProviderName:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ProviderSite:ol.xml.makeObjectPropertySetter(ol.format.XLink.readHref),ServiceContact:ol.xml.makeObjectPropertySetter(ol.format.OWS.readServiceContact_)});goog.provide("ol.geom.flat.flip");ol.geom.flat.flip.flipXY=function(e,t,o,r,i,n){var a,l;if(void 0!==i){a=i;l=void 0!==n?n:0}else{a=[];l=0}for(var s=t;o>s;){var p=e[s++];a[l++]=e[s++];a[l++]=p;for(var c=2;r>c;++c)a[l++]=e[s++]}a.length=l;return a};goog.provide("ol.format.Polyline");goog.require("ol");goog.require("ol.asserts");goog.require("ol.Feature");goog.require("ol.format.Feature");goog.require("ol.format.TextFeature");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.LineString");goog.require("ol.geom.SimpleGeometry");goog.require("ol.geom.flat.flip");goog.require("ol.geom.flat.inflate");goog.require("ol.proj");ol.format.Polyline=function(e){var t=e?e:{};ol.format.TextFeature.call(this);this.defaultDataProjection=ol.proj.get("EPSG:4326");this.factor_=t.factor?t.factor:1e5;this.geometryLayout_=t.geometryLayout?t.geometryLayout:ol.geom.GeometryLayout.XY};ol.inherits(ol.format.Polyline,ol.format.TextFeature);ol.format.Polyline.encodeDeltas=function(e,t,o){var r,i=o?o:1e5,n=new Array(t);for(r=0;t>r;++r)n[r]=0;var a,l;for(a=0,l=e.length;l>a;)for(r=0;t>r;++r,++a){var s=e[a],p=s-n[r];n[r]=s;e[a]=p}return ol.format.Polyline.encodeFloats(e,i)};ol.format.Polyline.decodeDeltas=function(e,t,o){var r,i=o?o:1e5,n=new Array(t);for(r=0;t>r;++r)n[r]=0;var a,l,s=ol.format.Polyline.decodeFloats(e,i);for(a=0,l=s.length;l>a;)for(r=0;t>r;++r,++a){n[r]+=s[a];s[a]=n[r]}return s};ol.format.Polyline.encodeFloats=function(e,t){var o,r,i=t?t:1e5;for(o=0,r=e.length;r>o;++o)e[o]=Math.round(e[o]*i);return ol.format.Polyline.encodeSignedIntegers(e)};ol.format.Polyline.decodeFloats=function(e,t){var o,r,i=t?t:1e5,n=ol.format.Polyline.decodeSignedIntegers(e);for(o=0,r=n.length;r>o;++o)n[o]/=i;return n};ol.format.Polyline.encodeSignedIntegers=function(e){var t,o;for(t=0,o=e.length;o>t;++t){var r=e[t];e[t]=0>r?~(r<<1):r<<1}return ol.format.Polyline.encodeUnsignedIntegers(e)};ol.format.Polyline.decodeSignedIntegers=function(e){var t,o,r=ol.format.Polyline.decodeUnsignedIntegers(e);for(t=0,o=r.length;o>t;++t){var i=r[t];r[t]=1&i?~(i>>1):i>>1}return r};ol.format.Polyline.encodeUnsignedIntegers=function(e){var t,o,r="";for(t=0,o=e.length;o>t;++t)r+=ol.format.Polyline.encodeUnsignedInteger(e[t]);return r};ol.format.Polyline.decodeUnsignedIntegers=function(e){var t,o,r=[],i=0,n=0;for(t=0,o=e.length;o>t;++t){var a=e.charCodeAt(t)-63;i|=(31&a)<<n;if(32>a){r.push(i);i=0;n=0}else n+=5}return r};ol.format.Polyline.encodeUnsignedInteger=function(e){for(var t,o="";e>=32;){t=(32|31&e)+63;o+=String.fromCharCode(t);e>>=5}t=e+63;o+=String.fromCharCode(t);return o};ol.format.Polyline.prototype.readFeature;ol.format.Polyline.prototype.readFeatureFromText=function(e,t){var o=this.readGeometryFromText(e,t);return new ol.Feature(o)};ol.format.Polyline.prototype.readFeatures;ol.format.Polyline.prototype.readFeaturesFromText=function(e,t){var o=this.readFeatureFromText(e,t);return[o]};ol.format.Polyline.prototype.readGeometry;ol.format.Polyline.prototype.readGeometryFromText=function(e,t){var o=ol.geom.SimpleGeometry.getStrideForLayout(this.geometryLayout_),r=ol.format.Polyline.decodeDeltas(e,o,this.factor_);ol.geom.flat.flip.flipXY(r,0,r.length,o,r);var i=ol.geom.flat.inflate.coordinates(r,0,r.length,o);return ol.format.Feature.transformWithOptions(new ol.geom.LineString(i,this.geometryLayout_),!1,this.adaptOptions(t))};ol.format.Polyline.prototype.readProjection;ol.format.Polyline.prototype.writeFeatureText=function(e,t){var o=e.getGeometry();if(o)return this.writeGeometryText(o,t);ol.asserts.assert(!1,40);return""};ol.format.Polyline.prototype.writeFeaturesText=function(e,t){return this.writeFeatureText(e[0],t)};ol.format.Polyline.prototype.writeGeometry;ol.format.Polyline.prototype.writeGeometryText=function(e,t){e=ol.format.Feature.transformWithOptions(e,!0,this.adaptOptions(t));var o=e.getFlatCoordinates(),r=e.getStride();ol.geom.flat.flip.flipXY(o,0,o.length,r,o);return ol.format.Polyline.encodeDeltas(o,r,this.factor_)};goog.provide("ol.format.TopoJSON");goog.require("ol");goog.require("ol.Feature");goog.require("ol.format.Feature");goog.require("ol.format.JSONFeature");goog.require("ol.geom.LineString");goog.require("ol.geom.MultiLineString");goog.require("ol.geom.MultiPoint");goog.require("ol.geom.MultiPolygon");goog.require("ol.geom.Point");goog.require("ol.geom.Polygon");goog.require("ol.obj");goog.require("ol.proj");ol.format.TopoJSON=function(e){var t=e?e:{};ol.format.JSONFeature.call(this);this.defaultDataProjection=ol.proj.get(t.defaultDataProjection?t.defaultDataProjection:"EPSG:4326")};ol.inherits(ol.format.TopoJSON,ol.format.JSONFeature);ol.format.TopoJSON.concatenateArcs_=function(e,t){var o,r,i,n,a,l,s=[];for(i=0,n=e.length;n>i;++i){o=e[i];i>0&&s.pop();r=o>=0?t[o]:t[~o].slice().reverse();s.push.apply(s,r)}for(a=0,l=s.length;l>a;++a)s[a]=s[a].slice();return s};ol.format.TopoJSON.readPointGeometry_=function(e,t,o){var r=e.coordinates;t&&o&&ol.format.TopoJSON.transformVertex_(r,t,o);return new ol.geom.Point(r)};ol.format.TopoJSON.readMultiPointGeometry_=function(e,t,o){var r,i,n=e.coordinates;if(t&&o)for(r=0,i=n.length;i>r;++r)ol.format.TopoJSON.transformVertex_(n[r],t,o);return new ol.geom.MultiPoint(n)};ol.format.TopoJSON.readLineStringGeometry_=function(e,t){var o=ol.format.TopoJSON.concatenateArcs_(e.arcs,t);return new ol.geom.LineString(o)};ol.format.TopoJSON.readMultiLineStringGeometry_=function(e,t){var o,r,i=[];for(o=0,r=e.arcs.length;r>o;++o)i[o]=ol.format.TopoJSON.concatenateArcs_(e.arcs[o],t);return new ol.geom.MultiLineString(i)};ol.format.TopoJSON.readPolygonGeometry_=function(e,t){var o,r,i=[];for(o=0,r=e.arcs.length;r>o;++o)i[o]=ol.format.TopoJSON.concatenateArcs_(e.arcs[o],t);return new ol.geom.Polygon(i)};ol.format.TopoJSON.readMultiPolygonGeometry_=function(e,t){var o,r,i,n,a,l,s=[];for(a=0,l=e.arcs.length;l>a;++a){o=e.arcs[a];r=[];for(i=0,n=o.length;n>i;++i)r[i]=ol.format.TopoJSON.concatenateArcs_(o[i],t);s[a]=r}return new ol.geom.MultiPolygon(s)};ol.format.TopoJSON.readFeaturesFromGeometryCollection_=function(e,t,o,r,i){var n,a,l=e.geometries,s=[];for(n=0,a=l.length;a>n;++n)s[n]=ol.format.TopoJSON.readFeatureFromGeometry_(l[n],t,o,r,i);return s};ol.format.TopoJSON.readFeatureFromGeometry_=function(e,t,o,r,i){var n,a=e.type,l=ol.format.TopoJSON.GEOMETRY_READERS_[a];n="Point"===a||"MultiPoint"===a?l(e,o,r):l(e,t);var s=new ol.Feature;s.setGeometry(ol.format.Feature.transformWithOptions(n,!1,i));void 0!==e.id&&s.setId(e.id);e.properties&&s.setProperties(e.properties);return s};ol.format.TopoJSON.prototype.readFeatures;ol.format.TopoJSON.prototype.readFeaturesFromObject=function(e,t){if("Topology"==e.type){var o,r=e,i=null,n=null;if(r.transform){o=r.transform;i=o.scale;n=o.translate}var a=r.arcs;o&&ol.format.TopoJSON.transformArcs_(a,i,n);var l,s,p,c=[],u=ol.obj.getValues(r.objects);for(l=0,s=u.length;s>l;++l)if("GeometryCollection"===u[l].type){p=u[l];c.push.apply(c,ol.format.TopoJSON.readFeaturesFromGeometryCollection_(p,a,i,n,t))}else{p=u[l];c.push(ol.format.TopoJSON.readFeatureFromGeometry_(p,a,i,n,t))}return c}return[]};ol.format.TopoJSON.transformArcs_=function(e,t,o){var r,i;for(r=0,i=e.length;i>r;++r)ol.format.TopoJSON.transformArc_(e[r],t,o)};ol.format.TopoJSON.transformArc_=function(e,t,o){var r,i,n,a=0,l=0;for(i=0,n=e.length;n>i;++i){r=e[i];a+=r[0];l+=r[1];r[0]=a;r[1]=l;ol.format.TopoJSON.transformVertex_(r,t,o)}};ol.format.TopoJSON.transformVertex_=function(e,t,o){e[0]=e[0]*t[0]+o[0];e[1]=e[1]*t[1]+o[1]};ol.format.TopoJSON.prototype.readProjection;ol.format.TopoJSON.prototype.readProjectionFromObject=function(e){return this.defaultDataProjection};ol.format.TopoJSON.GEOMETRY_READERS_={Point:ol.format.TopoJSON.readPointGeometry_,LineString:ol.format.TopoJSON.readLineStringGeometry_,Polygon:ol.format.TopoJSON.readPolygonGeometry_,MultiPoint:ol.format.TopoJSON.readMultiPointGeometry_,MultiLineString:ol.format.TopoJSON.readMultiLineStringGeometry_,MultiPolygon:ol.format.TopoJSON.readMultiPolygonGeometry_};ol.format.TopoJSON.prototype.writeFeatureObject=function(e,t){};ol.format.TopoJSON.prototype.writeFeaturesObject=function(e,t){};ol.format.TopoJSON.prototype.writeGeometryObject=function(e,t){};ol.format.TopoJSON.prototype.readGeometryFromObject=function(){};ol.format.TopoJSON.prototype.readFeatureFromObject=function(){};goog.provide("ol.format.WFS");goog.require("ol");goog.require("ol.asserts");goog.require("ol.format.GML2");goog.require("ol.format.GML3");goog.require("ol.format.GMLBase");goog.require("ol.format.filter");goog.require("ol.format.XMLFeature");goog.require("ol.format.XSD");goog.require("ol.geom.Geometry");goog.require("ol.obj");goog.require("ol.proj");goog.require("ol.xml");ol.format.WFS=function(e){var t=e?e:{};this.featureType_=t.featureType;this.featureNS_=t.featureNS;this.gmlFormat_=t.gmlFormat?t.gmlFormat:new ol.format.GML3;this.schemaLocation_=t.schemaLocation?t.schemaLocation:ol.format.WFS.SCHEMA_LOCATIONS[ol.format.WFS.DEFAULT_VERSION];ol.format.XMLFeature.call(this)};ol.inherits(ol.format.WFS,ol.format.XMLFeature);ol.format.WFS.FEATURE_PREFIX="feature";ol.format.WFS.XMLNS="http://www.w3.org/2000/xmlns/";ol.format.WFS.OGCNS="http://www.opengis.net/ogc";ol.format.WFS.WFSNS="http://www.opengis.net/wfs";ol.format.WFS.SCHEMA_LOCATIONS={"1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"};ol.format.WFS.DEFAULT_VERSION="1.1.0";ol.format.WFS.prototype.readFeatures;ol.format.WFS.prototype.readFeaturesFromNode=function(e,t){var o={featureType:this.featureType_,featureNS:this.featureNS_};ol.obj.assign(o,this.getReadOptions(e,t?t:{}));var r=[o];this.gmlFormat_.FEATURE_COLLECTION_PARSERS[ol.format.GMLBase.GMLNS].featureMember=ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.readFeaturesInternal);var i=ol.xml.pushParseAndPop([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,e,r,this.gmlFormat_);i||(i=[]);return i};ol.format.WFS.prototype.readTransactionResponse=function(e){if(ol.xml.isDocument(e))return this.readTransactionResponseFromDocument(e);if(ol.xml.isNode(e))return this.readTransactionResponseFromNode(e);if("string"==typeof e){var t=ol.xml.parse(e);return this.readTransactionResponseFromDocument(t)}return void 0};ol.format.WFS.prototype.readFeatureCollectionMetadata=function(e){if(ol.xml.isDocument(e))return this.readFeatureCollectionMetadataFromDocument(e);if(ol.xml.isNode(e))return this.readFeatureCollectionMetadataFromNode(e);if("string"==typeof e){var t=ol.xml.parse(e);return this.readFeatureCollectionMetadataFromDocument(t)}return void 0};ol.format.WFS.prototype.readFeatureCollectionMetadataFromDocument=function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(t);return void 0};ol.format.WFS.FEATURE_COLLECTION_PARSERS_={"http://www.opengis.net/gml":{boundedBy:ol.xml.makeObjectPropertySetter(ol.format.GMLBase.prototype.readGeometryElement,"bounds")}};ol.format.WFS.prototype.readFeatureCollectionMetadataFromNode=function(e){var t={},o=ol.format.XSD.readNonNegativeIntegerString(e.getAttribute("numberOfFeatures"));t.numberOfFeatures=o;return ol.xml.pushParseAndPop(t,ol.format.WFS.FEATURE_COLLECTION_PARSERS_,e,[],this.gmlFormat_)};ol.format.WFS.TRANSACTION_SUMMARY_PARSERS_={"http://www.opengis.net/wfs":{totalInserted:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),totalUpdated:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),totalDeleted:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger)}};ol.format.WFS.readTransactionSummary_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WFS.TRANSACTION_SUMMARY_PARSERS_,e,t)};ol.format.WFS.OGC_FID_PARSERS_={"http://www.opengis.net/ogc":{FeatureId:ol.xml.makeArrayPusher(function(e,t){return e.getAttribute("fid")})}};ol.format.WFS.fidParser_=function(e,t){ol.xml.parseNode(ol.format.WFS.OGC_FID_PARSERS_,e,t)};ol.format.WFS.INSERT_RESULTS_PARSERS_={"http://www.opengis.net/wfs":{Feature:ol.format.WFS.fidParser_}};ol.format.WFS.readInsertResults_=function(e,t){return ol.xml.pushParseAndPop([],ol.format.WFS.INSERT_RESULTS_PARSERS_,e,t)};ol.format.WFS.TRANSACTION_RESPONSE_PARSERS_={"http://www.opengis.net/wfs":{TransactionSummary:ol.xml.makeObjectPropertySetter(ol.format.WFS.readTransactionSummary_,"transactionSummary"),InsertResults:ol.xml.makeObjectPropertySetter(ol.format.WFS.readInsertResults_,"insertIds")}};ol.format.WFS.prototype.readTransactionResponseFromDocument=function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(t);return void 0};ol.format.WFS.prototype.readTransactionResponseFromNode=function(e){return ol.xml.pushParseAndPop({},ol.format.WFS.TRANSACTION_RESPONSE_PARSERS_,e,[])};ol.format.WFS.QUERY_SERIALIZERS_={"http://www.opengis.net/wfs":{PropertyName:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode)}};ol.format.WFS.writeFeature_=function(e,t,o){var r=o[o.length-1],i=r.featureType,n=r.featureNS,a=r.gmlVersion,l=ol.xml.createElementNS(n,i);e.appendChild(l);2===a?ol.format.GML2.prototype.writeFeatureElement(l,t,o):ol.format.GML3.prototype.writeFeatureElement(l,t,o)};ol.format.WFS.writeOgcFidFilter_=function(e,t,o){var r=ol.xml.createElementNS(ol.format.WFS.OGCNS,"Filter"),i=ol.xml.createElementNS(ol.format.WFS.OGCNS,"FeatureId");r.appendChild(i);i.setAttribute("fid",t);e.appendChild(r)};ol.format.WFS.writeDelete_=function(e,t,o){var r=o[o.length-1];ol.asserts.assert(void 0!==t.getId(),26);var i=r.featureType,n=r.featurePrefix;n=n?n:ol.format.WFS.FEATURE_PREFIX;var a=r.featureNS;e.setAttribute("typeName",n+":"+i);ol.xml.setAttributeNS(e,ol.format.WFS.XMLNS,"xmlns:"+n,a);var l=t.getId();void 0!==l&&ol.format.WFS.writeOgcFidFilter_(e,l,o)};ol.format.WFS.writeUpdate_=function(e,t,o){var r=o[o.length-1];ol.asserts.assert(void 0!==t.getId(),27);var i=r.featureType,n=r.featurePrefix;n=n?n:ol.format.WFS.FEATURE_PREFIX;var a=r.featureNS;e.setAttribute("typeName",n+":"+i);ol.xml.setAttributeNS(e,ol.format.WFS.XMLNS,"xmlns:"+n,a);var l=t.getId();if(void 0!==l){for(var s=t.getKeys(),p=[],c=0,u=s.length;u>c;c++){var g=t.get(s[c]);void 0!==g&&p.push({name:s[c],value:g})}ol.xml.pushSerializeAndPop({gmlVersion:r.gmlVersion,node:e,srsName:r.srsName},ol.format.WFS.TRANSACTION_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("Property"),p,o);ol.format.WFS.writeOgcFidFilter_(e,l,o)}};ol.format.WFS.writeProperty_=function(e,t,o){var r=ol.xml.createElementNS(ol.format.WFS.WFSNS,"Name"),i=o[o.length-1],n=i.gmlVersion;e.appendChild(r);ol.format.XSD.writeStringTextNode(r,t.name);if(void 0!==t.value&&null!==t.value){var a=ol.xml.createElementNS(ol.format.WFS.WFSNS,"Value");e.appendChild(a);t.value instanceof ol.geom.Geometry?2===n?ol.format.GML2.prototype.writeGeometryElement(a,t.value,o):ol.format.GML3.prototype.writeGeometryElement(a,t.value,o):ol.format.XSD.writeStringTextNode(a,t.value)}};ol.format.WFS.writeNative_=function(e,t,o){t.vendorId&&e.setAttribute("vendorId",t.vendorId);void 0!==t.safeToIgnore&&e.setAttribute("safeToIgnore",t.safeToIgnore);void 0!==t.value&&ol.format.XSD.writeStringTextNode(e,t.value)};ol.format.WFS.TRANSACTION_SERIALIZERS_={"http://www.opengis.net/wfs":{Insert:ol.xml.makeChildAppender(ol.format.WFS.writeFeature_),Update:ol.xml.makeChildAppender(ol.format.WFS.writeUpdate_),Delete:ol.xml.makeChildAppender(ol.format.WFS.writeDelete_),Property:ol.xml.makeChildAppender(ol.format.WFS.writeProperty_),Native:ol.xml.makeChildAppender(ol.format.WFS.writeNative_)}};ol.format.WFS.writeQuery_=function(e,t,o){var r=o[o.length-1],i=r.featurePrefix,n=r.featureNS,a=r.propertyNames,l=r.srsName,s=i?i+":":"";e.setAttribute("typeName",s+t);l&&e.setAttribute("srsName",l);n&&ol.xml.setAttributeNS(e,ol.format.WFS.XMLNS,"xmlns:"+i,n);var p=ol.obj.assign({},r);p.node=e;ol.xml.pushSerializeAndPop(p,ol.format.WFS.QUERY_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("PropertyName"),a,o);var c=r.filter;if(c){var u=ol.xml.createElementNS(ol.format.WFS.OGCNS,"Filter");e.appendChild(u);ol.format.WFS.writeFilterCondition_(u,c,o)}};ol.format.WFS.writeFilterCondition_=function(e,t,o){var r={node:e};ol.xml.pushSerializeAndPop(r,ol.format.WFS.GETFEATURE_SERIALIZERS_,ol.xml.makeSimpleNodeFactory(t.getTagName()),[t],o)};ol.format.WFS.writeBboxFilter_=function(e,t,o){var r=o[o.length-1];r.srsName=t.srsName;ol.format.WFS.writeOgcPropertyName_(e,t.geometryName);ol.format.GML3.prototype.writeGeometryElement(e,t.extent,o)};ol.format.WFS.writeIntersectsFilter_=function(e,t,o){var r=o[o.length-1];r.srsName=t.srsName;ol.format.WFS.writeOgcPropertyName_(e,t.geometryName);ol.format.GML3.prototype.writeGeometryElement(e,t.geometry,o)};ol.format.WFS.writeWithinFilter_=function(e,t,o){var r=o[o.length-1];r.srsName=t.srsName;ol.format.WFS.writeOgcPropertyName_(e,t.geometryName);ol.format.GML3.prototype.writeGeometryElement(e,t.geometry,o)};ol.format.WFS.writeLogicalFilter_=function(e,t,o){var r={node:e};t.conditions.forEach(function(e){ol.xml.pushSerializeAndPop(r,ol.format.WFS.GETFEATURE_SERIALIZERS_,ol.xml.makeSimpleNodeFactory(e.getTagName()),[e],o)})};ol.format.WFS.writeNotFilter_=function(e,t,o){var r={node:e},i=t.condition;ol.xml.pushSerializeAndPop(r,ol.format.WFS.GETFEATURE_SERIALIZERS_,ol.xml.makeSimpleNodeFactory(i.getTagName()),[i],o)};ol.format.WFS.writeComparisonFilter_=function(e,t,o){void 0!==t.matchCase&&e.setAttribute("matchCase",t.matchCase.toString());ol.format.WFS.writeOgcPropertyName_(e,t.propertyName);ol.format.WFS.writeOgcLiteral_(e,""+t.expression)};ol.format.WFS.writeIsNullFilter_=function(e,t,o){ol.format.WFS.writeOgcPropertyName_(e,t.propertyName)};ol.format.WFS.writeIsBetweenFilter_=function(e,t,o){ol.format.WFS.writeOgcPropertyName_(e,t.propertyName);var r=ol.xml.createElementNS(ol.format.WFS.OGCNS,"LowerBoundary");e.appendChild(r);ol.format.WFS.writeOgcLiteral_(r,""+t.lowerBoundary);var i=ol.xml.createElementNS(ol.format.WFS.OGCNS,"UpperBoundary");e.appendChild(i);ol.format.WFS.writeOgcLiteral_(i,""+t.upperBoundary)};ol.format.WFS.writeIsLikeFilter_=function(e,t,o){e.setAttribute("wildCard",t.wildCard);e.setAttribute("singleChar",t.singleChar);e.setAttribute("escapeChar",t.escapeChar);void 0!==t.matchCase&&e.setAttribute("matchCase",t.matchCase.toString());ol.format.WFS.writeOgcPropertyName_(e,t.propertyName);ol.format.WFS.writeOgcLiteral_(e,""+t.pattern)};ol.format.WFS.writeOgcExpression_=function(e,t,o){var r=ol.xml.createElementNS(ol.format.WFS.OGCNS,e);ol.format.XSD.writeStringTextNode(r,o);t.appendChild(r)};ol.format.WFS.writeOgcPropertyName_=function(e,t){ol.format.WFS.writeOgcExpression_("PropertyName",e,t)};ol.format.WFS.writeOgcLiteral_=function(e,t){ol.format.WFS.writeOgcExpression_("Literal",e,t)};ol.format.WFS.GETFEATURE_SERIALIZERS_={"http://www.opengis.net/wfs":{Query:ol.xml.makeChildAppender(ol.format.WFS.writeQuery_)},"http://www.opengis.net/ogc":{And:ol.xml.makeChildAppender(ol.format.WFS.writeLogicalFilter_),Or:ol.xml.makeChildAppender(ol.format.WFS.writeLogicalFilter_),Not:ol.xml.makeChildAppender(ol.format.WFS.writeNotFilter_),BBOX:ol.xml.makeChildAppender(ol.format.WFS.writeBboxFilter_),Intersects:ol.xml.makeChildAppender(ol.format.WFS.writeIntersectsFilter_),Within:ol.xml.makeChildAppender(ol.format.WFS.writeWithinFilter_),PropertyIsEqualTo:ol.xml.makeChildAppender(ol.format.WFS.writeComparisonFilter_),PropertyIsNotEqualTo:ol.xml.makeChildAppender(ol.format.WFS.writeComparisonFilter_),PropertyIsLessThan:ol.xml.makeChildAppender(ol.format.WFS.writeComparisonFilter_),PropertyIsLessThanOrEqualTo:ol.xml.makeChildAppender(ol.format.WFS.writeComparisonFilter_),PropertyIsGreaterThan:ol.xml.makeChildAppender(ol.format.WFS.writeComparisonFilter_),PropertyIsGreaterThanOrEqualTo:ol.xml.makeChildAppender(ol.format.WFS.writeComparisonFilter_),PropertyIsNull:ol.xml.makeChildAppender(ol.format.WFS.writeIsNullFilter_),PropertyIsBetween:ol.xml.makeChildAppender(ol.format.WFS.writeIsBetweenFilter_),PropertyIsLike:ol.xml.makeChildAppender(ol.format.WFS.writeIsLikeFilter_)}};ol.format.WFS.writeFilter=function(e){var t=ol.xml.createElementNS(ol.format.WFS.OGCNS,"Filter");ol.format.WFS.writeFilterCondition_(t,e,[]);return t};ol.format.WFS.writeGetFeature_=function(e,t,o){var r=o[o.length-1],i=ol.obj.assign({},r);i.node=e;ol.xml.pushSerializeAndPop(i,ol.format.WFS.GETFEATURE_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("Query"),t,o)};ol.format.WFS.prototype.writeGetFeature=function(e){var t=ol.xml.createElementNS(ol.format.WFS.WFSNS,"GetFeature");t.setAttribute("service","WFS");t.setAttribute("version","1.1.0");var o;if(e){e.handle&&t.setAttribute("handle",e.handle);e.outputFormat&&t.setAttribute("outputFormat",e.outputFormat);void 0!==e.maxFeatures&&t.setAttribute("maxFeatures",e.maxFeatures);e.resultType&&t.setAttribute("resultType",e.resultType);void 0!==e.startIndex&&t.setAttribute("startIndex",e.startIndex);void 0!==e.count&&t.setAttribute("count",e.count);o=e.filter;if(e.bbox){ol.asserts.assert(e.geometryName,12);var r=ol.format.filter.bbox(e.geometryName,e.bbox,e.srsName);o=o?ol.format.filter.and(o,r):r}}ol.xml.setAttributeNS(t,"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation",this.schemaLocation_);var i={node:t,srsName:e.srsName,featureNS:e.featureNS?e.featureNS:this.featureNS_,featurePrefix:e.featurePrefix,geometryName:e.geometryName,filter:o,propertyNames:e.propertyNames?e.propertyNames:[]};ol.asserts.assert(Array.isArray(e.featureTypes),11);ol.format.WFS.writeGetFeature_(t,e.featureTypes,[i]);return t};ol.format.WFS.prototype.writeTransaction=function(e,t,o,r){var i=[],n=ol.xml.createElementNS(ol.format.WFS.WFSNS,"Transaction"),a=r.version?r.version:ol.format.WFS.DEFAULT_VERSION,l="1.0.0"===a?2:3;n.setAttribute("service","WFS");n.setAttribute("version",a);var s,p;if(r){s=r.gmlOptions?r.gmlOptions:{};r.handle&&n.setAttribute("handle",r.handle)}var c=ol.format.WFS.SCHEMA_LOCATIONS[a];ol.xml.setAttributeNS(n,"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation",c);if(e){p={node:n,featureNS:r.featureNS,featureType:r.featureType,featurePrefix:r.featurePrefix,gmlVersion:l,srsName:r.srsName};ol.obj.assign(p,s);ol.xml.pushSerializeAndPop(p,ol.format.WFS.TRANSACTION_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("Insert"),e,i)}if(t){p={node:n,featureNS:r.featureNS,featureType:r.featureType,featurePrefix:r.featurePrefix,gmlVersion:l,srsName:r.srsName};ol.obj.assign(p,s);ol.xml.pushSerializeAndPop(p,ol.format.WFS.TRANSACTION_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("Update"),t,i)}o&&ol.xml.pushSerializeAndPop({node:n,featureNS:r.featureNS,featureType:r.featureType,featurePrefix:r.featurePrefix,gmlVersion:l,srsName:r.srsName},ol.format.WFS.TRANSACTION_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("Delete"),o,i);r.nativeElements&&ol.xml.pushSerializeAndPop({node:n,featureNS:r.featureNS,featureType:r.featureType,featurePrefix:r.featurePrefix,gmlVersion:l,srsName:r.srsName},ol.format.WFS.TRANSACTION_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("Native"),r.nativeElements,i);return n};ol.format.WFS.prototype.readProjection;ol.format.WFS.prototype.readProjectionFromDocument=function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(t);return null};ol.format.WFS.prototype.readProjectionFromNode=function(e){if(e.firstElementChild&&e.firstElementChild.firstElementChild){e=e.firstElementChild.firstElementChild;for(var t=e.firstElementChild;t;t=t.nextElementSibling)if(0!==t.childNodes.length&&(1!==t.childNodes.length||3!==t.firstChild.nodeType)){var o=[{}];this.gmlFormat_.readGeometryElement(t,o);return ol.proj.get(o.pop().srsName)}}return null};goog.provide("ol.format.WKT");goog.require("ol");goog.require("ol.Feature");goog.require("ol.format.Feature");goog.require("ol.format.TextFeature");goog.require("ol.geom.GeometryCollection");goog.require("ol.geom.GeometryType");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.LineString");goog.require("ol.geom.MultiLineString");goog.require("ol.geom.MultiPoint");goog.require("ol.geom.MultiPolygon");goog.require("ol.geom.Point");goog.require("ol.geom.Polygon");goog.require("ol.geom.SimpleGeometry");ol.format.WKT=function(e){var t=e?e:{};ol.format.TextFeature.call(this);this.splitCollection_=void 0!==t.splitCollection?t.splitCollection:!1};ol.inherits(ol.format.WKT,ol.format.TextFeature);ol.format.WKT.EMPTY="EMPTY";ol.format.WKT.Z="Z";ol.format.WKT.M="M";ol.format.WKT.ZM="ZM";ol.format.WKT.encodePointGeometry_=function(e){var t=e.getCoordinates();return 0===t.length?"":t.join(" ")};ol.format.WKT.encodeMultiPointGeometry_=function(e){for(var t=[],o=e.getPoints(),r=0,i=o.length;i>r;++r)t.push("("+ol.format.WKT.encodePointGeometry_(o[r])+")");return t.join(",")};ol.format.WKT.encodeGeometryCollectionGeometry_=function(e){for(var t=[],o=e.getGeometries(),r=0,i=o.length;i>r;++r)t.push(ol.format.WKT.encode_(o[r]));return t.join(",")};ol.format.WKT.encodeLineStringGeometry_=function(e){for(var t=e.getCoordinates(),o=[],r=0,i=t.length;i>r;++r)o.push(t[r].join(" "));return o.join(",")};ol.format.WKT.encodeMultiLineStringGeometry_=function(e){for(var t=[],o=e.getLineStrings(),r=0,i=o.length;i>r;++r)t.push("("+ol.format.WKT.encodeLineStringGeometry_(o[r])+")");return t.join(",")};ol.format.WKT.encodePolygonGeometry_=function(e){for(var t=[],o=e.getLinearRings(),r=0,i=o.length;i>r;++r)t.push("("+ol.format.WKT.encodeLineStringGeometry_(o[r])+")");return t.join(",")};ol.format.WKT.encodeMultiPolygonGeometry_=function(e){for(var t=[],o=e.getPolygons(),r=0,i=o.length;i>r;++r)t.push("("+ol.format.WKT.encodePolygonGeometry_(o[r])+")");return t.join(",")};ol.format.WKT.encodeGeometryLayout_=function(e){var t=e.getLayout(),o="";(t===ol.geom.GeometryLayout.XYZ||t===ol.geom.GeometryLayout.XYZM)&&(o+=ol.format.WKT.Z);(t===ol.geom.GeometryLayout.XYM||t===ol.geom.GeometryLayout.XYZM)&&(o+=ol.format.WKT.M);return o};ol.format.WKT.encode_=function(e){var t=e.getType(),o=ol.format.WKT.GeometryEncoder_[t],r=o(e);t=t.toUpperCase();if(e instanceof ol.geom.SimpleGeometry){var i=ol.format.WKT.encodeGeometryLayout_(e);i.length>0&&(t+=" "+i)}return 0===r.length?t+" "+ol.format.WKT.EMPTY:t+"("+r+")"};ol.format.WKT.GeometryEncoder_={Point:ol.format.WKT.encodePointGeometry_,LineString:ol.format.WKT.encodeLineStringGeometry_,Polygon:ol.format.WKT.encodePolygonGeometry_,MultiPoint:ol.format.WKT.encodeMultiPointGeometry_,MultiLineString:ol.format.WKT.encodeMultiLineStringGeometry_,MultiPolygon:ol.format.WKT.encodeMultiPolygonGeometry_,GeometryCollection:ol.format.WKT.encodeGeometryCollectionGeometry_};ol.format.WKT.prototype.parse_=function(e){var t=new ol.format.WKT.Lexer(e),o=new ol.format.WKT.Parser(t);return o.parse()};ol.format.WKT.prototype.readFeature;ol.format.WKT.prototype.readFeatureFromText=function(e,t){var o=this.readGeometryFromText(e,t);if(o){var r=new ol.Feature;r.setGeometry(o);return r}return null};ol.format.WKT.prototype.readFeatures;ol.format.WKT.prototype.readFeaturesFromText=function(e,t){var o=[],r=this.readGeometryFromText(e,t);o=this.splitCollection_&&r.getType()==ol.geom.GeometryType.GEOMETRY_COLLECTION?r.getGeometriesArray():[r];

for(var i,n=[],a=0,l=o.length;l>a;++a){i=new ol.Feature;i.setGeometry(o[a]);n.push(i)}return n};ol.format.WKT.prototype.readGeometry;ol.format.WKT.prototype.readGeometryFromText=function(e,t){var o=this.parse_(e);return o?ol.format.Feature.transformWithOptions(o,!1,t):null};ol.format.WKT.prototype.writeFeature;ol.format.WKT.prototype.writeFeatureText=function(e,t){var o=e.getGeometry();return o?this.writeGeometryText(o,t):""};ol.format.WKT.prototype.writeFeatures;ol.format.WKT.prototype.writeFeaturesText=function(e,t){if(1==e.length)return this.writeFeatureText(e[0],t);for(var o=[],r=0,i=e.length;i>r;++r)o.push(e[r].getGeometry());var n=new ol.geom.GeometryCollection(o);return this.writeGeometryText(n,t)};ol.format.WKT.prototype.writeGeometry;ol.format.WKT.prototype.writeGeometryText=function(e,t){return ol.format.WKT.encode_(ol.format.Feature.transformWithOptions(e,!0,t))};ol.format.WKT.TokenType_={TEXT:1,LEFT_PAREN:2,RIGHT_PAREN:3,NUMBER:4,COMMA:5,EOF:6};ol.format.WKT.Lexer=function(e){this.wkt=e;this.index_=-1};ol.format.WKT.Lexer.prototype.isAlpha_=function(e){return e>="a"&&"z">=e||e>="A"&&"Z">=e};ol.format.WKT.Lexer.prototype.isNumeric_=function(e,t){var o=void 0!==t?t:!1;return e>="0"&&"9">=e||"."==e&&!o};ol.format.WKT.Lexer.prototype.isWhiteSpace_=function(e){return" "==e||"	"==e||"\r"==e||"\n"==e};ol.format.WKT.Lexer.prototype.nextChar_=function(){return this.wkt.charAt(++this.index_)};ol.format.WKT.Lexer.prototype.nextToken=function(){var e=this.nextChar_(),t={position:this.index_,value:e};if("("==e)t.type=ol.format.WKT.TokenType_.LEFT_PAREN;else if(","==e)t.type=ol.format.WKT.TokenType_.COMMA;else if(")"==e)t.type=ol.format.WKT.TokenType_.RIGHT_PAREN;else if(this.isNumeric_(e)||"-"==e){t.type=ol.format.WKT.TokenType_.NUMBER;t.value=this.readNumber_()}else if(this.isAlpha_(e)){t.type=ol.format.WKT.TokenType_.TEXT;t.value=this.readText_()}else{if(this.isWhiteSpace_(e))return this.nextToken();if(""!==e)throw new Error("Unexpected character: "+e);t.type=ol.format.WKT.TokenType_.EOF}return t};ol.format.WKT.Lexer.prototype.readNumber_=function(){var e,t=this.index_,o=!1,r=!1;do{"."==e?o=!0:("e"==e||"E"==e)&&(r=!0);e=this.nextChar_()}while(this.isNumeric_(e,o)||!r&&("e"==e||"E"==e)||r&&("-"==e||"+"==e));return parseFloat(this.wkt.substring(t,this.index_--))};ol.format.WKT.Lexer.prototype.readText_=function(){var e,t=this.index_;do e=this.nextChar_();while(this.isAlpha_(e));return this.wkt.substring(t,this.index_--).toUpperCase()};ol.format.WKT.Parser=function(e){this.lexer_=e;this.token_;this.layout_=ol.geom.GeometryLayout.XY};ol.format.WKT.Parser.prototype.consume_=function(){this.token_=this.lexer_.nextToken()};ol.format.WKT.Parser.prototype.isTokenType=function(e){var t=this.token_.type==e;return t};ol.format.WKT.Parser.prototype.match=function(e){var t=this.isTokenType(e);t&&this.consume_();return t};ol.format.WKT.Parser.prototype.parse=function(){this.consume_();var e=this.parseGeometry_();return e};ol.format.WKT.Parser.prototype.parseGeometryLayout_=function(){var e=ol.geom.GeometryLayout.XY,t=this.token_;if(this.isTokenType(ol.format.WKT.TokenType_.TEXT)){var o=t.value;o===ol.format.WKT.Z?e=ol.geom.GeometryLayout.XYZ:o===ol.format.WKT.M?e=ol.geom.GeometryLayout.XYM:o===ol.format.WKT.ZM&&(e=ol.geom.GeometryLayout.XYZM);e!==ol.geom.GeometryLayout.XY&&this.consume_()}return e};ol.format.WKT.Parser.prototype.parseGeometry_=function(){var e=this.token_;if(this.match(ol.format.WKT.TokenType_.TEXT)){var t=e.value;this.layout_=this.parseGeometryLayout_();if(t==ol.geom.GeometryType.GEOMETRY_COLLECTION.toUpperCase()){var o=this.parseGeometryCollectionText_();return new ol.geom.GeometryCollection(o)}var r=ol.format.WKT.Parser.GeometryParser_[t],i=ol.format.WKT.Parser.GeometryConstructor_[t];if(!r||!i)throw new Error("Invalid geometry type: "+t);var n=r.call(this);return new i(n,this.layout_)}throw new Error(this.formatErrorMessage_())};ol.format.WKT.Parser.prototype.parseGeometryCollectionText_=function(){if(this.match(ol.format.WKT.TokenType_.LEFT_PAREN)){var e=[];do e.push(this.parseGeometry_());while(this.match(ol.format.WKT.TokenType_.COMMA));if(this.match(ol.format.WKT.TokenType_.RIGHT_PAREN))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())};ol.format.WKT.Parser.prototype.parsePointText_=function(){if(this.match(ol.format.WKT.TokenType_.LEFT_PAREN)){var e=this.parsePoint_();if(this.match(ol.format.WKT.TokenType_.RIGHT_PAREN))return e}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())};ol.format.WKT.Parser.prototype.parseLineStringText_=function(){if(this.match(ol.format.WKT.TokenType_.LEFT_PAREN)){var e=this.parsePointList_();if(this.match(ol.format.WKT.TokenType_.RIGHT_PAREN))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())};ol.format.WKT.Parser.prototype.parsePolygonText_=function(){if(this.match(ol.format.WKT.TokenType_.LEFT_PAREN)){var e=this.parseLineStringTextList_();if(this.match(ol.format.WKT.TokenType_.RIGHT_PAREN))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())};ol.format.WKT.Parser.prototype.parseMultiPointText_=function(){if(this.match(ol.format.WKT.TokenType_.LEFT_PAREN)){var e;e=this.token_.type==ol.format.WKT.TokenType_.LEFT_PAREN?this.parsePointTextList_():this.parsePointList_();if(this.match(ol.format.WKT.TokenType_.RIGHT_PAREN))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())};ol.format.WKT.Parser.prototype.parseMultiLineStringText_=function(){if(this.match(ol.format.WKT.TokenType_.LEFT_PAREN)){var e=this.parseLineStringTextList_();if(this.match(ol.format.WKT.TokenType_.RIGHT_PAREN))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())};ol.format.WKT.Parser.prototype.parseMultiPolygonText_=function(){if(this.match(ol.format.WKT.TokenType_.LEFT_PAREN)){var e=this.parsePolygonTextList_();if(this.match(ol.format.WKT.TokenType_.RIGHT_PAREN))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())};ol.format.WKT.Parser.prototype.parsePoint_=function(){for(var e=[],t=this.layout_.length,o=0;t>o;++o){var r=this.token_;if(!this.match(ol.format.WKT.TokenType_.NUMBER))break;e.push(r.value)}if(e.length==t)return e;throw new Error(this.formatErrorMessage_())};ol.format.WKT.Parser.prototype.parsePointList_=function(){for(var e=[this.parsePoint_()];this.match(ol.format.WKT.TokenType_.COMMA);)e.push(this.parsePoint_());return e};ol.format.WKT.Parser.prototype.parsePointTextList_=function(){for(var e=[this.parsePointText_()];this.match(ol.format.WKT.TokenType_.COMMA);)e.push(this.parsePointText_());return e};ol.format.WKT.Parser.prototype.parseLineStringTextList_=function(){for(var e=[this.parseLineStringText_()];this.match(ol.format.WKT.TokenType_.COMMA);)e.push(this.parseLineStringText_());return e};ol.format.WKT.Parser.prototype.parsePolygonTextList_=function(){for(var e=[this.parsePolygonText_()];this.match(ol.format.WKT.TokenType_.COMMA);)e.push(this.parsePolygonText_());return e};ol.format.WKT.Parser.prototype.isEmptyGeometry_=function(){var e=this.isTokenType(ol.format.WKT.TokenType_.TEXT)&&this.token_.value==ol.format.WKT.EMPTY;e&&this.consume_();return e};ol.format.WKT.Parser.prototype.formatErrorMessage_=function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"};ol.format.WKT.Parser.GeometryConstructor_={POINT:ol.geom.Point,LINESTRING:ol.geom.LineString,POLYGON:ol.geom.Polygon,MULTIPOINT:ol.geom.MultiPoint,MULTILINESTRING:ol.geom.MultiLineString,MULTIPOLYGON:ol.geom.MultiPolygon};ol.format.WKT.Parser.GeometryParser_={POINT:ol.format.WKT.Parser.prototype.parsePointText_,LINESTRING:ol.format.WKT.Parser.prototype.parseLineStringText_,POLYGON:ol.format.WKT.Parser.prototype.parsePolygonText_,MULTIPOINT:ol.format.WKT.Parser.prototype.parseMultiPointText_,MULTILINESTRING:ol.format.WKT.Parser.prototype.parseMultiLineStringText_,MULTIPOLYGON:ol.format.WKT.Parser.prototype.parseMultiPolygonText_};goog.provide("ol.format.WMSCapabilities");goog.require("ol");goog.require("ol.format.XLink");goog.require("ol.format.XML");goog.require("ol.format.XSD");goog.require("ol.xml");ol.format.WMSCapabilities=function(){ol.format.XML.call(this);this.version=void 0};ol.inherits(ol.format.WMSCapabilities,ol.format.XML);ol.format.WMSCapabilities.prototype.read;ol.format.WMSCapabilities.prototype.readFromDocument=function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFromNode(t);return null};ol.format.WMSCapabilities.prototype.readFromNode=function(e){this.version=e.getAttribute("version").trim();var t=ol.xml.pushParseAndPop({version:this.version},ol.format.WMSCapabilities.PARSERS_,e,[]);return t?t:null};ol.format.WMSCapabilities.readAttribution_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.ATTRIBUTION_PARSERS_,e,t)};ol.format.WMSCapabilities.readBoundingBox_=function(e,t){var o=[ol.format.XSD.readDecimalString(e.getAttribute("minx")),ol.format.XSD.readDecimalString(e.getAttribute("miny")),ol.format.XSD.readDecimalString(e.getAttribute("maxx")),ol.format.XSD.readDecimalString(e.getAttribute("maxy"))],r=[ol.format.XSD.readDecimalString(e.getAttribute("resx")),ol.format.XSD.readDecimalString(e.getAttribute("resy"))];return{crs:e.getAttribute("CRS"),extent:o,res:r}};ol.format.WMSCapabilities.readEXGeographicBoundingBox_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.EX_GEOGRAPHIC_BOUNDING_BOX_PARSERS_,e,t);if(!o)return void 0;var r=o.westBoundLongitude,i=o.southBoundLatitude,n=o.eastBoundLongitude,a=o.northBoundLatitude;return void 0===r||void 0===i||void 0===n||void 0===a?void 0:[r,i,n,a]};ol.format.WMSCapabilities.readCapability_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.CAPABILITY_PARSERS_,e,t)};ol.format.WMSCapabilities.readService_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.SERVICE_PARSERS_,e,t)};ol.format.WMSCapabilities.readContactInformation_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.CONTACT_INFORMATION_PARSERS_,e,t)};ol.format.WMSCapabilities.readContactPersonPrimary_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.CONTACT_PERSON_PARSERS_,e,t)};ol.format.WMSCapabilities.readContactAddress_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.CONTACT_ADDRESS_PARSERS_,e,t)};ol.format.WMSCapabilities.readException_=function(e,t){return ol.xml.pushParseAndPop([],ol.format.WMSCapabilities.EXCEPTION_PARSERS_,e,t)};ol.format.WMSCapabilities.readCapabilityLayer_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.LAYER_PARSERS_,e,t)};ol.format.WMSCapabilities.readLayer_=function(e,t){var o=t[t.length-1],r=ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.LAYER_PARSERS_,e,t);if(!r)return void 0;var i=ol.format.XSD.readBooleanString(e.getAttribute("queryable"));void 0===i&&(i=o.queryable);r.queryable=void 0!==i?i:!1;var n=ol.format.XSD.readNonNegativeIntegerString(e.getAttribute("cascaded"));void 0===n&&(n=o.cascaded);r.cascaded=n;var a=ol.format.XSD.readBooleanString(e.getAttribute("opaque"));void 0===a&&(a=o.opaque);r.opaque=void 0!==a?a:!1;var l=ol.format.XSD.readBooleanString(e.getAttribute("noSubsets"));void 0===l&&(l=o.noSubsets);r.noSubsets=void 0!==l?l:!1;var s=ol.format.XSD.readDecimalString(e.getAttribute("fixedWidth"));s||(s=o.fixedWidth);r.fixedWidth=s;var p=ol.format.XSD.readDecimalString(e.getAttribute("fixedHeight"));p||(p=o.fixedHeight);r.fixedHeight=p;var c=["Style","CRS","AuthorityURL"];c.forEach(function(e){if(e in o){var t=r[e]||[];r[e]=t.concat(o[e])}});var u=["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"];u.forEach(function(e){if(!(e in r)){var t=o[e];r[e]=t}});return r};ol.format.WMSCapabilities.readDimension_=function(e,t){var o={name:e.getAttribute("name"),units:e.getAttribute("units"),unitSymbol:e.getAttribute("unitSymbol"),"default":e.getAttribute("default"),multipleValues:ol.format.XSD.readBooleanString(e.getAttribute("multipleValues")),nearestValue:ol.format.XSD.readBooleanString(e.getAttribute("nearestValue")),current:ol.format.XSD.readBooleanString(e.getAttribute("current")),values:ol.format.XSD.readString(e)};return o};ol.format.WMSCapabilities.readFormatOnlineresource_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.FORMAT_ONLINERESOURCE_PARSERS_,e,t)};ol.format.WMSCapabilities.readRequest_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.REQUEST_PARSERS_,e,t)};ol.format.WMSCapabilities.readDCPType_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.DCPTYPE_PARSERS_,e,t)};ol.format.WMSCapabilities.readHTTP_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.HTTP_PARSERS_,e,t)};ol.format.WMSCapabilities.readOperationType_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.OPERATIONTYPE_PARSERS_,e,t)};ol.format.WMSCapabilities.readSizedFormatOnlineresource_=function(e,t){var o=ol.format.WMSCapabilities.readFormatOnlineresource_(e,t);if(o){var r=[ol.format.XSD.readNonNegativeIntegerString(e.getAttribute("width")),ol.format.XSD.readNonNegativeIntegerString(e.getAttribute("height"))];o.size=r;return o}return void 0};ol.format.WMSCapabilities.readAuthorityURL_=function(e,t){var o=ol.format.WMSCapabilities.readFormatOnlineresource_(e,t);if(o){o.name=e.getAttribute("name");return o}return void 0};ol.format.WMSCapabilities.readMetadataURL_=function(e,t){var o=ol.format.WMSCapabilities.readFormatOnlineresource_(e,t);if(o){o.type=e.getAttribute("type");return o}return void 0};ol.format.WMSCapabilities.readStyle_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.STYLE_PARSERS_,e,t)};ol.format.WMSCapabilities.readKeywordList_=function(e,t){return ol.xml.pushParseAndPop([],ol.format.WMSCapabilities.KEYWORDLIST_PARSERS_,e,t)};ol.format.WMSCapabilities.NAMESPACE_URIS_=[null,"http://www.opengis.net/wms"];ol.format.WMSCapabilities.PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Service:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readService_),Capability:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readCapability_)});ol.format.WMSCapabilities.CAPABILITY_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Request:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readRequest_),Exception:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readException_),Layer:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readCapabilityLayer_)});ol.format.WMSCapabilities.SERVICE_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Name:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Title:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Abstract:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),KeywordList:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readKeywordList_),OnlineResource:ol.xml.makeObjectPropertySetter(ol.format.XLink.readHref),ContactInformation:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readContactInformation_),Fees:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),AccessConstraints:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),LayerLimit:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),MaxWidth:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),MaxHeight:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger)});ol.format.WMSCapabilities.CONTACT_INFORMATION_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{ContactPersonPrimary:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readContactPersonPrimary_),ContactPosition:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ContactAddress:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readContactAddress_),ContactVoiceTelephone:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ContactFacsimileTelephone:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ContactElectronicMailAddress:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)});ol.format.WMSCapabilities.CONTACT_PERSON_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{ContactPerson:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ContactOrganization:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)});ol.format.WMSCapabilities.CONTACT_ADDRESS_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{AddressType:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Address:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),City:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),StateOrProvince:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),PostCode:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Country:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)});ol.format.WMSCapabilities.EXCEPTION_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Format:ol.xml.makeArrayPusher(ol.format.XSD.readString)});ol.format.WMSCapabilities.LAYER_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Name:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Title:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Abstract:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),KeywordList:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readKeywordList_),CRS:ol.xml.makeObjectPropertyPusher(ol.format.XSD.readString),EX_GeographicBoundingBox:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readEXGeographicBoundingBox_),BoundingBox:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readBoundingBox_),Dimension:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readDimension_),Attribution:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readAttribution_),AuthorityURL:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readAuthorityURL_),Identifier:ol.xml.makeObjectPropertyPusher(ol.format.XSD.readString),MetadataURL:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readMetadataURL_),DataURL:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readFormatOnlineresource_),FeatureListURL:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readFormatOnlineresource_),Style:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readStyle_),MinScaleDenominator:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),MaxScaleDenominator:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),Layer:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readLayer_)});ol.format.WMSCapabilities.ATTRIBUTION_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Title:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),OnlineResource:ol.xml.makeObjectPropertySetter(ol.format.XLink.readHref),LogoURL:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readSizedFormatOnlineresource_)});ol.format.WMSCapabilities.EX_GEOGRAPHIC_BOUNDING_BOX_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{westBoundLongitude:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),eastBoundLongitude:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),southBoundLatitude:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),northBoundLatitude:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal)});ol.format.WMSCapabilities.REQUEST_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{GetCapabilities:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readOperationType_),GetMap:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readOperationType_),GetFeatureInfo:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readOperationType_)});ol.format.WMSCapabilities.OPERATIONTYPE_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Format:ol.xml.makeObjectPropertyPusher(ol.format.XSD.readString),DCPType:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readDCPType_)});ol.format.WMSCapabilities.DCPTYPE_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{HTTP:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readHTTP_)});ol.format.WMSCapabilities.HTTP_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Get:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readFormatOnlineresource_),Post:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readFormatOnlineresource_)});ol.format.WMSCapabilities.STYLE_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Name:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Title:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Abstract:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),LegendURL:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readSizedFormatOnlineresource_),StyleSheetURL:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readFormatOnlineresource_),StyleURL:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readFormatOnlineresource_)});ol.format.WMSCapabilities.FORMAT_ONLINERESOURCE_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Format:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),OnlineResource:ol.xml.makeObjectPropertySetter(ol.format.XLink.readHref)});ol.format.WMSCapabilities.KEYWORDLIST_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Keyword:ol.xml.makeArrayPusher(ol.format.XSD.readString)});goog.provide("ol.format.WMSGetFeatureInfo");goog.require("ol");goog.require("ol.array");goog.require("ol.format.GML2");goog.require("ol.format.XMLFeature");goog.require("ol.obj");goog.require("ol.xml");ol.format.WMSGetFeatureInfo=function(e){var t=e?e:{};this.featureNS_="http://mapserver.gis.umn.edu/mapserver";this.gmlFormat_=new ol.format.GML2;this.layers_=t.layers?t.layers:null;ol.format.XMLFeature.call(this)};ol.inherits(ol.format.WMSGetFeatureInfo,ol.format.XMLFeature);ol.format.WMSGetFeatureInfo.featureIdentifier_="_feature";ol.format.WMSGetFeatureInfo.layerIdentifier_="_layer";ol.format.WMSGetFeatureInfo.prototype.readFeatures_=function(e,t){e.setAttribute("namespaceURI",this.featureNS_);var o=e.localName,r=[];if(0===e.childNodes.length)return r;if("msGMLOutput"==o)for(var i=0,n=e.childNodes.length;n>i;i++){var a=e.childNodes[i];if(a.nodeType===Node.ELEMENT_NODE){var l=t[0],s=ol.format.WMSGetFeatureInfo.layerIdentifier_,p=a.localName.replace(s,"");if(!this.layers_||ol.array.includes(this.layers_,p)){var c=p+ol.format.WMSGetFeatureInfo.featureIdentifier_;l.featureType=c;l.featureNS=this.featureNS_;var u={};u[c]=ol.xml.makeArrayPusher(this.gmlFormat_.readFeatureElement,this.gmlFormat_);var g=ol.xml.makeStructureNS([l.featureNS,null],u);a.setAttribute("namespaceURI",this.featureNS_);var d=ol.xml.pushParseAndPop([],g,a,t,this.gmlFormat_);d&&ol.array.extend(r,d)}}}if("FeatureCollection"==o){var h=ol.xml.pushParseAndPop([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,e,[{}],this.gmlFormat_);h&&(r=h)}return r};ol.format.WMSGetFeatureInfo.prototype.readFeatures;ol.format.WMSGetFeatureInfo.prototype.readFeaturesFromNode=function(e,t){var o={};t&&ol.obj.assign(o,this.getReadOptions(e,t));return this.readFeatures_(e,[o])};ol.format.WMSGetFeatureInfo.prototype.writeFeatureNode=function(e,t){};ol.format.WMSGetFeatureInfo.prototype.writeFeaturesNode=function(e,t){};ol.format.WMSGetFeatureInfo.prototype.writeGeometryNode=function(e,t){};goog.provide("ol.format.WMTSCapabilities");goog.require("ol");goog.require("ol.extent");goog.require("ol.format.OWS");goog.require("ol.format.XLink");goog.require("ol.format.XML");goog.require("ol.format.XSD");goog.require("ol.xml");ol.format.WMTSCapabilities=function(){ol.format.XML.call(this);this.owsParser_=new ol.format.OWS};ol.inherits(ol.format.WMTSCapabilities,ol.format.XML);ol.format.WMTSCapabilities.prototype.read;ol.format.WMTSCapabilities.prototype.readFromDocument=function(e){for(var t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFromNode(t);return null};ol.format.WMTSCapabilities.prototype.readFromNode=function(e){var t=e.getAttribute("version").trim(),o=this.owsParser_.readFromNode(e);if(!o)return null;o.version=t;o=ol.xml.pushParseAndPop(o,ol.format.WMTSCapabilities.PARSERS_,e,[]);return o?o:null};ol.format.WMTSCapabilities.readContents_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMTSCapabilities.CONTENTS_PARSERS_,e,t)};ol.format.WMTSCapabilities.readLayer_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMTSCapabilities.LAYER_PARSERS_,e,t)};ol.format.WMTSCapabilities.readTileMatrixSet_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMTSCapabilities.TMS_PARSERS_,e,t)};ol.format.WMTSCapabilities.readStyle_=function(e,t){var o=ol.xml.pushParseAndPop({},ol.format.WMTSCapabilities.STYLE_PARSERS_,e,t);if(!o)return void 0;var r="true"===e.getAttribute("isDefault");o.isDefault=r;return o};ol.format.WMTSCapabilities.readTileMatrixSetLink_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMTSCapabilities.TMS_LINKS_PARSERS_,e,t)};ol.format.WMTSCapabilities.readDimensions_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMTSCapabilities.DIMENSION_PARSERS_,e,t)};ol.format.WMTSCapabilities.readResourceUrl_=function(e,t){var o=e.getAttribute("format"),r=e.getAttribute("template"),i=e.getAttribute("resourceType"),n={};o&&(n.format=o);r&&(n.template=r);i&&(n.resourceType=i);return n};ol.format.WMTSCapabilities.readWgs84BoundingBox_=function(e,t){var o=ol.xml.pushParseAndPop([],ol.format.WMTSCapabilities.WGS84_BBOX_READERS_,e,t);return 2!=o.length?void 0:ol.extent.boundingExtent(o)};ol.format.WMTSCapabilities.readLegendUrl_=function(e,t){var o={};o.format=e.getAttribute("format");o.href=ol.format.XLink.readHref(e);return o};ol.format.WMTSCapabilities.readCoordinates_=function(e,t){var o=ol.format.XSD.readString(e).split(" ");if(!o||2!=o.length)return void 0;var r=+o[0],i=+o[1];return isNaN(r)||isNaN(i)?void 0:[r,i]};ol.format.WMTSCapabilities.readTileMatrix_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMTSCapabilities.TM_PARSERS_,e,t)};ol.format.WMTSCapabilities.readTileMatrixLimitsList_=function(e,t){return ol.xml.pushParseAndPop([],ol.format.WMTSCapabilities.TMS_LIMITS_LIST_PARSERS_,e,t)};ol.format.WMTSCapabilities.readTileMatrixLimits_=function(e,t){return ol.xml.pushParseAndPop({},ol.format.WMTSCapabilities.TMS_LIMITS_PARSERS_,e,t)};ol.format.WMTSCapabilities.NAMESPACE_URIS_=[null,"http://www.opengis.net/wmts/1.0"];ol.format.WMTSCapabilities.OWS_NAMESPACE_URIS_=[null,"http://www.opengis.net/ows/1.1"];ol.format.WMTSCapabilities.PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{Contents:ol.xml.makeObjectPropertySetter(ol.format.WMTSCapabilities.readContents_)});ol.format.WMTSCapabilities.CONTENTS_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{Layer:ol.xml.makeObjectPropertyPusher(ol.format.WMTSCapabilities.readLayer_),TileMatrixSet:ol.xml.makeObjectPropertyPusher(ol.format.WMTSCapabilities.readTileMatrixSet_)});ol.format.WMTSCapabilities.LAYER_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{Style:ol.xml.makeObjectPropertyPusher(ol.format.WMTSCapabilities.readStyle_),Format:ol.xml.makeObjectPropertyPusher(ol.format.XSD.readString),TileMatrixSetLink:ol.xml.makeObjectPropertyPusher(ol.format.WMTSCapabilities.readTileMatrixSetLink_),Dimension:ol.xml.makeObjectPropertyPusher(ol.format.WMTSCapabilities.readDimensions_),ResourceURL:ol.xml.makeObjectPropertyPusher(ol.format.WMTSCapabilities.readResourceUrl_)},ol.xml.makeStructureNS(ol.format.WMTSCapabilities.OWS_NAMESPACE_URIS_,{Title:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Abstract:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),WGS84BoundingBox:ol.xml.makeObjectPropertySetter(ol.format.WMTSCapabilities.readWgs84BoundingBox_),Identifier:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)}));ol.format.WMTSCapabilities.STYLE_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{LegendURL:ol.xml.makeObjectPropertyPusher(ol.format.WMTSCapabilities.readLegendUrl_)},ol.xml.makeStructureNS(ol.format.WMTSCapabilities.OWS_NAMESPACE_URIS_,{Title:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Identifier:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)}));ol.format.WMTSCapabilities.TMS_LINKS_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{TileMatrixSet:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),TileMatrixSetLimits:ol.xml.makeObjectPropertySetter(ol.format.WMTSCapabilities.readTileMatrixLimitsList_)});ol.format.WMTSCapabilities.TMS_LIMITS_LIST_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{TileMatrixLimits:ol.xml.makeArrayPusher(ol.format.WMTSCapabilities.readTileMatrixLimits_)});ol.format.WMTSCapabilities.TMS_LIMITS_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{TileMatrix:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),MinTileRow:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),MaxTileRow:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),MinTileCol:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),MaxTileCol:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger)});ol.format.WMTSCapabilities.DIMENSION_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{Default:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Value:ol.xml.makeObjectPropertyPusher(ol.format.XSD.readString)},ol.xml.makeStructureNS(ol.format.WMTSCapabilities.OWS_NAMESPACE_URIS_,{Identifier:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)}));ol.format.WMTSCapabilities.WGS84_BBOX_READERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.OWS_NAMESPACE_URIS_,{LowerCorner:ol.xml.makeArrayPusher(ol.format.WMTSCapabilities.readCoordinates_),UpperCorner:ol.xml.makeArrayPusher(ol.format.WMTSCapabilities.readCoordinates_)});ol.format.WMTSCapabilities.TMS_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{WellKnownScaleSet:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),TileMatrix:ol.xml.makeObjectPropertyPusher(ol.format.WMTSCapabilities.readTileMatrix_)},ol.xml.makeStructureNS(ol.format.WMTSCapabilities.OWS_NAMESPACE_URIS_,{SupportedCRS:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Identifier:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)}));ol.format.WMTSCapabilities.TM_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{TopLeftCorner:ol.xml.makeObjectPropertySetter(ol.format.WMTSCapabilities.readCoordinates_),ScaleDenominator:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),TileWidth:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),TileHeight:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),MatrixWidth:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),MatrixHeight:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger)},ol.xml.makeStructureNS(ol.format.WMTSCapabilities.OWS_NAMESPACE_URIS_,{Identifier:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)}));goog.provide("ol.GeolocationProperty");ol.GeolocationProperty={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"};goog.provide("ol.Geolocation");

goog.require("ol");goog.require("ol.Object");goog.require("ol.GeolocationProperty");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.geom.Polygon");goog.require("ol.has");goog.require("ol.math");goog.require("ol.proj");goog.require("ol.sphere.WGS84");ol.Geolocation=function(e){ol.Object.call(this);var t=e||{};this.position_=null;this.transform_=ol.proj.identityTransform;this.watchId_=void 0;ol.events.listen(this,ol.Object.getChangeEventType(ol.GeolocationProperty.PROJECTION),this.handleProjectionChanged_,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.GeolocationProperty.TRACKING),this.handleTrackingChanged_,this);void 0!==t.projection&&this.setProjection(ol.proj.get(t.projection));void 0!==t.trackingOptions&&this.setTrackingOptions(t.trackingOptions);this.setTracking(void 0!==t.tracking?t.tracking:!1)};ol.inherits(ol.Geolocation,ol.Object);ol.Geolocation.prototype.disposeInternal=function(){this.setTracking(!1);ol.Object.prototype.disposeInternal.call(this)};ol.Geolocation.prototype.handleProjectionChanged_=function(){var e=this.getProjection();if(e){this.transform_=ol.proj.getTransformFromProjections(ol.proj.get("EPSG:4326"),e);this.position_&&this.set(ol.GeolocationProperty.POSITION,this.transform_(this.position_))}};ol.Geolocation.prototype.handleTrackingChanged_=function(){if(ol.has.GEOLOCATION){var e=this.getTracking();if(e&&void 0===this.watchId_)this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions());else if(!e&&void 0!==this.watchId_){navigator.geolocation.clearWatch(this.watchId_);this.watchId_=void 0}}};ol.Geolocation.prototype.positionChange_=function(e){var t=e.coords;this.set(ol.GeolocationProperty.ACCURACY,t.accuracy);this.set(ol.GeolocationProperty.ALTITUDE,null===t.altitude?void 0:t.altitude);this.set(ol.GeolocationProperty.ALTITUDE_ACCURACY,null===t.altitudeAccuracy?void 0:t.altitudeAccuracy);this.set(ol.GeolocationProperty.HEADING,null===t.heading?void 0:ol.math.toRadians(t.heading));if(this.position_){this.position_[0]=t.longitude;this.position_[1]=t.latitude}else this.position_=[t.longitude,t.latitude];var o=this.transform_(this.position_);this.set(ol.GeolocationProperty.POSITION,o);this.set(ol.GeolocationProperty.SPEED,null===t.speed?void 0:t.speed);var r=ol.geom.Polygon.circular(ol.sphere.WGS84,this.position_,t.accuracy);r.applyTransform(this.transform_);this.set(ol.GeolocationProperty.ACCURACY_GEOMETRY,r);this.changed()};ol.Geolocation.prototype.positionError_=function(e){e.type=ol.events.EventType.ERROR;this.setTracking(!1);this.dispatchEvent(e)};ol.Geolocation.prototype.getAccuracy=function(){return this.get(ol.GeolocationProperty.ACCURACY)};ol.Geolocation.prototype.getAccuracyGeometry=function(){return this.get(ol.GeolocationProperty.ACCURACY_GEOMETRY)||null};ol.Geolocation.prototype.getAltitude=function(){return this.get(ol.GeolocationProperty.ALTITUDE)};ol.Geolocation.prototype.getAltitudeAccuracy=function(){return this.get(ol.GeolocationProperty.ALTITUDE_ACCURACY)};ol.Geolocation.prototype.getHeading=function(){return this.get(ol.GeolocationProperty.HEADING)};ol.Geolocation.prototype.getPosition=function(){return this.get(ol.GeolocationProperty.POSITION)};ol.Geolocation.prototype.getProjection=function(){return this.get(ol.GeolocationProperty.PROJECTION)};ol.Geolocation.prototype.getSpeed=function(){return this.get(ol.GeolocationProperty.SPEED)};ol.Geolocation.prototype.getTracking=function(){return this.get(ol.GeolocationProperty.TRACKING)};ol.Geolocation.prototype.getTrackingOptions=function(){return this.get(ol.GeolocationProperty.TRACKING_OPTIONS)};ol.Geolocation.prototype.setProjection=function(e){this.set(ol.GeolocationProperty.PROJECTION,e)};ol.Geolocation.prototype.setTracking=function(e){this.set(ol.GeolocationProperty.TRACKING,e)};ol.Geolocation.prototype.setTrackingOptions=function(e){this.set(ol.GeolocationProperty.TRACKING_OPTIONS,e)};goog.provide("ol.geom.Circle");goog.require("ol");goog.require("ol.extent");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.GeometryType");goog.require("ol.geom.SimpleGeometry");goog.require("ol.geom.flat.deflate");ol.geom.Circle=function(e,t,o){ol.geom.SimpleGeometry.call(this);var r=t?t:0;this.setCenterAndRadius(e,r,o)};ol.inherits(ol.geom.Circle,ol.geom.SimpleGeometry);ol.geom.Circle.prototype.clone=function(){var e=new ol.geom.Circle(null);e.setFlatCoordinates(this.layout,this.flatCoordinates.slice());return e};ol.geom.Circle.prototype.closestPointXY=function(e,t,o,r){var i=this.flatCoordinates,n=e-i[0],a=t-i[1],l=n*n+a*a;if(r>l){var s;if(0===l)for(s=0;s<this.stride;++s)o[s]=i[s];else{var p=this.getRadius()/Math.sqrt(l);o[0]=i[0]+p*n;o[1]=i[1]+p*a;for(s=2;s<this.stride;++s)o[s]=i[s]}o.length=this.stride;return l}return r};ol.geom.Circle.prototype.containsXY=function(e,t){var o=this.flatCoordinates,r=e-o[0],i=t-o[1];return r*r+i*i<=this.getRadiusSquared_()};ol.geom.Circle.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)};ol.geom.Circle.prototype.computeExtent=function(e){var t=this.flatCoordinates,o=t[this.stride]-t[0];return ol.extent.createOrUpdate(t[0]-o,t[1]-o,t[0]+o,t[1]+o,e)};ol.geom.Circle.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())};ol.geom.Circle.prototype.getRadiusSquared_=function(){var e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t};ol.geom.Circle.prototype.getType=function(){return ol.geom.GeometryType.CIRCLE};ol.geom.Circle.prototype.intersectsExtent=function(e){var t=this.getExtent();if(ol.extent.intersects(e,t)){var o=this.getCenter();return e[0]<=o[0]&&e[2]>=o[0]?!0:e[1]<=o[1]&&e[3]>=o[1]?!0:ol.extent.forEachCorner(e,this.intersectsCoordinate,this)}return!1};ol.geom.Circle.prototype.setCenter=function(e){var t=this.stride,o=this.flatCoordinates[t]-this.flatCoordinates[0],r=e.slice();r[t]=r[0]+o;var i;for(i=1;t>i;++i)r[t+i]=e[i];this.setFlatCoordinates(this.layout,r)};ol.geom.Circle.prototype.setCenterAndRadius=function(e,t,o){if(e){this.setLayout(o,e,0);this.flatCoordinates||(this.flatCoordinates=[]);var r=this.flatCoordinates,i=ol.geom.flat.deflate.coordinate(r,0,e,this.stride);r[i++]=r[0]+t;var n,a;for(n=1,a=this.stride;a>n;++n)r[i++]=r[n];r.length=i;this.changed()}else this.setFlatCoordinates(ol.geom.GeometryLayout.XY,null)};ol.geom.Circle.prototype.getCoordinates=function(){};ol.geom.Circle.prototype.setCoordinates=function(e,t){};ol.geom.Circle.prototype.setFlatCoordinates=function(e,t){this.setFlatCoordinatesInternal(e,t);this.changed()};ol.geom.Circle.prototype.setRadius=function(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e;this.changed()};ol.geom.Circle.prototype.transform;goog.provide("ol.geom.flat.geodesic");goog.require("ol.math");goog.require("ol.proj");ol.geom.flat.geodesic.line_=function(e,t,o){for(var r,i,n,a,l,s,p=[],c=e(0),u=e(1),g=t(c),d=t(u),h=[u,c],f=[d,g],y=[1,0],m={},v=1e5;--v>0&&y.length>0;){n=y.pop();c=h.pop();g=f.pop();s=n.toString();if(!(s in m)){p.push(g[0],g[1]);m[s]=!0}a=y.pop();u=h.pop();d=f.pop();l=(n+a)/2;r=e(l);i=t(r);if(ol.math.squaredSegmentDistance(i[0],i[1],g[0],g[1],d[0],d[1])<o){p.push(d[0],d[1]);s=a.toString();m[s]=!0}else{y.push(a,l,l,n);f.push(d,i,i,g);h.push(u,r,r,c)}}return p};ol.geom.flat.geodesic.greatCircleArc=function(e,t,o,r,i,n){var a=ol.proj.get("EPSG:4326"),l=Math.cos(ol.math.toRadians(t)),s=Math.sin(ol.math.toRadians(t)),p=Math.cos(ol.math.toRadians(r)),c=Math.sin(ol.math.toRadians(r)),u=Math.cos(ol.math.toRadians(o-e)),g=Math.sin(ol.math.toRadians(o-e)),d=s*c+l*p*u;return ol.geom.flat.geodesic.line_(function(t){if(d>=1)return[o,r];var i=t*Math.acos(d),n=Math.cos(i),a=Math.sin(i),h=g*p,f=l*c-s*p*u,y=Math.atan2(h,f),m=Math.asin(s*n+l*a*Math.cos(y)),v=ol.math.toRadians(e)+Math.atan2(Math.sin(y)*a*l,n-s*Math.sin(m));return[ol.math.toDegrees(v),ol.math.toDegrees(m)]},ol.proj.getTransform(a,i),n)};ol.geom.flat.geodesic.meridian=function(e,t,o,r,i){var n=ol.proj.get("EPSG:4326");return ol.geom.flat.geodesic.line_(function(r){return[e,t+(o-t)*r]},ol.proj.getTransform(n,r),i)};ol.geom.flat.geodesic.parallel=function(e,t,o,r,i){var n=ol.proj.get("EPSG:4326");return ol.geom.flat.geodesic.line_(function(r){return[t+(o-t)*r,e]},ol.proj.getTransform(n,r),i)};goog.provide("ol.Graticule");goog.require("ol.extent");goog.require("ol.geom.GeometryLayout");goog.require("ol.geom.LineString");goog.require("ol.geom.flat.geodesic");goog.require("ol.math");goog.require("ol.proj");goog.require("ol.render.EventType");goog.require("ol.style.Stroke");ol.Graticule=function(e){var t=e||{};this.map_=null;this.projection_=null;this.maxLat_=1/0;this.maxLon_=1/0;this.minLat_=-(1/0);this.minLon_=-(1/0);this.maxLatP_=1/0;this.maxLonP_=1/0;this.minLatP_=-(1/0);this.minLonP_=-(1/0);this.targetSize_=void 0!==t.targetSize?t.targetSize:100;this.maxLines_=void 0!==t.maxLines?t.maxLines:100;this.meridians_=[];this.parallels_=[];this.strokeStyle_=void 0!==t.strokeStyle?t.strokeStyle:ol.Graticule.DEFAULT_STROKE_STYLE_;this.fromLonLatTransform_=void 0;this.toLonLatTransform_=void 0;this.projectionCenterLonLat_=null;this.setMap(void 0!==t.map?t.map:null)};ol.Graticule.DEFAULT_STROKE_STYLE_=new ol.style.Stroke({color:"rgba(0,0,0,0.2)"});ol.Graticule.intervals_=[90,45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001];ol.Graticule.prototype.addMeridian_=function(e,t,o,r,i,n){var a=this.getMeridian_(e,t,o,r,n);ol.extent.intersects(a.getExtent(),i)&&(this.meridians_[n++]=a);return n};ol.Graticule.prototype.addParallel_=function(e,t,o,r,i,n){var a=this.getParallel_(e,t,o,r,n);ol.extent.intersects(a.getExtent(),i)&&(this.parallels_[n++]=a);return n};ol.Graticule.prototype.createGraticule_=function(e,t,o,r){var i=this.getInterval_(o);if(-1!=i){var n,a,l,s,p=this.toLonLatTransform_(t),c=p[0],u=p[1],g=this.maxLines_,d=[Math.max(e[0],this.minLonP_),Math.max(e[1],this.minLatP_),Math.min(e[2],this.maxLonP_),Math.min(e[3],this.maxLatP_)];d=ol.proj.transformExtent(d,this.projection_,"EPSG:4326");var h=d[3],f=d[2],y=d[1],m=d[0];c=Math.floor(c/i)*i;s=ol.math.clamp(c,this.minLon_,this.maxLon_);a=this.addMeridian_(s,y,h,r,e,0);n=0;for(;s!=this.minLon_&&n++<g;){s=Math.max(s-i,this.minLon_);a=this.addMeridian_(s,y,h,r,e,a)}s=ol.math.clamp(c,this.minLon_,this.maxLon_);n=0;for(;s!=this.maxLon_&&n++<g;){s=Math.min(s+i,this.maxLon_);a=this.addMeridian_(s,y,h,r,e,a)}this.meridians_.length=a;u=Math.floor(u/i)*i;l=ol.math.clamp(u,this.minLat_,this.maxLat_);a=this.addParallel_(l,m,f,r,e,0);n=0;for(;l!=this.minLat_&&n++<g;){l=Math.max(l-i,this.minLat_);a=this.addParallel_(l,m,f,r,e,a)}l=ol.math.clamp(u,this.minLat_,this.maxLat_);n=0;for(;l!=this.maxLat_&&n++<g;){l=Math.min(l+i,this.maxLat_);a=this.addParallel_(l,m,f,r,e,a)}this.parallels_.length=a}else this.meridians_.length=this.parallels_.length=0};ol.Graticule.prototype.getInterval_=function(e){var t,o,r,i,n=this.projectionCenterLonLat_[0],a=this.projectionCenterLonLat_[1],l=-1,s=Math.pow(this.targetSize_*e,2),p=[],c=[];for(t=0,o=ol.Graticule.intervals_.length;o>t;++t){r=ol.Graticule.intervals_[t]/2;p[0]=n-r;p[1]=a-r;c[0]=n+r;c[1]=a+r;this.fromLonLatTransform_(p,p);this.fromLonLatTransform_(c,c);i=Math.pow(c[0]-p[0],2)+Math.pow(c[1]-p[1],2);if(s>=i)break;l=ol.Graticule.intervals_[t]}return l};ol.Graticule.prototype.getMap=function(){return this.map_};ol.Graticule.prototype.getMeridian_=function(e,t,o,r,i){var n=ol.geom.flat.geodesic.meridian(e,t,o,this.projection_,r),a=void 0!==this.meridians_[i]?this.meridians_[i]:new ol.geom.LineString(null);a.setFlatCoordinates(ol.geom.GeometryLayout.XY,n);return a};ol.Graticule.prototype.getMeridians=function(){return this.meridians_};ol.Graticule.prototype.getParallel_=function(e,t,o,r,i){var n=ol.geom.flat.geodesic.parallel(e,this.minLon_,this.maxLon_,this.projection_,r),a=void 0!==this.parallels_[i]?this.parallels_[i]:new ol.geom.LineString(null);a.setFlatCoordinates(ol.geom.GeometryLayout.XY,n);return a};ol.Graticule.prototype.getParallels=function(){return this.parallels_};ol.Graticule.prototype.handlePostCompose_=function(e){var t=e.vectorContext,o=e.frameState,r=o.extent,i=o.viewState,n=i.center,a=i.projection,l=i.resolution,s=o.pixelRatio,p=l*l/(4*s*s),c=!this.projection_||!ol.proj.equivalent(this.projection_,a);c&&this.updateProjectionInfo_(a);var u=0;if(a.canWrapX()){var g=a.getExtent(),d=ol.extent.getWidth(g),h=o.focus[0];if(h<g[0]||h>g[2]){var f=Math.ceil((g[0]-h)/d);u=d*f;r=[r[0]+u,r[1],r[2]+u,r[3]]}}this.createGraticule_(r,n,l,p);t.setFillStrokeStyle(null,this.strokeStyle_);var y,m,v;for(y=0,m=this.meridians_.length;m>y;++y){v=this.meridians_[y];t.drawLineString(v,null)}for(y=0,m=this.parallels_.length;m>y;++y){v=this.parallels_[y];t.drawLineString(v,null)}};ol.Graticule.prototype.updateProjectionInfo_=function(e){var t=ol.proj.get("EPSG:4326"),o=e.getExtent(),r=e.getWorldExtent(),i=ol.proj.transformExtent(r,t,e),n=r[3],a=r[2],l=r[1],s=r[0],p=i[3],c=i[2],u=i[1],g=i[0];this.maxLat_=n;this.maxLon_=a;this.minLat_=l;this.minLon_=s;this.maxLatP_=p;this.maxLonP_=c;this.minLatP_=u;this.minLonP_=g;this.fromLonLatTransform_=ol.proj.getTransform(t,e);this.toLonLatTransform_=ol.proj.getTransform(e,t);this.projectionCenterLonLat_=this.toLonLatTransform_(ol.extent.getCenter(o));this.projection_=e};ol.Graticule.prototype.setMap=function(e){if(this.map_){this.map_.un(ol.render.EventType.POSTCOMPOSE,this.handlePostCompose_,this);this.map_.render()}if(e){e.on(ol.render.EventType.POSTCOMPOSE,this.handlePostCompose_,this);e.render()}this.map_=e};goog.provide("ol.ImageBase");goog.require("ol");goog.require("ol.events.EventTarget");goog.require("ol.events.EventType");ol.ImageBase=function(e,t,o,r,i){ol.events.EventTarget.call(this);this.attributions_=i;this.extent=e;this.pixelRatio_=o;this.resolution=t;this.state=r};ol.inherits(ol.ImageBase,ol.events.EventTarget);ol.ImageBase.prototype.changed=function(){this.dispatchEvent(ol.events.EventType.CHANGE)};ol.ImageBase.prototype.getAttributions=function(){return this.attributions_};ol.ImageBase.prototype.getExtent=function(){return this.extent};ol.ImageBase.prototype.getImage=function(e){};ol.ImageBase.prototype.getPixelRatio=function(){return this.pixelRatio_};ol.ImageBase.prototype.getResolution=function(){return this.resolution};ol.ImageBase.prototype.getState=function(){return this.state};ol.ImageBase.prototype.load=function(){};goog.provide("ol.Image");goog.require("ol");goog.require("ol.ImageBase");goog.require("ol.ImageState");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.extent");goog.require("ol.obj");ol.Image=function(e,t,o,r,i,n,a){ol.ImageBase.call(this,e,t,o,ol.ImageState.IDLE,r);this.src_=i;this.image_=new Image;null!==n&&(this.image_.crossOrigin=n);this.imageByContext_={};this.imageListenerKeys_=null;this.state=ol.ImageState.IDLE;this.imageLoadFunction_=a};ol.inherits(ol.Image,ol.ImageBase);ol.Image.prototype.getImage=function(e){if(void 0!==e){var t,o=ol.getUid(e);if(o in this.imageByContext_)return this.imageByContext_[o];t=ol.obj.isEmpty(this.imageByContext_)?this.image_:this.image_.cloneNode(!1);this.imageByContext_[o]=t;return t}return this.image_};ol.Image.prototype.handleImageError_=function(){this.state=ol.ImageState.ERROR;this.unlistenImage_();this.changed()};ol.Image.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=ol.extent.getHeight(this.extent)/this.image_.height);this.state=ol.ImageState.LOADED;this.unlistenImage_();this.changed()};ol.Image.prototype.load=function(){if(this.state==ol.ImageState.IDLE||this.state==ol.ImageState.ERROR){this.state=ol.ImageState.LOADING;this.changed();this.imageListenerKeys_=[ol.events.listenOnce(this.image_,ol.events.EventType.ERROR,this.handleImageError_,this),ol.events.listenOnce(this.image_,ol.events.EventType.LOAD,this.handleImageLoad_,this)];this.imageLoadFunction_(this,this.src_)}};ol.Image.prototype.setImage=function(e){this.image_=e};ol.Image.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(ol.events.unlistenByKey);this.imageListenerKeys_=null};goog.provide("ol.ImageCanvas");goog.require("ol");goog.require("ol.ImageBase");goog.require("ol.ImageState");ol.ImageCanvas=function(e,t,o,r,i,n){this.loader_=void 0!==n?n:null;var a=void 0!==n?ol.ImageState.IDLE:ol.ImageState.LOADED;ol.ImageBase.call(this,e,t,o,a,r);this.canvas_=i;this.error_=null};ol.inherits(ol.ImageCanvas,ol.ImageBase);ol.ImageCanvas.prototype.getError=function(){return this.error_};ol.ImageCanvas.prototype.handleLoad_=function(e){if(e){this.error_=e;this.state=ol.ImageState.ERROR}else this.state=ol.ImageState.LOADED;this.changed()};ol.ImageCanvas.prototype.load=function(){if(this.state==ol.ImageState.IDLE){this.state=ol.ImageState.LOADING;this.changed();this.loader_(this.handleLoad_.bind(this))}};ol.ImageCanvas.prototype.getImage=function(e){return this.canvas_};goog.provide("ol.Tile");goog.require("ol");goog.require("ol.TileState");goog.require("ol.events.EventTarget");goog.require("ol.events.EventType");ol.Tile=function(e,t){ol.events.EventTarget.call(this);this.tileCoord=e;this.state=t;this.interimTile=null;this.key=""};ol.inherits(ol.Tile,ol.events.EventTarget);ol.Tile.prototype.changed=function(){this.dispatchEvent(ol.events.EventType.CHANGE)};ol.Tile.prototype.getImage=function(){};ol.Tile.prototype.getKey=function(){return this.key+"/"+this.tileCoord};ol.Tile.prototype.getInterimTile=function(){if(!this.interimTile)return this;var e=this.interimTile;do{if(e.getState()==ol.TileState.LOADED)return e;e=e.interimTile}while(e);return this};ol.Tile.prototype.refreshInterimChain=function(){if(this.interimTile){var e=this.interimTile,t=this;do{if(e.getState()==ol.TileState.LOADED){e.interimTile=null;break}e.getState()==ol.TileState.LOADING?t=e:e.getState()==ol.TileState.IDLE?t.interimTile=e.interimTile:t=e;e=t.interimTile}while(e)}};ol.Tile.prototype.getTileCoord=function(){return this.tileCoord};ol.Tile.prototype.getState=function(){return this.state};ol.Tile.prototype.load=function(){};goog.provide("ol.ImageTile");goog.require("ol");goog.require("ol.Tile");goog.require("ol.TileState");goog.require("ol.events");goog.require("ol.events.EventType");ol.ImageTile=function(e,t,o,r,i){ol.Tile.call(this,e,t);this.src_=o;this.image_=new Image;null!==r&&(this.image_.crossOrigin=r);this.imageListenerKeys_=null;this.tileLoadFunction_=i};ol.inherits(ol.ImageTile,ol.Tile);ol.ImageTile.prototype.disposeInternal=function(){this.state==ol.TileState.LOADING&&this.unlistenImage_();this.interimTile&&this.interimTile.dispose();this.state=ol.TileState.ABORT;this.changed();ol.Tile.prototype.disposeInternal.call(this)};ol.ImageTile.prototype.getImage=function(){return this.image_};ol.ImageTile.prototype.getKey=function(){return this.src_};ol.ImageTile.prototype.handleImageError_=function(){this.state=ol.TileState.ERROR;this.unlistenImage_();this.changed()};ol.ImageTile.prototype.handleImageLoad_=function(){this.state=this.image_.naturalWidth&&this.image_.naturalHeight?ol.TileState.LOADED:ol.TileState.EMPTY;this.unlistenImage_();this.changed()};ol.ImageTile.prototype.load=function(){if(this.state==ol.TileState.IDLE||this.state==ol.TileState.ERROR){this.state=ol.TileState.LOADING;this.changed();this.imageListenerKeys_=[ol.events.listenOnce(this.image_,ol.events.EventType.ERROR,this.handleImageError_,this),ol.events.listenOnce(this.image_,ol.events.EventType.LOAD,this.handleImageLoad_,this)];this.tileLoadFunction_(this,this.src_)}};ol.ImageTile.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(ol.events.unlistenByKey);this.imageListenerKeys_=null};goog.provide("ol.interaction.DragAndDrop");goog.require("ol");goog.require("ol.functions");goog.require("ol.events");goog.require("ol.events.Event");goog.require("ol.events.EventType");goog.require("ol.interaction.Interaction");goog.require("ol.proj");ol.interaction.DragAndDrop=function(e){var t=e?e:{};ol.interaction.Interaction.call(this,{handleEvent:ol.interaction.DragAndDrop.handleEvent});this.formatConstructors_=t.formatConstructors?t.formatConstructors:[];this.projection_=t.projection?ol.proj.get(t.projection):null;this.dropListenKeys_=null;this.target=t.target?t.target:null};ol.inherits(ol.interaction.DragAndDrop,ol.interaction.Interaction);ol.interaction.DragAndDrop.handleDrop_=function(e){var t,o,r,i=e.dataTransfer.files;for(t=0,o=i.length;o>t;++t){r=i.item(t);var n=new FileReader;n.addEventListener(ol.events.EventType.LOAD,this.handleResult_.bind(this,r));n.readAsText(r)}};ol.interaction.DragAndDrop.handleStop_=function(e){e.stopPropagation();e.preventDefault();e.dataTransfer.dropEffect="copy"};ol.interaction.DragAndDrop.prototype.handleResult_=function(e,t){var o=t.target.result,r=this.getMap(),i=this.projection_;if(!i){var n=r.getView();i=n.getProjection()}var a,l,s=this.formatConstructors_,p=[];for(a=0,l=s.length;l>a;++a){var c=s[a],u=new c;p=this.tryReadFeatures_(u,o,{featureProjection:i});if(p&&p.length>0)break}this.dispatchEvent(new ol.interaction.DragAndDrop.Event(ol.interaction.DragAndDrop.EventType_.ADD_FEATURES,e,p,i))};ol.interaction.DragAndDrop.handleEvent=ol.functions.TRUE;ol.interaction.DragAndDrop.prototype.setMap=function(e){if(this.dropListenKeys_){this.dropListenKeys_.forEach(ol.events.unlistenByKey);this.dropListenKeys_=null}ol.interaction.Interaction.prototype.setMap.call(this,e);if(e){var t=this.target?this.target:e.getViewport();this.dropListenKeys_=[ol.events.listen(t,ol.events.EventType.DROP,ol.interaction.DragAndDrop.handleDrop_,this),ol.events.listen(t,ol.events.EventType.DRAGENTER,ol.interaction.DragAndDrop.handleStop_,this),ol.events.listen(t,ol.events.EventType.DRAGOVER,ol.interaction.DragAndDrop.handleStop_,this),ol.events.listen(t,ol.events.EventType.DROP,ol.interaction.DragAndDrop.handleStop_,this)]}};ol.interaction.DragAndDrop.prototype.tryReadFeatures_=function(e,t,o){try{return e.readFeatures(t,o)}catch(r){return null}};ol.interaction.DragAndDrop.EventType_={ADD_FEATURES:"addfeatures"};ol.interaction.DragAndDrop.Event=function(e,t,o,r){ol.events.Event.call(this,e);this.features=o;this.file=t;this.projection=r};ol.inherits(ol.interaction.DragAndDrop.Event,ol.events.Event);goog.provide("ol.interaction.DragRotateAndZoom");goog.require("ol");goog.require("ol.ViewHint");goog.require("ol.events.condition");goog.require("ol.interaction.Interaction");goog.require("ol.interaction.Pointer");ol.interaction.DragRotateAndZoom=function(e){var t=e?e:{};ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.DragRotateAndZoom.handleDownEvent_,handleDragEvent:ol.interaction.DragRotateAndZoom.handleDragEvent_,handleUpEvent:ol.interaction.DragRotateAndZoom.handleUpEvent_});this.condition_=t.condition?t.condition:ol.events.condition.shiftKeyOnly;this.lastAngle_=void 0;this.lastMagnitude_=void 0;this.lastScaleDelta_=0;this.duration_=void 0!==t.duration?t.duration:400};ol.inherits(ol.interaction.DragRotateAndZoom,ol.interaction.Pointer);ol.interaction.DragRotateAndZoom.handleDragEvent_=function(e){if(ol.events.condition.mouseOnly(e)){var t=e.map,o=t.getSize(),r=e.pixel,i=r[0]-o[0]/2,n=o[1]/2-r[1],a=Math.atan2(n,i),l=Math.sqrt(i*i+n*n),s=t.getView();if(void 0!==this.lastAngle_){var p=a-this.lastAngle_;ol.interaction.Interaction.rotateWithoutConstraints(s,s.getRotation()-p)}this.lastAngle_=a;if(void 0!==this.lastMagnitude_){var c=this.lastMagnitude_*(s.getResolution()/l);ol.interaction.Interaction.zoomWithoutConstraints(s,c)}void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/l);this.lastMagnitude_=l}};ol.interaction.DragRotateAndZoom.handleUpEvent_=function(e){if(!ol.events.condition.mouseOnly(e))return!0;var t=e.map,o=t.getView();o.setHint(ol.ViewHint.INTERACTING,-1);var r=this.lastScaleDelta_-1;ol.interaction.Interaction.rotate(o,o.getRotation());ol.interaction.Interaction.zoom(o,o.getResolution(),void 0,this.duration_,r);this.lastScaleDelta_=0;return!1};ol.interaction.DragRotateAndZoom.handleDownEvent_=function(e){if(!ol.events.condition.mouseOnly(e))return!1;if(this.condition_(e)){e.map.getView().setHint(ol.ViewHint.INTERACTING,1);this.lastAngle_=void 0;this.lastMagnitude_=void 0;return!0}return!1};goog.provide("ol.interaction.DrawEventType");ol.interaction.DrawEventType={DRAWSTART:"drawstart",DRAWEND:"drawend"};goog.provide("ol.render.canvas.Instruction");ol.render.canvas.Instruction={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,DRAW_IMAGE:4,DRAW_TEXT:5,END_GEOMETRY:6,FILL:7,MOVE_TO_LINE_TO:8,SET_FILL_STYLE:9,SET_STROKE_STYLE:10,SET_TEXT_STYLE:11,STROKE:12};goog.provide("ol.render.canvas.Replay");goog.require("ol");goog.require("ol.array");goog.require("ol.extent");goog.require("ol.extent.Relationship");goog.require("ol.geom.flat.transform");goog.require("ol.has");goog.require("ol.obj");goog.require("ol.render.VectorContext");goog.require("ol.render.canvas.Instruction");goog.require("ol.transform");ol.render.canvas.Replay=function(e,t,o,r){ol.render.VectorContext.call(this);this.tolerance=e;this.maxExtent=t;this.overlaps=r;this.maxLineWidth=0;this.resolution=o;this.fillOrigin_;this.beginGeometryInstruction1_=null;this.beginGeometryInstruction2_=null;this.instructions=[];this.coordinates=[];this.renderedTransform_=ol.transform.create();this.hitDetectionInstructions=[];this.pixelCoordinates_=null;this.tmpLocalTransform_=ol.transform.create();this.resetTransform_=ol.transform.create()};ol.inherits(ol.render.canvas.Replay,ol.render.VectorContext);ol.render.canvas.Replay.prototype.appendFlatCoordinates=function(e,t,o,r,i,n){var a=this.coordinates.length,l=this.getBufferedMaxExtent();n&&(t+=r);var s,p,c,u=[e[t],e[t+1]],g=[0/0,0/0],d=!0;for(s=t+r;o>s;s+=r){g[0]=e[s];g[1]=e[s+1];c=ol.extent.coordinateRelationship(l,g);if(c!==p){if(d){this.coordinates[a++]=u[0];this.coordinates[a++]=u[1]}this.coordinates[a++]=g[0];this.coordinates[a++]=g[1];d=!1}else if(c===ol.extent.Relationship.INTERSECTING){this.coordinates[a++]=g[0];this.coordinates[a++]=g[1];d=!1}else d=!0;u[0]=g[0];u[1]=g[1];p=c}if(i&&d||s===t+r){this.coordinates[a++]=u[0];this.coordinates[a++]=u[1]}return a};ol.render.canvas.Replay.prototype.beginGeometry=function(e,t){this.beginGeometryInstruction1_=[ol.render.canvas.Instruction.BEGIN_GEOMETRY,t,0];this.instructions.push(this.beginGeometryInstruction1_);this.beginGeometryInstruction2_=[ol.render.canvas.Instruction.BEGIN_GEOMETRY,t,0];this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)};ol.render.canvas.Replay.prototype.fill_=function(e,t){if(this.fillOrigin_){var o=ol.transform.apply(this.renderedTransform_,this.fillOrigin_.slice());e.translate(o[0],o[1]);e.rotate(t)}e.fill();this.fillOrigin_&&e.setTransform.apply(e,this.resetTransform_)};ol.render.canvas.Replay.prototype.replay_=function(e,t,o,r,i,n,a,l){var s;if(this.pixelCoordinates_&&ol.array.equals(o,this.renderedTransform_))s=this.pixelCoordinates_;else{this.pixelCoordinates_||(this.pixelCoordinates_=[]);s=ol.geom.flat.transform.transform2D(this.coordinates,0,this.coordinates.length,2,o,this.pixelCoordinates_);ol.transform.setFromArray(this.renderedTransform_,o)}for(var p,c,u,g,d,h=!ol.obj.isEmpty(i),f=0,y=n.length,m=0,v=this.tmpLocalTransform_,C=this.resetTransform_,T=0,_=0,S=this.instructions!=n||this.overlaps?0:200;y>f;){var E,x,P,L,w,R,A=n[f],b=A[0];switch(b){case ol.render.canvas.Instruction.BEGIN_GEOMETRY:E=A[1];h&&i[ol.getUid(E).toString()]||!E.getGeometry()?f=A[2]:void 0===l||ol.extent.intersects(l,E.getGeometry().getExtent())?++f:f=A[2]+1;break;case ol.render.canvas.Instruction.BEGIN_PATH:if(T>S){this.fill_(e,r);T=0}if(_>S){e.stroke();_=0}if(!T&&!_){e.beginPath();c=u=0/0}++f;break;case ol.render.canvas.Instruction.CIRCLE:m=A[1];var M=s[m],I=s[m+1],O=s[m+2],N=s[m+3],D=O-M,F=N-I,k=Math.sqrt(D*D+F*F);e.moveTo(M+k,I);e.arc(M,I,k,0,2*Math.PI,!0);++f;break;case ol.render.canvas.Instruction.CLOSE_PATH:e.closePath();++f;break;case ol.render.canvas.Instruction.DRAW_IMAGE:m=A[1];p=A[2];var G=A[3],U=A[4]*t,B=A[5]*t,q=A[6],j=A[7],$=A[8],W=A[9],V=A[10],Y=A[11],K=A[12],X=A[13],H=A[14];V&&(Y+=r);for(;p>m;m+=2){w=s[m]-U;R=s[m+1]-B;if(X){w=Math.round(w);R=Math.round(R)}if(1!=K||0!==Y){var z=w+U,Z=R+B;ol.transform.compose(v,z,Z,K,K,Y,-z,-Z);e.setTransform.apply(e,v)}var J=e.globalAlpha;1!=j&&(e.globalAlpha=J*j);var Q=H+$>G.width?G.width-$:H,ee=q+W>G.height?G.height-W:q;e.drawImage(G,$,W,Q,ee,w,R,Q*t,ee*t);1!=j&&(e.globalAlpha=J);(1!=K||0!==Y)&&e.setTransform.apply(e,C)}++f;break;case ol.render.canvas.Instruction.DRAW_TEXT:m=A[1];p=A[2];L=A[3];var te=A[4]*t,oe=A[5]*t;Y=A[6];K=A[7]*t;x=A[8];P=A[9];V=A[10];V&&(Y+=r);for(;p>m;m+=2){w=s[m]+te;R=s[m+1]+oe;if(1!=K||0!==Y){ol.transform.compose(v,w,R,K,K,Y,-w,-R);e.setTransform.apply(e,v)}var re,ie,ne=L.split("\n"),ae=ne.length;if(ae>1){re=Math.round(1.5*e.measureText("M").width);ie=R-(ae-1)/2*re}else{re=0;ie=R}for(var le=0;ae>le;le++){var se=ne[le];P&&e.strokeText(se,w,ie);x&&e.fillText(se,w,ie);ie+=re}(1!=K||0!==Y)&&e.setTransform.apply(e,C)}++f;break;case ol.render.canvas.Instruction.END_GEOMETRY:if(void 0!==a){E=A[1];var pe=a(E);if(pe)return pe}++f;break;case ol.render.canvas.Instruction.FILL:S?T++:this.fill_(e,r);++f;break;case ol.render.canvas.Instruction.MOVE_TO_LINE_TO:m=A[1];p=A[2];w=s[m];R=s[m+1];g=w+.5|0;d=R+.5|0;if(g!==c||d!==u){e.moveTo(w,R);c=g;u=d}for(m+=2;p>m;m+=2){w=s[m];R=s[m+1];g=w+.5|0;d=R+.5|0;if(m==p-2||g!==c||d!==u){e.lineTo(w,R);c=g;u=d}}++f;break;case ol.render.canvas.Instruction.SET_FILL_STYLE:this.fillOrigin_=A[2];if(T){this.fill_(e,r);T=0;if(_){e.stroke();_=0}}e.fillStyle=A[1];++f;break;case ol.render.canvas.Instruction.SET_STROKE_STYLE:var ce=void 0!==A[8]?A[8]:!0,ue=A[9],ge=A[2];if(_){e.stroke();_=0}e.strokeStyle=A[1];e.lineWidth=ce?ge*t:ge;e.lineCap=A[3];e.lineJoin=A[4];e.miterLimit=A[5];if(ol.has.CANVAS_LINE_DASH){var de=A[6],he=A[7];if(ce&&t!==ue){de=de.map(function(e){return e*t/ue});he*=t/ue;A[6]=de;A[7]=he;A[9]=t}e.lineDashOffset=he;e.setLineDash(de)}++f;break;case ol.render.canvas.Instruction.SET_TEXT_STYLE:e.font=A[1];e.textAlign=A[2];e.textBaseline=A[3];++f;break;case ol.render.canvas.Instruction.STROKE:S?_++:e.stroke();++f;break;default:++f}}T&&this.fill_(e,r);_&&e.stroke();return void 0};ol.render.canvas.Replay.prototype.replay=function(e,t,o,r,i){var n=this.instructions;this.replay_(e,t,o,r,i,n,void 0,void 0)};ol.render.canvas.Replay.prototype.replayHitDetection=function(e,t,o,r,i,n){var a=this.hitDetectionInstructions;return this.replay_(e,1,t,o,r,a,i,n)};ol.render.canvas.Replay.prototype.reverseHitDetectionInstructions=function(){var e=this.hitDetectionInstructions;e.reverse();var t,o,r,i=e.length,n=-1;for(t=0;i>t;++t){o=e[t];r=o[0];if(r==ol.render.canvas.Instruction.END_GEOMETRY)n=t;else if(r==ol.render.canvas.Instruction.BEGIN_GEOMETRY){o[2]=t;ol.array.reverseSubArray(this.hitDetectionInstructions,n,t);n=-1}}};ol.render.canvas.Replay.prototype.endGeometry=function(e,t){this.beginGeometryInstruction1_[2]=this.instructions.length;this.beginGeometryInstruction1_=null;this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length;this.beginGeometryInstruction2_=null;var o=[ol.render.canvas.Instruction.END_GEOMETRY,t];this.instructions.push(o);this.hitDetectionInstructions.push(o)};ol.render.canvas.Replay.prototype.finish=ol.nullFunction;ol.render.canvas.Replay.prototype.getBufferedMaxExtent=function(){return this.maxExtent};goog.provide("ol.render.canvas.ImageReplay");goog.require("ol");goog.require("ol.render.canvas.Instruction");goog.require("ol.render.canvas.Replay");ol.render.canvas.ImageReplay=function(e,t,o,r){ol.render.canvas.Replay.call(this,e,t,o,r);this.hitDetectionImage_=null;this.image_=null;this.anchorX_=void 0;this.anchorY_=void 0;this.height_=void 0;this.opacity_=void 0;this.originX_=void 0;this.originY_=void 0;this.rotateWithView_=void 0;this.rotation_=void 0;this.scale_=void 0;this.snapToPixel_=void 0;this.width_=void 0};ol.inherits(ol.render.canvas.ImageReplay,ol.render.canvas.Replay);ol.render.canvas.ImageReplay.prototype.drawCoordinates_=function(e,t,o,r){return this.appendFlatCoordinates(e,t,o,r,!1,!1);

};ol.render.canvas.ImageReplay.prototype.drawPoint=function(e,t){if(this.image_){this.beginGeometry(e,t);var o=e.getFlatCoordinates(),r=e.getStride(),i=this.coordinates.length,n=this.drawCoordinates_(o,0,o.length,r);this.instructions.push([ol.render.canvas.Instruction.DRAW_IMAGE,i,n,this.image_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.DRAW_IMAGE,i,n,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]);this.endGeometry(e,t)}};ol.render.canvas.ImageReplay.prototype.drawMultiPoint=function(e,t){if(this.image_){this.beginGeometry(e,t);var o=e.getFlatCoordinates(),r=e.getStride(),i=this.coordinates.length,n=this.drawCoordinates_(o,0,o.length,r);this.instructions.push([ol.render.canvas.Instruction.DRAW_IMAGE,i,n,this.image_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.DRAW_IMAGE,i,n,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]);this.endGeometry(e,t)}};ol.render.canvas.ImageReplay.prototype.finish=function(){this.reverseHitDetectionInstructions();this.anchorX_=void 0;this.anchorY_=void 0;this.hitDetectionImage_=null;this.image_=null;this.height_=void 0;this.scale_=void 0;this.opacity_=void 0;this.originX_=void 0;this.originY_=void 0;this.rotateWithView_=void 0;this.rotation_=void 0;this.snapToPixel_=void 0;this.width_=void 0};ol.render.canvas.ImageReplay.prototype.setImageStyle=function(e){var t=e.getAnchor(),o=e.getSize(),r=e.getHitDetectionImage(1),i=e.getImage(1),n=e.getOrigin();this.anchorX_=t[0];this.anchorY_=t[1];this.hitDetectionImage_=r;this.image_=i;this.height_=o[1];this.opacity_=e.getOpacity();this.originX_=n[0];this.originY_=n[1];this.rotateWithView_=e.getRotateWithView();this.rotation_=e.getRotation();this.scale_=e.getScale();this.snapToPixel_=e.getSnapToPixel();this.width_=o[0]};goog.provide("ol.render.canvas.LineStringReplay");goog.require("ol");goog.require("ol.array");goog.require("ol.colorlike");goog.require("ol.extent");goog.require("ol.render.canvas");goog.require("ol.render.canvas.Instruction");goog.require("ol.render.canvas.Replay");ol.render.canvas.LineStringReplay=function(e,t,o,r){ol.render.canvas.Replay.call(this,e,t,o,r);this.bufferedMaxExtent_=null;this.state_={currentStrokeStyle:void 0,currentLineCap:void 0,currentLineDash:null,currentLineDashOffset:void 0,currentLineJoin:void 0,currentLineWidth:void 0,currentMiterLimit:void 0,lastStroke:0,strokeStyle:void 0,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0}};ol.inherits(ol.render.canvas.LineStringReplay,ol.render.canvas.Replay);ol.render.canvas.LineStringReplay.prototype.drawFlatCoordinates_=function(e,t,o,r){var i=this.coordinates.length,n=this.appendFlatCoordinates(e,t,o,r,!1,!1),a=[ol.render.canvas.Instruction.MOVE_TO_LINE_TO,i,n];this.instructions.push(a);this.hitDetectionInstructions.push(a);return o};ol.render.canvas.LineStringReplay.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_){this.bufferedMaxExtent_=ol.extent.clone(this.maxExtent);if(this.maxLineWidth>0){var e=this.resolution*(this.maxLineWidth+1)/2;ol.extent.buffer(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}}return this.bufferedMaxExtent_};ol.render.canvas.LineStringReplay.prototype.setStrokeStyle_=function(){var e=this.state_,t=e.strokeStyle,o=e.lineCap,r=e.lineDash,i=e.lineDashOffset,n=e.lineJoin,a=e.lineWidth,l=e.miterLimit;if(e.currentStrokeStyle!=t||e.currentLineCap!=o||!ol.array.equals(e.currentLineDash,r)||e.currentLineDashOffset!=i||e.currentLineJoin!=n||e.currentLineWidth!=a||e.currentMiterLimit!=l){if(e.lastStroke!=this.coordinates.length){this.instructions.push([ol.render.canvas.Instruction.STROKE]);e.lastStroke=this.coordinates.length}this.instructions.push([ol.render.canvas.Instruction.SET_STROKE_STYLE,t,a,o,n,l,r,i,!0,1],[ol.render.canvas.Instruction.BEGIN_PATH]);e.currentStrokeStyle=t;e.currentLineCap=o;e.currentLineDash=r;e.currentLineDashOffset=i;e.currentLineJoin=n;e.currentLineWidth=a;e.currentMiterLimit=l}};ol.render.canvas.LineStringReplay.prototype.drawLineString=function(e,t){var o=this.state_,r=o.strokeStyle,i=o.lineWidth;if(void 0!==r&&void 0!==i){this.setStrokeStyle_();this.beginGeometry(e,t);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.SET_STROKE_STYLE,o.strokeStyle,o.lineWidth,o.lineCap,o.lineJoin,o.miterLimit,o.lineDash,o.lineDashOffset,!0,1],[ol.render.canvas.Instruction.BEGIN_PATH]);var n=e.getFlatCoordinates(),a=e.getStride();this.drawFlatCoordinates_(n,0,n.length,a);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.STROKE]);this.endGeometry(e,t)}};ol.render.canvas.LineStringReplay.prototype.drawMultiLineString=function(e,t){var o=this.state_,r=o.strokeStyle,i=o.lineWidth;if(void 0!==r&&void 0!==i){this.setStrokeStyle_();this.beginGeometry(e,t);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.SET_STROKE_STYLE,o.strokeStyle,o.lineWidth,o.lineCap,o.lineJoin,o.miterLimit,o.lineDash,o.lineDashOffset,!0,1],[ol.render.canvas.Instruction.BEGIN_PATH]);var n,a,l=e.getEnds(),s=e.getFlatCoordinates(),p=e.getStride(),c=0;for(n=0,a=l.length;a>n;++n)c=this.drawFlatCoordinates_(s,c,l[n],p);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.STROKE]);this.endGeometry(e,t)}};ol.render.canvas.LineStringReplay.prototype.finish=function(){var e=this.state_;e.lastStroke!=this.coordinates.length&&this.instructions.push([ol.render.canvas.Instruction.STROKE]);this.reverseHitDetectionInstructions();this.state_=null};ol.render.canvas.LineStringReplay.prototype.setFillStrokeStyle=function(e,t){var o=t.getColor();this.state_.strokeStyle=ol.colorlike.asColorLike(o?o:ol.render.canvas.defaultStrokeStyle);var r=t.getLineCap();this.state_.lineCap=void 0!==r?r:ol.render.canvas.defaultLineCap;var i=t.getLineDash();this.state_.lineDash=i?i:ol.render.canvas.defaultLineDash;var n=t.getLineDashOffset();this.state_.lineDashOffset=n?n:ol.render.canvas.defaultLineDashOffset;var a=t.getLineJoin();this.state_.lineJoin=void 0!==a?a:ol.render.canvas.defaultLineJoin;var l=t.getWidth();this.state_.lineWidth=void 0!==l?l:ol.render.canvas.defaultLineWidth;var s=t.getMiterLimit();this.state_.miterLimit=void 0!==s?s:ol.render.canvas.defaultMiterLimit;if(this.state_.lineWidth>this.maxLineWidth){this.maxLineWidth=this.state_.lineWidth;this.bufferedMaxExtent_=null}};goog.provide("ol.render.canvas.PolygonReplay");goog.require("ol");goog.require("ol.array");goog.require("ol.color");goog.require("ol.colorlike");goog.require("ol.extent");goog.require("ol.geom.flat.simplify");goog.require("ol.render.canvas");goog.require("ol.render.canvas.Instruction");goog.require("ol.render.canvas.Replay");ol.render.canvas.PolygonReplay=function(e,t,o,r){ol.render.canvas.Replay.call(this,e,t,o,r);this.bufferedMaxExtent_=null;this.state_={currentFillStyle:void 0,currentStrokeStyle:void 0,currentLineCap:void 0,currentLineDash:null,currentLineDashOffset:void 0,currentLineJoin:void 0,currentLineWidth:void 0,currentMiterLimit:void 0,fillStyle:void 0,strokeStyle:void 0,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0}};ol.inherits(ol.render.canvas.PolygonReplay,ol.render.canvas.Replay);ol.render.canvas.PolygonReplay.prototype.drawFlatCoordinatess_=function(e,t,o,r){var i=this.state_,n=void 0!==i.fillStyle,a=void 0!=i.strokeStyle,l=o.length,s=[ol.render.canvas.Instruction.BEGIN_PATH];this.instructions.push(s);this.hitDetectionInstructions.push(s);for(var p=0;l>p;++p){var c=o[p],u=this.coordinates.length,g=this.appendFlatCoordinates(e,t,c,r,!0,!a),d=[ol.render.canvas.Instruction.MOVE_TO_LINE_TO,u,g];this.instructions.push(d);this.hitDetectionInstructions.push(d);if(a){var h=[ol.render.canvas.Instruction.CLOSE_PATH];this.instructions.push(h);this.hitDetectionInstructions.push(h)}t=c}var f=[ol.render.canvas.Instruction.FILL];this.hitDetectionInstructions.push(f);n&&this.instructions.push(f);if(a){var y=[ol.render.canvas.Instruction.STROKE];this.instructions.push(y);this.hitDetectionInstructions.push(y)}return t};ol.render.canvas.PolygonReplay.prototype.drawCircle=function(e,t){var o=this.state_,r=o.fillStyle,i=o.strokeStyle;if(void 0!==r||void 0!==i){this.setFillStrokeStyles_(e);this.beginGeometry(e,t);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.SET_FILL_STYLE,ol.color.asString(ol.render.canvas.defaultFillStyle)]);void 0!==o.strokeStyle&&this.hitDetectionInstructions.push([ol.render.canvas.Instruction.SET_STROKE_STYLE,o.strokeStyle,o.lineWidth,o.lineCap,o.lineJoin,o.miterLimit,o.lineDash,o.lineDashOffset,!0,1]);var n=e.getFlatCoordinates(),a=e.getStride(),l=this.coordinates.length;this.appendFlatCoordinates(n,0,n.length,a,!1,!1);var s=[ol.render.canvas.Instruction.BEGIN_PATH],p=[ol.render.canvas.Instruction.CIRCLE,l];this.instructions.push(s,p);this.hitDetectionInstructions.push(s,p);var c=[ol.render.canvas.Instruction.FILL];this.hitDetectionInstructions.push(c);void 0!==o.fillStyle&&this.instructions.push(c);if(void 0!==o.strokeStyle){var u=[ol.render.canvas.Instruction.STROKE];this.instructions.push(u);this.hitDetectionInstructions.push(u)}this.endGeometry(e,t)}};ol.render.canvas.PolygonReplay.prototype.drawPolygon=function(e,t){var o=this.state_;this.setFillStrokeStyles_(e);this.beginGeometry(e,t);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.SET_FILL_STYLE,ol.color.asString(ol.render.canvas.defaultFillStyle)]);void 0!==o.strokeStyle&&this.hitDetectionInstructions.push([ol.render.canvas.Instruction.SET_STROKE_STYLE,o.strokeStyle,o.lineWidth,o.lineCap,o.lineJoin,o.miterLimit,o.lineDash,o.lineDashOffset,!0,1]);var r=e.getEnds(),i=e.getOrientedFlatCoordinates(),n=e.getStride();this.drawFlatCoordinatess_(i,0,r,n);this.endGeometry(e,t)};ol.render.canvas.PolygonReplay.prototype.drawMultiPolygon=function(e,t){var o=this.state_,r=o.fillStyle,i=o.strokeStyle;if(void 0!==r||void 0!==i){this.setFillStrokeStyles_(e);this.beginGeometry(e,t);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.SET_FILL_STYLE,ol.color.asString(ol.render.canvas.defaultFillStyle)]);void 0!==o.strokeStyle&&this.hitDetectionInstructions.push([ol.render.canvas.Instruction.SET_STROKE_STYLE,o.strokeStyle,o.lineWidth,o.lineCap,o.lineJoin,o.miterLimit,o.lineDash,o.lineDashOffset,!0,1]);var n,a,l=e.getEndss(),s=e.getOrientedFlatCoordinates(),p=e.getStride(),c=0;for(n=0,a=l.length;a>n;++n)c=this.drawFlatCoordinatess_(s,c,l[n],p);this.endGeometry(e,t)}};ol.render.canvas.PolygonReplay.prototype.finish=function(){this.reverseHitDetectionInstructions();this.state_=null;var e=this.tolerance;if(0!==e){var t,o,r=this.coordinates;for(t=0,o=r.length;o>t;++t)r[t]=ol.geom.flat.simplify.snap(r[t],e)}};ol.render.canvas.PolygonReplay.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_){this.bufferedMaxExtent_=ol.extent.clone(this.maxExtent);if(this.maxLineWidth>0){var e=this.resolution*(this.maxLineWidth+1)/2;ol.extent.buffer(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}}return this.bufferedMaxExtent_};ol.render.canvas.PolygonReplay.prototype.setFillStrokeStyle=function(e,t){var o=this.state_;if(e){var r=e.getColor();o.fillStyle=ol.colorlike.asColorLike(r?r:ol.render.canvas.defaultFillStyle)}else o.fillStyle=void 0;if(t){var i=t.getColor();o.strokeStyle=ol.colorlike.asColorLike(i?i:ol.render.canvas.defaultStrokeStyle);var n=t.getLineCap();o.lineCap=void 0!==n?n:ol.render.canvas.defaultLineCap;var a=t.getLineDash();o.lineDash=a?a.slice():ol.render.canvas.defaultLineDash;var l=t.getLineDashOffset();o.lineDashOffset=l?l:ol.render.canvas.defaultLineDashOffset;var s=t.getLineJoin();o.lineJoin=void 0!==s?s:ol.render.canvas.defaultLineJoin;var p=t.getWidth();o.lineWidth=void 0!==p?p:ol.render.canvas.defaultLineWidth;var c=t.getMiterLimit();o.miterLimit=void 0!==c?c:ol.render.canvas.defaultMiterLimit;if(o.lineWidth>this.maxLineWidth){this.maxLineWidth=o.lineWidth;this.bufferedMaxExtent_=null}}else{o.strokeStyle=void 0;o.lineCap=void 0;o.lineDash=null;o.lineDashOffset=void 0;o.lineJoin=void 0;o.lineWidth=void 0;o.miterLimit=void 0}};ol.render.canvas.PolygonReplay.prototype.setFillStrokeStyles_=function(e){var t=this.state_,o=t.fillStyle,r=t.strokeStyle,i=t.lineCap,n=t.lineDash,a=t.lineDashOffset,l=t.lineJoin,s=t.lineWidth,p=t.miterLimit;if(void 0!==o&&("string"!=typeof o||t.currentFillStyle!=o)){var c=[ol.render.canvas.Instruction.SET_FILL_STYLE,o];if("string"!=typeof o){var u=e.getExtent();c.push([u[0],u[3]])}this.instructions.push(c);t.currentFillStyle=t.fillStyle}if(void 0!==r&&(t.currentStrokeStyle!=r||t.currentLineCap!=i||!ol.array.equals(t.currentLineDash,n)||t.currentLineDashOffset!=a||t.currentLineJoin!=l||t.currentLineWidth!=s||t.currentMiterLimit!=p)){this.instructions.push([ol.render.canvas.Instruction.SET_STROKE_STYLE,r,s,i,l,p,n,a,!0,1]);t.currentStrokeStyle=r;t.currentLineCap=i;t.currentLineDash=n;t.currentLineDashOffset=a;t.currentLineJoin=l;t.currentLineWidth=s;t.currentMiterLimit=p}};goog.provide("ol.render.canvas.TextReplay");goog.require("ol");goog.require("ol.colorlike");goog.require("ol.render.canvas");goog.require("ol.render.canvas.Instruction");goog.require("ol.render.canvas.Replay");ol.render.canvas.TextReplay=function(e,t,o,r){ol.render.canvas.Replay.call(this,e,t,o,r);this.replayFillState_=null;this.replayStrokeState_=null;this.replayTextState_=null;this.text_="";this.textOffsetX_=0;this.textOffsetY_=0;this.textRotateWithView_=void 0;this.textRotation_=0;this.textScale_=0;this.textFillState_=null;this.textStrokeState_=null;this.textState_=null};ol.inherits(ol.render.canvas.TextReplay,ol.render.canvas.Replay);ol.render.canvas.TextReplay.prototype.drawText=function(e,t,o,r,i,n){if(""!==this.text_&&this.textState_&&(this.textFillState_||this.textStrokeState_)){this.textFillState_&&this.setReplayFillState_(this.textFillState_);this.textStrokeState_&&this.setReplayStrokeState_(this.textStrokeState_);this.setReplayTextState_(this.textState_);this.beginGeometry(i,n);var a=this.coordinates.length,l=this.appendFlatCoordinates(e,t,o,r,!1,!1),s=!!this.textFillState_,p=!!this.textStrokeState_,c=[ol.render.canvas.Instruction.DRAW_TEXT,a,l,this.text_,this.textOffsetX_,this.textOffsetY_,this.textRotation_,this.textScale_,s,p,this.textRotateWithView_];this.instructions.push(c);this.hitDetectionInstructions.push(c);this.endGeometry(i,n)}};ol.render.canvas.TextReplay.prototype.setReplayFillState_=function(e){var t=this.replayFillState_;if(!t||t.fillStyle!=e.fillStyle){var o=[ol.render.canvas.Instruction.SET_FILL_STYLE,e.fillStyle];this.instructions.push(o);this.hitDetectionInstructions.push(o);t?t.fillStyle=e.fillStyle:this.replayFillState_={fillStyle:e.fillStyle}}};ol.render.canvas.TextReplay.prototype.setReplayStrokeState_=function(e){var t=this.replayStrokeState_;if(!t||t.lineCap!=e.lineCap||t.lineDash!=e.lineDash||t.lineDashOffset!=e.lineDashOffset||t.lineJoin!=e.lineJoin||t.lineWidth!=e.lineWidth||t.miterLimit!=e.miterLimit||t.strokeStyle!=e.strokeStyle){var o=[ol.render.canvas.Instruction.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset,!1,1];this.instructions.push(o);this.hitDetectionInstructions.push(o);if(t){t.lineCap=e.lineCap;t.lineDash=e.lineDash;t.lineDashOffset=e.lineDashOffset;t.lineJoin=e.lineJoin;t.lineWidth=e.lineWidth;t.miterLimit=e.miterLimit;t.strokeStyle=e.strokeStyle}else this.replayStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle}}};ol.render.canvas.TextReplay.prototype.setReplayTextState_=function(e){var t=this.replayTextState_;if(!t||t.font!=e.font||t.textAlign!=e.textAlign||t.textBaseline!=e.textBaseline){var o=[ol.render.canvas.Instruction.SET_TEXT_STYLE,e.font,e.textAlign,e.textBaseline];this.instructions.push(o);this.hitDetectionInstructions.push(o);if(t){t.font=e.font;t.textAlign=e.textAlign;t.textBaseline=e.textBaseline}else this.replayTextState_={font:e.font,textAlign:e.textAlign,textBaseline:e.textBaseline}}};ol.render.canvas.TextReplay.prototype.setTextStyle=function(e){if(e){var t=e.getFill();if(t){var o=t.getColor(),r=ol.colorlike.asColorLike(o?o:ol.render.canvas.defaultFillStyle);if(this.textFillState_){var i=this.textFillState_;i.fillStyle=r}else this.textFillState_={fillStyle:r}}else this.textFillState_=null;var n=e.getStroke();if(n){var a=n.getColor(),l=n.getLineCap(),s=n.getLineDash(),p=n.getLineDashOffset(),c=n.getLineJoin(),u=n.getWidth(),g=n.getMiterLimit(),d=void 0!==l?l:ol.render.canvas.defaultLineCap,h=s?s.slice():ol.render.canvas.defaultLineDash,f=void 0!==p?p:ol.render.canvas.defaultLineDashOffset,y=void 0!==c?c:ol.render.canvas.defaultLineJoin,m=void 0!==u?u:ol.render.canvas.defaultLineWidth,v=void 0!==g?g:ol.render.canvas.defaultMiterLimit,C=ol.colorlike.asColorLike(a?a:ol.render.canvas.defaultStrokeStyle);if(this.textStrokeState_){var T=this.textStrokeState_;T.lineCap=d;T.lineDash=h;T.lineDashOffset=f;T.lineJoin=y;T.lineWidth=m;T.miterLimit=v;T.strokeStyle=C}else this.textStrokeState_={lineCap:d,lineDash:h,lineDashOffset:f,lineJoin:y,lineWidth:m,miterLimit:v,strokeStyle:C}}else this.textStrokeState_=null;var _=e.getFont(),S=e.getOffsetX(),E=e.getOffsetY(),x=e.getRotateWithView(),P=e.getRotation(),L=e.getScale(),w=e.getText(),R=e.getTextAlign(),A=e.getTextBaseline(),b=void 0!==_?_:ol.render.canvas.defaultFont,M=void 0!==R?R:ol.render.canvas.defaultTextAlign,I=void 0!==A?A:ol.render.canvas.defaultTextBaseline;if(this.textState_){var O=this.textState_;O.font=b;O.textAlign=M;O.textBaseline=I}else this.textState_={font:b,textAlign:M,textBaseline:I};this.text_=void 0!==w?w:"";this.textOffsetX_=void 0!==S?S:0;this.textOffsetY_=void 0!==E?E:0;this.textRotateWithView_=void 0!==x?x:!1;this.textRotation_=void 0!==P?P:0;this.textScale_=void 0!==L?L:1}else this.text_=""};goog.provide("ol.render.canvas.ReplayGroup");goog.require("ol");goog.require("ol.array");goog.require("ol.dom");goog.require("ol.extent");goog.require("ol.geom.flat.transform");goog.require("ol.obj");goog.require("ol.render.ReplayGroup");goog.require("ol.render.canvas.ImageReplay");goog.require("ol.render.canvas.LineStringReplay");goog.require("ol.render.canvas.PolygonReplay");goog.require("ol.render.canvas.TextReplay");goog.require("ol.render.replay");goog.require("ol.transform");ol.render.canvas.ReplayGroup=function(e,t,o,r,i){ol.render.ReplayGroup.call(this);this.tolerance_=e;this.maxExtent_=t;this.overlaps_=r;this.resolution_=o;this.renderBuffer_=i;this.replaysByZIndex_={};this.hitDetectionContext_=ol.dom.createCanvasContext2D(1,1);this.hitDetectionTransform_=ol.transform.create()};ol.inherits(ol.render.canvas.ReplayGroup,ol.render.ReplayGroup);ol.render.canvas.ReplayGroup.circleArrayCache_={0:[[!0]]};ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_=function(e,t,o){var r,i=Math.floor(e.length/2);if(t>=i)for(r=i;t>r;r++)e[r][o]=!0;else if(i>t)for(r=t+1;i>r;r++)e[r][o]=!0};ol.render.canvas.ReplayGroup.getCircleArray_=function(e){if(void 0!==ol.render.canvas.ReplayGroup.circleArrayCache_[e])return ol.render.canvas.ReplayGroup.circleArrayCache_[e];for(var t=2*e+1,o=new Array(t),r=0;t>r;r++)o[r]=new Array(t);for(var i=e,n=0,a=0;i>=n;){ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_(o,e+i,e+n);ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_(o,e+n,e+i);ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_(o,e-n,e+i);ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_(o,e-i,e+n);ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_(o,e-i,e-n);ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_(o,e-n,e-i);ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_(o,e+n,e-i);ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_(o,e+i,e-n);n++;a+=1+2*n;if(2*(a-i)+1>0){i-=1;a+=1-2*i}}ol.render.canvas.ReplayGroup.circleArrayCache_[e]=o;return o};ol.render.canvas.ReplayGroup.prototype.finish=function(){var e;for(e in this.replaysByZIndex_){var t,o=this.replaysByZIndex_[e];for(t in o)o[t].finish()}};ol.render.canvas.ReplayGroup.prototype.forEachFeatureAtCoordinate=function(e,t,o,r,i,n){r=Math.round(r);var a=2*r+1,l=ol.transform.compose(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-o,-e[0],-e[1]),s=this.hitDetectionContext_;if(s.canvas.width!==a||s.canvas.height!==a){s.canvas.width=a;s.canvas.height=a}else s.clearRect(0,0,a,a);var p;if(void 0!==this.renderBuffer_){p=ol.extent.createEmpty();ol.extent.extendCoordinate(p,e);ol.extent.buffer(p,t*(this.renderBuffer_+r),p)}var c=ol.render.canvas.ReplayGroup.getCircleArray_(r);return this.replayHitDetection_(s,l,o,i,function(e){for(var t=s.getImageData(0,0,a,a).data,o=0;a>o;o++)for(var r=0;a>r;r++)if(c[o][r]&&t[4*(r*a+o)+3]>0){var i=n(e);if(i)return i;s.clearRect(0,0,a,a);return void 0}},p)};ol.render.canvas.ReplayGroup.prototype.getClipCoords=function(e){var t=this.maxExtent_,o=t[0],r=t[1],i=t[2],n=t[3],a=[o,r,o,n,i,n,i,r];ol.geom.flat.transform.transform2D(a,0,8,2,e,a);return a};ol.render.canvas.ReplayGroup.prototype.getReplay=function(e,t){var o=void 0!==e?e.toString():"0",r=this.replaysByZIndex_[o];if(void 0===r){r={};this.replaysByZIndex_[o]=r}var i=r[t];if(void 0===i){var n=ol.render.canvas.ReplayGroup.BATCH_CONSTRUCTORS_[t];i=new n(this.tolerance_,this.maxExtent_,this.resolution_,this.overlaps_);r[t]=i}return i};ol.render.canvas.ReplayGroup.prototype.isEmpty=function(){return ol.obj.isEmpty(this.replaysByZIndex_)};ol.render.canvas.ReplayGroup.prototype.replay=function(e,t,o,r,i,n){var a=Object.keys(this.replaysByZIndex_).map(Number);a.sort(ol.array.numberSafeCompareFunction);var l=this.getClipCoords(o);e.save();e.beginPath();e.moveTo(l[0],l[1]);e.lineTo(l[2],l[3]);e.lineTo(l[4],l[5]);e.lineTo(l[6],l[7]);e.clip();var s,p,c,u,g,d,h=n?n:ol.render.replay.ORDER;for(s=0,p=a.length;p>s;++s){g=this.replaysByZIndex_[a[s].toString()];for(c=0,u=h.length;u>c;++c){d=g[h[c]];void 0!==d&&d.replay(e,t,o,r,i)}}e.restore()};ol.render.canvas.ReplayGroup.prototype.replayHitDetection_=function(e,t,o,r,i,n){var a=Object.keys(this.replaysByZIndex_).map(Number);a.sort(function(e,t){return t-e});var l,s,p,c,u,g;for(l=0,s=a.length;s>l;++l){c=this.replaysByZIndex_[a[l].toString()];for(p=ol.render.replay.ORDER.length-1;p>=0;--p){u=c[ol.render.replay.ORDER[p]];if(void 0!==u){g=u.replayHitDetection(e,t,o,r,i,n);if(g)return g}}}return void 0};ol.render.canvas.ReplayGroup.BATCH_CONSTRUCTORS_={Circle:ol.render.canvas.PolygonReplay,Image:ol.render.canvas.ImageReplay,LineString:ol.render.canvas.LineStringReplay,Polygon:ol.render.canvas.PolygonReplay,Text:ol.render.canvas.TextReplay};goog.provide("ol.renderer.Layer");goog.require("ol");goog.require("ol.ImageState");goog.require("ol.Observable");goog.require("ol.TileState");goog.require("ol.asserts");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.functions");goog.require("ol.source.State");ol.renderer.Layer=function(e){ol.Observable.call(this);this.layer_=e};ol.inherits(ol.renderer.Layer,ol.Observable);ol.renderer.Layer.prototype.forEachFeatureAtCoordinate=ol.nullFunction;ol.renderer.Layer.prototype.hasFeatureAtCoordinate=ol.functions.FALSE;ol.renderer.Layer.prototype.createLoadedTileFinder=function(e,t,o){return function(r,i){function n(e){o[r]||(o[r]={});o[r][e.tileCoord.toString()]=e}return e.forEachLoadedTile(t,r,i,n)}};ol.renderer.Layer.prototype.getLayer=function(){return this.layer_};ol.renderer.Layer.prototype.handleImageChange_=function(e){var t=e.target;t.getState()===ol.ImageState.LOADED&&this.renderIfReadyAndVisible()};ol.renderer.Layer.prototype.loadImage=function(e){var t=e.getState();t!=ol.ImageState.LOADED&&t!=ol.ImageState.ERROR&&ol.events.listen(e,ol.events.EventType.CHANGE,this.handleImageChange_,this);if(t==ol.ImageState.IDLE){e.load();t=e.getState()}return t==ol.ImageState.LOADED};ol.renderer.Layer.prototype.renderIfReadyAndVisible=function(){var e=this.getLayer();e.getVisible()&&e.getSourceState()==ol.source.State.READY&&this.changed()};ol.renderer.Layer.prototype.scheduleExpireCache=function(e,t){if(t.canExpireCache()){var o=function(e,t,o){var r=ol.getUid(e).toString();e.expireCache(o.viewState.projection,o.usedTiles[r])}.bind(null,t);e.postRenderFunctions.push(o)}};ol.renderer.Layer.prototype.updateAttributions=function(e,t){if(t){var o,r,i;for(r=0,i=t.length;i>r;++r){o=t[r];e[ol.getUid(o).toString()]=o}}};ol.renderer.Layer.prototype.updateLogos=function(e,t){var o=t.getLogo();if(void 0!==o)if("string"==typeof o)e.logos[o]="";else if(o){ol.asserts.assert("string"==typeof o.href,44);ol.asserts.assert("string"==typeof o.src,45);e.logos[o.src]=o.href}};ol.renderer.Layer.prototype.updateUsedTiles=function(e,t,o,r){var i=ol.getUid(t).toString(),n=o.toString();if(i in e)n in e[i]?e[i][n].extend(r):e[i][n]=r;else{e[i]={};e[i][n]=r}};ol.renderer.Layer.prototype.manageTilePyramid=function(e,t,o,r,i,n,a,l,s,p){var c=ol.getUid(t).toString();c in e.wantedTiles||(e.wantedTiles[c]={});var u,g,d,h,f,y,m=e.wantedTiles[c],v=e.tileQueue,C=o.getMinZoom();for(y=a;y>=C;--y){g=o.getTileRangeForExtentAndZ(n,y,g);d=o.getResolution(y);for(h=g.minX;h<=g.maxX;++h)for(f=g.minY;f<=g.maxY;++f)if(l>=a-y){u=t.getTile(y,h,f,r,i);if(u.getState()==ol.TileState.IDLE){m[u.getKey()]=!0;v.isKeyQueued(u.getKey())||v.enqueue([u,c,o.getTileCoordCenter(u.tileCoord),d])}void 0!==s&&s.call(p,u)}else t.useTile(y,h,f,i)}};goog.provide("ol.renderer.canvas.Layer");goog.require("ol");goog.require("ol.extent");goog.require("ol.functions");goog.require("ol.render.Event");goog.require("ol.render.EventType");goog.require("ol.render.canvas");goog.require("ol.render.canvas.Immediate");goog.require("ol.renderer.Layer");goog.require("ol.transform");ol.renderer.canvas.Layer=function(e){ol.renderer.Layer.call(this,e);this.renderedResolution;this.transform_=ol.transform.create()};ol.inherits(ol.renderer.canvas.Layer,ol.renderer.Layer);ol.renderer.canvas.Layer.prototype.clip=function(e,t,o){var r=t.pixelRatio,i=t.size[0]*r,n=t.size[1]*r,a=t.viewState.rotation,l=ol.extent.getTopLeft(o),s=ol.extent.getTopRight(o),p=ol.extent.getBottomRight(o),c=ol.extent.getBottomLeft(o);ol.transform.apply(t.coordinateToPixelTransform,l);ol.transform.apply(t.coordinateToPixelTransform,s);ol.transform.apply(t.coordinateToPixelTransform,p);ol.transform.apply(t.coordinateToPixelTransform,c);e.save();ol.render.canvas.rotateAtOffset(e,-a,i/2,n/2);e.beginPath();e.moveTo(l[0]*r,l[1]*r);e.lineTo(s[0]*r,s[1]*r);e.lineTo(p[0]*r,p[1]*r);e.lineTo(c[0]*r,c[1]*r);e.clip();ol.render.canvas.rotateAtOffset(e,a,i/2,n/2)};ol.renderer.canvas.Layer.prototype.dispatchComposeEvent_=function(e,t,o,r){var i=this.getLayer();if(i.hasListener(e)){var n=o.size[0]*o.pixelRatio,a=o.size[1]*o.pixelRatio,l=o.viewState.rotation;ol.render.canvas.rotateAtOffset(t,-l,n/2,a/2);var s=void 0!==r?r:this.getTransform(o,0),p=new ol.render.canvas.Immediate(t,o.pixelRatio,o.extent,s,o.viewState.rotation),c=new ol.render.Event(e,p,o,t,null);i.dispatchEvent(c);ol.render.canvas.rotateAtOffset(t,l,n/2,a/2)}};ol.renderer.canvas.Layer.prototype.forEachLayerAtCoordinate=function(e,t,o,r){var i=this.forEachFeatureAtCoordinate(e,t,0,ol.functions.TRUE,this);return i?o.call(r,this.getLayer(),null):void 0};ol.renderer.canvas.Layer.prototype.postCompose=function(e,t,o,r){this.dispatchComposeEvent_(ol.render.EventType.POSTCOMPOSE,e,t,r)};ol.renderer.canvas.Layer.prototype.preCompose=function(e,t,o){this.dispatchComposeEvent_(ol.render.EventType.PRECOMPOSE,e,t,o)};ol.renderer.canvas.Layer.prototype.dispatchRenderEvent=function(e,t,o){this.dispatchComposeEvent_(ol.render.EventType.RENDER,e,t,o)};ol.renderer.canvas.Layer.prototype.getTransform=function(e,t){var o=e.viewState,r=e.pixelRatio,i=r*e.size[0]/2,n=r*e.size[1]/2,a=r/o.resolution,l=-a,s=-o.rotation,p=-o.center[0]+t,c=-o.center[1];return ol.transform.compose(this.transform_,i,n,a,l,s,p,c)};ol.renderer.canvas.Layer.prototype.composeFrame=function(e,t,o){};ol.renderer.canvas.Layer.prototype.prepareFrame=function(e,t){};goog.provide("ol.renderer.vector");goog.require("ol");goog.require("ol.ImageState");goog.require("ol.render.ReplayType");ol.renderer.vector.defaultOrder=function(e,t){return ol.getUid(e)-ol.getUid(t)};ol.renderer.vector.getSquaredTolerance=function(e,t){var o=ol.renderer.vector.getTolerance(e,t);return o*o};ol.renderer.vector.getTolerance=function(e,t){return ol.SIMPLIFY_TOLERANCE*e/t};ol.renderer.vector.renderCircleGeometry_=function(e,t,o,r){var i=o.getFill(),n=o.getStroke();if(i||n){var a=e.getReplay(o.getZIndex(),ol.render.ReplayType.CIRCLE);a.setFillStrokeStyle(i,n);a.drawCircle(t,r)}var l=o.getText();if(l){var s=e.getReplay(o.getZIndex(),ol.render.ReplayType.TEXT);s.setTextStyle(l);s.drawText(t.getCenter(),0,2,2,t,r)}};ol.renderer.vector.renderFeature=function(e,t,o,r,i,n){var a,l,s=!1;a=o.getImage();if(a){l=a.getImageState();if(l==ol.ImageState.LOADED||l==ol.ImageState.ERROR)a.unlistenImageChange(i,n);else{l==ol.ImageState.IDLE&&a.load();l=a.getImageState();a.listenImageChange(i,n);s=!0}}ol.renderer.vector.renderFeature_(e,t,o,r);return s};ol.renderer.vector.renderFeature_=function(e,t,o,r){var i=o.getGeometryFunction()(t);if(i){var n=i.getSimplifiedGeometry(r),a=ol.renderer.vector.GEOMETRY_RENDERERS_[n.getType()];a(e,n,o,t)}};ol.renderer.vector.renderGeometryCollectionGeometry_=function(e,t,o,r){var i,n,a=t.getGeometriesArray();for(i=0,n=a.length;n>i;++i){var l=ol.renderer.vector.GEOMETRY_RENDERERS_[a[i].getType()];l(e,a[i],o,r)}};ol.renderer.vector.renderLineStringGeometry_=function(e,t,o,r){var i=o.getStroke();if(i){var n=e.getReplay(o.getZIndex(),ol.render.ReplayType.LINE_STRING);n.setFillStrokeStyle(null,i);n.drawLineString(t,r)}var a=o.getText();if(a){var l=e.getReplay(o.getZIndex(),ol.render.ReplayType.TEXT);l.setTextStyle(a);l.drawText(t.getFlatMidpoint(),0,2,2,t,r)}};ol.renderer.vector.renderMultiLineStringGeometry_=function(e,t,o,r){var i=o.getStroke();if(i){var n=e.getReplay(o.getZIndex(),ol.render.ReplayType.LINE_STRING);n.setFillStrokeStyle(null,i);n.drawMultiLineString(t,r)}var a=o.getText();if(a){var l=e.getReplay(o.getZIndex(),ol.render.ReplayType.TEXT);l.setTextStyle(a);var s=t.getFlatMidpoints();l.drawText(s,0,s.length,2,t,r)}};ol.renderer.vector.renderMultiPolygonGeometry_=function(e,t,o,r){var i=o.getFill(),n=o.getStroke();if(n||i){var a=e.getReplay(o.getZIndex(),ol.render.ReplayType.POLYGON);a.setFillStrokeStyle(i,n);a.drawMultiPolygon(t,r)}var l=o.getText();if(l){var s=e.getReplay(o.getZIndex(),ol.render.ReplayType.TEXT);s.setTextStyle(l);var p=t.getFlatInteriorPoints();s.drawText(p,0,p.length,2,t,r)}};ol.renderer.vector.renderPointGeometry_=function(e,t,o,r){var i=o.getImage();if(i){if(i.getImageState()!=ol.ImageState.LOADED)return;var n=e.getReplay(o.getZIndex(),ol.render.ReplayType.IMAGE);n.setImageStyle(i);n.drawPoint(t,r)}var a=o.getText();if(a){var l=e.getReplay(o.getZIndex(),ol.render.ReplayType.TEXT);l.setTextStyle(a);l.drawText(t.getFlatCoordinates(),0,2,2,t,r)}};ol.renderer.vector.renderMultiPointGeometry_=function(e,t,o,r){var i=o.getImage();if(i){if(i.getImageState()!=ol.ImageState.LOADED)return;var n=e.getReplay(o.getZIndex(),ol.render.ReplayType.IMAGE);n.setImageStyle(i);n.drawMultiPoint(t,r)}var a=o.getText();if(a){var l=e.getReplay(o.getZIndex(),ol.render.ReplayType.TEXT);l.setTextStyle(a);var s=t.getFlatCoordinates();l.drawText(s,0,s.length,t.getStride(),t,r)}};ol.renderer.vector.renderPolygonGeometry_=function(e,t,o,r){var i=o.getFill(),n=o.getStroke();if(i||n){var a=e.getReplay(o.getZIndex(),ol.render.ReplayType.POLYGON);a.setFillStrokeStyle(i,n);

a.drawPolygon(t,r)}var l=o.getText();if(l){var s=e.getReplay(o.getZIndex(),ol.render.ReplayType.TEXT);s.setTextStyle(l);s.drawText(t.getFlatInteriorPoint(),0,2,2,t,r)}};ol.renderer.vector.GEOMETRY_RENDERERS_={Point:ol.renderer.vector.renderPointGeometry_,LineString:ol.renderer.vector.renderLineStringGeometry_,Polygon:ol.renderer.vector.renderPolygonGeometry_,MultiPoint:ol.renderer.vector.renderMultiPointGeometry_,MultiLineString:ol.renderer.vector.renderMultiLineStringGeometry_,MultiPolygon:ol.renderer.vector.renderMultiPolygonGeometry_,GeometryCollection:ol.renderer.vector.renderGeometryCollectionGeometry_,Circle:ol.renderer.vector.renderCircleGeometry_};goog.provide("ol.renderer.canvas.VectorLayer");goog.require("ol");goog.require("ol.ViewHint");goog.require("ol.dom");goog.require("ol.extent");goog.require("ol.render.EventType");goog.require("ol.render.canvas");goog.require("ol.render.canvas.ReplayGroup");goog.require("ol.renderer.canvas.Layer");goog.require("ol.renderer.vector");ol.renderer.canvas.VectorLayer=function(e){ol.renderer.canvas.Layer.call(this,e);this.dirty_=!1;this.renderedRevision_=-1;this.renderedResolution_=0/0;this.renderedExtent_=ol.extent.createEmpty();this.renderedRenderOrder_=null;this.replayGroup_=null;this.context_=ol.dom.createCanvasContext2D()};ol.inherits(ol.renderer.canvas.VectorLayer,ol.renderer.canvas.Layer);ol.renderer.canvas.VectorLayer.prototype.composeFrame=function(e,t,o){var r=e.extent,i=e.pixelRatio,n=t.managed?e.skippedFeatureUids:{},a=e.viewState,l=a.projection,s=a.rotation,p=l.getExtent(),c=this.getLayer().getSource(),u=this.getTransform(e,0);this.preCompose(o,e,u);var g=t.extent,d=void 0!==g;d&&this.clip(o,e,g);var h=this.replayGroup_;if(h&&!h.isEmpty()){var f,y=this.getLayer(),m=0,v=0;if(y.hasListener(ol.render.EventType.RENDER)){var C=o.canvas.width,T=o.canvas.height;if(s){var _=Math.round(Math.sqrt(C*C+T*T));m=(_-C)/2;v=(_-T)/2;C=T=_}this.context_.canvas.width=C;this.context_.canvas.height=T;f=this.context_}else f=o;var S=f.globalAlpha;f.globalAlpha=t.opacity;f!=o&&f.translate(m,v);var E=e.size[0]*i,x=e.size[1]*i;ol.render.canvas.rotateAtOffset(f,-s,E/2,x/2);h.replay(f,i,u,s,n);if(c.getWrapX()&&l.canWrapX()&&!ol.extent.containsExtent(p,r)){for(var P,L=r[0],w=ol.extent.getWidth(p),R=0;L<p[0];){--R;P=w*R;u=this.getTransform(e,P);h.replay(f,i,u,s,n);L+=w}R=0;L=r[2];for(;L>p[2];){++R;P=w*R;u=this.getTransform(e,P);h.replay(f,i,u,s,n);L-=w}u=this.getTransform(e,0)}ol.render.canvas.rotateAtOffset(f,s,E/2,x/2);if(f!=o){this.dispatchRenderEvent(f,e,u);o.drawImage(f.canvas,-m,-v);f.translate(-m,-v)}f.globalAlpha=S}d&&o.restore();this.postCompose(o,e,t,u)};ol.renderer.canvas.VectorLayer.prototype.forEachFeatureAtCoordinate=function(e,t,o,r,i){if(this.replayGroup_){var n=t.viewState.resolution,a=t.viewState.rotation,l=this.getLayer(),s={};return this.replayGroup_.forEachFeatureAtCoordinate(e,n,a,o,{},function(e){var t=ol.getUid(e).toString();if(!(t in s)){s[t]=!0;return r.call(i,e,l)}})}return void 0};ol.renderer.canvas.VectorLayer.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()};ol.renderer.canvas.VectorLayer.prototype.prepareFrame=function(e,t){var o=this.getLayer(),r=o.getSource();this.updateAttributions(e.attributions,r.getAttributions());this.updateLogos(e,r);var i=e.viewHints[ol.ViewHint.ANIMATING],n=e.viewHints[ol.ViewHint.INTERACTING],a=o.getUpdateWhileAnimating(),l=o.getUpdateWhileInteracting();if(!this.dirty_&&!a&&i||!l&&n)return!0;var s=e.extent,p=e.viewState,c=p.projection,u=p.resolution,g=e.pixelRatio,d=o.getRevision(),h=o.getRenderBuffer(),f=o.getRenderOrder();void 0===f&&(f=ol.renderer.vector.defaultOrder);var y=ol.extent.buffer(s,h*u),m=p.projection.getExtent();if(r.getWrapX()&&p.projection.canWrapX()&&!ol.extent.containsExtent(m,e.extent)){var v=ol.extent.getWidth(m),C=Math.max(ol.extent.getWidth(y)/2,v);y[0]=m[0]-C;y[2]=m[2]+C}if(!this.dirty_&&this.renderedResolution_==u&&this.renderedRevision_==d&&this.renderedRenderOrder_==f&&ol.extent.containsExtent(this.renderedExtent_,y))return!0;this.replayGroup_=null;this.dirty_=!1;var T=new ol.render.canvas.ReplayGroup(ol.renderer.vector.getTolerance(u,g),y,u,r.getOverlaps(),o.getRenderBuffer());r.loadFeatures(y,u,c);var _=function(e){var t,r=e.getStyleFunction();if(r)t=r.call(e,u);else{r=o.getStyleFunction();r&&(t=r(e,u))}if(t){var i=this.renderFeature(e,u,g,t,T);this.dirty_=this.dirty_||i}};if(f){var S=[];r.forEachFeatureInExtent(y,function(e){S.push(e)},this);S.sort(f);S.forEach(_,this)}else r.forEachFeatureInExtent(y,_,this);T.finish();this.renderedResolution_=u;this.renderedRevision_=d;this.renderedRenderOrder_=f;this.renderedExtent_=y;this.replayGroup_=T;return!0};ol.renderer.canvas.VectorLayer.prototype.renderFeature=function(e,t,o,r,i){if(!r)return!1;var n=!1;if(Array.isArray(r))for(var a=0,l=r.length;l>a;++a)n=ol.renderer.vector.renderFeature(i,e,r[a],ol.renderer.vector.getSquaredTolerance(t,o),this.handleStyleImageChange_,this)||n;else n=ol.renderer.vector.renderFeature(i,e,r,ol.renderer.vector.getSquaredTolerance(t,o),this.handleStyleImageChange_,this)||n;return n};goog.provide("ol.renderer.webgl.defaultmapshader");goog.require("ol");goog.require("ol.webgl.Fragment");goog.require("ol.webgl.Vertex");if(ol.ENABLE_WEBGL){ol.renderer.webgl.defaultmapshader.Fragment=function(){ol.webgl.Fragment.call(this,ol.renderer.webgl.defaultmapshader.Fragment.SOURCE)};ol.inherits(ol.renderer.webgl.defaultmapshader.Fragment,ol.webgl.Fragment);ol.renderer.webgl.defaultmapshader.Fragment.DEBUG_SOURCE="precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform float u_opacity;\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_texture, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  gl_FragColor.a = texColor.a * u_opacity;\n}\n";ol.renderer.webgl.defaultmapshader.Fragment.OPTIMIZED_SOURCE="precision mediump float;varying vec2 a;uniform float f;uniform sampler2D g;void main(void){vec4 texColor=texture2D(g,a);gl_FragColor.rgb=texColor.rgb;gl_FragColor.a=texColor.a*f;}";ol.renderer.webgl.defaultmapshader.Fragment.SOURCE=ol.DEBUG_WEBGL?ol.renderer.webgl.defaultmapshader.Fragment.DEBUG_SOURCE:ol.renderer.webgl.defaultmapshader.Fragment.OPTIMIZED_SOURCE;ol.renderer.webgl.defaultmapshader.fragment=new ol.renderer.webgl.defaultmapshader.Fragment;ol.renderer.webgl.defaultmapshader.Vertex=function(){ol.webgl.Vertex.call(this,ol.renderer.webgl.defaultmapshader.Vertex.SOURCE)};ol.inherits(ol.renderer.webgl.defaultmapshader.Vertex,ol.webgl.Vertex);ol.renderer.webgl.defaultmapshader.Vertex.DEBUG_SOURCE="varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform mat4 u_texCoordMatrix;\nuniform mat4 u_projectionMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.);\n  v_texCoord = (u_texCoordMatrix * vec4(a_texCoord, 0., 1.)).st;\n}\n\n\n";ol.renderer.webgl.defaultmapshader.Vertex.OPTIMIZED_SOURCE="varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}";ol.renderer.webgl.defaultmapshader.Vertex.SOURCE=ol.DEBUG_WEBGL?ol.renderer.webgl.defaultmapshader.Vertex.DEBUG_SOURCE:ol.renderer.webgl.defaultmapshader.Vertex.OPTIMIZED_SOURCE;ol.renderer.webgl.defaultmapshader.vertex=new ol.renderer.webgl.defaultmapshader.Vertex;ol.renderer.webgl.defaultmapshader.Locations=function(e,t){this.u_opacity=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_opacity":"f");this.u_projectionMatrix=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_projectionMatrix":"e");this.u_texCoordMatrix=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_texCoordMatrix":"d");this.u_texture=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_texture":"g");this.a_position=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_position":"b");this.a_texCoord=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_texCoord":"c")}}goog.provide("ol.renderer.webgl.Layer");goog.require("ol");goog.require("ol.render.Event");goog.require("ol.render.EventType");goog.require("ol.render.webgl.Immediate");goog.require("ol.renderer.Layer");goog.require("ol.renderer.webgl.defaultmapshader");goog.require("ol.transform");goog.require("ol.vec.Mat4");goog.require("ol.webgl");goog.require("ol.webgl.Buffer");goog.require("ol.webgl.Context");if(ol.ENABLE_WEBGL){ol.renderer.webgl.Layer=function(e,t){ol.renderer.Layer.call(this,t);this.mapRenderer=e;this.arrayBuffer_=new ol.webgl.Buffer([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]);this.texture=null;this.framebuffer=null;this.framebufferDimension=void 0;this.texCoordMatrix=ol.transform.create();this.projectionMatrix=ol.transform.create();this.tmpMat4_=ol.vec.Mat4.create();this.defaultLocations_=null};ol.inherits(ol.renderer.webgl.Layer,ol.renderer.Layer);ol.renderer.webgl.Layer.prototype.bindFramebuffer=function(e,t){var o=this.mapRenderer.getGL();if(void 0===this.framebufferDimension||this.framebufferDimension!=t){var r=function(e,t,o){if(!e.isContextLost()){e.deleteFramebuffer(t);e.deleteTexture(o)}}.bind(null,o,this.framebuffer,this.texture);e.postRenderFunctions.push(r);var i=ol.webgl.Context.createEmptyTexture(o,t,t),n=o.createFramebuffer();o.bindFramebuffer(ol.webgl.FRAMEBUFFER,n);o.framebufferTexture2D(ol.webgl.FRAMEBUFFER,ol.webgl.COLOR_ATTACHMENT0,ol.webgl.TEXTURE_2D,i,0);this.texture=i;this.framebuffer=n;this.framebufferDimension=t}else o.bindFramebuffer(ol.webgl.FRAMEBUFFER,this.framebuffer)};ol.renderer.webgl.Layer.prototype.composeFrame=function(e,t,o){this.dispatchComposeEvent_(ol.render.EventType.PRECOMPOSE,o,e);o.bindBuffer(ol.webgl.ARRAY_BUFFER,this.arrayBuffer_);var r,i=o.getGL(),n=ol.renderer.webgl.defaultmapshader.fragment,a=ol.renderer.webgl.defaultmapshader.vertex,l=o.getProgram(n,a);if(this.defaultLocations_)r=this.defaultLocations_;else{r=new ol.renderer.webgl.defaultmapshader.Locations(i,l);this.defaultLocations_=r}if(o.useProgram(l)){i.enableVertexAttribArray(r.a_position);i.vertexAttribPointer(r.a_position,2,ol.webgl.FLOAT,!1,16,0);i.enableVertexAttribArray(r.a_texCoord);i.vertexAttribPointer(r.a_texCoord,2,ol.webgl.FLOAT,!1,16,8);i.uniform1i(r.u_texture,0)}i.uniformMatrix4fv(r.u_texCoordMatrix,!1,ol.vec.Mat4.fromTransform(this.tmpMat4_,this.getTexCoordMatrix()));i.uniformMatrix4fv(r.u_projectionMatrix,!1,ol.vec.Mat4.fromTransform(this.tmpMat4_,this.getProjectionMatrix()));i.uniform1f(r.u_opacity,t.opacity);i.bindTexture(ol.webgl.TEXTURE_2D,this.getTexture());i.drawArrays(ol.webgl.TRIANGLE_STRIP,0,4);this.dispatchComposeEvent_(ol.render.EventType.POSTCOMPOSE,o,e)};ol.renderer.webgl.Layer.prototype.dispatchComposeEvent_=function(e,t,o){var r=this.getLayer();if(r.hasListener(e)){var i=o.viewState,n=i.resolution,a=o.pixelRatio,l=o.extent,s=i.center,p=i.rotation,c=o.size,u=new ol.render.webgl.Immediate(t,s,n,p,c,l,a),g=new ol.render.Event(e,u,o,null,t);r.dispatchEvent(g)}};ol.renderer.webgl.Layer.prototype.getTexCoordMatrix=function(){return this.texCoordMatrix};ol.renderer.webgl.Layer.prototype.getTexture=function(){return this.texture};ol.renderer.webgl.Layer.prototype.getProjectionMatrix=function(){return this.projectionMatrix};ol.renderer.webgl.Layer.prototype.handleWebGLContextLost=function(){this.texture=null;this.framebuffer=null;this.framebufferDimension=void 0};ol.renderer.webgl.Layer.prototype.prepareFrame=function(e,t,o){};ol.renderer.webgl.Layer.prototype.forEachLayerAtPixel=function(e,t,o,r){}}goog.provide("ol.renderer.webgl.VectorLayer");goog.require("ol");goog.require("ol.ViewHint");goog.require("ol.extent");goog.require("ol.render.webgl.ReplayGroup");goog.require("ol.renderer.vector");goog.require("ol.renderer.webgl.Layer");goog.require("ol.transform");if(ol.ENABLE_WEBGL){ol.renderer.webgl.VectorLayer=function(e,t){ol.renderer.webgl.Layer.call(this,e,t);this.dirty_=!1;this.renderedRevision_=-1;this.renderedResolution_=0/0;this.renderedExtent_=ol.extent.createEmpty();this.renderedRenderOrder_=null;this.replayGroup_=null;this.layerState_=null};ol.inherits(ol.renderer.webgl.VectorLayer,ol.renderer.webgl.Layer);ol.renderer.webgl.VectorLayer.prototype.composeFrame=function(e,t,o){this.layerState_=t;var r=e.viewState,i=this.replayGroup_,n=e.size,a=e.pixelRatio,l=this.mapRenderer.getGL();if(i&&!i.isEmpty()){l.enable(l.SCISSOR_TEST);l.scissor(0,0,n[0]*a,n[1]*a);i.replay(o,r.center,r.resolution,r.rotation,n,a,t.opacity,t.managed?e.skippedFeatureUids:{});l.disable(l.SCISSOR_TEST)}};ol.renderer.webgl.VectorLayer.prototype.disposeInternal=function(){var e=this.replayGroup_;if(e){var t=this.mapRenderer.getContext();e.getDeleteResourcesFunction(t)();this.replayGroup_=null}ol.renderer.webgl.Layer.prototype.disposeInternal.call(this)};ol.renderer.webgl.VectorLayer.prototype.forEachFeatureAtCoordinate=function(e,t,o,r,i){if(this.replayGroup_&&this.layerState_){var n=this.mapRenderer.getContext(),a=t.viewState,l=this.getLayer(),s=this.layerState_,p={};return this.replayGroup_.forEachFeatureAtCoordinate(e,n,a.center,a.resolution,a.rotation,t.size,t.pixelRatio,s.opacity,{},function(e){var t=ol.getUid(e).toString();if(!(t in p)){p[t]=!0;return r.call(i,e,l)}})}return void 0};ol.renderer.webgl.VectorLayer.prototype.hasFeatureAtCoordinate=function(e,t){if(this.replayGroup_&&this.layerState_){var o=this.mapRenderer.getContext(),r=t.viewState,i=this.layerState_;return this.replayGroup_.hasFeatureAtCoordinate(e,o,r.center,r.resolution,r.rotation,t.size,t.pixelRatio,i.opacity,t.skippedFeatureUids)}return!1};ol.renderer.webgl.VectorLayer.prototype.forEachLayerAtPixel=function(e,t,o,r){var i=ol.transform.apply(t.pixelToCoordinateTransform,e.slice()),n=this.hasFeatureAtCoordinate(i,t);return n?o.call(r,this.getLayer(),null):void 0};ol.renderer.webgl.VectorLayer.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()};ol.renderer.webgl.VectorLayer.prototype.prepareFrame=function(e,t,o){var r=this.getLayer(),i=r.getSource();this.updateAttributions(e.attributions,i.getAttributions());this.updateLogos(e,i);var n=e.viewHints[ol.ViewHint.ANIMATING],a=e.viewHints[ol.ViewHint.INTERACTING],l=r.getUpdateWhileAnimating(),s=r.getUpdateWhileInteracting();if(!this.dirty_&&!l&&n||!s&&a)return!0;var p=e.extent,c=e.viewState,u=c.projection,g=c.resolution,d=e.pixelRatio,h=r.getRevision(),f=r.getRenderBuffer(),y=r.getRenderOrder();void 0===y&&(y=ol.renderer.vector.defaultOrder);var m=ol.extent.buffer(p,f*g);if(!this.dirty_&&this.renderedResolution_==g&&this.renderedRevision_==h&&this.renderedRenderOrder_==y&&ol.extent.containsExtent(this.renderedExtent_,m))return!0;this.replayGroup_&&e.postRenderFunctions.push(this.replayGroup_.getDeleteResourcesFunction(o));this.dirty_=!1;var v=new ol.render.webgl.ReplayGroup(ol.renderer.vector.getTolerance(g,d),m,r.getRenderBuffer());i.loadFeatures(m,g,u);var C=function(e){var t,o=e.getStyleFunction();if(o)t=o.call(e,g);else{o=r.getStyleFunction();o&&(t=o(e,g))}if(t){var i=this.renderFeature(e,g,d,t,v);this.dirty_=this.dirty_||i}};if(y){var T=[];i.forEachFeatureInExtent(m,function(e){T.push(e)},this);T.sort(y);T.forEach(C,this)}else i.forEachFeatureInExtent(m,C,this);v.finish(o);this.renderedResolution_=g;this.renderedRevision_=h;this.renderedRenderOrder_=y;this.renderedExtent_=m;this.replayGroup_=v;return!0};ol.renderer.webgl.VectorLayer.prototype.renderFeature=function(e,t,o,r,i){if(!r)return!1;var n=!1;if(Array.isArray(r))for(var a=r.length-1,l=0;a>=l;--a)n=ol.renderer.vector.renderFeature(i,e,r[a],ol.renderer.vector.getSquaredTolerance(t,o),this.handleStyleImageChange_,this)||n;else n=ol.renderer.vector.renderFeature(i,e,r,ol.renderer.vector.getSquaredTolerance(t,o),this.handleStyleImageChange_,this)||n;return n}}goog.provide("ol.layer.Vector");goog.require("ol");goog.require("ol.layer.Layer");goog.require("ol.obj");goog.require("ol.renderer.Type");goog.require("ol.renderer.canvas.VectorLayer");goog.require("ol.renderer.webgl.VectorLayer");goog.require("ol.style.Style");ol.layer.Vector=function(e){var t=e?e:{},o=ol.obj.assign({},t);delete o.style;delete o.renderBuffer;delete o.updateWhileAnimating;delete o.updateWhileInteracting;ol.layer.Layer.call(this,o);this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100;this.style_=null;this.styleFunction_=void 0;this.setStyle(t.style);this.updateWhileAnimating_=void 0!==t.updateWhileAnimating?t.updateWhileAnimating:!1;this.updateWhileInteracting_=void 0!==t.updateWhileInteracting?t.updateWhileInteracting:!1};ol.inherits(ol.layer.Vector,ol.layer.Layer);ol.layer.Vector.prototype.createRenderer=function(e){var t=null,o=e.getType();ol.ENABLE_CANVAS&&o===ol.renderer.Type.CANVAS?t=new ol.renderer.canvas.VectorLayer(this):ol.ENABLE_WEBGL&&o===ol.renderer.Type.WEBGL&&(t=new ol.renderer.webgl.VectorLayer(e,this));return t};ol.layer.Vector.prototype.getRenderBuffer=function(){return this.renderBuffer_};ol.layer.Vector.prototype.getRenderOrder=function(){return this.get(ol.layer.Vector.Property_.RENDER_ORDER)};ol.layer.Vector.prototype.getSource;ol.layer.Vector.prototype.getStyle=function(){return this.style_};ol.layer.Vector.prototype.getStyleFunction=function(){return this.styleFunction_};ol.layer.Vector.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_};ol.layer.Vector.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_};ol.layer.Vector.prototype.setRenderOrder=function(e){this.set(ol.layer.Vector.Property_.RENDER_ORDER,e)};ol.layer.Vector.prototype.setStyle=function(e){this.style_=void 0!==e?e:ol.style.Style.defaultFunction;this.styleFunction_=null===e?void 0:ol.style.Style.createFunction(this.style_);this.changed()};ol.layer.Vector.Property_={RENDER_ORDER:"renderOrder"};goog.provide("ol.loadingstrategy");ol.loadingstrategy.all=function(e,t){return[[-(1/0),-(1/0),1/0,1/0]]};ol.loadingstrategy.bbox=function(e,t){return[e]};ol.loadingstrategy.tile=function(e){return function(t,o){var r=e.getZForResolution(o),i=e.getTileRangeForExtentAndZ(t,r),n=[],a=[r,0,0];for(a[1]=i.minX;a[1]<=i.maxX;++a[1])for(a[2]=i.minY;a[2]<=i.maxY;++a[2])n.push(e.getTileCoordExtent(a));return n}};goog.provide("ol.source.Source");goog.require("ol");goog.require("ol.Attribution");goog.require("ol.Object");goog.require("ol.proj");goog.require("ol.source.State");ol.source.Source=function(e){ol.Object.call(this);this.projection_=ol.proj.get(e.projection);this.attributions_=ol.source.Source.toAttributionsArray_(e.attributions);this.logo_=e.logo;this.state_=void 0!==e.state?e.state:ol.source.State.READY;this.wrapX_=void 0!==e.wrapX?e.wrapX:!1};ol.inherits(ol.source.Source,ol.Object);ol.source.Source.toAttributionsArray_=function(e){if("string"==typeof e)return[new ol.Attribution({html:e})];if(e instanceof ol.Attribution)return[e];if(Array.isArray(e)){for(var t=e.length,o=new Array(t),r=0;t>r;r++){var i=e[r];o[r]="string"==typeof i?new ol.Attribution({html:i}):i}return o}return null};ol.source.Source.prototype.forEachFeatureAtCoordinate=ol.nullFunction;ol.source.Source.prototype.getAttributions=function(){return this.attributions_};ol.source.Source.prototype.getLogo=function(){return this.logo_};ol.source.Source.prototype.getProjection=function(){return this.projection_};ol.source.Source.prototype.getResolutions=function(){};ol.source.Source.prototype.getState=function(){return this.state_};ol.source.Source.prototype.getWrapX=function(){return this.wrapX_};ol.source.Source.prototype.refresh=function(){this.changed()};ol.source.Source.prototype.setAttributions=function(e){this.attributions_=ol.source.Source.toAttributionsArray_(e);this.changed()};ol.source.Source.prototype.setLogo=function(e){this.logo_=e};ol.source.Source.prototype.setState=function(e){this.state_=e;this.changed()};goog.provide("ol.source.VectorEventType");ol.source.VectorEventType={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"};goog.provide("ol.source.Vector");goog.require("ol");goog.require("ol.Collection");goog.require("ol.CollectionEventType");goog.require("ol.ObjectEventType");goog.require("ol.array");goog.require("ol.asserts");goog.require("ol.events");goog.require("ol.events.Event");goog.require("ol.events.EventType");goog.require("ol.extent");goog.require("ol.featureloader");goog.require("ol.functions");goog.require("ol.loadingstrategy");goog.require("ol.obj");goog.require("ol.source.Source");goog.require("ol.source.State");goog.require("ol.source.VectorEventType");goog.require("ol.structs.RBush");ol.source.Vector=function(e){var t=e||{};ol.source.Source.call(this,{attributions:t.attributions,logo:t.logo,projection:void 0,state:ol.source.State.READY,wrapX:void 0!==t.wrapX?t.wrapX:!0});this.loader_=ol.nullFunction;this.format_=t.format;this.overlaps_=void 0==t.overlaps?!0:t.overlaps;this.url_=t.url;if(void 0!==t.loader)this.loader_=t.loader;else if(void 0!==this.url_){ol.asserts.assert(this.format_,7);this.loader_=ol.featureloader.xhr(this.url_,this.format_)}this.strategy_=void 0!==t.strategy?t.strategy:ol.loadingstrategy.all;var o=void 0!==t.useSpatialIndex?t.useSpatialIndex:!0;this.featuresRtree_=o?new ol.structs.RBush:null;this.loadedExtentsRtree_=new ol.structs.RBush;this.nullGeometryFeatures_={};this.idIndex_={};this.undefIdIndex_={};this.featureChangeKeys_={};this.featuresCollection_=null;var r,i;if(t.features instanceof ol.Collection){r=t.features;i=r.getArray()}else Array.isArray(t.features)&&(i=t.features);o||void 0!==r||(r=new ol.Collection(i));void 0!==i&&this.addFeaturesInternal(i);void 0!==r&&this.bindFeaturesCollection_(r)};ol.inherits(ol.source.Vector,ol.source.Source);ol.source.Vector.prototype.addFeature=function(e){this.addFeatureInternal(e);this.changed()};ol.source.Vector.prototype.addFeatureInternal=function(e){var t=ol.getUid(e).toString();if(this.addToIndex_(t,e)){this.setupChangeEvents_(t,e);var o=e.getGeometry();if(o){var r=o.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new ol.source.Vector.Event(ol.source.VectorEventType.ADDFEATURE,e))}};ol.source.Vector.prototype.setupChangeEvents_=function(e,t){this.featureChangeKeys_[e]=[ol.events.listen(t,ol.events.EventType.CHANGE,this.handleFeatureChange_,this),ol.events.listen(t,ol.ObjectEventType.PROPERTYCHANGE,this.handleFeatureChange_,this)]};ol.source.Vector.prototype.addToIndex_=function(e,t){var o=!0,r=t.getId();if(void 0!==r)r.toString()in this.idIndex_?o=!1:this.idIndex_[r.toString()]=t;else{ol.asserts.assert(!(e in this.undefIdIndex_),30);this.undefIdIndex_[e]=t}return o};ol.source.Vector.prototype.addFeatures=function(e){this.addFeaturesInternal(e);this.changed()};ol.source.Vector.prototype.addFeaturesInternal=function(e){var t,o,r,i,n=[],a=[],l=[];for(o=0,r=e.length;r>o;o++){i=e[o];t=ol.getUid(i).toString();this.addToIndex_(t,i)&&a.push(i)}for(o=0,r=a.length;r>o;o++){i=a[o];t=ol.getUid(i).toString();this.setupChangeEvents_(t,i);var s=i.getGeometry();if(s){var p=s.getExtent();n.push(p);l.push(i)}else this.nullGeometryFeatures_[t]=i}this.featuresRtree_&&this.featuresRtree_.load(n,l);for(o=0,r=a.length;r>o;o++)this.dispatchEvent(new ol.source.Vector.Event(ol.source.VectorEventType.ADDFEATURE,a[o]))};ol.source.Vector.prototype.bindFeaturesCollection_=function(e){var t=!1;ol.events.listen(this,ol.source.VectorEventType.ADDFEATURE,function(o){if(!t){t=!0;e.push(o.feature);t=!1}});ol.events.listen(this,ol.source.VectorEventType.REMOVEFEATURE,function(o){if(!t){t=!0;e.remove(o.feature);t=!1}});ol.events.listen(e,ol.CollectionEventType.ADD,function(e){if(!t){t=!0;this.addFeature(e.element);t=!1}},this);ol.events.listen(e,ol.CollectionEventType.REMOVE,function(e){if(!t){t=!0;this.removeFeature(e.element);t=!1}},this);this.featuresCollection_=e};ol.source.Vector.prototype.clear=function(e){if(e){for(var t in this.featureChangeKeys_){var o=this.featureChangeKeys_[t];o.forEach(ol.events.unlistenByKey)}if(!this.featuresCollection_){this.featureChangeKeys_={};this.idIndex_={};this.undefIdIndex_={}}}else if(this.featuresRtree_){this.featuresRtree_.forEach(this.removeFeatureInternal,this);for(var r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear();this.featuresRtree_&&this.featuresRtree_.clear();this.loadedExtentsRtree_.clear();this.nullGeometryFeatures_={};var i=new ol.source.Vector.Event(ol.source.VectorEventType.CLEAR);this.dispatchEvent(i);this.changed()};ol.source.Vector.prototype.forEachFeature=function(e,t){return this.featuresRtree_?this.featuresRtree_.forEach(e,t):this.featuresCollection_?this.featuresCollection_.forEach(e,t):void 0};ol.source.Vector.prototype.forEachFeatureAtCoordinateDirect=function(e,t,o){var r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(r){var i=r.getGeometry();return i.intersectsCoordinate(e)?t.call(o,r):void 0})};ol.source.Vector.prototype.forEachFeatureInExtent=function(e,t,o){return this.featuresRtree_?this.featuresRtree_.forEachInExtent(e,t,o):this.featuresCollection_?this.featuresCollection_.forEach(t,o):void 0};ol.source.Vector.prototype.forEachFeatureIntersectingExtent=function(e,t,o){return this.forEachFeatureInExtent(e,function(r){var i=r.getGeometry();if(i.intersectsExtent(e)){var n=t.call(o,r);if(n)return n}})};ol.source.Vector.prototype.getFeaturesCollection=function(){return this.featuresCollection_};ol.source.Vector.prototype.getFeatures=function(){var e;if(this.featuresCollection_)e=this.featuresCollection_.getArray();else if(this.featuresRtree_){e=this.featuresRtree_.getAll();ol.obj.isEmpty(this.nullGeometryFeatures_)||ol.array.extend(e,ol.obj.getValues(this.nullGeometryFeatures_))}return e};ol.source.Vector.prototype.getFeaturesAtCoordinate=function(e){var t=[];this.forEachFeatureAtCoordinateDirect(e,function(e){t.push(e)});return t};ol.source.Vector.prototype.getFeaturesInExtent=function(e){return this.featuresRtree_.getInExtent(e)};ol.source.Vector.prototype.getClosestFeatureToCoordinate=function(e,t){var o=e[0],r=e[1],i=null,n=[0/0,0/0],a=1/0,l=[-(1/0),-(1/0),1/0,1/0],s=t?t:ol.functions.TRUE;this.featuresRtree_.forEachInExtent(l,function(e){if(s(e)){var t=e.getGeometry(),p=a;a=t.closestPointXY(o,r,n,a);if(p>a){i=e;var c=Math.sqrt(a);l[0]=o-c;l[1]=r-c;l[2]=o+c;l[3]=r+c}}});return i};ol.source.Vector.prototype.getExtent=function(e){return this.featuresRtree_.getExtent(e)};ol.source.Vector.prototype.getFeatureById=function(e){var t=this.idIndex_[e.toString()];return void 0!==t?t:null};ol.source.Vector.prototype.getFormat=function(){return this.format_};ol.source.Vector.prototype.getOverlaps=function(){return this.overlaps_};ol.source.Vector.prototype.getResolutions=function(){};ol.source.Vector.prototype.getUrl=function(){return this.url_};ol.source.Vector.prototype.handleFeatureChange_=function(e){var t=e.target,o=ol.getUid(t).toString(),r=t.getGeometry();if(r){var i=r.getExtent();if(o in this.nullGeometryFeatures_){delete this.nullGeometryFeatures_[o];this.featuresRtree_&&this.featuresRtree_.insert(i,t)}else this.featuresRtree_&&this.featuresRtree_.update(i,t)}else if(!(o in this.nullGeometryFeatures_)){this.featuresRtree_&&this.featuresRtree_.remove(t);this.nullGeometryFeatures_[o]=t}var n=t.getId();if(void 0!==n){var a=n.toString();if(o in this.undefIdIndex_){delete this.undefIdIndex_[o];this.idIndex_[a]=t}else if(this.idIndex_[a]!==t){this.removeFromIdIndex_(t);this.idIndex_[a]=t}}else if(!(o in this.undefIdIndex_)){this.removeFromIdIndex_(t);this.undefIdIndex_[o]=t}this.changed();this.dispatchEvent(new ol.source.Vector.Event(ol.source.VectorEventType.CHANGEFEATURE,t))};ol.source.Vector.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&ol.obj.isEmpty(this.nullGeometryFeatures_)};ol.source.Vector.prototype.loadFeatures=function(e,t,o){var r,i,n=this.loadedExtentsRtree_,a=this.strategy_(e,t);for(r=0,i=a.length;i>r;++r){var l=a[r],s=n.forEachInExtent(l,function(e){return ol.extent.containsExtent(e.extent,l)});if(!s){this.loader_.call(this,l,t,o);n.insert(l,{extent:l.slice()})}}};ol.source.Vector.prototype.removeFeature=function(e){var t=ol.getUid(e).toString();t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e);this.removeFeatureInternal(e);this.changed()};ol.source.Vector.prototype.removeFeatureInternal=function(e){var t=ol.getUid(e).toString();this.featureChangeKeys_[t].forEach(ol.events.unlistenByKey);delete this.featureChangeKeys_[t];var o=e.getId();void 0!==o?delete this.idIndex_[o.toString()]:delete this.undefIdIndex_[t];this.dispatchEvent(new ol.source.Vector.Event(ol.source.VectorEventType.REMOVEFEATURE,e))};ol.source.Vector.prototype.removeFromIdIndex_=function(e){var t=!1;for(var o in this.idIndex_)if(this.idIndex_[o]===e){delete this.idIndex_[o];t=!0;break}return t};ol.source.Vector.Event=function(e,t){ol.events.Event.call(this,e);this.feature=t};ol.inherits(ol.source.Vector.Event,ol.events.Event);goog.provide("ol.interaction.Draw");goog.require("ol");goog.require("ol.Feature");goog.require("ol.MapBrowserEventType");goog.require("ol.Object");goog.require("ol.coordinate");goog.require("ol.events");goog.require("ol.events.Event");goog.require("ol.events.condition");goog.require("ol.extent");goog.require("ol.functions");goog.require("ol.geom.Circle");goog.require("ol.geom.GeometryType");goog.require("ol.geom.LineString");goog.require("ol.geom.MultiLineString");goog.require("ol.geom.MultiPoint");goog.require("ol.geom.MultiPolygon");goog.require("ol.geom.Point");goog.require("ol.geom.Polygon");goog.require("ol.interaction.DrawEventType");goog.require("ol.interaction.Pointer");goog.require("ol.interaction.Property");goog.require("ol.layer.Vector");goog.require("ol.source.Vector");goog.require("ol.style.Style");ol.interaction.Draw=function(e){ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.Draw.handleDownEvent_,handleEvent:ol.interaction.Draw.handleEvent,handleUpEvent:ol.interaction.Draw.handleUpEvent_});this.shouldHandle_=!1;this.downPx_=null;this.freehand_=!1;this.source_=e.source?e.source:null;this.features_=e.features?e.features:null;this.snapTolerance_=e.snapTolerance?e.snapTolerance:12;this.type_=e.type;this.mode_=ol.interaction.Draw.getMode_(this.type_);this.minPoints_=e.minPoints?e.minPoints:this.mode_===ol.interaction.Draw.Mode_.POLYGON?3:2;this.maxPoints_=e.maxPoints?e.maxPoints:1/0;this.finishCondition_=e.finishCondition?e.finishCondition:ol.functions.TRUE;var t=e.geometryFunction;if(!t)if(this.type_===ol.geom.GeometryType.CIRCLE)t=function(e,t){var o=t?t:new ol.geom.Circle([0/0,0/0]),r=ol.coordinate.squaredDistance(e[0],e[1]);o.setCenterAndRadius(e[0],Math.sqrt(r));return o};else{var o,r=this.mode_;r===ol.interaction.Draw.Mode_.POINT?o=ol.geom.Point:r===ol.interaction.Draw.Mode_.LINE_STRING?o=ol.geom.LineString:r===ol.interaction.Draw.Mode_.POLYGON&&(o=ol.geom.Polygon);t=function(e,t){var i=t;i?i.setCoordinates(r===ol.interaction.Draw.Mode_.POLYGON?[e[0].concat([e[0][0]])]:e):i=new o(e);return i}}this.geometryFunction_=t;this.finishCoordinate_=null;this.sketchFeature_=null;this.sketchPoint_=null;this.sketchCoords_=null;this.sketchLine_=null;this.sketchLineCoords_=null;this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36;this.overlay_=new ol.layer.Vector({source:new ol.source.Vector({useSpatialIndex:!1,wrapX:e.wrapX?e.wrapX:!1}),style:e.style?e.style:ol.interaction.Draw.getDefaultStyleFunction()});this.geometryName_=e.geometryName;this.condition_=e.condition?e.condition:ol.events.condition.noModifierKeys;this.freehandCondition_;this.freehandCondition_=e.freehand?ol.events.condition.always:e.freehandCondition?e.freehandCondition:ol.events.condition.shiftKeyOnly;ol.events.listen(this,ol.Object.getChangeEventType(ol.interaction.Property.ACTIVE),this.updateState_,this)};ol.inherits(ol.interaction.Draw,ol.interaction.Pointer);ol.interaction.Draw.getDefaultStyleFunction=function(){var e=ol.style.Style.createDefaultEditing();return function(t,o){return e[t.getGeometry().getType()]}};ol.interaction.Draw.prototype.setMap=function(e){ol.interaction.Pointer.prototype.setMap.call(this,e);this.updateState_();

};ol.interaction.Draw.handleEvent=function(e){this.freehand_=this.mode_!==ol.interaction.Draw.Mode_.POINT&&this.freehandCondition_(e);var t=!this.freehand_;if(this.freehand_&&e.type===ol.MapBrowserEventType.POINTERDRAG&&null!==this.sketchFeature_){this.addToDrawing_(e);t=!1}else e.type===ol.MapBrowserEventType.POINTERMOVE?t=this.handlePointerMove_(e):e.type===ol.MapBrowserEventType.DBLCLICK&&(t=!1);return ol.interaction.Pointer.handleEvent.call(this,e)&&t};ol.interaction.Draw.handleDownEvent_=function(e){this.shouldHandle_=!this.freehand_;if(this.freehand_){this.downPx_=e.pixel;this.finishCoordinate_||this.startDrawing_(e);return!0}if(this.condition_(e)){this.downPx_=e.pixel;return!0}return!1};ol.interaction.Draw.handleUpEvent_=function(e){var t=!0;this.handlePointerMove_(e);var o=this.mode_===ol.interaction.Draw.Mode_.CIRCLE;if(this.shouldHandle_){if(this.finishCoordinate_)this.freehand_||o?this.finishDrawing():this.atFinish_(e)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e);else{this.startDrawing_(e);this.mode_===ol.interaction.Draw.Mode_.POINT&&this.finishDrawing()}t=!1}else if(this.freehand_){this.finishCoordinate_=null;this.abortDrawing_()}return t};ol.interaction.Draw.prototype.handlePointerMove_=function(e){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var t=this.downPx_,o=e.pixel,r=t[0]-o[0],i=t[1]-o[1],n=r*r+i*i;this.shouldHandle_=this.freehand_?n>this.squaredClickTolerance_:n<=this.squaredClickTolerance_}this.finishCoordinate_?this.modifyDrawing_(e):this.createOrUpdateSketchPoint_(e);return!0};ol.interaction.Draw.prototype.atFinish_=function(e){var t=!1;if(this.sketchFeature_){var o=!1,r=[this.finishCoordinate_];if(this.mode_===ol.interaction.Draw.Mode_.LINE_STRING)o=this.sketchCoords_.length>this.minPoints_;else if(this.mode_===ol.interaction.Draw.Mode_.POLYGON){o=this.sketchCoords_[0].length>this.minPoints_;r=[this.sketchCoords_[0][0],this.sketchCoords_[0][this.sketchCoords_[0].length-2]]}if(o)for(var i=e.map,n=0,a=r.length;a>n;n++){var l=r[n],s=i.getPixelFromCoordinate(l),p=e.pixel,c=p[0]-s[0],u=p[1]-s[1],g=this.freehand_?1:this.snapTolerance_;t=Math.sqrt(c*c+u*u)<=g;if(t){this.finishCoordinate_=l;break}}}return t};ol.interaction.Draw.prototype.createOrUpdateSketchPoint_=function(e){var t=e.coordinate.slice();if(this.sketchPoint_){var o=this.sketchPoint_.getGeometry();o.setCoordinates(t)}else{this.sketchPoint_=new ol.Feature(new ol.geom.Point(t));this.updateSketchFeatures_()}};ol.interaction.Draw.prototype.startDrawing_=function(e){var t=e.coordinate;this.finishCoordinate_=t;if(this.mode_===ol.interaction.Draw.Mode_.POINT)this.sketchCoords_=t.slice();else if(this.mode_===ol.interaction.Draw.Mode_.POLYGON){this.sketchCoords_=[[t.slice(),t.slice()]];this.sketchLineCoords_=this.sketchCoords_[0]}else{this.sketchCoords_=[t.slice(),t.slice()];this.mode_===ol.interaction.Draw.Mode_.CIRCLE&&(this.sketchLineCoords_=this.sketchCoords_)}this.sketchLineCoords_&&(this.sketchLine_=new ol.Feature(new ol.geom.LineString(this.sketchLineCoords_)));var o=this.geometryFunction_(this.sketchCoords_);this.sketchFeature_=new ol.Feature;this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_);this.sketchFeature_.setGeometry(o);this.updateSketchFeatures_();this.dispatchEvent(new ol.interaction.Draw.Event(ol.interaction.DrawEventType.DRAWSTART,this.sketchFeature_))};ol.interaction.Draw.prototype.modifyDrawing_=function(e){var t,o,r=e.coordinate,i=this.sketchFeature_.getGeometry();if(this.mode_===ol.interaction.Draw.Mode_.POINT)o=this.sketchCoords_;else if(this.mode_===ol.interaction.Draw.Mode_.POLYGON){t=this.sketchCoords_[0];o=t[t.length-1];this.atFinish_(e)&&(r=this.finishCoordinate_.slice())}else{t=this.sketchCoords_;o=t[t.length-1]}o[0]=r[0];o[1]=r[1];this.geometryFunction_(this.sketchCoords_,i);if(this.sketchPoint_){var n=this.sketchPoint_.getGeometry();n.setCoordinates(r)}var a;if(i instanceof ol.geom.Polygon&&this.mode_!==ol.interaction.Draw.Mode_.POLYGON){this.sketchLine_||(this.sketchLine_=new ol.Feature(new ol.geom.LineString(null)));var l=i.getLinearRing(0);a=this.sketchLine_.getGeometry();a.setFlatCoordinates(l.getLayout(),l.getFlatCoordinates())}else if(this.sketchLineCoords_){a=this.sketchLine_.getGeometry();a.setCoordinates(this.sketchLineCoords_)}this.updateSketchFeatures_()};ol.interaction.Draw.prototype.addToDrawing_=function(e){var t,o,r=e.coordinate,i=this.sketchFeature_.getGeometry();if(this.mode_===ol.interaction.Draw.Mode_.LINE_STRING){this.finishCoordinate_=r.slice();o=this.sketchCoords_;o.length>=this.maxPoints_&&(this.freehand_?o.pop():t=!0);o.push(r.slice());this.geometryFunction_(o,i)}else if(this.mode_===ol.interaction.Draw.Mode_.POLYGON){o=this.sketchCoords_[0];o.length>=this.maxPoints_&&(this.freehand_?o.pop():t=!0);o.push(r.slice());t&&(this.finishCoordinate_=o[0]);this.geometryFunction_(this.sketchCoords_,i)}this.updateSketchFeatures_();t&&this.finishDrawing()};ol.interaction.Draw.prototype.removeLastPoint=function(){if(this.sketchFeature_){var e,t,o=this.sketchFeature_.getGeometry();if(this.mode_===ol.interaction.Draw.Mode_.LINE_STRING){e=this.sketchCoords_;e.splice(-2,1);this.geometryFunction_(e,o);e.length>=2&&(this.finishCoordinate_=e[e.length-2].slice())}else if(this.mode_===ol.interaction.Draw.Mode_.POLYGON){e=this.sketchCoords_[0];e.splice(-2,1);t=this.sketchLine_.getGeometry();t.setCoordinates(e);this.geometryFunction_(this.sketchCoords_,o)}0===e.length&&(this.finishCoordinate_=null);this.updateSketchFeatures_()}};ol.interaction.Draw.prototype.finishDrawing=function(){var e=this.abortDrawing_(),t=this.sketchCoords_,o=e.getGeometry();if(this.mode_===ol.interaction.Draw.Mode_.LINE_STRING){t.pop();this.geometryFunction_(t,o)}else if(this.mode_===ol.interaction.Draw.Mode_.POLYGON){t[0].pop();this.geometryFunction_(t,o);t=o.getCoordinates()}this.type_===ol.geom.GeometryType.MULTI_POINT?e.setGeometry(new ol.geom.MultiPoint([t])):this.type_===ol.geom.GeometryType.MULTI_LINE_STRING?e.setGeometry(new ol.geom.MultiLineString([t])):this.type_===ol.geom.GeometryType.MULTI_POLYGON&&e.setGeometry(new ol.geom.MultiPolygon([t]));this.dispatchEvent(new ol.interaction.Draw.Event(ol.interaction.DrawEventType.DRAWEND,e));this.features_&&this.features_.push(e);this.source_&&this.source_.addFeature(e)};ol.interaction.Draw.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var e=this.sketchFeature_;if(e){this.sketchFeature_=null;this.sketchPoint_=null;this.sketchLine_=null;this.overlay_.getSource().clear(!0)}return e};ol.interaction.Draw.prototype.extend=function(e){var t=e.getGeometry(),o=t;this.sketchFeature_=e;this.sketchCoords_=o.getCoordinates();var r=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=r.slice();this.sketchCoords_.push(r.slice());this.updateSketchFeatures_();this.dispatchEvent(new ol.interaction.Draw.Event(ol.interaction.DrawEventType.DRAWSTART,this.sketchFeature_))};ol.interaction.Draw.prototype.shouldStopEvent=ol.functions.FALSE;ol.interaction.Draw.prototype.updateSketchFeatures_=function(){var e=[];this.sketchFeature_&&e.push(this.sketchFeature_);this.sketchLine_&&e.push(this.sketchLine_);this.sketchPoint_&&e.push(this.sketchPoint_);var t=this.overlay_.getSource();t.clear(!0);t.addFeatures(e)};ol.interaction.Draw.prototype.updateState_=function(){var e=this.getMap(),t=this.getActive();e&&t||this.abortDrawing_();this.overlay_.setMap(t?e:null)};ol.interaction.Draw.createRegularPolygon=function(e,t){return function(o,r){var i=o[0],n=o[1],a=Math.sqrt(ol.coordinate.squaredDistance(i,n)),l=r?r:ol.geom.Polygon.fromCircle(new ol.geom.Circle(i),e),s=t?t:Math.atan((n[1]-i[1])/(n[0]-i[0]));ol.geom.Polygon.makeRegular(l,i,a,s);return l}};ol.interaction.Draw.createBox=function(){return function(e,t){var o=ol.extent.boundingExtent(e),r=t||new ol.geom.Polygon(null);r.setCoordinates([[ol.extent.getBottomLeft(o),ol.extent.getBottomRight(o),ol.extent.getTopRight(o),ol.extent.getTopLeft(o),ol.extent.getBottomLeft(o)]]);return r}};ol.interaction.Draw.getMode_=function(e){var t;e===ol.geom.GeometryType.POINT||e===ol.geom.GeometryType.MULTI_POINT?t=ol.interaction.Draw.Mode_.POINT:e===ol.geom.GeometryType.LINE_STRING||e===ol.geom.GeometryType.MULTI_LINE_STRING?t=ol.interaction.Draw.Mode_.LINE_STRING:e===ol.geom.GeometryType.POLYGON||e===ol.geom.GeometryType.MULTI_POLYGON?t=ol.interaction.Draw.Mode_.POLYGON:e===ol.geom.GeometryType.CIRCLE&&(t=ol.interaction.Draw.Mode_.CIRCLE);return t};ol.interaction.Draw.Mode_={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",CIRCLE:"Circle"};ol.interaction.Draw.Event=function(e,t){ol.events.Event.call(this,e);this.feature=t};ol.inherits(ol.interaction.Draw.Event,ol.events.Event);goog.provide("ol.interaction.Extent");goog.require("ol");goog.require("ol.Feature");goog.require("ol.MapBrowserEventType");goog.require("ol.MapBrowserPointerEvent");goog.require("ol.coordinate");goog.require("ol.events.Event");goog.require("ol.extent");goog.require("ol.geom.GeometryType");goog.require("ol.geom.Point");goog.require("ol.geom.Polygon");goog.require("ol.interaction.Pointer");goog.require("ol.layer.Vector");goog.require("ol.source.Vector");goog.require("ol.style.Style");ol.interaction.Extent=function(e){this.extent_=null;this.pointerHandler_=null;this.pixelTolerance_=10;this.snappedToVertex_=!1;this.extentFeature_=null;this.vertexFeature_=null;e||(e={});e.extent&&this.setExtent(e.extent);ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.Extent.handleDownEvent_,handleDragEvent:ol.interaction.Extent.handleDragEvent_,handleEvent:ol.interaction.Extent.handleEvent_,handleUpEvent:ol.interaction.Extent.handleUpEvent_});this.extentOverlay_=new ol.layer.Vector({source:new ol.source.Vector({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.boxStyle?e.boxStyle:ol.interaction.Extent.getDefaultExtentStyleFunction_(),updateWhileAnimating:!0,updateWhileInteracting:!0});this.vertexOverlay_=new ol.layer.Vector({source:new ol.source.Vector({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.pointerStyle?e.pointerStyle:ol.interaction.Extent.getDefaultPointerStyleFunction_(),updateWhileAnimating:!0,updateWhileInteracting:!0})};ol.inherits(ol.interaction.Extent,ol.interaction.Pointer);ol.interaction.Extent.handleEvent_=function(e){if(!(e instanceof ol.MapBrowserPointerEvent))return!0;e.type!=ol.MapBrowserEventType.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e);ol.interaction.Pointer.handleEvent.call(this,e);return!1};ol.interaction.Extent.handleDownEvent_=function(e){var t=e.pixel,o=e.map,r=this.getExtent(),i=this.snapToVertex_(t,o),n=function(e){var t=null,o=null;e[0]==r[0]?t=r[2]:e[0]==r[2]&&(t=r[0]);e[1]==r[1]?o=r[3]:e[1]==r[3]&&(o=r[1]);return null!==t&&null!==o?[t,o]:null};if(i&&r){var a=i[0]==r[0]||i[0]==r[2]?i[0]:null,l=i[1]==r[1]||i[1]==r[3]?i[1]:null;null!==a&&null!==l?this.pointerHandler_=ol.interaction.Extent.getPointHandler_(n(i)):null!==a?this.pointerHandler_=ol.interaction.Extent.getEdgeHandler_(n([a,r[1]]),n([a,r[3]])):null!==l&&(this.pointerHandler_=ol.interaction.Extent.getEdgeHandler_(n([r[0],l]),n([r[2],l])))}else{i=o.getCoordinateFromPixel(t);this.setExtent([i[0],i[1],i[0],i[1]]);this.pointerHandler_=ol.interaction.Extent.getPointHandler_(i)}return!0};ol.interaction.Extent.handleDragEvent_=function(e){if(this.pointerHandler_){var t=e.coordinate;this.setExtent(this.pointerHandler_(t));this.createOrUpdatePointerFeature_(t)}return!0};ol.interaction.Extent.handleUpEvent_=function(e){this.pointerHandler_=null;var t=this.getExtent();t&&0!==ol.extent.getArea(t)||this.setExtent(null);return!1};ol.interaction.Extent.getDefaultExtentStyleFunction_=function(){var e=ol.style.Style.createDefaultEditing();return function(t,o){return e[ol.geom.GeometryType.POLYGON]}};ol.interaction.Extent.getDefaultPointerStyleFunction_=function(){var e=ol.style.Style.createDefaultEditing();return function(t,o){return e[ol.geom.GeometryType.POINT]}};ol.interaction.Extent.getPointHandler_=function(e){return function(t){return ol.extent.boundingExtent([e,t])}};ol.interaction.Extent.getEdgeHandler_=function(e,t){return e[0]==t[0]?function(o){return ol.extent.boundingExtent([e,[o[0],t[1]]])}:e[1]==t[1]?function(o){return ol.extent.boundingExtent([e,[t[0],o[1]]])}:null};ol.interaction.Extent.getSegments_=function(e){return[[[e[0],e[1]],[e[0],e[3]]],[[e[0],e[3]],[e[2],e[3]]],[[e[2],e[3]],[e[2],e[1]]],[[e[2],e[1]],[e[0],e[1]]]]};ol.interaction.Extent.prototype.snapToVertex_=function(e,t){var o=t.getCoordinateFromPixel(e),r=function(e,t){return ol.coordinate.squaredDistanceToSegment(o,e)-ol.coordinate.squaredDistanceToSegment(o,t)},i=this.getExtent();if(i){var n=ol.interaction.Extent.getSegments_(i);n.sort(r);var a=n[0],l=ol.coordinate.closestOnSegment(o,a),s=t.getPixelFromCoordinate(l);if(ol.coordinate.distance(e,s)<=this.pixelTolerance_){var p=t.getPixelFromCoordinate(a[0]),c=t.getPixelFromCoordinate(a[1]),u=ol.coordinate.squaredDistance(s,p),g=ol.coordinate.squaredDistance(s,c),d=Math.sqrt(Math.min(u,g));this.snappedToVertex_=d<=this.pixelTolerance_;this.snappedToVertex_&&(l=u>g?a[1]:a[0]);return l}}return null};ol.interaction.Extent.prototype.handlePointerMove_=function(e){var t=e.pixel,o=e.map,r=this.snapToVertex_(t,o);r||(r=o.getCoordinateFromPixel(t));this.createOrUpdatePointerFeature_(r)};ol.interaction.Extent.prototype.createOrUpdateExtentFeature_=function(e){var t=this.extentFeature_;if(t)t.setGeometry(e?ol.geom.Polygon.fromExtent(e):void 0);else{t=new ol.Feature(e?ol.geom.Polygon.fromExtent(e):{});this.extentFeature_=t;this.extentOverlay_.getSource().addFeature(t)}return t};ol.interaction.Extent.prototype.createOrUpdatePointerFeature_=function(e){var t=this.vertexFeature_;if(t){var o=t.getGeometry();o.setCoordinates(e)}else{t=new ol.Feature(new ol.geom.Point(e));this.vertexFeature_=t;this.vertexOverlay_.getSource().addFeature(t)}return t};ol.interaction.Extent.prototype.setMap=function(e){this.extentOverlay_.setMap(e);this.vertexOverlay_.setMap(e);ol.interaction.Pointer.prototype.setMap.call(this,e)};ol.interaction.Extent.prototype.getExtent=function(){return this.extent_};ol.interaction.Extent.prototype.setExtent=function(e){this.extent_=e?e:null;this.createOrUpdateExtentFeature_(e);this.dispatchEvent(new ol.interaction.Extent.Event(this.extent_))};ol.interaction.Extent.Event=function(e){ol.events.Event.call(this,ol.interaction.Extent.EventType_.EXTENTCHANGED);this.extent_=e};ol.inherits(ol.interaction.Extent.Event,ol.events.Event);ol.interaction.Extent.EventType_={EXTENTCHANGED:"extentchanged"};goog.provide("ol.interaction.ModifyEventType");ol.interaction.ModifyEventType={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};goog.provide("ol.interaction.Modify");goog.require("ol");goog.require("ol.CollectionEventType");goog.require("ol.Feature");goog.require("ol.MapBrowserEventType");goog.require("ol.MapBrowserPointerEvent");goog.require("ol.ViewHint");goog.require("ol.array");goog.require("ol.coordinate");goog.require("ol.events");goog.require("ol.events.Event");goog.require("ol.events.EventType");goog.require("ol.events.condition");goog.require("ol.extent");goog.require("ol.geom.GeometryType");goog.require("ol.geom.Point");goog.require("ol.interaction.ModifyEventType");goog.require("ol.interaction.Pointer");goog.require("ol.layer.Vector");goog.require("ol.source.Vector");goog.require("ol.structs.RBush");goog.require("ol.style.Style");ol.interaction.Modify=function(e){ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.Modify.handleDownEvent_,handleDragEvent:ol.interaction.Modify.handleDragEvent_,handleEvent:ol.interaction.Modify.handleEvent,handleUpEvent:ol.interaction.Modify.handleUpEvent_});this.condition_=e.condition?e.condition:ol.events.condition.primaryAction;this.defaultDeleteCondition_=function(e){return ol.events.condition.noModifierKeys(e)&&ol.events.condition.singleClick(e)};this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_;this.vertexFeature_=null;this.vertexSegments_=null;this.lastPixel_=[0,0];this.ignoreNextSingleClick_=!1;this.modified_=!1;this.rBush_=new ol.structs.RBush;this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10;this.snappedToVertex_=!1;this.changingFeature_=!1;this.dragSegments_=[];this.overlay_=new ol.layer.Vector({source:new ol.source.Vector({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:ol.interaction.Modify.getDefaultStyleFunction(),updateWhileAnimating:!0,updateWhileInteracting:!0});this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_};this.features_=e.features;this.features_.forEach(this.addFeature_,this);ol.events.listen(this.features_,ol.CollectionEventType.ADD,this.handleFeatureAdd_,this);ol.events.listen(this.features_,ol.CollectionEventType.REMOVE,this.handleFeatureRemove_,this);this.lastPointerEvent_=null};ol.inherits(ol.interaction.Modify,ol.interaction.Pointer);ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX=0;ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX=1;ol.interaction.Modify.prototype.addFeature_=function(e){var t=e.getGeometry();t&&t.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[t.getType()].call(this,e,t);var o=this.getMap();o&&o.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,o);ol.events.listen(e,ol.events.EventType.CHANGE,this.handleFeatureChange_,this)};ol.interaction.Modify.prototype.willModifyFeatures_=function(e){if(!this.modified_){this.modified_=!0;this.dispatchEvent(new ol.interaction.Modify.Event(ol.interaction.ModifyEventType.MODIFYSTART,this.features_,e))}};ol.interaction.Modify.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e);if(this.vertexFeature_&&0===this.features_.getLength()){this.overlay_.getSource().removeFeature(this.vertexFeature_);this.vertexFeature_=null}ol.events.unlisten(e,ol.events.EventType.CHANGE,this.handleFeatureChange_,this)};ol.interaction.Modify.prototype.removeFeatureSegmentData_=function(e){var t=this.rBush_,o=[];t.forEach(function(t){e===t.feature&&o.push(t)});for(var r=o.length-1;r>=0;--r)t.remove(o[r])};ol.interaction.Modify.prototype.setActive=function(e){if(this.vertexFeature_&&!e){this.overlay_.getSource().removeFeature(this.vertexFeature_);this.vertexFeature_=null}ol.interaction.Pointer.prototype.setActive.call(this,e)};ol.interaction.Modify.prototype.setMap=function(e){this.overlay_.setMap(e);ol.interaction.Pointer.prototype.setMap.call(this,e)};ol.interaction.Modify.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)};ol.interaction.Modify.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){var t=e.target;this.removeFeature_(t);this.addFeature_(t)}};ol.interaction.Modify.prototype.handleFeatureRemove_=function(e){var t=e.element;this.removeFeature_(t)};ol.interaction.Modify.prototype.writePointGeometry_=function(e,t){var o=t.getCoordinates(),r={feature:e,geometry:t,segment:[o,o]};this.rBush_.insert(t.getExtent(),r)};ol.interaction.Modify.prototype.writeMultiPointGeometry_=function(e,t){var o,r,i,n,a=t.getCoordinates();for(r=0,i=a.length;i>r;++r){o=a[r];n={feature:e,geometry:t,depth:[r],index:r,segment:[o,o]};this.rBush_.insert(t.getExtent(),n)}};ol.interaction.Modify.prototype.writeLineStringGeometry_=function(e,t){var o,r,i,n,a=t.getCoordinates();for(o=0,r=a.length-1;r>o;++o){i=a.slice(o,o+2);n={feature:e,geometry:t,index:o,segment:i};this.rBush_.insert(ol.extent.boundingExtent(i),n)}};ol.interaction.Modify.prototype.writeMultiLineStringGeometry_=function(e,t){var o,r,i,n,a,l,s,p=t.getCoordinates();for(n=0,a=p.length;a>n;++n){o=p[n];for(r=0,i=o.length-1;i>r;++r){l=o.slice(r,r+2);s={feature:e,geometry:t,depth:[n],index:r,segment:l};this.rBush_.insert(ol.extent.boundingExtent(l),s)}}};ol.interaction.Modify.prototype.writePolygonGeometry_=function(e,t){var o,r,i,n,a,l,s,p=t.getCoordinates();for(n=0,a=p.length;a>n;++n){o=p[n];for(r=0,i=o.length-1;i>r;++r){l=o.slice(r,r+2);s={feature:e,geometry:t,depth:[n],index:r,segment:l};this.rBush_.insert(ol.extent.boundingExtent(l),s)}}};ol.interaction.Modify.prototype.writeMultiPolygonGeometry_=function(e,t){var o,r,i,n,a,l,s,p,c,u,g=t.getCoordinates();for(l=0,s=g.length;s>l;++l){p=g[l];for(n=0,a=p.length;a>n;++n){o=p[n];for(r=0,i=o.length-1;i>r;++r){c=o.slice(r,r+2);u={feature:e,geometry:t,depth:[n,l],index:r,segment:c};this.rBush_.insert(ol.extent.boundingExtent(c),u)}}}};ol.interaction.Modify.prototype.writeCircleGeometry_=function(e,t){var o=t.getCenter(),r={feature:e,geometry:t,index:ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX,segment:[o,o]},i={feature:e,geometry:t,index:ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX,segment:[o,o]},n=[r,i];r.featureSegments=i.featureSegments=n;this.rBush_.insert(ol.extent.createOrUpdateFromCoordinate(o),r);this.rBush_.insert(t.getExtent(),i)};ol.interaction.Modify.prototype.writeGeometryCollectionGeometry_=function(e,t){var o,r=t.getGeometriesArray();for(o=0;o<r.length;++o)this.SEGMENT_WRITERS_[r[o].getType()].call(this,e,r[o])};ol.interaction.Modify.prototype.createOrUpdateVertexFeature_=function(e){var t=this.vertexFeature_;if(t){var o=t.getGeometry();o.setCoordinates(e)}else{t=new ol.Feature(new ol.geom.Point(e));this.vertexFeature_=t;this.overlay_.getSource().addFeature(t)}return t};ol.interaction.Modify.compareIndexes_=function(e,t){return e.index-t.index};ol.interaction.Modify.handleDownEvent_=function(e){if(!this.condition_(e))return!1;this.handlePointerAtPixel_(e.pixel,e.map);var t=e.map.getCoordinateFromPixel(e.pixel);this.dragSegments_.length=0;this.modified_=!1;var o=this.vertexFeature_;if(o){var r=[],i=o.getGeometry(),n=i.getCoordinates(),a=ol.extent.boundingExtent([n]),l=this.rBush_.getInExtent(a),s={};l.sort(ol.interaction.Modify.compareIndexes_);for(var p=0,c=l.length;c>p;++p){var u=l[p],g=u.segment,d=ol.getUid(u.feature),h=u.depth;h&&(d+="-"+h.join("-"));s[d]||(s[d]=new Array(2));if(u.geometry.getType()===ol.geom.GeometryType.CIRCLE&&u.index===ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX){var f=ol.interaction.Modify.closestOnSegmentData_(t,u);if(ol.coordinate.equals(f,n)&&!s[d][0]){this.dragSegments_.push([u,0]);s[d][0]=u}}else if(ol.coordinate.equals(g[0],n)&&!s[d][0]){this.dragSegments_.push([u,0]);s[d][0]=u}else if(ol.coordinate.equals(g[1],n)&&!s[d][1]){if((u.geometry.getType()===ol.geom.GeometryType.LINE_STRING||u.geometry.getType()===ol.geom.GeometryType.MULTI_LINE_STRING)&&s[d][0]&&0===s[d][0].index)continue;this.dragSegments_.push([u,1]);s[d][1]=u}else ol.getUid(g)in this.vertexSegments_&&!s[d][0]&&!s[d][1]&&r.push([u,n])}r.length&&this.willModifyFeatures_(e);for(var y=r.length-1;y>=0;--y)this.insertVertex_.apply(this,r[y])}return!!this.vertexFeature_};ol.interaction.Modify.handleDragEvent_=function(e){this.ignoreNextSingleClick_=!1;this.willModifyFeatures_(e);for(var t=e.coordinate,o=0,r=this.dragSegments_.length;r>o;++o){for(var i,n=this.dragSegments_[o],a=n[0],l=a.depth,s=a.geometry,p=a.segment,c=n[1];t.length<s.getStride();)t.push(p[c][t.length]);switch(s.getType()){case ol.geom.GeometryType.POINT:i=t;p[0]=p[1]=t;break;case ol.geom.GeometryType.MULTI_POINT:i=s.getCoordinates();i[a.index]=t;p[0]=p[1]=t;break;case ol.geom.GeometryType.LINE_STRING:i=s.getCoordinates();i[a.index+c]=t;p[c]=t;break;case ol.geom.GeometryType.MULTI_LINE_STRING:i=s.getCoordinates();i[l[0]][a.index+c]=t;p[c]=t;break;case ol.geom.GeometryType.POLYGON:i=s.getCoordinates();i[l[0]][a.index+c]=t;p[c]=t;break;case ol.geom.GeometryType.MULTI_POLYGON:i=s.getCoordinates();i[l[1]][l[0]][a.index+c]=t;p[c]=t;break;case ol.geom.GeometryType.CIRCLE:p[0]=p[1]=t;if(a.index===ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX){this.changingFeature_=!0;s.setCenter(t);this.changingFeature_=!1}else{this.changingFeature_=!0;s.setRadius(ol.coordinate.distance(s.getCenter(),t));this.changingFeature_=!1}}i&&this.setGeometryCoordinates_(s,i)}this.createOrUpdateVertexFeature_(t)};ol.interaction.Modify.handleUpEvent_=function(e){for(var t,o,r=this.dragSegments_.length-1;r>=0;--r){t=this.dragSegments_[r][0];o=t.geometry;if(o.getType()===ol.geom.GeometryType.CIRCLE){var i=o.getCenter(),n=t.featureSegments[0],a=t.featureSegments[1];n.segment[0]=n.segment[1]=i;a.segment[0]=a.segment[1]=i;this.rBush_.update(ol.extent.createOrUpdateFromCoordinate(i),n);this.rBush_.update(o.getExtent(),a)}else this.rBush_.update(ol.extent.boundingExtent(t.segment),t)}if(this.modified_){this.dispatchEvent(new ol.interaction.Modify.Event(ol.interaction.ModifyEventType.MODIFYEND,this.features_,e));this.modified_=!1}return!1};ol.interaction.Modify.handleEvent=function(e){if(!(e instanceof ol.MapBrowserPointerEvent))return!0;this.lastPointerEvent_=e;var t;e.map.getView().getHints()[ol.ViewHint.INTERACTING]||e.type!=ol.MapBrowserEventType.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e);this.vertexFeature_&&this.deleteCondition_(e)&&(t=e.type==ol.MapBrowserEventType.SINGLECLICK&&this.ignoreNextSingleClick_?!0:this.removePoint());e.type==ol.MapBrowserEventType.SINGLECLICK&&(this.ignoreNextSingleClick_=!1);return ol.interaction.Pointer.handleEvent.call(this,e)&&!t};ol.interaction.Modify.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel;this.handlePointerAtPixel_(e.pixel,e.map)};ol.interaction.Modify.prototype.handlePointerAtPixel_=function(e,t){var o=t.getCoordinateFromPixel(e),r=function(e,t){return ol.interaction.Modify.pointDistanceToSegmentDataSquared_(o,e)-ol.interaction.Modify.pointDistanceToSegmentDataSquared_(o,t)},i=ol.extent.buffer(ol.extent.createOrUpdateFromCoordinate(o),t.getView().getResolution()*this.pixelTolerance_),n=this.rBush_,a=n.getInExtent(i);if(a.length>0){a.sort(r);var l=a[0],s=l.segment,p=ol.interaction.Modify.closestOnSegmentData_(o,l),c=t.getPixelFromCoordinate(p),u=ol.coordinate.distance(e,c);if(u<=this.pixelTolerance_){var g={};if(l.geometry.getType()===ol.geom.GeometryType.CIRCLE&&l.index===ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX){this.snappedToVertex_=!0;this.createOrUpdateVertexFeature_(p)}else{var d=t.getPixelFromCoordinate(s[0]),h=t.getPixelFromCoordinate(s[1]),f=ol.coordinate.squaredDistance(c,d),y=ol.coordinate.squaredDistance(c,h);u=Math.sqrt(Math.min(f,y));this.snappedToVertex_=u<=this.pixelTolerance_;this.snappedToVertex_&&(p=f>y?s[1]:s[0]);this.createOrUpdateVertexFeature_(p);for(var m,v=1,C=a.length;C>v;++v){m=a[v].segment;if(!(ol.coordinate.equals(s[0],m[0])&&ol.coordinate.equals(s[1],m[1])||ol.coordinate.equals(s[0],m[1])&&ol.coordinate.equals(s[1],m[0])))break;g[ol.getUid(m)]=!0}}g[ol.getUid(s)]=!0;this.vertexSegments_=g;return}}if(this.vertexFeature_){this.overlay_.getSource().removeFeature(this.vertexFeature_);this.vertexFeature_=null}};ol.interaction.Modify.pointDistanceToSegmentDataSquared_=function(e,t){var o=t.geometry;if(o.getType()===ol.geom.GeometryType.CIRCLE){var r=o;if(t.index===ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX){var i=ol.coordinate.squaredDistance(r.getCenter(),e),n=Math.sqrt(i)-r.getRadius();return n*n}}return ol.coordinate.squaredDistanceToSegment(e,t.segment)};ol.interaction.Modify.closestOnSegmentData_=function(e,t){var o=t.geometry;return o.getType()===ol.geom.GeometryType.CIRCLE&&t.index===ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX?o.getClosestPoint(e):ol.coordinate.closestOnSegment(e,t.segment)};ol.interaction.Modify.prototype.insertVertex_=function(e,t){for(var o,r=e.segment,i=e.feature,n=e.geometry,a=e.depth,l=e.index;t.length<n.getStride();)t.push(0);switch(n.getType()){case ol.geom.GeometryType.MULTI_LINE_STRING:o=n.getCoordinates();o[a[0]].splice(l+1,0,t);break;case ol.geom.GeometryType.POLYGON:o=n.getCoordinates();o[a[0]].splice(l+1,0,t);break;case ol.geom.GeometryType.MULTI_POLYGON:o=n.getCoordinates();o[a[1]][a[0]].splice(l+1,0,t);break;case ol.geom.GeometryType.LINE_STRING:o=n.getCoordinates();o.splice(l+1,0,t);break;default:return}this.setGeometryCoordinates_(n,o);var s=this.rBush_;s.remove(e);this.updateSegmentIndices_(n,l,a,1);var p={segment:[r[0],t],feature:i,geometry:n,depth:a,index:l};s.insert(ol.extent.boundingExtent(p.segment),p);this.dragSegments_.push([p,1]);var c={segment:[t,r[1]],feature:i,geometry:n,depth:a,index:l+1};s.insert(ol.extent.boundingExtent(c.segment),c);this.dragSegments_.push([c,0]);this.ignoreNextSingleClick_=!0};ol.interaction.Modify.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=ol.MapBrowserEventType.POINTERDRAG){var e=this.lastPointerEvent_;this.willModifyFeatures_(e);this.removeVertex_();this.dispatchEvent(new ol.interaction.Modify.Event(ol.interaction.ModifyEventType.MODIFYEND,this.features_,e));this.modified_=!1;return!0}return!1};ol.interaction.Modify.prototype.removeVertex_=function(){var e,t,o,r,i,n,a,l,s,p,c,u=this.dragSegments_,g={},d=!1;for(i=u.length-1;i>=0;--i){o=u[i];p=o[0];c=ol.getUid(p.feature);p.depth&&(c+="-"+p.depth.join("-"));c in g||(g[c]={});if(0===o[1]){g[c].right=p;g[c].index=p.index}else if(1==o[1]){g[c].left=p;g[c].index=p.index+1}}for(c in g){s=g[c].right;a=g[c].left;n=g[c].index;l=n-1;p=void 0!==a?a:s;0>l&&(l=0);r=p.geometry;t=r.getCoordinates();e=t;d=!1;switch(r.getType()){case ol.geom.GeometryType.MULTI_LINE_STRING:if(t[p.depth[0]].length>2){t[p.depth[0]].splice(n,1);d=!0}break;case ol.geom.GeometryType.LINE_STRING:if(t.length>2){t.splice(n,1);d=!0}break;case ol.geom.GeometryType.MULTI_POLYGON:e=e[p.depth[1]];case ol.geom.GeometryType.POLYGON:e=e[p.depth[0]];if(e.length>4){n==e.length-1&&(n=0);e.splice(n,1);d=!0;if(0===n){e.pop();e.push(e[0]);l=e.length-1}}}if(d){this.setGeometryCoordinates_(r,t);var h=[];if(void 0!==a){this.rBush_.remove(a);h.push(a.segment[0])}if(void 0!==s){this.rBush_.remove(s);h.push(s.segment[1])}if(void 0!==a&&void 0!==s){var f={depth:p.depth,feature:p.feature,geometry:p.geometry,index:l,segment:h};this.rBush_.insert(ol.extent.boundingExtent(f.segment),f)}this.updateSegmentIndices_(r,n,p.depth,-1);if(this.vertexFeature_){this.overlay_.getSource().removeFeature(this.vertexFeature_);this.vertexFeature_=null}u.length=0}}return d};ol.interaction.Modify.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0;e.setCoordinates(t);this.changingFeature_=!1};ol.interaction.Modify.prototype.updateSegmentIndices_=function(e,t,o,r){this.rBush_.forEachInExtent(e.getExtent(),function(i){i.geometry===e&&(void 0===o||void 0===i.depth||ol.array.equals(i.depth,o))&&i.index>t&&(i.index+=r)})};ol.interaction.Modify.getDefaultStyleFunction=function(){var e=ol.style.Style.createDefaultEditing();return function(t,o){return e[ol.geom.GeometryType.POINT]}};ol.interaction.Modify.Event=function(e,t,o){ol.events.Event.call(this,e);this.features=t;this.mapBrowserEvent=o};ol.inherits(ol.interaction.Modify.Event,ol.events.Event);goog.provide("ol.interaction.Select");goog.require("ol");goog.require("ol.CollectionEventType");goog.require("ol.array");goog.require("ol.events");goog.require("ol.events.Event");goog.require("ol.events.condition");goog.require("ol.functions");goog.require("ol.geom.GeometryType");goog.require("ol.interaction.Interaction");goog.require("ol.layer.Vector");goog.require("ol.obj");goog.require("ol.source.Vector");goog.require("ol.style.Style");ol.interaction.Select=function(e){ol.interaction.Interaction.call(this,{handleEvent:ol.interaction.Select.handleEvent});var t=e?e:{};this.condition_=t.condition?t.condition:ol.events.condition.singleClick;this.addCondition_=t.addCondition?t.addCondition:ol.events.condition.never;this.removeCondition_=t.removeCondition?t.removeCondition:ol.events.condition.never;this.toggleCondition_=t.toggleCondition?t.toggleCondition:ol.events.condition.shiftKeyOnly;this.multi_=t.multi?t.multi:!1;this.filter_=t.filter?t.filter:ol.functions.TRUE;

this.hitTolerance_=t.hitTolerance?t.hitTolerance:0;var o=new ol.layer.Vector({source:new ol.source.Vector({useSpatialIndex:!1,features:t.features,wrapX:t.wrapX}),style:t.style?t.style:ol.interaction.Select.getDefaultStyleFunction(),updateWhileAnimating:!0,updateWhileInteracting:!0});this.featureOverlay_=o;var r;if(t.layers)if("function"==typeof t.layers)r=t.layers;else{var i=t.layers;r=function(e){return ol.array.includes(i,e)}}else r=ol.functions.TRUE;this.layerFilter_=r;this.featureLayerAssociation_={};var n=this.featureOverlay_.getSource().getFeaturesCollection();ol.events.listen(n,ol.CollectionEventType.ADD,this.addFeature_,this);ol.events.listen(n,ol.CollectionEventType.REMOVE,this.removeFeature_,this)};ol.inherits(ol.interaction.Select,ol.interaction.Interaction);ol.interaction.Select.prototype.addFeatureLayerAssociation_=function(e,t){var o=ol.getUid(e);this.featureLayerAssociation_[o]=t};ol.interaction.Select.prototype.getFeatures=function(){return this.featureOverlay_.getSource().getFeaturesCollection()};ol.interaction.Select.prototype.getHitTolerance=function(){return this.hitTolerance_};ol.interaction.Select.prototype.getLayer=function(e){var t=ol.getUid(e);return this.featureLayerAssociation_[t]};ol.interaction.Select.handleEvent=function(e){if(!this.condition_(e))return!0;var t=this.addCondition_(e),o=this.removeCondition_(e),r=this.toggleCondition_(e),i=!t&&!o&&!r,n=e.map,a=this.featureOverlay_.getSource().getFeaturesCollection(),l=[],s=[];if(i){ol.obj.clear(this.featureLayerAssociation_);n.forEachFeatureAtPixel(e.pixel,function(e,t){if(this.filter_(e,t)){s.push(e);this.addFeatureLayerAssociation_(e,t);return!this.multi_}}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});var p;for(p=a.getLength()-1;p>=0;--p){var c=a.item(p),u=s.indexOf(c);if(u>-1)s.splice(u,1);else{a.remove(c);l.push(c)}}0!==s.length&&a.extend(s)}else{n.forEachFeatureAtPixel(e.pixel,function(e,i){if(this.filter_(e,i)){if(!t&&!r||ol.array.includes(a.getArray(),e)){if((o||r)&&ol.array.includes(a.getArray(),e)){l.push(e);this.removeFeatureLayerAssociation_(e)}}else{s.push(e);this.addFeatureLayerAssociation_(e,i)}return!this.multi_}}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});var g;for(g=l.length-1;g>=0;--g)a.remove(l[g]);a.extend(s)}(s.length>0||l.length>0)&&this.dispatchEvent(new ol.interaction.Select.Event(ol.interaction.Select.EventType_.SELECT,s,l,e));return ol.events.condition.pointerMove(e)};ol.interaction.Select.prototype.setHitTolerance=function(e){this.hitTolerance_=e};ol.interaction.Select.prototype.setMap=function(e){var t=this.getMap(),o=this.featureOverlay_.getSource().getFeaturesCollection();t&&o.forEach(t.unskipFeature,t);ol.interaction.Interaction.prototype.setMap.call(this,e);this.featureOverlay_.setMap(e);e&&o.forEach(e.skipFeature,e)};ol.interaction.Select.getDefaultStyleFunction=function(){var e=ol.style.Style.createDefaultEditing();ol.array.extend(e[ol.geom.GeometryType.POLYGON],e[ol.geom.GeometryType.LINE_STRING]);ol.array.extend(e[ol.geom.GeometryType.GEOMETRY_COLLECTION],e[ol.geom.GeometryType.LINE_STRING]);return function(t,o){return t.getGeometry()?e[t.getGeometry().getType()]:null}};ol.interaction.Select.prototype.addFeature_=function(e){var t=this.getMap();t&&t.skipFeature(e.element)};ol.interaction.Select.prototype.removeFeature_=function(e){var t=this.getMap();t&&t.unskipFeature(e.element)};ol.interaction.Select.prototype.removeFeatureLayerAssociation_=function(e){var t=ol.getUid(e);delete this.featureLayerAssociation_[t]};ol.interaction.Select.Event=function(e,t,o,r){ol.events.Event.call(this,e);this.selected=t;this.deselected=o;this.mapBrowserEvent=r};ol.inherits(ol.interaction.Select.Event,ol.events.Event);ol.interaction.Select.EventType_={SELECT:"select"};goog.provide("ol.interaction.Snap");goog.require("ol");goog.require("ol.Collection");goog.require("ol.CollectionEventType");goog.require("ol.coordinate");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.extent");goog.require("ol.functions");goog.require("ol.interaction.Pointer");goog.require("ol.obj");goog.require("ol.source.Vector");goog.require("ol.source.VectorEventType");goog.require("ol.structs.RBush");ol.interaction.Snap=function(e){ol.interaction.Pointer.call(this,{handleEvent:ol.interaction.Snap.handleEvent_,handleDownEvent:ol.functions.TRUE,handleUpEvent:ol.interaction.Snap.handleUpEvent_});var t=e?e:{};this.source_=t.source?t.source:null;this.vertex_=void 0!==t.vertex?t.vertex:!0;this.edge_=void 0!==t.edge?t.edge:!0;this.features_=t.features?t.features:null;this.featuresListenerKeys_=[];this.featureChangeListenerKeys_={};this.indexedFeaturesExtents_={};this.pendingFeatures_={};this.pixelCoordinate_=null;this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10;this.sortByDistance_=ol.interaction.Snap.sortByDistance.bind(this);this.rBush_=new ol.structs.RBush;this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_}};ol.inherits(ol.interaction.Snap,ol.interaction.Pointer);ol.interaction.Snap.prototype.addFeature=function(e,t){var o=void 0!==t?t:!0,r=ol.getUid(e),i=e.getGeometry();if(i){var n=this.SEGMENT_WRITERS_[i.getType()];if(n){this.indexedFeaturesExtents_[r]=i.getExtent(ol.extent.createEmpty());n.call(this,e,i)}}o&&(this.featureChangeListenerKeys_[r]=ol.events.listen(e,ol.events.EventType.CHANGE,this.handleFeatureChange_,this))};ol.interaction.Snap.prototype.forEachFeatureAdd_=function(e){this.addFeature(e)};ol.interaction.Snap.prototype.forEachFeatureRemove_=function(e){this.removeFeature(e)};ol.interaction.Snap.prototype.getFeatures_=function(){var e;this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures());return e};ol.interaction.Snap.prototype.handleFeatureAdd_=function(e){var t;e instanceof ol.source.Vector.Event?t=e.feature:e instanceof ol.Collection.Event&&(t=e.element);this.addFeature(t)};ol.interaction.Snap.prototype.handleFeatureRemove_=function(e){var t;e instanceof ol.source.Vector.Event?t=e.feature:e instanceof ol.Collection.Event&&(t=e.element);this.removeFeature(t)};ol.interaction.Snap.prototype.handleFeatureChange_=function(e){var t=e.target;if(this.handlingDownUpSequence){var o=ol.getUid(t);o in this.pendingFeatures_||(this.pendingFeatures_[o]=t)}else this.updateFeature_(t)};ol.interaction.Snap.prototype.removeFeature=function(e,t){var o=void 0!==t?t:!0,r=ol.getUid(e),i=this.indexedFeaturesExtents_[r];if(i){var n,a=this.rBush_,l=[];a.forEachInExtent(i,function(t){e===t.feature&&l.push(t)});for(n=l.length-1;n>=0;--n)a.remove(l[n])}if(o){ol.events.unlistenByKey(this.featureChangeListenerKeys_[r]);delete this.featureChangeListenerKeys_[r]}};ol.interaction.Snap.prototype.setMap=function(e){var t=this.getMap(),o=this.featuresListenerKeys_,r=this.getFeatures_();if(t){o.forEach(ol.events.unlistenByKey);o.length=0;r.forEach(this.forEachFeatureRemove_,this)}ol.interaction.Pointer.prototype.setMap.call(this,e);if(e){this.features_?o.push(ol.events.listen(this.features_,ol.CollectionEventType.ADD,this.handleFeatureAdd_,this),ol.events.listen(this.features_,ol.CollectionEventType.REMOVE,this.handleFeatureRemove_,this)):this.source_&&o.push(ol.events.listen(this.source_,ol.source.VectorEventType.ADDFEATURE,this.handleFeatureAdd_,this),ol.events.listen(this.source_,ol.source.VectorEventType.REMOVEFEATURE,this.handleFeatureRemove_,this));r.forEach(this.forEachFeatureAdd_,this)}};ol.interaction.Snap.prototype.shouldStopEvent=ol.functions.FALSE;ol.interaction.Snap.prototype.snapTo=function(e,t,o){var r,i,n,a,l,s=o.getCoordinateFromPixel([e[0]-this.pixelTolerance_,e[1]+this.pixelTolerance_]),p=o.getCoordinateFromPixel([e[0]+this.pixelTolerance_,e[1]-this.pixelTolerance_]),c=ol.extent.boundingExtent([s,p]),u=this.rBush_.getInExtent(c),g=!1,d=!1,h=null,f=null;if(u.length>0){this.pixelCoordinate_=t;u.sort(this.sortByDistance_);var y=u[0].segment;if(this.vertex_&&!this.edge_){i=o.getPixelFromCoordinate(y[0]);n=o.getPixelFromCoordinate(y[1]);a=ol.coordinate.squaredDistance(e,i);l=ol.coordinate.squaredDistance(e,n);r=Math.sqrt(Math.min(a,l));g=r<=this.pixelTolerance_;if(g){d=!0;h=a>l?y[1]:y[0];f=o.getPixelFromCoordinate(h)}}else if(this.edge_){h=ol.coordinate.closestOnSegment(t,y);f=o.getPixelFromCoordinate(h);if(ol.coordinate.distance(e,f)<=this.pixelTolerance_){d=!0;if(this.vertex_){i=o.getPixelFromCoordinate(y[0]);n=o.getPixelFromCoordinate(y[1]);a=ol.coordinate.squaredDistance(f,i);l=ol.coordinate.squaredDistance(f,n);r=Math.sqrt(Math.min(a,l));g=r<=this.pixelTolerance_;if(g){h=a>l?y[1]:y[0];f=o.getPixelFromCoordinate(h)}}}}d&&(f=[Math.round(f[0]),Math.round(f[1])])}return{snapped:d,vertex:h,vertexPixel:f}};ol.interaction.Snap.prototype.updateFeature_=function(e){this.removeFeature(e,!1);this.addFeature(e,!1)};ol.interaction.Snap.prototype.writeGeometryCollectionGeometry_=function(e,t){var o,r=t.getGeometriesArray();for(o=0;o<r.length;++o)this.SEGMENT_WRITERS_[r[o].getType()].call(this,e,r[o])};ol.interaction.Snap.prototype.writeLineStringGeometry_=function(e,t){var o,r,i,n,a=t.getCoordinates();for(o=0,r=a.length-1;r>o;++o){i=a.slice(o,o+2);n={feature:e,segment:i};this.rBush_.insert(ol.extent.boundingExtent(i),n)}};ol.interaction.Snap.prototype.writeMultiLineStringGeometry_=function(e,t){var o,r,i,n,a,l,s,p=t.getCoordinates();for(n=0,a=p.length;a>n;++n){o=p[n];for(r=0,i=o.length-1;i>r;++r){l=o.slice(r,r+2);s={feature:e,segment:l};this.rBush_.insert(ol.extent.boundingExtent(l),s)}}};ol.interaction.Snap.prototype.writeMultiPointGeometry_=function(e,t){var o,r,i,n,a=t.getCoordinates();for(r=0,i=a.length;i>r;++r){o=a[r];n={feature:e,segment:[o,o]};this.rBush_.insert(t.getExtent(),n)}};ol.interaction.Snap.prototype.writeMultiPolygonGeometry_=function(e,t){var o,r,i,n,a,l,s,p,c,u,g=t.getCoordinates();for(l=0,s=g.length;s>l;++l){p=g[l];for(n=0,a=p.length;a>n;++n){o=p[n];for(r=0,i=o.length-1;i>r;++r){c=o.slice(r,r+2);u={feature:e,segment:c};this.rBush_.insert(ol.extent.boundingExtent(c),u)}}}};ol.interaction.Snap.prototype.writePointGeometry_=function(e,t){var o=t.getCoordinates(),r={feature:e,segment:[o,o]};this.rBush_.insert(t.getExtent(),r)};ol.interaction.Snap.prototype.writePolygonGeometry_=function(e,t){var o,r,i,n,a,l,s,p=t.getCoordinates();for(n=0,a=p.length;a>n;++n){o=p[n];for(r=0,i=o.length-1;i>r;++r){l=o.slice(r,r+2);s={feature:e,segment:l};this.rBush_.insert(ol.extent.boundingExtent(l),s)}}};ol.interaction.Snap.handleEvent_=function(e){var t=this.snapTo(e.pixel,e.coordinate,e.map);if(t.snapped){e.coordinate=t.vertex.slice(0,2);e.pixel=t.vertexPixel}return ol.interaction.Pointer.handleEvent.call(this,e)};ol.interaction.Snap.handleUpEvent_=function(e){var t=ol.obj.getValues(this.pendingFeatures_);if(t.length){t.forEach(this.updateFeature_,this);this.pendingFeatures_={}}return!1};ol.interaction.Snap.sortByDistance=function(e,t){return ol.coordinate.squaredDistanceToSegment(this.pixelCoordinate_,e.segment)-ol.coordinate.squaredDistanceToSegment(this.pixelCoordinate_,t.segment)};goog.provide("ol.interaction.TranslateEventType");ol.interaction.TranslateEventType={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"};goog.provide("ol.interaction.Translate");goog.require("ol");goog.require("ol.Collection");goog.require("ol.events");goog.require("ol.events.Event");goog.require("ol.functions");goog.require("ol.array");goog.require("ol.interaction.Pointer");goog.require("ol.interaction.TranslateEventType");ol.interaction.Translate=function(e){ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.Translate.handleDownEvent_,handleDragEvent:ol.interaction.Translate.handleDragEvent_,handleMoveEvent:ol.interaction.Translate.handleMoveEvent_,handleUpEvent:ol.interaction.Translate.handleUpEvent_});var t=e?e:{};this.previousCursor_=void 0;this.lastCoordinate_=null;this.features_=void 0!==t.features?t.features:null;var o;if(t.layers)if("function"==typeof t.layers)o=t.layers;else{var r=t.layers;o=function(e){return ol.array.includes(r,e)}}else o=ol.functions.TRUE;this.layerFilter_=o;this.hitTolerance_=t.hitTolerance?t.hitTolerance:0;this.lastFeature_=null;ol.events.listen(this,ol.Object.getChangeEventType(ol.interaction.Property.ACTIVE),this.handleActiveChanged_,this)};ol.inherits(ol.interaction.Translate,ol.interaction.Pointer);ol.interaction.Translate.handleDownEvent_=function(e){this.lastFeature_=this.featuresAtPixel_(e.pixel,e.map);if(!this.lastCoordinate_&&this.lastFeature_){this.lastCoordinate_=e.coordinate;ol.interaction.Translate.handleMoveEvent_.call(this,e);var t=this.features_||new ol.Collection([this.lastFeature_]);this.dispatchEvent(new ol.interaction.Translate.Event(ol.interaction.TranslateEventType.TRANSLATESTART,t,e.coordinate));return!0}return!1};ol.interaction.Translate.handleUpEvent_=function(e){if(this.lastCoordinate_){this.lastCoordinate_=null;ol.interaction.Translate.handleMoveEvent_.call(this,e);var t=this.features_||new ol.Collection([this.lastFeature_]);this.dispatchEvent(new ol.interaction.Translate.Event(ol.interaction.TranslateEventType.TRANSLATEEND,t,e.coordinate));return!0}return!1};ol.interaction.Translate.handleDragEvent_=function(e){if(this.lastCoordinate_){var t=e.coordinate,o=t[0]-this.lastCoordinate_[0],r=t[1]-this.lastCoordinate_[1],i=this.features_||new ol.Collection([this.lastFeature_]);i.forEach(function(e){var t=e.getGeometry();t.translate(o,r);e.setGeometry(t)});this.lastCoordinate_=t;this.dispatchEvent(new ol.interaction.Translate.Event(ol.interaction.TranslateEventType.TRANSLATING,i,t))}};ol.interaction.Translate.handleMoveEvent_=function(e){var t=e.map.getTargetElement();if(this.featuresAtPixel_(e.pixel,e.map)){this.previousCursor_=void 0!==this.previousCursor_?this.previousCursor_:t.style.cursor;t.style.cursor=this.lastCoordinate_?"-webkit-grabbing":"-webkit-grab";t.style.cursor=this.lastCoordinate_?"grabbing":"grab"}else if(void 0!==this.previousCursor_){t.style.cursor=this.previousCursor_;this.previousCursor_=void 0}};ol.interaction.Translate.prototype.featuresAtPixel_=function(e,t){return t.forEachFeatureAtPixel(e,function(e){return!this.features_||ol.array.includes(this.features_.getArray(),e)?e:void 0}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})};ol.interaction.Translate.prototype.getHitTolerance=function(){return this.hitTolerance_};ol.interaction.Translate.prototype.setHitTolerance=function(e){this.hitTolerance_=e};ol.interaction.Translate.prototype.setMap=function(e){var t=this.getMap();ol.interaction.Pointer.prototype.setMap.call(this,e);this.updateState_(t)};ol.interaction.Translate.prototype.handleActiveChanged_=function(){this.updateState_(null)};ol.interaction.Translate.prototype.updateState_=function(e){var t=this.getMap(),o=this.getActive();if(!(t&&o||void 0===this.previousCursor_)){t||(t=e);var r=t.getTargetElement();r.style.cursor=this.previousCursor_;this.previousCursor_=void 0}};ol.interaction.Translate.Event=function(e,t,o){ol.events.Event.call(this,e);this.features=t;this.coordinate=o};ol.inherits(ol.interaction.Translate.Event,ol.events.Event);goog.provide("ol.layer.Heatmap");goog.require("ol.events");goog.require("ol");goog.require("ol.Object");goog.require("ol.dom");goog.require("ol.layer.Vector");goog.require("ol.math");goog.require("ol.obj");goog.require("ol.render.EventType");goog.require("ol.style.Icon");goog.require("ol.style.Style");ol.layer.Heatmap=function(e){var t=e?e:{},o=ol.obj.assign({},t);delete o.gradient;delete o.radius;delete o.blur;delete o.shadow;delete o.weight;ol.layer.Vector.call(this,o);this.gradient_=null;this.shadow_=void 0!==t.shadow?t.shadow:250;this.circleImage_=void 0;this.styleCache_=null;ol.events.listen(this,ol.Object.getChangeEventType(ol.layer.Heatmap.Property_.GRADIENT),this.handleGradientChanged_,this);this.setGradient(t.gradient?t.gradient:ol.layer.Heatmap.DEFAULT_GRADIENT);this.setBlur(void 0!==t.blur?t.blur:15);this.setRadius(void 0!==t.radius?t.radius:8);ol.events.listen(this,ol.Object.getChangeEventType(ol.layer.Heatmap.Property_.BLUR),this.handleStyleChanged_,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.layer.Heatmap.Property_.RADIUS),this.handleStyleChanged_,this);this.handleStyleChanged_();var r,i=t.weight?t.weight:"weight";r="string"==typeof i?function(e){return e.get(i)}:i;this.setStyle(function(e,t){var o=r(e),i=void 0!==o?ol.math.clamp(o,0,1):1,n=255*i|0,a=this.styleCache_[n];if(!a){a=[new ol.style.Style({image:new ol.style.Icon({opacity:i,src:this.circleImage_})})];this.styleCache_[n]=a}return a}.bind(this));this.setRenderOrder(null);ol.events.listen(this,ol.render.EventType.RENDER,this.handleRender_,this)};ol.inherits(ol.layer.Heatmap,ol.layer.Vector);ol.layer.Heatmap.DEFAULT_GRADIENT=["#00f","#0ff","#0f0","#ff0","#f00"];ol.layer.Heatmap.createGradient_=function(e){for(var t=1,o=256,r=ol.dom.createCanvasContext2D(t,o),i=r.createLinearGradient(0,0,t,o),n=1/(e.length-1),a=0,l=e.length;l>a;++a)i.addColorStop(a*n,e[a]);r.fillStyle=i;r.fillRect(0,0,t,o);return r.getImageData(0,0,t,o).data};ol.layer.Heatmap.prototype.createCircle_=function(){var e=this.getRadius(),t=this.getBlur(),o=e+t+1,r=2*o,i=ol.dom.createCanvasContext2D(r,r);i.shadowOffsetX=i.shadowOffsetY=this.shadow_;i.shadowBlur=t;i.shadowColor="#000";i.beginPath();var n=o-this.shadow_;i.arc(n,n,e,0,2*Math.PI,!0);i.fill();return i.canvas.toDataURL()};ol.layer.Heatmap.prototype.getBlur=function(){return this.get(ol.layer.Heatmap.Property_.BLUR)};ol.layer.Heatmap.prototype.getGradient=function(){return this.get(ol.layer.Heatmap.Property_.GRADIENT)};ol.layer.Heatmap.prototype.getRadius=function(){return this.get(ol.layer.Heatmap.Property_.RADIUS)};ol.layer.Heatmap.prototype.handleGradientChanged_=function(){this.gradient_=ol.layer.Heatmap.createGradient_(this.getGradient())};ol.layer.Heatmap.prototype.handleStyleChanged_=function(){this.circleImage_=this.createCircle_();this.styleCache_=new Array(256);this.changed()};ol.layer.Heatmap.prototype.handleRender_=function(e){var t,o,r,i=e.context,n=i.canvas,a=i.getImageData(0,0,n.width,n.height),l=a.data;for(t=0,o=l.length;o>t;t+=4){r=4*l[t+3];if(r){l[t]=this.gradient_[r];l[t+1]=this.gradient_[r+1];l[t+2]=this.gradient_[r+2]}}i.putImageData(a,0,0)};ol.layer.Heatmap.prototype.setBlur=function(e){this.set(ol.layer.Heatmap.Property_.BLUR,e)};ol.layer.Heatmap.prototype.setGradient=function(e){this.set(ol.layer.Heatmap.Property_.GRADIENT,e)};ol.layer.Heatmap.prototype.setRadius=function(e){this.set(ol.layer.Heatmap.Property_.RADIUS,e)};ol.layer.Heatmap.Property_={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"};goog.provide("ol.renderer.canvas.IntermediateCanvas");goog.require("ol");goog.require("ol.coordinate");goog.require("ol.dom");goog.require("ol.extent");goog.require("ol.renderer.canvas.Layer");goog.require("ol.transform");ol.renderer.canvas.IntermediateCanvas=function(e){ol.renderer.canvas.Layer.call(this,e);this.coordinateToCanvasPixelTransform=ol.transform.create();this.hitCanvasContext_=null};ol.inherits(ol.renderer.canvas.IntermediateCanvas,ol.renderer.canvas.Layer);ol.renderer.canvas.IntermediateCanvas.prototype.composeFrame=function(e,t,o){this.preCompose(o,e);var r=this.getImage();if(r){var i=t.extent,n=void 0!==i&&!ol.extent.containsExtent(i,e.extent)&&ol.extent.intersects(i,e.extent);n&&this.clip(o,e,i);var a=this.getImageTransform(),l=o.globalAlpha;o.globalAlpha=t.opacity;var s=a[4],p=a[5],c=r.width*a[0],u=r.height*a[3];o.drawImage(r,0,0,+r.width,+r.height,Math.round(s),Math.round(p),Math.round(c),Math.round(u));o.globalAlpha=l;n&&o.restore()}this.postCompose(o,e,t)};ol.renderer.canvas.IntermediateCanvas.prototype.getImage=function(){};ol.renderer.canvas.IntermediateCanvas.prototype.getImageTransform=function(){};ol.renderer.canvas.IntermediateCanvas.prototype.forEachFeatureAtCoordinate=function(e,t,o,r,i){var n=this.getLayer(),a=n.getSource(),l=t.viewState.resolution,s=t.viewState.rotation,p=t.skippedFeatureUids;return a.forEachFeatureAtCoordinate(e,l,s,o,p,function(e){return r.call(i,e,n)})};ol.renderer.canvas.IntermediateCanvas.prototype.forEachLayerAtCoordinate=function(e,t,o,r){if(!this.getImage())return void 0;if(this.getLayer().getSource().forEachFeatureAtCoordinate!==ol.nullFunction)return ol.renderer.canvas.Layer.prototype.forEachLayerAtCoordinate.apply(this,arguments);var i=ol.transform.apply(this.coordinateToCanvasPixelTransform,e.slice());ol.coordinate.scale(i,t.viewState.resolution/this.renderedResolution);this.hitCanvasContext_||(this.hitCanvasContext_=ol.dom.createCanvasContext2D(1,1));this.hitCanvasContext_.clearRect(0,0,1,1);this.hitCanvasContext_.drawImage(this.getImage(),i[0],i[1],1,1,0,0,1,1);var n=this.hitCanvasContext_.getImageData(0,0,1,1).data;return n[3]>0?o.call(r,this.getLayer(),n):void 0};goog.provide("ol.renderer.canvas.ImageLayer");goog.require("ol");goog.require("ol.ViewHint");goog.require("ol.extent");goog.require("ol.renderer.canvas.IntermediateCanvas");goog.require("ol.transform");ol.renderer.canvas.ImageLayer=function(e){ol.renderer.canvas.IntermediateCanvas.call(this,e);this.image_=null;this.imageTransform_=ol.transform.create()};ol.inherits(ol.renderer.canvas.ImageLayer,ol.renderer.canvas.IntermediateCanvas);ol.renderer.canvas.ImageLayer.prototype.getImage=function(){return this.image_?this.image_.getImage():null};ol.renderer.canvas.ImageLayer.prototype.getImageTransform=function(){return this.imageTransform_};ol.renderer.canvas.ImageLayer.prototype.prepareFrame=function(e,t){var o,r=e.pixelRatio,i=e.size,n=e.viewState,a=n.center,l=n.resolution,s=this.getLayer(),p=s.getSource(),c=e.viewHints,u=e.extent;void 0!==t.extent&&(u=ol.extent.getIntersection(u,t.extent));if(!c[ol.ViewHint.ANIMATING]&&!c[ol.ViewHint.INTERACTING]&&!ol.extent.isEmpty(u)){var g=n.projection;if(!ol.ENABLE_RASTER_REPROJECTION){var d=p.getProjection();d&&(g=d)}o=p.getImage(u,l,r,g);if(o){var h=this.loadImage(o);h&&(this.image_=o)}}if(this.image_){o=this.image_;var f=o.getExtent(),y=o.getResolution(),m=o.getPixelRatio(),v=r*y/(l*m),C=ol.transform.compose(this.imageTransform_,r*i[0]/2,r*i[1]/2,v,v,0,m*(f[0]-a[0])/y,m*(a[1]-f[3])/y);ol.transform.compose(this.coordinateToCanvasPixelTransform,r*i[0]/2-C[4],r*i[1]/2-C[5],r/l,-r/l,0,-a[0],-a[1]);this.updateAttributions(e.attributions,o.getAttributions());this.updateLogos(e,p);this.renderedResolution=l*r/m}return!!this.image_};goog.provide("ol.reproj");goog.require("ol.dom");goog.require("ol.extent");goog.require("ol.math");goog.require("ol.proj");ol.reproj.calculateSourceResolution=function(e,t,o,r){var i=ol.proj.transform(o,t,e),n=ol.proj.getPointResolution(t,r,o),a=t.getMetersPerUnit();void 0!==a&&(n*=a);var l=e.getMetersPerUnit();void 0!==l&&(n/=l);var s=ol.proj.getPointResolution(e,n,i)/n;isFinite(s)&&s>0&&(n/=s);return n};ol.reproj.enlargeClipPoint_=function(e,t,o,r){var i=o-e,n=r-t,a=Math.sqrt(i*i+n*n);return[Math.round(o+i/a),Math.round(r+n/a)]};ol.reproj.render=function(e,t,o,r,i,n,a,l,s,p,c){var u=ol.dom.createCanvasContext2D(Math.round(o*e),Math.round(o*t));if(0===s.length)return u.canvas;u.scale(o,o);var g=ol.extent.createEmpty();s.forEach(function(e,t,o){ol.extent.extend(g,e.extent)});var d=ol.extent.getWidth(g),h=ol.extent.getHeight(g),f=ol.dom.createCanvasContext2D(Math.round(o*d/r),Math.round(o*h/r)),y=o/r;s.forEach(function(e,t,o){var r=e.extent[0]-g[0],i=-(e.extent[3]-g[3]),n=ol.extent.getWidth(e.extent),a=ol.extent.getHeight(e.extent);f.drawImage(e.image,p,p,e.image.width-2*p,e.image.height-2*p,r*y,i*y,n*y,a*y)});var m=ol.extent.getTopLeft(a);l.getTriangles().forEach(function(e,t,i){var a=e.source,l=e.target,s=a[0][0],p=a[0][1],c=a[1][0],d=a[1][1],h=a[2][0],y=a[2][1],v=(l[0][0]-m[0])/n,C=-(l[0][1]-m[1])/n,T=(l[1][0]-m[0])/n,_=-(l[1][1]-m[1])/n,S=(l[2][0]-m[0])/n,E=-(l[2][1]-m[1])/n,x=s,P=p;s=0;p=0;c-=x;d-=P;h-=x;y-=P;var L=[[c,d,0,0,T-v],[h,y,0,0,S-v],[0,0,c,d,_-C],[0,0,h,y,E-C]],w=ol.math.solveLinearSystem(L);if(w){u.save();u.beginPath();var R=(v+T+S)/3,A=(C+_+E)/3,b=ol.reproj.enlargeClipPoint_(R,A,v,C),M=ol.reproj.enlargeClipPoint_(R,A,T,_),I=ol.reproj.enlargeClipPoint_(R,A,S,E);u.moveTo(M[0],M[1]);u.lineTo(b[0],b[1]);u.lineTo(I[0],I[1]);u.clip();u.transform(w[0],w[2],w[1],w[3],v,C);u.translate(g[0]-x,g[3]-P);u.scale(r/o,-r/o);u.drawImage(f.canvas,0,0);u.restore()}});if(c){u.save();u.strokeStyle="black";u.lineWidth=1;l.getTriangles().forEach(function(e,t,o){var r=e.target,i=(r[0][0]-m[0])/n,a=-(r[0][1]-m[1])/n,l=(r[1][0]-m[0])/n,s=-(r[1][1]-m[1])/n,p=(r[2][0]-m[0])/n,c=-(r[2][1]-m[1])/n;u.beginPath();u.moveTo(l,s);u.lineTo(i,a);u.lineTo(p,c);u.closePath();u.stroke()});u.restore()}return u.canvas};goog.provide("ol.reproj.Triangulation");goog.require("ol");goog.require("ol.extent");goog.require("ol.math");goog.require("ol.proj");ol.reproj.Triangulation=function(e,t,o,r,i){this.sourceProj_=e;this.targetProj_=t;var n={},a=ol.proj.getTransform(this.targetProj_,this.sourceProj_);this.transformInv_=function(e){var t=e[0]+"/"+e[1];n[t]||(n[t]=a(e));return n[t]};this.maxSourceExtent_=r;this.errorThresholdSquared_=i*i;this.triangles_=[];this.wrapsXInSource_=!1;this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&ol.extent.getWidth(r)==ol.extent.getWidth(this.sourceProj_.getExtent());this.sourceWorldWidth_=this.sourceProj_.getExtent()?ol.extent.getWidth(this.sourceProj_.getExtent()):null;this.targetWorldWidth_=this.targetProj_.getExtent()?ol.extent.getWidth(this.targetProj_.getExtent()):null;var l=ol.extent.getTopLeft(o),s=ol.extent.getTopRight(o),p=ol.extent.getBottomRight(o),c=ol.extent.getBottomLeft(o),u=this.transformInv_(l),g=this.transformInv_(s),d=this.transformInv_(p),h=this.transformInv_(c);this.addQuad_(l,s,p,c,u,g,d,h,ol.RASTER_REPROJECTION_MAX_SUBDIVISION);if(this.wrapsXInSource_){var f=1/0;this.triangles_.forEach(function(e,t,o){f=Math.min(f,e.source[0][0],e.source[1][0],e.source[2][0])});this.triangles_.forEach(function(e){if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-f>this.sourceWorldWidth_/2){var t=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];t[0][0]-f>this.sourceWorldWidth_/2&&(t[0][0]-=this.sourceWorldWidth_);t[1][0]-f>this.sourceWorldWidth_/2&&(t[1][0]-=this.sourceWorldWidth_);t[2][0]-f>this.sourceWorldWidth_/2&&(t[2][0]-=this.sourceWorldWidth_);var o=Math.min(t[0][0],t[1][0],t[2][0]),r=Math.max(t[0][0],t[1][0],t[2][0]);r-o<this.sourceWorldWidth_/2&&(e.source=t)}},this)}n={}};ol.reproj.Triangulation.prototype.addTriangle_=function(e,t,o,r,i,n){this.triangles_.push({source:[r,i,n],target:[e,t,o]})};ol.reproj.Triangulation.prototype.addQuad_=function(e,t,o,r,i,n,a,l,s){var p=ol.extent.boundingExtent([i,n,a,l]),c=this.sourceWorldWidth_?ol.extent.getWidth(p)/this.sourceWorldWidth_:null,u=this.sourceWorldWidth_,g=this.sourceProj_.canWrapX()&&c>.5&&1>c,d=!1;if(s>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var h=ol.extent.boundingExtent([e,t,o,r]),f=ol.extent.getWidth(h)/this.targetWorldWidth_;d|=f>ol.RASTER_REPROJECTION_MAX_TRIANGLE_WIDTH}!g&&this.sourceProj_.isGlobal()&&c&&(d|=c>ol.RASTER_REPROJECTION_MAX_TRIANGLE_WIDTH)}if(d||!this.maxSourceExtent_||ol.extent.intersects(p,this.maxSourceExtent_)){if(!(d||isFinite(i[0])&&isFinite(i[1])&&isFinite(n[0])&&isFinite(n[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(l[0])&&isFinite(l[1]))){if(!(s>0))return;d=!0}if(s>0){if(!d){var y,m=[(e[0]+o[0])/2,(e[1]+o[1])/2],v=this.transformInv_(m);if(g){var C=(ol.math.modulo(i[0],u)+ol.math.modulo(a[0],u))/2;y=C-ol.math.modulo(v[0],u)}else y=(i[0]+a[0])/2-v[0];var T=(i[1]+a[1])/2-v[1],_=y*y+T*T;d=_>this.errorThresholdSquared_}if(d){if(Math.abs(e[0]-o[0])<=Math.abs(e[1]-o[1])){var S=[(t[0]+o[0])/2,(t[1]+o[1])/2],E=this.transformInv_(S),x=[(r[0]+e[0])/2,(r[1]+e[1])/2],P=this.transformInv_(x);this.addQuad_(e,t,S,x,i,n,E,P,s-1);this.addQuad_(x,S,o,r,P,E,a,l,s-1)}else{var L=[(e[0]+t[0])/2,(e[1]+t[1])/2],w=this.transformInv_(L),R=[(o[0]+r[0])/2,(o[1]+r[1])/2],A=this.transformInv_(R);this.addQuad_(e,L,R,r,i,w,A,l,s-1);this.addQuad_(L,t,o,R,w,n,a,A,s-1)}return}}if(g){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(e,o,r,i,a,l);this.addTriangle_(e,t,o,i,n,a)}};ol.reproj.Triangulation.prototype.calculateSourceExtent=function(){var e=ol.extent.createEmpty();this.triangles_.forEach(function(t,o,r){var i=t.source;ol.extent.extendCoordinate(e,i[0]);ol.extent.extendCoordinate(e,i[1]);ol.extent.extendCoordinate(e,i[2])});return e};ol.reproj.Triangulation.prototype.getTriangles=function(){return this.triangles_};goog.provide("ol.reproj.Image");goog.require("ol");goog.require("ol.ImageBase");goog.require("ol.ImageState");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.extent");goog.require("ol.reproj");goog.require("ol.reproj.Triangulation");ol.reproj.Image=function(e,t,o,r,i,n){this.targetProj_=t;this.maxSourceExtent_=e.getExtent();var a=t.getExtent(),l=a?ol.extent.getIntersection(o,a):o,s=ol.extent.getCenter(l),p=ol.reproj.calculateSourceResolution(e,t,s,r),c=ol.DEFAULT_RASTER_REPROJECTION_ERROR_THRESHOLD;this.triangulation_=new ol.reproj.Triangulation(e,t,l,this.maxSourceExtent_,p*c);this.targetResolution_=r;this.targetExtent_=o;var u=this.triangulation_.calculateSourceExtent();this.sourceImage_=n(u,p,i);this.sourcePixelRatio_=this.sourceImage_?this.sourceImage_.getPixelRatio():1;this.canvas_=null;this.sourceListenerKey_=null;var g=ol.ImageState.LOADED,d=[];if(this.sourceImage_){g=ol.ImageState.IDLE;d=this.sourceImage_.getAttributions()}ol.ImageBase.call(this,o,r,this.sourcePixelRatio_,g,d)};ol.inherits(ol.reproj.Image,ol.ImageBase);ol.reproj.Image.prototype.disposeInternal=function(){this.state==ol.ImageState.LOADING&&this.unlistenSource_();ol.ImageBase.prototype.disposeInternal.call(this)};ol.reproj.Image.prototype.getImage=function(e){return this.canvas_};ol.reproj.Image.prototype.getProjection=function(){return this.targetProj_};ol.reproj.Image.prototype.reproject_=function(){var e=this.sourceImage_.getState();if(e==ol.ImageState.LOADED){var t=ol.extent.getWidth(this.targetExtent_)/this.targetResolution_,o=ol.extent.getHeight(this.targetExtent_)/this.targetResolution_;this.canvas_=ol.reproj.render(t,o,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=e;this.changed()};ol.reproj.Image.prototype.load=function(){if(this.state==ol.ImageState.IDLE){this.state=ol.ImageState.LOADING;this.changed();var e=this.sourceImage_.getState();if(e==ol.ImageState.LOADED||e==ol.ImageState.ERROR)this.reproject_();else{this.sourceListenerKey_=ol.events.listen(this.sourceImage_,ol.events.EventType.CHANGE,function(e){var t=this.sourceImage_.getState();if(t==ol.ImageState.LOADED||t==ol.ImageState.ERROR){this.unlistenSource_();this.reproject_()}},this);this.sourceImage_.load()}}};ol.reproj.Image.prototype.unlistenSource_=function(){ol.events.unlistenByKey(this.sourceListenerKey_);this.sourceListenerKey_=null};goog.provide("ol.source.Image");goog.require("ol");goog.require("ol.ImageState");goog.require("ol.array");goog.require("ol.events.Event");goog.require("ol.extent");goog.require("ol.proj");goog.require("ol.reproj.Image");goog.require("ol.source.Source");ol.source.Image=function(e){ol.source.Source.call(this,{attributions:e.attributions,extent:e.extent,logo:e.logo,projection:e.projection,state:e.state});this.resolutions_=void 0!==e.resolutions?e.resolutions:null;this.reprojectedImage_=null;this.reprojectedRevision_=0};ol.inherits(ol.source.Image,ol.source.Source);ol.source.Image.prototype.getResolutions=function(){return this.resolutions_};ol.source.Image.prototype.findNearestResolution=function(e){if(this.resolutions_){var t=ol.array.linearFindNearest(this.resolutions_,e,0);

e=this.resolutions_[t]}return e};ol.source.Image.prototype.getImage=function(e,t,o,r){var i=this.getProjection();if(ol.ENABLE_RASTER_REPROJECTION&&i&&r&&!ol.proj.equivalent(i,r)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&ol.proj.equivalent(this.reprojectedImage_.getProjection(),r)&&this.reprojectedImage_.getResolution()==t&&this.reprojectedImage_.getPixelRatio()==o&&ol.extent.equals(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose();this.reprojectedImage_=null}this.reprojectedImage_=new ol.reproj.Image(i,r,e,t,o,function(e,t,o){return this.getImageInternal(e,t,o,i)}.bind(this));this.reprojectedRevision_=this.getRevision();return this.reprojectedImage_}i&&(r=i);return this.getImageInternal(e,t,o,r)};ol.source.Image.prototype.getImageInternal=function(e,t,o,r){};ol.source.Image.prototype.handleImageChange=function(e){var t=e.target;switch(t.getState()){case ol.ImageState.LOADING:this.dispatchEvent(new ol.source.Image.Event(ol.source.Image.EventType_.IMAGELOADSTART,t));break;case ol.ImageState.LOADED:this.dispatchEvent(new ol.source.Image.Event(ol.source.Image.EventType_.IMAGELOADEND,t));break;case ol.ImageState.ERROR:this.dispatchEvent(new ol.source.Image.Event(ol.source.Image.EventType_.IMAGELOADERROR,t))}};ol.source.Image.defaultImageLoadFunction=function(e,t){e.getImage().src=t};ol.source.Image.Event=function(e,t){ol.events.Event.call(this,e);this.image=t};ol.inherits(ol.source.Image.Event,ol.events.Event);ol.source.Image.EventType_={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};goog.provide("ol.source.ImageCanvas");goog.require("ol");goog.require("ol.ImageCanvas");goog.require("ol.extent");goog.require("ol.source.Image");ol.source.ImageCanvas=function(e){ol.source.Image.call(this,{attributions:e.attributions,logo:e.logo,projection:e.projection,resolutions:e.resolutions,state:e.state});this.canvasFunction_=e.canvasFunction;this.canvas_=null;this.renderedRevision_=0;this.ratio_=void 0!==e.ratio?e.ratio:1.5};ol.inherits(ol.source.ImageCanvas,ol.source.Image);ol.source.ImageCanvas.prototype.getImageInternal=function(e,t,o,r){t=this.findNearestResolution(t);var i=this.canvas_;if(i&&this.renderedRevision_==this.getRevision()&&i.getResolution()==t&&i.getPixelRatio()==o&&ol.extent.containsExtent(i.getExtent(),e))return i;e=e.slice();ol.extent.scaleFromCenter(e,this.ratio_);var n=ol.extent.getWidth(e)/t,a=ol.extent.getHeight(e)/t,l=[n*o,a*o],s=this.canvasFunction_(e,t,o,l,r);s&&(i=new ol.ImageCanvas(e,t,o,this.getAttributions(),s));this.canvas_=i;this.renderedRevision_=this.getRevision();return i};goog.provide("ol.source.ImageVector");goog.require("ol");goog.require("ol.dom");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.extent");goog.require("ol.render.canvas.ReplayGroup");goog.require("ol.renderer.vector");goog.require("ol.source.ImageCanvas");goog.require("ol.style.Style");goog.require("ol.transform");ol.source.ImageVector=function(e){this.source_=e.source;this.transform_=ol.transform.create();this.canvasContext_=ol.dom.createCanvasContext2D();this.canvasSize_=[0,0];this.renderBuffer_=void 0==e.renderBuffer?100:e.renderBuffer;this.replayGroup_=null;ol.source.ImageCanvas.call(this,{attributions:e.attributions,canvasFunction:this.canvasFunctionInternal_.bind(this),logo:e.logo,projection:e.projection,ratio:e.ratio,resolutions:e.resolutions,state:this.source_.getState()});this.style_=null;this.styleFunction_=void 0;this.setStyle(e.style);ol.events.listen(this.source_,ol.events.EventType.CHANGE,this.handleSourceChange_,this)};ol.inherits(ol.source.ImageVector,ol.source.ImageCanvas);ol.source.ImageVector.prototype.canvasFunctionInternal_=function(e,t,o,r,i){var n=new ol.render.canvas.ReplayGroup(ol.renderer.vector.getTolerance(t,o),e,t,this.source_.getOverlaps(),this.renderBuffer_);this.source_.loadFeatures(e,t,i);var a=!1;this.source_.forEachFeatureInExtent(e,function(e){a=a||this.renderFeature_(e,t,o,n)},this);n.finish();if(a)return null;if(this.canvasSize_[0]!=r[0]||this.canvasSize_[1]!=r[1]){this.canvasContext_.canvas.width=r[0];this.canvasContext_.canvas.height=r[1];this.canvasSize_[0]=r[0];this.canvasSize_[1]=r[1]}else this.canvasContext_.clearRect(0,0,r[0],r[1]);var l=this.getTransform_(ol.extent.getCenter(e),t,o,r);n.replay(this.canvasContext_,o,l,0,{});this.replayGroup_=n;return this.canvasContext_.canvas};ol.source.ImageVector.prototype.forEachFeatureAtCoordinate=function(e,t,o,r,i,n){if(this.replayGroup_){var a={};return this.replayGroup_.forEachFeatureAtCoordinate(e,t,0,r,i,function(e){var t=ol.getUid(e).toString();if(!(t in a)){a[t]=!0;return n(e)}})}return void 0};ol.source.ImageVector.prototype.getSource=function(){return this.source_};ol.source.ImageVector.prototype.getStyle=function(){return this.style_};ol.source.ImageVector.prototype.getStyleFunction=function(){return this.styleFunction_};ol.source.ImageVector.prototype.getTransform_=function(e,t,o,r){var i=r[0]/2,n=r[1]/2,a=o/t,l=-a,s=-e[0],p=-e[1];return ol.transform.compose(this.transform_,i,n,a,l,0,s,p)};ol.source.ImageVector.prototype.handleImageChange_=function(e){this.changed()};ol.source.ImageVector.prototype.handleSourceChange_=function(){this.setState(this.source_.getState())};ol.source.ImageVector.prototype.renderFeature_=function(e,t,o,r){var i,n=e.getStyleFunction();n?i=n.call(e,t):this.styleFunction_&&(i=this.styleFunction_(e,t));if(!i)return!1;var a,l,s=!1;Array.isArray(i)||(i=[i]);for(a=0,l=i.length;l>a;++a)s=ol.renderer.vector.renderFeature(r,e,i[a],ol.renderer.vector.getSquaredTolerance(t,o),this.handleImageChange_,this)||s;return s};ol.source.ImageVector.prototype.setStyle=function(e){this.style_=void 0!==e?e:ol.style.Style.defaultFunction;this.styleFunction_=e?ol.style.Style.createFunction(this.style_):void 0;this.changed()};goog.provide("ol.renderer.webgl.ImageLayer");goog.require("ol");goog.require("ol.ViewHint");goog.require("ol.dom");goog.require("ol.extent");goog.require("ol.functions");goog.require("ol.renderer.webgl.Layer");goog.require("ol.source.ImageVector");goog.require("ol.transform");goog.require("ol.webgl");goog.require("ol.webgl.Context");if(ol.ENABLE_WEBGL){ol.renderer.webgl.ImageLayer=function(e,t){ol.renderer.webgl.Layer.call(this,e,t);this.image_=null;this.hitCanvasContext_=null;this.hitTransformationMatrix_=null};ol.inherits(ol.renderer.webgl.ImageLayer,ol.renderer.webgl.Layer);ol.renderer.webgl.ImageLayer.prototype.createTexture_=function(e){var t=e.getImage(),o=this.mapRenderer.getGL();return ol.webgl.Context.createTexture(o,t,ol.webgl.CLAMP_TO_EDGE,ol.webgl.CLAMP_TO_EDGE)};ol.renderer.webgl.ImageLayer.prototype.forEachFeatureAtCoordinate=function(e,t,o,r,i){var n=this.getLayer(),a=n.getSource(),l=t.viewState.resolution,s=t.viewState.rotation,p=t.skippedFeatureUids;return a.forEachFeatureAtCoordinate(e,l,s,o,p,function(e){return r.call(i,e,n)})};ol.renderer.webgl.ImageLayer.prototype.prepareFrame=function(e,t,o){var r=this.mapRenderer.getGL(),i=e.pixelRatio,n=e.viewState,a=n.center,l=n.resolution,s=n.rotation,p=this.image_,c=this.texture,u=this.getLayer(),g=u.getSource(),d=e.viewHints,h=e.extent;void 0!==t.extent&&(h=ol.extent.getIntersection(h,t.extent));if(!d[ol.ViewHint.ANIMATING]&&!d[ol.ViewHint.INTERACTING]&&!ol.extent.isEmpty(h)){var f=n.projection;if(!ol.ENABLE_RASTER_REPROJECTION){var y=g.getProjection();y&&(f=y)}var m=g.getImage(h,l,i,f);if(m){var v=this.loadImage(m);if(v){p=m;c=this.createTexture_(m);if(this.texture){var C=function(e,t){e.isContextLost()||e.deleteTexture(t)}.bind(null,r,this.texture);e.postRenderFunctions.push(C)}}}}if(p){var T=this.mapRenderer.getContext().getCanvas();this.updateProjectionMatrix_(T.width,T.height,i,a,l,s,p.getExtent());this.hitTransformationMatrix_=null;var _=this.texCoordMatrix;ol.transform.reset(_);ol.transform.scale(_,1,-1);ol.transform.translate(_,0,-1);this.image_=p;this.texture=c;this.updateAttributions(e.attributions,p.getAttributions());this.updateLogos(e,g)}return!!p};ol.renderer.webgl.ImageLayer.prototype.updateProjectionMatrix_=function(e,t,o,r,i,n,a){var l=e*i,s=t*i,p=this.projectionMatrix;ol.transform.reset(p);ol.transform.scale(p,2*o/l,2*o/s);ol.transform.rotate(p,-n);ol.transform.translate(p,a[0]-r[0],a[1]-r[1]);ol.transform.scale(p,(a[2]-a[0])/2,(a[3]-a[1])/2);ol.transform.translate(p,1,1)};ol.renderer.webgl.ImageLayer.prototype.hasFeatureAtCoordinate=function(e,t){var o=this.forEachFeatureAtCoordinate(e,t,0,ol.functions.TRUE,this);return void 0!==o};ol.renderer.webgl.ImageLayer.prototype.forEachLayerAtPixel=function(e,t,o,r){if(!this.image_||!this.image_.getImage())return void 0;if(this.getLayer().getSource()instanceof ol.source.ImageVector){var i=ol.transform.apply(t.pixelToCoordinateTransform,e.slice()),n=this.forEachFeatureAtCoordinate(i,t,0,ol.functions.TRUE,this);return n?o.call(r,this.getLayer(),null):void 0}var a=[this.image_.getImage().width,this.image_.getImage().height];this.hitTransformationMatrix_||(this.hitTransformationMatrix_=this.getHitTransformationMatrix_(t.size,a));var l=ol.transform.apply(this.hitTransformationMatrix_,e.slice());if(l[0]<0||l[0]>a[0]||l[1]<0||l[1]>a[1])return void 0;this.hitCanvasContext_||(this.hitCanvasContext_=ol.dom.createCanvasContext2D(1,1));this.hitCanvasContext_.clearRect(0,0,1,1);this.hitCanvasContext_.drawImage(this.image_.getImage(),l[0],l[1],1,1,0,0,1,1);var s=this.hitCanvasContext_.getImageData(0,0,1,1).data;return s[3]>0?o.call(r,this.getLayer(),s):void 0};ol.renderer.webgl.ImageLayer.prototype.getHitTransformationMatrix_=function(e,t){var o=ol.transform.create();ol.transform.translate(o,-1,-1);ol.transform.scale(o,2/e[0],2/e[1]);ol.transform.translate(o,0,e[1]);ol.transform.scale(o,1,-1);var r=ol.transform.invert(this.projectionMatrix.slice()),i=ol.transform.create();ol.transform.translate(i,0,t[1]);ol.transform.scale(i,1,-1);ol.transform.scale(i,t[0]/2,t[1]/2);ol.transform.translate(i,1,1);ol.transform.multiply(i,r);ol.transform.multiply(i,o);return i}}goog.provide("ol.layer.Image");goog.require("ol");goog.require("ol.layer.Layer");goog.require("ol.renderer.Type");goog.require("ol.renderer.canvas.ImageLayer");goog.require("ol.renderer.webgl.ImageLayer");ol.layer.Image=function(e){var t=e?e:{};ol.layer.Layer.call(this,t)};ol.inherits(ol.layer.Image,ol.layer.Layer);ol.layer.Image.prototype.createRenderer=function(e){var t=null,o=e.getType();ol.ENABLE_CANVAS&&o===ol.renderer.Type.CANVAS?t=new ol.renderer.canvas.ImageLayer(this):ol.ENABLE_WEBGL&&o===ol.renderer.Type.WEBGL&&(t=new ol.renderer.webgl.ImageLayer(e,this));return t};ol.layer.Image.prototype.getSource;goog.provide("ol.layer.TileProperty");ol.layer.TileProperty={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};goog.provide("ol.renderer.canvas.TileLayer");goog.require("ol");goog.require("ol.TileRange");goog.require("ol.TileState");goog.require("ol.ViewHint");goog.require("ol.array");goog.require("ol.dom");goog.require("ol.extent");goog.require("ol.renderer.canvas.IntermediateCanvas");goog.require("ol.transform");ol.renderer.canvas.TileLayer=function(e){ol.renderer.canvas.IntermediateCanvas.call(this,e);this.context=null===this.context?null:ol.dom.createCanvasContext2D();this.oversampling_;this.renderedExtent_=null;this.renderedRevision;this.renderedTiles=[];this.tmpExtent=ol.extent.createEmpty();this.tmpTileRange_=new ol.TileRange(0,0,0,0);this.imageTransform_=ol.transform.create();this.zDirection=0};ol.inherits(ol.renderer.canvas.TileLayer,ol.renderer.canvas.IntermediateCanvas);ol.renderer.canvas.TileLayer.prototype.isDrawableTile_=function(e){var t=e.getState(),o=this.getLayer().getUseInterimTilesOnError();return t==ol.TileState.LOADED||t==ol.TileState.EMPTY||t==ol.TileState.ERROR&&!o};ol.renderer.canvas.TileLayer.prototype.prepareFrame=function(e,t){var o=e.pixelRatio,r=e.size,i=e.viewState,n=i.projection,a=i.resolution,l=i.center,s=this.getLayer(),p=s.getSource(),c=p.getRevision(),u=p.getTileGridForProjection(n),g=u.getZForResolution(a,this.zDirection),d=u.getResolution(g),h=Math.round(a/d)||1,f=e.extent;void 0!==t.extent&&(f=ol.extent.getIntersection(f,t.extent));if(ol.extent.isEmpty(f))return!1;var y=u.getTileRangeForExtentAndResolution(f,d),m=u.getTileRangeExtent(g,y),v=p.getTilePixelRatio(o),C={};C[g]={};var T,_,S,E=this.createLoadedTileFinder(p,n,C),x=this.tmpExtent,P=this.tmpTileRange_,L=!1;for(_=y.minX;_<=y.maxX;++_)for(S=y.minY;S<=y.maxY;++S){T=p.getTile(g,_,S,o,n);this.isDrawableTile_(T)||(T=T.getInterimTile());if(this.isDrawableTile_(T)){if(T.getState()==ol.TileState.LOADED){C[g][T.tileCoord.toString()]=T;L||-1!=this.renderedTiles.indexOf(T)||(L=!0)}}else{var w=u.forEachTileCoordParentTileRange(T.tileCoord,E,null,P,x);if(!w){var R=u.getTileCoordChildTileRange(T.tileCoord,P,x);R&&E(g+1,R)}}}var A=e.viewHints;if(!((this.renderedResolution&&Date.now()-e.time>16&&(A[ol.ViewHint.ANIMATING]||A[ol.ViewHint.INTERACTING])||!L&&this.renderedExtent_&&ol.extent.containsExtent(this.renderedExtent_,f)&&this.renderedRevision==c)&&h==this.oversampling_)){var b=this.context;if(b){var M=p.getTilePixelSize(g,o,n),I=Math.round(y.getWidth()*M[0]/h),O=Math.round(y.getHeight()*M[1]/h),N=b.canvas;if(N.width!=I||N.height!=O){this.oversampling_=h;N.width=I;N.height=O}else{b.clearRect(0,0,I,O);h=this.oversampling_}}this.renderedTiles.length=0;var D=Object.keys(C).map(Number);D.sort(ol.array.numberSafeCompareFunction);var F,k,G,U,B,q,j,$,W,V,Y;for(B=0,q=D.length;q>B;++B){U=D[B];G=p.getTilePixelSize(U,o,n);F=u.getResolution(U);k=F/d;$=v*p.getGutter(n);W=C[U];for(var K in W){T=W[K];j=u.getTileCoordExtent(T.getTileCoord(),x);_=(j[0]-m[0])/d*v/h;S=(m[3]-j[3])/d*v/h;V=G[0]*k/h;Y=G[1]*k/h;this.drawTileImage(T,e,t,_,S,V,Y,$);this.renderedTiles.push(T)}}this.renderedRevision=c;this.renderedResolution=d*o/v*h;this.renderedExtent_=m}var X=this.renderedResolution/a,H=ol.transform.compose(this.imageTransform_,o*r[0]/2,o*r[1]/2,X,X,0,(this.renderedExtent_[0]-l[0])/this.renderedResolution*o,(l[1]-this.renderedExtent_[3])/this.renderedResolution*o);ol.transform.compose(this.coordinateToCanvasPixelTransform,o*r[0]/2-H[4],o*r[1]/2-H[5],o/a,-o/a,0,-l[0],-l[1]);this.updateUsedTiles(e.usedTiles,p,g,y);this.manageTilePyramid(e,p,u,o,n,f,g,s.getPreload());this.scheduleExpireCache(e,p);this.updateLogos(e,p);return this.renderedTiles.length>0};ol.renderer.canvas.TileLayer.prototype.drawTileImage=function(e,t,o,r,i,n,a,l){this.getLayer().getSource().getOpaque(t.viewState.projection)||this.context.clearRect(r,i,n,a);var s=e.getImage();s&&this.context.drawImage(s,l,l,s.width-2*l,s.height-2*l,r,i,n,a)};ol.renderer.canvas.TileLayer.prototype.getImage=function(){var e=this.context;return e?e.canvas:null};ol.renderer.canvas.TileLayer.prototype.getLayer;ol.renderer.canvas.TileLayer.prototype.getImageTransform=function(){return this.imageTransform_};goog.provide("ol.renderer.webgl.tilelayershader");goog.require("ol");goog.require("ol.webgl.Fragment");goog.require("ol.webgl.Vertex");if(ol.ENABLE_WEBGL){ol.renderer.webgl.tilelayershader.Fragment=function(){ol.webgl.Fragment.call(this,ol.renderer.webgl.tilelayershader.Fragment.SOURCE)};ol.inherits(ol.renderer.webgl.tilelayershader.Fragment,ol.webgl.Fragment);ol.renderer.webgl.tilelayershader.Fragment.DEBUG_SOURCE="precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  gl_FragColor = texture2D(u_texture, v_texCoord);\n}\n";ol.renderer.webgl.tilelayershader.Fragment.OPTIMIZED_SOURCE="precision mediump float;varying vec2 a;uniform sampler2D e;void main(void){gl_FragColor=texture2D(e,a);}";ol.renderer.webgl.tilelayershader.Fragment.SOURCE=ol.DEBUG_WEBGL?ol.renderer.webgl.tilelayershader.Fragment.DEBUG_SOURCE:ol.renderer.webgl.tilelayershader.Fragment.OPTIMIZED_SOURCE;ol.renderer.webgl.tilelayershader.fragment=new ol.renderer.webgl.tilelayershader.Fragment;ol.renderer.webgl.tilelayershader.Vertex=function(){ol.webgl.Vertex.call(this,ol.renderer.webgl.tilelayershader.Vertex.SOURCE)};ol.inherits(ol.renderer.webgl.tilelayershader.Vertex,ol.webgl.Vertex);ol.renderer.webgl.tilelayershader.Vertex.DEBUG_SOURCE="varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform vec4 u_tileOffset;\n\nvoid main(void) {\n  gl_Position = vec4(a_position * u_tileOffset.xy + u_tileOffset.zw, 0., 1.);\n  v_texCoord = a_texCoord;\n}\n\n\n";ol.renderer.webgl.tilelayershader.Vertex.OPTIMIZED_SOURCE="varying vec2 a;attribute vec2 b;attribute vec2 c;uniform vec4 d;void main(void){gl_Position=vec4(b*d.xy+d.zw,0.,1.);a=c;}";ol.renderer.webgl.tilelayershader.Vertex.SOURCE=ol.DEBUG_WEBGL?ol.renderer.webgl.tilelayershader.Vertex.DEBUG_SOURCE:ol.renderer.webgl.tilelayershader.Vertex.OPTIMIZED_SOURCE;ol.renderer.webgl.tilelayershader.vertex=new ol.renderer.webgl.tilelayershader.Vertex;ol.renderer.webgl.tilelayershader.Locations=function(e,t){this.u_texture=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_texture":"e");this.u_tileOffset=e.getUniformLocation(t,ol.DEBUG_WEBGL?"u_tileOffset":"d");this.a_position=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_position":"b");this.a_texCoord=e.getAttribLocation(t,ol.DEBUG_WEBGL?"a_texCoord":"c")}}goog.provide("ol.renderer.webgl.TileLayer");goog.require("ol");goog.require("ol.TileState");goog.require("ol.TileRange");goog.require("ol.array");goog.require("ol.extent");goog.require("ol.math");goog.require("ol.renderer.webgl.Layer");goog.require("ol.renderer.webgl.tilelayershader");goog.require("ol.size");goog.require("ol.transform");goog.require("ol.webgl");goog.require("ol.webgl.Buffer");if(ol.ENABLE_WEBGL){ol.renderer.webgl.TileLayer=function(e,t){ol.renderer.webgl.Layer.call(this,e,t);this.fragmentShader_=ol.renderer.webgl.tilelayershader.fragment;this.vertexShader_=ol.renderer.webgl.tilelayershader.vertex;this.locations_=null;this.renderArrayBuffer_=new ol.webgl.Buffer([0,0,0,1,1,0,1,1,0,1,0,0,1,1,1,0]);this.renderedTileRange_=null;this.renderedFramebufferExtent_=null;this.renderedRevision_=-1;this.tmpSize_=[0,0]};ol.inherits(ol.renderer.webgl.TileLayer,ol.renderer.webgl.Layer);ol.renderer.webgl.TileLayer.prototype.disposeInternal=function(){var e=this.mapRenderer.getContext();e.deleteBuffer(this.renderArrayBuffer_);ol.renderer.webgl.Layer.prototype.disposeInternal.call(this)};ol.renderer.webgl.TileLayer.prototype.createLoadedTileFinder=function(e,t,o){var r=this.mapRenderer;return function(i,n){function a(e){var t=r.isTileTextureLoaded(e);if(t){o[i]||(o[i]={});o[i][e.tileCoord.toString()]=e}return t}return e.forEachLoadedTile(t,i,n,a)}};ol.renderer.webgl.TileLayer.prototype.handleWebGLContextLost=function(){ol.renderer.webgl.Layer.prototype.handleWebGLContextLost.call(this);this.locations_=null};ol.renderer.webgl.TileLayer.prototype.prepareFrame=function(e,t,o){var r,i=this.mapRenderer,n=o.getGL(),a=e.viewState,l=a.projection,s=this.getLayer(),p=s.getSource(),c=p.getTileGridForProjection(l),u=c.getZForResolution(a.resolution),g=c.getResolution(u),d=p.getTilePixelSize(u,e.pixelRatio,l),h=d[0]/ol.size.toSize(c.getTileSize(u),this.tmpSize_)[0],f=g/h,y=p.getTilePixelRatio(h)*p.getGutter(l),m=a.center,v=e.extent,C=c.getTileRangeForExtentAndResolution(v,g);if(this.renderedTileRange_&&this.renderedTileRange_.equals(C)&&this.renderedRevision_==p.getRevision())r=this.renderedFramebufferExtent_;else{var T=C.getSize(),_=Math.max(T[0]*d[0],T[1]*d[1]),S=ol.math.roundUpToPowerOfTwo(_),E=f*S,x=c.getOrigin(u),P=x[0]+C.minX*d[0]*f,L=x[1]+C.minY*d[1]*f;r=[P,L,P+E,L+E];this.bindFramebuffer(e,S);n.viewport(0,0,S,S);n.clearColor(0,0,0,0);n.clear(ol.webgl.COLOR_BUFFER_BIT);n.disable(ol.webgl.BLEND);var w=o.getProgram(this.fragmentShader_,this.vertexShader_);o.useProgram(w);this.locations_||(this.locations_=new ol.renderer.webgl.tilelayershader.Locations(n,w));o.bindBuffer(ol.webgl.ARRAY_BUFFER,this.renderArrayBuffer_);n.enableVertexAttribArray(this.locations_.a_position);n.vertexAttribPointer(this.locations_.a_position,2,ol.webgl.FLOAT,!1,16,0);n.enableVertexAttribArray(this.locations_.a_texCoord);n.vertexAttribPointer(this.locations_.a_texCoord,2,ol.webgl.FLOAT,!1,16,8);n.uniform1i(this.locations_.u_texture,0);var R={};R[u]={};var A,b,M,I,O,N,D,F,k=this.createLoadedTileFinder(p,l,R),G=s.getUseInterimTilesOnError(),U=!0,B=ol.extent.createEmpty(),q=new ol.TileRange(0,0,0,0);for(N=C.minX;N<=C.maxX;++N)for(D=C.minY;D<=C.maxY;++D){I=p.getTile(u,N,D,h,l);if(void 0!==t.extent){F=c.getTileCoordExtent(I.tileCoord,B);if(!ol.extent.intersects(F,t.extent))continue}O=I.getState();b=O==ol.TileState.LOADED||O==ol.TileState.EMPTY||O==ol.TileState.ERROR&&!G;b||(I=I.getInterimTile());O=I.getState();if(O==ol.TileState.LOADED){if(i.isTileTextureLoaded(I)){R[u][I.tileCoord.toString()]=I;continue}}else if(O==ol.TileState.EMPTY||O==ol.TileState.ERROR&&!G)continue;U=!1;M=c.forEachTileCoordParentTileRange(I.tileCoord,k,null,q,B);if(!M){A=c.getTileCoordChildTileRange(I.tileCoord,q,B);A&&k(u+1,A)}}var j=Object.keys(R).map(Number);j.sort(ol.array.numberSafeCompareFunction);var $,W,V,Y,K=new Float32Array(4);for($=0,W=j.length;W>$;++$){Y=R[j[$]];for(V in Y){I=Y[V];F=c.getTileCoordExtent(I.tileCoord,B);K[0]=2*(F[2]-F[0])/E;K[1]=2*(F[3]-F[1])/E;K[2]=2*(F[0]-r[0])/E-1;K[3]=2*(F[1]-r[1])/E-1;n.uniform4fv(this.locations_.u_tileOffset,K);i.bindTileTexture(I,d,y*h,ol.webgl.LINEAR,ol.webgl.LINEAR);n.drawArrays(ol.webgl.TRIANGLE_STRIP,0,4)}}if(U){this.renderedTileRange_=C;this.renderedFramebufferExtent_=r;this.renderedRevision_=p.getRevision()}else{this.renderedTileRange_=null;this.renderedFramebufferExtent_=null;this.renderedRevision_=-1;e.animate=!0}}this.updateUsedTiles(e.usedTiles,p,u,C);var X=i.getTileTextureQueue();this.manageTilePyramid(e,p,c,h,l,v,u,s.getPreload(),function(e){e.getState()!=ol.TileState.LOADED||i.isTileTextureLoaded(e)||X.isKeyQueued(e.getKey())||X.enqueue([e,c.getTileCoordCenter(e.tileCoord),c.getResolution(e.tileCoord[0]),d,y*h])},this);this.scheduleExpireCache(e,p);this.updateLogos(e,p);var H=this.texCoordMatrix;ol.transform.reset(H);ol.transform.translate(H,(Math.round(m[0]/g)*g-r[0])/(r[2]-r[0]),(Math.round(m[1]/g)*g-r[1])/(r[3]-r[1]));0!==a.rotation&&ol.transform.rotate(H,a.rotation);ol.transform.scale(H,e.size[0]*a.resolution/(r[2]-r[0]),e.size[1]*a.resolution/(r[3]-r[1]));ol.transform.translate(H,-.5,-.5);return!0};ol.renderer.webgl.TileLayer.prototype.forEachLayerAtPixel=function(e,t,o,r){if(!this.framebuffer)return void 0;var i=[e[0]/t.size[0],(t.size[1]-e[1])/t.size[1]],n=ol.transform.apply(this.texCoordMatrix,i.slice()),a=[n[0]*this.framebufferDimension,n[1]*this.framebufferDimension],l=this.mapRenderer.getContext().getGL();l.bindFramebuffer(l.FRAMEBUFFER,this.framebuffer);var s=new Uint8Array(4);l.readPixels(a[0],a[1],1,1,l.RGBA,l.UNSIGNED_BYTE,s);return s[3]>0?o.call(r,this.getLayer(),s):void 0}}goog.provide("ol.layer.Tile");goog.require("ol");goog.require("ol.layer.Layer");goog.require("ol.layer.TileProperty");goog.require("ol.obj");goog.require("ol.renderer.Type");goog.require("ol.renderer.canvas.TileLayer");goog.require("ol.renderer.webgl.TileLayer");ol.layer.Tile=function(e){var t=e?e:{},o=ol.obj.assign({},t);delete o.preload;delete o.useInterimTilesOnError;ol.layer.Layer.call(this,o);this.setPreload(void 0!==t.preload?t.preload:0);this.setUseInterimTilesOnError(void 0!==t.useInterimTilesOnError?t.useInterimTilesOnError:!0)};ol.inherits(ol.layer.Tile,ol.layer.Layer);ol.layer.Tile.prototype.createRenderer=function(e){var t=null,o=e.getType();ol.ENABLE_CANVAS&&o===ol.renderer.Type.CANVAS?t=new ol.renderer.canvas.TileLayer(this):ol.ENABLE_WEBGL&&o===ol.renderer.Type.WEBGL&&(t=new ol.renderer.webgl.TileLayer(e,this));return t};ol.layer.Tile.prototype.getPreload=function(){return this.get(ol.layer.TileProperty.PRELOAD)};ol.layer.Tile.prototype.getSource;ol.layer.Tile.prototype.setPreload=function(e){this.set(ol.layer.TileProperty.PRELOAD,e)};ol.layer.Tile.prototype.getUseInterimTilesOnError=function(){return this.get(ol.layer.TileProperty.USE_INTERIM_TILES_ON_ERROR)};ol.layer.Tile.prototype.setUseInterimTilesOnError=function(e){this.set(ol.layer.TileProperty.USE_INTERIM_TILES_ON_ERROR,e)};goog.provide("ol.layer.VectorTileRenderType");ol.layer.VectorTileRenderType={IMAGE:"image",HYBRID:"hybrid",VECTOR:"vector"};goog.provide("ol.renderer.canvas.VectorTileLayer");goog.require("ol");goog.require("ol.dom");goog.require("ol.extent");goog.require("ol.proj");goog.require("ol.proj.Units");goog.require("ol.layer.VectorTileRenderType");goog.require("ol.render.ReplayType");goog.require("ol.render.canvas");goog.require("ol.render.canvas.ReplayGroup");goog.require("ol.render.replay");goog.require("ol.renderer.canvas.TileLayer");goog.require("ol.renderer.vector");goog.require("ol.size");goog.require("ol.transform");ol.renderer.canvas.VectorTileLayer=function(e){this.context=null;ol.renderer.canvas.TileLayer.call(this,e);this.dirty_=!1;this.renderedLayerRevision_;this.tmpTransform_=ol.transform.create();this.zDirection=e.getRenderMode()==ol.layer.VectorTileRenderType.VECTOR?1:0};ol.inherits(ol.renderer.canvas.VectorTileLayer,ol.renderer.canvas.TileLayer);ol.renderer.canvas.VectorTileLayer.IMAGE_REPLAYS={image:ol.render.replay.ORDER,hybrid:[ol.render.ReplayType.POLYGON,ol.render.ReplayType.LINE_STRING]};ol.renderer.canvas.VectorTileLayer.VECTOR_REPLAYS={hybrid:[ol.render.ReplayType.IMAGE,ol.render.ReplayType.TEXT],vector:ol.render.replay.ORDER};ol.renderer.canvas.VectorTileLayer.prototype.prepareFrame=function(e,t){var o=this.getLayer(),r=o.getRevision();if(this.renderedLayerRevision_!=r){this.renderedTiles.length=0;var i=o.getRenderMode();this.context||i==ol.layer.VectorTileRenderType.VECTOR||(this.context=ol.dom.createCanvasContext2D());this.context&&i==ol.layer.VectorTileRenderType.VECTOR&&(this.context=null)}this.renderedLayerRevision_=r;return ol.renderer.canvas.TileLayer.prototype.prepareFrame.apply(this,arguments)};ol.renderer.canvas.VectorTileLayer.prototype.createReplayGroup_=function(e,t){function o(e){var t,o=e.getStyleFunction();if(o)t=o.call(e,y);else{o=r.getStyleFunction();o&&(t=o(e,y))}if(t){Array.isArray(t)||(t=[t]);var i=this.renderFeature(e,T,t,C);this.dirty_=this.dirty_||i;s.dirty=s.dirty||i}}var r=this.getLayer(),i=t.pixelRatio,n=t.viewState.projection,a=r.getRevision(),l=r.getRenderOrder()||null,s=e.getReplayState();if(s.dirty||s.renderedRevision!=a||s.renderedRenderOrder!=l){s.replayGroup=null;s.dirty=!1;var p,c,u,g=r.getSource(),d=g.getTileGrid(),h=e.tileCoord,f=e.getProjection(),y=d.getResolution(h[0]);if(f.getUnits()==ol.proj.Units.TILE_PIXELS){var m=u=g.getTilePixelRatio(),v=ol.size.toSize(d.getTileSize(h[0]));p=[0,0,v[0]*m,v[1]*m]}else{u=y;p=d.getTileCoordExtent(h);if(!ol.proj.equivalent(n,f)){c=!0;e.setProjection(n)}}s.dirty=!1;var C=new ol.render.canvas.ReplayGroup(0,p,u,g.getOverlaps(),r.getRenderBuffer()),T=ol.renderer.vector.getSquaredTolerance(u,i),_=e.getFeatures();l&&l!==s.renderedRenderOrder&&_.sort(l);for(var S,E=0,x=_.length;x>E;++E){S=_[E];c&&S.getGeometry().transform(f,n);o.call(this,S)}C.finish();s.renderedRevision=a;s.renderedRenderOrder=l;s.replayGroup=C;s.resolution=0/0}};ol.renderer.canvas.VectorTileLayer.prototype.drawTileImage=function(e,t,o,r,i,n,a,l){var s=e;this.createReplayGroup_(s,t);if(this.context){this.renderTileImage_(s,t,o);ol.renderer.canvas.TileLayer.prototype.drawTileImage.apply(this,arguments)}};ol.renderer.canvas.VectorTileLayer.prototype.forEachFeatureAtCoordinate=function(e,t,o,r,i){var n=t.viewState.resolution,a=t.viewState.rotation;o=void 0==o?0:o;var l,s,p,c,u,g,d,h,f,y,m,v=this.getLayer(),C={},T=this.renderedTiles,_=v.getSource(),S=_.getTileGrid();for(p=0,c=T.length;c>p;++p){d=T[p];h=d.tileCoord;f=_.getTileGrid().getTileCoordExtent(h,this.tmpExtent);if(ol.extent.containsCoordinate(ol.extent.buffer(f,o*n),e)){if(d.getProjection().getUnits()===ol.proj.Units.TILE_PIXELS){u=ol.extent.getTopLeft(f);y=_.getTilePixelRatio();m=S.getResolution(h[0])/y;s=[(e[0]-u[0])/m,(u[1]-e[1])/m];n=y}else s=e;g=d.getReplayState().replayGroup;l=l||g.forEachFeatureAtCoordinate(s,n,a,o,{},function(e){var t=ol.getUid(e).toString();if(!(t in C)){C[t]=!0;return r.call(i,e,v)}})}}return l};ol.renderer.canvas.VectorTileLayer.prototype.getReplayTransform_=function(e,t){if(e.getProjection().getUnits()==ol.proj.Units.TILE_PIXELS){var o=this.getLayer(),r=o.getSource(),i=r.getTileGrid(),n=e.tileCoord,a=i.getResolution(n[0])/r.getTilePixelRatio(),l=t.viewState,s=t.pixelRatio,p=l.resolution/s,c=i.getTileCoordExtent(n,this.tmpExtent),u=l.center,g=ol.extent.getTopLeft(c),d=t.size,h=Math.round(s*d[0]/2),f=Math.round(s*d[1]/2);return ol.transform.compose(this.tmpTransform_,h,f,a/p,a/p,l.rotation,(g[0]-u[0])/a,(u[1]-g[1])/a)}return this.getTransform(t,0)};ol.renderer.canvas.VectorTileLayer.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()};ol.renderer.canvas.VectorTileLayer.prototype.postCompose=function(e,t,o){var r=this.getLayer().getRenderMode(),i=ol.renderer.canvas.VectorTileLayer.VECTOR_REPLAYS[r];if(i)for(var n=t.pixelRatio,a=t.viewState.rotation,l=t.size,s=Math.round(n*l[0]/2),p=Math.round(n*l[1]/2),c=this.renderedTiles,u=[],g=[],d=c.length-1;d>=0;--d){var h=c[d],f=this.getReplayTransform_(h,t),y=h.getReplayState().replayGroup.getClipCoords(f),m=h.tileCoord[0];e.save();e.globalAlpha=o.opacity;ol.render.canvas.rotateAtOffset(e,-a,s,p);for(var v=0,C=u.length;C>v;++v){var T=u[v];if(m<g[v]){e.beginPath();e.moveTo(y[0],y[1]);e.lineTo(y[2],y[3]);e.lineTo(y[4],y[5]);e.lineTo(y[6],y[7]);e.moveTo(T[6],T[7]);e.lineTo(T[4],T[5]);e.lineTo(T[2],T[3]);e.lineTo(T[0],T[1]);e.clip()}}var _=h.getReplayState().replayGroup;_.replay(e,n,f,a,{},i);e.restore();u.push(y);g.push(m)}ol.renderer.canvas.TileLayer.prototype.postCompose.apply(this,arguments)};ol.renderer.canvas.VectorTileLayer.prototype.renderFeature=function(e,t,o,r){if(!o)return!1;var i=!1;if(Array.isArray(o))for(var n=0,a=o.length;a>n;++n)i=ol.renderer.vector.renderFeature(r,e,o[n],t,this.handleStyleImageChange_,this)||i;else i=ol.renderer.vector.renderFeature(r,e,o,t,this.handleStyleImageChange_,this)||i;return i};ol.renderer.canvas.VectorTileLayer.prototype.renderTileImage_=function(e,t,o){var r=this.getLayer(),i=e.getReplayState(),n=r.getRevision(),a=ol.renderer.canvas.VectorTileLayer.IMAGE_REPLAYS[r.getRenderMode()];if(a&&i.renderedTileRevision!==n){i.renderedTileRevision=n;var l=e.tileCoord,s=e.tileCoord[0],p=t.pixelRatio,c=r.getSource(),u=c.getTileGrid(),g=c.getTilePixelRatio(),d=ol.transform.reset(this.tmpTransform_);if(e.getProjection().getUnits()==ol.proj.Units.TILE_PIXELS){var h=p/g;ol.transform.scale(d,h,h)}else{var f=u.getResolution(s),y=p/f,m=u.getTileCoordExtent(l,this.tmpExtent);ol.transform.scale(d,y,-y);ol.transform.translate(d,-m[0],-m[3])}var v=e.getContext(),C=c.getTilePixelSize(s,p,t.viewState.projection);v.canvas.width=C[0];v.canvas.height=C[1];i.replayGroup.replay(v,p,d,0,{},a)}};goog.provide("ol.layer.VectorTile");goog.require("ol");goog.require("ol.asserts");goog.require("ol.layer.TileProperty");goog.require("ol.layer.Vector");goog.require("ol.layer.VectorTileRenderType");goog.require("ol.obj");goog.require("ol.renderer.Type");goog.require("ol.renderer.canvas.VectorTileLayer");ol.layer.VectorTile=function(e){var t=e?e:{},o=ol.obj.assign({},t);delete o.preload;delete o.useInterimTilesOnError;ol.layer.Vector.call(this,o);this.setPreload(t.preload?t.preload:0);this.setUseInterimTilesOnError(t.useInterimTilesOnError?t.useInterimTilesOnError:!0);ol.asserts.assert(void 0==t.renderMode||t.renderMode==ol.layer.VectorTileRenderType.IMAGE||t.renderMode==ol.layer.VectorTileRenderType.HYBRID||t.renderMode==ol.layer.VectorTileRenderType.VECTOR,28);this.renderMode_=t.renderMode||ol.layer.VectorTileRenderType.HYBRID};ol.inherits(ol.layer.VectorTile,ol.layer.Vector);ol.layer.VectorTile.prototype.createRenderer=function(e){var t=null,o=e.getType();ol.ENABLE_CANVAS&&o===ol.renderer.Type.CANVAS&&(t=new ol.renderer.canvas.VectorTileLayer(this));return t};ol.layer.VectorTile.prototype.getPreload=function(){return this.get(ol.layer.TileProperty.PRELOAD)};ol.layer.VectorTile.prototype.getRenderMode=function(){
return this.renderMode_};ol.layer.VectorTile.prototype.getUseInterimTilesOnError=function(){return this.get(ol.layer.TileProperty.USE_INTERIM_TILES_ON_ERROR)};ol.layer.VectorTile.prototype.setPreload=function(e){this.set(ol.layer.TileProperty.PRELOAD,e)};ol.layer.VectorTile.prototype.setUseInterimTilesOnError=function(e){this.set(ol.layer.TileProperty.USE_INTERIM_TILES_ON_ERROR,e)};goog.provide("ol.net");goog.require("ol");ol.net.jsonp=function(e,t,o,r){function i(){delete window[a];n.parentNode.removeChild(n)}var n=document.createElement("script"),a="olc_"+ol.getUid(t);n.async=!0;n.src=e+(-1==e.indexOf("?")?"?":"&")+(r||"callback")+"="+a;var l=setTimeout(function(){i();o&&o()},1e4);window[a]=function(e){clearTimeout(l);i();t(e)};document.getElementsByTagName("head")[0].appendChild(n)};goog.provide("ol.proj.common");goog.require("ol.proj");ol.proj.common.add=ol.proj.addCommon;goog.provide("ol.render");goog.require("ol.has");goog.require("ol.transform");goog.require("ol.render.canvas.Immediate");ol.render.toContext=function(e,t){var o=e.canvas,r=t?t:{},i=r.pixelRatio||ol.has.DEVICE_PIXEL_RATIO,n=r.size;if(n){o.width=n[0]*i;o.height=n[1]*i;o.style.width=n[0]+"px";o.style.height=n[1]+"px"}var a=[0,0,o.width,o.height],l=ol.transform.scale(ol.transform.create(),i,i);return new ol.render.canvas.Immediate(e,i,a,l,0)};goog.provide("ol.reproj.Tile");goog.require("ol");goog.require("ol.Tile");goog.require("ol.TileState");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.extent");goog.require("ol.math");goog.require("ol.reproj");goog.require("ol.reproj.Triangulation");ol.reproj.Tile=function(e,t,o,r,i,n,a,l,s,p,c){ol.Tile.call(this,i,ol.TileState.IDLE);this.renderEdges_=void 0!==c?c:!1;this.pixelRatio_=a;this.gutter_=l;this.canvas_=null;this.sourceTileGrid_=t;this.targetTileGrid_=r;this.wrappedTileCoord_=n?n:i;this.sourceTiles_=[];this.sourcesListenerKeys_=null;this.sourceZ_=0;var u=r.getTileCoordExtent(this.wrappedTileCoord_),g=this.targetTileGrid_.getExtent(),d=this.sourceTileGrid_.getExtent(),h=g?ol.extent.getIntersection(u,g):u;if(0!==ol.extent.getArea(h)){var f=e.getExtent();f&&(d=d?ol.extent.getIntersection(d,f):f);var y=r.getResolution(this.wrappedTileCoord_[0]),m=ol.extent.getCenter(h),v=ol.reproj.calculateSourceResolution(e,o,m,y);if(!isFinite(v)||0>=v)this.state=ol.TileState.EMPTY;else{var C=void 0!==p?p:ol.DEFAULT_RASTER_REPROJECTION_ERROR_THRESHOLD;this.triangulation_=new ol.reproj.Triangulation(e,o,h,d,v*C);if(0!==this.triangulation_.getTriangles().length){this.sourceZ_=t.getZForResolution(v);var T=this.triangulation_.calculateSourceExtent();if(d)if(e.canWrapX()){T[1]=ol.math.clamp(T[1],d[1],d[3]);T[3]=ol.math.clamp(T[3],d[1],d[3])}else T=ol.extent.getIntersection(T,d);if(ol.extent.getArea(T)){for(var _=t.getTileRangeForExtentAndZ(T,this.sourceZ_),S=_.minX;S<=_.maxX;S++)for(var E=_.minY;E<=_.maxY;E++){var x=s(this.sourceZ_,S,E,a);x&&this.sourceTiles_.push(x)}0===this.sourceTiles_.length&&(this.state=ol.TileState.EMPTY)}else this.state=ol.TileState.EMPTY}else this.state=ol.TileState.EMPTY}}else this.state=ol.TileState.EMPTY};ol.inherits(ol.reproj.Tile,ol.Tile);ol.reproj.Tile.prototype.disposeInternal=function(){this.state==ol.TileState.LOADING&&this.unlistenSources_();ol.Tile.prototype.disposeInternal.call(this)};ol.reproj.Tile.prototype.getImage=function(){return this.canvas_};ol.reproj.Tile.prototype.reproject_=function(){var e=[];this.sourceTiles_.forEach(function(t,o,r){t&&t.getState()==ol.TileState.LOADED&&e.push({extent:this.sourceTileGrid_.getTileCoordExtent(t.tileCoord),image:t.getImage()})},this);this.sourceTiles_.length=0;if(0===e.length)this.state=ol.TileState.ERROR;else{var t=this.wrappedTileCoord_[0],o=this.targetTileGrid_.getTileSize(t),r="number"==typeof o?o:o[0],i="number"==typeof o?o:o[1],n=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=ol.reproj.render(r,i,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),n,l,this.triangulation_,e,this.gutter_,this.renderEdges_);this.state=ol.TileState.LOADED}this.changed()};ol.reproj.Tile.prototype.load=function(){if(this.state==ol.TileState.IDLE){this.state=ol.TileState.LOADING;this.changed();var e=0;this.sourcesListenerKeys_=[];this.sourceTiles_.forEach(function(t,o,r){var i=t.getState();if(i==ol.TileState.IDLE||i==ol.TileState.LOADING){e++;var n;n=ol.events.listen(t,ol.events.EventType.CHANGE,function(o){var r=t.getState();if(r==ol.TileState.LOADED||r==ol.TileState.ERROR||r==ol.TileState.EMPTY){ol.events.unlistenByKey(n);e--;if(0===e){this.unlistenSources_();this.reproject_()}}},this);this.sourcesListenerKeys_.push(n)}},this);this.sourceTiles_.forEach(function(e,t,o){var r=e.getState();r==ol.TileState.IDLE&&e.load()});0===e&&setTimeout(this.reproject_.bind(this),0)}};ol.reproj.Tile.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(ol.events.unlistenByKey);this.sourcesListenerKeys_=null};goog.provide("ol.TileUrlFunction");goog.require("ol.asserts");goog.require("ol.math");goog.require("ol.tilecoord");ol.TileUrlFunction.createFromTemplate=function(e,t){var o=/\{z\}/g,r=/\{x\}/g,i=/\{y\}/g,n=/\{-y\}/g;return function(a,l,s){return a?e.replace(o,a[0].toString()).replace(r,a[1].toString()).replace(i,function(){var e=-a[2]-1;return e.toString()}).replace(n,function(){var e=a[0],o=t.getFullTileRange(e);ol.asserts.assert(o,55);var r=o.getHeight()+a[2];return r.toString()}):void 0}};ol.TileUrlFunction.createFromTemplates=function(e,t){for(var o=e.length,r=new Array(o),i=0;o>i;++i)r[i]=ol.TileUrlFunction.createFromTemplate(e[i],t);return ol.TileUrlFunction.createFromTileUrlFunctions(r)};ol.TileUrlFunction.createFromTileUrlFunctions=function(e){return 1===e.length?e[0]:function(t,o,r){if(t){var i=ol.tilecoord.hash(t),n=ol.math.modulo(i,e.length);return e[n](t,o,r)}return void 0}};ol.TileUrlFunction.nullTileUrlFunction=function(e,t,o){return void 0};ol.TileUrlFunction.expandUrl=function(e){var t=[],o=/\{([a-z])-([a-z])\}/.exec(e);if(o){var r,i=o[1].charCodeAt(0),n=o[2].charCodeAt(0);for(r=i;n>=r;++r)t.push(e.replace(o[0],String.fromCharCode(r)));return t}o=o=/\{(\d+)-(\d+)\}/.exec(e);if(o){for(var a=parseInt(o[2],10),l=parseInt(o[1],10);a>=l;l++)t.push(e.replace(o[0],l.toString()));return t}t.push(e);return t};goog.provide("ol.TileCache");goog.require("ol");goog.require("ol.structs.LRUCache");ol.TileCache=function(e){ol.structs.LRUCache.call(this);this.highWaterMark=void 0!==e?e:2048};ol.inherits(ol.TileCache,ol.structs.LRUCache);ol.TileCache.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark};ol.TileCache.prototype.expireCache=function(e){for(var t,o;this.canExpireCache();){t=this.peekLast();o=t.tileCoord[0].toString();if(o in e&&e[o].contains(t.tileCoord))break;this.pop().dispose()}};goog.provide("ol.source.Tile");goog.require("ol");goog.require("ol.TileCache");goog.require("ol.TileState");goog.require("ol.events.Event");goog.require("ol.proj");goog.require("ol.size");goog.require("ol.source.Source");goog.require("ol.tilecoord");goog.require("ol.tilegrid");ol.source.Tile=function(e){ol.source.Source.call(this,{attributions:e.attributions,extent:e.extent,logo:e.logo,projection:e.projection,state:e.state,wrapX:e.wrapX});this.opaque_=void 0!==e.opaque?e.opaque:!1;this.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1;this.tileGrid=void 0!==e.tileGrid?e.tileGrid:null;this.tileCache=new ol.TileCache(e.cacheSize);this.tmpSize=[0,0];this.key_=""};ol.inherits(ol.source.Tile,ol.source.Source);ol.source.Tile.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()};ol.source.Tile.prototype.expireCache=function(e,t){var o=this.getTileCacheForProjection(e);o&&o.expireCache(t)};ol.source.Tile.prototype.forEachLoadedTile=function(e,t,o,r){var i=this.getTileCacheForProjection(e);if(!i)return!1;for(var n,a,l,s=!0,p=o.minX;p<=o.maxX;++p)for(var c=o.minY;c<=o.maxY;++c){a=this.getKeyZXY(t,p,c);l=!1;if(i.containsKey(a)){n=i.get(a);l=n.getState()===ol.TileState.LOADED;l&&(l=r(n)!==!1)}l||(s=!1)}return s};ol.source.Tile.prototype.getGutter=function(e){return 0};ol.source.Tile.prototype.getKey=function(){return this.key_};ol.source.Tile.prototype.setKey=function(e){if(this.key_!==e){this.key_=e;this.changed()}};ol.source.Tile.prototype.getKeyZXY=ol.tilecoord.getKeyZXY;ol.source.Tile.prototype.getOpaque=function(e){return this.opaque_};ol.source.Tile.prototype.getResolutions=function(){return this.tileGrid.getResolutions()};ol.source.Tile.prototype.getTile=function(e,t,o,r,i){};ol.source.Tile.prototype.getTileGrid=function(){return this.tileGrid};ol.source.Tile.prototype.getTileGridForProjection=function(e){return this.tileGrid?this.tileGrid:ol.tilegrid.getForProjection(e)};ol.source.Tile.prototype.getTileCacheForProjection=function(e){var t=this.getProjection();return t&&!ol.proj.equivalent(t,e)?null:this.tileCache};ol.source.Tile.prototype.getTilePixelRatio=function(e){return this.tilePixelRatio_};ol.source.Tile.prototype.getTilePixelSize=function(e,t,o){var r=this.getTileGridForProjection(o),i=this.getTilePixelRatio(t),n=ol.size.toSize(r.getTileSize(e),this.tmpSize);return 1==i?n:ol.size.scale(n,i,this.tmpSize)};ol.source.Tile.prototype.getTileCoordForTileUrlFunction=function(e,t){var o=void 0!==t?t:this.getProjection(),r=this.getTileGridForProjection(o);this.getWrapX()&&o.isGlobal()&&(e=ol.tilegrid.wrapX(r,e,o));return ol.tilecoord.withinExtentAndZ(e,r)?e:null};ol.source.Tile.prototype.refresh=function(){this.tileCache.clear();this.changed()};ol.source.Tile.prototype.useTile=ol.nullFunction;ol.source.Tile.Event=function(e,t){ol.events.Event.call(this,e);this.tile=t};ol.inherits(ol.source.Tile.Event,ol.events.Event);goog.provide("ol.source.TileEventType");ol.source.TileEventType={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};goog.provide("ol.source.UrlTile");goog.require("ol");goog.require("ol.TileState");goog.require("ol.TileUrlFunction");goog.require("ol.source.Tile");goog.require("ol.source.TileEventType");ol.source.UrlTile=function(e){ol.source.Tile.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,extent:e.extent,logo:e.logo,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX});this.tileLoadFunction=e.tileLoadFunction;this.tileUrlFunction=this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):ol.TileUrlFunction.nullTileUrlFunction;this.urls=null;e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url);e.tileUrlFunction&&this.setTileUrlFunction(e.tileUrlFunction)};ol.inherits(ol.source.UrlTile,ol.source.Tile);ol.source.UrlTile.prototype.fixedTileUrlFunction;ol.source.UrlTile.prototype.getTileLoadFunction=function(){return this.tileLoadFunction};ol.source.UrlTile.prototype.getTileUrlFunction=function(){return this.tileUrlFunction};ol.source.UrlTile.prototype.getUrls=function(){return this.urls};ol.source.UrlTile.prototype.handleTileChange=function(e){var t=e.target;switch(t.getState()){case ol.TileState.LOADING:this.dispatchEvent(new ol.source.Tile.Event(ol.source.TileEventType.TILELOADSTART,t));break;case ol.TileState.LOADED:this.dispatchEvent(new ol.source.Tile.Event(ol.source.TileEventType.TILELOADEND,t));break;case ol.TileState.ERROR:this.dispatchEvent(new ol.source.Tile.Event(ol.source.TileEventType.TILELOADERROR,t))}};ol.source.UrlTile.prototype.setTileLoadFunction=function(e){this.tileCache.clear();this.tileLoadFunction=e;this.changed()};ol.source.UrlTile.prototype.setTileUrlFunction=function(e,t){this.tileUrlFunction=e;"undefined"!=typeof t?this.setKey(t):this.changed()};ol.source.UrlTile.prototype.setUrl=function(e){var t=this.urls=ol.TileUrlFunction.expandUrl(e);this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):ol.TileUrlFunction.createFromTemplates(t,this.tileGrid),e)};ol.source.UrlTile.prototype.setUrls=function(e){this.urls=e;var t=e.join("\n");this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):ol.TileUrlFunction.createFromTemplates(e,this.tileGrid),t)};ol.source.UrlTile.prototype.useTile=function(e,t,o){var r=this.getKeyZXY(e,t,o);this.tileCache.containsKey(r)&&this.tileCache.get(r)};goog.provide("ol.source.TileImage");goog.require("ol");goog.require("ol.ImageTile");goog.require("ol.TileCache");goog.require("ol.TileState");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.proj");goog.require("ol.reproj.Tile");goog.require("ol.source.UrlTile");goog.require("ol.tilegrid");ol.source.TileImage=function(e){ol.source.UrlTile.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,extent:e.extent,logo:e.logo,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:ol.source.TileImage.defaultTileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX});this.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null;this.tileClass=void 0!==e.tileClass?e.tileClass:ol.ImageTile;this.tileCacheForProjection={};this.tileGridForProjection={};this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold;this.renderReprojectionEdges_=!1};ol.inherits(ol.source.TileImage,ol.source.UrlTile);ol.source.TileImage.prototype.canExpireCache=function(){if(!ol.ENABLE_RASTER_REPROJECTION)return ol.source.UrlTile.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(var e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1};ol.source.TileImage.prototype.expireCache=function(e,t){if(ol.ENABLE_RASTER_REPROJECTION){var o=this.getTileCacheForProjection(e);this.tileCache.expireCache(this.tileCache==o?t:{});for(var r in this.tileCacheForProjection){var i=this.tileCacheForProjection[r];i.expireCache(i==o?t:{})}}else ol.source.UrlTile.prototype.expireCache.call(this,e,t)};ol.source.TileImage.prototype.getGutter=function(e){return ol.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&e&&!ol.proj.equivalent(this.getProjection(),e)?0:this.getGutterInternal()};ol.source.TileImage.prototype.getGutterInternal=function(){return 0};ol.source.TileImage.prototype.getOpaque=function(e){return ol.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&e&&!ol.proj.equivalent(this.getProjection(),e)?!1:ol.source.UrlTile.prototype.getOpaque.call(this,e)};ol.source.TileImage.prototype.getTileGridForProjection=function(e){if(!ol.ENABLE_RASTER_REPROJECTION)return ol.source.UrlTile.prototype.getTileGridForProjection.call(this,e);var t=this.getProjection();if(!this.tileGrid||t&&!ol.proj.equivalent(t,e)){var o=ol.getUid(e).toString();o in this.tileGridForProjection||(this.tileGridForProjection[o]=ol.tilegrid.getForProjection(e));return this.tileGridForProjection[o]}return this.tileGrid};ol.source.TileImage.prototype.getTileCacheForProjection=function(e){if(!ol.ENABLE_RASTER_REPROJECTION)return ol.source.UrlTile.prototype.getTileCacheForProjection.call(this,e);var t=this.getProjection();if(!t||ol.proj.equivalent(t,e))return this.tileCache;var o=ol.getUid(e).toString();o in this.tileCacheForProjection||(this.tileCacheForProjection[o]=new ol.TileCache(this.tileCache.highWaterMark));return this.tileCacheForProjection[o]};ol.source.TileImage.prototype.createTile_=function(e,t,o,r,i,n){var a=[e,t,o],l=this.getTileCoordForTileUrlFunction(a,i),s=l?this.tileUrlFunction(l,r,i):void 0,p=new this.tileClass(a,void 0!==s?ol.TileState.IDLE:ol.TileState.EMPTY,void 0!==s?s:"",this.crossOrigin,this.tileLoadFunction);p.key=n;ol.events.listen(p,ol.events.EventType.CHANGE,this.handleTileChange,this);return p};ol.source.TileImage.prototype.getTile=function(e,t,o,r,i){if(ol.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&i&&!ol.proj.equivalent(this.getProjection(),i)){var n,a=this.getTileCacheForProjection(i),l=[e,t,o],s=this.getKeyZXY.apply(this,l);a.containsKey(s)&&(n=a.get(s));var p=this.getKey();if(n&&n.key==p)return n;var c=this.getProjection(),u=this.getTileGridForProjection(c),g=this.getTileGridForProjection(i),d=this.getTileCoordForTileUrlFunction(l,i),h=new ol.reproj.Tile(c,u,i,g,l,d,this.getTilePixelRatio(r),this.getGutterInternal(),function(e,t,o,r){return this.getTileInternal(e,t,o,r,c)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);h.key=p;if(n){h.interimTile=n;a.replace(s,h)}else a.set(s,h);return h}return this.getTileInternal(e,t,o,r,i)};ol.source.TileImage.prototype.getTileInternal=function(e,t,o,r,i){var n=null,a=this.getKeyZXY(e,t,o),l=this.getKey();if(this.tileCache.containsKey(a)){n=this.tileCache.get(a);if(n.key!=l){var s=n;n=this.createTile_(e,t,o,r,i,l);n.interimTile=s.getState()==ol.TileState.IDLE?s.interimTile:s;n.refreshInterimChain();this.tileCache.replace(a,n)}}else{n=this.createTile_(e,t,o,r,i,l);this.tileCache.set(a,n)}return n};ol.source.TileImage.prototype.setRenderReprojectionEdges=function(e){if(ol.ENABLE_RASTER_REPROJECTION&&this.renderReprojectionEdges_!=e){this.renderReprojectionEdges_=e;for(var t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}};ol.source.TileImage.prototype.setTileGridForProjection=function(e,t){if(ol.ENABLE_RASTER_REPROJECTION){var o=ol.proj.get(e);if(o){var r=ol.getUid(o).toString();r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}};ol.source.TileImage.defaultTileLoadFunction=function(e,t){e.getImage().src=t};goog.provide("ol.source.BingMaps");goog.require("ol");goog.require("ol.Attribution");goog.require("ol.TileUrlFunction");goog.require("ol.extent");goog.require("ol.net");goog.require("ol.proj");goog.require("ol.source.State");goog.require("ol.source.TileImage");goog.require("ol.tilecoord");goog.require("ol.tilegrid");ol.source.BingMaps=function(e){this.hidpi_=void 0!==e.hidpi?e.hidpi:!1;ol.source.TileImage.call(this,{cacheSize:e.cacheSize,crossOrigin:"anonymous",opaque:!0,projection:ol.proj.get("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:ol.source.State.LOADING,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:this.hidpi_?2:1,wrapX:void 0!==e.wrapX?e.wrapX:!0});this.culture_=void 0!==e.culture?e.culture:"en-us";this.maxZoom_=void 0!==e.maxZoom?e.maxZoom:-1;this.apiKey_=e.key;this.imagerySet_=e.imagerySet;var t="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+this.apiKey_;ol.net.jsonp(t,this.handleImageryMetadataResponse.bind(this),void 0,"jsonp")};ol.inherits(ol.source.BingMaps,ol.source.TileImage);ol.source.BingMaps.TOS_ATTRIBUTION=new ol.Attribution({html:'<a class="ol-attribution-bing-tos" href="http://www.microsoft.com/maps/product/terms.html">Terms of Use</a>'});ol.source.BingMaps.prototype.getApiKey=function(){return this.apiKey_};ol.source.BingMaps.prototype.getImagerySet=function(){return this.imagerySet_};ol.source.BingMaps.prototype.handleImageryMetadataResponse=function(e){if(200==e.statusCode&&"OK"==e.statusDescription&&"ValidCredentials"==e.authenticationResultCode&&1==e.resourceSets.length&&1==e.resourceSets[0].resources.length){var t=e.brandLogoUri;-1==t.indexOf("https")&&(t=t.replace("http","https"));var o=e.resourceSets[0].resources[0],r=-1==this.maxZoom_?o.zoomMax:this.maxZoom_,i=this.getProjection(),n=ol.tilegrid.extentFromProjection(i),a=o.imageWidth==o.imageHeight?o.imageWidth:[o.imageWidth,o.imageHeight],l=ol.tilegrid.createXYZ({extent:n,minZoom:o.zoomMin,maxZoom:r,tileSize:a/this.getTilePixelRatio()});this.tileGrid=l;var s=this.culture_,p=this.hidpi_;this.tileUrlFunction=ol.TileUrlFunction.createFromTileUrlFunctions(o.imageUrlSubdomains.map(function(e){var t=[0,0,0],r=o.imageUrl.replace("{subdomain}",e).replace("{culture}",s);return function(e,o,i){if(e){ol.tilecoord.createOrUpdate(e[0],e[1],-e[2]-1,t);var n=r;p&&(n+="&dpi=d1&device=mobile");return n.replace("{quadkey}",ol.tilecoord.quadKey(t))}return void 0}}));if(o.imageryProviders){var c=ol.proj.getTransformFromProjections(ol.proj.get("EPSG:4326"),this.getProjection()),u=o.imageryProviders.map(function(e){var t=e.attribution,o={};e.coverageAreas.forEach(function(e){var t,i,n,a=e.zoomMin,s=Math.min(e.zoomMax,r),p=e.bbox,u=[p[1],p[0],p[3],p[2]],g=ol.extent.applyTransform(u,c);for(i=a;s>=i;++i){n=i.toString();t=l.getTileRangeForExtentAndZ(g,i);n in o?o[n].push(t):o[n]=[t]}});return new ol.Attribution({html:t,tileRanges:o})});u.push(ol.source.BingMaps.TOS_ATTRIBUTION);this.setAttributions(u)}this.setLogo(t);this.setState(ol.source.State.READY)}else this.setState(ol.source.State.ERROR)};goog.provide("ol.source.XYZ");goog.require("ol");goog.require("ol.source.TileImage");goog.require("ol.tilegrid");ol.source.XYZ=function(e){var t=e||{},o=void 0!==t.projection?t.projection:"EPSG:3857",r=void 0!==t.tileGrid?t.tileGrid:ol.tilegrid.createXYZ({extent:ol.tilegrid.extentFromProjection(o),maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});ol.source.TileImage.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,logo:t.logo,opaque:t.opaque,projection:o,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0!==t.wrapX?t.wrapX:!0})};ol.inherits(ol.source.XYZ,ol.source.TileImage);goog.provide("ol.source.CartoDB");goog.require("ol");goog.require("ol.obj");goog.require("ol.source.State");goog.require("ol.source.XYZ");ol.source.CartoDB=function(e){this.account_=e.account;this.mapId_=e.map||"";this.config_=e.config||{};this.templateCache_={};ol.source.XYZ.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,logo:e.logo,maxZoom:void 0!==e.maxZoom?e.maxZoom:18,minZoom:e.minZoom,projection:e.projection,state:ol.source.State.LOADING,wrapX:e.wrapX});this.initializeMap_()};ol.inherits(ol.source.CartoDB,ol.source.XYZ);ol.source.CartoDB.prototype.getConfig=function(){return this.config_};ol.source.CartoDB.prototype.updateConfig=function(e){ol.obj.assign(this.config_,e);this.initializeMap_()};ol.source.CartoDB.prototype.setConfig=function(e){this.config_=e||{};this.initializeMap_()};ol.source.CartoDB.prototype.initializeMap_=function(){var e=JSON.stringify(this.config_);if(this.templateCache_[e])this.applyTemplate_(this.templateCache_[e]);else{var t="https://"+this.account_+".cartodb.com/api/v1/map";this.mapId_&&(t+="/named/"+this.mapId_);var o=new XMLHttpRequest;o.addEventListener("load",this.handleInitResponse_.bind(this,e));o.addEventListener("error",this.handleInitError_.bind(this));o.open("POST",t);o.setRequestHeader("Content-type","application/json");o.send(JSON.stringify(this.config_))}};ol.source.CartoDB.prototype.handleInitResponse_=function(e,t){var o=t.target;if(!o.status||o.status>=200&&o.status<300){var r;try{r=JSON.parse(o.responseText)}catch(i){this.setState(ol.source.State.ERROR);return}this.applyTemplate_(r);this.templateCache_[e]=r;this.setState(ol.source.State.READY)}else this.setState(ol.source.State.ERROR)};ol.source.CartoDB.prototype.handleInitError_=function(e){this.setState(ol.source.State.ERROR)};ol.source.CartoDB.prototype.applyTemplate_=function(e){var t="https://"+e.cdn_url.https+"/"+this.account_+"/api/v1/map/"+e.layergroupid+"/{z}/{x}/{y}.png";this.setUrl(t)};goog.provide("ol.source.Cluster");goog.require("ol");goog.require("ol.asserts");goog.require("ol.Feature");goog.require("ol.coordinate");goog.require("ol.events.EventType");goog.require("ol.extent");goog.require("ol.geom.Point");goog.require("ol.source.Vector");ol.source.Cluster=function(e){ol.source.Vector.call(this,{attributions:e.attributions,extent:e.extent,logo:e.logo,projection:e.projection,wrapX:e.wrapX});this.resolution_=void 0;this.distance_=void 0!==e.distance?e.distance:20;this.features_=[];this.geometryFunction_=e.geometryFunction||function(e){var t=e.getGeometry();ol.asserts.assert(t instanceof ol.geom.Point,10);return t};this.source_=e.source;this.source_.on(ol.events.EventType.CHANGE,ol.source.Cluster.prototype.refresh_,this)};ol.inherits(ol.source.Cluster,ol.source.Vector);ol.source.Cluster.prototype.getDistance=function(){return this.distance_};ol.source.Cluster.prototype.getSource=function(){return this.source_};ol.source.Cluster.prototype.loadFeatures=function(e,t,o){this.source_.loadFeatures(e,t,o);if(t!==this.resolution_){this.clear();this.resolution_=t;this.cluster_();this.addFeatures(this.features_)}};ol.source.Cluster.prototype.setDistance=function(e){this.distance_=e;this.refresh_()};ol.source.Cluster.prototype.refresh_=function(){this.clear();this.cluster_();this.addFeatures(this.features_);this.changed()};ol.source.Cluster.prototype.cluster_=function(){if(void 0!==this.resolution_){this.features_.length=0;for(var e=ol.extent.createEmpty(),t=this.distance_*this.resolution_,o=this.source_.getFeatures(),r={},i=0,n=o.length;n>i;i++){var a=o[i];if(!(ol.getUid(a).toString()in r)){var l=this.geometryFunction_(a);if(l){var s=l.getCoordinates();ol.extent.createOrUpdateFromCoordinate(s,e);ol.extent.buffer(e,t,e);var p=this.source_.getFeaturesInExtent(e);p=p.filter(function(e){var t=ol.getUid(e).toString();if(t in r)return!1;r[t]=!0;return!0});this.features_.push(this.createCluster_(p))}}}}};ol.source.Cluster.prototype.createCluster_=function(e){for(var t=[0,0],o=e.length-1;o>=0;--o){var r=this.geometryFunction_(e[o]);r?ol.coordinate.add(t,r.getCoordinates()):e.splice(o,1)}ol.coordinate.scale(t,1/e.length);var i=new ol.Feature(new ol.geom.Point(t));i.set("features",e);return i};goog.provide("ol.uri");ol.uri.appendParams=function(e,t){var o=[];Object.keys(t).forEach(function(e){null!==t[e]&&void 0!==t[e]&&o.push(e+"="+encodeURIComponent(t[e]))});var r=o.join("&");e=e.replace(/[?&]$/,"");e=-1===e.indexOf("?")?e+"?":e+"&";return e+r};goog.provide("ol.source.ImageArcGISRest");goog.require("ol");goog.require("ol.Image");goog.require("ol.asserts");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.extent");goog.require("ol.obj");goog.require("ol.source.Image");goog.require("ol.uri");ol.source.ImageArcGISRest=function(e){var t=e||{};ol.source.Image.call(this,{attributions:t.attributions,logo:t.logo,projection:t.projection,resolutions:t.resolutions});this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;this.hidpi_=void 0!==t.hidpi?t.hidpi:!0;this.url_=t.url;this.imageLoadFunction_=void 0!==t.imageLoadFunction?t.imageLoadFunction:ol.source.Image.defaultImageLoadFunction;this.params_=t.params||{};this.image_=null;this.imageSize_=[0,0];this.renderedRevision_=0;this.ratio_=void 0!==t.ratio?t.ratio:1.5};ol.inherits(ol.source.ImageArcGISRest,ol.source.Image);ol.source.ImageArcGISRest.prototype.getParams=function(){return this.params_};ol.source.ImageArcGISRest.prototype.getImageInternal=function(e,t,o,r){if(void 0===this.url_)return null;t=this.findNearestResolution(t);o=this.hidpi_?o:1;var i=this.image_;if(i&&this.renderedRevision_==this.getRevision()&&i.getResolution()==t&&i.getPixelRatio()==o&&ol.extent.containsExtent(i.getExtent(),e))return i;var n={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};ol.obj.assign(n,this.params_);e=e.slice();var a=(e[0]+e[2])/2,l=(e[1]+e[3])/2;if(1!=this.ratio_){var s=this.ratio_*ol.extent.getWidth(e)/2,p=this.ratio_*ol.extent.getHeight(e)/2;e[0]=a-s;e[1]=l-p;e[2]=a+s;e[3]=l+p}var c=t/o,u=Math.ceil(ol.extent.getWidth(e)/c),g=Math.ceil(ol.extent.getHeight(e)/c);e[0]=a-c*u/2;e[2]=a+c*u/2;e[1]=l-c*g/2;e[3]=l+c*g/2;this.imageSize_[0]=u;this.imageSize_[1]=g;var d=this.getRequestUrl_(e,this.imageSize_,o,r,n);this.image_=new ol.Image(e,t,o,this.getAttributions(),d,this.crossOrigin_,this.imageLoadFunction_);this.renderedRevision_=this.getRevision();ol.events.listen(this.image_,ol.events.EventType.CHANGE,this.handleImageChange,this);return this.image_};ol.source.ImageArcGISRest.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_};ol.source.ImageArcGISRest.prototype.getRequestUrl_=function(e,t,o,r,i){var n=r.getCode().split(":").pop();i.SIZE=t[0]+","+t[1];i.BBOX=e.join(",");i.BBOXSR=n;i.IMAGESR=n;i.DPI=Math.round(90*o);var a=this.url_,l=a.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");l==a&&ol.asserts.assert(!1,50);return ol.uri.appendParams(l,i)};ol.source.ImageArcGISRest.prototype.getUrl=function(){return this.url_};ol.source.ImageArcGISRest.prototype.setImageLoadFunction=function(e){this.image_=null;this.imageLoadFunction_=e;this.changed()};ol.source.ImageArcGISRest.prototype.setUrl=function(e){if(e!=this.url_){this.url_=e;this.image_=null;this.changed()}};ol.source.ImageArcGISRest.prototype.updateParams=function(e){ol.obj.assign(this.params_,e);this.image_=null;this.changed()};goog.provide("ol.source.ImageMapGuide");goog.require("ol");goog.require("ol.Image");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.extent");goog.require("ol.obj");goog.require("ol.source.Image");goog.require("ol.uri");ol.source.ImageMapGuide=function(e){ol.source.Image.call(this,{projection:e.projection,resolutions:e.resolutions});this.crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null;this.displayDpi_=void 0!==e.displayDpi?e.displayDpi:96;this.params_=e.params||{};this.url_=e.url;this.imageLoadFunction_=void 0!==e.imageLoadFunction?e.imageLoadFunction:ol.source.Image.defaultImageLoadFunction;this.hidpi_=void 0!==e.hidpi?e.hidpi:!0;this.metersPerUnit_=void 0!==e.metersPerUnit?e.metersPerUnit:1;this.ratio_=void 0!==e.ratio?e.ratio:1;this.useOverlay_=void 0!==e.useOverlay?e.useOverlay:!1;this.image_=null;this.renderedRevision_=0};ol.inherits(ol.source.ImageMapGuide,ol.source.Image);ol.source.ImageMapGuide.prototype.getParams=function(){return this.params_};ol.source.ImageMapGuide.prototype.getImageInternal=function(e,t,o,r){t=this.findNearestResolution(t);o=this.hidpi_?o:1;var i=this.image_;if(i&&this.renderedRevision_==this.getRevision()&&i.getResolution()==t&&i.getPixelRatio()==o&&ol.extent.containsExtent(i.getExtent(),e))return i;if(1!=this.ratio_){e=e.slice();ol.extent.scaleFromCenter(e,this.ratio_)}var n=ol.extent.getWidth(e)/t,a=ol.extent.getHeight(e)/t,l=[n*o,a*o];if(void 0!==this.url_){var s=this.getUrl(this.url_,this.params_,e,l,r);i=new ol.Image(e,t,o,this.getAttributions(),s,this.crossOrigin_,this.imageLoadFunction_);ol.events.listen(i,ol.events.EventType.CHANGE,this.handleImageChange,this)}else i=null;this.image_=i;this.renderedRevision_=this.getRevision();return i};ol.source.ImageMapGuide.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_};ol.source.ImageMapGuide.getScale=function(e,t,o,r){var i=ol.extent.getWidth(e),n=ol.extent.getHeight(e),a=t[0],l=t[1],s=.0254/r;return l*i>a*n?i*o/(a*s):n*o/(l*s)};ol.source.ImageMapGuide.prototype.updateParams=function(e){ol.obj.assign(this.params_,e);this.changed()};ol.source.ImageMapGuide.prototype.getUrl=function(e,t,o,r,i){var n=ol.source.ImageMapGuide.getScale(o,r,this.metersPerUnit_,this.displayDpi_),a=ol.extent.getCenter(o),l={OPERATION:this.useOverlay_?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol.source.ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.displayDpi_,SETDISPLAYWIDTH:Math.round(r[0]),SETDISPLAYHEIGHT:Math.round(r[1]),SETVIEWSCALE:n,SETVIEWCENTERX:a[0],SETVIEWCENTERY:a[1]};ol.obj.assign(l,t);return ol.uri.appendParams(e,l)};ol.source.ImageMapGuide.prototype.setImageLoadFunction=function(e){this.image_=null;this.imageLoadFunction_=e;this.changed()};goog.provide("ol.source.ImageStatic");goog.require("ol");goog.require("ol.Image");goog.require("ol.ImageState");goog.require("ol.dom");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.extent");goog.require("ol.proj");goog.require("ol.source.Image");ol.source.ImageStatic=function(e){var t=e.imageExtent,o=void 0!==e.crossOrigin?e.crossOrigin:null,r=void 0!==e.imageLoadFunction?e.imageLoadFunction:ol.source.Image.defaultImageLoadFunction;ol.source.Image.call(this,{
attributions:e.attributions,logo:e.logo,projection:ol.proj.get(e.projection)});this.image_=new ol.Image(t,void 0,1,this.getAttributions(),e.url,o,r);this.imageSize_=e.imageSize?e.imageSize:null;ol.events.listen(this.image_,ol.events.EventType.CHANGE,this.handleImageChange,this)};ol.inherits(ol.source.ImageStatic,ol.source.Image);ol.source.ImageStatic.prototype.getImageInternal=function(e,t,o,r){return ol.extent.intersects(e,this.image_.getExtent())?this.image_:null};ol.source.ImageStatic.prototype.handleImageChange=function(e){if(this.image_.getState()==ol.ImageState.LOADED){var t,o,r=this.image_.getExtent(),i=this.image_.getImage();if(this.imageSize_){t=this.imageSize_[0];o=this.imageSize_[1]}else{t=i.width;o=i.height}var n=ol.extent.getHeight(r)/o,a=Math.ceil(ol.extent.getWidth(r)/n);if(a!=t){var l=ol.dom.createCanvasContext2D(a,o),s=l.canvas;l.drawImage(i,0,0,t,o,0,0,s.width,s.height);this.image_.setImage(s)}}ol.source.Image.prototype.handleImageChange.call(this,e)};goog.provide("ol.source.WMSServerType");ol.source.WMSServerType={CARMENTA_SERVER:"carmentaserver",GEOSERVER:"geoserver",MAPSERVER:"mapserver",QGIS:"qgis"};goog.provide("ol.source.ImageWMS");goog.require("ol");goog.require("ol.Image");goog.require("ol.asserts");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.extent");goog.require("ol.obj");goog.require("ol.proj");goog.require("ol.source.Image");goog.require("ol.source.WMSServerType");goog.require("ol.string");goog.require("ol.uri");ol.source.ImageWMS=function(e){var t=e||{};ol.source.Image.call(this,{attributions:t.attributions,logo:t.logo,projection:t.projection,resolutions:t.resolutions});this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;this.url_=t.url;this.imageLoadFunction_=void 0!==t.imageLoadFunction?t.imageLoadFunction:ol.source.Image.defaultImageLoadFunction;this.params_=t.params||{};this.v13_=!0;this.updateV13_();this.serverType_=t.serverType;this.hidpi_=void 0!==t.hidpi?t.hidpi:!0;this.image_=null;this.imageSize_=[0,0];this.renderedRevision_=0;this.ratio_=void 0!==t.ratio?t.ratio:1.5};ol.inherits(ol.source.ImageWMS,ol.source.Image);ol.source.ImageWMS.GETFEATUREINFO_IMAGE_SIZE_=[101,101];ol.source.ImageWMS.prototype.getGetFeatureInfoUrl=function(e,t,o,r){if(void 0===this.url_)return void 0;var i=ol.extent.getForViewAndSize(e,t,0,ol.source.ImageWMS.GETFEATUREINFO_IMAGE_SIZE_),n={SERVICE:"WMS",VERSION:ol.DEFAULT_WMS_VERSION,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};ol.obj.assign(n,this.params_,r);var a=Math.floor((e[0]-i[0])/t),l=Math.floor((i[3]-e[1])/t);n[this.v13_?"I":"X"]=a;n[this.v13_?"J":"Y"]=l;return this.getRequestUrl_(i,ol.source.ImageWMS.GETFEATUREINFO_IMAGE_SIZE_,1,ol.proj.get(o),n)};ol.source.ImageWMS.prototype.getParams=function(){return this.params_};ol.source.ImageWMS.prototype.getImageInternal=function(e,t,o,r){if(void 0===this.url_)return null;t=this.findNearestResolution(t);1==o||this.hidpi_&&void 0!==this.serverType_||(o=1);var i=t/o,n=ol.extent.getCenter(e),a=Math.ceil(ol.extent.getWidth(e)/i),l=Math.ceil(ol.extent.getHeight(e)/i),s=ol.extent.getForViewAndSize(n,i,0,[a,l]),p=Math.ceil(this.ratio_*ol.extent.getWidth(e)/i),c=Math.ceil(this.ratio_*ol.extent.getHeight(e)/i),u=ol.extent.getForViewAndSize(n,i,0,[p,c]),g=this.image_;if(g&&this.renderedRevision_==this.getRevision()&&g.getResolution()==t&&g.getPixelRatio()==o&&ol.extent.containsExtent(g.getExtent(),s))return g;var d={SERVICE:"WMS",VERSION:ol.DEFAULT_WMS_VERSION,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};ol.obj.assign(d,this.params_);this.imageSize_[0]=Math.round(ol.extent.getWidth(u)/i);this.imageSize_[1]=Math.round(ol.extent.getHeight(u)/i);var h=this.getRequestUrl_(u,this.imageSize_,o,r,d);this.image_=new ol.Image(u,t,o,this.getAttributions(),h,this.crossOrigin_,this.imageLoadFunction_);this.renderedRevision_=this.getRevision();ol.events.listen(this.image_,ol.events.EventType.CHANGE,this.handleImageChange,this);return this.image_};ol.source.ImageWMS.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_};ol.source.ImageWMS.prototype.getRequestUrl_=function(e,t,o,r,i){ol.asserts.assert(void 0!==this.url_,9);i[this.v13_?"CRS":"SRS"]=r.getCode();"STYLES"in this.params_||(i.STYLES="");if(1!=o)switch(this.serverType_){case ol.source.WMSServerType.GEOSERVER:var n=90*o+.5|0;"FORMAT_OPTIONS"in i?i.FORMAT_OPTIONS+=";dpi:"+n:i.FORMAT_OPTIONS="dpi:"+n;break;case ol.source.WMSServerType.MAPSERVER:i.MAP_RESOLUTION=90*o;break;case ol.source.WMSServerType.CARMENTA_SERVER:case ol.source.WMSServerType.QGIS:i.DPI=90*o;break;default:ol.asserts.assert(!1,8)}i.WIDTH=t[0];i.HEIGHT=t[1];var a,l=r.getAxisOrientation();a=this.v13_&&"ne"==l.substr(0,2)?[e[1],e[0],e[3],e[2]]:e;i.BBOX=a.join(",");return ol.uri.appendParams(this.url_,i)};ol.source.ImageWMS.prototype.getUrl=function(){return this.url_};ol.source.ImageWMS.prototype.setImageLoadFunction=function(e){this.image_=null;this.imageLoadFunction_=e;this.changed()};ol.source.ImageWMS.prototype.setUrl=function(e){if(e!=this.url_){this.url_=e;this.image_=null;this.changed()}};ol.source.ImageWMS.prototype.updateParams=function(e){ol.obj.assign(this.params_,e);this.updateV13_();this.image_=null;this.changed()};ol.source.ImageWMS.prototype.updateV13_=function(){var e=this.params_.VERSION||ol.DEFAULT_WMS_VERSION;this.v13_=ol.string.compareVersions(e,"1.3")>=0};goog.provide("ol.source.OSM");goog.require("ol");goog.require("ol.Attribution");goog.require("ol.source.XYZ");ol.source.OSM=function(e){var t,o=e||{};t=void 0!==o.attributions?o.attributions:[ol.source.OSM.ATTRIBUTION];var r=void 0!==o.crossOrigin?o.crossOrigin:"anonymous",i=void 0!==o.url?o.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";ol.source.XYZ.call(this,{attributions:t,cacheSize:o.cacheSize,crossOrigin:r,opaque:void 0!==o.opaque?o.opaque:!0,maxZoom:void 0!==o.maxZoom?o.maxZoom:19,reprojectionErrorThreshold:o.reprojectionErrorThreshold,tileLoadFunction:o.tileLoadFunction,url:i,wrapX:o.wrapX})};ol.inherits(ol.source.OSM,ol.source.XYZ);ol.source.OSM.ATTRIBUTION=new ol.Attribution({html:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.'});goog.provide("ol.ext.pixelworks");ol.ext.pixelworks;!function(){var e,t={},o={exports:t};!function(r){if("object"==typeof t&&"undefined"!=typeof o)o.exports=r();else if("function"==typeof e&&e.amd)e([],r);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this;i.pixelworks=r()}}(function(){return function e(t,o,r){function i(a,l){if(!o[a]){if(!t[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(n)return n(a,!0);var p=new Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var c=o[a]={exports:{}};t[a][0].call(c.exports,function(e){var o=t[a][1][e];return i(o?o:e)},c,c.exports,e,t,o,r)}return o[a].exports}for(var n="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,o){var r=e("./processor");o.Processor=r},{"./processor":2}],2:[function(e,t,o){function r(e){function t(e,t,r){return o?new ImageData(e,t,r):{data:e,width:t,height:r}}var o=!0;try{new ImageData(10,10)}catch(r){o=!1}return function(o){var r,i,n=o.buffers,a=o.meta,l=o.imageOps,s=o.width,p=o.height,c=n.length,u=n[0].byteLength;if(l){var g=new Array(c);for(i=0;c>i;++i)g[i]=t(new Uint8ClampedArray(n[i]),s,p);r=e(g,a).data}else{r=new Uint8ClampedArray(u);var d=new Array(c),h=new Array(c);for(i=0;c>i;++i){d[i]=new Uint8ClampedArray(n[i]);h[i]=[0,0,0,0]}for(var f=0;u>f;f+=4){for(var y=0;c>y;++y){var m=d[y];h[y][0]=m[f];h[y][1]=m[f+1];h[y][2]=m[f+2];h[y][3]=m[f+3]}var v=e(h,a);r[f]=v[0];r[f+1]=v[1];r[f+2]=v[2];r[f+3]=v[3]}}return r.buffer}}function i(e,t){var o=Object.keys(e.lib||{}).map(function(t){return"var "+t+" = "+e.lib[t].toString()+";"}),i=o.concat(["var __minion__ = ("+r.toString()+")(",e.operation.toString(),");",'self.addEventListener("message", function(event) {',"  var buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),n=new Blob(i,{type:"text/javascript"}),a=URL.createObjectURL(n),l=new Worker(a);l.addEventListener("message",t);return l}function n(e,t){var o=r(e.operation);return{postMessage:function(e){setTimeout(function(){t({data:{buffer:o(e),meta:e.meta}})},0)}}}function a(e){this._imageOps=!!e.imageOps;var t;t=0===e.threads?0:this._imageOps?1:e.threads||1;var o=[];if(t)for(var r=0;t>r;++r)o[r]=i(e,this._onWorkerMessage.bind(this,r));else o[0]=n(e,this._onWorkerMessage.bind(this,0));this._workers=o;this._queue=[];this._maxQueueLength=e.queue||1/0;this._running=0;this._dataLookup={};this._job=null}var l=e("./util").newImageData;a.prototype.process=function(e,t,o){this._enqueue({inputs:e,meta:t,callback:o});this._dispatch()};a.prototype.destroy=function(){for(var e in this)this[e]=null;this._destroyed=!0};a.prototype._enqueue=function(e){this._queue.push(e);for(;this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)};a.prototype._dispatch=function(){if(0===this._running&&this._queue.length>0){var e=this._job=this._queue.shift(),t=e.inputs[0].width,o=e.inputs[0].height,r=e.inputs.map(function(e){return e.data.buffer}),i=this._workers.length;this._running=i;if(1===i)this._workers[0].postMessage({buffers:r,meta:e.meta,imageOps:this._imageOps,width:t,height:o},r);else for(var n=e.inputs[0].data.length,a=4*Math.ceil(n/4/i),l=0;i>l;++l){for(var s=l*a,p=[],c=0,u=r.length;u>c;++c)p.push(r[l].slice(s,s+a));this._workers[l].postMessage({buffers:p,meta:e.meta,imageOps:this._imageOps,width:t,height:o},p)}}};a.prototype._onWorkerMessage=function(e,t){if(!this._destroyed){this._dataLookup[e]=t.data;--this._running;0===this._running&&this._resolveJob()}};a.prototype._resolveJob=function(){var e,t,o=this._job,r=this._workers.length;if(1===r){e=new Uint8ClampedArray(this._dataLookup[0].buffer);t=this._dataLookup[0].meta}else{var i=o.inputs[0].data.length;e=new Uint8ClampedArray(i);t=new Array(i);for(var n=4*Math.ceil(i/4/r),a=0;r>a;++a){var s=this._dataLookup[a].buffer,p=a*n;e.set(new Uint8ClampedArray(s),p);t[a]=this._dataLookup[a].meta}}this._job=null;this._dataLookup={};o.callback(null,l(e,o.inputs[0].width,o.inputs[0].height),t);this._dispatch()};t.exports=a},{"./util":3}],3:[function(e,t,o){function r(e,t,o){if(i)return new ImageData(e,t,o);var r=a.createImageData(t,o);r.data.set(e);return r}var i=!0;try{new ImageData(10,10)}catch(n){i=!1}var a=document.createElement("canvas").getContext("2d");o.newImageData=r},{}]},{},[1])(1)});ol.ext.pixelworks=o.exports}();goog.provide("ol.source.RasterOperationType");ol.source.RasterOperationType={PIXEL:"pixel",IMAGE:"image"};goog.provide("ol.source.Raster");goog.require("ol");goog.require("ol.ImageCanvas");goog.require("ol.TileQueue");goog.require("ol.dom");goog.require("ol.events");goog.require("ol.events.Event");goog.require("ol.events.EventType");goog.require("ol.ext.pixelworks");goog.require("ol.extent");goog.require("ol.layer.Image");goog.require("ol.layer.Tile");goog.require("ol.obj");goog.require("ol.renderer.canvas.ImageLayer");goog.require("ol.renderer.canvas.TileLayer");goog.require("ol.source.Image");goog.require("ol.source.RasterOperationType");goog.require("ol.source.State");goog.require("ol.source.Tile");goog.require("ol.transform");ol.source.Raster=function(e){this.worker_=null;this.operationType_=void 0!==e.operationType?e.operationType:ol.source.RasterOperationType.PIXEL;this.threads_=void 0!==e.threads?e.threads:1;this.renderers_=ol.source.Raster.createRenderers_(e.sources);for(var t=0,o=this.renderers_.length;o>t;++t)ol.events.listen(this.renderers_[t],ol.events.EventType.CHANGE,this.changed,this);this.tileQueue_=new ol.TileQueue(function(){return 1},this.changed.bind(this));for(var r=ol.source.Raster.getLayerStatesArray_(this.renderers_),i={},n=0,a=r.length;a>n;++n)i[ol.getUid(r[n].layer)]=r[n];this.requestedFrameState_;this.renderedImageCanvas_=null;this.renderedRevision_;this.frameState_={animate:!1,attributions:{},coordinateToPixelTransform:ol.transform.create(),extent:null,focus:null,index:0,layerStates:i,layerStatesArray:r,logos:{},pixelRatio:1,pixelToCoordinateTransform:ol.transform.create(),postRenderFunctions:[],size:[0,0],skippedFeatureUids:{},tileQueue:this.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{}};ol.source.Image.call(this,{});void 0!==e.operation&&this.setOperation(e.operation,e.lib)};ol.inherits(ol.source.Raster,ol.source.Image);ol.source.Raster.prototype.setOperation=function(e,t){this.worker_=new ol.ext.pixelworks.Processor({operation:e,imageOps:this.operationType_===ol.source.RasterOperationType.IMAGE,queue:1,lib:t,threads:this.threads_});this.changed()};ol.source.Raster.prototype.updateFrameState_=function(e,t,o){var r=ol.obj.assign({},this.frameState_);r.viewState=ol.obj.assign({},r.viewState);var i=ol.extent.getCenter(e);r.extent=e.slice();r.focus=i;r.size[0]=Math.round(ol.extent.getWidth(e)/t);r.size[1]=Math.round(ol.extent.getHeight(e)/t);var n=r.viewState;n.center=i;n.projection=o;n.resolution=t;return r};ol.source.Raster.prototype.allSourcesReady_=function(){for(var e,t=!0,o=0,r=this.renderers_.length;r>o;++o){e=this.renderers_[o].getLayer().getSource();if(e.getState()!==ol.source.State.READY){t=!1;break}}return t};ol.source.Raster.prototype.getImage=function(e,t,o,r){if(!this.allSourcesReady_())return null;var i=this.updateFrameState_(e,t,r);this.requestedFrameState_=i;i.tileQueue.loadMoreTiles(16,16);if(this.renderedImageCanvas_){var n=this.renderedImageCanvas_.getResolution(),a=this.renderedImageCanvas_.getExtent();t===n&&ol.extent.equals(e,a)||(this.renderedImageCanvas_=null)}this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_();return this.renderedImageCanvas_};ol.source.Raster.prototype.processSources_=function(){for(var e=this.requestedFrameState_,t=this.renderers_.length,o=new Array(t),r=0;t>r;++r){var i=ol.source.Raster.getImageData_(this.renderers_[r],e,e.layerStatesArray[r]);if(!i)return;o[r]=i}var n={};this.dispatchEvent(new ol.source.Raster.Event(ol.source.Raster.EventType_.BEFOREOPERATIONS,e,n));this.worker_.process(o,n,this.onWorkerComplete_.bind(this,e))};ol.source.Raster.prototype.onWorkerComplete_=function(e,t,o,r){if(!t&&o){var i=e.extent,n=e.viewState.resolution;if(n===this.requestedFrameState_.viewState.resolution&&ol.extent.equals(i,this.requestedFrameState_.extent)){var a;if(this.renderedImageCanvas_)a=this.renderedImageCanvas_.getImage().getContext("2d");else{var l=Math.round(ol.extent.getWidth(i)/n),s=Math.round(ol.extent.getHeight(i)/n);a=ol.dom.createCanvasContext2D(l,s);this.renderedImageCanvas_=new ol.ImageCanvas(i,n,1,this.getAttributions(),a.canvas)}a.putImageData(o,0,0);this.changed();this.renderedRevision_=this.getRevision();this.dispatchEvent(new ol.source.Raster.Event(ol.source.Raster.EventType_.AFTEROPERATIONS,e,r))}}};ol.source.Raster.getImageData_=function(e,t,o){if(!e.prepareFrame(t,o))return null;var r=t.size[0],i=t.size[1];if(ol.source.Raster.context_){var n=ol.source.Raster.context_.canvas;n.width!==r||n.height!==i?ol.source.Raster.context_=ol.dom.createCanvasContext2D(r,i):ol.source.Raster.context_.clearRect(0,0,r,i)}else ol.source.Raster.context_=ol.dom.createCanvasContext2D(r,i);e.composeFrame(t,o,ol.source.Raster.context_);return ol.source.Raster.context_.getImageData(0,0,r,i)};ol.source.Raster.context_=null;ol.source.Raster.getLayerStatesArray_=function(e){return e.map(function(e){return e.getLayer().getLayerState()})};ol.source.Raster.createRenderers_=function(e){for(var t=e.length,o=new Array(t),r=0;t>r;++r)o[r]=ol.source.Raster.createRenderer_(e[r]);return o};ol.source.Raster.createRenderer_=function(e){var t=null;e instanceof ol.source.Tile?t=ol.source.Raster.createTileRenderer_(e):e instanceof ol.source.Image&&(t=ol.source.Raster.createImageRenderer_(e));return t};ol.source.Raster.createImageRenderer_=function(e){var t=new ol.layer.Image({source:e});return new ol.renderer.canvas.ImageLayer(t)};ol.source.Raster.createTileRenderer_=function(e){var t=new ol.layer.Tile({source:e});return new ol.renderer.canvas.TileLayer(t)};ol.source.Raster.Event=function(e,t,o){ol.events.Event.call(this,e);this.extent=t.extent;this.resolution=t.viewState.resolution/t.pixelRatio;this.data=o};ol.inherits(ol.source.Raster.Event,ol.events.Event);ol.source.Raster.prototype.getImageInternal=function(){return null};ol.source.Raster.EventType_={BEFOREOPERATIONS:"beforeoperations",AFTEROPERATIONS:"afteroperations"};goog.provide("ol.source.Stamen");goog.require("ol");goog.require("ol.Attribution");goog.require("ol.source.OSM");goog.require("ol.source.XYZ");ol.source.Stamen=function(e){var t=e.layer.indexOf("-"),o=-1==t?e.layer:e.layer.slice(0,t),r=ol.source.Stamen.ProviderConfig[o],i=ol.source.Stamen.LayerConfig[e.layer],n=void 0!==e.url?e.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+e.layer+"/{z}/{x}/{y}."+i.extension;ol.source.XYZ.call(this,{attributions:ol.source.Stamen.ATTRIBUTIONS,cacheSize:e.cacheSize,crossOrigin:"anonymous",maxZoom:void 0!=e.maxZoom?e.maxZoom:r.maxZoom,minZoom:void 0!=e.minZoom?e.minZoom:r.minZoom,opaque:i.opaque,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,url:n})};ol.inherits(ol.source.Stamen,ol.source.XYZ);ol.source.Stamen.ATTRIBUTIONS=[new ol.Attribution({html:'Map tiles by <a href="http://stamen.com/">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.'}),ol.source.OSM.ATTRIBUTION];ol.source.Stamen.LayerConfig={terrain:{extension:"jpg",opaque:!0},"terrain-background":{extension:"jpg",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}};ol.source.Stamen.ProviderConfig={terrain:{minZoom:4,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:1,maxZoom:16}};goog.provide("ol.source.TileArcGISRest");goog.require("ol");goog.require("ol.extent");goog.require("ol.math");goog.require("ol.obj");goog.require("ol.size");goog.require("ol.source.TileImage");goog.require("ol.tilecoord");goog.require("ol.uri");ol.source.TileArcGISRest=function(e){var t=e||{};ol.source.TileImage.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,logo:t.logo,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:void 0!==t.wrapX?t.wrapX:!0});this.params_=t.params||{};this.tmpExtent_=ol.extent.createEmpty();this.setKey(this.getKeyForParams_())};ol.inherits(ol.source.TileArcGISRest,ol.source.TileImage);ol.source.TileArcGISRest.prototype.getKeyForParams_=function(){var e=0,t=[];for(var o in this.params_)t[e++]=o+"-"+this.params_[o];return t.join("/")};ol.source.TileArcGISRest.prototype.getParams=function(){return this.params_};ol.source.TileArcGISRest.prototype.getRequestUrl_=function(e,t,o,r,i,n){var a=this.urls;if(!a)return void 0;var l=i.getCode().split(":").pop();n.SIZE=t[0]+","+t[1];n.BBOX=o.join(",");n.BBOXSR=l;n.IMAGESR=l;n.DPI=Math.round(n.DPI?n.DPI*r:90*r);var s;if(1==a.length)s=a[0];else{var p=ol.math.modulo(ol.tilecoord.hash(e),a.length);s=a[p]}var c=s.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return ol.uri.appendParams(c,n)};ol.source.TileArcGISRest.prototype.getTilePixelRatio=function(e){return e};ol.source.TileArcGISRest.prototype.fixedTileUrlFunction=function(e,t,o){var r=this.getTileGrid();r||(r=this.getTileGridForProjection(o));if(r.getResolutions().length<=e[0])return void 0;var i=r.getTileCoordExtent(e,this.tmpExtent_),n=ol.size.toSize(r.getTileSize(e[0]),this.tmpSize);1!=t&&(n=ol.size.scale(n,t,this.tmpSize));var a={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};ol.obj.assign(a,this.params_);return this.getRequestUrl_(e,n,i,t,o,a)};ol.source.TileArcGISRest.prototype.updateParams=function(e){ol.obj.assign(this.params_,e);this.setKey(this.getKeyForParams_())};goog.provide("ol.source.TileDebug");goog.require("ol");goog.require("ol.Tile");goog.require("ol.TileState");goog.require("ol.dom");goog.require("ol.size");goog.require("ol.source.Tile");ol.source.TileDebug=function(e){ol.source.Tile.call(this,{opaque:!1,projection:e.projection,tileGrid:e.tileGrid,wrapX:void 0!==e.wrapX?e.wrapX:!0})};ol.inherits(ol.source.TileDebug,ol.source.Tile);ol.source.TileDebug.prototype.getTile=function(e,t,o){var r=this.getKeyZXY(e,t,o);if(this.tileCache.containsKey(r))return this.tileCache.get(r);var i=ol.size.toSize(this.tileGrid.getTileSize(e)),n=[e,t,o],a=this.getTileCoordForTileUrlFunction(n),l=a?this.getTileCoordForTileUrlFunction(a).toString():"",s=new ol.source.TileDebug.Tile_(n,i,l);this.tileCache.set(r,s);return s};ol.source.TileDebug.Tile_=function(e,t,o){ol.Tile.call(this,e,ol.TileState.LOADED);this.tileSize_=t;this.text_=o;this.canvas_=null};ol.inherits(ol.source.TileDebug.Tile_,ol.Tile);ol.source.TileDebug.Tile_.prototype.getImage=function(){if(this.canvas_)return this.canvas_;var e=this.tileSize_,t=ol.dom.createCanvasContext2D(e[0],e[1]);t.strokeStyle="black";t.strokeRect(.5,.5,e[0]+.5,e[1]+.5);t.fillStyle="black";t.textAlign="center";t.textBaseline="middle";t.font="24px sans-serif";t.fillText(this.text_,e[0]/2,e[1]/2);this.canvas_=t.canvas;return t.canvas};ol.source.TileDebug.Tile_.prototype.load=function(){};goog.provide("ol.source.TileJSON");goog.require("ol");goog.require("ol.Attribution");goog.require("ol.TileUrlFunction");goog.require("ol.extent");goog.require("ol.net");goog.require("ol.proj");goog.require("ol.source.State");goog.require("ol.source.TileImage");goog.require("ol.tilegrid");ol.source.TileJSON=function(e){this.tileJSON_=null;ol.source.TileImage.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,projection:ol.proj.get("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:ol.source.State.LOADING,tileLoadFunction:e.tileLoadFunction,wrapX:void 0!==e.wrapX?e.wrapX:!0});if(e.jsonp)ol.net.jsonp(e.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{var t=new XMLHttpRequest;t.addEventListener("load",this.onXHRLoad_.bind(this));t.addEventListener("error",this.onXHRError_.bind(this));t.open("GET",e.url);t.send()}};ol.inherits(ol.source.TileJSON,ol.source.TileImage);ol.source.TileJSON.prototype.onXHRLoad_=function(e){var t=e.target;if(!t.status||t.status>=200&&t.status<300){var o;try{o=JSON.parse(t.responseText)}catch(r){this.handleTileJSONError();return}this.handleTileJSONResponse(o)}else this.handleTileJSONError()};ol.source.TileJSON.prototype.onXHRError_=function(e){this.handleTileJSONError()};ol.source.TileJSON.prototype.getTileJSON=function(){return this.tileJSON_};ol.source.TileJSON.prototype.handleTileJSONResponse=function(e){var t,o=ol.proj.get("EPSG:4326"),r=this.getProjection();if(void 0!==e.bounds){var i=ol.proj.getTransformFromProjections(o,r);t=ol.extent.applyTransform(e.bounds,i)}var n=e.minzoom||0,a=e.maxzoom||22,l=ol.tilegrid.createXYZ({extent:ol.tilegrid.extentFromProjection(r),maxZoom:a,minZoom:n});this.tileGrid=l;this.tileUrlFunction=ol.TileUrlFunction.createFromTemplates(e.tiles,l);if(void 0!==e.attribution&&!this.getAttributions()){var s,p,c=void 0!==t?t:o.getExtent(),u={};for(s=n;a>=s;++s){p=s.toString();u[p]=[l.getTileRangeForExtentAndZ(c,s)]}this.setAttributions([new ol.Attribution({html:e.attribution,tileRanges:u})])}this.tileJSON_=e;this.setState(ol.source.State.READY)};ol.source.TileJSON.prototype.handleTileJSONError=function(){this.setState(ol.source.State.ERROR)};goog.provide("ol.source.TileUTFGrid");goog.require("ol");goog.require("ol.Attribution");goog.require("ol.Tile");goog.require("ol.TileState");goog.require("ol.TileUrlFunction");goog.require("ol.asserts");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.extent");goog.require("ol.net");goog.require("ol.proj");goog.require("ol.source.State");goog.require("ol.source.Tile");goog.require("ol.tilegrid");ol.source.TileUTFGrid=function(e){ol.source.Tile.call(this,{projection:ol.proj.get("EPSG:3857"),state:ol.source.State.LOADING});this.preemptive_=void 0!==e.preemptive?e.preemptive:!0;this.tileUrlFunction_=ol.TileUrlFunction.nullTileUrlFunction;this.template_=void 0;this.jsonp_=e.jsonp||!1;if(e.url)if(this.jsonp_)ol.net.jsonp(e.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{var t=new XMLHttpRequest;t.addEventListener("load",this.onXHRLoad_.bind(this));t.addEventListener("error",this.onXHRError_.bind(this));t.open("GET",e.url);t.send()}else e.tileJSON?this.handleTileJSONResponse(e.tileJSON):ol.asserts.assert(!1,51)};ol.inherits(ol.source.TileUTFGrid,ol.source.Tile);ol.source.TileUTFGrid.prototype.onXHRLoad_=function(e){var t=e.target;if(!t.status||t.status>=200&&t.status<300){var o;try{o=JSON.parse(t.responseText)}catch(r){this.handleTileJSONError();return}this.handleTileJSONResponse(o)}else this.handleTileJSONError()};ol.source.TileUTFGrid.prototype.onXHRError_=function(e){this.handleTileJSONError()};ol.source.TileUTFGrid.prototype.getTemplate=function(){return this.template_};ol.source.TileUTFGrid.prototype.forDataAtCoordinateAndResolution=function(e,t,o,r,i){if(this.tileGrid){var n=this.tileGrid.getTileCoordForCoordAndResolution(e,t),a=this.getTile(n[0],n[1],n[2],1,this.getProjection());a.forDataAtCoordinate(e,o,r,i)}else i===!0?setTimeout(function(){o.call(r,null)},0):o.call(r,null)};ol.source.TileUTFGrid.prototype.handleTileJSONError=function(){this.setState(ol.source.State.ERROR)};ol.source.TileUTFGrid.prototype.handleTileJSONResponse=function(e){var t,o=ol.proj.get("EPSG:4326"),r=this.getProjection();if(void 0!==e.bounds){var i=ol.proj.getTransformFromProjections(o,r);t=ol.extent.applyTransform(e.bounds,i)}var n=e.minzoom||0,a=e.maxzoom||22,l=ol.tilegrid.createXYZ({extent:ol.tilegrid.extentFromProjection(r),maxZoom:a,minZoom:n});this.tileGrid=l;this.template_=e.template;var s=e.grids;if(s){this.tileUrlFunction_=ol.TileUrlFunction.createFromTemplates(s,l);if(void 0!==e.attribution){var p,c,u=void 0!==t?t:o.getExtent(),g={};for(p=n;a>=p;++p){c=p.toString();g[c]=[l.getTileRangeForExtentAndZ(u,p)]}this.setAttributions([new ol.Attribution({html:e.attribution,tileRanges:g})])}this.setState(ol.source.State.READY)}else this.setState(ol.source.State.ERROR)};ol.source.TileUTFGrid.prototype.getTile=function(e,t,o,r,i){var n=this.getKeyZXY(e,t,o);if(this.tileCache.containsKey(n))return this.tileCache.get(n);var a=[e,t,o],l=this.getTileCoordForTileUrlFunction(a,i),s=this.tileUrlFunction_(l,r,i),p=new ol.source.TileUTFGrid.Tile_(a,void 0!==s?ol.TileState.IDLE:ol.TileState.EMPTY,void 0!==s?s:"",this.tileGrid.getTileCoordExtent(a),this.preemptive_,this.jsonp_);this.tileCache.set(n,p);return p};ol.source.TileUTFGrid.prototype.useTile=function(e,t,o){var r=this.getKeyZXY(e,t,o);this.tileCache.containsKey(r)&&this.tileCache.get(r)};ol.source.TileUTFGrid.Tile_=function(e,t,o,r,i,n){ol.Tile.call(this,e,t);this.src_=o;this.extent_=r;this.preemptive_=i;this.grid_=null;this.keys_=null;this.data_=null;this.jsonp_=n};ol.inherits(ol.source.TileUTFGrid.Tile_,ol.Tile);ol.source.TileUTFGrid.Tile_.prototype.getImage=function(){return null};ol.source.TileUTFGrid.Tile_.prototype.getData=function(e){if(!this.grid_||!this.keys_)return null;var t=(e[0]-this.extent_[0])/(this.extent_[2]-this.extent_[0]),o=(e[1]-this.extent_[1])/(this.extent_[3]-this.extent_[1]),r=this.grid_[Math.floor((1-o)*this.grid_.length)];if("string"!=typeof r)return null;var i=r.charCodeAt(Math.floor(t*r.length));i>=93&&i--;i>=35&&i--;i-=32;var n=null;if(i in this.keys_){var a=this.keys_[i];n=this.data_&&a in this.data_?this.data_[a]:a}return n};ol.source.TileUTFGrid.Tile_.prototype.forDataAtCoordinate=function(e,t,o,r){if(this.state==ol.TileState.IDLE&&r===!0){ol.events.listenOnce(this,ol.events.EventType.CHANGE,function(r){t.call(o,this.getData(e))},this);this.loadInternal_()}else r===!0?setTimeout(function(){t.call(o,this.getData(e))}.bind(this),0):t.call(o,this.getData(e))};ol.source.TileUTFGrid.Tile_.prototype.getKey=function(){return this.src_};ol.source.TileUTFGrid.Tile_.prototype.handleError_=function(){this.state=ol.TileState.ERROR;this.changed()};ol.source.TileUTFGrid.Tile_.prototype.handleLoad_=function(e){this.grid_=e.grid;this.keys_=e.keys;this.data_=e.data;this.state=ol.TileState.EMPTY;this.changed()};ol.source.TileUTFGrid.Tile_.prototype.loadInternal_=function(){if(this.state==ol.TileState.IDLE){this.state=ol.TileState.LOADING;if(this.jsonp_)ol.net.jsonp(this.src_,this.handleLoad_.bind(this),this.handleError_.bind(this));else{var e=new XMLHttpRequest;e.addEventListener("load",this.onXHRLoad_.bind(this));e.addEventListener("error",this.onXHRError_.bind(this));e.open("GET",this.src_);e.send()}}};ol.source.TileUTFGrid.Tile_.prototype.onXHRLoad_=function(e){var t=e.target;if(!t.status||t.status>=200&&t.status<300){var o;try{o=JSON.parse(t.responseText)}catch(r){this.handleError_();return}this.handleLoad_(o)}else this.handleError_()};ol.source.TileUTFGrid.Tile_.prototype.onXHRError_=function(e){this.handleError_()};ol.source.TileUTFGrid.Tile_.prototype.load=function(){this.preemptive_&&this.loadInternal_()};goog.provide("ol.source.TileWMS");goog.require("ol");goog.require("ol.asserts");goog.require("ol.extent");goog.require("ol.obj");goog.require("ol.math");goog.require("ol.proj");goog.require("ol.size");goog.require("ol.source.TileImage");goog.require("ol.source.WMSServerType");goog.require("ol.tilecoord");goog.require("ol.string");goog.require("ol.uri");ol.source.TileWMS=function(e){var t=e||{},o=t.params||{},r="TRANSPARENT"in o?o.TRANSPARENT:!0;ol.source.TileImage.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,logo:t.logo,opaque:!r,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:void 0!==t.wrapX?t.wrapX:!0});this.gutter_=void 0!==t.gutter?t.gutter:0;this.params_=o;this.v13_=!0;this.serverType_=t.serverType;this.hidpi_=void 0!==t.hidpi?t.hidpi:!0;this.coordKeyPrefix_="";this.resetCoordKeyPrefix_();this.tmpExtent_=ol.extent.createEmpty();this.updateV13_();this.setKey(this.getKeyForParams_())};ol.inherits(ol.source.TileWMS,ol.source.TileImage);ol.source.TileWMS.prototype.getGetFeatureInfoUrl=function(e,t,o,r){var i=ol.proj.get(o),n=this.getTileGrid();n||(n=this.getTileGridForProjection(i));var a=n.getTileCoordForCoordAndResolution(e,t);if(n.getResolutions().length<=a[0])return void 0;var l=n.getResolution(a[0]),s=n.getTileCoordExtent(a,this.tmpExtent_),p=ol.size.toSize(n.getTileSize(a[0]),this.tmpSize),c=this.gutter_;if(0!==c){p=ol.size.buffer(p,c,this.tmpSize);s=ol.extent.buffer(s,l*c,s)}var u={SERVICE:"WMS",VERSION:ol.DEFAULT_WMS_VERSION,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};ol.obj.assign(u,this.params_,r);var g=Math.floor((e[0]-s[0])/l),d=Math.floor((s[3]-e[1])/l);u[this.v13_?"I":"X"]=g;u[this.v13_?"J":"Y"]=d;return this.getRequestUrl_(a,p,s,1,i,u)};ol.source.TileWMS.prototype.getGutterInternal=function(){return this.gutter_};ol.source.TileWMS.prototype.getKeyZXY=function(e,t,o){return this.coordKeyPrefix_+ol.source.TileImage.prototype.getKeyZXY.call(this,e,t,o)};ol.source.TileWMS.prototype.getParams=function(){return this.params_};ol.source.TileWMS.prototype.getRequestUrl_=function(e,t,o,r,i,n){var a=this.urls;if(!a)return void 0;n.WIDTH=t[0];n.HEIGHT=t[1];n[this.v13_?"CRS":"SRS"]=i.getCode();"STYLES"in this.params_||(n.STYLES="");if(1!=r)switch(this.serverType_){case ol.source.WMSServerType.GEOSERVER:
var l=90*r+.5|0;"FORMAT_OPTIONS"in n?n.FORMAT_OPTIONS+=";dpi:"+l:n.FORMAT_OPTIONS="dpi:"+l;break;case ol.source.WMSServerType.MAPSERVER:n.MAP_RESOLUTION=90*r;break;case ol.source.WMSServerType.CARMENTA_SERVER:case ol.source.WMSServerType.QGIS:n.DPI=90*r;break;default:ol.asserts.assert(!1,52)}var s=i.getAxisOrientation(),p=o;if(this.v13_&&"ne"==s.substr(0,2)){var c;c=o[0];p[0]=o[1];p[1]=c;c=o[2];p[2]=o[3];p[3]=c}n.BBOX=p.join(",");var u;if(1==a.length)u=a[0];else{var g=ol.math.modulo(ol.tilecoord.hash(e),a.length);u=a[g]}return ol.uri.appendParams(u,n)};ol.source.TileWMS.prototype.getTilePixelRatio=function(e){return this.hidpi_&&void 0!==this.serverType_?e:1};ol.source.TileWMS.prototype.resetCoordKeyPrefix_=function(){var e=0,t=[];if(this.urls){var o,r;for(o=0,r=this.urls.length;r>o;++o)t[e++]=this.urls[o]}this.coordKeyPrefix_=t.join("#")};ol.source.TileWMS.prototype.getKeyForParams_=function(){var e=0,t=[];for(var o in this.params_)t[e++]=o+"-"+this.params_[o];return t.join("/")};ol.source.TileWMS.prototype.fixedTileUrlFunction=function(e,t,o){var r=this.getTileGrid();r||(r=this.getTileGridForProjection(o));if(r.getResolutions().length<=e[0])return void 0;1==t||this.hidpi_&&void 0!==this.serverType_||(t=1);var i=r.getResolution(e[0]),n=r.getTileCoordExtent(e,this.tmpExtent_),a=ol.size.toSize(r.getTileSize(e[0]),this.tmpSize),l=this.gutter_;if(0!==l){a=ol.size.buffer(a,l,this.tmpSize);n=ol.extent.buffer(n,i*l,n)}1!=t&&(a=ol.size.scale(a,t,this.tmpSize));var s={SERVICE:"WMS",VERSION:ol.DEFAULT_WMS_VERSION,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};ol.obj.assign(s,this.params_);return this.getRequestUrl_(e,a,n,t,o,s)};ol.source.TileWMS.prototype.setUrls=function(e){ol.source.TileImage.prototype.setUrls.call(this,e);this.resetCoordKeyPrefix_()};ol.source.TileWMS.prototype.updateParams=function(e){ol.obj.assign(this.params_,e);this.resetCoordKeyPrefix_();this.updateV13_();this.setKey(this.getKeyForParams_())};ol.source.TileWMS.prototype.updateV13_=function(){var e=this.params_.VERSION||ol.DEFAULT_WMS_VERSION;this.v13_=ol.string.compareVersions(e,"1.3")>=0};goog.provide("ol.VectorTile");goog.require("ol");goog.require("ol.Tile");goog.require("ol.TileState");goog.require("ol.dom");goog.require("ol.featureloader");ol.VectorTile=function(e,t,o,r,i){ol.Tile.call(this,e,t);this.context_=null;this.format_=r;this.features_=null;this.loader_;this.projection_;this.replayState_={dirty:!1,renderedRenderOrder:null,renderedRevision:-1,renderedTileRevision:-1,replayGroup:null};this.tileLoadFunction_=i;this.url_=o};ol.inherits(ol.VectorTile,ol.Tile);ol.VectorTile.prototype.getContext=function(){this.context_||(this.context_=ol.dom.createCanvasContext2D());return this.context_};ol.VectorTile.prototype.getImage=function(){return-1==this.replayState_.renderedTileRevision?null:this.context_.canvas};ol.VectorTile.prototype.getFormat=function(){return this.format_};ol.VectorTile.prototype.getFeatures=function(){return this.features_};ol.VectorTile.prototype.getReplayState=function(){return this.replayState_};ol.VectorTile.prototype.getKey=function(){return this.url_};ol.VectorTile.prototype.getProjection=function(){return this.projection_};ol.VectorTile.prototype.load=function(){if(this.state==ol.TileState.IDLE){this.setState(ol.TileState.LOADING);this.tileLoadFunction_(this,this.url_);this.loader_(null,0/0,null)}};ol.VectorTile.prototype.onLoad_=function(e,t){this.setProjection(t);this.setFeatures(e)};ol.VectorTile.prototype.onError_=function(){this.setState(ol.TileState.ERROR)};ol.VectorTile.prototype.setFeatures=function(e){this.features_=e;this.setState(ol.TileState.LOADED)};ol.VectorTile.prototype.setProjection=function(e){this.projection_=e};ol.VectorTile.prototype.setState=function(e){this.state=e;this.changed()};ol.VectorTile.prototype.setLoader=function(e){this.loader_=e};ol.VectorTile.defaultLoadFunction=function(e,t){var o=ol.featureloader.loadFeaturesXhr(t,e.getFormat(),e.onLoad_.bind(e),e.onError_.bind(e));e.setLoader(o)};goog.provide("ol.source.VectorTile");goog.require("ol");goog.require("ol.TileState");goog.require("ol.VectorTile");goog.require("ol.events");goog.require("ol.events.EventType");goog.require("ol.size");goog.require("ol.source.UrlTile");ol.source.VectorTile=function(e){ol.source.UrlTile.call(this,{attributions:e.attributions,cacheSize:void 0!==e.cacheSize?e.cacheSize:128,extent:e.extent,logo:e.logo,opaque:!1,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:ol.VectorTile.defaultLoadFunction,tileUrlFunction:e.tileUrlFunction,tilePixelRatio:e.tilePixelRatio,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX?!0:e.wrapX});this.format_=e.format?e.format:null;this.overlaps_=void 0==e.overlaps?!0:e.overlaps;this.tileClass=e.tileClass?e.tileClass:ol.VectorTile};ol.inherits(ol.source.VectorTile,ol.source.UrlTile);ol.source.VectorTile.prototype.getOverlaps=function(){return this.overlaps_};ol.source.VectorTile.prototype.getTile=function(e,t,o,r,i){var n=this.getKeyZXY(e,t,o);if(this.tileCache.containsKey(n))return this.tileCache.get(n);var a=[e,t,o],l=this.getTileCoordForTileUrlFunction(a,i),s=l?this.tileUrlFunction(l,r,i):void 0,p=new this.tileClass(a,void 0!==s?ol.TileState.IDLE:ol.TileState.EMPTY,void 0!==s?s:"",this.format_,this.tileLoadFunction);ol.events.listen(p,ol.events.EventType.CHANGE,this.handleTileChange,this);this.tileCache.set(n,p);return p};ol.source.VectorTile.prototype.getTilePixelRatio=function(e){return void 0==e?ol.source.UrlTile.prototype.getTilePixelRatio.call(this,e):e};ol.source.VectorTile.prototype.getTilePixelSize=function(e,t,o){var r=ol.size.toSize(this.tileGrid.getTileSize(e));return[Math.round(r[0]*t),Math.round(r[1]*t)]};goog.provide("ol.source.WMTSRequestEncoding");ol.source.WMTSRequestEncoding={KVP:"KVP",REST:"REST"};goog.provide("ol.tilegrid.WMTS");goog.require("ol");goog.require("ol.array");goog.require("ol.proj");goog.require("ol.tilegrid.TileGrid");ol.tilegrid.WMTS=function(e){this.matrixIds_=e.matrixIds;ol.tilegrid.TileGrid.call(this,{extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes})};ol.inherits(ol.tilegrid.WMTS,ol.tilegrid.TileGrid);ol.tilegrid.WMTS.prototype.getMatrixId=function(e){return this.matrixIds_[e]};ol.tilegrid.WMTS.prototype.getMatrixIds=function(){return this.matrixIds_};ol.tilegrid.WMTS.createFromCapabilitiesMatrixSet=function(e,t,o){var r,i=[],n=[],a=[],l=[],s=[],p=void 0!==o?o:[],c="SupportedCRS",u="TileMatrix",g="Identifier",d="ScaleDenominator",h="TopLeftCorner",f="TileWidth",y="TileHeight";r=ol.proj.get(e[c].replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"));var m=r.getMetersPerUnit(),v="ne"==r.getAxisOrientation().substr(0,2);e[u].sort(function(e,t){return t[d]-e[d]});e[u].forEach(function(e,t,o){var r;r=p.length>0?ol.array.find(p,function(t,o,r){return e[g]==t[u]}):!0;if(r){n.push(e[g]);var c=28e-5*e[d]/m,C=e[f],T=e[y];a.push(v?[e[h][1],e[h][0]]:e[h]);i.push(c);l.push(C==T?C:[C,T]);s.push([e.MatrixWidth,-e.MatrixHeight])}});return new ol.tilegrid.WMTS({extent:t,origins:a,resolutions:i,matrixIds:n,tileSizes:l,sizes:s})};goog.provide("ol.source.WMTS");goog.require("ol");goog.require("ol.TileUrlFunction");goog.require("ol.array");goog.require("ol.extent");goog.require("ol.obj");goog.require("ol.proj");goog.require("ol.source.TileImage");goog.require("ol.source.WMTSRequestEncoding");goog.require("ol.tilegrid.WMTS");goog.require("ol.uri");ol.source.WMTS=function(e){function t(e){e=r==ol.source.WMTSRequestEncoding.KVP?ol.uri.appendParams(e,n):e.replace(/\{(\w+?)\}/g,function(e,t){return t.toLowerCase()in n?n[t.toLowerCase()]:e});return function(t,o,n){if(t){var l={TileMatrix:i.getMatrixId(t[0]),TileCol:t[1],TileRow:-t[2]-1};ol.obj.assign(l,a);var s=e;s=r==ol.source.WMTSRequestEncoding.KVP?ol.uri.appendParams(s,l):s.replace(/\{(\w+?)\}/g,function(e,t){return l[t]});return s}return void 0}}this.version_=void 0!==e.version?e.version:"1.0.0";this.format_=void 0!==e.format?e.format:"image/jpeg";this.dimensions_=void 0!==e.dimensions?e.dimensions:{};this.layer_=e.layer;this.matrixSet_=e.matrixSet;this.style_=e.style;var o=e.urls;void 0===o&&void 0!==e.url&&(o=ol.TileUrlFunction.expandUrl(e.url));this.requestEncoding_=void 0!==e.requestEncoding?e.requestEncoding:ol.source.WMTSRequestEncoding.KVP;var r=this.requestEncoding_,i=e.tileGrid,n={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};r==ol.source.WMTSRequestEncoding.KVP&&ol.obj.assign(n,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_});var a=this.dimensions_,l=o&&o.length>0?ol.TileUrlFunction.createFromTileUrlFunctions(o.map(t)):ol.TileUrlFunction.nullTileUrlFunction;ol.source.TileImage.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,logo:e.logo,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:l,urls:o,wrapX:void 0!==e.wrapX?e.wrapX:!1});this.setKey(this.getKeyForDimensions_())};ol.inherits(ol.source.WMTS,ol.source.TileImage);ol.source.WMTS.prototype.getDimensions=function(){return this.dimensions_};ol.source.WMTS.prototype.getFormat=function(){return this.format_};ol.source.WMTS.prototype.getLayer=function(){return this.layer_};ol.source.WMTS.prototype.getMatrixSet=function(){return this.matrixSet_};ol.source.WMTS.prototype.getRequestEncoding=function(){return this.requestEncoding_};ol.source.WMTS.prototype.getStyle=function(){return this.style_};ol.source.WMTS.prototype.getVersion=function(){return this.version_};ol.source.WMTS.prototype.getKeyForDimensions_=function(){var e=0,t=[];for(var o in this.dimensions_)t[e++]=o+"-"+this.dimensions_[o];return t.join("/")};ol.source.WMTS.prototype.updateDimensions=function(e){ol.obj.assign(this.dimensions_,e);this.setKey(this.getKeyForDimensions_())};ol.source.WMTS.optionsFromCapabilities=function(e,t){var o=e.Contents.Layer,r=ol.array.find(o,function(e,o,r){return e.Identifier==t.layer});if(null===r)return null;var i,n,a,l=e.Contents.TileMatrixSet;i=r.TileMatrixSetLink.length>1?"projection"in t?ol.array.findIndex(r.TileMatrixSetLink,function(e,o,r){var i=ol.array.find(l,function(t){return t.Identifier==e.TileMatrixSet}),n=i.SupportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"),a=ol.proj.get(n),s=ol.proj.get(t.projection);return a&&s?ol.proj.equivalent(a,s):n==t.projection}):ol.array.findIndex(r.TileMatrixSetLink,function(e,o,r){return e.TileMatrixSet==t.matrixSet}):0;0>i&&(i=0);n=r.TileMatrixSetLink[i].TileMatrixSet;a=r.TileMatrixSetLink[i].TileMatrixSetLimits;var s=r.Format[0];"format"in t&&(s=t.format);i=ol.array.findIndex(r.Style,function(e,o,r){return"style"in t?e.Title==t.style:e.isDefault});0>i&&(i=0);var p=r.Style[i].Identifier,c={};"Dimension"in r&&r.Dimension.forEach(function(e,t,o){var r=e.Identifier,i=e.Default;void 0===i&&(i=e.Value[0]);c[r]=i});var u,g=e.Contents.TileMatrixSet,d=ol.array.find(g,function(e,t,o){return e.Identifier==n});u=ol.proj.get("projection"in t?t.projection:d.SupportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"));var h,f,y=r.WGS84BoundingBox;if(void 0!==y){var m=ol.proj.get("EPSG:4326").getExtent();f=y[0]==m[0]&&y[2]==m[2];h=ol.proj.transformExtent(y,"EPSG:4326",u);var v=u.getExtent();v&&(ol.extent.containsExtent(v,h)||(h=void 0))}var C=ol.tilegrid.WMTS.createFromCapabilitiesMatrixSet(d,h,a),T=[],_=t.requestEncoding;_=void 0!==_?_:"";if("OperationsMetadata"in e&&"GetTile"in e.OperationsMetadata)for(var S=e.OperationsMetadata.GetTile.DCP.HTTP.Get,E=0,x=S.length;x>E;++E){var P=ol.array.find(S[E].Constraint,function(e){return"GetEncoding"==e.name}),L=P.AllowedValues.Value;""===_&&(_=L[0]);if(_!==ol.source.WMTSRequestEncoding.KVP)break;ol.array.includes(L,ol.source.WMTSRequestEncoding.KVP)&&T.push(S[E].href)}if(0===T.length){_=ol.source.WMTSRequestEncoding.REST;r.ResourceURL.forEach(function(e){if("tile"===e.resourceType){s=e.format;T.push(e.template)}})}return{urls:T,layer:t.layer,matrixSet:n,format:s,projection:u,requestEncoding:_,tileGrid:C,style:p,dimensions:c,wrapX:f,crossOrigin:t.crossOrigin}};goog.provide("ol.source.Zoomify");goog.require("ol");goog.require("ol.ImageTile");goog.require("ol.TileState");goog.require("ol.TileUrlFunction");goog.require("ol.asserts");goog.require("ol.dom");goog.require("ol.extent");goog.require("ol.source.TileImage");goog.require("ol.tilegrid.TileGrid");ol.source.Zoomify=function(e){function t(e){return function(t,o,r){if(t){var i=t[0],n=t[1],a=-t[2]-1,s=n+a*l[i][0]+h[i],p=s/ol.DEFAULT_TILE_SIZE|0,c={z:i,x:n,y:a,TileGroup:"TileGroup"+p};return e.replace(/\{(\w+?)\}/g,function(e,t){return c[t]})}return void 0}}var o=e||{},r=o.size,i=void 0!==o.tierSizeCalculation?o.tierSizeCalculation:ol.source.Zoomify.TierSizeCalculation_.DEFAULT,n=r[0],a=r[1],l=[],s=ol.DEFAULT_TILE_SIZE;switch(i){case ol.source.Zoomify.TierSizeCalculation_.DEFAULT:for(;n>s||a>s;){l.push([Math.ceil(n/s),Math.ceil(a/s)]);s+=s}break;case ol.source.Zoomify.TierSizeCalculation_.TRUNCATED:for(var p=n,c=a;p>s||c>s;){l.push([Math.ceil(p/s),Math.ceil(c/s)]);p>>=1;c>>=1}break;default:ol.asserts.assert(!1,53)}l.push([1,1]);l.reverse();var u,g,d=[1],h=[0];for(u=1,g=l.length;g>u;u++){d.push(1<<u);h.push(l[u-1][0]*l[u-1][1]+h[u-1])}d.reverse();var f=[0,-r[1],r[0],0],y=new ol.tilegrid.TileGrid({extent:f,origin:ol.extent.getTopLeft(f),resolutions:d}),m=o.url;m&&-1==m.indexOf("{TileGroup}")&&(m+="{TileGroup}/{z}-{x}-{y}.jpg");var v=ol.TileUrlFunction.expandUrl(m),C=ol.TileUrlFunction.createFromTileUrlFunctions(v.map(t));ol.source.TileImage.call(this,{attributions:o.attributions,cacheSize:o.cacheSize,crossOrigin:o.crossOrigin,logo:o.logo,projection:o.projection,reprojectionErrorThreshold:o.reprojectionErrorThreshold,tileClass:ol.source.Zoomify.Tile_,tileGrid:y,tileUrlFunction:C})};ol.inherits(ol.source.Zoomify,ol.source.TileImage);ol.source.Zoomify.Tile_=function(e,t,o,r,i){ol.ImageTile.call(this,e,t,o,r,i);this.zoomifyImage_=null};ol.inherits(ol.source.Zoomify.Tile_,ol.ImageTile);ol.source.Zoomify.Tile_.prototype.getImage=function(){if(this.zoomifyImage_)return this.zoomifyImage_;var e=ol.DEFAULT_TILE_SIZE,t=ol.ImageTile.prototype.getImage.call(this);if(this.state==ol.TileState.LOADED){if(t.width==e&&t.height==e){this.zoomifyImage_=t;return t}var o=ol.dom.createCanvasContext2D(e,e);o.drawImage(t,0,0);this.zoomifyImage_=o.canvas;return o.canvas}return t};ol.source.Zoomify.TierSizeCalculation_={DEFAULT:"default",TRUNCATED:"truncated"};goog.provide("ol.style.Atlas");goog.require("ol.dom");ol.style.Atlas=function(e,t){this.space_=t;this.emptyBlocks_=[{x:0,y:0,width:e,height:e}];this.entries_={};this.context_=ol.dom.createCanvasContext2D(e,e);this.canvas_=this.context_.canvas};ol.style.Atlas.prototype.get=function(e){return this.entries_[e]||null};ol.style.Atlas.prototype.add=function(e,t,o,r,i){var n,a,l;for(a=0,l=this.emptyBlocks_.length;l>a;++a){n=this.emptyBlocks_[a];if(n.width>=t+this.space_&&n.height>=o+this.space_){var s={offsetX:n.x+this.space_,offsetY:n.y+this.space_,image:this.canvas_};this.entries_[e]=s;r.call(i,this.context_,n.x+this.space_,n.y+this.space_);this.split_(a,n,t+this.space_,o+this.space_);return s}}return null};ol.style.Atlas.prototype.split_=function(e,t,o,r){var i,n,a=t.width-o,l=t.height-r;if(a>l){i={x:t.x+o,y:t.y,width:t.width-o,height:t.height};n={x:t.x,y:t.y+r,width:o,height:t.height-r};this.updateBlocks_(e,i,n)}else{i={x:t.x+o,y:t.y,width:t.width-o,height:r};n={x:t.x,y:t.y+r,width:t.width,height:t.height-r};this.updateBlocks_(e,i,n)}};ol.style.Atlas.prototype.updateBlocks_=function(e,t,o){var r=[e,1];t.width>0&&t.height>0&&r.push(t);o.width>0&&o.height>0&&r.push(o);this.emptyBlocks_.splice.apply(this.emptyBlocks_,r)};goog.provide("ol.style.AtlasManager");goog.require("ol");goog.require("ol.style.Atlas");ol.style.AtlasManager=function(e){var t=e||{};this.currentSize_=void 0!==t.initialSize?t.initialSize:ol.INITIAL_ATLAS_SIZE;this.maxSize_=void 0!==t.maxSize?t.maxSize:-1!=ol.MAX_ATLAS_SIZE?ol.MAX_ATLAS_SIZE:void 0!==ol.WEBGL_MAX_TEXTURE_SIZE?ol.WEBGL_MAX_TEXTURE_SIZE:2048;this.space_=void 0!==t.space?t.space:1;this.atlases_=[new ol.style.Atlas(this.currentSize_,this.space_)];this.currentHitSize_=this.currentSize_;this.hitAtlases_=[new ol.style.Atlas(this.currentHitSize_,this.space_)]};ol.style.AtlasManager.prototype.getInfo=function(e){var t=this.getInfo_(this.atlases_,e);if(!t)return null;var o=this.getInfo_(this.hitAtlases_,e);return this.mergeInfos_(t,o)};ol.style.AtlasManager.prototype.getInfo_=function(e,t){var o,r,i,n;for(i=0,n=e.length;n>i;++i){o=e[i];r=o.get(t);if(r)return r}return null};ol.style.AtlasManager.prototype.mergeInfos_=function(e,t){return{offsetX:e.offsetX,offsetY:e.offsetY,image:e.image,hitImage:t.image}};ol.style.AtlasManager.prototype.add=function(e,t,o,r,i,n){if(t+this.space_>this.maxSize_||o+this.space_>this.maxSize_)return null;var a=this.add_(!1,e,t,o,r,n);if(!a)return null;var l=void 0!==i?i:ol.nullFunction,s=this.add_(!0,e,t,o,l,n);return this.mergeInfos_(a,s)};ol.style.AtlasManager.prototype.add_=function(e,t,o,r,i,n){var a,l,s,p,c=e?this.hitAtlases_:this.atlases_;for(s=0,p=c.length;p>s;++s){a=c[s];l=a.add(t,o,r,i,n);if(l)return l;if(!l&&s===p-1){var u;if(e){u=Math.min(2*this.currentHitSize_,this.maxSize_);this.currentHitSize_=u}else{u=Math.min(2*this.currentSize_,this.maxSize_);this.currentSize_=u}a=new ol.style.Atlas(u,this.space_);c.push(a);++p}}return null};goog.addDependency("demos/editor/equationeditor.js",["goog.demos.editor.EquationEditor"],["goog.ui.equation.EquationEditorDialog"]);goog.addDependency("demos/editor/helloworld.js",["goog.demos.editor.HelloWorld"],["goog.dom","goog.dom.TagName","goog.editor.Plugin"]);goog.addDependency("demos/editor/helloworlddialog.js",["goog.demos.editor.HelloWorldDialog","goog.demos.editor.HelloWorldDialog.OkEvent"],["goog.dom.TagName","goog.events.Event","goog.string","goog.ui.editor.AbstractDialog","goog.ui.editor.AbstractDialog.Builder","goog.ui.editor.AbstractDialog.EventType"]);goog.addDependency("demos/editor/helloworlddialogplugin.js",["goog.demos.editor.HelloWorldDialogPlugin","goog.demos.editor.HelloWorldDialogPlugin.Command"],["goog.demos.editor.HelloWorldDialog","goog.dom.TagName","goog.editor.plugins.AbstractDialogPlugin","goog.editor.range","goog.functions","goog.ui.editor.AbstractDialog.EventType"]);goog.require("ol");goog.require("ol.AssertionError");goog.require("ol.Attribution");goog.require("ol.Collection");goog.require("ol.DeviceOrientation");goog.require("ol.Feature");goog.require("ol.Geolocation");goog.require("ol.Graticule");goog.require("ol.Image");goog.require("ol.ImageTile");goog.require("ol.Kinetic");goog.require("ol.Map");goog.require("ol.MapBrowserEvent");goog.require("ol.MapEvent");goog.require("ol.Object");goog.require("ol.Observable");goog.require("ol.Overlay");goog.require("ol.Sphere");goog.require("ol.Tile");goog.require("ol.VectorTile");goog.require("ol.View");goog.require("ol.color");goog.require("ol.colorlike");goog.require("ol.control");goog.require("ol.control.Attribution");goog.require("ol.control.Control");goog.require("ol.control.FullScreen");goog.require("ol.control.MousePosition");goog.require("ol.control.OverviewMap");goog.require("ol.control.Rotate");goog.require("ol.control.ScaleLine");goog.require("ol.control.Zoom");goog.require("ol.control.ZoomSlider");goog.require("ol.control.ZoomToExtent");goog.require("ol.coordinate");goog.require("ol.easing");goog.require("ol.events.Event");goog.require("ol.events.condition");goog.require("ol.extent");goog.require("ol.featureloader");goog.require("ol.format.EsriJSON");goog.require("ol.format.Feature");goog.require("ol.format.GML");goog.require("ol.format.GML2");goog.require("ol.format.GML3");goog.require("ol.format.GMLBase");goog.require("ol.format.GPX");goog.require("ol.format.GeoJSON");goog.require("ol.format.IGC");goog.require("ol.format.KML");goog.require("ol.format.MVT");goog.require("ol.format.OSMXML");goog.require("ol.format.Polyline");goog.require("ol.format.TopoJSON");goog.require("ol.format.WFS");goog.require("ol.format.WKT");goog.require("ol.format.WMSCapabilities");goog.require("ol.format.WMSGetFeatureInfo");goog.require("ol.format.WMTSCapabilities");goog.require("ol.format.filter");goog.require("ol.format.filter.And");goog.require("ol.format.filter.Bbox");goog.require("ol.format.filter.Comparison");goog.require("ol.format.filter.ComparisonBinary");goog.require("ol.format.filter.EqualTo");goog.require("ol.format.filter.Filter");goog.require("ol.format.filter.GreaterThan");goog.require("ol.format.filter.GreaterThanOrEqualTo");goog.require("ol.format.filter.Intersects");goog.require("ol.format.filter.IsBetween");goog.require("ol.format.filter.IsLike");goog.require("ol.format.filter.IsNull");goog.require("ol.format.filter.LessThan");goog.require("ol.format.filter.LessThanOrEqualTo");goog.require("ol.format.filter.Not");goog.require("ol.format.filter.NotEqualTo");goog.require("ol.format.filter.Or");goog.require("ol.format.filter.Spatial");goog.require("ol.format.filter.Within");goog.require("ol.geom.Circle");goog.require("ol.geom.Geometry");goog.require("ol.geom.GeometryCollection");goog.require("ol.geom.LineString");goog.require("ol.geom.LinearRing");goog.require("ol.geom.MultiLineString");goog.require("ol.geom.MultiPoint");goog.require("ol.geom.MultiPolygon");goog.require("ol.geom.Point");goog.require("ol.geom.Polygon");goog.require("ol.geom.SimpleGeometry");goog.require("ol.has");goog.require("ol.interaction");goog.require("ol.interaction.DoubleClickZoom");goog.require("ol.interaction.DragAndDrop");goog.require("ol.interaction.DragBox");goog.require("ol.interaction.DragPan");goog.require("ol.interaction.DragRotate");goog.require("ol.interaction.DragRotateAndZoom");goog.require("ol.interaction.DragZoom");goog.require("ol.interaction.Draw");goog.require("ol.interaction.Extent");goog.require("ol.interaction.Interaction");goog.require("ol.interaction.KeyboardPan");goog.require("ol.interaction.KeyboardZoom");goog.require("ol.interaction.Modify");goog.require("ol.interaction.MouseWheelZoom");goog.require("ol.interaction.PinchRotate");goog.require("ol.interaction.PinchZoom");goog.require("ol.interaction.Pointer");goog.require("ol.interaction.Select");goog.require("ol.interaction.Snap");goog.require("ol.interaction.Translate");goog.require("ol.layer.Base");goog.require("ol.layer.Group");goog.require("ol.layer.Heatmap");goog.require("ol.layer.Image");goog.require("ol.layer.Layer");goog.require("ol.layer.Tile");goog.require("ol.layer.Vector");goog.require("ol.layer.VectorTile");goog.require("ol.loadingstrategy");goog.require("ol.proj");goog.require("ol.proj.Projection");goog.require("ol.proj.Units");goog.require("ol.proj.common");goog.require("ol.render");goog.require("ol.render.Event");goog.require("ol.render.Feature");goog.require("ol.render.VectorContext");goog.require("ol.render.canvas.Immediate");goog.require("ol.render.webgl.Immediate");goog.require("ol.size");goog.require("ol.source.BingMaps");goog.require("ol.source.CartoDB");goog.require("ol.source.Cluster");goog.require("ol.source.Image");goog.require("ol.source.ImageArcGISRest");goog.require("ol.source.ImageCanvas");goog.require("ol.source.ImageMapGuide");goog.require("ol.source.ImageStatic");goog.require("ol.source.ImageVector");goog.require("ol.source.ImageWMS");goog.require("ol.source.OSM");goog.require("ol.source.Raster");goog.require("ol.source.Source");goog.require("ol.source.Stamen");goog.require("ol.source.Tile");goog.require("ol.source.TileArcGISRest");goog.require("ol.source.TileDebug");goog.require("ol.source.TileImage");goog.require("ol.source.TileJSON");goog.require("ol.source.TileUTFGrid");goog.require("ol.source.TileWMS");goog.require("ol.source.UrlTile");goog.require("ol.source.Vector");goog.require("ol.source.VectorTile");goog.require("ol.source.WMTS");goog.require("ol.source.XYZ");goog.require("ol.source.Zoomify");goog.require("ol.style.AtlasManager");goog.require("ol.style.Circle");goog.require("ol.style.Fill");goog.require("ol.style.Icon");goog.require("ol.style.Image");goog.require("ol.style.RegularShape");goog.require("ol.style.Stroke");goog.require("ol.style.Style");goog.require("ol.style.Text");goog.require("ol.tilegrid");goog.require("ol.tilegrid.TileGrid");goog.require("ol.tilegrid.WMTS");goog.require("ol.webgl.Context");goog.require("ol.xml");goog.exportProperty(ol.AssertionError.prototype,"code",ol.AssertionError.prototype.code);goog.exportSymbol("ol.Attribution",ol.Attribution,OPENLAYERS);goog.exportProperty(ol.Attribution.prototype,"getHTML",ol.Attribution.prototype.getHTML);goog.exportSymbol("ol.Collection",ol.Collection,OPENLAYERS);goog.exportProperty(ol.Collection.prototype,"clear",ol.Collection.prototype.clear);goog.exportProperty(ol.Collection.prototype,"extend",ol.Collection.prototype.extend);goog.exportProperty(ol.Collection.prototype,"forEach",ol.Collection.prototype.forEach);goog.exportProperty(ol.Collection.prototype,"getArray",ol.Collection.prototype.getArray);goog.exportProperty(ol.Collection.prototype,"item",ol.Collection.prototype.item);goog.exportProperty(ol.Collection.prototype,"getLength",ol.Collection.prototype.getLength);goog.exportProperty(ol.Collection.prototype,"insertAt",ol.Collection.prototype.insertAt);goog.exportProperty(ol.Collection.prototype,"pop",ol.Collection.prototype.pop);goog.exportProperty(ol.Collection.prototype,"push",ol.Collection.prototype.push);goog.exportProperty(ol.Collection.prototype,"remove",ol.Collection.prototype.remove);goog.exportProperty(ol.Collection.prototype,"removeAt",ol.Collection.prototype.removeAt);goog.exportProperty(ol.Collection.prototype,"setAt",ol.Collection.prototype.setAt);goog.exportProperty(ol.Collection.Event.prototype,"element",ol.Collection.Event.prototype.element);goog.exportSymbol("ol.color.asArray",ol.color.asArray,OPENLAYERS);goog.exportSymbol("ol.color.asString",ol.color.asString,OPENLAYERS);goog.exportSymbol("ol.colorlike.asColorLike",ol.colorlike.asColorLike,OPENLAYERS);goog.exportSymbol("ol.control.defaults",ol.control.defaults,OPENLAYERS);goog.exportSymbol("ol.coordinate.add",ol.coordinate.add,OPENLAYERS);goog.exportSymbol("ol.coordinate.createStringXY",ol.coordinate.createStringXY,OPENLAYERS);goog.exportSymbol("ol.coordinate.format",ol.coordinate.format,OPENLAYERS);goog.exportSymbol("ol.coordinate.rotate",ol.coordinate.rotate,OPENLAYERS);goog.exportSymbol("ol.coordinate.toStringHDMS",ol.coordinate.toStringHDMS,OPENLAYERS);goog.exportSymbol("ol.coordinate.toStringXY",ol.coordinate.toStringXY,OPENLAYERS);goog.exportSymbol("ol.DeviceOrientation",ol.DeviceOrientation,OPENLAYERS);goog.exportProperty(ol.DeviceOrientation.prototype,"getAlpha",ol.DeviceOrientation.prototype.getAlpha);goog.exportProperty(ol.DeviceOrientation.prototype,"getBeta",ol.DeviceOrientation.prototype.getBeta);goog.exportProperty(ol.DeviceOrientation.prototype,"getGamma",ol.DeviceOrientation.prototype.getGamma);goog.exportProperty(ol.DeviceOrientation.prototype,"getHeading",ol.DeviceOrientation.prototype.getHeading);goog.exportProperty(ol.DeviceOrientation.prototype,"getTracking",ol.DeviceOrientation.prototype.getTracking);goog.exportProperty(ol.DeviceOrientation.prototype,"setTracking",ol.DeviceOrientation.prototype.setTracking);goog.exportSymbol("ol.easing.easeIn",ol.easing.easeIn,OPENLAYERS);goog.exportSymbol("ol.easing.easeOut",ol.easing.easeOut,OPENLAYERS);goog.exportSymbol("ol.easing.inAndOut",ol.easing.inAndOut,OPENLAYERS);goog.exportSymbol("ol.easing.linear",ol.easing.linear,OPENLAYERS);goog.exportSymbol("ol.easing.upAndDown",ol.easing.upAndDown,OPENLAYERS);goog.exportSymbol("ol.extent.boundingExtent",ol.extent.boundingExtent,OPENLAYERS);goog.exportSymbol("ol.extent.buffer",ol.extent.buffer,OPENLAYERS);goog.exportSymbol("ol.extent.containsCoordinate",ol.extent.containsCoordinate,OPENLAYERS);goog.exportSymbol("ol.extent.containsExtent",ol.extent.containsExtent,OPENLAYERS);goog.exportSymbol("ol.extent.containsXY",ol.extent.containsXY,OPENLAYERS);goog.exportSymbol("ol.extent.createEmpty",ol.extent.createEmpty,OPENLAYERS);goog.exportSymbol("ol.extent.equals",ol.extent.equals,OPENLAYERS);goog.exportSymbol("ol.extent.extend",ol.extent.extend,OPENLAYERS);goog.exportSymbol("ol.extent.getBottomLeft",ol.extent.getBottomLeft,OPENLAYERS);goog.exportSymbol("ol.extent.getBottomRight",ol.extent.getBottomRight,OPENLAYERS);goog.exportSymbol("ol.extent.getCenter",ol.extent.getCenter,OPENLAYERS);goog.exportSymbol("ol.extent.getHeight",ol.extent.getHeight,OPENLAYERS);goog.exportSymbol("ol.extent.getIntersection",ol.extent.getIntersection,OPENLAYERS);goog.exportSymbol("ol.extent.getSize",ol.extent.getSize,OPENLAYERS);goog.exportSymbol("ol.extent.getTopLeft",ol.extent.getTopLeft,OPENLAYERS);goog.exportSymbol("ol.extent.getTopRight",ol.extent.getTopRight,OPENLAYERS);goog.exportSymbol("ol.extent.getWidth",ol.extent.getWidth,OPENLAYERS);goog.exportSymbol("ol.extent.intersects",ol.extent.intersects,OPENLAYERS);goog.exportSymbol("ol.extent.isEmpty",ol.extent.isEmpty,OPENLAYERS);goog.exportSymbol("ol.extent.applyTransform",ol.extent.applyTransform,OPENLAYERS);goog.exportSymbol("ol.Feature",ol.Feature,OPENLAYERS);goog.exportProperty(ol.Feature.prototype,"clone",ol.Feature.prototype.clone);goog.exportProperty(ol.Feature.prototype,"getGeometry",ol.Feature.prototype.getGeometry);goog.exportProperty(ol.Feature.prototype,"getId",ol.Feature.prototype.getId);goog.exportProperty(ol.Feature.prototype,"getGeometryName",ol.Feature.prototype.getGeometryName);goog.exportProperty(ol.Feature.prototype,"getStyle",ol.Feature.prototype.getStyle);goog.exportProperty(ol.Feature.prototype,"getStyleFunction",ol.Feature.prototype.getStyleFunction);goog.exportProperty(ol.Feature.prototype,"setGeometry",ol.Feature.prototype.setGeometry);goog.exportProperty(ol.Feature.prototype,"setStyle",ol.Feature.prototype.setStyle);goog.exportProperty(ol.Feature.prototype,"setId",ol.Feature.prototype.setId);goog.exportProperty(ol.Feature.prototype,"setGeometryName",ol.Feature.prototype.setGeometryName);goog.exportSymbol("ol.featureloader.xhr",ol.featureloader.xhr,OPENLAYERS);goog.exportSymbol("ol.Geolocation",ol.Geolocation,OPENLAYERS);goog.exportProperty(ol.Geolocation.prototype,"getAccuracy",ol.Geolocation.prototype.getAccuracy);goog.exportProperty(ol.Geolocation.prototype,"getAccuracyGeometry",ol.Geolocation.prototype.getAccuracyGeometry);goog.exportProperty(ol.Geolocation.prototype,"getAltitude",ol.Geolocation.prototype.getAltitude);goog.exportProperty(ol.Geolocation.prototype,"getAltitudeAccuracy",ol.Geolocation.prototype.getAltitudeAccuracy);goog.exportProperty(ol.Geolocation.prototype,"getHeading",ol.Geolocation.prototype.getHeading);goog.exportProperty(ol.Geolocation.prototype,"getPosition",ol.Geolocation.prototype.getPosition);goog.exportProperty(ol.Geolocation.prototype,"getProjection",ol.Geolocation.prototype.getProjection);goog.exportProperty(ol.Geolocation.prototype,"getSpeed",ol.Geolocation.prototype.getSpeed);goog.exportProperty(ol.Geolocation.prototype,"getTracking",ol.Geolocation.prototype.getTracking);goog.exportProperty(ol.Geolocation.prototype,"getTrackingOptions",ol.Geolocation.prototype.getTrackingOptions);goog.exportProperty(ol.Geolocation.prototype,"setProjection",ol.Geolocation.prototype.setProjection);goog.exportProperty(ol.Geolocation.prototype,"setTracking",ol.Geolocation.prototype.setTracking);goog.exportProperty(ol.Geolocation.prototype,"setTrackingOptions",ol.Geolocation.prototype.setTrackingOptions);goog.exportSymbol("ol.Graticule",ol.Graticule,OPENLAYERS);goog.exportProperty(ol.Graticule.prototype,"getMap",ol.Graticule.prototype.getMap);goog.exportProperty(ol.Graticule.prototype,"getMeridians",ol.Graticule.prototype.getMeridians);goog.exportProperty(ol.Graticule.prototype,"getParallels",ol.Graticule.prototype.getParallels);goog.exportProperty(ol.Graticule.prototype,"setMap",ol.Graticule.prototype.setMap);goog.exportSymbol("ol.has.DEVICE_PIXEL_RATIO",ol.has.DEVICE_PIXEL_RATIO,OPENLAYERS);

goog.exportSymbol("ol.has.CANVAS",ol.has.CANVAS,OPENLAYERS);goog.exportSymbol("ol.has.DEVICE_ORIENTATION",ol.has.DEVICE_ORIENTATION,OPENLAYERS);goog.exportSymbol("ol.has.GEOLOCATION",ol.has.GEOLOCATION,OPENLAYERS);goog.exportSymbol("ol.has.TOUCH",ol.has.TOUCH,OPENLAYERS);goog.exportSymbol("ol.has.WEBGL",ol.has.WEBGL,OPENLAYERS);goog.exportProperty(ol.Image.prototype,"getImage",ol.Image.prototype.getImage);goog.exportProperty(ol.Image.prototype,"load",ol.Image.prototype.load);goog.exportProperty(ol.ImageTile.prototype,"getImage",ol.ImageTile.prototype.getImage);goog.exportSymbol("ol.inherits",ol.inherits,OPENLAYERS);goog.exportSymbol("ol.interaction.defaults",ol.interaction.defaults,OPENLAYERS);goog.exportSymbol("ol.Kinetic",ol.Kinetic,OPENLAYERS);goog.exportSymbol("ol.loadingstrategy.all",ol.loadingstrategy.all,OPENLAYERS);goog.exportSymbol("ol.loadingstrategy.bbox",ol.loadingstrategy.bbox,OPENLAYERS);goog.exportSymbol("ol.loadingstrategy.tile",ol.loadingstrategy.tile,OPENLAYERS);goog.exportSymbol("ol.Map",ol.Map,OPENLAYERS);goog.exportProperty(ol.Map.prototype,"addControl",ol.Map.prototype.addControl);goog.exportProperty(ol.Map.prototype,"addInteraction",ol.Map.prototype.addInteraction);goog.exportProperty(ol.Map.prototype,"addLayer",ol.Map.prototype.addLayer);goog.exportProperty(ol.Map.prototype,"addOverlay",ol.Map.prototype.addOverlay);goog.exportProperty(ol.Map.prototype,"forEachFeatureAtPixel",ol.Map.prototype.forEachFeatureAtPixel);goog.exportProperty(ol.Map.prototype,"forEachLayerAtPixel",ol.Map.prototype.forEachLayerAtPixel);goog.exportProperty(ol.Map.prototype,"hasFeatureAtPixel",ol.Map.prototype.hasFeatureAtPixel);goog.exportProperty(ol.Map.prototype,"getEventCoordinate",ol.Map.prototype.getEventCoordinate);goog.exportProperty(ol.Map.prototype,"getEventPixel",ol.Map.prototype.getEventPixel);goog.exportProperty(ol.Map.prototype,"getTarget",ol.Map.prototype.getTarget);goog.exportProperty(ol.Map.prototype,"getTargetElement",ol.Map.prototype.getTargetElement);goog.exportProperty(ol.Map.prototype,"getCoordinateFromPixel",ol.Map.prototype.getCoordinateFromPixel);goog.exportProperty(ol.Map.prototype,"getControls",ol.Map.prototype.getControls);goog.exportProperty(ol.Map.prototype,"getOverlays",ol.Map.prototype.getOverlays);goog.exportProperty(ol.Map.prototype,"getOverlayById",ol.Map.prototype.getOverlayById);goog.exportProperty(ol.Map.prototype,"getInteractions",ol.Map.prototype.getInteractions);goog.exportProperty(ol.Map.prototype,"getLayerGroup",ol.Map.prototype.getLayerGroup);goog.exportProperty(ol.Map.prototype,"getLayers",ol.Map.prototype.getLayers);goog.exportProperty(ol.Map.prototype,"getPixelFromCoordinate",ol.Map.prototype.getPixelFromCoordinate);goog.exportProperty(ol.Map.prototype,"getSize",ol.Map.prototype.getSize);goog.exportProperty(ol.Map.prototype,"getView",ol.Map.prototype.getView);goog.exportProperty(ol.Map.prototype,"getViewport",ol.Map.prototype.getViewport);goog.exportProperty(ol.Map.prototype,"renderSync",ol.Map.prototype.renderSync);goog.exportProperty(ol.Map.prototype,"render",ol.Map.prototype.render);goog.exportProperty(ol.Map.prototype,"removeControl",ol.Map.prototype.removeControl);goog.exportProperty(ol.Map.prototype,"removeInteraction",ol.Map.prototype.removeInteraction);goog.exportProperty(ol.Map.prototype,"removeLayer",ol.Map.prototype.removeLayer);goog.exportProperty(ol.Map.prototype,"removeOverlay",ol.Map.prototype.removeOverlay);goog.exportProperty(ol.Map.prototype,"setLayerGroup",ol.Map.prototype.setLayerGroup);goog.exportProperty(ol.Map.prototype,"setSize",ol.Map.prototype.setSize);goog.exportProperty(ol.Map.prototype,"setTarget",ol.Map.prototype.setTarget);goog.exportProperty(ol.Map.prototype,"setView",ol.Map.prototype.setView);goog.exportProperty(ol.Map.prototype,"updateSize",ol.Map.prototype.updateSize);goog.exportProperty(ol.MapBrowserEvent.prototype,"originalEvent",ol.MapBrowserEvent.prototype.originalEvent);goog.exportProperty(ol.MapBrowserEvent.prototype,"pixel",ol.MapBrowserEvent.prototype.pixel);goog.exportProperty(ol.MapBrowserEvent.prototype,"coordinate",ol.MapBrowserEvent.prototype.coordinate);goog.exportProperty(ol.MapBrowserEvent.prototype,"dragging",ol.MapBrowserEvent.prototype.dragging);goog.exportProperty(ol.MapEvent.prototype,"map",ol.MapEvent.prototype.map);goog.exportProperty(ol.MapEvent.prototype,"frameState",ol.MapEvent.prototype.frameState);goog.exportSymbol("ol.Object",ol.Object,OPENLAYERS);goog.exportProperty(ol.Object.prototype,"get",ol.Object.prototype.get);goog.exportProperty(ol.Object.prototype,"getKeys",ol.Object.prototype.getKeys);goog.exportProperty(ol.Object.prototype,"getProperties",ol.Object.prototype.getProperties);goog.exportProperty(ol.Object.prototype,"set",ol.Object.prototype.set);goog.exportProperty(ol.Object.prototype,"setProperties",ol.Object.prototype.setProperties);goog.exportProperty(ol.Object.prototype,"unset",ol.Object.prototype.unset);goog.exportProperty(ol.Object.Event.prototype,"key",ol.Object.Event.prototype.key);goog.exportProperty(ol.Object.Event.prototype,"oldValue",ol.Object.Event.prototype.oldValue);goog.exportSymbol("ol.Observable",ol.Observable,OPENLAYERS);goog.exportSymbol("ol.Observable.unByKey",ol.Observable.unByKey,OPENLAYERS);goog.exportProperty(ol.Observable.prototype,"changed",ol.Observable.prototype.changed);goog.exportProperty(ol.Observable.prototype,"dispatchEvent",ol.Observable.prototype.dispatchEvent);goog.exportProperty(ol.Observable.prototype,"getRevision",ol.Observable.prototype.getRevision);goog.exportProperty(ol.Observable.prototype,"on",ol.Observable.prototype.on);goog.exportProperty(ol.Observable.prototype,"once",ol.Observable.prototype.once);goog.exportProperty(ol.Observable.prototype,"un",ol.Observable.prototype.un);goog.exportSymbol("ol.Overlay",ol.Overlay,OPENLAYERS);goog.exportProperty(ol.Overlay.prototype,"getElement",ol.Overlay.prototype.getElement);goog.exportProperty(ol.Overlay.prototype,"getId",ol.Overlay.prototype.getId);goog.exportProperty(ol.Overlay.prototype,"getMap",ol.Overlay.prototype.getMap);goog.exportProperty(ol.Overlay.prototype,"getOffset",ol.Overlay.prototype.getOffset);goog.exportProperty(ol.Overlay.prototype,"getPosition",ol.Overlay.prototype.getPosition);goog.exportProperty(ol.Overlay.prototype,"getPositioning",ol.Overlay.prototype.getPositioning);goog.exportProperty(ol.Overlay.prototype,"setElement",ol.Overlay.prototype.setElement);goog.exportProperty(ol.Overlay.prototype,"setMap",ol.Overlay.prototype.setMap);goog.exportProperty(ol.Overlay.prototype,"setOffset",ol.Overlay.prototype.setOffset);goog.exportProperty(ol.Overlay.prototype,"setPosition",ol.Overlay.prototype.setPosition);goog.exportProperty(ol.Overlay.prototype,"setPositioning",ol.Overlay.prototype.setPositioning);goog.exportSymbol("ol.proj.METERS_PER_UNIT",ol.proj.METERS_PER_UNIT,OPENLAYERS);goog.exportSymbol("ol.proj.setProj4",ol.proj.setProj4,OPENLAYERS);goog.exportSymbol("ol.proj.getPointResolution",ol.proj.getPointResolution,OPENLAYERS);goog.exportSymbol("ol.proj.addEquivalentProjections",ol.proj.addEquivalentProjections,OPENLAYERS);goog.exportSymbol("ol.proj.addProjection",ol.proj.addProjection,OPENLAYERS);goog.exportSymbol("ol.proj.addCoordinateTransforms",ol.proj.addCoordinateTransforms,OPENLAYERS);goog.exportSymbol("ol.proj.fromLonLat",ol.proj.fromLonLat,OPENLAYERS);goog.exportSymbol("ol.proj.toLonLat",ol.proj.toLonLat,OPENLAYERS);goog.exportSymbol("ol.proj.get",ol.proj.get,OPENLAYERS);goog.exportSymbol("ol.proj.equivalent",ol.proj.equivalent,OPENLAYERS);goog.exportSymbol("ol.proj.getTransform",ol.proj.getTransform,OPENLAYERS);goog.exportSymbol("ol.proj.transform",ol.proj.transform,OPENLAYERS);goog.exportSymbol("ol.proj.transformExtent",ol.proj.transformExtent,OPENLAYERS);goog.exportSymbol("ol.render.toContext",ol.render.toContext,OPENLAYERS);goog.exportSymbol("ol.size.toSize",ol.size.toSize,OPENLAYERS);goog.exportSymbol("ol.Sphere",ol.Sphere,OPENLAYERS);goog.exportProperty(ol.Sphere.prototype,"geodesicArea",ol.Sphere.prototype.geodesicArea);goog.exportProperty(ol.Sphere.prototype,"haversineDistance",ol.Sphere.prototype.haversineDistance);goog.exportProperty(ol.Tile.prototype,"getTileCoord",ol.Tile.prototype.getTileCoord);goog.exportProperty(ol.Tile.prototype,"load",ol.Tile.prototype.load);goog.exportSymbol("ol.tilegrid.createXYZ",ol.tilegrid.createXYZ,OPENLAYERS);goog.exportProperty(ol.VectorTile.prototype,"getFormat",ol.VectorTile.prototype.getFormat);goog.exportProperty(ol.VectorTile.prototype,"setFeatures",ol.VectorTile.prototype.setFeatures);goog.exportProperty(ol.VectorTile.prototype,"setProjection",ol.VectorTile.prototype.setProjection);goog.exportProperty(ol.VectorTile.prototype,"setLoader",ol.VectorTile.prototype.setLoader);goog.exportSymbol("ol.View",ol.View,OPENLAYERS);goog.exportProperty(ol.View.prototype,"animate",ol.View.prototype.animate);goog.exportProperty(ol.View.prototype,"getAnimating",ol.View.prototype.getAnimating);goog.exportProperty(ol.View.prototype,"cancelAnimations",ol.View.prototype.cancelAnimations);goog.exportProperty(ol.View.prototype,"constrainCenter",ol.View.prototype.constrainCenter);goog.exportProperty(ol.View.prototype,"constrainResolution",ol.View.prototype.constrainResolution);goog.exportProperty(ol.View.prototype,"constrainRotation",ol.View.prototype.constrainRotation);goog.exportProperty(ol.View.prototype,"getCenter",ol.View.prototype.getCenter);goog.exportProperty(ol.View.prototype,"calculateExtent",ol.View.prototype.calculateExtent);goog.exportProperty(ol.View.prototype,"getMaxResolution",ol.View.prototype.getMaxResolution);goog.exportProperty(ol.View.prototype,"getMinResolution",ol.View.prototype.getMinResolution);goog.exportProperty(ol.View.prototype,"getMaxZoom",ol.View.prototype.getMaxZoom);goog.exportProperty(ol.View.prototype,"setMaxZoom",ol.View.prototype.setMaxZoom);goog.exportProperty(ol.View.prototype,"getMinZoom",ol.View.prototype.getMinZoom);goog.exportProperty(ol.View.prototype,"setMinZoom",ol.View.prototype.setMinZoom);goog.exportProperty(ol.View.prototype,"getProjection",ol.View.prototype.getProjection);goog.exportProperty(ol.View.prototype,"getResolution",ol.View.prototype.getResolution);goog.exportProperty(ol.View.prototype,"getResolutions",ol.View.prototype.getResolutions);goog.exportProperty(ol.View.prototype,"getRotation",ol.View.prototype.getRotation);goog.exportProperty(ol.View.prototype,"getZoom",ol.View.prototype.getZoom);goog.exportProperty(ol.View.prototype,"getZoomForResolution",ol.View.prototype.getZoomForResolution);goog.exportProperty(ol.View.prototype,"fit",ol.View.prototype.fit);goog.exportProperty(ol.View.prototype,"centerOn",ol.View.prototype.centerOn);goog.exportProperty(ol.View.prototype,"rotate",ol.View.prototype.rotate);goog.exportProperty(ol.View.prototype,"setCenter",ol.View.prototype.setCenter);goog.exportProperty(ol.View.prototype,"setResolution",ol.View.prototype.setResolution);goog.exportProperty(ol.View.prototype,"setRotation",ol.View.prototype.setRotation);goog.exportProperty(ol.View.prototype,"setZoom",ol.View.prototype.setZoom);goog.exportSymbol("ol.xml.getAllTextContent",ol.xml.getAllTextContent,OPENLAYERS);goog.exportSymbol("ol.xml.parse",ol.xml.parse,OPENLAYERS);goog.exportProperty(ol.webgl.Context.prototype,"getGL",ol.webgl.Context.prototype.getGL);goog.exportProperty(ol.webgl.Context.prototype,"useProgram",ol.webgl.Context.prototype.useProgram);goog.exportSymbol("ol.tilegrid.TileGrid",ol.tilegrid.TileGrid,OPENLAYERS);goog.exportProperty(ol.tilegrid.TileGrid.prototype,"forEachTileCoord",ol.tilegrid.TileGrid.prototype.forEachTileCoord);goog.exportProperty(ol.tilegrid.TileGrid.prototype,"getMaxZoom",ol.tilegrid.TileGrid.prototype.getMaxZoom);goog.exportProperty(ol.tilegrid.TileGrid.prototype,"getMinZoom",ol.tilegrid.TileGrid.prototype.getMinZoom);goog.exportProperty(ol.tilegrid.TileGrid.prototype,"getOrigin",ol.tilegrid.TileGrid.prototype.getOrigin);goog.exportProperty(ol.tilegrid.TileGrid.prototype,"getResolution",ol.tilegrid.TileGrid.prototype.getResolution);goog.exportProperty(ol.tilegrid.TileGrid.prototype,"getResolutions",ol.tilegrid.TileGrid.prototype.getResolutions);goog.exportProperty(ol.tilegrid.TileGrid.prototype,"getTileCoordExtent",ol.tilegrid.TileGrid.prototype.getTileCoordExtent);goog.exportProperty(ol.tilegrid.TileGrid.prototype,"getTileCoordForCoordAndResolution",ol.tilegrid.TileGrid.prototype.getTileCoordForCoordAndResolution);goog.exportProperty(ol.tilegrid.TileGrid.prototype,"getTileCoordForCoordAndZ",ol.tilegrid.TileGrid.prototype.getTileCoordForCoordAndZ);goog.exportProperty(ol.tilegrid.TileGrid.prototype,"getTileSize",ol.tilegrid.TileGrid.prototype.getTileSize);goog.exportProperty(ol.tilegrid.TileGrid.prototype,"getZForResolution",ol.tilegrid.TileGrid.prototype.getZForResolution);goog.exportSymbol("ol.tilegrid.WMTS",ol.tilegrid.WMTS,OPENLAYERS);goog.exportProperty(ol.tilegrid.WMTS.prototype,"getMatrixIds",ol.tilegrid.WMTS.prototype.getMatrixIds);goog.exportSymbol("ol.tilegrid.WMTS.createFromCapabilitiesMatrixSet",ol.tilegrid.WMTS.createFromCapabilitiesMatrixSet,OPENLAYERS);goog.exportSymbol("ol.style.AtlasManager",ol.style.AtlasManager,OPENLAYERS);goog.exportSymbol("ol.style.Circle",ol.style.Circle,OPENLAYERS);goog.exportProperty(ol.style.Circle.prototype,"setRadius",ol.style.Circle.prototype.setRadius);goog.exportSymbol("ol.style.Fill",ol.style.Fill,OPENLAYERS);goog.exportProperty(ol.style.Fill.prototype,"clone",ol.style.Fill.prototype.clone);goog.exportProperty(ol.style.Fill.prototype,"getColor",ol.style.Fill.prototype.getColor);goog.exportProperty(ol.style.Fill.prototype,"setColor",ol.style.Fill.prototype.setColor);goog.exportSymbol("ol.style.Icon",ol.style.Icon,OPENLAYERS);goog.exportProperty(ol.style.Icon.prototype,"clone",ol.style.Icon.prototype.clone);goog.exportProperty(ol.style.Icon.prototype,"getAnchor",ol.style.Icon.prototype.getAnchor);goog.exportProperty(ol.style.Icon.prototype,"getColor",ol.style.Icon.prototype.getColor);goog.exportProperty(ol.style.Icon.prototype,"getImage",ol.style.Icon.prototype.getImage);goog.exportProperty(ol.style.Icon.prototype,"getOrigin",ol.style.Icon.prototype.getOrigin);goog.exportProperty(ol.style.Icon.prototype,"getSrc",ol.style.Icon.prototype.getSrc);goog.exportProperty(ol.style.Icon.prototype,"getSize",ol.style.Icon.prototype.getSize);goog.exportProperty(ol.style.Icon.prototype,"load",ol.style.Icon.prototype.load);goog.exportSymbol("ol.style.Image",ol.style.Image,OPENLAYERS);goog.exportProperty(ol.style.Image.prototype,"getOpacity",ol.style.Image.prototype.getOpacity);goog.exportProperty(ol.style.Image.prototype,"getRotateWithView",ol.style.Image.prototype.getRotateWithView);goog.exportProperty(ol.style.Image.prototype,"getRotation",ol.style.Image.prototype.getRotation);goog.exportProperty(ol.style.Image.prototype,"getScale",ol.style.Image.prototype.getScale);goog.exportProperty(ol.style.Image.prototype,"getSnapToPixel",ol.style.Image.prototype.getSnapToPixel);goog.exportProperty(ol.style.Image.prototype,"setOpacity",ol.style.Image.prototype.setOpacity);goog.exportProperty(ol.style.Image.prototype,"setRotation",ol.style.Image.prototype.setRotation);goog.exportProperty(ol.style.Image.prototype,"setScale",ol.style.Image.prototype.setScale);goog.exportSymbol("ol.style.RegularShape",ol.style.RegularShape,OPENLAYERS);goog.exportProperty(ol.style.RegularShape.prototype,"clone",ol.style.RegularShape.prototype.clone);goog.exportProperty(ol.style.RegularShape.prototype,"getAnchor",ol.style.RegularShape.prototype.getAnchor);goog.exportProperty(ol.style.RegularShape.prototype,"getAngle",ol.style.RegularShape.prototype.getAngle);goog.exportProperty(ol.style.RegularShape.prototype,"getFill",ol.style.RegularShape.prototype.getFill);goog.exportProperty(ol.style.RegularShape.prototype,"getImage",ol.style.RegularShape.prototype.getImage);goog.exportProperty(ol.style.RegularShape.prototype,"getOrigin",ol.style.RegularShape.prototype.getOrigin);goog.exportProperty(ol.style.RegularShape.prototype,"getPoints",ol.style.RegularShape.prototype.getPoints);goog.exportProperty(ol.style.RegularShape.prototype,"getRadius",ol.style.RegularShape.prototype.getRadius);goog.exportProperty(ol.style.RegularShape.prototype,"getRadius2",ol.style.RegularShape.prototype.getRadius2);goog.exportProperty(ol.style.RegularShape.prototype,"getSize",ol.style.RegularShape.prototype.getSize);goog.exportProperty(ol.style.RegularShape.prototype,"getStroke",ol.style.RegularShape.prototype.getStroke);goog.exportSymbol("ol.style.Stroke",ol.style.Stroke,OPENLAYERS);goog.exportProperty(ol.style.Stroke.prototype,"clone",ol.style.Stroke.prototype.clone);goog.exportProperty(ol.style.Stroke.prototype,"getColor",ol.style.Stroke.prototype.getColor);goog.exportProperty(ol.style.Stroke.prototype,"getLineCap",ol.style.Stroke.prototype.getLineCap);goog.exportProperty(ol.style.Stroke.prototype,"getLineDash",ol.style.Stroke.prototype.getLineDash);goog.exportProperty(ol.style.Stroke.prototype,"getLineDashOffset",ol.style.Stroke.prototype.getLineDashOffset);goog.exportProperty(ol.style.Stroke.prototype,"getLineJoin",ol.style.Stroke.prototype.getLineJoin);goog.exportProperty(ol.style.Stroke.prototype,"getMiterLimit",ol.style.Stroke.prototype.getMiterLimit);goog.exportProperty(ol.style.Stroke.prototype,"getWidth",ol.style.Stroke.prototype.getWidth);goog.exportProperty(ol.style.Stroke.prototype,"setColor",ol.style.Stroke.prototype.setColor);goog.exportProperty(ol.style.Stroke.prototype,"setLineCap",ol.style.Stroke.prototype.setLineCap);goog.exportProperty(ol.style.Stroke.prototype,"setLineDash",ol.style.Stroke.prototype.setLineDash);goog.exportProperty(ol.style.Stroke.prototype,"setLineDashOffset",ol.style.Stroke.prototype.setLineDashOffset);goog.exportProperty(ol.style.Stroke.prototype,"setLineJoin",ol.style.Stroke.prototype.setLineJoin);goog.exportProperty(ol.style.Stroke.prototype,"setMiterLimit",ol.style.Stroke.prototype.setMiterLimit);goog.exportProperty(ol.style.Stroke.prototype,"setWidth",ol.style.Stroke.prototype.setWidth);goog.exportSymbol("ol.style.Style",ol.style.Style,OPENLAYERS);goog.exportProperty(ol.style.Style.prototype,"clone",ol.style.Style.prototype.clone);goog.exportProperty(ol.style.Style.prototype,"getGeometry",ol.style.Style.prototype.getGeometry);goog.exportProperty(ol.style.Style.prototype,"getGeometryFunction",ol.style.Style.prototype.getGeometryFunction);goog.exportProperty(ol.style.Style.prototype,"getFill",ol.style.Style.prototype.getFill);goog.exportProperty(ol.style.Style.prototype,"setFill",ol.style.Style.prototype.setFill);goog.exportProperty(ol.style.Style.prototype,"getImage",ol.style.Style.prototype.getImage);goog.exportProperty(ol.style.Style.prototype,"setImage",ol.style.Style.prototype.setImage);goog.exportProperty(ol.style.Style.prototype,"getStroke",ol.style.Style.prototype.getStroke);goog.exportProperty(ol.style.Style.prototype,"setStroke",ol.style.Style.prototype.setStroke);goog.exportProperty(ol.style.Style.prototype,"getText",ol.style.Style.prototype.getText);goog.exportProperty(ol.style.Style.prototype,"setText",ol.style.Style.prototype.setText);goog.exportProperty(ol.style.Style.prototype,"getZIndex",ol.style.Style.prototype.getZIndex);goog.exportProperty(ol.style.Style.prototype,"setGeometry",ol.style.Style.prototype.setGeometry);goog.exportProperty(ol.style.Style.prototype,"setZIndex",ol.style.Style.prototype.setZIndex);goog.exportSymbol("ol.style.Text",ol.style.Text,OPENLAYERS);goog.exportProperty(ol.style.Text.prototype,"clone",ol.style.Text.prototype.clone);goog.exportProperty(ol.style.Text.prototype,"getFont",ol.style.Text.prototype.getFont);goog.exportProperty(ol.style.Text.prototype,"getOffsetX",ol.style.Text.prototype.getOffsetX);goog.exportProperty(ol.style.Text.prototype,"getOffsetY",ol.style.Text.prototype.getOffsetY);goog.exportProperty(ol.style.Text.prototype,"getFill",ol.style.Text.prototype.getFill);goog.exportProperty(ol.style.Text.prototype,"getRotateWithView",ol.style.Text.prototype.getRotateWithView);goog.exportProperty(ol.style.Text.prototype,"getRotation",ol.style.Text.prototype.getRotation);goog.exportProperty(ol.style.Text.prototype,"getScale",ol.style.Text.prototype.getScale);goog.exportProperty(ol.style.Text.prototype,"getStroke",ol.style.Text.prototype.getStroke);goog.exportProperty(ol.style.Text.prototype,"getText",ol.style.Text.prototype.getText);goog.exportProperty(ol.style.Text.prototype,"getTextAlign",ol.style.Text.prototype.getTextAlign);goog.exportProperty(ol.style.Text.prototype,"getTextBaseline",ol.style.Text.prototype.getTextBaseline);goog.exportProperty(ol.style.Text.prototype,"setFont",ol.style.Text.prototype.setFont);goog.exportProperty(ol.style.Text.prototype,"setOffsetX",ol.style.Text.prototype.setOffsetX);goog.exportProperty(ol.style.Text.prototype,"setOffsetY",ol.style.Text.prototype.setOffsetY);goog.exportProperty(ol.style.Text.prototype,"setFill",ol.style.Text.prototype.setFill);goog.exportProperty(ol.style.Text.prototype,"setRotation",ol.style.Text.prototype.setRotation);goog.exportProperty(ol.style.Text.prototype,"setScale",ol.style.Text.prototype.setScale);goog.exportProperty(ol.style.Text.prototype,"setStroke",ol.style.Text.prototype.setStroke);goog.exportProperty(ol.style.Text.prototype,"setText",ol.style.Text.prototype.setText);goog.exportProperty(ol.style.Text.prototype,"setTextAlign",ol.style.Text.prototype.setTextAlign);goog.exportProperty(ol.style.Text.prototype,"setTextBaseline",ol.style.Text.prototype.setTextBaseline);goog.exportSymbol("ol.source.BingMaps",ol.source.BingMaps,OPENLAYERS);goog.exportSymbol("ol.source.BingMaps.TOS_ATTRIBUTION",ol.source.BingMaps.TOS_ATTRIBUTION,OPENLAYERS);goog.exportProperty(ol.source.BingMaps.prototype,"getApiKey",ol.source.BingMaps.prototype.getApiKey);goog.exportProperty(ol.source.BingMaps.prototype,"getImagerySet",ol.source.BingMaps.prototype.getImagerySet);goog.exportSymbol("ol.source.CartoDB",ol.source.CartoDB,OPENLAYERS);goog.exportProperty(ol.source.CartoDB.prototype,"getConfig",ol.source.CartoDB.prototype.getConfig);goog.exportProperty(ol.source.CartoDB.prototype,"updateConfig",ol.source.CartoDB.prototype.updateConfig);goog.exportProperty(ol.source.CartoDB.prototype,"setConfig",ol.source.CartoDB.prototype.setConfig);goog.exportSymbol("ol.source.Cluster",ol.source.Cluster,OPENLAYERS);goog.exportProperty(ol.source.Cluster.prototype,"getDistance",ol.source.Cluster.prototype.getDistance);goog.exportProperty(ol.source.Cluster.prototype,"getSource",ol.source.Cluster.prototype.getSource);goog.exportProperty(ol.source.Cluster.prototype,"setDistance",ol.source.Cluster.prototype.setDistance);goog.exportSymbol("ol.source.Image",ol.source.Image,OPENLAYERS);goog.exportProperty(ol.source.Image.Event.prototype,"image",ol.source.Image.Event.prototype.image);goog.exportSymbol("ol.source.ImageArcGISRest",ol.source.ImageArcGISRest,OPENLAYERS);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"getParams",ol.source.ImageArcGISRest.prototype.getParams);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"getImageLoadFunction",ol.source.ImageArcGISRest.prototype.getImageLoadFunction);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"getUrl",ol.source.ImageArcGISRest.prototype.getUrl);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"setImageLoadFunction",ol.source.ImageArcGISRest.prototype.setImageLoadFunction);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"setUrl",ol.source.ImageArcGISRest.prototype.setUrl);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"updateParams",ol.source.ImageArcGISRest.prototype.updateParams);goog.exportSymbol("ol.source.ImageCanvas",ol.source.ImageCanvas,OPENLAYERS);goog.exportSymbol("ol.source.ImageMapGuide",ol.source.ImageMapGuide,OPENLAYERS);goog.exportProperty(ol.source.ImageMapGuide.prototype,"getParams",ol.source.ImageMapGuide.prototype.getParams);goog.exportProperty(ol.source.ImageMapGuide.prototype,"getImageLoadFunction",ol.source.ImageMapGuide.prototype.getImageLoadFunction);goog.exportProperty(ol.source.ImageMapGuide.prototype,"updateParams",ol.source.ImageMapGuide.prototype.updateParams);goog.exportProperty(ol.source.ImageMapGuide.prototype,"setImageLoadFunction",ol.source.ImageMapGuide.prototype.setImageLoadFunction);goog.exportSymbol("ol.source.ImageStatic",ol.source.ImageStatic,OPENLAYERS);goog.exportSymbol("ol.source.ImageVector",ol.source.ImageVector,OPENLAYERS);goog.exportProperty(ol.source.ImageVector.prototype,"getSource",ol.source.ImageVector.prototype.getSource);goog.exportProperty(ol.source.ImageVector.prototype,"getStyle",ol.source.ImageVector.prototype.getStyle);goog.exportProperty(ol.source.ImageVector.prototype,"getStyleFunction",ol.source.ImageVector.prototype.getStyleFunction);goog.exportProperty(ol.source.ImageVector.prototype,"setStyle",ol.source.ImageVector.prototype.setStyle);goog.exportSymbol("ol.source.ImageWMS",ol.source.ImageWMS,OPENLAYERS);goog.exportProperty(ol.source.ImageWMS.prototype,"getGetFeatureInfoUrl",ol.source.ImageWMS.prototype.getGetFeatureInfoUrl);goog.exportProperty(ol.source.ImageWMS.prototype,"getParams",ol.source.ImageWMS.prototype.getParams);goog.exportProperty(ol.source.ImageWMS.prototype,"getImageLoadFunction",ol.source.ImageWMS.prototype.getImageLoadFunction);goog.exportProperty(ol.source.ImageWMS.prototype,"getUrl",ol.source.ImageWMS.prototype.getUrl);goog.exportProperty(ol.source.ImageWMS.prototype,"setImageLoadFunction",ol.source.ImageWMS.prototype.setImageLoadFunction);goog.exportProperty(ol.source.ImageWMS.prototype,"setUrl",ol.source.ImageWMS.prototype.setUrl);goog.exportProperty(ol.source.ImageWMS.prototype,"updateParams",ol.source.ImageWMS.prototype.updateParams);goog.exportSymbol("ol.source.OSM",ol.source.OSM,OPENLAYERS);goog.exportSymbol("ol.source.OSM.ATTRIBUTION",ol.source.OSM.ATTRIBUTION,OPENLAYERS);goog.exportSymbol("ol.source.Raster",ol.source.Raster,OPENLAYERS);goog.exportProperty(ol.source.Raster.prototype,"setOperation",ol.source.Raster.prototype.setOperation);goog.exportProperty(ol.source.Raster.Event.prototype,"extent",ol.source.Raster.Event.prototype.extent);goog.exportProperty(ol.source.Raster.Event.prototype,"resolution",ol.source.Raster.Event.prototype.resolution);goog.exportProperty(ol.source.Raster.Event.prototype,"data",ol.source.Raster.Event.prototype.data);goog.exportSymbol("ol.source.Source",ol.source.Source,OPENLAYERS);goog.exportProperty(ol.source.Source.prototype,"getAttributions",ol.source.Source.prototype.getAttributions);goog.exportProperty(ol.source.Source.prototype,"getLogo",ol.source.Source.prototype.getLogo);goog.exportProperty(ol.source.Source.prototype,"getProjection",ol.source.Source.prototype.getProjection);goog.exportProperty(ol.source.Source.prototype,"getState",ol.source.Source.prototype.getState);goog.exportProperty(ol.source.Source.prototype,"refresh",ol.source.Source.prototype.refresh);goog.exportProperty(ol.source.Source.prototype,"setAttributions",ol.source.Source.prototype.setAttributions);goog.exportSymbol("ol.source.Stamen",ol.source.Stamen,OPENLAYERS);goog.exportSymbol("ol.source.Tile",ol.source.Tile,OPENLAYERS);goog.exportProperty(ol.source.Tile.prototype,"getTileGrid",ol.source.Tile.prototype.getTileGrid);goog.exportProperty(ol.source.Tile.Event.prototype,"tile",ol.source.Tile.Event.prototype.tile);goog.exportSymbol("ol.source.TileArcGISRest",ol.source.TileArcGISRest,OPENLAYERS);goog.exportProperty(ol.source.TileArcGISRest.prototype,"getParams",ol.source.TileArcGISRest.prototype.getParams);goog.exportProperty(ol.source.TileArcGISRest.prototype,"updateParams",ol.source.TileArcGISRest.prototype.updateParams);goog.exportSymbol("ol.source.TileDebug",ol.source.TileDebug,OPENLAYERS);goog.exportSymbol("ol.source.TileImage",ol.source.TileImage,OPENLAYERS);goog.exportProperty(ol.source.TileImage.prototype,"setRenderReprojectionEdges",ol.source.TileImage.prototype.setRenderReprojectionEdges);goog.exportProperty(ol.source.TileImage.prototype,"setTileGridForProjection",ol.source.TileImage.prototype.setTileGridForProjection);goog.exportSymbol("ol.source.TileJSON",ol.source.TileJSON,OPENLAYERS);goog.exportProperty(ol.source.TileJSON.prototype,"getTileJSON",ol.source.TileJSON.prototype.getTileJSON);goog.exportSymbol("ol.source.TileUTFGrid",ol.source.TileUTFGrid,OPENLAYERS);goog.exportProperty(ol.source.TileUTFGrid.prototype,"getTemplate",ol.source.TileUTFGrid.prototype.getTemplate);goog.exportProperty(ol.source.TileUTFGrid.prototype,"forDataAtCoordinateAndResolution",ol.source.TileUTFGrid.prototype.forDataAtCoordinateAndResolution);goog.exportSymbol("ol.source.TileWMS",ol.source.TileWMS,OPENLAYERS);goog.exportProperty(ol.source.TileWMS.prototype,"getGetFeatureInfoUrl",ol.source.TileWMS.prototype.getGetFeatureInfoUrl);goog.exportProperty(ol.source.TileWMS.prototype,"getParams",ol.source.TileWMS.prototype.getParams);goog.exportProperty(ol.source.TileWMS.prototype,"updateParams",ol.source.TileWMS.prototype.updateParams);goog.exportProperty(ol.source.UrlTile.prototype,"getTileLoadFunction",ol.source.UrlTile.prototype.getTileLoadFunction);goog.exportProperty(ol.source.UrlTile.prototype,"getTileUrlFunction",ol.source.UrlTile.prototype.getTileUrlFunction);goog.exportProperty(ol.source.UrlTile.prototype,"getUrls",ol.source.UrlTile.prototype.getUrls);goog.exportProperty(ol.source.UrlTile.prototype,"setTileLoadFunction",ol.source.UrlTile.prototype.setTileLoadFunction);goog.exportProperty(ol.source.UrlTile.prototype,"setTileUrlFunction",ol.source.UrlTile.prototype.setTileUrlFunction);goog.exportProperty(ol.source.UrlTile.prototype,"setUrl",ol.source.UrlTile.prototype.setUrl);goog.exportProperty(ol.source.UrlTile.prototype,"setUrls",ol.source.UrlTile.prototype.setUrls);goog.exportSymbol("ol.source.Vector",ol.source.Vector,OPENLAYERS);goog.exportProperty(ol.source.Vector.prototype,"addFeature",ol.source.Vector.prototype.addFeature);goog.exportProperty(ol.source.Vector.prototype,"addFeatures",ol.source.Vector.prototype.addFeatures);goog.exportProperty(ol.source.Vector.prototype,"clear",ol.source.Vector.prototype.clear);goog.exportProperty(ol.source.Vector.prototype,"forEachFeature",ol.source.Vector.prototype.forEachFeature);goog.exportProperty(ol.source.Vector.prototype,"forEachFeatureInExtent",ol.source.Vector.prototype.forEachFeatureInExtent);goog.exportProperty(ol.source.Vector.prototype,"forEachFeatureIntersectingExtent",ol.source.Vector.prototype.forEachFeatureIntersectingExtent);goog.exportProperty(ol.source.Vector.prototype,"getFeaturesCollection",ol.source.Vector.prototype.getFeaturesCollection);goog.exportProperty(ol.source.Vector.prototype,"getFeatures",ol.source.Vector.prototype.getFeatures);goog.exportProperty(ol.source.Vector.prototype,"getFeaturesAtCoordinate",ol.source.Vector.prototype.getFeaturesAtCoordinate);goog.exportProperty(ol.source.Vector.prototype,"getFeaturesInExtent",ol.source.Vector.prototype.getFeaturesInExtent);goog.exportProperty(ol.source.Vector.prototype,"getClosestFeatureToCoordinate",ol.source.Vector.prototype.getClosestFeatureToCoordinate);goog.exportProperty(ol.source.Vector.prototype,"getExtent",ol.source.Vector.prototype.getExtent);goog.exportProperty(ol.source.Vector.prototype,"getFeatureById",ol.source.Vector.prototype.getFeatureById);goog.exportProperty(ol.source.Vector.prototype,"getFormat",ol.source.Vector.prototype.getFormat);goog.exportProperty(ol.source.Vector.prototype,"getUrl",ol.source.Vector.prototype.getUrl);goog.exportProperty(ol.source.Vector.prototype,"removeFeature",ol.source.Vector.prototype.removeFeature);goog.exportProperty(ol.source.Vector.Event.prototype,"feature",ol.source.Vector.Event.prototype.feature);goog.exportSymbol("ol.source.VectorTile",ol.source.VectorTile,OPENLAYERS);goog.exportSymbol("ol.source.WMTS",ol.source.WMTS,OPENLAYERS);goog.exportProperty(ol.source.WMTS.prototype,"getDimensions",ol.source.WMTS.prototype.getDimensions);goog.exportProperty(ol.source.WMTS.prototype,"getFormat",ol.source.WMTS.prototype.getFormat);goog.exportProperty(ol.source.WMTS.prototype,"getLayer",ol.source.WMTS.prototype.getLayer);goog.exportProperty(ol.source.WMTS.prototype,"getMatrixSet",ol.source.WMTS.prototype.getMatrixSet);

goog.exportProperty(ol.source.WMTS.prototype,"getRequestEncoding",ol.source.WMTS.prototype.getRequestEncoding);goog.exportProperty(ol.source.WMTS.prototype,"getStyle",ol.source.WMTS.prototype.getStyle);goog.exportProperty(ol.source.WMTS.prototype,"getVersion",ol.source.WMTS.prototype.getVersion);goog.exportProperty(ol.source.WMTS.prototype,"updateDimensions",ol.source.WMTS.prototype.updateDimensions);goog.exportSymbol("ol.source.WMTS.optionsFromCapabilities",ol.source.WMTS.optionsFromCapabilities,OPENLAYERS);goog.exportSymbol("ol.source.XYZ",ol.source.XYZ,OPENLAYERS);goog.exportSymbol("ol.source.Zoomify",ol.source.Zoomify,OPENLAYERS);goog.exportProperty(ol.render.Event.prototype,"vectorContext",ol.render.Event.prototype.vectorContext);goog.exportProperty(ol.render.Event.prototype,"frameState",ol.render.Event.prototype.frameState);goog.exportProperty(ol.render.Event.prototype,"context",ol.render.Event.prototype.context);goog.exportProperty(ol.render.Event.prototype,"glContext",ol.render.Event.prototype.glContext);goog.exportProperty(ol.render.Feature.prototype,"get",ol.render.Feature.prototype.get);goog.exportProperty(ol.render.Feature.prototype,"getExtent",ol.render.Feature.prototype.getExtent);goog.exportProperty(ol.render.Feature.prototype,"getGeometry",ol.render.Feature.prototype.getGeometry);goog.exportProperty(ol.render.Feature.prototype,"getProperties",ol.render.Feature.prototype.getProperties);goog.exportProperty(ol.render.Feature.prototype,"getType",ol.render.Feature.prototype.getType);goog.exportSymbol("ol.render.VectorContext",ol.render.VectorContext,OPENLAYERS);goog.exportProperty(ol.render.webgl.Immediate.prototype,"setStyle",ol.render.webgl.Immediate.prototype.setStyle);goog.exportProperty(ol.render.webgl.Immediate.prototype,"drawGeometry",ol.render.webgl.Immediate.prototype.drawGeometry);goog.exportProperty(ol.render.webgl.Immediate.prototype,"drawFeature",ol.render.webgl.Immediate.prototype.drawFeature);goog.exportProperty(ol.render.canvas.Immediate.prototype,"drawCircle",ol.render.canvas.Immediate.prototype.drawCircle);goog.exportProperty(ol.render.canvas.Immediate.prototype,"setStyle",ol.render.canvas.Immediate.prototype.setStyle);goog.exportProperty(ol.render.canvas.Immediate.prototype,"drawGeometry",ol.render.canvas.Immediate.prototype.drawGeometry);goog.exportProperty(ol.render.canvas.Immediate.prototype,"drawFeature",ol.render.canvas.Immediate.prototype.drawFeature);goog.exportSymbol("ol.proj.common.add",ol.proj.common.add,OPENLAYERS);goog.exportSymbol("ol.proj.Projection",ol.proj.Projection,OPENLAYERS);goog.exportProperty(ol.proj.Projection.prototype,"getCode",ol.proj.Projection.prototype.getCode);goog.exportProperty(ol.proj.Projection.prototype,"getExtent",ol.proj.Projection.prototype.getExtent);goog.exportProperty(ol.proj.Projection.prototype,"getUnits",ol.proj.Projection.prototype.getUnits);goog.exportProperty(ol.proj.Projection.prototype,"getMetersPerUnit",ol.proj.Projection.prototype.getMetersPerUnit);goog.exportProperty(ol.proj.Projection.prototype,"getWorldExtent",ol.proj.Projection.prototype.getWorldExtent);goog.exportProperty(ol.proj.Projection.prototype,"isGlobal",ol.proj.Projection.prototype.isGlobal);goog.exportProperty(ol.proj.Projection.prototype,"setGlobal",ol.proj.Projection.prototype.setGlobal);goog.exportProperty(ol.proj.Projection.prototype,"setExtent",ol.proj.Projection.prototype.setExtent);goog.exportProperty(ol.proj.Projection.prototype,"setWorldExtent",ol.proj.Projection.prototype.setWorldExtent);goog.exportProperty(ol.proj.Projection.prototype,"setGetPointResolution",ol.proj.Projection.prototype.setGetPointResolution);goog.exportSymbol("ol.proj.Units.METERS_PER_UNIT",ol.proj.Units.METERS_PER_UNIT,OPENLAYERS);goog.exportSymbol("ol.layer.Base",ol.layer.Base,OPENLAYERS);goog.exportProperty(ol.layer.Base.prototype,"getExtent",ol.layer.Base.prototype.getExtent);goog.exportProperty(ol.layer.Base.prototype,"getMaxResolution",ol.layer.Base.prototype.getMaxResolution);goog.exportProperty(ol.layer.Base.prototype,"getMinResolution",ol.layer.Base.prototype.getMinResolution);goog.exportProperty(ol.layer.Base.prototype,"getOpacity",ol.layer.Base.prototype.getOpacity);goog.exportProperty(ol.layer.Base.prototype,"getVisible",ol.layer.Base.prototype.getVisible);goog.exportProperty(ol.layer.Base.prototype,"getZIndex",ol.layer.Base.prototype.getZIndex);goog.exportProperty(ol.layer.Base.prototype,"setExtent",ol.layer.Base.prototype.setExtent);goog.exportProperty(ol.layer.Base.prototype,"setMaxResolution",ol.layer.Base.prototype.setMaxResolution);goog.exportProperty(ol.layer.Base.prototype,"setMinResolution",ol.layer.Base.prototype.setMinResolution);goog.exportProperty(ol.layer.Base.prototype,"setOpacity",ol.layer.Base.prototype.setOpacity);goog.exportProperty(ol.layer.Base.prototype,"setVisible",ol.layer.Base.prototype.setVisible);goog.exportProperty(ol.layer.Base.prototype,"setZIndex",ol.layer.Base.prototype.setZIndex);goog.exportSymbol("ol.layer.Group",ol.layer.Group,OPENLAYERS);goog.exportProperty(ol.layer.Group.prototype,"getLayers",ol.layer.Group.prototype.getLayers);goog.exportProperty(ol.layer.Group.prototype,"setLayers",ol.layer.Group.prototype.setLayers);goog.exportSymbol("ol.layer.Heatmap",ol.layer.Heatmap,OPENLAYERS);goog.exportProperty(ol.layer.Heatmap.prototype,"getBlur",ol.layer.Heatmap.prototype.getBlur);goog.exportProperty(ol.layer.Heatmap.prototype,"getGradient",ol.layer.Heatmap.prototype.getGradient);goog.exportProperty(ol.layer.Heatmap.prototype,"getRadius",ol.layer.Heatmap.prototype.getRadius);goog.exportProperty(ol.layer.Heatmap.prototype,"setBlur",ol.layer.Heatmap.prototype.setBlur);goog.exportProperty(ol.layer.Heatmap.prototype,"setGradient",ol.layer.Heatmap.prototype.setGradient);goog.exportProperty(ol.layer.Heatmap.prototype,"setRadius",ol.layer.Heatmap.prototype.setRadius);goog.exportSymbol("ol.layer.Image",ol.layer.Image,OPENLAYERS);goog.exportProperty(ol.layer.Image.prototype,"getSource",ol.layer.Image.prototype.getSource);goog.exportSymbol("ol.layer.Layer",ol.layer.Layer,OPENLAYERS);goog.exportProperty(ol.layer.Layer.prototype,"getSource",ol.layer.Layer.prototype.getSource);goog.exportProperty(ol.layer.Layer.prototype,"setMap",ol.layer.Layer.prototype.setMap);goog.exportProperty(ol.layer.Layer.prototype,"setSource",ol.layer.Layer.prototype.setSource);goog.exportSymbol("ol.layer.Tile",ol.layer.Tile,OPENLAYERS);goog.exportProperty(ol.layer.Tile.prototype,"getPreload",ol.layer.Tile.prototype.getPreload);goog.exportProperty(ol.layer.Tile.prototype,"getSource",ol.layer.Tile.prototype.getSource);goog.exportProperty(ol.layer.Tile.prototype,"setPreload",ol.layer.Tile.prototype.setPreload);goog.exportProperty(ol.layer.Tile.prototype,"getUseInterimTilesOnError",ol.layer.Tile.prototype.getUseInterimTilesOnError);goog.exportProperty(ol.layer.Tile.prototype,"setUseInterimTilesOnError",ol.layer.Tile.prototype.setUseInterimTilesOnError);goog.exportSymbol("ol.layer.Vector",ol.layer.Vector,OPENLAYERS);goog.exportProperty(ol.layer.Vector.prototype,"getSource",ol.layer.Vector.prototype.getSource);goog.exportProperty(ol.layer.Vector.prototype,"getStyle",ol.layer.Vector.prototype.getStyle);goog.exportProperty(ol.layer.Vector.prototype,"getStyleFunction",ol.layer.Vector.prototype.getStyleFunction);goog.exportProperty(ol.layer.Vector.prototype,"setStyle",ol.layer.Vector.prototype.setStyle);goog.exportSymbol("ol.layer.VectorTile",ol.layer.VectorTile,OPENLAYERS);goog.exportProperty(ol.layer.VectorTile.prototype,"getPreload",ol.layer.VectorTile.prototype.getPreload);goog.exportProperty(ol.layer.VectorTile.prototype,"getUseInterimTilesOnError",ol.layer.VectorTile.prototype.getUseInterimTilesOnError);goog.exportProperty(ol.layer.VectorTile.prototype,"setPreload",ol.layer.VectorTile.prototype.setPreload);goog.exportProperty(ol.layer.VectorTile.prototype,"setUseInterimTilesOnError",ol.layer.VectorTile.prototype.setUseInterimTilesOnError);goog.exportSymbol("ol.interaction.DoubleClickZoom",ol.interaction.DoubleClickZoom,OPENLAYERS);goog.exportSymbol("ol.interaction.DoubleClickZoom.handleEvent",ol.interaction.DoubleClickZoom.handleEvent,OPENLAYERS);goog.exportSymbol("ol.interaction.DragAndDrop",ol.interaction.DragAndDrop,OPENLAYERS);goog.exportSymbol("ol.interaction.DragAndDrop.handleEvent",ol.interaction.DragAndDrop.handleEvent,OPENLAYERS);goog.exportProperty(ol.interaction.DragAndDrop.Event.prototype,"features",ol.interaction.DragAndDrop.Event.prototype.features);goog.exportProperty(ol.interaction.DragAndDrop.Event.prototype,"file",ol.interaction.DragAndDrop.Event.prototype.file);goog.exportProperty(ol.interaction.DragAndDrop.Event.prototype,"projection",ol.interaction.DragAndDrop.Event.prototype.projection);goog.exportSymbol("ol.interaction.DragBox",ol.interaction.DragBox,OPENLAYERS);goog.exportProperty(ol.interaction.DragBox.prototype,"getGeometry",ol.interaction.DragBox.prototype.getGeometry);goog.exportProperty(ol.interaction.DragBox.Event.prototype,"coordinate",ol.interaction.DragBox.Event.prototype.coordinate);goog.exportProperty(ol.interaction.DragBox.Event.prototype,"mapBrowserEvent",ol.interaction.DragBox.Event.prototype.mapBrowserEvent);goog.exportSymbol("ol.interaction.DragPan",ol.interaction.DragPan,OPENLAYERS);goog.exportSymbol("ol.interaction.DragRotate",ol.interaction.DragRotate,OPENLAYERS);goog.exportSymbol("ol.interaction.DragRotateAndZoom",ol.interaction.DragRotateAndZoom,OPENLAYERS);goog.exportSymbol("ol.interaction.DragZoom",ol.interaction.DragZoom,OPENLAYERS);goog.exportSymbol("ol.interaction.Draw",ol.interaction.Draw,OPENLAYERS);goog.exportSymbol("ol.interaction.Draw.handleEvent",ol.interaction.Draw.handleEvent,OPENLAYERS);goog.exportProperty(ol.interaction.Draw.prototype,"removeLastPoint",ol.interaction.Draw.prototype.removeLastPoint);goog.exportProperty(ol.interaction.Draw.prototype,"finishDrawing",ol.interaction.Draw.prototype.finishDrawing);goog.exportProperty(ol.interaction.Draw.prototype,"extend",ol.interaction.Draw.prototype.extend);goog.exportSymbol("ol.interaction.Draw.createRegularPolygon",ol.interaction.Draw.createRegularPolygon,OPENLAYERS);goog.exportSymbol("ol.interaction.Draw.createBox",ol.interaction.Draw.createBox,OPENLAYERS);goog.exportProperty(ol.interaction.Draw.Event.prototype,"feature",ol.interaction.Draw.Event.prototype.feature);goog.exportSymbol("ol.interaction.Extent",ol.interaction.Extent,OPENLAYERS);goog.exportProperty(ol.interaction.Extent.prototype,"getExtent",ol.interaction.Extent.prototype.getExtent);goog.exportProperty(ol.interaction.Extent.prototype,"setExtent",ol.interaction.Extent.prototype.setExtent);goog.exportProperty(ol.interaction.Extent.Event.prototype,"extent_",ol.interaction.Extent.Event.prototype.extent_);goog.exportSymbol("ol.interaction.Interaction",ol.interaction.Interaction,OPENLAYERS);goog.exportProperty(ol.interaction.Interaction.prototype,"getActive",ol.interaction.Interaction.prototype.getActive);goog.exportProperty(ol.interaction.Interaction.prototype,"getMap",ol.interaction.Interaction.prototype.getMap);goog.exportProperty(ol.interaction.Interaction.prototype,"setActive",ol.interaction.Interaction.prototype.setActive);goog.exportSymbol("ol.interaction.KeyboardPan",ol.interaction.KeyboardPan,OPENLAYERS);goog.exportSymbol("ol.interaction.KeyboardPan.handleEvent",ol.interaction.KeyboardPan.handleEvent,OPENLAYERS);goog.exportSymbol("ol.interaction.KeyboardZoom",ol.interaction.KeyboardZoom,OPENLAYERS);goog.exportSymbol("ol.interaction.KeyboardZoom.handleEvent",ol.interaction.KeyboardZoom.handleEvent,OPENLAYERS);goog.exportSymbol("ol.interaction.Modify",ol.interaction.Modify,OPENLAYERS);goog.exportSymbol("ol.interaction.Modify.handleEvent",ol.interaction.Modify.handleEvent,OPENLAYERS);goog.exportProperty(ol.interaction.Modify.prototype,"removePoint",ol.interaction.Modify.prototype.removePoint);goog.exportProperty(ol.interaction.Modify.Event.prototype,"features",ol.interaction.Modify.Event.prototype.features);goog.exportProperty(ol.interaction.Modify.Event.prototype,"mapBrowserEvent",ol.interaction.Modify.Event.prototype.mapBrowserEvent);goog.exportSymbol("ol.interaction.MouseWheelZoom",ol.interaction.MouseWheelZoom,OPENLAYERS);goog.exportSymbol("ol.interaction.MouseWheelZoom.handleEvent",ol.interaction.MouseWheelZoom.handleEvent,OPENLAYERS);goog.exportProperty(ol.interaction.MouseWheelZoom.prototype,"setMouseAnchor",ol.interaction.MouseWheelZoom.prototype.setMouseAnchor);goog.exportSymbol("ol.interaction.PinchRotate",ol.interaction.PinchRotate,OPENLAYERS);goog.exportSymbol("ol.interaction.PinchZoom",ol.interaction.PinchZoom,OPENLAYERS);goog.exportSymbol("ol.interaction.Pointer",ol.interaction.Pointer,OPENLAYERS);goog.exportSymbol("ol.interaction.Pointer.handleEvent",ol.interaction.Pointer.handleEvent,OPENLAYERS);goog.exportSymbol("ol.interaction.Select",ol.interaction.Select,OPENLAYERS);goog.exportProperty(ol.interaction.Select.prototype,"getFeatures",ol.interaction.Select.prototype.getFeatures);goog.exportProperty(ol.interaction.Select.prototype,"getHitTolerance",ol.interaction.Select.prototype.getHitTolerance);goog.exportProperty(ol.interaction.Select.prototype,"getLayer",ol.interaction.Select.prototype.getLayer);goog.exportSymbol("ol.interaction.Select.handleEvent",ol.interaction.Select.handleEvent,OPENLAYERS);goog.exportProperty(ol.interaction.Select.prototype,"setHitTolerance",ol.interaction.Select.prototype.setHitTolerance);goog.exportProperty(ol.interaction.Select.prototype,"setMap",ol.interaction.Select.prototype.setMap);goog.exportProperty(ol.interaction.Select.Event.prototype,"selected",ol.interaction.Select.Event.prototype.selected);goog.exportProperty(ol.interaction.Select.Event.prototype,"deselected",ol.interaction.Select.Event.prototype.deselected);goog.exportProperty(ol.interaction.Select.Event.prototype,"mapBrowserEvent",ol.interaction.Select.Event.prototype.mapBrowserEvent);goog.exportSymbol("ol.interaction.Snap",ol.interaction.Snap,OPENLAYERS);goog.exportProperty(ol.interaction.Snap.prototype,"addFeature",ol.interaction.Snap.prototype.addFeature);goog.exportProperty(ol.interaction.Snap.prototype,"removeFeature",ol.interaction.Snap.prototype.removeFeature);goog.exportSymbol("ol.interaction.Translate",ol.interaction.Translate,OPENLAYERS);goog.exportProperty(ol.interaction.Translate.prototype,"getHitTolerance",ol.interaction.Translate.prototype.getHitTolerance);goog.exportProperty(ol.interaction.Translate.prototype,"setHitTolerance",ol.interaction.Translate.prototype.setHitTolerance);goog.exportProperty(ol.interaction.Translate.Event.prototype,"features",ol.interaction.Translate.Event.prototype.features);goog.exportProperty(ol.interaction.Translate.Event.prototype,"coordinate",ol.interaction.Translate.Event.prototype.coordinate);goog.exportSymbol("ol.geom.Circle",ol.geom.Circle,OPENLAYERS);goog.exportProperty(ol.geom.Circle.prototype,"clone",ol.geom.Circle.prototype.clone);goog.exportProperty(ol.geom.Circle.prototype,"getCenter",ol.geom.Circle.prototype.getCenter);goog.exportProperty(ol.geom.Circle.prototype,"getRadius",ol.geom.Circle.prototype.getRadius);goog.exportProperty(ol.geom.Circle.prototype,"getType",ol.geom.Circle.prototype.getType);goog.exportProperty(ol.geom.Circle.prototype,"intersectsExtent",ol.geom.Circle.prototype.intersectsExtent);goog.exportProperty(ol.geom.Circle.prototype,"setCenter",ol.geom.Circle.prototype.setCenter);goog.exportProperty(ol.geom.Circle.prototype,"setCenterAndRadius",ol.geom.Circle.prototype.setCenterAndRadius);goog.exportProperty(ol.geom.Circle.prototype,"setRadius",ol.geom.Circle.prototype.setRadius);goog.exportProperty(ol.geom.Circle.prototype,"transform",ol.geom.Circle.prototype.transform);goog.exportSymbol("ol.geom.Geometry",ol.geom.Geometry,OPENLAYERS);goog.exportProperty(ol.geom.Geometry.prototype,"getClosestPoint",ol.geom.Geometry.prototype.getClosestPoint);goog.exportProperty(ol.geom.Geometry.prototype,"intersectsCoordinate",ol.geom.Geometry.prototype.intersectsCoordinate);goog.exportProperty(ol.geom.Geometry.prototype,"getExtent",ol.geom.Geometry.prototype.getExtent);goog.exportProperty(ol.geom.Geometry.prototype,"rotate",ol.geom.Geometry.prototype.rotate);goog.exportProperty(ol.geom.Geometry.prototype,"scale",ol.geom.Geometry.prototype.scale);goog.exportProperty(ol.geom.Geometry.prototype,"simplify",ol.geom.Geometry.prototype.simplify);goog.exportProperty(ol.geom.Geometry.prototype,"transform",ol.geom.Geometry.prototype.transform);goog.exportSymbol("ol.geom.GeometryCollection",ol.geom.GeometryCollection,OPENLAYERS);goog.exportProperty(ol.geom.GeometryCollection.prototype,"clone",ol.geom.GeometryCollection.prototype.clone);goog.exportProperty(ol.geom.GeometryCollection.prototype,"getGeometries",ol.geom.GeometryCollection.prototype.getGeometries);goog.exportProperty(ol.geom.GeometryCollection.prototype,"getType",ol.geom.GeometryCollection.prototype.getType);goog.exportProperty(ol.geom.GeometryCollection.prototype,"intersectsExtent",ol.geom.GeometryCollection.prototype.intersectsExtent);goog.exportProperty(ol.geom.GeometryCollection.prototype,"setGeometries",ol.geom.GeometryCollection.prototype.setGeometries);goog.exportProperty(ol.geom.GeometryCollection.prototype,"applyTransform",ol.geom.GeometryCollection.prototype.applyTransform);goog.exportProperty(ol.geom.GeometryCollection.prototype,"translate",ol.geom.GeometryCollection.prototype.translate);goog.exportSymbol("ol.geom.LinearRing",ol.geom.LinearRing,OPENLAYERS);goog.exportProperty(ol.geom.LinearRing.prototype,"clone",ol.geom.LinearRing.prototype.clone);goog.exportProperty(ol.geom.LinearRing.prototype,"getArea",ol.geom.LinearRing.prototype.getArea);goog.exportProperty(ol.geom.LinearRing.prototype,"getCoordinates",ol.geom.LinearRing.prototype.getCoordinates);goog.exportProperty(ol.geom.LinearRing.prototype,"getType",ol.geom.LinearRing.prototype.getType);goog.exportProperty(ol.geom.LinearRing.prototype,"setCoordinates",ol.geom.LinearRing.prototype.setCoordinates);goog.exportSymbol("ol.geom.LineString",ol.geom.LineString,OPENLAYERS);goog.exportProperty(ol.geom.LineString.prototype,"appendCoordinate",ol.geom.LineString.prototype.appendCoordinate);goog.exportProperty(ol.geom.LineString.prototype,"clone",ol.geom.LineString.prototype.clone);goog.exportProperty(ol.geom.LineString.prototype,"forEachSegment",ol.geom.LineString.prototype.forEachSegment);goog.exportProperty(ol.geom.LineString.prototype,"getCoordinateAtM",ol.geom.LineString.prototype.getCoordinateAtM);goog.exportProperty(ol.geom.LineString.prototype,"getCoordinates",ol.geom.LineString.prototype.getCoordinates);goog.exportProperty(ol.geom.LineString.prototype,"getCoordinateAt",ol.geom.LineString.prototype.getCoordinateAt);goog.exportProperty(ol.geom.LineString.prototype,"getLength",ol.geom.LineString.prototype.getLength);goog.exportProperty(ol.geom.LineString.prototype,"getType",ol.geom.LineString.prototype.getType);goog.exportProperty(ol.geom.LineString.prototype,"intersectsExtent",ol.geom.LineString.prototype.intersectsExtent);goog.exportProperty(ol.geom.LineString.prototype,"setCoordinates",ol.geom.LineString.prototype.setCoordinates);goog.exportSymbol("ol.geom.MultiLineString",ol.geom.MultiLineString,OPENLAYERS);goog.exportProperty(ol.geom.MultiLineString.prototype,"appendLineString",ol.geom.MultiLineString.prototype.appendLineString);goog.exportProperty(ol.geom.MultiLineString.prototype,"clone",ol.geom.MultiLineString.prototype.clone);goog.exportProperty(ol.geom.MultiLineString.prototype,"getCoordinateAtM",ol.geom.MultiLineString.prototype.getCoordinateAtM);goog.exportProperty(ol.geom.MultiLineString.prototype,"getCoordinates",ol.geom.MultiLineString.prototype.getCoordinates);goog.exportProperty(ol.geom.MultiLineString.prototype,"getLineString",ol.geom.MultiLineString.prototype.getLineString);goog.exportProperty(ol.geom.MultiLineString.prototype,"getLineStrings",ol.geom.MultiLineString.prototype.getLineStrings);goog.exportProperty(ol.geom.MultiLineString.prototype,"getType",ol.geom.MultiLineString.prototype.getType);goog.exportProperty(ol.geom.MultiLineString.prototype,"intersectsExtent",ol.geom.MultiLineString.prototype.intersectsExtent);goog.exportProperty(ol.geom.MultiLineString.prototype,"setCoordinates",ol.geom.MultiLineString.prototype.setCoordinates);goog.exportSymbol("ol.geom.MultiPoint",ol.geom.MultiPoint,OPENLAYERS);goog.exportProperty(ol.geom.MultiPoint.prototype,"appendPoint",ol.geom.MultiPoint.prototype.appendPoint);goog.exportProperty(ol.geom.MultiPoint.prototype,"clone",ol.geom.MultiPoint.prototype.clone);goog.exportProperty(ol.geom.MultiPoint.prototype,"getCoordinates",ol.geom.MultiPoint.prototype.getCoordinates);goog.exportProperty(ol.geom.MultiPoint.prototype,"getPoint",ol.geom.MultiPoint.prototype.getPoint);goog.exportProperty(ol.geom.MultiPoint.prototype,"getPoints",ol.geom.MultiPoint.prototype.getPoints);goog.exportProperty(ol.geom.MultiPoint.prototype,"getType",ol.geom.MultiPoint.prototype.getType);goog.exportProperty(ol.geom.MultiPoint.prototype,"intersectsExtent",ol.geom.MultiPoint.prototype.intersectsExtent);goog.exportProperty(ol.geom.MultiPoint.prototype,"setCoordinates",ol.geom.MultiPoint.prototype.setCoordinates);goog.exportSymbol("ol.geom.MultiPolygon",ol.geom.MultiPolygon,OPENLAYERS);goog.exportProperty(ol.geom.MultiPolygon.prototype,"appendPolygon",ol.geom.MultiPolygon.prototype.appendPolygon);goog.exportProperty(ol.geom.MultiPolygon.prototype,"clone",ol.geom.MultiPolygon.prototype.clone);goog.exportProperty(ol.geom.MultiPolygon.prototype,"getArea",ol.geom.MultiPolygon.prototype.getArea);goog.exportProperty(ol.geom.MultiPolygon.prototype,"getCoordinates",ol.geom.MultiPolygon.prototype.getCoordinates);goog.exportProperty(ol.geom.MultiPolygon.prototype,"getInteriorPoints",ol.geom.MultiPolygon.prototype.getInteriorPoints);goog.exportProperty(ol.geom.MultiPolygon.prototype,"getPolygon",ol.geom.MultiPolygon.prototype.getPolygon);goog.exportProperty(ol.geom.MultiPolygon.prototype,"getPolygons",ol.geom.MultiPolygon.prototype.getPolygons);goog.exportProperty(ol.geom.MultiPolygon.prototype,"getType",ol.geom.MultiPolygon.prototype.getType);goog.exportProperty(ol.geom.MultiPolygon.prototype,"intersectsExtent",ol.geom.MultiPolygon.prototype.intersectsExtent);goog.exportProperty(ol.geom.MultiPolygon.prototype,"setCoordinates",ol.geom.MultiPolygon.prototype.setCoordinates);goog.exportSymbol("ol.geom.Point",ol.geom.Point,OPENLAYERS);goog.exportProperty(ol.geom.Point.prototype,"clone",ol.geom.Point.prototype.clone);goog.exportProperty(ol.geom.Point.prototype,"getCoordinates",ol.geom.Point.prototype.getCoordinates);goog.exportProperty(ol.geom.Point.prototype,"getType",ol.geom.Point.prototype.getType);goog.exportProperty(ol.geom.Point.prototype,"intersectsExtent",ol.geom.Point.prototype.intersectsExtent);goog.exportProperty(ol.geom.Point.prototype,"setCoordinates",ol.geom.Point.prototype.setCoordinates);goog.exportSymbol("ol.geom.Polygon",ol.geom.Polygon,OPENLAYERS);goog.exportProperty(ol.geom.Polygon.prototype,"appendLinearRing",ol.geom.Polygon.prototype.appendLinearRing);goog.exportProperty(ol.geom.Polygon.prototype,"clone",ol.geom.Polygon.prototype.clone);goog.exportProperty(ol.geom.Polygon.prototype,"getArea",ol.geom.Polygon.prototype.getArea);goog.exportProperty(ol.geom.Polygon.prototype,"getCoordinates",ol.geom.Polygon.prototype.getCoordinates);goog.exportProperty(ol.geom.Polygon.prototype,"getInteriorPoint",ol.geom.Polygon.prototype.getInteriorPoint);goog.exportProperty(ol.geom.Polygon.prototype,"getLinearRingCount",ol.geom.Polygon.prototype.getLinearRingCount);goog.exportProperty(ol.geom.Polygon.prototype,"getLinearRing",ol.geom.Polygon.prototype.getLinearRing);goog.exportProperty(ol.geom.Polygon.prototype,"getLinearRings",ol.geom.Polygon.prototype.getLinearRings);goog.exportProperty(ol.geom.Polygon.prototype,"getType",ol.geom.Polygon.prototype.getType);goog.exportProperty(ol.geom.Polygon.prototype,"intersectsExtent",ol.geom.Polygon.prototype.intersectsExtent);goog.exportProperty(ol.geom.Polygon.prototype,"setCoordinates",ol.geom.Polygon.prototype.setCoordinates);goog.exportSymbol("ol.geom.Polygon.circular",ol.geom.Polygon.circular,OPENLAYERS);goog.exportSymbol("ol.geom.Polygon.fromExtent",ol.geom.Polygon.fromExtent,OPENLAYERS);goog.exportSymbol("ol.geom.Polygon.fromCircle",ol.geom.Polygon.fromCircle,OPENLAYERS);goog.exportSymbol("ol.geom.SimpleGeometry",ol.geom.SimpleGeometry,OPENLAYERS);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"getFirstCoordinate",ol.geom.SimpleGeometry.prototype.getFirstCoordinate);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"getLastCoordinate",ol.geom.SimpleGeometry.prototype.getLastCoordinate);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"getLayout",ol.geom.SimpleGeometry.prototype.getLayout);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"applyTransform",ol.geom.SimpleGeometry.prototype.applyTransform);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"translate",ol.geom.SimpleGeometry.prototype.translate);goog.exportSymbol("ol.format.EsriJSON",ol.format.EsriJSON,OPENLAYERS);goog.exportProperty(ol.format.EsriJSON.prototype,"readFeature",ol.format.EsriJSON.prototype.readFeature);goog.exportProperty(ol.format.EsriJSON.prototype,"readFeatures",ol.format.EsriJSON.prototype.readFeatures);goog.exportProperty(ol.format.EsriJSON.prototype,"readGeometry",ol.format.EsriJSON.prototype.readGeometry);goog.exportProperty(ol.format.EsriJSON.prototype,"readProjection",ol.format.EsriJSON.prototype.readProjection);goog.exportProperty(ol.format.EsriJSON.prototype,"writeGeometry",ol.format.EsriJSON.prototype.writeGeometry);goog.exportProperty(ol.format.EsriJSON.prototype,"writeGeometryObject",ol.format.EsriJSON.prototype.writeGeometryObject);goog.exportProperty(ol.format.EsriJSON.prototype,"writeFeature",ol.format.EsriJSON.prototype.writeFeature);goog.exportProperty(ol.format.EsriJSON.prototype,"writeFeatureObject",ol.format.EsriJSON.prototype.writeFeatureObject);goog.exportProperty(ol.format.EsriJSON.prototype,"writeFeatures",ol.format.EsriJSON.prototype.writeFeatures);goog.exportProperty(ol.format.EsriJSON.prototype,"writeFeaturesObject",ol.format.EsriJSON.prototype.writeFeaturesObject);goog.exportSymbol("ol.format.Feature",ol.format.Feature,OPENLAYERS);goog.exportSymbol("ol.format.filter.and",ol.format.filter.and,OPENLAYERS);goog.exportSymbol("ol.format.filter.or",ol.format.filter.or,OPENLAYERS);goog.exportSymbol("ol.format.filter.not",ol.format.filter.not,OPENLAYERS);goog.exportSymbol("ol.format.filter.bbox",ol.format.filter.bbox,OPENLAYERS);goog.exportSymbol("ol.format.filter.intersects",ol.format.filter.intersects,OPENLAYERS);goog.exportSymbol("ol.format.filter.within",ol.format.filter.within,OPENLAYERS);goog.exportSymbol("ol.format.filter.equalTo",ol.format.filter.equalTo,OPENLAYERS);goog.exportSymbol("ol.format.filter.notEqualTo",ol.format.filter.notEqualTo,OPENLAYERS);goog.exportSymbol("ol.format.filter.lessThan",ol.format.filter.lessThan,OPENLAYERS);goog.exportSymbol("ol.format.filter.lessThanOrEqualTo",ol.format.filter.lessThanOrEqualTo,OPENLAYERS);goog.exportSymbol("ol.format.filter.greaterThan",ol.format.filter.greaterThan,OPENLAYERS);goog.exportSymbol("ol.format.filter.greaterThanOrEqualTo",ol.format.filter.greaterThanOrEqualTo,OPENLAYERS);goog.exportSymbol("ol.format.filter.isNull",ol.format.filter.isNull,OPENLAYERS);goog.exportSymbol("ol.format.filter.between",ol.format.filter.between,OPENLAYERS);goog.exportSymbol("ol.format.filter.like",ol.format.filter.like,OPENLAYERS);goog.exportSymbol("ol.format.GeoJSON",ol.format.GeoJSON,OPENLAYERS);goog.exportProperty(ol.format.GeoJSON.prototype,"readFeature",ol.format.GeoJSON.prototype.readFeature);goog.exportProperty(ol.format.GeoJSON.prototype,"readFeatures",ol.format.GeoJSON.prototype.readFeatures);goog.exportProperty(ol.format.GeoJSON.prototype,"readGeometry",ol.format.GeoJSON.prototype.readGeometry);goog.exportProperty(ol.format.GeoJSON.prototype,"readProjection",ol.format.GeoJSON.prototype.readProjection);goog.exportProperty(ol.format.GeoJSON.prototype,"writeFeature",ol.format.GeoJSON.prototype.writeFeature);goog.exportProperty(ol.format.GeoJSON.prototype,"writeFeatureObject",ol.format.GeoJSON.prototype.writeFeatureObject);goog.exportProperty(ol.format.GeoJSON.prototype,"writeFeatures",ol.format.GeoJSON.prototype.writeFeatures);goog.exportProperty(ol.format.GeoJSON.prototype,"writeFeaturesObject",ol.format.GeoJSON.prototype.writeFeaturesObject);goog.exportProperty(ol.format.GeoJSON.prototype,"writeGeometry",ol.format.GeoJSON.prototype.writeGeometry);goog.exportProperty(ol.format.GeoJSON.prototype,"writeGeometryObject",ol.format.GeoJSON.prototype.writeGeometryObject);goog.exportSymbol("ol.format.GML",ol.format.GML,OPENLAYERS);goog.exportProperty(ol.format.GML.prototype,"writeFeatures",ol.format.GML.prototype.writeFeatures);goog.exportProperty(ol.format.GML.prototype,"writeFeaturesNode",ol.format.GML.prototype.writeFeaturesNode);goog.exportSymbol("ol.format.GML2",ol.format.GML2,OPENLAYERS);goog.exportSymbol("ol.format.GML3",ol.format.GML3,OPENLAYERS);goog.exportProperty(ol.format.GML3.prototype,"writeGeometryNode",ol.format.GML3.prototype.writeGeometryNode);goog.exportProperty(ol.format.GML3.prototype,"writeFeatures",ol.format.GML3.prototype.writeFeatures);goog.exportProperty(ol.format.GML3.prototype,"writeFeaturesNode",ol.format.GML3.prototype.writeFeaturesNode);goog.exportProperty(ol.format.GMLBase.prototype,"readFeatures",ol.format.GMLBase.prototype.readFeatures);goog.exportSymbol("ol.format.GPX",ol.format.GPX,OPENLAYERS);goog.exportProperty(ol.format.GPX.prototype,"readFeature",ol.format.GPX.prototype.readFeature);goog.exportProperty(ol.format.GPX.prototype,"readFeatures",ol.format.GPX.prototype.readFeatures);goog.exportProperty(ol.format.GPX.prototype,"readProjection",ol.format.GPX.prototype.readProjection);goog.exportProperty(ol.format.GPX.prototype,"writeFeatures",ol.format.GPX.prototype.writeFeatures);goog.exportProperty(ol.format.GPX.prototype,"writeFeaturesNode",ol.format.GPX.prototype.writeFeaturesNode);goog.exportSymbol("ol.format.IGC",ol.format.IGC,OPENLAYERS);goog.exportProperty(ol.format.IGC.prototype,"readFeature",ol.format.IGC.prototype.readFeature);goog.exportProperty(ol.format.IGC.prototype,"readFeatures",ol.format.IGC.prototype.readFeatures);goog.exportProperty(ol.format.IGC.prototype,"readProjection",ol.format.IGC.prototype.readProjection);goog.exportSymbol("ol.format.KML",ol.format.KML,OPENLAYERS);goog.exportProperty(ol.format.KML.prototype,"readFeature",ol.format.KML.prototype.readFeature);goog.exportProperty(ol.format.KML.prototype,"readFeatures",ol.format.KML.prototype.readFeatures);goog.exportProperty(ol.format.KML.prototype,"readName",ol.format.KML.prototype.readName);goog.exportProperty(ol.format.KML.prototype,"readNetworkLinks",ol.format.KML.prototype.readNetworkLinks);goog.exportProperty(ol.format.KML.prototype,"readRegion",ol.format.KML.prototype.readRegion);goog.exportProperty(ol.format.KML.prototype,"readRegionFromNode",ol.format.KML.prototype.readRegionFromNode);goog.exportProperty(ol.format.KML.prototype,"readProjection",ol.format.KML.prototype.readProjection);goog.exportProperty(ol.format.KML.prototype,"writeFeatures",ol.format.KML.prototype.writeFeatures);goog.exportProperty(ol.format.KML.prototype,"writeFeaturesNode",ol.format.KML.prototype.writeFeaturesNode);goog.exportSymbol("ol.format.MVT",ol.format.MVT,OPENLAYERS);goog.exportProperty(ol.format.MVT.prototype,"readFeatures",ol.format.MVT.prototype.readFeatures);goog.exportProperty(ol.format.MVT.prototype,"readProjection",ol.format.MVT.prototype.readProjection);goog.exportProperty(ol.format.MVT.prototype,"setLayers",ol.format.MVT.prototype.setLayers);goog.exportSymbol("ol.format.OSMXML",ol.format.OSMXML,OPENLAYERS);goog.exportProperty(ol.format.OSMXML.prototype,"readFeatures",ol.format.OSMXML.prototype.readFeatures);goog.exportProperty(ol.format.OSMXML.prototype,"readProjection",ol.format.OSMXML.prototype.readProjection);goog.exportSymbol("ol.format.Polyline",ol.format.Polyline,OPENLAYERS);goog.exportSymbol("ol.format.Polyline.encodeDeltas",ol.format.Polyline.encodeDeltas,OPENLAYERS);

goog.exportSymbol("ol.format.Polyline.decodeDeltas",ol.format.Polyline.decodeDeltas,OPENLAYERS);goog.exportSymbol("ol.format.Polyline.encodeFloats",ol.format.Polyline.encodeFloats,OPENLAYERS);goog.exportSymbol("ol.format.Polyline.decodeFloats",ol.format.Polyline.decodeFloats,OPENLAYERS);goog.exportProperty(ol.format.Polyline.prototype,"readFeature",ol.format.Polyline.prototype.readFeature);goog.exportProperty(ol.format.Polyline.prototype,"readFeatures",ol.format.Polyline.prototype.readFeatures);goog.exportProperty(ol.format.Polyline.prototype,"readGeometry",ol.format.Polyline.prototype.readGeometry);goog.exportProperty(ol.format.Polyline.prototype,"readProjection",ol.format.Polyline.prototype.readProjection);goog.exportProperty(ol.format.Polyline.prototype,"writeGeometry",ol.format.Polyline.prototype.writeGeometry);goog.exportSymbol("ol.format.TopoJSON",ol.format.TopoJSON,OPENLAYERS);goog.exportProperty(ol.format.TopoJSON.prototype,"readFeatures",ol.format.TopoJSON.prototype.readFeatures);goog.exportProperty(ol.format.TopoJSON.prototype,"readProjection",ol.format.TopoJSON.prototype.readProjection);goog.exportSymbol("ol.format.WFS",ol.format.WFS,OPENLAYERS);goog.exportProperty(ol.format.WFS.prototype,"readFeatures",ol.format.WFS.prototype.readFeatures);goog.exportProperty(ol.format.WFS.prototype,"readTransactionResponse",ol.format.WFS.prototype.readTransactionResponse);goog.exportProperty(ol.format.WFS.prototype,"readFeatureCollectionMetadata",ol.format.WFS.prototype.readFeatureCollectionMetadata);goog.exportSymbol("ol.format.WFS.writeFilter",ol.format.WFS.writeFilter,OPENLAYERS);goog.exportProperty(ol.format.WFS.prototype,"writeGetFeature",ol.format.WFS.prototype.writeGetFeature);goog.exportProperty(ol.format.WFS.prototype,"writeTransaction",ol.format.WFS.prototype.writeTransaction);goog.exportProperty(ol.format.WFS.prototype,"readProjection",ol.format.WFS.prototype.readProjection);goog.exportSymbol("ol.format.WKT",ol.format.WKT,OPENLAYERS);goog.exportProperty(ol.format.WKT.prototype,"readFeature",ol.format.WKT.prototype.readFeature);goog.exportProperty(ol.format.WKT.prototype,"readFeatures",ol.format.WKT.prototype.readFeatures);goog.exportProperty(ol.format.WKT.prototype,"readGeometry",ol.format.WKT.prototype.readGeometry);goog.exportProperty(ol.format.WKT.prototype,"writeFeature",ol.format.WKT.prototype.writeFeature);goog.exportProperty(ol.format.WKT.prototype,"writeFeatures",ol.format.WKT.prototype.writeFeatures);goog.exportProperty(ol.format.WKT.prototype,"writeGeometry",ol.format.WKT.prototype.writeGeometry);goog.exportSymbol("ol.format.WMSCapabilities",ol.format.WMSCapabilities,OPENLAYERS);goog.exportProperty(ol.format.WMSCapabilities.prototype,"read",ol.format.WMSCapabilities.prototype.read);goog.exportSymbol("ol.format.WMSGetFeatureInfo",ol.format.WMSGetFeatureInfo,OPENLAYERS);goog.exportProperty(ol.format.WMSGetFeatureInfo.prototype,"readFeatures",ol.format.WMSGetFeatureInfo.prototype.readFeatures);goog.exportSymbol("ol.format.WMTSCapabilities",ol.format.WMTSCapabilities,OPENLAYERS);goog.exportProperty(ol.format.WMTSCapabilities.prototype,"read",ol.format.WMTSCapabilities.prototype.read);goog.exportSymbol("ol.format.filter.And",ol.format.filter.And,OPENLAYERS);goog.exportSymbol("ol.format.filter.Bbox",ol.format.filter.Bbox,OPENLAYERS);goog.exportSymbol("ol.format.filter.Comparison",ol.format.filter.Comparison,OPENLAYERS);goog.exportSymbol("ol.format.filter.ComparisonBinary",ol.format.filter.ComparisonBinary,OPENLAYERS);goog.exportSymbol("ol.format.filter.EqualTo",ol.format.filter.EqualTo,OPENLAYERS);goog.exportSymbol("ol.format.filter.Filter",ol.format.filter.Filter,OPENLAYERS);goog.exportSymbol("ol.format.filter.GreaterThan",ol.format.filter.GreaterThan,OPENLAYERS);goog.exportSymbol("ol.format.filter.GreaterThanOrEqualTo",ol.format.filter.GreaterThanOrEqualTo,OPENLAYERS);goog.exportSymbol("ol.format.filter.Intersects",ol.format.filter.Intersects,OPENLAYERS);goog.exportSymbol("ol.format.filter.IsBetween",ol.format.filter.IsBetween,OPENLAYERS);goog.exportSymbol("ol.format.filter.IsLike",ol.format.filter.IsLike,OPENLAYERS);goog.exportSymbol("ol.format.filter.IsNull",ol.format.filter.IsNull,OPENLAYERS);goog.exportSymbol("ol.format.filter.LessThan",ol.format.filter.LessThan,OPENLAYERS);goog.exportSymbol("ol.format.filter.LessThanOrEqualTo",ol.format.filter.LessThanOrEqualTo,OPENLAYERS);goog.exportSymbol("ol.format.filter.Not",ol.format.filter.Not,OPENLAYERS);goog.exportSymbol("ol.format.filter.NotEqualTo",ol.format.filter.NotEqualTo,OPENLAYERS);goog.exportSymbol("ol.format.filter.Or",ol.format.filter.Or,OPENLAYERS);goog.exportSymbol("ol.format.filter.Spatial",ol.format.filter.Spatial,OPENLAYERS);goog.exportSymbol("ol.format.filter.Within",ol.format.filter.Within,OPENLAYERS);goog.exportSymbol("ol.events.condition.altKeyOnly",ol.events.condition.altKeyOnly,OPENLAYERS);goog.exportSymbol("ol.events.condition.altShiftKeysOnly",ol.events.condition.altShiftKeysOnly,OPENLAYERS);goog.exportSymbol("ol.events.condition.always",ol.events.condition.always,OPENLAYERS);goog.exportSymbol("ol.events.condition.click",ol.events.condition.click,OPENLAYERS);goog.exportSymbol("ol.events.condition.never",ol.events.condition.never,OPENLAYERS);goog.exportSymbol("ol.events.condition.pointerMove",ol.events.condition.pointerMove,OPENLAYERS);goog.exportSymbol("ol.events.condition.singleClick",ol.events.condition.singleClick,OPENLAYERS);goog.exportSymbol("ol.events.condition.doubleClick",ol.events.condition.doubleClick,OPENLAYERS);goog.exportSymbol("ol.events.condition.noModifierKeys",ol.events.condition.noModifierKeys,OPENLAYERS);goog.exportSymbol("ol.events.condition.platformModifierKeyOnly",ol.events.condition.platformModifierKeyOnly,OPENLAYERS);goog.exportSymbol("ol.events.condition.shiftKeyOnly",ol.events.condition.shiftKeyOnly,OPENLAYERS);goog.exportSymbol("ol.events.condition.targetNotEditable",ol.events.condition.targetNotEditable,OPENLAYERS);goog.exportSymbol("ol.events.condition.mouseOnly",ol.events.condition.mouseOnly,OPENLAYERS);goog.exportSymbol("ol.events.condition.primaryAction",ol.events.condition.primaryAction,OPENLAYERS);goog.exportProperty(ol.events.Event.prototype,"type",ol.events.Event.prototype.type);goog.exportProperty(ol.events.Event.prototype,"target",ol.events.Event.prototype.target);goog.exportProperty(ol.events.Event.prototype,"preventDefault",ol.events.Event.prototype.preventDefault);goog.exportProperty(ol.events.Event.prototype,"stopPropagation",ol.events.Event.prototype.stopPropagation);goog.exportSymbol("ol.control.Attribution",ol.control.Attribution,OPENLAYERS);goog.exportSymbol("ol.control.Attribution.render",ol.control.Attribution.render,OPENLAYERS);goog.exportProperty(ol.control.Attribution.prototype,"getCollapsible",ol.control.Attribution.prototype.getCollapsible);goog.exportProperty(ol.control.Attribution.prototype,"setCollapsible",ol.control.Attribution.prototype.setCollapsible);goog.exportProperty(ol.control.Attribution.prototype,"setCollapsed",ol.control.Attribution.prototype.setCollapsed);goog.exportProperty(ol.control.Attribution.prototype,"getCollapsed",ol.control.Attribution.prototype.getCollapsed);goog.exportSymbol("ol.control.Control",ol.control.Control,OPENLAYERS);goog.exportProperty(ol.control.Control.prototype,"getMap",ol.control.Control.prototype.getMap);goog.exportProperty(ol.control.Control.prototype,"setMap",ol.control.Control.prototype.setMap);goog.exportProperty(ol.control.Control.prototype,"setTarget",ol.control.Control.prototype.setTarget);goog.exportSymbol("ol.control.FullScreen",ol.control.FullScreen,OPENLAYERS);goog.exportSymbol("ol.control.MousePosition",ol.control.MousePosition,OPENLAYERS);goog.exportSymbol("ol.control.MousePosition.render",ol.control.MousePosition.render,OPENLAYERS);goog.exportProperty(ol.control.MousePosition.prototype,"getCoordinateFormat",ol.control.MousePosition.prototype.getCoordinateFormat);goog.exportProperty(ol.control.MousePosition.prototype,"getProjection",ol.control.MousePosition.prototype.getProjection);goog.exportProperty(ol.control.MousePosition.prototype,"setCoordinateFormat",ol.control.MousePosition.prototype.setCoordinateFormat);goog.exportProperty(ol.control.MousePosition.prototype,"setProjection",ol.control.MousePosition.prototype.setProjection);goog.exportSymbol("ol.control.OverviewMap",ol.control.OverviewMap,OPENLAYERS);goog.exportSymbol("ol.control.OverviewMap.render",ol.control.OverviewMap.render,OPENLAYERS);goog.exportProperty(ol.control.OverviewMap.prototype,"getCollapsible",ol.control.OverviewMap.prototype.getCollapsible);goog.exportProperty(ol.control.OverviewMap.prototype,"setCollapsible",ol.control.OverviewMap.prototype.setCollapsible);goog.exportProperty(ol.control.OverviewMap.prototype,"setCollapsed",ol.control.OverviewMap.prototype.setCollapsed);goog.exportProperty(ol.control.OverviewMap.prototype,"getCollapsed",ol.control.OverviewMap.prototype.getCollapsed);goog.exportProperty(ol.control.OverviewMap.prototype,"getOverviewMap",ol.control.OverviewMap.prototype.getOverviewMap);goog.exportSymbol("ol.control.Rotate",ol.control.Rotate,OPENLAYERS);goog.exportSymbol("ol.control.Rotate.render",ol.control.Rotate.render,OPENLAYERS);goog.exportSymbol("ol.control.ScaleLine",ol.control.ScaleLine,OPENLAYERS);goog.exportProperty(ol.control.ScaleLine.prototype,"getUnits",ol.control.ScaleLine.prototype.getUnits);goog.exportSymbol("ol.control.ScaleLine.render",ol.control.ScaleLine.render,OPENLAYERS);goog.exportProperty(ol.control.ScaleLine.prototype,"setUnits",ol.control.ScaleLine.prototype.setUnits);goog.exportSymbol("ol.control.Zoom",ol.control.Zoom,OPENLAYERS);goog.exportSymbol("ol.control.ZoomSlider",ol.control.ZoomSlider,OPENLAYERS);goog.exportSymbol("ol.control.ZoomSlider.render",ol.control.ZoomSlider.render,OPENLAYERS);goog.exportSymbol("ol.control.ZoomToExtent",ol.control.ZoomToExtent,OPENLAYERS);goog.exportProperty(ol.Object.prototype,"changed",ol.Object.prototype.changed);goog.exportProperty(ol.Object.prototype,"dispatchEvent",ol.Object.prototype.dispatchEvent);goog.exportProperty(ol.Object.prototype,"getRevision",ol.Object.prototype.getRevision);goog.exportProperty(ol.Object.prototype,"on",ol.Object.prototype.on);goog.exportProperty(ol.Object.prototype,"once",ol.Object.prototype.once);goog.exportProperty(ol.Object.prototype,"un",ol.Object.prototype.un);goog.exportProperty(ol.Collection.prototype,"get",ol.Collection.prototype.get);goog.exportProperty(ol.Collection.prototype,"getKeys",ol.Collection.prototype.getKeys);goog.exportProperty(ol.Collection.prototype,"getProperties",ol.Collection.prototype.getProperties);goog.exportProperty(ol.Collection.prototype,"set",ol.Collection.prototype.set);goog.exportProperty(ol.Collection.prototype,"setProperties",ol.Collection.prototype.setProperties);goog.exportProperty(ol.Collection.prototype,"unset",ol.Collection.prototype.unset);goog.exportProperty(ol.Collection.prototype,"changed",ol.Collection.prototype.changed);goog.exportProperty(ol.Collection.prototype,"dispatchEvent",ol.Collection.prototype.dispatchEvent);goog.exportProperty(ol.Collection.prototype,"getRevision",ol.Collection.prototype.getRevision);goog.exportProperty(ol.Collection.prototype,"on",ol.Collection.prototype.on);goog.exportProperty(ol.Collection.prototype,"once",ol.Collection.prototype.once);goog.exportProperty(ol.Collection.prototype,"un",ol.Collection.prototype.un);goog.exportProperty(ol.Collection.Event.prototype,"type",ol.Collection.Event.prototype.type);goog.exportProperty(ol.Collection.Event.prototype,"target",ol.Collection.Event.prototype.target);goog.exportProperty(ol.Collection.Event.prototype,"preventDefault",ol.Collection.Event.prototype.preventDefault);goog.exportProperty(ol.Collection.Event.prototype,"stopPropagation",ol.Collection.Event.prototype.stopPropagation);goog.exportProperty(ol.DeviceOrientation.prototype,"get",ol.DeviceOrientation.prototype.get);goog.exportProperty(ol.DeviceOrientation.prototype,"getKeys",ol.DeviceOrientation.prototype.getKeys);goog.exportProperty(ol.DeviceOrientation.prototype,"getProperties",ol.DeviceOrientation.prototype.getProperties);goog.exportProperty(ol.DeviceOrientation.prototype,"set",ol.DeviceOrientation.prototype.set);goog.exportProperty(ol.DeviceOrientation.prototype,"setProperties",ol.DeviceOrientation.prototype.setProperties);goog.exportProperty(ol.DeviceOrientation.prototype,"unset",ol.DeviceOrientation.prototype.unset);goog.exportProperty(ol.DeviceOrientation.prototype,"changed",ol.DeviceOrientation.prototype.changed);goog.exportProperty(ol.DeviceOrientation.prototype,"dispatchEvent",ol.DeviceOrientation.prototype.dispatchEvent);goog.exportProperty(ol.DeviceOrientation.prototype,"getRevision",ol.DeviceOrientation.prototype.getRevision);goog.exportProperty(ol.DeviceOrientation.prototype,"on",ol.DeviceOrientation.prototype.on);goog.exportProperty(ol.DeviceOrientation.prototype,"once",ol.DeviceOrientation.prototype.once);goog.exportProperty(ol.DeviceOrientation.prototype,"un",ol.DeviceOrientation.prototype.un);goog.exportProperty(ol.Feature.prototype,"get",ol.Feature.prototype.get);goog.exportProperty(ol.Feature.prototype,"getKeys",ol.Feature.prototype.getKeys);goog.exportProperty(ol.Feature.prototype,"getProperties",ol.Feature.prototype.getProperties);goog.exportProperty(ol.Feature.prototype,"set",ol.Feature.prototype.set);goog.exportProperty(ol.Feature.prototype,"setProperties",ol.Feature.prototype.setProperties);goog.exportProperty(ol.Feature.prototype,"unset",ol.Feature.prototype.unset);goog.exportProperty(ol.Feature.prototype,"changed",ol.Feature.prototype.changed);goog.exportProperty(ol.Feature.prototype,"dispatchEvent",ol.Feature.prototype.dispatchEvent);goog.exportProperty(ol.Feature.prototype,"getRevision",ol.Feature.prototype.getRevision);goog.exportProperty(ol.Feature.prototype,"on",ol.Feature.prototype.on);goog.exportProperty(ol.Feature.prototype,"once",ol.Feature.prototype.once);goog.exportProperty(ol.Feature.prototype,"un",ol.Feature.prototype.un);goog.exportProperty(ol.Geolocation.prototype,"get",ol.Geolocation.prototype.get);goog.exportProperty(ol.Geolocation.prototype,"getKeys",ol.Geolocation.prototype.getKeys);goog.exportProperty(ol.Geolocation.prototype,"getProperties",ol.Geolocation.prototype.getProperties);goog.exportProperty(ol.Geolocation.prototype,"set",ol.Geolocation.prototype.set);goog.exportProperty(ol.Geolocation.prototype,"setProperties",ol.Geolocation.prototype.setProperties);goog.exportProperty(ol.Geolocation.prototype,"unset",ol.Geolocation.prototype.unset);goog.exportProperty(ol.Geolocation.prototype,"changed",ol.Geolocation.prototype.changed);goog.exportProperty(ol.Geolocation.prototype,"dispatchEvent",ol.Geolocation.prototype.dispatchEvent);goog.exportProperty(ol.Geolocation.prototype,"getRevision",ol.Geolocation.prototype.getRevision);goog.exportProperty(ol.Geolocation.prototype,"on",ol.Geolocation.prototype.on);goog.exportProperty(ol.Geolocation.prototype,"once",ol.Geolocation.prototype.once);goog.exportProperty(ol.Geolocation.prototype,"un",ol.Geolocation.prototype.un);goog.exportProperty(ol.ImageTile.prototype,"getTileCoord",ol.ImageTile.prototype.getTileCoord);goog.exportProperty(ol.ImageTile.prototype,"load",ol.ImageTile.prototype.load);goog.exportProperty(ol.Map.prototype,"get",ol.Map.prototype.get);goog.exportProperty(ol.Map.prototype,"getKeys",ol.Map.prototype.getKeys);goog.exportProperty(ol.Map.prototype,"getProperties",ol.Map.prototype.getProperties);goog.exportProperty(ol.Map.prototype,"set",ol.Map.prototype.set);goog.exportProperty(ol.Map.prototype,"setProperties",ol.Map.prototype.setProperties);goog.exportProperty(ol.Map.prototype,"unset",ol.Map.prototype.unset);goog.exportProperty(ol.Map.prototype,"changed",ol.Map.prototype.changed);goog.exportProperty(ol.Map.prototype,"dispatchEvent",ol.Map.prototype.dispatchEvent);goog.exportProperty(ol.Map.prototype,"getRevision",ol.Map.prototype.getRevision);goog.exportProperty(ol.Map.prototype,"on",ol.Map.prototype.on);goog.exportProperty(ol.Map.prototype,"once",ol.Map.prototype.once);goog.exportProperty(ol.Map.prototype,"un",ol.Map.prototype.un);goog.exportProperty(ol.MapEvent.prototype,"type",ol.MapEvent.prototype.type);goog.exportProperty(ol.MapEvent.prototype,"target",ol.MapEvent.prototype.target);goog.exportProperty(ol.MapEvent.prototype,"preventDefault",ol.MapEvent.prototype.preventDefault);goog.exportProperty(ol.MapEvent.prototype,"stopPropagation",ol.MapEvent.prototype.stopPropagation);goog.exportProperty(ol.MapBrowserEvent.prototype,"map",ol.MapBrowserEvent.prototype.map);goog.exportProperty(ol.MapBrowserEvent.prototype,"frameState",ol.MapBrowserEvent.prototype.frameState);goog.exportProperty(ol.MapBrowserEvent.prototype,"type",ol.MapBrowserEvent.prototype.type);goog.exportProperty(ol.MapBrowserEvent.prototype,"target",ol.MapBrowserEvent.prototype.target);goog.exportProperty(ol.MapBrowserEvent.prototype,"preventDefault",ol.MapBrowserEvent.prototype.preventDefault);goog.exportProperty(ol.MapBrowserEvent.prototype,"stopPropagation",ol.MapBrowserEvent.prototype.stopPropagation);goog.exportProperty(ol.MapBrowserPointerEvent.prototype,"originalEvent",ol.MapBrowserPointerEvent.prototype.originalEvent);goog.exportProperty(ol.MapBrowserPointerEvent.prototype,"pixel",ol.MapBrowserPointerEvent.prototype.pixel);goog.exportProperty(ol.MapBrowserPointerEvent.prototype,"coordinate",ol.MapBrowserPointerEvent.prototype.coordinate);goog.exportProperty(ol.MapBrowserPointerEvent.prototype,"dragging",ol.MapBrowserPointerEvent.prototype.dragging);goog.exportProperty(ol.MapBrowserPointerEvent.prototype,"preventDefault",ol.MapBrowserPointerEvent.prototype.preventDefault);goog.exportProperty(ol.MapBrowserPointerEvent.prototype,"stopPropagation",ol.MapBrowserPointerEvent.prototype.stopPropagation);goog.exportProperty(ol.MapBrowserPointerEvent.prototype,"map",ol.MapBrowserPointerEvent.prototype.map);goog.exportProperty(ol.MapBrowserPointerEvent.prototype,"frameState",ol.MapBrowserPointerEvent.prototype.frameState);goog.exportProperty(ol.MapBrowserPointerEvent.prototype,"type",ol.MapBrowserPointerEvent.prototype.type);goog.exportProperty(ol.MapBrowserPointerEvent.prototype,"target",ol.MapBrowserPointerEvent.prototype.target);goog.exportProperty(ol.Object.Event.prototype,"type",ol.Object.Event.prototype.type);goog.exportProperty(ol.Object.Event.prototype,"target",ol.Object.Event.prototype.target);goog.exportProperty(ol.Object.Event.prototype,"preventDefault",ol.Object.Event.prototype.preventDefault);goog.exportProperty(ol.Object.Event.prototype,"stopPropagation",ol.Object.Event.prototype.stopPropagation);goog.exportProperty(ol.Overlay.prototype,"get",ol.Overlay.prototype.get);goog.exportProperty(ol.Overlay.prototype,"getKeys",ol.Overlay.prototype.getKeys);goog.exportProperty(ol.Overlay.prototype,"getProperties",ol.Overlay.prototype.getProperties);goog.exportProperty(ol.Overlay.prototype,"set",ol.Overlay.prototype.set);goog.exportProperty(ol.Overlay.prototype,"setProperties",ol.Overlay.prototype.setProperties);goog.exportProperty(ol.Overlay.prototype,"unset",ol.Overlay.prototype.unset);goog.exportProperty(ol.Overlay.prototype,"changed",ol.Overlay.prototype.changed);goog.exportProperty(ol.Overlay.prototype,"dispatchEvent",ol.Overlay.prototype.dispatchEvent);goog.exportProperty(ol.Overlay.prototype,"getRevision",ol.Overlay.prototype.getRevision);goog.exportProperty(ol.Overlay.prototype,"on",ol.Overlay.prototype.on);goog.exportProperty(ol.Overlay.prototype,"once",ol.Overlay.prototype.once);goog.exportProperty(ol.Overlay.prototype,"un",ol.Overlay.prototype.un);goog.exportProperty(ol.VectorTile.prototype,"getTileCoord",ol.VectorTile.prototype.getTileCoord);goog.exportProperty(ol.VectorTile.prototype,"load",ol.VectorTile.prototype.load);goog.exportProperty(ol.View.prototype,"get",ol.View.prototype.get);goog.exportProperty(ol.View.prototype,"getKeys",ol.View.prototype.getKeys);goog.exportProperty(ol.View.prototype,"getProperties",ol.View.prototype.getProperties);goog.exportProperty(ol.View.prototype,"set",ol.View.prototype.set);goog.exportProperty(ol.View.prototype,"setProperties",ol.View.prototype.setProperties);goog.exportProperty(ol.View.prototype,"unset",ol.View.prototype.unset);goog.exportProperty(ol.View.prototype,"changed",ol.View.prototype.changed);goog.exportProperty(ol.View.prototype,"dispatchEvent",ol.View.prototype.dispatchEvent);goog.exportProperty(ol.View.prototype,"getRevision",ol.View.prototype.getRevision);goog.exportProperty(ol.View.prototype,"on",ol.View.prototype.on);goog.exportProperty(ol.View.prototype,"once",ol.View.prototype.once);goog.exportProperty(ol.View.prototype,"un",ol.View.prototype.un);goog.exportProperty(ol.tilegrid.WMTS.prototype,"forEachTileCoord",ol.tilegrid.WMTS.prototype.forEachTileCoord);goog.exportProperty(ol.tilegrid.WMTS.prototype,"getMaxZoom",ol.tilegrid.WMTS.prototype.getMaxZoom);goog.exportProperty(ol.tilegrid.WMTS.prototype,"getMinZoom",ol.tilegrid.WMTS.prototype.getMinZoom);goog.exportProperty(ol.tilegrid.WMTS.prototype,"getOrigin",ol.tilegrid.WMTS.prototype.getOrigin);goog.exportProperty(ol.tilegrid.WMTS.prototype,"getResolution",ol.tilegrid.WMTS.prototype.getResolution);goog.exportProperty(ol.tilegrid.WMTS.prototype,"getResolutions",ol.tilegrid.WMTS.prototype.getResolutions);goog.exportProperty(ol.tilegrid.WMTS.prototype,"getTileCoordExtent",ol.tilegrid.WMTS.prototype.getTileCoordExtent);goog.exportProperty(ol.tilegrid.WMTS.prototype,"getTileCoordForCoordAndResolution",ol.tilegrid.WMTS.prototype.getTileCoordForCoordAndResolution);goog.exportProperty(ol.tilegrid.WMTS.prototype,"getTileCoordForCoordAndZ",ol.tilegrid.WMTS.prototype.getTileCoordForCoordAndZ);goog.exportProperty(ol.tilegrid.WMTS.prototype,"getTileSize",ol.tilegrid.WMTS.prototype.getTileSize);goog.exportProperty(ol.tilegrid.WMTS.prototype,"getZForResolution",ol.tilegrid.WMTS.prototype.getZForResolution);goog.exportProperty(ol.style.RegularShape.prototype,"getOpacity",ol.style.RegularShape.prototype.getOpacity);goog.exportProperty(ol.style.RegularShape.prototype,"getRotateWithView",ol.style.RegularShape.prototype.getRotateWithView);goog.exportProperty(ol.style.RegularShape.prototype,"getRotation",ol.style.RegularShape.prototype.getRotation);goog.exportProperty(ol.style.RegularShape.prototype,"getScale",ol.style.RegularShape.prototype.getScale);goog.exportProperty(ol.style.RegularShape.prototype,"getSnapToPixel",ol.style.RegularShape.prototype.getSnapToPixel);goog.exportProperty(ol.style.RegularShape.prototype,"setOpacity",ol.style.RegularShape.prototype.setOpacity);goog.exportProperty(ol.style.RegularShape.prototype,"setRotation",ol.style.RegularShape.prototype.setRotation);goog.exportProperty(ol.style.RegularShape.prototype,"setScale",ol.style.RegularShape.prototype.setScale);goog.exportProperty(ol.style.Circle.prototype,"clone",ol.style.Circle.prototype.clone);goog.exportProperty(ol.style.Circle.prototype,"getAngle",ol.style.Circle.prototype.getAngle);goog.exportProperty(ol.style.Circle.prototype,"getFill",ol.style.Circle.prototype.getFill);goog.exportProperty(ol.style.Circle.prototype,"getPoints",ol.style.Circle.prototype.getPoints);goog.exportProperty(ol.style.Circle.prototype,"getRadius",ol.style.Circle.prototype.getRadius);goog.exportProperty(ol.style.Circle.prototype,"getRadius2",ol.style.Circle.prototype.getRadius2);goog.exportProperty(ol.style.Circle.prototype,"getStroke",ol.style.Circle.prototype.getStroke);goog.exportProperty(ol.style.Circle.prototype,"getOpacity",ol.style.Circle.prototype.getOpacity);goog.exportProperty(ol.style.Circle.prototype,"getRotateWithView",ol.style.Circle.prototype.getRotateWithView);goog.exportProperty(ol.style.Circle.prototype,"getRotation",ol.style.Circle.prototype.getRotation);goog.exportProperty(ol.style.Circle.prototype,"getScale",ol.style.Circle.prototype.getScale);goog.exportProperty(ol.style.Circle.prototype,"getSnapToPixel",ol.style.Circle.prototype.getSnapToPixel);goog.exportProperty(ol.style.Circle.prototype,"setOpacity",ol.style.Circle.prototype.setOpacity);goog.exportProperty(ol.style.Circle.prototype,"setRotation",ol.style.Circle.prototype.setRotation);goog.exportProperty(ol.style.Circle.prototype,"setScale",ol.style.Circle.prototype.setScale);goog.exportProperty(ol.style.Icon.prototype,"getOpacity",ol.style.Icon.prototype.getOpacity);goog.exportProperty(ol.style.Icon.prototype,"getRotateWithView",ol.style.Icon.prototype.getRotateWithView);goog.exportProperty(ol.style.Icon.prototype,"getRotation",ol.style.Icon.prototype.getRotation);goog.exportProperty(ol.style.Icon.prototype,"getScale",ol.style.Icon.prototype.getScale);goog.exportProperty(ol.style.Icon.prototype,"getSnapToPixel",ol.style.Icon.prototype.getSnapToPixel);goog.exportProperty(ol.style.Icon.prototype,"setOpacity",ol.style.Icon.prototype.setOpacity);goog.exportProperty(ol.style.Icon.prototype,"setRotation",ol.style.Icon.prototype.setRotation);goog.exportProperty(ol.style.Icon.prototype,"setScale",ol.style.Icon.prototype.setScale);goog.exportProperty(ol.source.Source.prototype,"get",ol.source.Source.prototype.get);goog.exportProperty(ol.source.Source.prototype,"getKeys",ol.source.Source.prototype.getKeys);goog.exportProperty(ol.source.Source.prototype,"getProperties",ol.source.Source.prototype.getProperties);goog.exportProperty(ol.source.Source.prototype,"set",ol.source.Source.prototype.set);goog.exportProperty(ol.source.Source.prototype,"setProperties",ol.source.Source.prototype.setProperties);goog.exportProperty(ol.source.Source.prototype,"unset",ol.source.Source.prototype.unset);goog.exportProperty(ol.source.Source.prototype,"changed",ol.source.Source.prototype.changed);goog.exportProperty(ol.source.Source.prototype,"dispatchEvent",ol.source.Source.prototype.dispatchEvent);goog.exportProperty(ol.source.Source.prototype,"getRevision",ol.source.Source.prototype.getRevision);goog.exportProperty(ol.source.Source.prototype,"on",ol.source.Source.prototype.on);goog.exportProperty(ol.source.Source.prototype,"once",ol.source.Source.prototype.once);goog.exportProperty(ol.source.Source.prototype,"un",ol.source.Source.prototype.un);goog.exportProperty(ol.source.Tile.prototype,"getAttributions",ol.source.Tile.prototype.getAttributions);goog.exportProperty(ol.source.Tile.prototype,"getLogo",ol.source.Tile.prototype.getLogo);goog.exportProperty(ol.source.Tile.prototype,"getProjection",ol.source.Tile.prototype.getProjection);goog.exportProperty(ol.source.Tile.prototype,"getState",ol.source.Tile.prototype.getState);goog.exportProperty(ol.source.Tile.prototype,"refresh",ol.source.Tile.prototype.refresh);goog.exportProperty(ol.source.Tile.prototype,"setAttributions",ol.source.Tile.prototype.setAttributions);goog.exportProperty(ol.source.Tile.prototype,"get",ol.source.Tile.prototype.get);goog.exportProperty(ol.source.Tile.prototype,"getKeys",ol.source.Tile.prototype.getKeys);goog.exportProperty(ol.source.Tile.prototype,"getProperties",ol.source.Tile.prototype.getProperties);goog.exportProperty(ol.source.Tile.prototype,"set",ol.source.Tile.prototype.set);goog.exportProperty(ol.source.Tile.prototype,"setProperties",ol.source.Tile.prototype.setProperties);goog.exportProperty(ol.source.Tile.prototype,"unset",ol.source.Tile.prototype.unset);goog.exportProperty(ol.source.Tile.prototype,"changed",ol.source.Tile.prototype.changed);goog.exportProperty(ol.source.Tile.prototype,"dispatchEvent",ol.source.Tile.prototype.dispatchEvent);goog.exportProperty(ol.source.Tile.prototype,"getRevision",ol.source.Tile.prototype.getRevision);goog.exportProperty(ol.source.Tile.prototype,"on",ol.source.Tile.prototype.on);goog.exportProperty(ol.source.Tile.prototype,"once",ol.source.Tile.prototype.once);goog.exportProperty(ol.source.Tile.prototype,"un",ol.source.Tile.prototype.un);goog.exportProperty(ol.source.UrlTile.prototype,"getTileGrid",ol.source.UrlTile.prototype.getTileGrid);goog.exportProperty(ol.source.UrlTile.prototype,"refresh",ol.source.UrlTile.prototype.refresh);goog.exportProperty(ol.source.UrlTile.prototype,"getAttributions",ol.source.UrlTile.prototype.getAttributions);goog.exportProperty(ol.source.UrlTile.prototype,"getLogo",ol.source.UrlTile.prototype.getLogo);goog.exportProperty(ol.source.UrlTile.prototype,"getProjection",ol.source.UrlTile.prototype.getProjection);goog.exportProperty(ol.source.UrlTile.prototype,"getState",ol.source.UrlTile.prototype.getState);goog.exportProperty(ol.source.UrlTile.prototype,"setAttributions",ol.source.UrlTile.prototype.setAttributions);goog.exportProperty(ol.source.UrlTile.prototype,"get",ol.source.UrlTile.prototype.get);goog.exportProperty(ol.source.UrlTile.prototype,"getKeys",ol.source.UrlTile.prototype.getKeys);goog.exportProperty(ol.source.UrlTile.prototype,"getProperties",ol.source.UrlTile.prototype.getProperties);goog.exportProperty(ol.source.UrlTile.prototype,"set",ol.source.UrlTile.prototype.set);goog.exportProperty(ol.source.UrlTile.prototype,"setProperties",ol.source.UrlTile.prototype.setProperties);goog.exportProperty(ol.source.UrlTile.prototype,"unset",ol.source.UrlTile.prototype.unset);goog.exportProperty(ol.source.UrlTile.prototype,"changed",ol.source.UrlTile.prototype.changed);goog.exportProperty(ol.source.UrlTile.prototype,"dispatchEvent",ol.source.UrlTile.prototype.dispatchEvent);goog.exportProperty(ol.source.UrlTile.prototype,"getRevision",ol.source.UrlTile.prototype.getRevision);goog.exportProperty(ol.source.UrlTile.prototype,"on",ol.source.UrlTile.prototype.on);goog.exportProperty(ol.source.UrlTile.prototype,"once",ol.source.UrlTile.prototype.once);goog.exportProperty(ol.source.UrlTile.prototype,"un",ol.source.UrlTile.prototype.un);goog.exportProperty(ol.source.TileImage.prototype,"getTileLoadFunction",ol.source.TileImage.prototype.getTileLoadFunction);goog.exportProperty(ol.source.TileImage.prototype,"getTileUrlFunction",ol.source.TileImage.prototype.getTileUrlFunction);goog.exportProperty(ol.source.TileImage.prototype,"getUrls",ol.source.TileImage.prototype.getUrls);goog.exportProperty(ol.source.TileImage.prototype,"setTileLoadFunction",ol.source.TileImage.prototype.setTileLoadFunction);goog.exportProperty(ol.source.TileImage.prototype,"setTileUrlFunction",ol.source.TileImage.prototype.setTileUrlFunction);goog.exportProperty(ol.source.TileImage.prototype,"setUrl",ol.source.TileImage.prototype.setUrl);goog.exportProperty(ol.source.TileImage.prototype,"setUrls",ol.source.TileImage.prototype.setUrls);goog.exportProperty(ol.source.TileImage.prototype,"getTileGrid",ol.source.TileImage.prototype.getTileGrid);goog.exportProperty(ol.source.TileImage.prototype,"refresh",ol.source.TileImage.prototype.refresh);goog.exportProperty(ol.source.TileImage.prototype,"getAttributions",ol.source.TileImage.prototype.getAttributions);goog.exportProperty(ol.source.TileImage.prototype,"getLogo",ol.source.TileImage.prototype.getLogo);goog.exportProperty(ol.source.TileImage.prototype,"getProjection",ol.source.TileImage.prototype.getProjection);goog.exportProperty(ol.source.TileImage.prototype,"getState",ol.source.TileImage.prototype.getState);goog.exportProperty(ol.source.TileImage.prototype,"setAttributions",ol.source.TileImage.prototype.setAttributions);goog.exportProperty(ol.source.TileImage.prototype,"get",ol.source.TileImage.prototype.get);goog.exportProperty(ol.source.TileImage.prototype,"getKeys",ol.source.TileImage.prototype.getKeys);goog.exportProperty(ol.source.TileImage.prototype,"getProperties",ol.source.TileImage.prototype.getProperties);goog.exportProperty(ol.source.TileImage.prototype,"set",ol.source.TileImage.prototype.set);goog.exportProperty(ol.source.TileImage.prototype,"setProperties",ol.source.TileImage.prototype.setProperties);goog.exportProperty(ol.source.TileImage.prototype,"unset",ol.source.TileImage.prototype.unset);goog.exportProperty(ol.source.TileImage.prototype,"changed",ol.source.TileImage.prototype.changed);goog.exportProperty(ol.source.TileImage.prototype,"dispatchEvent",ol.source.TileImage.prototype.dispatchEvent);goog.exportProperty(ol.source.TileImage.prototype,"getRevision",ol.source.TileImage.prototype.getRevision);goog.exportProperty(ol.source.TileImage.prototype,"on",ol.source.TileImage.prototype.on);

goog.exportProperty(ol.source.TileImage.prototype,"once",ol.source.TileImage.prototype.once);goog.exportProperty(ol.source.TileImage.prototype,"un",ol.source.TileImage.prototype.un);goog.exportProperty(ol.source.BingMaps.prototype,"setRenderReprojectionEdges",ol.source.BingMaps.prototype.setRenderReprojectionEdges);goog.exportProperty(ol.source.BingMaps.prototype,"setTileGridForProjection",ol.source.BingMaps.prototype.setTileGridForProjection);goog.exportProperty(ol.source.BingMaps.prototype,"getTileLoadFunction",ol.source.BingMaps.prototype.getTileLoadFunction);goog.exportProperty(ol.source.BingMaps.prototype,"getTileUrlFunction",ol.source.BingMaps.prototype.getTileUrlFunction);goog.exportProperty(ol.source.BingMaps.prototype,"getUrls",ol.source.BingMaps.prototype.getUrls);goog.exportProperty(ol.source.BingMaps.prototype,"setTileLoadFunction",ol.source.BingMaps.prototype.setTileLoadFunction);goog.exportProperty(ol.source.BingMaps.prototype,"setTileUrlFunction",ol.source.BingMaps.prototype.setTileUrlFunction);goog.exportProperty(ol.source.BingMaps.prototype,"setUrl",ol.source.BingMaps.prototype.setUrl);goog.exportProperty(ol.source.BingMaps.prototype,"setUrls",ol.source.BingMaps.prototype.setUrls);goog.exportProperty(ol.source.BingMaps.prototype,"getTileGrid",ol.source.BingMaps.prototype.getTileGrid);goog.exportProperty(ol.source.BingMaps.prototype,"refresh",ol.source.BingMaps.prototype.refresh);goog.exportProperty(ol.source.BingMaps.prototype,"getAttributions",ol.source.BingMaps.prototype.getAttributions);goog.exportProperty(ol.source.BingMaps.prototype,"getLogo",ol.source.BingMaps.prototype.getLogo);goog.exportProperty(ol.source.BingMaps.prototype,"getProjection",ol.source.BingMaps.prototype.getProjection);goog.exportProperty(ol.source.BingMaps.prototype,"getState",ol.source.BingMaps.prototype.getState);goog.exportProperty(ol.source.BingMaps.prototype,"setAttributions",ol.source.BingMaps.prototype.setAttributions);goog.exportProperty(ol.source.BingMaps.prototype,"get",ol.source.BingMaps.prototype.get);goog.exportProperty(ol.source.BingMaps.prototype,"getKeys",ol.source.BingMaps.prototype.getKeys);goog.exportProperty(ol.source.BingMaps.prototype,"getProperties",ol.source.BingMaps.prototype.getProperties);goog.exportProperty(ol.source.BingMaps.prototype,"set",ol.source.BingMaps.prototype.set);goog.exportProperty(ol.source.BingMaps.prototype,"setProperties",ol.source.BingMaps.prototype.setProperties);goog.exportProperty(ol.source.BingMaps.prototype,"unset",ol.source.BingMaps.prototype.unset);goog.exportProperty(ol.source.BingMaps.prototype,"changed",ol.source.BingMaps.prototype.changed);goog.exportProperty(ol.source.BingMaps.prototype,"dispatchEvent",ol.source.BingMaps.prototype.dispatchEvent);goog.exportProperty(ol.source.BingMaps.prototype,"getRevision",ol.source.BingMaps.prototype.getRevision);goog.exportProperty(ol.source.BingMaps.prototype,"on",ol.source.BingMaps.prototype.on);goog.exportProperty(ol.source.BingMaps.prototype,"once",ol.source.BingMaps.prototype.once);goog.exportProperty(ol.source.BingMaps.prototype,"un",ol.source.BingMaps.prototype.un);goog.exportProperty(ol.source.XYZ.prototype,"setRenderReprojectionEdges",ol.source.XYZ.prototype.setRenderReprojectionEdges);goog.exportProperty(ol.source.XYZ.prototype,"setTileGridForProjection",ol.source.XYZ.prototype.setTileGridForProjection);goog.exportProperty(ol.source.XYZ.prototype,"getTileLoadFunction",ol.source.XYZ.prototype.getTileLoadFunction);goog.exportProperty(ol.source.XYZ.prototype,"getTileUrlFunction",ol.source.XYZ.prototype.getTileUrlFunction);goog.exportProperty(ol.source.XYZ.prototype,"getUrls",ol.source.XYZ.prototype.getUrls);goog.exportProperty(ol.source.XYZ.prototype,"setTileLoadFunction",ol.source.XYZ.prototype.setTileLoadFunction);goog.exportProperty(ol.source.XYZ.prototype,"setTileUrlFunction",ol.source.XYZ.prototype.setTileUrlFunction);goog.exportProperty(ol.source.XYZ.prototype,"setUrl",ol.source.XYZ.prototype.setUrl);goog.exportProperty(ol.source.XYZ.prototype,"setUrls",ol.source.XYZ.prototype.setUrls);goog.exportProperty(ol.source.XYZ.prototype,"getTileGrid",ol.source.XYZ.prototype.getTileGrid);goog.exportProperty(ol.source.XYZ.prototype,"refresh",ol.source.XYZ.prototype.refresh);goog.exportProperty(ol.source.XYZ.prototype,"getAttributions",ol.source.XYZ.prototype.getAttributions);goog.exportProperty(ol.source.XYZ.prototype,"getLogo",ol.source.XYZ.prototype.getLogo);goog.exportProperty(ol.source.XYZ.prototype,"getProjection",ol.source.XYZ.prototype.getProjection);goog.exportProperty(ol.source.XYZ.prototype,"getState",ol.source.XYZ.prototype.getState);goog.exportProperty(ol.source.XYZ.prototype,"setAttributions",ol.source.XYZ.prototype.setAttributions);goog.exportProperty(ol.source.XYZ.prototype,"get",ol.source.XYZ.prototype.get);goog.exportProperty(ol.source.XYZ.prototype,"getKeys",ol.source.XYZ.prototype.getKeys);goog.exportProperty(ol.source.XYZ.prototype,"getProperties",ol.source.XYZ.prototype.getProperties);goog.exportProperty(ol.source.XYZ.prototype,"set",ol.source.XYZ.prototype.set);goog.exportProperty(ol.source.XYZ.prototype,"setProperties",ol.source.XYZ.prototype.setProperties);goog.exportProperty(ol.source.XYZ.prototype,"unset",ol.source.XYZ.prototype.unset);goog.exportProperty(ol.source.XYZ.prototype,"changed",ol.source.XYZ.prototype.changed);goog.exportProperty(ol.source.XYZ.prototype,"dispatchEvent",ol.source.XYZ.prototype.dispatchEvent);goog.exportProperty(ol.source.XYZ.prototype,"getRevision",ol.source.XYZ.prototype.getRevision);goog.exportProperty(ol.source.XYZ.prototype,"on",ol.source.XYZ.prototype.on);goog.exportProperty(ol.source.XYZ.prototype,"once",ol.source.XYZ.prototype.once);goog.exportProperty(ol.source.XYZ.prototype,"un",ol.source.XYZ.prototype.un);goog.exportProperty(ol.source.CartoDB.prototype,"setRenderReprojectionEdges",ol.source.CartoDB.prototype.setRenderReprojectionEdges);goog.exportProperty(ol.source.CartoDB.prototype,"setTileGridForProjection",ol.source.CartoDB.prototype.setTileGridForProjection);goog.exportProperty(ol.source.CartoDB.prototype,"getTileLoadFunction",ol.source.CartoDB.prototype.getTileLoadFunction);goog.exportProperty(ol.source.CartoDB.prototype,"getTileUrlFunction",ol.source.CartoDB.prototype.getTileUrlFunction);goog.exportProperty(ol.source.CartoDB.prototype,"getUrls",ol.source.CartoDB.prototype.getUrls);goog.exportProperty(ol.source.CartoDB.prototype,"setTileLoadFunction",ol.source.CartoDB.prototype.setTileLoadFunction);goog.exportProperty(ol.source.CartoDB.prototype,"setTileUrlFunction",ol.source.CartoDB.prototype.setTileUrlFunction);goog.exportProperty(ol.source.CartoDB.prototype,"setUrl",ol.source.CartoDB.prototype.setUrl);goog.exportProperty(ol.source.CartoDB.prototype,"setUrls",ol.source.CartoDB.prototype.setUrls);goog.exportProperty(ol.source.CartoDB.prototype,"getTileGrid",ol.source.CartoDB.prototype.getTileGrid);goog.exportProperty(ol.source.CartoDB.prototype,"refresh",ol.source.CartoDB.prototype.refresh);goog.exportProperty(ol.source.CartoDB.prototype,"getAttributions",ol.source.CartoDB.prototype.getAttributions);goog.exportProperty(ol.source.CartoDB.prototype,"getLogo",ol.source.CartoDB.prototype.getLogo);goog.exportProperty(ol.source.CartoDB.prototype,"getProjection",ol.source.CartoDB.prototype.getProjection);goog.exportProperty(ol.source.CartoDB.prototype,"getState",ol.source.CartoDB.prototype.getState);goog.exportProperty(ol.source.CartoDB.prototype,"setAttributions",ol.source.CartoDB.prototype.setAttributions);goog.exportProperty(ol.source.CartoDB.prototype,"get",ol.source.CartoDB.prototype.get);goog.exportProperty(ol.source.CartoDB.prototype,"getKeys",ol.source.CartoDB.prototype.getKeys);goog.exportProperty(ol.source.CartoDB.prototype,"getProperties",ol.source.CartoDB.prototype.getProperties);goog.exportProperty(ol.source.CartoDB.prototype,"set",ol.source.CartoDB.prototype.set);goog.exportProperty(ol.source.CartoDB.prototype,"setProperties",ol.source.CartoDB.prototype.setProperties);goog.exportProperty(ol.source.CartoDB.prototype,"unset",ol.source.CartoDB.prototype.unset);goog.exportProperty(ol.source.CartoDB.prototype,"changed",ol.source.CartoDB.prototype.changed);goog.exportProperty(ol.source.CartoDB.prototype,"dispatchEvent",ol.source.CartoDB.prototype.dispatchEvent);goog.exportProperty(ol.source.CartoDB.prototype,"getRevision",ol.source.CartoDB.prototype.getRevision);goog.exportProperty(ol.source.CartoDB.prototype,"on",ol.source.CartoDB.prototype.on);goog.exportProperty(ol.source.CartoDB.prototype,"once",ol.source.CartoDB.prototype.once);goog.exportProperty(ol.source.CartoDB.prototype,"un",ol.source.CartoDB.prototype.un);goog.exportProperty(ol.source.Vector.prototype,"getAttributions",ol.source.Vector.prototype.getAttributions);goog.exportProperty(ol.source.Vector.prototype,"getLogo",ol.source.Vector.prototype.getLogo);goog.exportProperty(ol.source.Vector.prototype,"getProjection",ol.source.Vector.prototype.getProjection);goog.exportProperty(ol.source.Vector.prototype,"getState",ol.source.Vector.prototype.getState);goog.exportProperty(ol.source.Vector.prototype,"refresh",ol.source.Vector.prototype.refresh);goog.exportProperty(ol.source.Vector.prototype,"setAttributions",ol.source.Vector.prototype.setAttributions);goog.exportProperty(ol.source.Vector.prototype,"get",ol.source.Vector.prototype.get);goog.exportProperty(ol.source.Vector.prototype,"getKeys",ol.source.Vector.prototype.getKeys);goog.exportProperty(ol.source.Vector.prototype,"getProperties",ol.source.Vector.prototype.getProperties);goog.exportProperty(ol.source.Vector.prototype,"set",ol.source.Vector.prototype.set);goog.exportProperty(ol.source.Vector.prototype,"setProperties",ol.source.Vector.prototype.setProperties);goog.exportProperty(ol.source.Vector.prototype,"unset",ol.source.Vector.prototype.unset);goog.exportProperty(ol.source.Vector.prototype,"changed",ol.source.Vector.prototype.changed);goog.exportProperty(ol.source.Vector.prototype,"dispatchEvent",ol.source.Vector.prototype.dispatchEvent);goog.exportProperty(ol.source.Vector.prototype,"getRevision",ol.source.Vector.prototype.getRevision);goog.exportProperty(ol.source.Vector.prototype,"on",ol.source.Vector.prototype.on);goog.exportProperty(ol.source.Vector.prototype,"once",ol.source.Vector.prototype.once);goog.exportProperty(ol.source.Vector.prototype,"un",ol.source.Vector.prototype.un);goog.exportProperty(ol.source.Cluster.prototype,"addFeature",ol.source.Cluster.prototype.addFeature);goog.exportProperty(ol.source.Cluster.prototype,"addFeatures",ol.source.Cluster.prototype.addFeatures);goog.exportProperty(ol.source.Cluster.prototype,"clear",ol.source.Cluster.prototype.clear);goog.exportProperty(ol.source.Cluster.prototype,"forEachFeature",ol.source.Cluster.prototype.forEachFeature);goog.exportProperty(ol.source.Cluster.prototype,"forEachFeatureInExtent",ol.source.Cluster.prototype.forEachFeatureInExtent);goog.exportProperty(ol.source.Cluster.prototype,"forEachFeatureIntersectingExtent",ol.source.Cluster.prototype.forEachFeatureIntersectingExtent);goog.exportProperty(ol.source.Cluster.prototype,"getFeaturesCollection",ol.source.Cluster.prototype.getFeaturesCollection);goog.exportProperty(ol.source.Cluster.prototype,"getFeatures",ol.source.Cluster.prototype.getFeatures);goog.exportProperty(ol.source.Cluster.prototype,"getFeaturesAtCoordinate",ol.source.Cluster.prototype.getFeaturesAtCoordinate);goog.exportProperty(ol.source.Cluster.prototype,"getFeaturesInExtent",ol.source.Cluster.prototype.getFeaturesInExtent);goog.exportProperty(ol.source.Cluster.prototype,"getClosestFeatureToCoordinate",ol.source.Cluster.prototype.getClosestFeatureToCoordinate);goog.exportProperty(ol.source.Cluster.prototype,"getExtent",ol.source.Cluster.prototype.getExtent);goog.exportProperty(ol.source.Cluster.prototype,"getFeatureById",ol.source.Cluster.prototype.getFeatureById);goog.exportProperty(ol.source.Cluster.prototype,"getFormat",ol.source.Cluster.prototype.getFormat);goog.exportProperty(ol.source.Cluster.prototype,"getUrl",ol.source.Cluster.prototype.getUrl);goog.exportProperty(ol.source.Cluster.prototype,"removeFeature",ol.source.Cluster.prototype.removeFeature);goog.exportProperty(ol.source.Cluster.prototype,"getAttributions",ol.source.Cluster.prototype.getAttributions);goog.exportProperty(ol.source.Cluster.prototype,"getLogo",ol.source.Cluster.prototype.getLogo);goog.exportProperty(ol.source.Cluster.prototype,"getProjection",ol.source.Cluster.prototype.getProjection);goog.exportProperty(ol.source.Cluster.prototype,"getState",ol.source.Cluster.prototype.getState);goog.exportProperty(ol.source.Cluster.prototype,"refresh",ol.source.Cluster.prototype.refresh);goog.exportProperty(ol.source.Cluster.prototype,"setAttributions",ol.source.Cluster.prototype.setAttributions);goog.exportProperty(ol.source.Cluster.prototype,"get",ol.source.Cluster.prototype.get);goog.exportProperty(ol.source.Cluster.prototype,"getKeys",ol.source.Cluster.prototype.getKeys);goog.exportProperty(ol.source.Cluster.prototype,"getProperties",ol.source.Cluster.prototype.getProperties);goog.exportProperty(ol.source.Cluster.prototype,"set",ol.source.Cluster.prototype.set);goog.exportProperty(ol.source.Cluster.prototype,"setProperties",ol.source.Cluster.prototype.setProperties);goog.exportProperty(ol.source.Cluster.prototype,"unset",ol.source.Cluster.prototype.unset);goog.exportProperty(ol.source.Cluster.prototype,"changed",ol.source.Cluster.prototype.changed);goog.exportProperty(ol.source.Cluster.prototype,"dispatchEvent",ol.source.Cluster.prototype.dispatchEvent);goog.exportProperty(ol.source.Cluster.prototype,"getRevision",ol.source.Cluster.prototype.getRevision);goog.exportProperty(ol.source.Cluster.prototype,"on",ol.source.Cluster.prototype.on);goog.exportProperty(ol.source.Cluster.prototype,"once",ol.source.Cluster.prototype.once);goog.exportProperty(ol.source.Cluster.prototype,"un",ol.source.Cluster.prototype.un);goog.exportProperty(ol.source.Image.prototype,"getAttributions",ol.source.Image.prototype.getAttributions);goog.exportProperty(ol.source.Image.prototype,"getLogo",ol.source.Image.prototype.getLogo);goog.exportProperty(ol.source.Image.prototype,"getProjection",ol.source.Image.prototype.getProjection);goog.exportProperty(ol.source.Image.prototype,"getState",ol.source.Image.prototype.getState);goog.exportProperty(ol.source.Image.prototype,"refresh",ol.source.Image.prototype.refresh);goog.exportProperty(ol.source.Image.prototype,"setAttributions",ol.source.Image.prototype.setAttributions);goog.exportProperty(ol.source.Image.prototype,"get",ol.source.Image.prototype.get);goog.exportProperty(ol.source.Image.prototype,"getKeys",ol.source.Image.prototype.getKeys);goog.exportProperty(ol.source.Image.prototype,"getProperties",ol.source.Image.prototype.getProperties);goog.exportProperty(ol.source.Image.prototype,"set",ol.source.Image.prototype.set);goog.exportProperty(ol.source.Image.prototype,"setProperties",ol.source.Image.prototype.setProperties);goog.exportProperty(ol.source.Image.prototype,"unset",ol.source.Image.prototype.unset);goog.exportProperty(ol.source.Image.prototype,"changed",ol.source.Image.prototype.changed);goog.exportProperty(ol.source.Image.prototype,"dispatchEvent",ol.source.Image.prototype.dispatchEvent);goog.exportProperty(ol.source.Image.prototype,"getRevision",ol.source.Image.prototype.getRevision);goog.exportProperty(ol.source.Image.prototype,"on",ol.source.Image.prototype.on);goog.exportProperty(ol.source.Image.prototype,"once",ol.source.Image.prototype.once);goog.exportProperty(ol.source.Image.prototype,"un",ol.source.Image.prototype.un);goog.exportProperty(ol.source.Image.Event.prototype,"type",ol.source.Image.Event.prototype.type);goog.exportProperty(ol.source.Image.Event.prototype,"target",ol.source.Image.Event.prototype.target);goog.exportProperty(ol.source.Image.Event.prototype,"preventDefault",ol.source.Image.Event.prototype.preventDefault);goog.exportProperty(ol.source.Image.Event.prototype,"stopPropagation",ol.source.Image.Event.prototype.stopPropagation);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"getAttributions",ol.source.ImageArcGISRest.prototype.getAttributions);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"getLogo",ol.source.ImageArcGISRest.prototype.getLogo);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"getProjection",ol.source.ImageArcGISRest.prototype.getProjection);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"getState",ol.source.ImageArcGISRest.prototype.getState);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"refresh",ol.source.ImageArcGISRest.prototype.refresh);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"setAttributions",ol.source.ImageArcGISRest.prototype.setAttributions);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"get",ol.source.ImageArcGISRest.prototype.get);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"getKeys",ol.source.ImageArcGISRest.prototype.getKeys);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"getProperties",ol.source.ImageArcGISRest.prototype.getProperties);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"set",ol.source.ImageArcGISRest.prototype.set);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"setProperties",ol.source.ImageArcGISRest.prototype.setProperties);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"unset",ol.source.ImageArcGISRest.prototype.unset);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"changed",ol.source.ImageArcGISRest.prototype.changed);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"dispatchEvent",ol.source.ImageArcGISRest.prototype.dispatchEvent);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"getRevision",ol.source.ImageArcGISRest.prototype.getRevision);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"on",ol.source.ImageArcGISRest.prototype.on);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"once",ol.source.ImageArcGISRest.prototype.once);goog.exportProperty(ol.source.ImageArcGISRest.prototype,"un",ol.source.ImageArcGISRest.prototype.un);goog.exportProperty(ol.source.ImageCanvas.prototype,"getAttributions",ol.source.ImageCanvas.prototype.getAttributions);goog.exportProperty(ol.source.ImageCanvas.prototype,"getLogo",ol.source.ImageCanvas.prototype.getLogo);goog.exportProperty(ol.source.ImageCanvas.prototype,"getProjection",ol.source.ImageCanvas.prototype.getProjection);goog.exportProperty(ol.source.ImageCanvas.prototype,"getState",ol.source.ImageCanvas.prototype.getState);goog.exportProperty(ol.source.ImageCanvas.prototype,"refresh",ol.source.ImageCanvas.prototype.refresh);goog.exportProperty(ol.source.ImageCanvas.prototype,"setAttributions",ol.source.ImageCanvas.prototype.setAttributions);goog.exportProperty(ol.source.ImageCanvas.prototype,"get",ol.source.ImageCanvas.prototype.get);goog.exportProperty(ol.source.ImageCanvas.prototype,"getKeys",ol.source.ImageCanvas.prototype.getKeys);goog.exportProperty(ol.source.ImageCanvas.prototype,"getProperties",ol.source.ImageCanvas.prototype.getProperties);goog.exportProperty(ol.source.ImageCanvas.prototype,"set",ol.source.ImageCanvas.prototype.set);goog.exportProperty(ol.source.ImageCanvas.prototype,"setProperties",ol.source.ImageCanvas.prototype.setProperties);goog.exportProperty(ol.source.ImageCanvas.prototype,"unset",ol.source.ImageCanvas.prototype.unset);goog.exportProperty(ol.source.ImageCanvas.prototype,"changed",ol.source.ImageCanvas.prototype.changed);goog.exportProperty(ol.source.ImageCanvas.prototype,"dispatchEvent",ol.source.ImageCanvas.prototype.dispatchEvent);goog.exportProperty(ol.source.ImageCanvas.prototype,"getRevision",ol.source.ImageCanvas.prototype.getRevision);goog.exportProperty(ol.source.ImageCanvas.prototype,"on",ol.source.ImageCanvas.prototype.on);goog.exportProperty(ol.source.ImageCanvas.prototype,"once",ol.source.ImageCanvas.prototype.once);goog.exportProperty(ol.source.ImageCanvas.prototype,"un",ol.source.ImageCanvas.prototype.un);goog.exportProperty(ol.source.ImageMapGuide.prototype,"getAttributions",ol.source.ImageMapGuide.prototype.getAttributions);goog.exportProperty(ol.source.ImageMapGuide.prototype,"getLogo",ol.source.ImageMapGuide.prototype.getLogo);goog.exportProperty(ol.source.ImageMapGuide.prototype,"getProjection",ol.source.ImageMapGuide.prototype.getProjection);goog.exportProperty(ol.source.ImageMapGuide.prototype,"getState",ol.source.ImageMapGuide.prototype.getState);goog.exportProperty(ol.source.ImageMapGuide.prototype,"refresh",ol.source.ImageMapGuide.prototype.refresh);goog.exportProperty(ol.source.ImageMapGuide.prototype,"setAttributions",ol.source.ImageMapGuide.prototype.setAttributions);goog.exportProperty(ol.source.ImageMapGuide.prototype,"get",ol.source.ImageMapGuide.prototype.get);goog.exportProperty(ol.source.ImageMapGuide.prototype,"getKeys",ol.source.ImageMapGuide.prototype.getKeys);goog.exportProperty(ol.source.ImageMapGuide.prototype,"getProperties",ol.source.ImageMapGuide.prototype.getProperties);goog.exportProperty(ol.source.ImageMapGuide.prototype,"set",ol.source.ImageMapGuide.prototype.set);goog.exportProperty(ol.source.ImageMapGuide.prototype,"setProperties",ol.source.ImageMapGuide.prototype.setProperties);goog.exportProperty(ol.source.ImageMapGuide.prototype,"unset",ol.source.ImageMapGuide.prototype.unset);goog.exportProperty(ol.source.ImageMapGuide.prototype,"changed",ol.source.ImageMapGuide.prototype.changed);goog.exportProperty(ol.source.ImageMapGuide.prototype,"dispatchEvent",ol.source.ImageMapGuide.prototype.dispatchEvent);goog.exportProperty(ol.source.ImageMapGuide.prototype,"getRevision",ol.source.ImageMapGuide.prototype.getRevision);goog.exportProperty(ol.source.ImageMapGuide.prototype,"on",ol.source.ImageMapGuide.prototype.on);goog.exportProperty(ol.source.ImageMapGuide.prototype,"once",ol.source.ImageMapGuide.prototype.once);goog.exportProperty(ol.source.ImageMapGuide.prototype,"un",ol.source.ImageMapGuide.prototype.un);goog.exportProperty(ol.source.ImageStatic.prototype,"getAttributions",ol.source.ImageStatic.prototype.getAttributions);goog.exportProperty(ol.source.ImageStatic.prototype,"getLogo",ol.source.ImageStatic.prototype.getLogo);goog.exportProperty(ol.source.ImageStatic.prototype,"getProjection",ol.source.ImageStatic.prototype.getProjection);goog.exportProperty(ol.source.ImageStatic.prototype,"getState",ol.source.ImageStatic.prototype.getState);goog.exportProperty(ol.source.ImageStatic.prototype,"refresh",ol.source.ImageStatic.prototype.refresh);goog.exportProperty(ol.source.ImageStatic.prototype,"setAttributions",ol.source.ImageStatic.prototype.setAttributions);goog.exportProperty(ol.source.ImageStatic.prototype,"get",ol.source.ImageStatic.prototype.get);goog.exportProperty(ol.source.ImageStatic.prototype,"getKeys",ol.source.ImageStatic.prototype.getKeys);goog.exportProperty(ol.source.ImageStatic.prototype,"getProperties",ol.source.ImageStatic.prototype.getProperties);goog.exportProperty(ol.source.ImageStatic.prototype,"set",ol.source.ImageStatic.prototype.set);goog.exportProperty(ol.source.ImageStatic.prototype,"setProperties",ol.source.ImageStatic.prototype.setProperties);goog.exportProperty(ol.source.ImageStatic.prototype,"unset",ol.source.ImageStatic.prototype.unset);goog.exportProperty(ol.source.ImageStatic.prototype,"changed",ol.source.ImageStatic.prototype.changed);goog.exportProperty(ol.source.ImageStatic.prototype,"dispatchEvent",ol.source.ImageStatic.prototype.dispatchEvent);goog.exportProperty(ol.source.ImageStatic.prototype,"getRevision",ol.source.ImageStatic.prototype.getRevision);goog.exportProperty(ol.source.ImageStatic.prototype,"on",ol.source.ImageStatic.prototype.on);goog.exportProperty(ol.source.ImageStatic.prototype,"once",ol.source.ImageStatic.prototype.once);goog.exportProperty(ol.source.ImageStatic.prototype,"un",ol.source.ImageStatic.prototype.un);goog.exportProperty(ol.source.ImageVector.prototype,"getAttributions",ol.source.ImageVector.prototype.getAttributions);goog.exportProperty(ol.source.ImageVector.prototype,"getLogo",ol.source.ImageVector.prototype.getLogo);goog.exportProperty(ol.source.ImageVector.prototype,"getProjection",ol.source.ImageVector.prototype.getProjection);goog.exportProperty(ol.source.ImageVector.prototype,"getState",ol.source.ImageVector.prototype.getState);goog.exportProperty(ol.source.ImageVector.prototype,"refresh",ol.source.ImageVector.prototype.refresh);goog.exportProperty(ol.source.ImageVector.prototype,"setAttributions",ol.source.ImageVector.prototype.setAttributions);goog.exportProperty(ol.source.ImageVector.prototype,"get",ol.source.ImageVector.prototype.get);goog.exportProperty(ol.source.ImageVector.prototype,"getKeys",ol.source.ImageVector.prototype.getKeys);goog.exportProperty(ol.source.ImageVector.prototype,"getProperties",ol.source.ImageVector.prototype.getProperties);goog.exportProperty(ol.source.ImageVector.prototype,"set",ol.source.ImageVector.prototype.set);goog.exportProperty(ol.source.ImageVector.prototype,"setProperties",ol.source.ImageVector.prototype.setProperties);goog.exportProperty(ol.source.ImageVector.prototype,"unset",ol.source.ImageVector.prototype.unset);goog.exportProperty(ol.source.ImageVector.prototype,"changed",ol.source.ImageVector.prototype.changed);goog.exportProperty(ol.source.ImageVector.prototype,"dispatchEvent",ol.source.ImageVector.prototype.dispatchEvent);goog.exportProperty(ol.source.ImageVector.prototype,"getRevision",ol.source.ImageVector.prototype.getRevision);goog.exportProperty(ol.source.ImageVector.prototype,"on",ol.source.ImageVector.prototype.on);goog.exportProperty(ol.source.ImageVector.prototype,"once",ol.source.ImageVector.prototype.once);goog.exportProperty(ol.source.ImageVector.prototype,"un",ol.source.ImageVector.prototype.un);goog.exportProperty(ol.source.ImageWMS.prototype,"getAttributions",ol.source.ImageWMS.prototype.getAttributions);goog.exportProperty(ol.source.ImageWMS.prototype,"getLogo",ol.source.ImageWMS.prototype.getLogo);goog.exportProperty(ol.source.ImageWMS.prototype,"getProjection",ol.source.ImageWMS.prototype.getProjection);goog.exportProperty(ol.source.ImageWMS.prototype,"getState",ol.source.ImageWMS.prototype.getState);goog.exportProperty(ol.source.ImageWMS.prototype,"refresh",ol.source.ImageWMS.prototype.refresh);goog.exportProperty(ol.source.ImageWMS.prototype,"setAttributions",ol.source.ImageWMS.prototype.setAttributions);goog.exportProperty(ol.source.ImageWMS.prototype,"get",ol.source.ImageWMS.prototype.get);goog.exportProperty(ol.source.ImageWMS.prototype,"getKeys",ol.source.ImageWMS.prototype.getKeys);goog.exportProperty(ol.source.ImageWMS.prototype,"getProperties",ol.source.ImageWMS.prototype.getProperties);goog.exportProperty(ol.source.ImageWMS.prototype,"set",ol.source.ImageWMS.prototype.set);goog.exportProperty(ol.source.ImageWMS.prototype,"setProperties",ol.source.ImageWMS.prototype.setProperties);goog.exportProperty(ol.source.ImageWMS.prototype,"unset",ol.source.ImageWMS.prototype.unset);goog.exportProperty(ol.source.ImageWMS.prototype,"changed",ol.source.ImageWMS.prototype.changed);goog.exportProperty(ol.source.ImageWMS.prototype,"dispatchEvent",ol.source.ImageWMS.prototype.dispatchEvent);goog.exportProperty(ol.source.ImageWMS.prototype,"getRevision",ol.source.ImageWMS.prototype.getRevision);goog.exportProperty(ol.source.ImageWMS.prototype,"on",ol.source.ImageWMS.prototype.on);goog.exportProperty(ol.source.ImageWMS.prototype,"once",ol.source.ImageWMS.prototype.once);goog.exportProperty(ol.source.ImageWMS.prototype,"un",ol.source.ImageWMS.prototype.un);goog.exportProperty(ol.source.OSM.prototype,"setRenderReprojectionEdges",ol.source.OSM.prototype.setRenderReprojectionEdges);goog.exportProperty(ol.source.OSM.prototype,"setTileGridForProjection",ol.source.OSM.prototype.setTileGridForProjection);goog.exportProperty(ol.source.OSM.prototype,"getTileLoadFunction",ol.source.OSM.prototype.getTileLoadFunction);goog.exportProperty(ol.source.OSM.prototype,"getTileUrlFunction",ol.source.OSM.prototype.getTileUrlFunction);goog.exportProperty(ol.source.OSM.prototype,"getUrls",ol.source.OSM.prototype.getUrls);goog.exportProperty(ol.source.OSM.prototype,"setTileLoadFunction",ol.source.OSM.prototype.setTileLoadFunction);goog.exportProperty(ol.source.OSM.prototype,"setTileUrlFunction",ol.source.OSM.prototype.setTileUrlFunction);goog.exportProperty(ol.source.OSM.prototype,"setUrl",ol.source.OSM.prototype.setUrl);goog.exportProperty(ol.source.OSM.prototype,"setUrls",ol.source.OSM.prototype.setUrls);goog.exportProperty(ol.source.OSM.prototype,"getTileGrid",ol.source.OSM.prototype.getTileGrid);goog.exportProperty(ol.source.OSM.prototype,"refresh",ol.source.OSM.prototype.refresh);goog.exportProperty(ol.source.OSM.prototype,"getAttributions",ol.source.OSM.prototype.getAttributions);goog.exportProperty(ol.source.OSM.prototype,"getLogo",ol.source.OSM.prototype.getLogo);goog.exportProperty(ol.source.OSM.prototype,"getProjection",ol.source.OSM.prototype.getProjection);goog.exportProperty(ol.source.OSM.prototype,"getState",ol.source.OSM.prototype.getState);goog.exportProperty(ol.source.OSM.prototype,"setAttributions",ol.source.OSM.prototype.setAttributions);goog.exportProperty(ol.source.OSM.prototype,"get",ol.source.OSM.prototype.get);goog.exportProperty(ol.source.OSM.prototype,"getKeys",ol.source.OSM.prototype.getKeys);goog.exportProperty(ol.source.OSM.prototype,"getProperties",ol.source.OSM.prototype.getProperties);goog.exportProperty(ol.source.OSM.prototype,"set",ol.source.OSM.prototype.set);goog.exportProperty(ol.source.OSM.prototype,"setProperties",ol.source.OSM.prototype.setProperties);goog.exportProperty(ol.source.OSM.prototype,"unset",ol.source.OSM.prototype.unset);goog.exportProperty(ol.source.OSM.prototype,"changed",ol.source.OSM.prototype.changed);goog.exportProperty(ol.source.OSM.prototype,"dispatchEvent",ol.source.OSM.prototype.dispatchEvent);goog.exportProperty(ol.source.OSM.prototype,"getRevision",ol.source.OSM.prototype.getRevision);goog.exportProperty(ol.source.OSM.prototype,"on",ol.source.OSM.prototype.on);goog.exportProperty(ol.source.OSM.prototype,"once",ol.source.OSM.prototype.once);goog.exportProperty(ol.source.OSM.prototype,"un",ol.source.OSM.prototype.un);goog.exportProperty(ol.source.Raster.prototype,"getAttributions",ol.source.Raster.prototype.getAttributions);goog.exportProperty(ol.source.Raster.prototype,"getLogo",ol.source.Raster.prototype.getLogo);goog.exportProperty(ol.source.Raster.prototype,"getProjection",ol.source.Raster.prototype.getProjection);goog.exportProperty(ol.source.Raster.prototype,"getState",ol.source.Raster.prototype.getState);goog.exportProperty(ol.source.Raster.prototype,"refresh",ol.source.Raster.prototype.refresh);goog.exportProperty(ol.source.Raster.prototype,"setAttributions",ol.source.Raster.prototype.setAttributions);goog.exportProperty(ol.source.Raster.prototype,"get",ol.source.Raster.prototype.get);goog.exportProperty(ol.source.Raster.prototype,"getKeys",ol.source.Raster.prototype.getKeys);goog.exportProperty(ol.source.Raster.prototype,"getProperties",ol.source.Raster.prototype.getProperties);goog.exportProperty(ol.source.Raster.prototype,"set",ol.source.Raster.prototype.set);goog.exportProperty(ol.source.Raster.prototype,"setProperties",ol.source.Raster.prototype.setProperties);goog.exportProperty(ol.source.Raster.prototype,"unset",ol.source.Raster.prototype.unset);goog.exportProperty(ol.source.Raster.prototype,"changed",ol.source.Raster.prototype.changed);goog.exportProperty(ol.source.Raster.prototype,"dispatchEvent",ol.source.Raster.prototype.dispatchEvent);goog.exportProperty(ol.source.Raster.prototype,"getRevision",ol.source.Raster.prototype.getRevision);goog.exportProperty(ol.source.Raster.prototype,"on",ol.source.Raster.prototype.on);goog.exportProperty(ol.source.Raster.prototype,"once",ol.source.Raster.prototype.once);goog.exportProperty(ol.source.Raster.prototype,"un",ol.source.Raster.prototype.un);goog.exportProperty(ol.source.Raster.Event.prototype,"type",ol.source.Raster.Event.prototype.type);goog.exportProperty(ol.source.Raster.Event.prototype,"target",ol.source.Raster.Event.prototype.target);

goog.exportProperty(ol.source.Raster.Event.prototype,"preventDefault",ol.source.Raster.Event.prototype.preventDefault);goog.exportProperty(ol.source.Raster.Event.prototype,"stopPropagation",ol.source.Raster.Event.prototype.stopPropagation);goog.exportProperty(ol.source.Stamen.prototype,"setRenderReprojectionEdges",ol.source.Stamen.prototype.setRenderReprojectionEdges);goog.exportProperty(ol.source.Stamen.prototype,"setTileGridForProjection",ol.source.Stamen.prototype.setTileGridForProjection);goog.exportProperty(ol.source.Stamen.prototype,"getTileLoadFunction",ol.source.Stamen.prototype.getTileLoadFunction);goog.exportProperty(ol.source.Stamen.prototype,"getTileUrlFunction",ol.source.Stamen.prototype.getTileUrlFunction);goog.exportProperty(ol.source.Stamen.prototype,"getUrls",ol.source.Stamen.prototype.getUrls);goog.exportProperty(ol.source.Stamen.prototype,"setTileLoadFunction",ol.source.Stamen.prototype.setTileLoadFunction);goog.exportProperty(ol.source.Stamen.prototype,"setTileUrlFunction",ol.source.Stamen.prototype.setTileUrlFunction);goog.exportProperty(ol.source.Stamen.prototype,"setUrl",ol.source.Stamen.prototype.setUrl);goog.exportProperty(ol.source.Stamen.prototype,"setUrls",ol.source.Stamen.prototype.setUrls);goog.exportProperty(ol.source.Stamen.prototype,"getTileGrid",ol.source.Stamen.prototype.getTileGrid);goog.exportProperty(ol.source.Stamen.prototype,"refresh",ol.source.Stamen.prototype.refresh);goog.exportProperty(ol.source.Stamen.prototype,"getAttributions",ol.source.Stamen.prototype.getAttributions);goog.exportProperty(ol.source.Stamen.prototype,"getLogo",ol.source.Stamen.prototype.getLogo);goog.exportProperty(ol.source.Stamen.prototype,"getProjection",ol.source.Stamen.prototype.getProjection);goog.exportProperty(ol.source.Stamen.prototype,"getState",ol.source.Stamen.prototype.getState);goog.exportProperty(ol.source.Stamen.prototype,"setAttributions",ol.source.Stamen.prototype.setAttributions);goog.exportProperty(ol.source.Stamen.prototype,"get",ol.source.Stamen.prototype.get);goog.exportProperty(ol.source.Stamen.prototype,"getKeys",ol.source.Stamen.prototype.getKeys);goog.exportProperty(ol.source.Stamen.prototype,"getProperties",ol.source.Stamen.prototype.getProperties);goog.exportProperty(ol.source.Stamen.prototype,"set",ol.source.Stamen.prototype.set);goog.exportProperty(ol.source.Stamen.prototype,"setProperties",ol.source.Stamen.prototype.setProperties);goog.exportProperty(ol.source.Stamen.prototype,"unset",ol.source.Stamen.prototype.unset);goog.exportProperty(ol.source.Stamen.prototype,"changed",ol.source.Stamen.prototype.changed);goog.exportProperty(ol.source.Stamen.prototype,"dispatchEvent",ol.source.Stamen.prototype.dispatchEvent);goog.exportProperty(ol.source.Stamen.prototype,"getRevision",ol.source.Stamen.prototype.getRevision);goog.exportProperty(ol.source.Stamen.prototype,"on",ol.source.Stamen.prototype.on);goog.exportProperty(ol.source.Stamen.prototype,"once",ol.source.Stamen.prototype.once);goog.exportProperty(ol.source.Stamen.prototype,"un",ol.source.Stamen.prototype.un);goog.exportProperty(ol.source.Tile.Event.prototype,"type",ol.source.Tile.Event.prototype.type);goog.exportProperty(ol.source.Tile.Event.prototype,"target",ol.source.Tile.Event.prototype.target);goog.exportProperty(ol.source.Tile.Event.prototype,"preventDefault",ol.source.Tile.Event.prototype.preventDefault);goog.exportProperty(ol.source.Tile.Event.prototype,"stopPropagation",ol.source.Tile.Event.prototype.stopPropagation);goog.exportProperty(ol.source.TileArcGISRest.prototype,"setRenderReprojectionEdges",ol.source.TileArcGISRest.prototype.setRenderReprojectionEdges);goog.exportProperty(ol.source.TileArcGISRest.prototype,"setTileGridForProjection",ol.source.TileArcGISRest.prototype.setTileGridForProjection);goog.exportProperty(ol.source.TileArcGISRest.prototype,"getTileLoadFunction",ol.source.TileArcGISRest.prototype.getTileLoadFunction);goog.exportProperty(ol.source.TileArcGISRest.prototype,"getTileUrlFunction",ol.source.TileArcGISRest.prototype.getTileUrlFunction);goog.exportProperty(ol.source.TileArcGISRest.prototype,"getUrls",ol.source.TileArcGISRest.prototype.getUrls);goog.exportProperty(ol.source.TileArcGISRest.prototype,"setTileLoadFunction",ol.source.TileArcGISRest.prototype.setTileLoadFunction);goog.exportProperty(ol.source.TileArcGISRest.prototype,"setTileUrlFunction",ol.source.TileArcGISRest.prototype.setTileUrlFunction);goog.exportProperty(ol.source.TileArcGISRest.prototype,"setUrl",ol.source.TileArcGISRest.prototype.setUrl);goog.exportProperty(ol.source.TileArcGISRest.prototype,"setUrls",ol.source.TileArcGISRest.prototype.setUrls);goog.exportProperty(ol.source.TileArcGISRest.prototype,"getTileGrid",ol.source.TileArcGISRest.prototype.getTileGrid);goog.exportProperty(ol.source.TileArcGISRest.prototype,"refresh",ol.source.TileArcGISRest.prototype.refresh);goog.exportProperty(ol.source.TileArcGISRest.prototype,"getAttributions",ol.source.TileArcGISRest.prototype.getAttributions);goog.exportProperty(ol.source.TileArcGISRest.prototype,"getLogo",ol.source.TileArcGISRest.prototype.getLogo);goog.exportProperty(ol.source.TileArcGISRest.prototype,"getProjection",ol.source.TileArcGISRest.prototype.getProjection);goog.exportProperty(ol.source.TileArcGISRest.prototype,"getState",ol.source.TileArcGISRest.prototype.getState);goog.exportProperty(ol.source.TileArcGISRest.prototype,"setAttributions",ol.source.TileArcGISRest.prototype.setAttributions);goog.exportProperty(ol.source.TileArcGISRest.prototype,"get",ol.source.TileArcGISRest.prototype.get);goog.exportProperty(ol.source.TileArcGISRest.prototype,"getKeys",ol.source.TileArcGISRest.prototype.getKeys);goog.exportProperty(ol.source.TileArcGISRest.prototype,"getProperties",ol.source.TileArcGISRest.prototype.getProperties);goog.exportProperty(ol.source.TileArcGISRest.prototype,"set",ol.source.TileArcGISRest.prototype.set);goog.exportProperty(ol.source.TileArcGISRest.prototype,"setProperties",ol.source.TileArcGISRest.prototype.setProperties);goog.exportProperty(ol.source.TileArcGISRest.prototype,"unset",ol.source.TileArcGISRest.prototype.unset);goog.exportProperty(ol.source.TileArcGISRest.prototype,"changed",ol.source.TileArcGISRest.prototype.changed);goog.exportProperty(ol.source.TileArcGISRest.prototype,"dispatchEvent",ol.source.TileArcGISRest.prototype.dispatchEvent);goog.exportProperty(ol.source.TileArcGISRest.prototype,"getRevision",ol.source.TileArcGISRest.prototype.getRevision);goog.exportProperty(ol.source.TileArcGISRest.prototype,"on",ol.source.TileArcGISRest.prototype.on);goog.exportProperty(ol.source.TileArcGISRest.prototype,"once",ol.source.TileArcGISRest.prototype.once);goog.exportProperty(ol.source.TileArcGISRest.prototype,"un",ol.source.TileArcGISRest.prototype.un);goog.exportProperty(ol.source.TileDebug.prototype,"getTileGrid",ol.source.TileDebug.prototype.getTileGrid);goog.exportProperty(ol.source.TileDebug.prototype,"refresh",ol.source.TileDebug.prototype.refresh);goog.exportProperty(ol.source.TileDebug.prototype,"getAttributions",ol.source.TileDebug.prototype.getAttributions);goog.exportProperty(ol.source.TileDebug.prototype,"getLogo",ol.source.TileDebug.prototype.getLogo);goog.exportProperty(ol.source.TileDebug.prototype,"getProjection",ol.source.TileDebug.prototype.getProjection);goog.exportProperty(ol.source.TileDebug.prototype,"getState",ol.source.TileDebug.prototype.getState);goog.exportProperty(ol.source.TileDebug.prototype,"setAttributions",ol.source.TileDebug.prototype.setAttributions);goog.exportProperty(ol.source.TileDebug.prototype,"get",ol.source.TileDebug.prototype.get);goog.exportProperty(ol.source.TileDebug.prototype,"getKeys",ol.source.TileDebug.prototype.getKeys);goog.exportProperty(ol.source.TileDebug.prototype,"getProperties",ol.source.TileDebug.prototype.getProperties);goog.exportProperty(ol.source.TileDebug.prototype,"set",ol.source.TileDebug.prototype.set);goog.exportProperty(ol.source.TileDebug.prototype,"setProperties",ol.source.TileDebug.prototype.setProperties);goog.exportProperty(ol.source.TileDebug.prototype,"unset",ol.source.TileDebug.prototype.unset);goog.exportProperty(ol.source.TileDebug.prototype,"changed",ol.source.TileDebug.prototype.changed);goog.exportProperty(ol.source.TileDebug.prototype,"dispatchEvent",ol.source.TileDebug.prototype.dispatchEvent);goog.exportProperty(ol.source.TileDebug.prototype,"getRevision",ol.source.TileDebug.prototype.getRevision);goog.exportProperty(ol.source.TileDebug.prototype,"on",ol.source.TileDebug.prototype.on);goog.exportProperty(ol.source.TileDebug.prototype,"once",ol.source.TileDebug.prototype.once);goog.exportProperty(ol.source.TileDebug.prototype,"un",ol.source.TileDebug.prototype.un);goog.exportProperty(ol.source.TileJSON.prototype,"setRenderReprojectionEdges",ol.source.TileJSON.prototype.setRenderReprojectionEdges);goog.exportProperty(ol.source.TileJSON.prototype,"setTileGridForProjection",ol.source.TileJSON.prototype.setTileGridForProjection);goog.exportProperty(ol.source.TileJSON.prototype,"getTileLoadFunction",ol.source.TileJSON.prototype.getTileLoadFunction);goog.exportProperty(ol.source.TileJSON.prototype,"getTileUrlFunction",ol.source.TileJSON.prototype.getTileUrlFunction);goog.exportProperty(ol.source.TileJSON.prototype,"getUrls",ol.source.TileJSON.prototype.getUrls);goog.exportProperty(ol.source.TileJSON.prototype,"setTileLoadFunction",ol.source.TileJSON.prototype.setTileLoadFunction);goog.exportProperty(ol.source.TileJSON.prototype,"setTileUrlFunction",ol.source.TileJSON.prototype.setTileUrlFunction);goog.exportProperty(ol.source.TileJSON.prototype,"setUrl",ol.source.TileJSON.prototype.setUrl);goog.exportProperty(ol.source.TileJSON.prototype,"setUrls",ol.source.TileJSON.prototype.setUrls);goog.exportProperty(ol.source.TileJSON.prototype,"getTileGrid",ol.source.TileJSON.prototype.getTileGrid);goog.exportProperty(ol.source.TileJSON.prototype,"refresh",ol.source.TileJSON.prototype.refresh);goog.exportProperty(ol.source.TileJSON.prototype,"getAttributions",ol.source.TileJSON.prototype.getAttributions);goog.exportProperty(ol.source.TileJSON.prototype,"getLogo",ol.source.TileJSON.prototype.getLogo);goog.exportProperty(ol.source.TileJSON.prototype,"getProjection",ol.source.TileJSON.prototype.getProjection);goog.exportProperty(ol.source.TileJSON.prototype,"getState",ol.source.TileJSON.prototype.getState);goog.exportProperty(ol.source.TileJSON.prototype,"setAttributions",ol.source.TileJSON.prototype.setAttributions);goog.exportProperty(ol.source.TileJSON.prototype,"get",ol.source.TileJSON.prototype.get);goog.exportProperty(ol.source.TileJSON.prototype,"getKeys",ol.source.TileJSON.prototype.getKeys);goog.exportProperty(ol.source.TileJSON.prototype,"getProperties",ol.source.TileJSON.prototype.getProperties);goog.exportProperty(ol.source.TileJSON.prototype,"set",ol.source.TileJSON.prototype.set);goog.exportProperty(ol.source.TileJSON.prototype,"setProperties",ol.source.TileJSON.prototype.setProperties);goog.exportProperty(ol.source.TileJSON.prototype,"unset",ol.source.TileJSON.prototype.unset);goog.exportProperty(ol.source.TileJSON.prototype,"changed",ol.source.TileJSON.prototype.changed);goog.exportProperty(ol.source.TileJSON.prototype,"dispatchEvent",ol.source.TileJSON.prototype.dispatchEvent);goog.exportProperty(ol.source.TileJSON.prototype,"getRevision",ol.source.TileJSON.prototype.getRevision);goog.exportProperty(ol.source.TileJSON.prototype,"on",ol.source.TileJSON.prototype.on);goog.exportProperty(ol.source.TileJSON.prototype,"once",ol.source.TileJSON.prototype.once);goog.exportProperty(ol.source.TileJSON.prototype,"un",ol.source.TileJSON.prototype.un);goog.exportProperty(ol.source.TileUTFGrid.prototype,"getTileGrid",ol.source.TileUTFGrid.prototype.getTileGrid);goog.exportProperty(ol.source.TileUTFGrid.prototype,"refresh",ol.source.TileUTFGrid.prototype.refresh);goog.exportProperty(ol.source.TileUTFGrid.prototype,"getAttributions",ol.source.TileUTFGrid.prototype.getAttributions);goog.exportProperty(ol.source.TileUTFGrid.prototype,"getLogo",ol.source.TileUTFGrid.prototype.getLogo);goog.exportProperty(ol.source.TileUTFGrid.prototype,"getProjection",ol.source.TileUTFGrid.prototype.getProjection);goog.exportProperty(ol.source.TileUTFGrid.prototype,"getState",ol.source.TileUTFGrid.prototype.getState);goog.exportProperty(ol.source.TileUTFGrid.prototype,"setAttributions",ol.source.TileUTFGrid.prototype.setAttributions);goog.exportProperty(ol.source.TileUTFGrid.prototype,"get",ol.source.TileUTFGrid.prototype.get);goog.exportProperty(ol.source.TileUTFGrid.prototype,"getKeys",ol.source.TileUTFGrid.prototype.getKeys);goog.exportProperty(ol.source.TileUTFGrid.prototype,"getProperties",ol.source.TileUTFGrid.prototype.getProperties);goog.exportProperty(ol.source.TileUTFGrid.prototype,"set",ol.source.TileUTFGrid.prototype.set);goog.exportProperty(ol.source.TileUTFGrid.prototype,"setProperties",ol.source.TileUTFGrid.prototype.setProperties);goog.exportProperty(ol.source.TileUTFGrid.prototype,"unset",ol.source.TileUTFGrid.prototype.unset);goog.exportProperty(ol.source.TileUTFGrid.prototype,"changed",ol.source.TileUTFGrid.prototype.changed);goog.exportProperty(ol.source.TileUTFGrid.prototype,"dispatchEvent",ol.source.TileUTFGrid.prototype.dispatchEvent);goog.exportProperty(ol.source.TileUTFGrid.prototype,"getRevision",ol.source.TileUTFGrid.prototype.getRevision);goog.exportProperty(ol.source.TileUTFGrid.prototype,"on",ol.source.TileUTFGrid.prototype.on);goog.exportProperty(ol.source.TileUTFGrid.prototype,"once",ol.source.TileUTFGrid.prototype.once);goog.exportProperty(ol.source.TileUTFGrid.prototype,"un",ol.source.TileUTFGrid.prototype.un);goog.exportProperty(ol.source.TileWMS.prototype,"setRenderReprojectionEdges",ol.source.TileWMS.prototype.setRenderReprojectionEdges);goog.exportProperty(ol.source.TileWMS.prototype,"setTileGridForProjection",ol.source.TileWMS.prototype.setTileGridForProjection);goog.exportProperty(ol.source.TileWMS.prototype,"getTileLoadFunction",ol.source.TileWMS.prototype.getTileLoadFunction);goog.exportProperty(ol.source.TileWMS.prototype,"getTileUrlFunction",ol.source.TileWMS.prototype.getTileUrlFunction);goog.exportProperty(ol.source.TileWMS.prototype,"getUrls",ol.source.TileWMS.prototype.getUrls);goog.exportProperty(ol.source.TileWMS.prototype,"setTileLoadFunction",ol.source.TileWMS.prototype.setTileLoadFunction);goog.exportProperty(ol.source.TileWMS.prototype,"setTileUrlFunction",ol.source.TileWMS.prototype.setTileUrlFunction);goog.exportProperty(ol.source.TileWMS.prototype,"setUrl",ol.source.TileWMS.prototype.setUrl);goog.exportProperty(ol.source.TileWMS.prototype,"setUrls",ol.source.TileWMS.prototype.setUrls);goog.exportProperty(ol.source.TileWMS.prototype,"getTileGrid",ol.source.TileWMS.prototype.getTileGrid);goog.exportProperty(ol.source.TileWMS.prototype,"refresh",ol.source.TileWMS.prototype.refresh);goog.exportProperty(ol.source.TileWMS.prototype,"getAttributions",ol.source.TileWMS.prototype.getAttributions);goog.exportProperty(ol.source.TileWMS.prototype,"getLogo",ol.source.TileWMS.prototype.getLogo);goog.exportProperty(ol.source.TileWMS.prototype,"getProjection",ol.source.TileWMS.prototype.getProjection);goog.exportProperty(ol.source.TileWMS.prototype,"getState",ol.source.TileWMS.prototype.getState);goog.exportProperty(ol.source.TileWMS.prototype,"setAttributions",ol.source.TileWMS.prototype.setAttributions);goog.exportProperty(ol.source.TileWMS.prototype,"get",ol.source.TileWMS.prototype.get);goog.exportProperty(ol.source.TileWMS.prototype,"getKeys",ol.source.TileWMS.prototype.getKeys);goog.exportProperty(ol.source.TileWMS.prototype,"getProperties",ol.source.TileWMS.prototype.getProperties);goog.exportProperty(ol.source.TileWMS.prototype,"set",ol.source.TileWMS.prototype.set);goog.exportProperty(ol.source.TileWMS.prototype,"setProperties",ol.source.TileWMS.prototype.setProperties);goog.exportProperty(ol.source.TileWMS.prototype,"unset",ol.source.TileWMS.prototype.unset);goog.exportProperty(ol.source.TileWMS.prototype,"changed",ol.source.TileWMS.prototype.changed);goog.exportProperty(ol.source.TileWMS.prototype,"dispatchEvent",ol.source.TileWMS.prototype.dispatchEvent);goog.exportProperty(ol.source.TileWMS.prototype,"getRevision",ol.source.TileWMS.prototype.getRevision);goog.exportProperty(ol.source.TileWMS.prototype,"on",ol.source.TileWMS.prototype.on);goog.exportProperty(ol.source.TileWMS.prototype,"once",ol.source.TileWMS.prototype.once);goog.exportProperty(ol.source.TileWMS.prototype,"un",ol.source.TileWMS.prototype.un);goog.exportProperty(ol.source.Vector.Event.prototype,"type",ol.source.Vector.Event.prototype.type);goog.exportProperty(ol.source.Vector.Event.prototype,"target",ol.source.Vector.Event.prototype.target);goog.exportProperty(ol.source.Vector.Event.prototype,"preventDefault",ol.source.Vector.Event.prototype.preventDefault);goog.exportProperty(ol.source.Vector.Event.prototype,"stopPropagation",ol.source.Vector.Event.prototype.stopPropagation);goog.exportProperty(ol.source.VectorTile.prototype,"getTileLoadFunction",ol.source.VectorTile.prototype.getTileLoadFunction);goog.exportProperty(ol.source.VectorTile.prototype,"getTileUrlFunction",ol.source.VectorTile.prototype.getTileUrlFunction);goog.exportProperty(ol.source.VectorTile.prototype,"getUrls",ol.source.VectorTile.prototype.getUrls);goog.exportProperty(ol.source.VectorTile.prototype,"setTileLoadFunction",ol.source.VectorTile.prototype.setTileLoadFunction);goog.exportProperty(ol.source.VectorTile.prototype,"setTileUrlFunction",ol.source.VectorTile.prototype.setTileUrlFunction);goog.exportProperty(ol.source.VectorTile.prototype,"setUrl",ol.source.VectorTile.prototype.setUrl);goog.exportProperty(ol.source.VectorTile.prototype,"setUrls",ol.source.VectorTile.prototype.setUrls);goog.exportProperty(ol.source.VectorTile.prototype,"getTileGrid",ol.source.VectorTile.prototype.getTileGrid);goog.exportProperty(ol.source.VectorTile.prototype,"refresh",ol.source.VectorTile.prototype.refresh);goog.exportProperty(ol.source.VectorTile.prototype,"getAttributions",ol.source.VectorTile.prototype.getAttributions);goog.exportProperty(ol.source.VectorTile.prototype,"getLogo",ol.source.VectorTile.prototype.getLogo);goog.exportProperty(ol.source.VectorTile.prototype,"getProjection",ol.source.VectorTile.prototype.getProjection);goog.exportProperty(ol.source.VectorTile.prototype,"getState",ol.source.VectorTile.prototype.getState);goog.exportProperty(ol.source.VectorTile.prototype,"setAttributions",ol.source.VectorTile.prototype.setAttributions);goog.exportProperty(ol.source.VectorTile.prototype,"get",ol.source.VectorTile.prototype.get);goog.exportProperty(ol.source.VectorTile.prototype,"getKeys",ol.source.VectorTile.prototype.getKeys);goog.exportProperty(ol.source.VectorTile.prototype,"getProperties",ol.source.VectorTile.prototype.getProperties);goog.exportProperty(ol.source.VectorTile.prototype,"set",ol.source.VectorTile.prototype.set);goog.exportProperty(ol.source.VectorTile.prototype,"setProperties",ol.source.VectorTile.prototype.setProperties);goog.exportProperty(ol.source.VectorTile.prototype,"unset",ol.source.VectorTile.prototype.unset);goog.exportProperty(ol.source.VectorTile.prototype,"changed",ol.source.VectorTile.prototype.changed);goog.exportProperty(ol.source.VectorTile.prototype,"dispatchEvent",ol.source.VectorTile.prototype.dispatchEvent);goog.exportProperty(ol.source.VectorTile.prototype,"getRevision",ol.source.VectorTile.prototype.getRevision);goog.exportProperty(ol.source.VectorTile.prototype,"on",ol.source.VectorTile.prototype.on);goog.exportProperty(ol.source.VectorTile.prototype,"once",ol.source.VectorTile.prototype.once);goog.exportProperty(ol.source.VectorTile.prototype,"un",ol.source.VectorTile.prototype.un);goog.exportProperty(ol.source.WMTS.prototype,"setRenderReprojectionEdges",ol.source.WMTS.prototype.setRenderReprojectionEdges);goog.exportProperty(ol.source.WMTS.prototype,"setTileGridForProjection",ol.source.WMTS.prototype.setTileGridForProjection);goog.exportProperty(ol.source.WMTS.prototype,"getTileLoadFunction",ol.source.WMTS.prototype.getTileLoadFunction);goog.exportProperty(ol.source.WMTS.prototype,"getTileUrlFunction",ol.source.WMTS.prototype.getTileUrlFunction);goog.exportProperty(ol.source.WMTS.prototype,"getUrls",ol.source.WMTS.prototype.getUrls);goog.exportProperty(ol.source.WMTS.prototype,"setTileLoadFunction",ol.source.WMTS.prototype.setTileLoadFunction);goog.exportProperty(ol.source.WMTS.prototype,"setTileUrlFunction",ol.source.WMTS.prototype.setTileUrlFunction);goog.exportProperty(ol.source.WMTS.prototype,"setUrl",ol.source.WMTS.prototype.setUrl);goog.exportProperty(ol.source.WMTS.prototype,"setUrls",ol.source.WMTS.prototype.setUrls);goog.exportProperty(ol.source.WMTS.prototype,"getTileGrid",ol.source.WMTS.prototype.getTileGrid);goog.exportProperty(ol.source.WMTS.prototype,"refresh",ol.source.WMTS.prototype.refresh);goog.exportProperty(ol.source.WMTS.prototype,"getAttributions",ol.source.WMTS.prototype.getAttributions);goog.exportProperty(ol.source.WMTS.prototype,"getLogo",ol.source.WMTS.prototype.getLogo);goog.exportProperty(ol.source.WMTS.prototype,"getProjection",ol.source.WMTS.prototype.getProjection);goog.exportProperty(ol.source.WMTS.prototype,"getState",ol.source.WMTS.prototype.getState);goog.exportProperty(ol.source.WMTS.prototype,"setAttributions",ol.source.WMTS.prototype.setAttributions);goog.exportProperty(ol.source.WMTS.prototype,"get",ol.source.WMTS.prototype.get);goog.exportProperty(ol.source.WMTS.prototype,"getKeys",ol.source.WMTS.prototype.getKeys);goog.exportProperty(ol.source.WMTS.prototype,"getProperties",ol.source.WMTS.prototype.getProperties);goog.exportProperty(ol.source.WMTS.prototype,"set",ol.source.WMTS.prototype.set);goog.exportProperty(ol.source.WMTS.prototype,"setProperties",ol.source.WMTS.prototype.setProperties);goog.exportProperty(ol.source.WMTS.prototype,"unset",ol.source.WMTS.prototype.unset);goog.exportProperty(ol.source.WMTS.prototype,"changed",ol.source.WMTS.prototype.changed);goog.exportProperty(ol.source.WMTS.prototype,"dispatchEvent",ol.source.WMTS.prototype.dispatchEvent);goog.exportProperty(ol.source.WMTS.prototype,"getRevision",ol.source.WMTS.prototype.getRevision);goog.exportProperty(ol.source.WMTS.prototype,"on",ol.source.WMTS.prototype.on);goog.exportProperty(ol.source.WMTS.prototype,"once",ol.source.WMTS.prototype.once);goog.exportProperty(ol.source.WMTS.prototype,"un",ol.source.WMTS.prototype.un);goog.exportProperty(ol.source.Zoomify.prototype,"setRenderReprojectionEdges",ol.source.Zoomify.prototype.setRenderReprojectionEdges);goog.exportProperty(ol.source.Zoomify.prototype,"setTileGridForProjection",ol.source.Zoomify.prototype.setTileGridForProjection);goog.exportProperty(ol.source.Zoomify.prototype,"getTileLoadFunction",ol.source.Zoomify.prototype.getTileLoadFunction);goog.exportProperty(ol.source.Zoomify.prototype,"getTileUrlFunction",ol.source.Zoomify.prototype.getTileUrlFunction);goog.exportProperty(ol.source.Zoomify.prototype,"getUrls",ol.source.Zoomify.prototype.getUrls);goog.exportProperty(ol.source.Zoomify.prototype,"setTileLoadFunction",ol.source.Zoomify.prototype.setTileLoadFunction);goog.exportProperty(ol.source.Zoomify.prototype,"setTileUrlFunction",ol.source.Zoomify.prototype.setTileUrlFunction);goog.exportProperty(ol.source.Zoomify.prototype,"setUrl",ol.source.Zoomify.prototype.setUrl);goog.exportProperty(ol.source.Zoomify.prototype,"setUrls",ol.source.Zoomify.prototype.setUrls);goog.exportProperty(ol.source.Zoomify.prototype,"getTileGrid",ol.source.Zoomify.prototype.getTileGrid);goog.exportProperty(ol.source.Zoomify.prototype,"refresh",ol.source.Zoomify.prototype.refresh);goog.exportProperty(ol.source.Zoomify.prototype,"getAttributions",ol.source.Zoomify.prototype.getAttributions);goog.exportProperty(ol.source.Zoomify.prototype,"getLogo",ol.source.Zoomify.prototype.getLogo);goog.exportProperty(ol.source.Zoomify.prototype,"getProjection",ol.source.Zoomify.prototype.getProjection);goog.exportProperty(ol.source.Zoomify.prototype,"getState",ol.source.Zoomify.prototype.getState);goog.exportProperty(ol.source.Zoomify.prototype,"setAttributions",ol.source.Zoomify.prototype.setAttributions);goog.exportProperty(ol.source.Zoomify.prototype,"get",ol.source.Zoomify.prototype.get);goog.exportProperty(ol.source.Zoomify.prototype,"getKeys",ol.source.Zoomify.prototype.getKeys);goog.exportProperty(ol.source.Zoomify.prototype,"getProperties",ol.source.Zoomify.prototype.getProperties);goog.exportProperty(ol.source.Zoomify.prototype,"set",ol.source.Zoomify.prototype.set);goog.exportProperty(ol.source.Zoomify.prototype,"setProperties",ol.source.Zoomify.prototype.setProperties);goog.exportProperty(ol.source.Zoomify.prototype,"unset",ol.source.Zoomify.prototype.unset);goog.exportProperty(ol.source.Zoomify.prototype,"changed",ol.source.Zoomify.prototype.changed);goog.exportProperty(ol.source.Zoomify.prototype,"dispatchEvent",ol.source.Zoomify.prototype.dispatchEvent);goog.exportProperty(ol.source.Zoomify.prototype,"getRevision",ol.source.Zoomify.prototype.getRevision);goog.exportProperty(ol.source.Zoomify.prototype,"on",ol.source.Zoomify.prototype.on);goog.exportProperty(ol.source.Zoomify.prototype,"once",ol.source.Zoomify.prototype.once);goog.exportProperty(ol.source.Zoomify.prototype,"un",ol.source.Zoomify.prototype.un);goog.exportProperty(ol.reproj.Tile.prototype,"getTileCoord",ol.reproj.Tile.prototype.getTileCoord);goog.exportProperty(ol.reproj.Tile.prototype,"load",ol.reproj.Tile.prototype.load);goog.exportProperty(ol.renderer.Layer.prototype,"changed",ol.renderer.Layer.prototype.changed);goog.exportProperty(ol.renderer.Layer.prototype,"dispatchEvent",ol.renderer.Layer.prototype.dispatchEvent);goog.exportProperty(ol.renderer.Layer.prototype,"getRevision",ol.renderer.Layer.prototype.getRevision);goog.exportProperty(ol.renderer.Layer.prototype,"on",ol.renderer.Layer.prototype.on);goog.exportProperty(ol.renderer.Layer.prototype,"once",ol.renderer.Layer.prototype.once);goog.exportProperty(ol.renderer.Layer.prototype,"un",ol.renderer.Layer.prototype.un);goog.exportProperty(ol.renderer.webgl.Layer.prototype,"changed",ol.renderer.webgl.Layer.prototype.changed);goog.exportProperty(ol.renderer.webgl.Layer.prototype,"dispatchEvent",ol.renderer.webgl.Layer.prototype.dispatchEvent);goog.exportProperty(ol.renderer.webgl.Layer.prototype,"getRevision",ol.renderer.webgl.Layer.prototype.getRevision);goog.exportProperty(ol.renderer.webgl.Layer.prototype,"on",ol.renderer.webgl.Layer.prototype.on);goog.exportProperty(ol.renderer.webgl.Layer.prototype,"once",ol.renderer.webgl.Layer.prototype.once);goog.exportProperty(ol.renderer.webgl.Layer.prototype,"un",ol.renderer.webgl.Layer.prototype.un);goog.exportProperty(ol.renderer.webgl.ImageLayer.prototype,"changed",ol.renderer.webgl.ImageLayer.prototype.changed);goog.exportProperty(ol.renderer.webgl.ImageLayer.prototype,"dispatchEvent",ol.renderer.webgl.ImageLayer.prototype.dispatchEvent);goog.exportProperty(ol.renderer.webgl.ImageLayer.prototype,"getRevision",ol.renderer.webgl.ImageLayer.prototype.getRevision);goog.exportProperty(ol.renderer.webgl.ImageLayer.prototype,"on",ol.renderer.webgl.ImageLayer.prototype.on);goog.exportProperty(ol.renderer.webgl.ImageLayer.prototype,"once",ol.renderer.webgl.ImageLayer.prototype.once);goog.exportProperty(ol.renderer.webgl.ImageLayer.prototype,"un",ol.renderer.webgl.ImageLayer.prototype.un);goog.exportProperty(ol.renderer.webgl.TileLayer.prototype,"changed",ol.renderer.webgl.TileLayer.prototype.changed);goog.exportProperty(ol.renderer.webgl.TileLayer.prototype,"dispatchEvent",ol.renderer.webgl.TileLayer.prototype.dispatchEvent);goog.exportProperty(ol.renderer.webgl.TileLayer.prototype,"getRevision",ol.renderer.webgl.TileLayer.prototype.getRevision);goog.exportProperty(ol.renderer.webgl.TileLayer.prototype,"on",ol.renderer.webgl.TileLayer.prototype.on);goog.exportProperty(ol.renderer.webgl.TileLayer.prototype,"once",ol.renderer.webgl.TileLayer.prototype.once);goog.exportProperty(ol.renderer.webgl.TileLayer.prototype,"un",ol.renderer.webgl.TileLayer.prototype.un);goog.exportProperty(ol.renderer.webgl.VectorLayer.prototype,"changed",ol.renderer.webgl.VectorLayer.prototype.changed);goog.exportProperty(ol.renderer.webgl.VectorLayer.prototype,"dispatchEvent",ol.renderer.webgl.VectorLayer.prototype.dispatchEvent);goog.exportProperty(ol.renderer.webgl.VectorLayer.prototype,"getRevision",ol.renderer.webgl.VectorLayer.prototype.getRevision);goog.exportProperty(ol.renderer.webgl.VectorLayer.prototype,"on",ol.renderer.webgl.VectorLayer.prototype.on);goog.exportProperty(ol.renderer.webgl.VectorLayer.prototype,"once",ol.renderer.webgl.VectorLayer.prototype.once);goog.exportProperty(ol.renderer.webgl.VectorLayer.prototype,"un",ol.renderer.webgl.VectorLayer.prototype.un);goog.exportProperty(ol.renderer.canvas.Layer.prototype,"changed",ol.renderer.canvas.Layer.prototype.changed);goog.exportProperty(ol.renderer.canvas.Layer.prototype,"dispatchEvent",ol.renderer.canvas.Layer.prototype.dispatchEvent);goog.exportProperty(ol.renderer.canvas.Layer.prototype,"getRevision",ol.renderer.canvas.Layer.prototype.getRevision);goog.exportProperty(ol.renderer.canvas.Layer.prototype,"on",ol.renderer.canvas.Layer.prototype.on);goog.exportProperty(ol.renderer.canvas.Layer.prototype,"once",ol.renderer.canvas.Layer.prototype.once);goog.exportProperty(ol.renderer.canvas.Layer.prototype,"un",ol.renderer.canvas.Layer.prototype.un);goog.exportProperty(ol.renderer.canvas.IntermediateCanvas.prototype,"changed",ol.renderer.canvas.IntermediateCanvas.prototype.changed);goog.exportProperty(ol.renderer.canvas.IntermediateCanvas.prototype,"dispatchEvent",ol.renderer.canvas.IntermediateCanvas.prototype.dispatchEvent);goog.exportProperty(ol.renderer.canvas.IntermediateCanvas.prototype,"getRevision",ol.renderer.canvas.IntermediateCanvas.prototype.getRevision);goog.exportProperty(ol.renderer.canvas.IntermediateCanvas.prototype,"on",ol.renderer.canvas.IntermediateCanvas.prototype.on);goog.exportProperty(ol.renderer.canvas.IntermediateCanvas.prototype,"once",ol.renderer.canvas.IntermediateCanvas.prototype.once);goog.exportProperty(ol.renderer.canvas.IntermediateCanvas.prototype,"un",ol.renderer.canvas.IntermediateCanvas.prototype.un);goog.exportProperty(ol.renderer.canvas.ImageLayer.prototype,"changed",ol.renderer.canvas.ImageLayer.prototype.changed);goog.exportProperty(ol.renderer.canvas.ImageLayer.prototype,"dispatchEvent",ol.renderer.canvas.ImageLayer.prototype.dispatchEvent);goog.exportProperty(ol.renderer.canvas.ImageLayer.prototype,"getRevision",ol.renderer.canvas.ImageLayer.prototype.getRevision);goog.exportProperty(ol.renderer.canvas.ImageLayer.prototype,"on",ol.renderer.canvas.ImageLayer.prototype.on);goog.exportProperty(ol.renderer.canvas.ImageLayer.prototype,"once",ol.renderer.canvas.ImageLayer.prototype.once);goog.exportProperty(ol.renderer.canvas.ImageLayer.prototype,"un",ol.renderer.canvas.ImageLayer.prototype.un);goog.exportProperty(ol.renderer.canvas.TileLayer.prototype,"changed",ol.renderer.canvas.TileLayer.prototype.changed);goog.exportProperty(ol.renderer.canvas.TileLayer.prototype,"dispatchEvent",ol.renderer.canvas.TileLayer.prototype.dispatchEvent);goog.exportProperty(ol.renderer.canvas.TileLayer.prototype,"getRevision",ol.renderer.canvas.TileLayer.prototype.getRevision);goog.exportProperty(ol.renderer.canvas.TileLayer.prototype,"on",ol.renderer.canvas.TileLayer.prototype.on);goog.exportProperty(ol.renderer.canvas.TileLayer.prototype,"once",ol.renderer.canvas.TileLayer.prototype.once);goog.exportProperty(ol.renderer.canvas.TileLayer.prototype,"un",ol.renderer.canvas.TileLayer.prototype.un);goog.exportProperty(ol.renderer.canvas.VectorLayer.prototype,"changed",ol.renderer.canvas.VectorLayer.prototype.changed);goog.exportProperty(ol.renderer.canvas.VectorLayer.prototype,"dispatchEvent",ol.renderer.canvas.VectorLayer.prototype.dispatchEvent);goog.exportProperty(ol.renderer.canvas.VectorLayer.prototype,"getRevision",ol.renderer.canvas.VectorLayer.prototype.getRevision);goog.exportProperty(ol.renderer.canvas.VectorLayer.prototype,"on",ol.renderer.canvas.VectorLayer.prototype.on);

goog.exportProperty(ol.renderer.canvas.VectorLayer.prototype,"once",ol.renderer.canvas.VectorLayer.prototype.once);goog.exportProperty(ol.renderer.canvas.VectorLayer.prototype,"un",ol.renderer.canvas.VectorLayer.prototype.un);goog.exportProperty(ol.renderer.canvas.VectorTileLayer.prototype,"changed",ol.renderer.canvas.VectorTileLayer.prototype.changed);goog.exportProperty(ol.renderer.canvas.VectorTileLayer.prototype,"dispatchEvent",ol.renderer.canvas.VectorTileLayer.prototype.dispatchEvent);goog.exportProperty(ol.renderer.canvas.VectorTileLayer.prototype,"getRevision",ol.renderer.canvas.VectorTileLayer.prototype.getRevision);goog.exportProperty(ol.renderer.canvas.VectorTileLayer.prototype,"on",ol.renderer.canvas.VectorTileLayer.prototype.on);goog.exportProperty(ol.renderer.canvas.VectorTileLayer.prototype,"once",ol.renderer.canvas.VectorTileLayer.prototype.once);goog.exportProperty(ol.renderer.canvas.VectorTileLayer.prototype,"un",ol.renderer.canvas.VectorTileLayer.prototype.un);goog.exportProperty(ol.render.Event.prototype,"type",ol.render.Event.prototype.type);goog.exportProperty(ol.render.Event.prototype,"target",ol.render.Event.prototype.target);goog.exportProperty(ol.render.Event.prototype,"preventDefault",ol.render.Event.prototype.preventDefault);goog.exportProperty(ol.render.Event.prototype,"stopPropagation",ol.render.Event.prototype.stopPropagation);goog.exportProperty(ol.pointer.PointerEvent.prototype,"type",ol.pointer.PointerEvent.prototype.type);goog.exportProperty(ol.pointer.PointerEvent.prototype,"target",ol.pointer.PointerEvent.prototype.target);goog.exportProperty(ol.pointer.PointerEvent.prototype,"preventDefault",ol.pointer.PointerEvent.prototype.preventDefault);goog.exportProperty(ol.pointer.PointerEvent.prototype,"stopPropagation",ol.pointer.PointerEvent.prototype.stopPropagation);goog.exportProperty(ol.layer.Base.prototype,"get",ol.layer.Base.prototype.get);goog.exportProperty(ol.layer.Base.prototype,"getKeys",ol.layer.Base.prototype.getKeys);goog.exportProperty(ol.layer.Base.prototype,"getProperties",ol.layer.Base.prototype.getProperties);goog.exportProperty(ol.layer.Base.prototype,"set",ol.layer.Base.prototype.set);goog.exportProperty(ol.layer.Base.prototype,"setProperties",ol.layer.Base.prototype.setProperties);goog.exportProperty(ol.layer.Base.prototype,"unset",ol.layer.Base.prototype.unset);goog.exportProperty(ol.layer.Base.prototype,"changed",ol.layer.Base.prototype.changed);goog.exportProperty(ol.layer.Base.prototype,"dispatchEvent",ol.layer.Base.prototype.dispatchEvent);goog.exportProperty(ol.layer.Base.prototype,"getRevision",ol.layer.Base.prototype.getRevision);goog.exportProperty(ol.layer.Base.prototype,"on",ol.layer.Base.prototype.on);goog.exportProperty(ol.layer.Base.prototype,"once",ol.layer.Base.prototype.once);goog.exportProperty(ol.layer.Base.prototype,"un",ol.layer.Base.prototype.un);goog.exportProperty(ol.layer.Group.prototype,"getExtent",ol.layer.Group.prototype.getExtent);goog.exportProperty(ol.layer.Group.prototype,"getMaxResolution",ol.layer.Group.prototype.getMaxResolution);goog.exportProperty(ol.layer.Group.prototype,"getMinResolution",ol.layer.Group.prototype.getMinResolution);goog.exportProperty(ol.layer.Group.prototype,"getOpacity",ol.layer.Group.prototype.getOpacity);goog.exportProperty(ol.layer.Group.prototype,"getVisible",ol.layer.Group.prototype.getVisible);goog.exportProperty(ol.layer.Group.prototype,"getZIndex",ol.layer.Group.prototype.getZIndex);goog.exportProperty(ol.layer.Group.prototype,"setExtent",ol.layer.Group.prototype.setExtent);goog.exportProperty(ol.layer.Group.prototype,"setMaxResolution",ol.layer.Group.prototype.setMaxResolution);goog.exportProperty(ol.layer.Group.prototype,"setMinResolution",ol.layer.Group.prototype.setMinResolution);goog.exportProperty(ol.layer.Group.prototype,"setOpacity",ol.layer.Group.prototype.setOpacity);goog.exportProperty(ol.layer.Group.prototype,"setVisible",ol.layer.Group.prototype.setVisible);goog.exportProperty(ol.layer.Group.prototype,"setZIndex",ol.layer.Group.prototype.setZIndex);goog.exportProperty(ol.layer.Group.prototype,"get",ol.layer.Group.prototype.get);goog.exportProperty(ol.layer.Group.prototype,"getKeys",ol.layer.Group.prototype.getKeys);goog.exportProperty(ol.layer.Group.prototype,"getProperties",ol.layer.Group.prototype.getProperties);goog.exportProperty(ol.layer.Group.prototype,"set",ol.layer.Group.prototype.set);goog.exportProperty(ol.layer.Group.prototype,"setProperties",ol.layer.Group.prototype.setProperties);goog.exportProperty(ol.layer.Group.prototype,"unset",ol.layer.Group.prototype.unset);goog.exportProperty(ol.layer.Group.prototype,"changed",ol.layer.Group.prototype.changed);goog.exportProperty(ol.layer.Group.prototype,"dispatchEvent",ol.layer.Group.prototype.dispatchEvent);goog.exportProperty(ol.layer.Group.prototype,"getRevision",ol.layer.Group.prototype.getRevision);goog.exportProperty(ol.layer.Group.prototype,"on",ol.layer.Group.prototype.on);goog.exportProperty(ol.layer.Group.prototype,"once",ol.layer.Group.prototype.once);goog.exportProperty(ol.layer.Group.prototype,"un",ol.layer.Group.prototype.un);goog.exportProperty(ol.layer.Layer.prototype,"getExtent",ol.layer.Layer.prototype.getExtent);goog.exportProperty(ol.layer.Layer.prototype,"getMaxResolution",ol.layer.Layer.prototype.getMaxResolution);goog.exportProperty(ol.layer.Layer.prototype,"getMinResolution",ol.layer.Layer.prototype.getMinResolution);goog.exportProperty(ol.layer.Layer.prototype,"getOpacity",ol.layer.Layer.prototype.getOpacity);goog.exportProperty(ol.layer.Layer.prototype,"getVisible",ol.layer.Layer.prototype.getVisible);goog.exportProperty(ol.layer.Layer.prototype,"getZIndex",ol.layer.Layer.prototype.getZIndex);goog.exportProperty(ol.layer.Layer.prototype,"setExtent",ol.layer.Layer.prototype.setExtent);goog.exportProperty(ol.layer.Layer.prototype,"setMaxResolution",ol.layer.Layer.prototype.setMaxResolution);goog.exportProperty(ol.layer.Layer.prototype,"setMinResolution",ol.layer.Layer.prototype.setMinResolution);goog.exportProperty(ol.layer.Layer.prototype,"setOpacity",ol.layer.Layer.prototype.setOpacity);goog.exportProperty(ol.layer.Layer.prototype,"setVisible",ol.layer.Layer.prototype.setVisible);goog.exportProperty(ol.layer.Layer.prototype,"setZIndex",ol.layer.Layer.prototype.setZIndex);goog.exportProperty(ol.layer.Layer.prototype,"get",ol.layer.Layer.prototype.get);goog.exportProperty(ol.layer.Layer.prototype,"getKeys",ol.layer.Layer.prototype.getKeys);goog.exportProperty(ol.layer.Layer.prototype,"getProperties",ol.layer.Layer.prototype.getProperties);goog.exportProperty(ol.layer.Layer.prototype,"set",ol.layer.Layer.prototype.set);goog.exportProperty(ol.layer.Layer.prototype,"setProperties",ol.layer.Layer.prototype.setProperties);goog.exportProperty(ol.layer.Layer.prototype,"unset",ol.layer.Layer.prototype.unset);goog.exportProperty(ol.layer.Layer.prototype,"changed",ol.layer.Layer.prototype.changed);goog.exportProperty(ol.layer.Layer.prototype,"dispatchEvent",ol.layer.Layer.prototype.dispatchEvent);goog.exportProperty(ol.layer.Layer.prototype,"getRevision",ol.layer.Layer.prototype.getRevision);goog.exportProperty(ol.layer.Layer.prototype,"on",ol.layer.Layer.prototype.on);goog.exportProperty(ol.layer.Layer.prototype,"once",ol.layer.Layer.prototype.once);goog.exportProperty(ol.layer.Layer.prototype,"un",ol.layer.Layer.prototype.un);goog.exportProperty(ol.layer.Vector.prototype,"setMap",ol.layer.Vector.prototype.setMap);goog.exportProperty(ol.layer.Vector.prototype,"setSource",ol.layer.Vector.prototype.setSource);goog.exportProperty(ol.layer.Vector.prototype,"getExtent",ol.layer.Vector.prototype.getExtent);goog.exportProperty(ol.layer.Vector.prototype,"getMaxResolution",ol.layer.Vector.prototype.getMaxResolution);goog.exportProperty(ol.layer.Vector.prototype,"getMinResolution",ol.layer.Vector.prototype.getMinResolution);goog.exportProperty(ol.layer.Vector.prototype,"getOpacity",ol.layer.Vector.prototype.getOpacity);goog.exportProperty(ol.layer.Vector.prototype,"getVisible",ol.layer.Vector.prototype.getVisible);goog.exportProperty(ol.layer.Vector.prototype,"getZIndex",ol.layer.Vector.prototype.getZIndex);goog.exportProperty(ol.layer.Vector.prototype,"setExtent",ol.layer.Vector.prototype.setExtent);goog.exportProperty(ol.layer.Vector.prototype,"setMaxResolution",ol.layer.Vector.prototype.setMaxResolution);goog.exportProperty(ol.layer.Vector.prototype,"setMinResolution",ol.layer.Vector.prototype.setMinResolution);goog.exportProperty(ol.layer.Vector.prototype,"setOpacity",ol.layer.Vector.prototype.setOpacity);goog.exportProperty(ol.layer.Vector.prototype,"setVisible",ol.layer.Vector.prototype.setVisible);goog.exportProperty(ol.layer.Vector.prototype,"setZIndex",ol.layer.Vector.prototype.setZIndex);goog.exportProperty(ol.layer.Vector.prototype,"get",ol.layer.Vector.prototype.get);goog.exportProperty(ol.layer.Vector.prototype,"getKeys",ol.layer.Vector.prototype.getKeys);goog.exportProperty(ol.layer.Vector.prototype,"getProperties",ol.layer.Vector.prototype.getProperties);goog.exportProperty(ol.layer.Vector.prototype,"set",ol.layer.Vector.prototype.set);goog.exportProperty(ol.layer.Vector.prototype,"setProperties",ol.layer.Vector.prototype.setProperties);goog.exportProperty(ol.layer.Vector.prototype,"unset",ol.layer.Vector.prototype.unset);goog.exportProperty(ol.layer.Vector.prototype,"changed",ol.layer.Vector.prototype.changed);goog.exportProperty(ol.layer.Vector.prototype,"dispatchEvent",ol.layer.Vector.prototype.dispatchEvent);goog.exportProperty(ol.layer.Vector.prototype,"getRevision",ol.layer.Vector.prototype.getRevision);goog.exportProperty(ol.layer.Vector.prototype,"on",ol.layer.Vector.prototype.on);goog.exportProperty(ol.layer.Vector.prototype,"once",ol.layer.Vector.prototype.once);goog.exportProperty(ol.layer.Vector.prototype,"un",ol.layer.Vector.prototype.un);goog.exportProperty(ol.layer.Heatmap.prototype,"getSource",ol.layer.Heatmap.prototype.getSource);goog.exportProperty(ol.layer.Heatmap.prototype,"getStyle",ol.layer.Heatmap.prototype.getStyle);goog.exportProperty(ol.layer.Heatmap.prototype,"getStyleFunction",ol.layer.Heatmap.prototype.getStyleFunction);goog.exportProperty(ol.layer.Heatmap.prototype,"setStyle",ol.layer.Heatmap.prototype.setStyle);goog.exportProperty(ol.layer.Heatmap.prototype,"setMap",ol.layer.Heatmap.prototype.setMap);goog.exportProperty(ol.layer.Heatmap.prototype,"setSource",ol.layer.Heatmap.prototype.setSource);goog.exportProperty(ol.layer.Heatmap.prototype,"getExtent",ol.layer.Heatmap.prototype.getExtent);goog.exportProperty(ol.layer.Heatmap.prototype,"getMaxResolution",ol.layer.Heatmap.prototype.getMaxResolution);goog.exportProperty(ol.layer.Heatmap.prototype,"getMinResolution",ol.layer.Heatmap.prototype.getMinResolution);goog.exportProperty(ol.layer.Heatmap.prototype,"getOpacity",ol.layer.Heatmap.prototype.getOpacity);goog.exportProperty(ol.layer.Heatmap.prototype,"getVisible",ol.layer.Heatmap.prototype.getVisible);goog.exportProperty(ol.layer.Heatmap.prototype,"getZIndex",ol.layer.Heatmap.prototype.getZIndex);goog.exportProperty(ol.layer.Heatmap.prototype,"setExtent",ol.layer.Heatmap.prototype.setExtent);goog.exportProperty(ol.layer.Heatmap.prototype,"setMaxResolution",ol.layer.Heatmap.prototype.setMaxResolution);goog.exportProperty(ol.layer.Heatmap.prototype,"setMinResolution",ol.layer.Heatmap.prototype.setMinResolution);goog.exportProperty(ol.layer.Heatmap.prototype,"setOpacity",ol.layer.Heatmap.prototype.setOpacity);goog.exportProperty(ol.layer.Heatmap.prototype,"setVisible",ol.layer.Heatmap.prototype.setVisible);goog.exportProperty(ol.layer.Heatmap.prototype,"setZIndex",ol.layer.Heatmap.prototype.setZIndex);goog.exportProperty(ol.layer.Heatmap.prototype,"get",ol.layer.Heatmap.prototype.get);goog.exportProperty(ol.layer.Heatmap.prototype,"getKeys",ol.layer.Heatmap.prototype.getKeys);goog.exportProperty(ol.layer.Heatmap.prototype,"getProperties",ol.layer.Heatmap.prototype.getProperties);goog.exportProperty(ol.layer.Heatmap.prototype,"set",ol.layer.Heatmap.prototype.set);goog.exportProperty(ol.layer.Heatmap.prototype,"setProperties",ol.layer.Heatmap.prototype.setProperties);goog.exportProperty(ol.layer.Heatmap.prototype,"unset",ol.layer.Heatmap.prototype.unset);goog.exportProperty(ol.layer.Heatmap.prototype,"changed",ol.layer.Heatmap.prototype.changed);goog.exportProperty(ol.layer.Heatmap.prototype,"dispatchEvent",ol.layer.Heatmap.prototype.dispatchEvent);goog.exportProperty(ol.layer.Heatmap.prototype,"getRevision",ol.layer.Heatmap.prototype.getRevision);goog.exportProperty(ol.layer.Heatmap.prototype,"on",ol.layer.Heatmap.prototype.on);goog.exportProperty(ol.layer.Heatmap.prototype,"once",ol.layer.Heatmap.prototype.once);goog.exportProperty(ol.layer.Heatmap.prototype,"un",ol.layer.Heatmap.prototype.un);goog.exportProperty(ol.layer.Image.prototype,"setMap",ol.layer.Image.prototype.setMap);goog.exportProperty(ol.layer.Image.prototype,"setSource",ol.layer.Image.prototype.setSource);goog.exportProperty(ol.layer.Image.prototype,"getExtent",ol.layer.Image.prototype.getExtent);goog.exportProperty(ol.layer.Image.prototype,"getMaxResolution",ol.layer.Image.prototype.getMaxResolution);goog.exportProperty(ol.layer.Image.prototype,"getMinResolution",ol.layer.Image.prototype.getMinResolution);goog.exportProperty(ol.layer.Image.prototype,"getOpacity",ol.layer.Image.prototype.getOpacity);goog.exportProperty(ol.layer.Image.prototype,"getVisible",ol.layer.Image.prototype.getVisible);goog.exportProperty(ol.layer.Image.prototype,"getZIndex",ol.layer.Image.prototype.getZIndex);goog.exportProperty(ol.layer.Image.prototype,"setExtent",ol.layer.Image.prototype.setExtent);goog.exportProperty(ol.layer.Image.prototype,"setMaxResolution",ol.layer.Image.prototype.setMaxResolution);goog.exportProperty(ol.layer.Image.prototype,"setMinResolution",ol.layer.Image.prototype.setMinResolution);goog.exportProperty(ol.layer.Image.prototype,"setOpacity",ol.layer.Image.prototype.setOpacity);goog.exportProperty(ol.layer.Image.prototype,"setVisible",ol.layer.Image.prototype.setVisible);goog.exportProperty(ol.layer.Image.prototype,"setZIndex",ol.layer.Image.prototype.setZIndex);goog.exportProperty(ol.layer.Image.prototype,"get",ol.layer.Image.prototype.get);goog.exportProperty(ol.layer.Image.prototype,"getKeys",ol.layer.Image.prototype.getKeys);goog.exportProperty(ol.layer.Image.prototype,"getProperties",ol.layer.Image.prototype.getProperties);goog.exportProperty(ol.layer.Image.prototype,"set",ol.layer.Image.prototype.set);goog.exportProperty(ol.layer.Image.prototype,"setProperties",ol.layer.Image.prototype.setProperties);goog.exportProperty(ol.layer.Image.prototype,"unset",ol.layer.Image.prototype.unset);goog.exportProperty(ol.layer.Image.prototype,"changed",ol.layer.Image.prototype.changed);goog.exportProperty(ol.layer.Image.prototype,"dispatchEvent",ol.layer.Image.prototype.dispatchEvent);goog.exportProperty(ol.layer.Image.prototype,"getRevision",ol.layer.Image.prototype.getRevision);goog.exportProperty(ol.layer.Image.prototype,"on",ol.layer.Image.prototype.on);goog.exportProperty(ol.layer.Image.prototype,"once",ol.layer.Image.prototype.once);goog.exportProperty(ol.layer.Image.prototype,"un",ol.layer.Image.prototype.un);goog.exportProperty(ol.layer.Tile.prototype,"setMap",ol.layer.Tile.prototype.setMap);goog.exportProperty(ol.layer.Tile.prototype,"setSource",ol.layer.Tile.prototype.setSource);goog.exportProperty(ol.layer.Tile.prototype,"getExtent",ol.layer.Tile.prototype.getExtent);goog.exportProperty(ol.layer.Tile.prototype,"getMaxResolution",ol.layer.Tile.prototype.getMaxResolution);goog.exportProperty(ol.layer.Tile.prototype,"getMinResolution",ol.layer.Tile.prototype.getMinResolution);goog.exportProperty(ol.layer.Tile.prototype,"getOpacity",ol.layer.Tile.prototype.getOpacity);goog.exportProperty(ol.layer.Tile.prototype,"getVisible",ol.layer.Tile.prototype.getVisible);goog.exportProperty(ol.layer.Tile.prototype,"getZIndex",ol.layer.Tile.prototype.getZIndex);goog.exportProperty(ol.layer.Tile.prototype,"setExtent",ol.layer.Tile.prototype.setExtent);goog.exportProperty(ol.layer.Tile.prototype,"setMaxResolution",ol.layer.Tile.prototype.setMaxResolution);goog.exportProperty(ol.layer.Tile.prototype,"setMinResolution",ol.layer.Tile.prototype.setMinResolution);goog.exportProperty(ol.layer.Tile.prototype,"setOpacity",ol.layer.Tile.prototype.setOpacity);goog.exportProperty(ol.layer.Tile.prototype,"setVisible",ol.layer.Tile.prototype.setVisible);goog.exportProperty(ol.layer.Tile.prototype,"setZIndex",ol.layer.Tile.prototype.setZIndex);goog.exportProperty(ol.layer.Tile.prototype,"get",ol.layer.Tile.prototype.get);goog.exportProperty(ol.layer.Tile.prototype,"getKeys",ol.layer.Tile.prototype.getKeys);goog.exportProperty(ol.layer.Tile.prototype,"getProperties",ol.layer.Tile.prototype.getProperties);goog.exportProperty(ol.layer.Tile.prototype,"set",ol.layer.Tile.prototype.set);goog.exportProperty(ol.layer.Tile.prototype,"setProperties",ol.layer.Tile.prototype.setProperties);goog.exportProperty(ol.layer.Tile.prototype,"unset",ol.layer.Tile.prototype.unset);goog.exportProperty(ol.layer.Tile.prototype,"changed",ol.layer.Tile.prototype.changed);goog.exportProperty(ol.layer.Tile.prototype,"dispatchEvent",ol.layer.Tile.prototype.dispatchEvent);goog.exportProperty(ol.layer.Tile.prototype,"getRevision",ol.layer.Tile.prototype.getRevision);goog.exportProperty(ol.layer.Tile.prototype,"on",ol.layer.Tile.prototype.on);goog.exportProperty(ol.layer.Tile.prototype,"once",ol.layer.Tile.prototype.once);goog.exportProperty(ol.layer.Tile.prototype,"un",ol.layer.Tile.prototype.un);goog.exportProperty(ol.layer.VectorTile.prototype,"getSource",ol.layer.VectorTile.prototype.getSource);goog.exportProperty(ol.layer.VectorTile.prototype,"getStyle",ol.layer.VectorTile.prototype.getStyle);goog.exportProperty(ol.layer.VectorTile.prototype,"getStyleFunction",ol.layer.VectorTile.prototype.getStyleFunction);goog.exportProperty(ol.layer.VectorTile.prototype,"setStyle",ol.layer.VectorTile.prototype.setStyle);goog.exportProperty(ol.layer.VectorTile.prototype,"setMap",ol.layer.VectorTile.prototype.setMap);goog.exportProperty(ol.layer.VectorTile.prototype,"setSource",ol.layer.VectorTile.prototype.setSource);goog.exportProperty(ol.layer.VectorTile.prototype,"getExtent",ol.layer.VectorTile.prototype.getExtent);goog.exportProperty(ol.layer.VectorTile.prototype,"getMaxResolution",ol.layer.VectorTile.prototype.getMaxResolution);goog.exportProperty(ol.layer.VectorTile.prototype,"getMinResolution",ol.layer.VectorTile.prototype.getMinResolution);goog.exportProperty(ol.layer.VectorTile.prototype,"getOpacity",ol.layer.VectorTile.prototype.getOpacity);goog.exportProperty(ol.layer.VectorTile.prototype,"getVisible",ol.layer.VectorTile.prototype.getVisible);goog.exportProperty(ol.layer.VectorTile.prototype,"getZIndex",ol.layer.VectorTile.prototype.getZIndex);goog.exportProperty(ol.layer.VectorTile.prototype,"setExtent",ol.layer.VectorTile.prototype.setExtent);goog.exportProperty(ol.layer.VectorTile.prototype,"setMaxResolution",ol.layer.VectorTile.prototype.setMaxResolution);goog.exportProperty(ol.layer.VectorTile.prototype,"setMinResolution",ol.layer.VectorTile.prototype.setMinResolution);goog.exportProperty(ol.layer.VectorTile.prototype,"setOpacity",ol.layer.VectorTile.prototype.setOpacity);goog.exportProperty(ol.layer.VectorTile.prototype,"setVisible",ol.layer.VectorTile.prototype.setVisible);goog.exportProperty(ol.layer.VectorTile.prototype,"setZIndex",ol.layer.VectorTile.prototype.setZIndex);goog.exportProperty(ol.layer.VectorTile.prototype,"get",ol.layer.VectorTile.prototype.get);goog.exportProperty(ol.layer.VectorTile.prototype,"getKeys",ol.layer.VectorTile.prototype.getKeys);goog.exportProperty(ol.layer.VectorTile.prototype,"getProperties",ol.layer.VectorTile.prototype.getProperties);goog.exportProperty(ol.layer.VectorTile.prototype,"set",ol.layer.VectorTile.prototype.set);goog.exportProperty(ol.layer.VectorTile.prototype,"setProperties",ol.layer.VectorTile.prototype.setProperties);goog.exportProperty(ol.layer.VectorTile.prototype,"unset",ol.layer.VectorTile.prototype.unset);goog.exportProperty(ol.layer.VectorTile.prototype,"changed",ol.layer.VectorTile.prototype.changed);goog.exportProperty(ol.layer.VectorTile.prototype,"dispatchEvent",ol.layer.VectorTile.prototype.dispatchEvent);goog.exportProperty(ol.layer.VectorTile.prototype,"getRevision",ol.layer.VectorTile.prototype.getRevision);goog.exportProperty(ol.layer.VectorTile.prototype,"on",ol.layer.VectorTile.prototype.on);goog.exportProperty(ol.layer.VectorTile.prototype,"once",ol.layer.VectorTile.prototype.once);goog.exportProperty(ol.layer.VectorTile.prototype,"un",ol.layer.VectorTile.prototype.un);goog.exportProperty(ol.interaction.Interaction.prototype,"get",ol.interaction.Interaction.prototype.get);goog.exportProperty(ol.interaction.Interaction.prototype,"getKeys",ol.interaction.Interaction.prototype.getKeys);goog.exportProperty(ol.interaction.Interaction.prototype,"getProperties",ol.interaction.Interaction.prototype.getProperties);goog.exportProperty(ol.interaction.Interaction.prototype,"set",ol.interaction.Interaction.prototype.set);goog.exportProperty(ol.interaction.Interaction.prototype,"setProperties",ol.interaction.Interaction.prototype.setProperties);goog.exportProperty(ol.interaction.Interaction.prototype,"unset",ol.interaction.Interaction.prototype.unset);goog.exportProperty(ol.interaction.Interaction.prototype,"changed",ol.interaction.Interaction.prototype.changed);goog.exportProperty(ol.interaction.Interaction.prototype,"dispatchEvent",ol.interaction.Interaction.prototype.dispatchEvent);goog.exportProperty(ol.interaction.Interaction.prototype,"getRevision",ol.interaction.Interaction.prototype.getRevision);goog.exportProperty(ol.interaction.Interaction.prototype,"on",ol.interaction.Interaction.prototype.on);goog.exportProperty(ol.interaction.Interaction.prototype,"once",ol.interaction.Interaction.prototype.once);goog.exportProperty(ol.interaction.Interaction.prototype,"un",ol.interaction.Interaction.prototype.un);goog.exportProperty(ol.interaction.DoubleClickZoom.prototype,"getActive",ol.interaction.DoubleClickZoom.prototype.getActive);goog.exportProperty(ol.interaction.DoubleClickZoom.prototype,"getMap",ol.interaction.DoubleClickZoom.prototype.getMap);goog.exportProperty(ol.interaction.DoubleClickZoom.prototype,"setActive",ol.interaction.DoubleClickZoom.prototype.setActive);goog.exportProperty(ol.interaction.DoubleClickZoom.prototype,"get",ol.interaction.DoubleClickZoom.prototype.get);goog.exportProperty(ol.interaction.DoubleClickZoom.prototype,"getKeys",ol.interaction.DoubleClickZoom.prototype.getKeys);goog.exportProperty(ol.interaction.DoubleClickZoom.prototype,"getProperties",ol.interaction.DoubleClickZoom.prototype.getProperties);goog.exportProperty(ol.interaction.DoubleClickZoom.prototype,"set",ol.interaction.DoubleClickZoom.prototype.set);goog.exportProperty(ol.interaction.DoubleClickZoom.prototype,"setProperties",ol.interaction.DoubleClickZoom.prototype.setProperties);goog.exportProperty(ol.interaction.DoubleClickZoom.prototype,"unset",ol.interaction.DoubleClickZoom.prototype.unset);goog.exportProperty(ol.interaction.DoubleClickZoom.prototype,"changed",ol.interaction.DoubleClickZoom.prototype.changed);goog.exportProperty(ol.interaction.DoubleClickZoom.prototype,"dispatchEvent",ol.interaction.DoubleClickZoom.prototype.dispatchEvent);goog.exportProperty(ol.interaction.DoubleClickZoom.prototype,"getRevision",ol.interaction.DoubleClickZoom.prototype.getRevision);goog.exportProperty(ol.interaction.DoubleClickZoom.prototype,"on",ol.interaction.DoubleClickZoom.prototype.on);goog.exportProperty(ol.interaction.DoubleClickZoom.prototype,"once",ol.interaction.DoubleClickZoom.prototype.once);goog.exportProperty(ol.interaction.DoubleClickZoom.prototype,"un",ol.interaction.DoubleClickZoom.prototype.un);goog.exportProperty(ol.interaction.DragAndDrop.prototype,"getActive",ol.interaction.DragAndDrop.prototype.getActive);goog.exportProperty(ol.interaction.DragAndDrop.prototype,"getMap",ol.interaction.DragAndDrop.prototype.getMap);goog.exportProperty(ol.interaction.DragAndDrop.prototype,"setActive",ol.interaction.DragAndDrop.prototype.setActive);goog.exportProperty(ol.interaction.DragAndDrop.prototype,"get",ol.interaction.DragAndDrop.prototype.get);goog.exportProperty(ol.interaction.DragAndDrop.prototype,"getKeys",ol.interaction.DragAndDrop.prototype.getKeys);goog.exportProperty(ol.interaction.DragAndDrop.prototype,"getProperties",ol.interaction.DragAndDrop.prototype.getProperties);goog.exportProperty(ol.interaction.DragAndDrop.prototype,"set",ol.interaction.DragAndDrop.prototype.set);goog.exportProperty(ol.interaction.DragAndDrop.prototype,"setProperties",ol.interaction.DragAndDrop.prototype.setProperties);goog.exportProperty(ol.interaction.DragAndDrop.prototype,"unset",ol.interaction.DragAndDrop.prototype.unset);goog.exportProperty(ol.interaction.DragAndDrop.prototype,"changed",ol.interaction.DragAndDrop.prototype.changed);goog.exportProperty(ol.interaction.DragAndDrop.prototype,"dispatchEvent",ol.interaction.DragAndDrop.prototype.dispatchEvent);goog.exportProperty(ol.interaction.DragAndDrop.prototype,"getRevision",ol.interaction.DragAndDrop.prototype.getRevision);goog.exportProperty(ol.interaction.DragAndDrop.prototype,"on",ol.interaction.DragAndDrop.prototype.on);goog.exportProperty(ol.interaction.DragAndDrop.prototype,"once",ol.interaction.DragAndDrop.prototype.once);goog.exportProperty(ol.interaction.DragAndDrop.prototype,"un",ol.interaction.DragAndDrop.prototype.un);goog.exportProperty(ol.interaction.DragAndDrop.Event.prototype,"type",ol.interaction.DragAndDrop.Event.prototype.type);goog.exportProperty(ol.interaction.DragAndDrop.Event.prototype,"target",ol.interaction.DragAndDrop.Event.prototype.target);goog.exportProperty(ol.interaction.DragAndDrop.Event.prototype,"preventDefault",ol.interaction.DragAndDrop.Event.prototype.preventDefault);goog.exportProperty(ol.interaction.DragAndDrop.Event.prototype,"stopPropagation",ol.interaction.DragAndDrop.Event.prototype.stopPropagation);goog.exportProperty(ol.interaction.Pointer.prototype,"getActive",ol.interaction.Pointer.prototype.getActive);goog.exportProperty(ol.interaction.Pointer.prototype,"getMap",ol.interaction.Pointer.prototype.getMap);goog.exportProperty(ol.interaction.Pointer.prototype,"setActive",ol.interaction.Pointer.prototype.setActive);goog.exportProperty(ol.interaction.Pointer.prototype,"get",ol.interaction.Pointer.prototype.get);goog.exportProperty(ol.interaction.Pointer.prototype,"getKeys",ol.interaction.Pointer.prototype.getKeys);goog.exportProperty(ol.interaction.Pointer.prototype,"getProperties",ol.interaction.Pointer.prototype.getProperties);goog.exportProperty(ol.interaction.Pointer.prototype,"set",ol.interaction.Pointer.prototype.set);goog.exportProperty(ol.interaction.Pointer.prototype,"setProperties",ol.interaction.Pointer.prototype.setProperties);goog.exportProperty(ol.interaction.Pointer.prototype,"unset",ol.interaction.Pointer.prototype.unset);goog.exportProperty(ol.interaction.Pointer.prototype,"changed",ol.interaction.Pointer.prototype.changed);goog.exportProperty(ol.interaction.Pointer.prototype,"dispatchEvent",ol.interaction.Pointer.prototype.dispatchEvent);goog.exportProperty(ol.interaction.Pointer.prototype,"getRevision",ol.interaction.Pointer.prototype.getRevision);goog.exportProperty(ol.interaction.Pointer.prototype,"on",ol.interaction.Pointer.prototype.on);goog.exportProperty(ol.interaction.Pointer.prototype,"once",ol.interaction.Pointer.prototype.once);goog.exportProperty(ol.interaction.Pointer.prototype,"un",ol.interaction.Pointer.prototype.un);goog.exportProperty(ol.interaction.DragBox.prototype,"getActive",ol.interaction.DragBox.prototype.getActive);goog.exportProperty(ol.interaction.DragBox.prototype,"getMap",ol.interaction.DragBox.prototype.getMap);goog.exportProperty(ol.interaction.DragBox.prototype,"setActive",ol.interaction.DragBox.prototype.setActive);goog.exportProperty(ol.interaction.DragBox.prototype,"get",ol.interaction.DragBox.prototype.get);goog.exportProperty(ol.interaction.DragBox.prototype,"getKeys",ol.interaction.DragBox.prototype.getKeys);goog.exportProperty(ol.interaction.DragBox.prototype,"getProperties",ol.interaction.DragBox.prototype.getProperties);goog.exportProperty(ol.interaction.DragBox.prototype,"set",ol.interaction.DragBox.prototype.set);goog.exportProperty(ol.interaction.DragBox.prototype,"setProperties",ol.interaction.DragBox.prototype.setProperties);goog.exportProperty(ol.interaction.DragBox.prototype,"unset",ol.interaction.DragBox.prototype.unset);goog.exportProperty(ol.interaction.DragBox.prototype,"changed",ol.interaction.DragBox.prototype.changed);goog.exportProperty(ol.interaction.DragBox.prototype,"dispatchEvent",ol.interaction.DragBox.prototype.dispatchEvent);goog.exportProperty(ol.interaction.DragBox.prototype,"getRevision",ol.interaction.DragBox.prototype.getRevision);goog.exportProperty(ol.interaction.DragBox.prototype,"on",ol.interaction.DragBox.prototype.on);goog.exportProperty(ol.interaction.DragBox.prototype,"once",ol.interaction.DragBox.prototype.once);goog.exportProperty(ol.interaction.DragBox.prototype,"un",ol.interaction.DragBox.prototype.un);goog.exportProperty(ol.interaction.DragBox.Event.prototype,"type",ol.interaction.DragBox.Event.prototype.type);goog.exportProperty(ol.interaction.DragBox.Event.prototype,"target",ol.interaction.DragBox.Event.prototype.target);goog.exportProperty(ol.interaction.DragBox.Event.prototype,"preventDefault",ol.interaction.DragBox.Event.prototype.preventDefault);goog.exportProperty(ol.interaction.DragBox.Event.prototype,"stopPropagation",ol.interaction.DragBox.Event.prototype.stopPropagation);goog.exportProperty(ol.interaction.DragPan.prototype,"getActive",ol.interaction.DragPan.prototype.getActive);goog.exportProperty(ol.interaction.DragPan.prototype,"getMap",ol.interaction.DragPan.prototype.getMap);goog.exportProperty(ol.interaction.DragPan.prototype,"setActive",ol.interaction.DragPan.prototype.setActive);goog.exportProperty(ol.interaction.DragPan.prototype,"get",ol.interaction.DragPan.prototype.get);goog.exportProperty(ol.interaction.DragPan.prototype,"getKeys",ol.interaction.DragPan.prototype.getKeys);goog.exportProperty(ol.interaction.DragPan.prototype,"getProperties",ol.interaction.DragPan.prototype.getProperties);goog.exportProperty(ol.interaction.DragPan.prototype,"set",ol.interaction.DragPan.prototype.set);goog.exportProperty(ol.interaction.DragPan.prototype,"setProperties",ol.interaction.DragPan.prototype.setProperties);goog.exportProperty(ol.interaction.DragPan.prototype,"unset",ol.interaction.DragPan.prototype.unset);goog.exportProperty(ol.interaction.DragPan.prototype,"changed",ol.interaction.DragPan.prototype.changed);goog.exportProperty(ol.interaction.DragPan.prototype,"dispatchEvent",ol.interaction.DragPan.prototype.dispatchEvent);goog.exportProperty(ol.interaction.DragPan.prototype,"getRevision",ol.interaction.DragPan.prototype.getRevision);goog.exportProperty(ol.interaction.DragPan.prototype,"on",ol.interaction.DragPan.prototype.on);goog.exportProperty(ol.interaction.DragPan.prototype,"once",ol.interaction.DragPan.prototype.once);goog.exportProperty(ol.interaction.DragPan.prototype,"un",ol.interaction.DragPan.prototype.un);goog.exportProperty(ol.interaction.DragRotate.prototype,"getActive",ol.interaction.DragRotate.prototype.getActive);goog.exportProperty(ol.interaction.DragRotate.prototype,"getMap",ol.interaction.DragRotate.prototype.getMap);goog.exportProperty(ol.interaction.DragRotate.prototype,"setActive",ol.interaction.DragRotate.prototype.setActive);goog.exportProperty(ol.interaction.DragRotate.prototype,"get",ol.interaction.DragRotate.prototype.get);goog.exportProperty(ol.interaction.DragRotate.prototype,"getKeys",ol.interaction.DragRotate.prototype.getKeys);goog.exportProperty(ol.interaction.DragRotate.prototype,"getProperties",ol.interaction.DragRotate.prototype.getProperties);goog.exportProperty(ol.interaction.DragRotate.prototype,"set",ol.interaction.DragRotate.prototype.set);

goog.exportProperty(ol.interaction.DragRotate.prototype,"setProperties",ol.interaction.DragRotate.prototype.setProperties);goog.exportProperty(ol.interaction.DragRotate.prototype,"unset",ol.interaction.DragRotate.prototype.unset);goog.exportProperty(ol.interaction.DragRotate.prototype,"changed",ol.interaction.DragRotate.prototype.changed);goog.exportProperty(ol.interaction.DragRotate.prototype,"dispatchEvent",ol.interaction.DragRotate.prototype.dispatchEvent);goog.exportProperty(ol.interaction.DragRotate.prototype,"getRevision",ol.interaction.DragRotate.prototype.getRevision);goog.exportProperty(ol.interaction.DragRotate.prototype,"on",ol.interaction.DragRotate.prototype.on);goog.exportProperty(ol.interaction.DragRotate.prototype,"once",ol.interaction.DragRotate.prototype.once);goog.exportProperty(ol.interaction.DragRotate.prototype,"un",ol.interaction.DragRotate.prototype.un);goog.exportProperty(ol.interaction.DragRotateAndZoom.prototype,"getActive",ol.interaction.DragRotateAndZoom.prototype.getActive);goog.exportProperty(ol.interaction.DragRotateAndZoom.prototype,"getMap",ol.interaction.DragRotateAndZoom.prototype.getMap);goog.exportProperty(ol.interaction.DragRotateAndZoom.prototype,"setActive",ol.interaction.DragRotateAndZoom.prototype.setActive);goog.exportProperty(ol.interaction.DragRotateAndZoom.prototype,"get",ol.interaction.DragRotateAndZoom.prototype.get);goog.exportProperty(ol.interaction.DragRotateAndZoom.prototype,"getKeys",ol.interaction.DragRotateAndZoom.prototype.getKeys);goog.exportProperty(ol.interaction.DragRotateAndZoom.prototype,"getProperties",ol.interaction.DragRotateAndZoom.prototype.getProperties);goog.exportProperty(ol.interaction.DragRotateAndZoom.prototype,"set",ol.interaction.DragRotateAndZoom.prototype.set);goog.exportProperty(ol.interaction.DragRotateAndZoom.prototype,"setProperties",ol.interaction.DragRotateAndZoom.prototype.setProperties);goog.exportProperty(ol.interaction.DragRotateAndZoom.prototype,"unset",ol.interaction.DragRotateAndZoom.prototype.unset);goog.exportProperty(ol.interaction.DragRotateAndZoom.prototype,"changed",ol.interaction.DragRotateAndZoom.prototype.changed);goog.exportProperty(ol.interaction.DragRotateAndZoom.prototype,"dispatchEvent",ol.interaction.DragRotateAndZoom.prototype.dispatchEvent);goog.exportProperty(ol.interaction.DragRotateAndZoom.prototype,"getRevision",ol.interaction.DragRotateAndZoom.prototype.getRevision);goog.exportProperty(ol.interaction.DragRotateAndZoom.prototype,"on",ol.interaction.DragRotateAndZoom.prototype.on);goog.exportProperty(ol.interaction.DragRotateAndZoom.prototype,"once",ol.interaction.DragRotateAndZoom.prototype.once);goog.exportProperty(ol.interaction.DragRotateAndZoom.prototype,"un",ol.interaction.DragRotateAndZoom.prototype.un);goog.exportProperty(ol.interaction.DragZoom.prototype,"getGeometry",ol.interaction.DragZoom.prototype.getGeometry);goog.exportProperty(ol.interaction.DragZoom.prototype,"getActive",ol.interaction.DragZoom.prototype.getActive);goog.exportProperty(ol.interaction.DragZoom.prototype,"getMap",ol.interaction.DragZoom.prototype.getMap);goog.exportProperty(ol.interaction.DragZoom.prototype,"setActive",ol.interaction.DragZoom.prototype.setActive);goog.exportProperty(ol.interaction.DragZoom.prototype,"get",ol.interaction.DragZoom.prototype.get);goog.exportProperty(ol.interaction.DragZoom.prototype,"getKeys",ol.interaction.DragZoom.prototype.getKeys);goog.exportProperty(ol.interaction.DragZoom.prototype,"getProperties",ol.interaction.DragZoom.prototype.getProperties);goog.exportProperty(ol.interaction.DragZoom.prototype,"set",ol.interaction.DragZoom.prototype.set);goog.exportProperty(ol.interaction.DragZoom.prototype,"setProperties",ol.interaction.DragZoom.prototype.setProperties);goog.exportProperty(ol.interaction.DragZoom.prototype,"unset",ol.interaction.DragZoom.prototype.unset);goog.exportProperty(ol.interaction.DragZoom.prototype,"changed",ol.interaction.DragZoom.prototype.changed);goog.exportProperty(ol.interaction.DragZoom.prototype,"dispatchEvent",ol.interaction.DragZoom.prototype.dispatchEvent);goog.exportProperty(ol.interaction.DragZoom.prototype,"getRevision",ol.interaction.DragZoom.prototype.getRevision);goog.exportProperty(ol.interaction.DragZoom.prototype,"on",ol.interaction.DragZoom.prototype.on);goog.exportProperty(ol.interaction.DragZoom.prototype,"once",ol.interaction.DragZoom.prototype.once);goog.exportProperty(ol.interaction.DragZoom.prototype,"un",ol.interaction.DragZoom.prototype.un);goog.exportProperty(ol.interaction.Draw.prototype,"getActive",ol.interaction.Draw.prototype.getActive);goog.exportProperty(ol.interaction.Draw.prototype,"getMap",ol.interaction.Draw.prototype.getMap);goog.exportProperty(ol.interaction.Draw.prototype,"setActive",ol.interaction.Draw.prototype.setActive);goog.exportProperty(ol.interaction.Draw.prototype,"get",ol.interaction.Draw.prototype.get);goog.exportProperty(ol.interaction.Draw.prototype,"getKeys",ol.interaction.Draw.prototype.getKeys);goog.exportProperty(ol.interaction.Draw.prototype,"getProperties",ol.interaction.Draw.prototype.getProperties);goog.exportProperty(ol.interaction.Draw.prototype,"set",ol.interaction.Draw.prototype.set);goog.exportProperty(ol.interaction.Draw.prototype,"setProperties",ol.interaction.Draw.prototype.setProperties);goog.exportProperty(ol.interaction.Draw.prototype,"unset",ol.interaction.Draw.prototype.unset);goog.exportProperty(ol.interaction.Draw.prototype,"changed",ol.interaction.Draw.prototype.changed);goog.exportProperty(ol.interaction.Draw.prototype,"dispatchEvent",ol.interaction.Draw.prototype.dispatchEvent);goog.exportProperty(ol.interaction.Draw.prototype,"getRevision",ol.interaction.Draw.prototype.getRevision);goog.exportProperty(ol.interaction.Draw.prototype,"on",ol.interaction.Draw.prototype.on);goog.exportProperty(ol.interaction.Draw.prototype,"once",ol.interaction.Draw.prototype.once);goog.exportProperty(ol.interaction.Draw.prototype,"un",ol.interaction.Draw.prototype.un);goog.exportProperty(ol.interaction.Draw.Event.prototype,"type",ol.interaction.Draw.Event.prototype.type);goog.exportProperty(ol.interaction.Draw.Event.prototype,"target",ol.interaction.Draw.Event.prototype.target);goog.exportProperty(ol.interaction.Draw.Event.prototype,"preventDefault",ol.interaction.Draw.Event.prototype.preventDefault);goog.exportProperty(ol.interaction.Draw.Event.prototype,"stopPropagation",ol.interaction.Draw.Event.prototype.stopPropagation);goog.exportProperty(ol.interaction.Extent.prototype,"getActive",ol.interaction.Extent.prototype.getActive);goog.exportProperty(ol.interaction.Extent.prototype,"getMap",ol.interaction.Extent.prototype.getMap);goog.exportProperty(ol.interaction.Extent.prototype,"setActive",ol.interaction.Extent.prototype.setActive);goog.exportProperty(ol.interaction.Extent.prototype,"get",ol.interaction.Extent.prototype.get);goog.exportProperty(ol.interaction.Extent.prototype,"getKeys",ol.interaction.Extent.prototype.getKeys);goog.exportProperty(ol.interaction.Extent.prototype,"getProperties",ol.interaction.Extent.prototype.getProperties);goog.exportProperty(ol.interaction.Extent.prototype,"set",ol.interaction.Extent.prototype.set);goog.exportProperty(ol.interaction.Extent.prototype,"setProperties",ol.interaction.Extent.prototype.setProperties);goog.exportProperty(ol.interaction.Extent.prototype,"unset",ol.interaction.Extent.prototype.unset);goog.exportProperty(ol.interaction.Extent.prototype,"changed",ol.interaction.Extent.prototype.changed);goog.exportProperty(ol.interaction.Extent.prototype,"dispatchEvent",ol.interaction.Extent.prototype.dispatchEvent);goog.exportProperty(ol.interaction.Extent.prototype,"getRevision",ol.interaction.Extent.prototype.getRevision);goog.exportProperty(ol.interaction.Extent.prototype,"on",ol.interaction.Extent.prototype.on);goog.exportProperty(ol.interaction.Extent.prototype,"once",ol.interaction.Extent.prototype.once);goog.exportProperty(ol.interaction.Extent.prototype,"un",ol.interaction.Extent.prototype.un);goog.exportProperty(ol.interaction.Extent.Event.prototype,"type",ol.interaction.Extent.Event.prototype.type);goog.exportProperty(ol.interaction.Extent.Event.prototype,"target",ol.interaction.Extent.Event.prototype.target);goog.exportProperty(ol.interaction.Extent.Event.prototype,"preventDefault",ol.interaction.Extent.Event.prototype.preventDefault);goog.exportProperty(ol.interaction.Extent.Event.prototype,"stopPropagation",ol.interaction.Extent.Event.prototype.stopPropagation);goog.exportProperty(ol.interaction.KeyboardPan.prototype,"getActive",ol.interaction.KeyboardPan.prototype.getActive);goog.exportProperty(ol.interaction.KeyboardPan.prototype,"getMap",ol.interaction.KeyboardPan.prototype.getMap);goog.exportProperty(ol.interaction.KeyboardPan.prototype,"setActive",ol.interaction.KeyboardPan.prototype.setActive);goog.exportProperty(ol.interaction.KeyboardPan.prototype,"get",ol.interaction.KeyboardPan.prototype.get);goog.exportProperty(ol.interaction.KeyboardPan.prototype,"getKeys",ol.interaction.KeyboardPan.prototype.getKeys);goog.exportProperty(ol.interaction.KeyboardPan.prototype,"getProperties",ol.interaction.KeyboardPan.prototype.getProperties);goog.exportProperty(ol.interaction.KeyboardPan.prototype,"set",ol.interaction.KeyboardPan.prototype.set);goog.exportProperty(ol.interaction.KeyboardPan.prototype,"setProperties",ol.interaction.KeyboardPan.prototype.setProperties);goog.exportProperty(ol.interaction.KeyboardPan.prototype,"unset",ol.interaction.KeyboardPan.prototype.unset);goog.exportProperty(ol.interaction.KeyboardPan.prototype,"changed",ol.interaction.KeyboardPan.prototype.changed);goog.exportProperty(ol.interaction.KeyboardPan.prototype,"dispatchEvent",ol.interaction.KeyboardPan.prototype.dispatchEvent);goog.exportProperty(ol.interaction.KeyboardPan.prototype,"getRevision",ol.interaction.KeyboardPan.prototype.getRevision);goog.exportProperty(ol.interaction.KeyboardPan.prototype,"on",ol.interaction.KeyboardPan.prototype.on);goog.exportProperty(ol.interaction.KeyboardPan.prototype,"once",ol.interaction.KeyboardPan.prototype.once);goog.exportProperty(ol.interaction.KeyboardPan.prototype,"un",ol.interaction.KeyboardPan.prototype.un);goog.exportProperty(ol.interaction.KeyboardZoom.prototype,"getActive",ol.interaction.KeyboardZoom.prototype.getActive);goog.exportProperty(ol.interaction.KeyboardZoom.prototype,"getMap",ol.interaction.KeyboardZoom.prototype.getMap);goog.exportProperty(ol.interaction.KeyboardZoom.prototype,"setActive",ol.interaction.KeyboardZoom.prototype.setActive);goog.exportProperty(ol.interaction.KeyboardZoom.prototype,"get",ol.interaction.KeyboardZoom.prototype.get);goog.exportProperty(ol.interaction.KeyboardZoom.prototype,"getKeys",ol.interaction.KeyboardZoom.prototype.getKeys);goog.exportProperty(ol.interaction.KeyboardZoom.prototype,"getProperties",ol.interaction.KeyboardZoom.prototype.getProperties);goog.exportProperty(ol.interaction.KeyboardZoom.prototype,"set",ol.interaction.KeyboardZoom.prototype.set);goog.exportProperty(ol.interaction.KeyboardZoom.prototype,"setProperties",ol.interaction.KeyboardZoom.prototype.setProperties);goog.exportProperty(ol.interaction.KeyboardZoom.prototype,"unset",ol.interaction.KeyboardZoom.prototype.unset);goog.exportProperty(ol.interaction.KeyboardZoom.prototype,"changed",ol.interaction.KeyboardZoom.prototype.changed);goog.exportProperty(ol.interaction.KeyboardZoom.prototype,"dispatchEvent",ol.interaction.KeyboardZoom.prototype.dispatchEvent);goog.exportProperty(ol.interaction.KeyboardZoom.prototype,"getRevision",ol.interaction.KeyboardZoom.prototype.getRevision);goog.exportProperty(ol.interaction.KeyboardZoom.prototype,"on",ol.interaction.KeyboardZoom.prototype.on);goog.exportProperty(ol.interaction.KeyboardZoom.prototype,"once",ol.interaction.KeyboardZoom.prototype.once);goog.exportProperty(ol.interaction.KeyboardZoom.prototype,"un",ol.interaction.KeyboardZoom.prototype.un);goog.exportProperty(ol.interaction.Modify.prototype,"getActive",ol.interaction.Modify.prototype.getActive);goog.exportProperty(ol.interaction.Modify.prototype,"getMap",ol.interaction.Modify.prototype.getMap);goog.exportProperty(ol.interaction.Modify.prototype,"setActive",ol.interaction.Modify.prototype.setActive);goog.exportProperty(ol.interaction.Modify.prototype,"get",ol.interaction.Modify.prototype.get);goog.exportProperty(ol.interaction.Modify.prototype,"getKeys",ol.interaction.Modify.prototype.getKeys);goog.exportProperty(ol.interaction.Modify.prototype,"getProperties",ol.interaction.Modify.prototype.getProperties);goog.exportProperty(ol.interaction.Modify.prototype,"set",ol.interaction.Modify.prototype.set);goog.exportProperty(ol.interaction.Modify.prototype,"setProperties",ol.interaction.Modify.prototype.setProperties);goog.exportProperty(ol.interaction.Modify.prototype,"unset",ol.interaction.Modify.prototype.unset);goog.exportProperty(ol.interaction.Modify.prototype,"changed",ol.interaction.Modify.prototype.changed);goog.exportProperty(ol.interaction.Modify.prototype,"dispatchEvent",ol.interaction.Modify.prototype.dispatchEvent);goog.exportProperty(ol.interaction.Modify.prototype,"getRevision",ol.interaction.Modify.prototype.getRevision);goog.exportProperty(ol.interaction.Modify.prototype,"on",ol.interaction.Modify.prototype.on);goog.exportProperty(ol.interaction.Modify.prototype,"once",ol.interaction.Modify.prototype.once);goog.exportProperty(ol.interaction.Modify.prototype,"un",ol.interaction.Modify.prototype.un);goog.exportProperty(ol.interaction.Modify.Event.prototype,"type",ol.interaction.Modify.Event.prototype.type);goog.exportProperty(ol.interaction.Modify.Event.prototype,"target",ol.interaction.Modify.Event.prototype.target);goog.exportProperty(ol.interaction.Modify.Event.prototype,"preventDefault",ol.interaction.Modify.Event.prototype.preventDefault);goog.exportProperty(ol.interaction.Modify.Event.prototype,"stopPropagation",ol.interaction.Modify.Event.prototype.stopPropagation);goog.exportProperty(ol.interaction.MouseWheelZoom.prototype,"getActive",ol.interaction.MouseWheelZoom.prototype.getActive);goog.exportProperty(ol.interaction.MouseWheelZoom.prototype,"getMap",ol.interaction.MouseWheelZoom.prototype.getMap);goog.exportProperty(ol.interaction.MouseWheelZoom.prototype,"setActive",ol.interaction.MouseWheelZoom.prototype.setActive);goog.exportProperty(ol.interaction.MouseWheelZoom.prototype,"get",ol.interaction.MouseWheelZoom.prototype.get);goog.exportProperty(ol.interaction.MouseWheelZoom.prototype,"getKeys",ol.interaction.MouseWheelZoom.prototype.getKeys);goog.exportProperty(ol.interaction.MouseWheelZoom.prototype,"getProperties",ol.interaction.MouseWheelZoom.prototype.getProperties);goog.exportProperty(ol.interaction.MouseWheelZoom.prototype,"set",ol.interaction.MouseWheelZoom.prototype.set);goog.exportProperty(ol.interaction.MouseWheelZoom.prototype,"setProperties",ol.interaction.MouseWheelZoom.prototype.setProperties);goog.exportProperty(ol.interaction.MouseWheelZoom.prototype,"unset",ol.interaction.MouseWheelZoom.prototype.unset);goog.exportProperty(ol.interaction.MouseWheelZoom.prototype,"changed",ol.interaction.MouseWheelZoom.prototype.changed);goog.exportProperty(ol.interaction.MouseWheelZoom.prototype,"dispatchEvent",ol.interaction.MouseWheelZoom.prototype.dispatchEvent);goog.exportProperty(ol.interaction.MouseWheelZoom.prototype,"getRevision",ol.interaction.MouseWheelZoom.prototype.getRevision);goog.exportProperty(ol.interaction.MouseWheelZoom.prototype,"on",ol.interaction.MouseWheelZoom.prototype.on);goog.exportProperty(ol.interaction.MouseWheelZoom.prototype,"once",ol.interaction.MouseWheelZoom.prototype.once);goog.exportProperty(ol.interaction.MouseWheelZoom.prototype,"un",ol.interaction.MouseWheelZoom.prototype.un);goog.exportProperty(ol.interaction.PinchRotate.prototype,"getActive",ol.interaction.PinchRotate.prototype.getActive);goog.exportProperty(ol.interaction.PinchRotate.prototype,"getMap",ol.interaction.PinchRotate.prototype.getMap);goog.exportProperty(ol.interaction.PinchRotate.prototype,"setActive",ol.interaction.PinchRotate.prototype.setActive);goog.exportProperty(ol.interaction.PinchRotate.prototype,"get",ol.interaction.PinchRotate.prototype.get);goog.exportProperty(ol.interaction.PinchRotate.prototype,"getKeys",ol.interaction.PinchRotate.prototype.getKeys);goog.exportProperty(ol.interaction.PinchRotate.prototype,"getProperties",ol.interaction.PinchRotate.prototype.getProperties);goog.exportProperty(ol.interaction.PinchRotate.prototype,"set",ol.interaction.PinchRotate.prototype.set);goog.exportProperty(ol.interaction.PinchRotate.prototype,"setProperties",ol.interaction.PinchRotate.prototype.setProperties);goog.exportProperty(ol.interaction.PinchRotate.prototype,"unset",ol.interaction.PinchRotate.prototype.unset);goog.exportProperty(ol.interaction.PinchRotate.prototype,"changed",ol.interaction.PinchRotate.prototype.changed);goog.exportProperty(ol.interaction.PinchRotate.prototype,"dispatchEvent",ol.interaction.PinchRotate.prototype.dispatchEvent);goog.exportProperty(ol.interaction.PinchRotate.prototype,"getRevision",ol.interaction.PinchRotate.prototype.getRevision);goog.exportProperty(ol.interaction.PinchRotate.prototype,"on",ol.interaction.PinchRotate.prototype.on);goog.exportProperty(ol.interaction.PinchRotate.prototype,"once",ol.interaction.PinchRotate.prototype.once);goog.exportProperty(ol.interaction.PinchRotate.prototype,"un",ol.interaction.PinchRotate.prototype.un);goog.exportProperty(ol.interaction.PinchZoom.prototype,"getActive",ol.interaction.PinchZoom.prototype.getActive);goog.exportProperty(ol.interaction.PinchZoom.prototype,"getMap",ol.interaction.PinchZoom.prototype.getMap);goog.exportProperty(ol.interaction.PinchZoom.prototype,"setActive",ol.interaction.PinchZoom.prototype.setActive);goog.exportProperty(ol.interaction.PinchZoom.prototype,"get",ol.interaction.PinchZoom.prototype.get);goog.exportProperty(ol.interaction.PinchZoom.prototype,"getKeys",ol.interaction.PinchZoom.prototype.getKeys);goog.exportProperty(ol.interaction.PinchZoom.prototype,"getProperties",ol.interaction.PinchZoom.prototype.getProperties);goog.exportProperty(ol.interaction.PinchZoom.prototype,"set",ol.interaction.PinchZoom.prototype.set);goog.exportProperty(ol.interaction.PinchZoom.prototype,"setProperties",ol.interaction.PinchZoom.prototype.setProperties);goog.exportProperty(ol.interaction.PinchZoom.prototype,"unset",ol.interaction.PinchZoom.prototype.unset);goog.exportProperty(ol.interaction.PinchZoom.prototype,"changed",ol.interaction.PinchZoom.prototype.changed);goog.exportProperty(ol.interaction.PinchZoom.prototype,"dispatchEvent",ol.interaction.PinchZoom.prototype.dispatchEvent);goog.exportProperty(ol.interaction.PinchZoom.prototype,"getRevision",ol.interaction.PinchZoom.prototype.getRevision);goog.exportProperty(ol.interaction.PinchZoom.prototype,"on",ol.interaction.PinchZoom.prototype.on);goog.exportProperty(ol.interaction.PinchZoom.prototype,"once",ol.interaction.PinchZoom.prototype.once);goog.exportProperty(ol.interaction.PinchZoom.prototype,"un",ol.interaction.PinchZoom.prototype.un);goog.exportProperty(ol.interaction.Select.prototype,"getActive",ol.interaction.Select.prototype.getActive);goog.exportProperty(ol.interaction.Select.prototype,"getMap",ol.interaction.Select.prototype.getMap);goog.exportProperty(ol.interaction.Select.prototype,"setActive",ol.interaction.Select.prototype.setActive);goog.exportProperty(ol.interaction.Select.prototype,"get",ol.interaction.Select.prototype.get);goog.exportProperty(ol.interaction.Select.prototype,"getKeys",ol.interaction.Select.prototype.getKeys);goog.exportProperty(ol.interaction.Select.prototype,"getProperties",ol.interaction.Select.prototype.getProperties);goog.exportProperty(ol.interaction.Select.prototype,"set",ol.interaction.Select.prototype.set);goog.exportProperty(ol.interaction.Select.prototype,"setProperties",ol.interaction.Select.prototype.setProperties);goog.exportProperty(ol.interaction.Select.prototype,"unset",ol.interaction.Select.prototype.unset);goog.exportProperty(ol.interaction.Select.prototype,"changed",ol.interaction.Select.prototype.changed);goog.exportProperty(ol.interaction.Select.prototype,"dispatchEvent",ol.interaction.Select.prototype.dispatchEvent);goog.exportProperty(ol.interaction.Select.prototype,"getRevision",ol.interaction.Select.prototype.getRevision);goog.exportProperty(ol.interaction.Select.prototype,"on",ol.interaction.Select.prototype.on);goog.exportProperty(ol.interaction.Select.prototype,"once",ol.interaction.Select.prototype.once);goog.exportProperty(ol.interaction.Select.prototype,"un",ol.interaction.Select.prototype.un);goog.exportProperty(ol.interaction.Select.Event.prototype,"type",ol.interaction.Select.Event.prototype.type);goog.exportProperty(ol.interaction.Select.Event.prototype,"target",ol.interaction.Select.Event.prototype.target);goog.exportProperty(ol.interaction.Select.Event.prototype,"preventDefault",ol.interaction.Select.Event.prototype.preventDefault);goog.exportProperty(ol.interaction.Select.Event.prototype,"stopPropagation",ol.interaction.Select.Event.prototype.stopPropagation);goog.exportProperty(ol.interaction.Snap.prototype,"getActive",ol.interaction.Snap.prototype.getActive);goog.exportProperty(ol.interaction.Snap.prototype,"getMap",ol.interaction.Snap.prototype.getMap);goog.exportProperty(ol.interaction.Snap.prototype,"setActive",ol.interaction.Snap.prototype.setActive);goog.exportProperty(ol.interaction.Snap.prototype,"get",ol.interaction.Snap.prototype.get);goog.exportProperty(ol.interaction.Snap.prototype,"getKeys",ol.interaction.Snap.prototype.getKeys);goog.exportProperty(ol.interaction.Snap.prototype,"getProperties",ol.interaction.Snap.prototype.getProperties);goog.exportProperty(ol.interaction.Snap.prototype,"set",ol.interaction.Snap.prototype.set);goog.exportProperty(ol.interaction.Snap.prototype,"setProperties",ol.interaction.Snap.prototype.setProperties);goog.exportProperty(ol.interaction.Snap.prototype,"unset",ol.interaction.Snap.prototype.unset);goog.exportProperty(ol.interaction.Snap.prototype,"changed",ol.interaction.Snap.prototype.changed);goog.exportProperty(ol.interaction.Snap.prototype,"dispatchEvent",ol.interaction.Snap.prototype.dispatchEvent);goog.exportProperty(ol.interaction.Snap.prototype,"getRevision",ol.interaction.Snap.prototype.getRevision);goog.exportProperty(ol.interaction.Snap.prototype,"on",ol.interaction.Snap.prototype.on);goog.exportProperty(ol.interaction.Snap.prototype,"once",ol.interaction.Snap.prototype.once);goog.exportProperty(ol.interaction.Snap.prototype,"un",ol.interaction.Snap.prototype.un);goog.exportProperty(ol.interaction.Translate.prototype,"getActive",ol.interaction.Translate.prototype.getActive);goog.exportProperty(ol.interaction.Translate.prototype,"getMap",ol.interaction.Translate.prototype.getMap);goog.exportProperty(ol.interaction.Translate.prototype,"setActive",ol.interaction.Translate.prototype.setActive);goog.exportProperty(ol.interaction.Translate.prototype,"get",ol.interaction.Translate.prototype.get);goog.exportProperty(ol.interaction.Translate.prototype,"getKeys",ol.interaction.Translate.prototype.getKeys);goog.exportProperty(ol.interaction.Translate.prototype,"getProperties",ol.interaction.Translate.prototype.getProperties);goog.exportProperty(ol.interaction.Translate.prototype,"set",ol.interaction.Translate.prototype.set);goog.exportProperty(ol.interaction.Translate.prototype,"setProperties",ol.interaction.Translate.prototype.setProperties);goog.exportProperty(ol.interaction.Translate.prototype,"unset",ol.interaction.Translate.prototype.unset);goog.exportProperty(ol.interaction.Translate.prototype,"changed",ol.interaction.Translate.prototype.changed);goog.exportProperty(ol.interaction.Translate.prototype,"dispatchEvent",ol.interaction.Translate.prototype.dispatchEvent);goog.exportProperty(ol.interaction.Translate.prototype,"getRevision",ol.interaction.Translate.prototype.getRevision);goog.exportProperty(ol.interaction.Translate.prototype,"on",ol.interaction.Translate.prototype.on);goog.exportProperty(ol.interaction.Translate.prototype,"once",ol.interaction.Translate.prototype.once);goog.exportProperty(ol.interaction.Translate.prototype,"un",ol.interaction.Translate.prototype.un);goog.exportProperty(ol.interaction.Translate.Event.prototype,"type",ol.interaction.Translate.Event.prototype.type);goog.exportProperty(ol.interaction.Translate.Event.prototype,"target",ol.interaction.Translate.Event.prototype.target);goog.exportProperty(ol.interaction.Translate.Event.prototype,"preventDefault",ol.interaction.Translate.Event.prototype.preventDefault);goog.exportProperty(ol.interaction.Translate.Event.prototype,"stopPropagation",ol.interaction.Translate.Event.prototype.stopPropagation);goog.exportProperty(ol.geom.Geometry.prototype,"get",ol.geom.Geometry.prototype.get);goog.exportProperty(ol.geom.Geometry.prototype,"getKeys",ol.geom.Geometry.prototype.getKeys);goog.exportProperty(ol.geom.Geometry.prototype,"getProperties",ol.geom.Geometry.prototype.getProperties);goog.exportProperty(ol.geom.Geometry.prototype,"set",ol.geom.Geometry.prototype.set);goog.exportProperty(ol.geom.Geometry.prototype,"setProperties",ol.geom.Geometry.prototype.setProperties);goog.exportProperty(ol.geom.Geometry.prototype,"unset",ol.geom.Geometry.prototype.unset);goog.exportProperty(ol.geom.Geometry.prototype,"changed",ol.geom.Geometry.prototype.changed);goog.exportProperty(ol.geom.Geometry.prototype,"dispatchEvent",ol.geom.Geometry.prototype.dispatchEvent);goog.exportProperty(ol.geom.Geometry.prototype,"getRevision",ol.geom.Geometry.prototype.getRevision);goog.exportProperty(ol.geom.Geometry.prototype,"on",ol.geom.Geometry.prototype.on);goog.exportProperty(ol.geom.Geometry.prototype,"once",ol.geom.Geometry.prototype.once);goog.exportProperty(ol.geom.Geometry.prototype,"un",ol.geom.Geometry.prototype.un);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"getClosestPoint",ol.geom.SimpleGeometry.prototype.getClosestPoint);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"intersectsCoordinate",ol.geom.SimpleGeometry.prototype.intersectsCoordinate);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"getExtent",ol.geom.SimpleGeometry.prototype.getExtent);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"rotate",ol.geom.SimpleGeometry.prototype.rotate);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"scale",ol.geom.SimpleGeometry.prototype.scale);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"simplify",ol.geom.SimpleGeometry.prototype.simplify);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"transform",ol.geom.SimpleGeometry.prototype.transform);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"get",ol.geom.SimpleGeometry.prototype.get);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"getKeys",ol.geom.SimpleGeometry.prototype.getKeys);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"getProperties",ol.geom.SimpleGeometry.prototype.getProperties);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"set",ol.geom.SimpleGeometry.prototype.set);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"setProperties",ol.geom.SimpleGeometry.prototype.setProperties);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"unset",ol.geom.SimpleGeometry.prototype.unset);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"changed",ol.geom.SimpleGeometry.prototype.changed);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"dispatchEvent",ol.geom.SimpleGeometry.prototype.dispatchEvent);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"getRevision",ol.geom.SimpleGeometry.prototype.getRevision);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"on",ol.geom.SimpleGeometry.prototype.on);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"once",ol.geom.SimpleGeometry.prototype.once);goog.exportProperty(ol.geom.SimpleGeometry.prototype,"un",ol.geom.SimpleGeometry.prototype.un);goog.exportProperty(ol.geom.Circle.prototype,"getFirstCoordinate",ol.geom.Circle.prototype.getFirstCoordinate);goog.exportProperty(ol.geom.Circle.prototype,"getLastCoordinate",ol.geom.Circle.prototype.getLastCoordinate);goog.exportProperty(ol.geom.Circle.prototype,"getLayout",ol.geom.Circle.prototype.getLayout);goog.exportProperty(ol.geom.Circle.prototype,"rotate",ol.geom.Circle.prototype.rotate);goog.exportProperty(ol.geom.Circle.prototype,"scale",ol.geom.Circle.prototype.scale);goog.exportProperty(ol.geom.Circle.prototype,"getClosestPoint",ol.geom.Circle.prototype.getClosestPoint);goog.exportProperty(ol.geom.Circle.prototype,"intersectsCoordinate",ol.geom.Circle.prototype.intersectsCoordinate);goog.exportProperty(ol.geom.Circle.prototype,"getExtent",ol.geom.Circle.prototype.getExtent);goog.exportProperty(ol.geom.Circle.prototype,"simplify",ol.geom.Circle.prototype.simplify);goog.exportProperty(ol.geom.Circle.prototype,"get",ol.geom.Circle.prototype.get);goog.exportProperty(ol.geom.Circle.prototype,"getKeys",ol.geom.Circle.prototype.getKeys);goog.exportProperty(ol.geom.Circle.prototype,"getProperties",ol.geom.Circle.prototype.getProperties);goog.exportProperty(ol.geom.Circle.prototype,"set",ol.geom.Circle.prototype.set);goog.exportProperty(ol.geom.Circle.prototype,"setProperties",ol.geom.Circle.prototype.setProperties);goog.exportProperty(ol.geom.Circle.prototype,"unset",ol.geom.Circle.prototype.unset);goog.exportProperty(ol.geom.Circle.prototype,"changed",ol.geom.Circle.prototype.changed);goog.exportProperty(ol.geom.Circle.prototype,"dispatchEvent",ol.geom.Circle.prototype.dispatchEvent);goog.exportProperty(ol.geom.Circle.prototype,"getRevision",ol.geom.Circle.prototype.getRevision);goog.exportProperty(ol.geom.Circle.prototype,"on",ol.geom.Circle.prototype.on);goog.exportProperty(ol.geom.Circle.prototype,"once",ol.geom.Circle.prototype.once);goog.exportProperty(ol.geom.Circle.prototype,"un",ol.geom.Circle.prototype.un);goog.exportProperty(ol.geom.GeometryCollection.prototype,"getClosestPoint",ol.geom.GeometryCollection.prototype.getClosestPoint);goog.exportProperty(ol.geom.GeometryCollection.prototype,"intersectsCoordinate",ol.geom.GeometryCollection.prototype.intersectsCoordinate);goog.exportProperty(ol.geom.GeometryCollection.prototype,"getExtent",ol.geom.GeometryCollection.prototype.getExtent);goog.exportProperty(ol.geom.GeometryCollection.prototype,"rotate",ol.geom.GeometryCollection.prototype.rotate);goog.exportProperty(ol.geom.GeometryCollection.prototype,"scale",ol.geom.GeometryCollection.prototype.scale);goog.exportProperty(ol.geom.GeometryCollection.prototype,"simplify",ol.geom.GeometryCollection.prototype.simplify);goog.exportProperty(ol.geom.GeometryCollection.prototype,"transform",ol.geom.GeometryCollection.prototype.transform);goog.exportProperty(ol.geom.GeometryCollection.prototype,"get",ol.geom.GeometryCollection.prototype.get);goog.exportProperty(ol.geom.GeometryCollection.prototype,"getKeys",ol.geom.GeometryCollection.prototype.getKeys);goog.exportProperty(ol.geom.GeometryCollection.prototype,"getProperties",ol.geom.GeometryCollection.prototype.getProperties);goog.exportProperty(ol.geom.GeometryCollection.prototype,"set",ol.geom.GeometryCollection.prototype.set);goog.exportProperty(ol.geom.GeometryCollection.prototype,"setProperties",ol.geom.GeometryCollection.prototype.setProperties);goog.exportProperty(ol.geom.GeometryCollection.prototype,"unset",ol.geom.GeometryCollection.prototype.unset);goog.exportProperty(ol.geom.GeometryCollection.prototype,"changed",ol.geom.GeometryCollection.prototype.changed);goog.exportProperty(ol.geom.GeometryCollection.prototype,"dispatchEvent",ol.geom.GeometryCollection.prototype.dispatchEvent);goog.exportProperty(ol.geom.GeometryCollection.prototype,"getRevision",ol.geom.GeometryCollection.prototype.getRevision);goog.exportProperty(ol.geom.GeometryCollection.prototype,"on",ol.geom.GeometryCollection.prototype.on);goog.exportProperty(ol.geom.GeometryCollection.prototype,"once",ol.geom.GeometryCollection.prototype.once);goog.exportProperty(ol.geom.GeometryCollection.prototype,"un",ol.geom.GeometryCollection.prototype.un);

goog.exportProperty(ol.geom.LinearRing.prototype,"getFirstCoordinate",ol.geom.LinearRing.prototype.getFirstCoordinate);goog.exportProperty(ol.geom.LinearRing.prototype,"getLastCoordinate",ol.geom.LinearRing.prototype.getLastCoordinate);goog.exportProperty(ol.geom.LinearRing.prototype,"getLayout",ol.geom.LinearRing.prototype.getLayout);goog.exportProperty(ol.geom.LinearRing.prototype,"rotate",ol.geom.LinearRing.prototype.rotate);goog.exportProperty(ol.geom.LinearRing.prototype,"scale",ol.geom.LinearRing.prototype.scale);goog.exportProperty(ol.geom.LinearRing.prototype,"getClosestPoint",ol.geom.LinearRing.prototype.getClosestPoint);goog.exportProperty(ol.geom.LinearRing.prototype,"intersectsCoordinate",ol.geom.LinearRing.prototype.intersectsCoordinate);goog.exportProperty(ol.geom.LinearRing.prototype,"getExtent",ol.geom.LinearRing.prototype.getExtent);goog.exportProperty(ol.geom.LinearRing.prototype,"simplify",ol.geom.LinearRing.prototype.simplify);goog.exportProperty(ol.geom.LinearRing.prototype,"transform",ol.geom.LinearRing.prototype.transform);goog.exportProperty(ol.geom.LinearRing.prototype,"get",ol.geom.LinearRing.prototype.get);goog.exportProperty(ol.geom.LinearRing.prototype,"getKeys",ol.geom.LinearRing.prototype.getKeys);goog.exportProperty(ol.geom.LinearRing.prototype,"getProperties",ol.geom.LinearRing.prototype.getProperties);goog.exportProperty(ol.geom.LinearRing.prototype,"set",ol.geom.LinearRing.prototype.set);goog.exportProperty(ol.geom.LinearRing.prototype,"setProperties",ol.geom.LinearRing.prototype.setProperties);goog.exportProperty(ol.geom.LinearRing.prototype,"unset",ol.geom.LinearRing.prototype.unset);goog.exportProperty(ol.geom.LinearRing.prototype,"changed",ol.geom.LinearRing.prototype.changed);goog.exportProperty(ol.geom.LinearRing.prototype,"dispatchEvent",ol.geom.LinearRing.prototype.dispatchEvent);goog.exportProperty(ol.geom.LinearRing.prototype,"getRevision",ol.geom.LinearRing.prototype.getRevision);goog.exportProperty(ol.geom.LinearRing.prototype,"on",ol.geom.LinearRing.prototype.on);goog.exportProperty(ol.geom.LinearRing.prototype,"once",ol.geom.LinearRing.prototype.once);goog.exportProperty(ol.geom.LinearRing.prototype,"un",ol.geom.LinearRing.prototype.un);goog.exportProperty(ol.geom.LineString.prototype,"getFirstCoordinate",ol.geom.LineString.prototype.getFirstCoordinate);goog.exportProperty(ol.geom.LineString.prototype,"getLastCoordinate",ol.geom.LineString.prototype.getLastCoordinate);goog.exportProperty(ol.geom.LineString.prototype,"getLayout",ol.geom.LineString.prototype.getLayout);goog.exportProperty(ol.geom.LineString.prototype,"rotate",ol.geom.LineString.prototype.rotate);goog.exportProperty(ol.geom.LineString.prototype,"scale",ol.geom.LineString.prototype.scale);goog.exportProperty(ol.geom.LineString.prototype,"getClosestPoint",ol.geom.LineString.prototype.getClosestPoint);goog.exportProperty(ol.geom.LineString.prototype,"intersectsCoordinate",ol.geom.LineString.prototype.intersectsCoordinate);goog.exportProperty(ol.geom.LineString.prototype,"getExtent",ol.geom.LineString.prototype.getExtent);goog.exportProperty(ol.geom.LineString.prototype,"simplify",ol.geom.LineString.prototype.simplify);goog.exportProperty(ol.geom.LineString.prototype,"transform",ol.geom.LineString.prototype.transform);goog.exportProperty(ol.geom.LineString.prototype,"get",ol.geom.LineString.prototype.get);goog.exportProperty(ol.geom.LineString.prototype,"getKeys",ol.geom.LineString.prototype.getKeys);goog.exportProperty(ol.geom.LineString.prototype,"getProperties",ol.geom.LineString.prototype.getProperties);goog.exportProperty(ol.geom.LineString.prototype,"set",ol.geom.LineString.prototype.set);goog.exportProperty(ol.geom.LineString.prototype,"setProperties",ol.geom.LineString.prototype.setProperties);goog.exportProperty(ol.geom.LineString.prototype,"unset",ol.geom.LineString.prototype.unset);goog.exportProperty(ol.geom.LineString.prototype,"changed",ol.geom.LineString.prototype.changed);goog.exportProperty(ol.geom.LineString.prototype,"dispatchEvent",ol.geom.LineString.prototype.dispatchEvent);goog.exportProperty(ol.geom.LineString.prototype,"getRevision",ol.geom.LineString.prototype.getRevision);goog.exportProperty(ol.geom.LineString.prototype,"on",ol.geom.LineString.prototype.on);goog.exportProperty(ol.geom.LineString.prototype,"once",ol.geom.LineString.prototype.once);goog.exportProperty(ol.geom.LineString.prototype,"un",ol.geom.LineString.prototype.un);goog.exportProperty(ol.geom.MultiLineString.prototype,"getFirstCoordinate",ol.geom.MultiLineString.prototype.getFirstCoordinate);goog.exportProperty(ol.geom.MultiLineString.prototype,"getLastCoordinate",ol.geom.MultiLineString.prototype.getLastCoordinate);goog.exportProperty(ol.geom.MultiLineString.prototype,"getLayout",ol.geom.MultiLineString.prototype.getLayout);goog.exportProperty(ol.geom.MultiLineString.prototype,"rotate",ol.geom.MultiLineString.prototype.rotate);goog.exportProperty(ol.geom.MultiLineString.prototype,"scale",ol.geom.MultiLineString.prototype.scale);goog.exportProperty(ol.geom.MultiLineString.prototype,"getClosestPoint",ol.geom.MultiLineString.prototype.getClosestPoint);goog.exportProperty(ol.geom.MultiLineString.prototype,"intersectsCoordinate",ol.geom.MultiLineString.prototype.intersectsCoordinate);goog.exportProperty(ol.geom.MultiLineString.prototype,"getExtent",ol.geom.MultiLineString.prototype.getExtent);goog.exportProperty(ol.geom.MultiLineString.prototype,"simplify",ol.geom.MultiLineString.prototype.simplify);goog.exportProperty(ol.geom.MultiLineString.prototype,"transform",ol.geom.MultiLineString.prototype.transform);goog.exportProperty(ol.geom.MultiLineString.prototype,"get",ol.geom.MultiLineString.prototype.get);goog.exportProperty(ol.geom.MultiLineString.prototype,"getKeys",ol.geom.MultiLineString.prototype.getKeys);goog.exportProperty(ol.geom.MultiLineString.prototype,"getProperties",ol.geom.MultiLineString.prototype.getProperties);goog.exportProperty(ol.geom.MultiLineString.prototype,"set",ol.geom.MultiLineString.prototype.set);goog.exportProperty(ol.geom.MultiLineString.prototype,"setProperties",ol.geom.MultiLineString.prototype.setProperties);goog.exportProperty(ol.geom.MultiLineString.prototype,"unset",ol.geom.MultiLineString.prototype.unset);goog.exportProperty(ol.geom.MultiLineString.prototype,"changed",ol.geom.MultiLineString.prototype.changed);goog.exportProperty(ol.geom.MultiLineString.prototype,"dispatchEvent",ol.geom.MultiLineString.prototype.dispatchEvent);goog.exportProperty(ol.geom.MultiLineString.prototype,"getRevision",ol.geom.MultiLineString.prototype.getRevision);goog.exportProperty(ol.geom.MultiLineString.prototype,"on",ol.geom.MultiLineString.prototype.on);goog.exportProperty(ol.geom.MultiLineString.prototype,"once",ol.geom.MultiLineString.prototype.once);goog.exportProperty(ol.geom.MultiLineString.prototype,"un",ol.geom.MultiLineString.prototype.un);goog.exportProperty(ol.geom.MultiPoint.prototype,"getFirstCoordinate",ol.geom.MultiPoint.prototype.getFirstCoordinate);goog.exportProperty(ol.geom.MultiPoint.prototype,"getLastCoordinate",ol.geom.MultiPoint.prototype.getLastCoordinate);goog.exportProperty(ol.geom.MultiPoint.prototype,"getLayout",ol.geom.MultiPoint.prototype.getLayout);goog.exportProperty(ol.geom.MultiPoint.prototype,"rotate",ol.geom.MultiPoint.prototype.rotate);goog.exportProperty(ol.geom.MultiPoint.prototype,"scale",ol.geom.MultiPoint.prototype.scale);goog.exportProperty(ol.geom.MultiPoint.prototype,"getClosestPoint",ol.geom.MultiPoint.prototype.getClosestPoint);goog.exportProperty(ol.geom.MultiPoint.prototype,"intersectsCoordinate",ol.geom.MultiPoint.prototype.intersectsCoordinate);goog.exportProperty(ol.geom.MultiPoint.prototype,"getExtent",ol.geom.MultiPoint.prototype.getExtent);goog.exportProperty(ol.geom.MultiPoint.prototype,"simplify",ol.geom.MultiPoint.prototype.simplify);goog.exportProperty(ol.geom.MultiPoint.prototype,"transform",ol.geom.MultiPoint.prototype.transform);goog.exportProperty(ol.geom.MultiPoint.prototype,"get",ol.geom.MultiPoint.prototype.get);goog.exportProperty(ol.geom.MultiPoint.prototype,"getKeys",ol.geom.MultiPoint.prototype.getKeys);goog.exportProperty(ol.geom.MultiPoint.prototype,"getProperties",ol.geom.MultiPoint.prototype.getProperties);goog.exportProperty(ol.geom.MultiPoint.prototype,"set",ol.geom.MultiPoint.prototype.set);goog.exportProperty(ol.geom.MultiPoint.prototype,"setProperties",ol.geom.MultiPoint.prototype.setProperties);goog.exportProperty(ol.geom.MultiPoint.prototype,"unset",ol.geom.MultiPoint.prototype.unset);goog.exportProperty(ol.geom.MultiPoint.prototype,"changed",ol.geom.MultiPoint.prototype.changed);goog.exportProperty(ol.geom.MultiPoint.prototype,"dispatchEvent",ol.geom.MultiPoint.prototype.dispatchEvent);goog.exportProperty(ol.geom.MultiPoint.prototype,"getRevision",ol.geom.MultiPoint.prototype.getRevision);goog.exportProperty(ol.geom.MultiPoint.prototype,"on",ol.geom.MultiPoint.prototype.on);goog.exportProperty(ol.geom.MultiPoint.prototype,"once",ol.geom.MultiPoint.prototype.once);goog.exportProperty(ol.geom.MultiPoint.prototype,"un",ol.geom.MultiPoint.prototype.un);goog.exportProperty(ol.geom.MultiPolygon.prototype,"getFirstCoordinate",ol.geom.MultiPolygon.prototype.getFirstCoordinate);goog.exportProperty(ol.geom.MultiPolygon.prototype,"getLastCoordinate",ol.geom.MultiPolygon.prototype.getLastCoordinate);goog.exportProperty(ol.geom.MultiPolygon.prototype,"getLayout",ol.geom.MultiPolygon.prototype.getLayout);goog.exportProperty(ol.geom.MultiPolygon.prototype,"rotate",ol.geom.MultiPolygon.prototype.rotate);goog.exportProperty(ol.geom.MultiPolygon.prototype,"scale",ol.geom.MultiPolygon.prototype.scale);goog.exportProperty(ol.geom.MultiPolygon.prototype,"getClosestPoint",ol.geom.MultiPolygon.prototype.getClosestPoint);goog.exportProperty(ol.geom.MultiPolygon.prototype,"intersectsCoordinate",ol.geom.MultiPolygon.prototype.intersectsCoordinate);goog.exportProperty(ol.geom.MultiPolygon.prototype,"getExtent",ol.geom.MultiPolygon.prototype.getExtent);goog.exportProperty(ol.geom.MultiPolygon.prototype,"simplify",ol.geom.MultiPolygon.prototype.simplify);goog.exportProperty(ol.geom.MultiPolygon.prototype,"transform",ol.geom.MultiPolygon.prototype.transform);goog.exportProperty(ol.geom.MultiPolygon.prototype,"get",ol.geom.MultiPolygon.prototype.get);goog.exportProperty(ol.geom.MultiPolygon.prototype,"getKeys",ol.geom.MultiPolygon.prototype.getKeys);goog.exportProperty(ol.geom.MultiPolygon.prototype,"getProperties",ol.geom.MultiPolygon.prototype.getProperties);goog.exportProperty(ol.geom.MultiPolygon.prototype,"set",ol.geom.MultiPolygon.prototype.set);goog.exportProperty(ol.geom.MultiPolygon.prototype,"setProperties",ol.geom.MultiPolygon.prototype.setProperties);goog.exportProperty(ol.geom.MultiPolygon.prototype,"unset",ol.geom.MultiPolygon.prototype.unset);goog.exportProperty(ol.geom.MultiPolygon.prototype,"changed",ol.geom.MultiPolygon.prototype.changed);goog.exportProperty(ol.geom.MultiPolygon.prototype,"dispatchEvent",ol.geom.MultiPolygon.prototype.dispatchEvent);goog.exportProperty(ol.geom.MultiPolygon.prototype,"getRevision",ol.geom.MultiPolygon.prototype.getRevision);goog.exportProperty(ol.geom.MultiPolygon.prototype,"on",ol.geom.MultiPolygon.prototype.on);goog.exportProperty(ol.geom.MultiPolygon.prototype,"once",ol.geom.MultiPolygon.prototype.once);goog.exportProperty(ol.geom.MultiPolygon.prototype,"un",ol.geom.MultiPolygon.prototype.un);goog.exportProperty(ol.geom.Point.prototype,"getFirstCoordinate",ol.geom.Point.prototype.getFirstCoordinate);goog.exportProperty(ol.geom.Point.prototype,"getLastCoordinate",ol.geom.Point.prototype.getLastCoordinate);goog.exportProperty(ol.geom.Point.prototype,"getLayout",ol.geom.Point.prototype.getLayout);goog.exportProperty(ol.geom.Point.prototype,"rotate",ol.geom.Point.prototype.rotate);goog.exportProperty(ol.geom.Point.prototype,"scale",ol.geom.Point.prototype.scale);goog.exportProperty(ol.geom.Point.prototype,"getClosestPoint",ol.geom.Point.prototype.getClosestPoint);goog.exportProperty(ol.geom.Point.prototype,"intersectsCoordinate",ol.geom.Point.prototype.intersectsCoordinate);goog.exportProperty(ol.geom.Point.prototype,"getExtent",ol.geom.Point.prototype.getExtent);goog.exportProperty(ol.geom.Point.prototype,"simplify",ol.geom.Point.prototype.simplify);goog.exportProperty(ol.geom.Point.prototype,"transform",ol.geom.Point.prototype.transform);goog.exportProperty(ol.geom.Point.prototype,"get",ol.geom.Point.prototype.get);goog.exportProperty(ol.geom.Point.prototype,"getKeys",ol.geom.Point.prototype.getKeys);goog.exportProperty(ol.geom.Point.prototype,"getProperties",ol.geom.Point.prototype.getProperties);goog.exportProperty(ol.geom.Point.prototype,"set",ol.geom.Point.prototype.set);goog.exportProperty(ol.geom.Point.prototype,"setProperties",ol.geom.Point.prototype.setProperties);goog.exportProperty(ol.geom.Point.prototype,"unset",ol.geom.Point.prototype.unset);goog.exportProperty(ol.geom.Point.prototype,"changed",ol.geom.Point.prototype.changed);goog.exportProperty(ol.geom.Point.prototype,"dispatchEvent",ol.geom.Point.prototype.dispatchEvent);goog.exportProperty(ol.geom.Point.prototype,"getRevision",ol.geom.Point.prototype.getRevision);goog.exportProperty(ol.geom.Point.prototype,"on",ol.geom.Point.prototype.on);goog.exportProperty(ol.geom.Point.prototype,"once",ol.geom.Point.prototype.once);goog.exportProperty(ol.geom.Point.prototype,"un",ol.geom.Point.prototype.un);goog.exportProperty(ol.geom.Polygon.prototype,"getFirstCoordinate",ol.geom.Polygon.prototype.getFirstCoordinate);goog.exportProperty(ol.geom.Polygon.prototype,"getLastCoordinate",ol.geom.Polygon.prototype.getLastCoordinate);goog.exportProperty(ol.geom.Polygon.prototype,"getLayout",ol.geom.Polygon.prototype.getLayout);goog.exportProperty(ol.geom.Polygon.prototype,"rotate",ol.geom.Polygon.prototype.rotate);goog.exportProperty(ol.geom.Polygon.prototype,"scale",ol.geom.Polygon.prototype.scale);goog.exportProperty(ol.geom.Polygon.prototype,"getClosestPoint",ol.geom.Polygon.prototype.getClosestPoint);goog.exportProperty(ol.geom.Polygon.prototype,"intersectsCoordinate",ol.geom.Polygon.prototype.intersectsCoordinate);goog.exportProperty(ol.geom.Polygon.prototype,"getExtent",ol.geom.Polygon.prototype.getExtent);goog.exportProperty(ol.geom.Polygon.prototype,"simplify",ol.geom.Polygon.prototype.simplify);goog.exportProperty(ol.geom.Polygon.prototype,"transform",ol.geom.Polygon.prototype.transform);goog.exportProperty(ol.geom.Polygon.prototype,"get",ol.geom.Polygon.prototype.get);goog.exportProperty(ol.geom.Polygon.prototype,"getKeys",ol.geom.Polygon.prototype.getKeys);goog.exportProperty(ol.geom.Polygon.prototype,"getProperties",ol.geom.Polygon.prototype.getProperties);goog.exportProperty(ol.geom.Polygon.prototype,"set",ol.geom.Polygon.prototype.set);goog.exportProperty(ol.geom.Polygon.prototype,"setProperties",ol.geom.Polygon.prototype.setProperties);goog.exportProperty(ol.geom.Polygon.prototype,"unset",ol.geom.Polygon.prototype.unset);goog.exportProperty(ol.geom.Polygon.prototype,"changed",ol.geom.Polygon.prototype.changed);goog.exportProperty(ol.geom.Polygon.prototype,"dispatchEvent",ol.geom.Polygon.prototype.dispatchEvent);goog.exportProperty(ol.geom.Polygon.prototype,"getRevision",ol.geom.Polygon.prototype.getRevision);goog.exportProperty(ol.geom.Polygon.prototype,"on",ol.geom.Polygon.prototype.on);goog.exportProperty(ol.geom.Polygon.prototype,"once",ol.geom.Polygon.prototype.once);goog.exportProperty(ol.geom.Polygon.prototype,"un",ol.geom.Polygon.prototype.un);goog.exportProperty(ol.format.GML.prototype,"readFeatures",ol.format.GML.prototype.readFeatures);goog.exportProperty(ol.format.GML2.prototype,"readFeatures",ol.format.GML2.prototype.readFeatures);goog.exportProperty(ol.format.GML3.prototype,"readFeatures",ol.format.GML3.prototype.readFeatures);goog.exportProperty(ol.control.Control.prototype,"get",ol.control.Control.prototype.get);goog.exportProperty(ol.control.Control.prototype,"getKeys",ol.control.Control.prototype.getKeys);goog.exportProperty(ol.control.Control.prototype,"getProperties",ol.control.Control.prototype.getProperties);goog.exportProperty(ol.control.Control.prototype,"set",ol.control.Control.prototype.set);goog.exportProperty(ol.control.Control.prototype,"setProperties",ol.control.Control.prototype.setProperties);goog.exportProperty(ol.control.Control.prototype,"unset",ol.control.Control.prototype.unset);goog.exportProperty(ol.control.Control.prototype,"changed",ol.control.Control.prototype.changed);goog.exportProperty(ol.control.Control.prototype,"dispatchEvent",ol.control.Control.prototype.dispatchEvent);goog.exportProperty(ol.control.Control.prototype,"getRevision",ol.control.Control.prototype.getRevision);goog.exportProperty(ol.control.Control.prototype,"on",ol.control.Control.prototype.on);goog.exportProperty(ol.control.Control.prototype,"once",ol.control.Control.prototype.once);goog.exportProperty(ol.control.Control.prototype,"un",ol.control.Control.prototype.un);goog.exportProperty(ol.control.Attribution.prototype,"getMap",ol.control.Attribution.prototype.getMap);goog.exportProperty(ol.control.Attribution.prototype,"setMap",ol.control.Attribution.prototype.setMap);goog.exportProperty(ol.control.Attribution.prototype,"setTarget",ol.control.Attribution.prototype.setTarget);goog.exportProperty(ol.control.Attribution.prototype,"get",ol.control.Attribution.prototype.get);goog.exportProperty(ol.control.Attribution.prototype,"getKeys",ol.control.Attribution.prototype.getKeys);goog.exportProperty(ol.control.Attribution.prototype,"getProperties",ol.control.Attribution.prototype.getProperties);goog.exportProperty(ol.control.Attribution.prototype,"set",ol.control.Attribution.prototype.set);goog.exportProperty(ol.control.Attribution.prototype,"setProperties",ol.control.Attribution.prototype.setProperties);goog.exportProperty(ol.control.Attribution.prototype,"unset",ol.control.Attribution.prototype.unset);goog.exportProperty(ol.control.Attribution.prototype,"changed",ol.control.Attribution.prototype.changed);goog.exportProperty(ol.control.Attribution.prototype,"dispatchEvent",ol.control.Attribution.prototype.dispatchEvent);goog.exportProperty(ol.control.Attribution.prototype,"getRevision",ol.control.Attribution.prototype.getRevision);goog.exportProperty(ol.control.Attribution.prototype,"on",ol.control.Attribution.prototype.on);goog.exportProperty(ol.control.Attribution.prototype,"once",ol.control.Attribution.prototype.once);goog.exportProperty(ol.control.Attribution.prototype,"un",ol.control.Attribution.prototype.un);goog.exportProperty(ol.control.FullScreen.prototype,"getMap",ol.control.FullScreen.prototype.getMap);goog.exportProperty(ol.control.FullScreen.prototype,"setMap",ol.control.FullScreen.prototype.setMap);goog.exportProperty(ol.control.FullScreen.prototype,"setTarget",ol.control.FullScreen.prototype.setTarget);goog.exportProperty(ol.control.FullScreen.prototype,"get",ol.control.FullScreen.prototype.get);goog.exportProperty(ol.control.FullScreen.prototype,"getKeys",ol.control.FullScreen.prototype.getKeys);goog.exportProperty(ol.control.FullScreen.prototype,"getProperties",ol.control.FullScreen.prototype.getProperties);goog.exportProperty(ol.control.FullScreen.prototype,"set",ol.control.FullScreen.prototype.set);goog.exportProperty(ol.control.FullScreen.prototype,"setProperties",ol.control.FullScreen.prototype.setProperties);goog.exportProperty(ol.control.FullScreen.prototype,"unset",ol.control.FullScreen.prototype.unset);goog.exportProperty(ol.control.FullScreen.prototype,"changed",ol.control.FullScreen.prototype.changed);goog.exportProperty(ol.control.FullScreen.prototype,"dispatchEvent",ol.control.FullScreen.prototype.dispatchEvent);goog.exportProperty(ol.control.FullScreen.prototype,"getRevision",ol.control.FullScreen.prototype.getRevision);goog.exportProperty(ol.control.FullScreen.prototype,"on",ol.control.FullScreen.prototype.on);goog.exportProperty(ol.control.FullScreen.prototype,"once",ol.control.FullScreen.prototype.once);goog.exportProperty(ol.control.FullScreen.prototype,"un",ol.control.FullScreen.prototype.un);goog.exportProperty(ol.control.MousePosition.prototype,"getMap",ol.control.MousePosition.prototype.getMap);goog.exportProperty(ol.control.MousePosition.prototype,"setMap",ol.control.MousePosition.prototype.setMap);goog.exportProperty(ol.control.MousePosition.prototype,"setTarget",ol.control.MousePosition.prototype.setTarget);goog.exportProperty(ol.control.MousePosition.prototype,"get",ol.control.MousePosition.prototype.get);goog.exportProperty(ol.control.MousePosition.prototype,"getKeys",ol.control.MousePosition.prototype.getKeys);goog.exportProperty(ol.control.MousePosition.prototype,"getProperties",ol.control.MousePosition.prototype.getProperties);goog.exportProperty(ol.control.MousePosition.prototype,"set",ol.control.MousePosition.prototype.set);goog.exportProperty(ol.control.MousePosition.prototype,"setProperties",ol.control.MousePosition.prototype.setProperties);goog.exportProperty(ol.control.MousePosition.prototype,"unset",ol.control.MousePosition.prototype.unset);goog.exportProperty(ol.control.MousePosition.prototype,"changed",ol.control.MousePosition.prototype.changed);goog.exportProperty(ol.control.MousePosition.prototype,"dispatchEvent",ol.control.MousePosition.prototype.dispatchEvent);goog.exportProperty(ol.control.MousePosition.prototype,"getRevision",ol.control.MousePosition.prototype.getRevision);goog.exportProperty(ol.control.MousePosition.prototype,"on",ol.control.MousePosition.prototype.on);goog.exportProperty(ol.control.MousePosition.prototype,"once",ol.control.MousePosition.prototype.once);goog.exportProperty(ol.control.MousePosition.prototype,"un",ol.control.MousePosition.prototype.un);goog.exportProperty(ol.control.OverviewMap.prototype,"getMap",ol.control.OverviewMap.prototype.getMap);goog.exportProperty(ol.control.OverviewMap.prototype,"setMap",ol.control.OverviewMap.prototype.setMap);goog.exportProperty(ol.control.OverviewMap.prototype,"setTarget",ol.control.OverviewMap.prototype.setTarget);goog.exportProperty(ol.control.OverviewMap.prototype,"get",ol.control.OverviewMap.prototype.get);goog.exportProperty(ol.control.OverviewMap.prototype,"getKeys",ol.control.OverviewMap.prototype.getKeys);goog.exportProperty(ol.control.OverviewMap.prototype,"getProperties",ol.control.OverviewMap.prototype.getProperties);goog.exportProperty(ol.control.OverviewMap.prototype,"set",ol.control.OverviewMap.prototype.set);goog.exportProperty(ol.control.OverviewMap.prototype,"setProperties",ol.control.OverviewMap.prototype.setProperties);goog.exportProperty(ol.control.OverviewMap.prototype,"unset",ol.control.OverviewMap.prototype.unset);goog.exportProperty(ol.control.OverviewMap.prototype,"changed",ol.control.OverviewMap.prototype.changed);goog.exportProperty(ol.control.OverviewMap.prototype,"dispatchEvent",ol.control.OverviewMap.prototype.dispatchEvent);goog.exportProperty(ol.control.OverviewMap.prototype,"getRevision",ol.control.OverviewMap.prototype.getRevision);goog.exportProperty(ol.control.OverviewMap.prototype,"on",ol.control.OverviewMap.prototype.on);goog.exportProperty(ol.control.OverviewMap.prototype,"once",ol.control.OverviewMap.prototype.once);goog.exportProperty(ol.control.OverviewMap.prototype,"un",ol.control.OverviewMap.prototype.un);goog.exportProperty(ol.control.Rotate.prototype,"getMap",ol.control.Rotate.prototype.getMap);goog.exportProperty(ol.control.Rotate.prototype,"setMap",ol.control.Rotate.prototype.setMap);goog.exportProperty(ol.control.Rotate.prototype,"setTarget",ol.control.Rotate.prototype.setTarget);goog.exportProperty(ol.control.Rotate.prototype,"get",ol.control.Rotate.prototype.get);goog.exportProperty(ol.control.Rotate.prototype,"getKeys",ol.control.Rotate.prototype.getKeys);goog.exportProperty(ol.control.Rotate.prototype,"getProperties",ol.control.Rotate.prototype.getProperties);goog.exportProperty(ol.control.Rotate.prototype,"set",ol.control.Rotate.prototype.set);goog.exportProperty(ol.control.Rotate.prototype,"setProperties",ol.control.Rotate.prototype.setProperties);goog.exportProperty(ol.control.Rotate.prototype,"unset",ol.control.Rotate.prototype.unset);goog.exportProperty(ol.control.Rotate.prototype,"changed",ol.control.Rotate.prototype.changed);goog.exportProperty(ol.control.Rotate.prototype,"dispatchEvent",ol.control.Rotate.prototype.dispatchEvent);goog.exportProperty(ol.control.Rotate.prototype,"getRevision",ol.control.Rotate.prototype.getRevision);goog.exportProperty(ol.control.Rotate.prototype,"on",ol.control.Rotate.prototype.on);goog.exportProperty(ol.control.Rotate.prototype,"once",ol.control.Rotate.prototype.once);goog.exportProperty(ol.control.Rotate.prototype,"un",ol.control.Rotate.prototype.un);goog.exportProperty(ol.control.ScaleLine.prototype,"getMap",ol.control.ScaleLine.prototype.getMap);goog.exportProperty(ol.control.ScaleLine.prototype,"setMap",ol.control.ScaleLine.prototype.setMap);goog.exportProperty(ol.control.ScaleLine.prototype,"setTarget",ol.control.ScaleLine.prototype.setTarget);goog.exportProperty(ol.control.ScaleLine.prototype,"get",ol.control.ScaleLine.prototype.get);goog.exportProperty(ol.control.ScaleLine.prototype,"getKeys",ol.control.ScaleLine.prototype.getKeys);goog.exportProperty(ol.control.ScaleLine.prototype,"getProperties",ol.control.ScaleLine.prototype.getProperties);goog.exportProperty(ol.control.ScaleLine.prototype,"set",ol.control.ScaleLine.prototype.set);goog.exportProperty(ol.control.ScaleLine.prototype,"setProperties",ol.control.ScaleLine.prototype.setProperties);goog.exportProperty(ol.control.ScaleLine.prototype,"unset",ol.control.ScaleLine.prototype.unset);goog.exportProperty(ol.control.ScaleLine.prototype,"changed",ol.control.ScaleLine.prototype.changed);goog.exportProperty(ol.control.ScaleLine.prototype,"dispatchEvent",ol.control.ScaleLine.prototype.dispatchEvent);goog.exportProperty(ol.control.ScaleLine.prototype,"getRevision",ol.control.ScaleLine.prototype.getRevision);goog.exportProperty(ol.control.ScaleLine.prototype,"on",ol.control.ScaleLine.prototype.on);goog.exportProperty(ol.control.ScaleLine.prototype,"once",ol.control.ScaleLine.prototype.once);goog.exportProperty(ol.control.ScaleLine.prototype,"un",ol.control.ScaleLine.prototype.un);goog.exportProperty(ol.control.Zoom.prototype,"getMap",ol.control.Zoom.prototype.getMap);goog.exportProperty(ol.control.Zoom.prototype,"setMap",ol.control.Zoom.prototype.setMap);goog.exportProperty(ol.control.Zoom.prototype,"setTarget",ol.control.Zoom.prototype.setTarget);goog.exportProperty(ol.control.Zoom.prototype,"get",ol.control.Zoom.prototype.get);goog.exportProperty(ol.control.Zoom.prototype,"getKeys",ol.control.Zoom.prototype.getKeys);goog.exportProperty(ol.control.Zoom.prototype,"getProperties",ol.control.Zoom.prototype.getProperties);goog.exportProperty(ol.control.Zoom.prototype,"set",ol.control.Zoom.prototype.set);goog.exportProperty(ol.control.Zoom.prototype,"setProperties",ol.control.Zoom.prototype.setProperties);goog.exportProperty(ol.control.Zoom.prototype,"unset",ol.control.Zoom.prototype.unset);goog.exportProperty(ol.control.Zoom.prototype,"changed",ol.control.Zoom.prototype.changed);goog.exportProperty(ol.control.Zoom.prototype,"dispatchEvent",ol.control.Zoom.prototype.dispatchEvent);goog.exportProperty(ol.control.Zoom.prototype,"getRevision",ol.control.Zoom.prototype.getRevision);goog.exportProperty(ol.control.Zoom.prototype,"on",ol.control.Zoom.prototype.on);goog.exportProperty(ol.control.Zoom.prototype,"once",ol.control.Zoom.prototype.once);goog.exportProperty(ol.control.Zoom.prototype,"un",ol.control.Zoom.prototype.un);goog.exportProperty(ol.control.ZoomSlider.prototype,"getMap",ol.control.ZoomSlider.prototype.getMap);goog.exportProperty(ol.control.ZoomSlider.prototype,"setMap",ol.control.ZoomSlider.prototype.setMap);goog.exportProperty(ol.control.ZoomSlider.prototype,"setTarget",ol.control.ZoomSlider.prototype.setTarget);goog.exportProperty(ol.control.ZoomSlider.prototype,"get",ol.control.ZoomSlider.prototype.get);goog.exportProperty(ol.control.ZoomSlider.prototype,"getKeys",ol.control.ZoomSlider.prototype.getKeys);goog.exportProperty(ol.control.ZoomSlider.prototype,"getProperties",ol.control.ZoomSlider.prototype.getProperties);goog.exportProperty(ol.control.ZoomSlider.prototype,"set",ol.control.ZoomSlider.prototype.set);goog.exportProperty(ol.control.ZoomSlider.prototype,"setProperties",ol.control.ZoomSlider.prototype.setProperties);goog.exportProperty(ol.control.ZoomSlider.prototype,"unset",ol.control.ZoomSlider.prototype.unset);goog.exportProperty(ol.control.ZoomSlider.prototype,"changed",ol.control.ZoomSlider.prototype.changed);goog.exportProperty(ol.control.ZoomSlider.prototype,"dispatchEvent",ol.control.ZoomSlider.prototype.dispatchEvent);goog.exportProperty(ol.control.ZoomSlider.prototype,"getRevision",ol.control.ZoomSlider.prototype.getRevision);goog.exportProperty(ol.control.ZoomSlider.prototype,"on",ol.control.ZoomSlider.prototype.on);goog.exportProperty(ol.control.ZoomSlider.prototype,"once",ol.control.ZoomSlider.prototype.once);goog.exportProperty(ol.control.ZoomSlider.prototype,"un",ol.control.ZoomSlider.prototype.un);goog.exportProperty(ol.control.ZoomToExtent.prototype,"getMap",ol.control.ZoomToExtent.prototype.getMap);goog.exportProperty(ol.control.ZoomToExtent.prototype,"setMap",ol.control.ZoomToExtent.prototype.setMap);goog.exportProperty(ol.control.ZoomToExtent.prototype,"setTarget",ol.control.ZoomToExtent.prototype.setTarget);goog.exportProperty(ol.control.ZoomToExtent.prototype,"get",ol.control.ZoomToExtent.prototype.get);goog.exportProperty(ol.control.ZoomToExtent.prototype,"getKeys",ol.control.ZoomToExtent.prototype.getKeys);goog.exportProperty(ol.control.ZoomToExtent.prototype,"getProperties",ol.control.ZoomToExtent.prototype.getProperties);goog.exportProperty(ol.control.ZoomToExtent.prototype,"set",ol.control.ZoomToExtent.prototype.set);goog.exportProperty(ol.control.ZoomToExtent.prototype,"setProperties",ol.control.ZoomToExtent.prototype.setProperties);goog.exportProperty(ol.control.ZoomToExtent.prototype,"unset",ol.control.ZoomToExtent.prototype.unset);goog.exportProperty(ol.control.ZoomToExtent.prototype,"changed",ol.control.ZoomToExtent.prototype.changed);goog.exportProperty(ol.control.ZoomToExtent.prototype,"dispatchEvent",ol.control.ZoomToExtent.prototype.dispatchEvent);goog.exportProperty(ol.control.ZoomToExtent.prototype,"getRevision",ol.control.ZoomToExtent.prototype.getRevision);goog.exportProperty(ol.control.ZoomToExtent.prototype,"on",ol.control.ZoomToExtent.prototype.on);goog.exportProperty(ol.control.ZoomToExtent.prototype,"once",ol.control.ZoomToExtent.prototype.once);goog.exportProperty(ol.control.ZoomToExtent.prototype,"un",ol.control.ZoomToExtent.prototype.un);ol.VERSION="v4.1.0";OPENLAYERS.ol=ol;return OPENLAYERS.ol});!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.proj4=e()}}(function(){return function e(t,o,r){function i(a,l){if(!o[a]){if(!t[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(n)return n(a,!0);throw Error("Cannot find module '"+a+"'")}var p=o[a]={exports:{}};t[a][0].call(p.exports,function(e){var o=t[a][1][e];return i(o?o:e)},p,p.exports,e,t,o,r)}return o[a].exports}for(var n="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t){function o(e,t,r){if(!(this instanceof o))return new o(e,t,r);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if("object"==typeof e)this.x=e.x,this.y=e.y,this.z=e.z||0;else if("string"==typeof e&&void 0===t){var i=e.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=e,this.y=t,this.z=r||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var r=e("mgrs");o.fromMGRS=function(e){return new o(r.toPoint(e))},o.prototype.toMGRS=function(e){
return r.forward([this.x,this.y],e)},t.exports=o},{mgrs:67}],2:[function(e,t){function o(e,t){if(!(this instanceof o))return new o(e);t=t||function(e){if(e)throw e};var n=r(e);if("object"!=typeof n)return void t(e);var l=a(n),s=o.projections.get(l.projName);s?(i(this,l),i(this,s),this.init(),t(null,this)):t(e)}var r=e("./parseCode"),i=e("./extend"),n=e("./projections"),a=e("./deriveConstants");o.projections=n,o.projections.start(),t.exports=o},{"./deriveConstants":33,"./extend":34,"./parseCode":37,"./projections":39}],3:[function(e,t){t.exports=function(e,t,o){var r,i,n,a=o.x,l=o.y,s=o.z||0;for(n=0;3>n;n++)if(!t||2!==n||void 0!==o.z)switch(0===n?(r=a,i="x"):1===n?(r=l,i="y"):(r=s,i="z"),e.axis[n]){case"e":o[i]=r;break;case"w":o[i]=-r;break;case"n":o[i]=r;break;case"s":o[i]=-r;break;case"u":void 0!==o[i]&&(o.z=r);break;case"d":void 0!==o[i]&&(o.z=-r);break;default:return null}return o}},{}],4:[function(e,t){var o=Math.PI/2,r=e("./sign");t.exports=function(e){return Math.abs(e)<o?e:e-r(e)*Math.PI}},{"./sign":21}],5:[function(e,t){var o=2*Math.PI,r=3.14159265359,i=e("./sign");t.exports=function(e){return Math.abs(e)>r?e-i(e)*o:e}},{"./sign":21}],6:[function(e,t){t.exports=function(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)}},{}],7:[function(e,t){t.exports=function(e){return 1-.25*e*(1+e/16*(3+1.25*e))}},{}],8:[function(e,t){t.exports=function(e){return.375*e*(1+.25*e*(1+.46875*e))}},{}],9:[function(e,t){t.exports=function(e){return.05859375*e*e*(1+.75*e)}},{}],10:[function(e,t){t.exports=function(e){return e*e*e*(35/3072)}},{}],11:[function(e,t){t.exports=function(e,t,o){var r=t*o;return e/Math.sqrt(1-r*r)}},{}],12:[function(e,t){t.exports=function(e,t,o,r,i){var n,a;n=e/t;for(var l=0;15>l;l++)if(a=(e-(t*n-o*Math.sin(2*n)+r*Math.sin(4*n)-i*Math.sin(6*n)))/(t-2*o*Math.cos(2*n)+4*r*Math.cos(4*n)-6*i*Math.cos(6*n)),n+=a,Math.abs(a)<=1e-10)return n;return 0/0}},{}],13:[function(e,t){var o=Math.PI/2;t.exports=function(e,t){var r=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(t)-r)<1e-6)return 0>t?-1*o:o;for(var i,n,a,l,s=Math.asin(.5*t),p=0;30>p;p++)if(n=Math.sin(s),a=Math.cos(s),l=e*n,i=Math.pow(1-l*l,2)/(2*a)*(t/(1-e*e)-n/(1-l*l)+.5/e*Math.log((1-l)/(1+l))),s+=i,Math.abs(i)<=1e-10)return s;return 0/0}},{}],14:[function(e,t){t.exports=function(e,t,o,r,i){return e*i-t*Math.sin(2*i)+o*Math.sin(4*i)-r*Math.sin(6*i)}},{}],15:[function(e,t){t.exports=function(e,t,o){var r=e*t;return o/Math.sqrt(1-r*r)}},{}],16:[function(e,t){var o=Math.PI/2;t.exports=function(e,t){for(var r,i,n=.5*e,a=o-2*Math.atan(t),l=0;15>=l;l++)if(r=e*Math.sin(a),i=o-2*Math.atan(t*Math.pow((1-r)/(1+r),n))-a,a+=i,Math.abs(i)<=1e-10)return a;return-9999}},{}],17:[function(e,t){var o=1,r=.25,i=.046875,n=.01953125,a=.01068115234375,l=.75,s=.46875,p=.013020833333333334,c=.007120768229166667,u=.3645833333333333,g=.005696614583333333,d=.3076171875;t.exports=function(e){var t=[];t[0]=o-e*(r+e*(i+e*(n+e*a))),t[1]=e*(l-e*(i+e*(n+e*a)));var h=e*e;return t[2]=h*(s-e*(p+e*c)),h*=e,t[3]=h*(u-e*g),t[4]=h*e*d,t}},{}],18:[function(e,t){var o=e("./pj_mlfn"),r=1e-10,i=20;t.exports=function(e,t,n){for(var a=1/(1-t),l=e,s=i;s;--s){var p=Math.sin(l),c=1-t*p*p;if(c=(o(l,p,Math.cos(l),n)-e)*c*Math.sqrt(c)*a,l-=c,Math.abs(c)<r)return l}return l}},{"./pj_mlfn":19}],19:[function(e,t){t.exports=function(e,t,o,r){return o*=t,t*=t,r[0]*e-o*(r[1]+t*(r[2]+t*(r[3]+t*r[4])))}},{}],20:[function(e,t){t.exports=function(e,t){var o;return e>1e-7?(o=e*t,(1-e*e)*(t/(1-o*o)-.5/e*Math.log((1-o)/(1+o)))):2*t}},{}],21:[function(e,t){t.exports=function(e){return 0>e?-1:1}},{}],22:[function(e,t){t.exports=function(e,t){return Math.pow((1-e)/(1+e),t)}},{}],23:[function(e,t){t.exports=function(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t}},{}],24:[function(e,t){var o=Math.PI/2;t.exports=function(e,t,r){var i=e*r,n=.5*e;return i=Math.pow((1-i)/(1+i),n),Math.tan(.5*(o-t))/i}},{}],25:[function(e,t,o){o.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},o.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},o.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},o.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},o.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},o.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},o.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},o.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},o.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},o.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},o.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},o.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},o.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},o.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},o.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},o.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},{}],26:[function(e,t,o){o.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},o.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},o.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},o.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},o.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},o.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},o.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},o.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},o.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},o.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},o.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},o.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},o.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},o.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},o.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},o.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},o.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},o.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},o.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},o.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},o.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},o.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},o.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},o.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},o.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},o.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},o.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},o.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},o.hough={a:6378270,rf:297,ellipseName:"Hough"},o.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},o.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},o.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},o.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},o.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},o.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},o.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},o.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},o.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},o.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},o.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},o.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"},o.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"},o.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},{}],27:[function(e,t,o){o.greenwich=0,o.lisbon=-9.131906111111,o.paris=2.337229166667,o.bogota=-74.080916666667,o.madrid=-3.687938888889,o.rome=12.452333333333,o.bern=7.439583333333,o.jakarta=106.807719444444,o.ferro=-17.666666666667,o.brussels=4.367975,o.stockholm=18.058277777778,o.athens=23.7163375,o.oslo=10.722916666667},{}],28:[function(e,t,o){o.ft={to_meter:.3048},o["us-ft"]={to_meter:1200/3937}},{}],29:[function(e,t){function o(e,t,o){var r;return Array.isArray(o)?(r=a(e,t,o),4===o.length?[r.x,r.y,r.z,r.m]:3===o.length?[r.x,r.y,r.z]:[r.x,r.y]):a(e,t,o)}function r(e){return e instanceof n?e:e.oProj?e.oProj:n(e)}function i(e,t,i){e=r(e);var n,a=!1;return void 0===t?(t=e,e=l,a=!0):(void 0!==t.x||Array.isArray(t))&&(i=t,t=e,e=l,a=!0),t=r(t),i?o(e,t,i):(n={forward:function(r){return o(e,t,r)},inverse:function(r){return o(t,e,r)}},a&&(n.oProj=t),n)}var n=e("./Proj"),a=e("./transform"),l=n("WGS84");t.exports=i},{"./Proj":2,"./transform":65}],30:[function(e,t){var o=Math.PI/2,r=1,i=2,n=3,a=4,l=5,s=484813681109536e-20,p=1.0026,c=.3826834323650898,u=function(e){return this instanceof u?(this.datum_type=a,void(e&&(e.datumCode&&"none"===e.datumCode&&(this.datum_type=l),e.datum_params&&(this.datum_params=e.datum_params.map(parseFloat),(0!==this.datum_params[0]||0!==this.datum_params[1]||0!==this.datum_params[2])&&(this.datum_type=r),this.datum_params.length>3&&(0!==this.datum_params[3]||0!==this.datum_params[4]||0!==this.datum_params[5]||0!==this.datum_params[6])&&(this.datum_type=i,this.datum_params[3]*=s,this.datum_params[4]*=s,this.datum_params[5]*=s,this.datum_params[6]=this.datum_params[6]/1e6+1)),this.datum_type=e.grids?n:this.datum_type,this.a=e.a,this.b=e.b,this.es=e.es,this.ep2=e.ep2,this.datum_type===n&&(this.grids=e.grids)))):new u(e)};u.prototype={compare_datums:function(e){return this.datum_type!==e.datum_type?!1:this.a!==e.a||Math.abs(this.es-e.es)>5e-11?!1:this.datum_type===r?this.datum_params[0]===e.datum_params[0]&&this.datum_params[1]===e.datum_params[1]&&this.datum_params[2]===e.datum_params[2]:this.datum_type===i?this.datum_params[0]===e.datum_params[0]&&this.datum_params[1]===e.datum_params[1]&&this.datum_params[2]===e.datum_params[2]&&this.datum_params[3]===e.datum_params[3]&&this.datum_params[4]===e.datum_params[4]&&this.datum_params[5]===e.datum_params[5]&&this.datum_params[6]===e.datum_params[6]:this.datum_type===n||e.datum_type===n?this.nadgrids===e.nadgrids:!0},geodetic_to_geocentric:function(e){var t,r,i,n,a,l,s,p=e.x,c=e.y,u=e.z?e.z:0,g=0;if(-o>c&&c>-1.001*o)c=-o;else if(c>o&&1.001*o>c)c=o;else if(-o>c||c>o)return null;return p>Math.PI&&(p-=2*Math.PI),a=Math.sin(c),s=Math.cos(c),l=a*a,n=this.a/Math.sqrt(1-this.es*l),t=(n+u)*s*Math.cos(p),r=(n+u)*s*Math.sin(p),i=(n*(1-this.es)+u)*a,e.x=t,e.y=r,e.z=i,g},geocentric_to_geodetic:function(e){var t,r,i,n,a,l,s,p,c,u,g,d,h,f,y,m,v,C=1e-12,T=C*C,_=30,S=e.x,E=e.y,x=e.z?e.z:0;if(h=!1,t=Math.sqrt(S*S+E*E),r=Math.sqrt(S*S+E*E+x*x),t/this.a<C){if(h=!0,y=0,r/this.a<C)return m=o,void(v=-this.b)}else y=Math.atan2(E,S);i=x/r,n=t/r,a=1/Math.sqrt(1-this.es*(2-this.es)*n*n),p=n*(1-this.es)*a,c=i*a,f=0;do f++,s=this.a/Math.sqrt(1-this.es*c*c),v=t*p+x*c-s*(1-this.es*c*c),l=this.es*s/(s+v),a=1/Math.sqrt(1-l*(2-l)*n*n),u=n*(1-l)*a,g=i*a,d=g*p-u*c,p=u,c=g;while(d*d>T&&_>f);return m=Math.atan(g/Math.abs(u)),e.x=y,e.y=m,e.z=v,e},geocentric_to_geodetic_noniter:function(e){var t,r,i,n,a,l,s,u,g,d,h,f,y,m,v,C,T,_=e.x,S=e.y,E=e.z?e.z:0;if(_=parseFloat(_),S=parseFloat(S),E=parseFloat(E),T=!1,0!==_)t=Math.atan2(S,_);else if(S>0)t=o;else if(0>S)t=-o;else if(T=!0,t=0,E>0)r=o;else{if(E>=0)return r=o,void(i=-this.b);r=-o}return a=_*_+S*S,n=Math.sqrt(a),l=E*p,u=Math.sqrt(l*l+a),d=l/u,f=n/u,h=d*d*d,s=E+this.b*this.ep2*h,C=n-this.a*this.es*f*f*f,g=Math.sqrt(s*s+C*C),y=s/g,m=C/g,v=this.a/Math.sqrt(1-this.es*y*y),i=c>m?m>-c?E/y+v*(this.es-1):n/-m-v:n/m-v,T===!1&&(r=Math.atan(y/m)),e.x=t,e.y=r,e.z=i,e},geocentric_to_wgs84:function(e){if(this.datum_type===r)e.x+=this.datum_params[0],e.y+=this.datum_params[1],e.z+=this.datum_params[2];else if(this.datum_type===i){var t=this.datum_params[0],o=this.datum_params[1],n=this.datum_params[2],a=this.datum_params[3],l=this.datum_params[4],s=this.datum_params[5],p=this.datum_params[6],c=p*(e.x-s*e.y+l*e.z)+t,u=p*(s*e.x+e.y-a*e.z)+o,g=p*(-l*e.x+a*e.y+e.z)+n;e.x=c,e.y=u,e.z=g}},geocentric_from_wgs84:function(e){if(this.datum_type===r)e.x-=this.datum_params[0],e.y-=this.datum_params[1],e.z-=this.datum_params[2];else if(this.datum_type===i){var t=this.datum_params[0],o=this.datum_params[1],n=this.datum_params[2],a=this.datum_params[3],l=this.datum_params[4],s=this.datum_params[5],p=this.datum_params[6],c=(e.x-t)/p,u=(e.y-o)/p,g=(e.z-n)/p;e.x=c+s*u-l*g,e.y=-s*c+u+a*g,e.z=l*c-a*u+g}}},t.exports=u},{}],31:[function(e,t){var o=1,r=2,i=3,n=5,a=6378137,l=.006694379990141316;t.exports=function(e,t,s){function p(e){return e===o||e===r}var c,u,g;if(e.compare_datums(t))return s;if(e.datum_type===n||t.datum_type===n)return s;var d=e.a,h=e.es,f=t.a,y=t.es,m=e.datum_type;if(m===i)if(0===this.apply_gridshift(e,0,s))e.a=a,e.es=l;else{if(!e.datum_params)return e.a=d,e.es=e.es,s;for(c=1,u=0,g=e.datum_params.length;g>u;u++)c*=e.datum_params[u];if(0===c)return e.a=d,e.es=e.es,s;m=e.datum_params.length>3?r:o}return t.datum_type===i&&(t.a=a,t.es=l),(e.es!==t.es||e.a!==t.a||p(m)||p(t.datum_type))&&(e.geodetic_to_geocentric(s),p(e.datum_type)&&e.geocentric_to_wgs84(s),p(t.datum_type)&&t.geocentric_from_wgs84(s),t.geocentric_to_geodetic(s)),t.datum_type===i&&this.apply_gridshift(t,1,s),e.a=d,e.es=h,t.a=f,t.es=y,s}},{}],32:[function(e,t){function o(e){var t=this;if(2===arguments.length){var r=arguments[1];o[e]="string"==typeof r?"+"===r.charAt(0)?i(arguments[1]):n(arguments[1]):r}else if(1===arguments.length){if(Array.isArray(e))return e.map(function(e){Array.isArray(e)?o.apply(t,e):o(e)});if("string"==typeof e){if(e in o)return o[e]}else"EPSG"in e?o["EPSG:"+e.EPSG]=e:"ESRI"in e?o["ESRI:"+e.ESRI]=e:"IAU2000"in e?o["IAU2000:"+e.IAU2000]=e:console.log(e);return}}var r=e("./global"),i=e("./projString"),n=e("./wkt");r(o),t.exports=o},{"./global":35,"./projString":38,"./wkt":66}],33:[function(e,t){var o=e("./constants/Datum"),r=e("./constants/Ellipsoid"),i=e("./extend"),n=e("./datum"),a=1e-10,l=.16666666666666666,s=.04722222222222222,p=.022156084656084655;t.exports=function(e){if(e.datumCode&&"none"!==e.datumCode){var t=o[e.datumCode];t&&(e.datum_params=t.towgs84?t.towgs84.split(","):null,e.ellps=t.ellipse,e.datumName=t.datumName?t.datumName:e.datumCode)}if(!e.a){var c=r[e.ellps]?r[e.ellps]:r.WGS84;i(e,c)}return e.rf&&!e.b&&(e.b=(1-1/e.rf)*e.a),(0===e.rf||Math.abs(e.a-e.b)<a)&&(e.sphere=!0,e.b=e.a),e.a2=e.a*e.a,e.b2=e.b*e.b,e.es=(e.a2-e.b2)/e.a2,e.e=Math.sqrt(e.es),e.R_A&&(e.a*=1-e.es*(l+e.es*(s+e.es*p)),e.a2=e.a*e.a,e.b2=e.b*e.b,e.es=0),e.ep2=(e.a2-e.b2)/e.b2,e.k0||(e.k0=1),e.axis||(e.axis="enu"),e.datum||(e.datum=n(e)),e}},{"./constants/Datum":25,"./constants/Ellipsoid":26,"./datum":30,"./extend":34}],34:[function(e,t){t.exports=function(e,t){e=e||{};var o,r;if(!t)return e;for(r in t)o=t[r],void 0!==o&&(e[r]=o);return e}},{}],35:[function(e,t){t.exports=function(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}},{}],36:[function(e,t){var o=e("./core");o.defaultDatum="WGS84",o.Proj=e("./Proj"),o.WGS84=new o.Proj("WGS84"),o.Point=e("./Point"),o.toPoint=e("./common/toPoint"),o.defs=e("./defs"),o.transform=e("./transform"),o.mgrs=e("mgrs"),o.version=e("../package.json").version,e("./includedProjections")(o),t.exports=o},{"../package.json":68,"./Point":1,"./Proj":2,"./common/toPoint":23,"./core":29,"./defs":32,"./includedProjections":"hTEDpn","./transform":65,mgrs:67}],37:[function(e,t){function o(e){return"string"==typeof e}function r(e){return e in l}function i(e){var t=["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"];return t.reduce(function(t,o){return t+1+e.indexOf(o)},0)}function n(e){return"+"===e[0]}function a(e){return o(e)?r(e)?l[e]:i(e)?s(e):n(e)?p(e):void 0:e}var l=e("./defs"),s=e("./wkt"),p=e("./projString");t.exports=a},{"./defs":32,"./projString":38,"./wkt":66}],38:[function(e,t){var o=.017453292519943295,r=e("./constants/PrimeMeridian"),i=e("./constants/units");t.exports=function(e){var t={},n={};e.split("+").map(function(e){return e.trim()}).filter(function(e){return e}).forEach(function(e){var t=e.split("=");t.push(!0),n[t[0].toLowerCase()]=t[1]});var a,l,s,p={proj:"projName",datum:"datumCode",rf:function(e){t.rf=parseFloat(e)},lat_0:function(e){t.lat0=e*o},lat_1:function(e){t.lat1=e*o},lat_2:function(e){t.lat2=e*o},lat_ts:function(e){t.lat_ts=e*o},lon_0:function(e){t.long0=e*o},lon_1:function(e){t.long1=e*o},lon_2:function(e){t.long2=e*o},alpha:function(e){t.alpha=parseFloat(e)*o},lonc:function(e){t.longc=e*o},x_0:function(e){t.x0=parseFloat(e)},y_0:function(e){t.y0=parseFloat(e)},k_0:function(e){t.k0=parseFloat(e)},k:function(e){t.k0=parseFloat(e)},a:function(e){t.a=parseFloat(e)},b:function(e){t.b=parseFloat(e)},r_a:function(){t.R_A=!0},zone:function(e){t.zone=parseInt(e,10)},south:function(){t.utmSouth=!0},towgs84:function(e){t.datum_params=e.split(",").map(function(e){return parseFloat(e)})},to_meter:function(e){t.to_meter=parseFloat(e)},units:function(e){t.units=e,i[e]&&(t.to_meter=i[e].to_meter)},from_greenwich:function(e){t.from_greenwich=e*o},pm:function(e){t.from_greenwich=(r[e]?r[e]:parseFloat(e))*o},nadgrids:function(e){"@null"===e?t.datumCode="none":t.nadgrids=e},axis:function(e){var o="ewnsud";3===e.length&&-1!==o.indexOf(e.substr(0,1))&&-1!==o.indexOf(e.substr(1,1))&&-1!==o.indexOf(e.substr(2,1))&&(t.axis=e)}};for(a in n)l=n[a],a in p?(s=p[a],"function"==typeof s?s(l):t[s]=l):t[a]=l;return"string"==typeof t.datumCode&&"WGS84"!==t.datumCode&&(t.datumCode=t.datumCode.toLowerCase()),t}},{"./constants/PrimeMeridian":27,"./constants/units":28}],39:[function(e,t,o){function r(e,t){var o=a.length;return e.names?(a[o]=e,e.names.forEach(function(e){n[e.toLowerCase()]=o}),this):(console.log(t),!0)}var i=[e("./projections/merc"),e("./projections/longlat")],n={},a=[];o.add=r,o.get=function(e){if(!e)return!1;var t=e.toLowerCase();return void 0!==n[t]&&a[n[t]]?a[n[t]]:void 0},o.start=function(){i.forEach(r)}},{"./projections/longlat":51,"./projections/merc":52}],40:[function(e,t,o){var r=1e-10,i=e("../common/msfnz"),n=e("../common/qsfnz"),a=e("../common/adjust_lon"),l=e("../common/asinz");o.init=function(){Math.abs(this.lat1+this.lat2)<r||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=i(this.e3,this.sin_po,this.cos_po),this.qs1=n(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=i(this.e3,this.sin_po,this.cos_po),this.qs2=n(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=n(this.e3,this.sin_po,this.cos_po),this.ns0=Math.abs(this.lat1-this.lat2)>r?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},o.forward=function(e){var t=e.x,o=e.y;this.sin_phi=Math.sin(o),this.cos_phi=Math.cos(o);var r=n(this.e3,this.sin_phi,this.cos_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,l=this.ns0*a(t-this.long0),s=i*Math.sin(l)+this.x0,p=this.rh-i*Math.cos(l)+this.y0;return e.x=s,e.y=p,e},o.inverse=function(e){var t,o,r,i,n,l;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0<0?(t=-Math.sqrt(e.x*e.x+e.y*e.y),r=-1):(t=Math.sqrt(e.x*e.x+e.y*e.y),r=1),i=0,0!==t&&(i=Math.atan2(r*e.x,r*e.y)),r=t*this.ns0/this.a,this.sphere?l=Math.asin((this.c-r*r)/(2*this.ns0)):(o=(this.c-r*r)/this.ns0,l=this.phi1z(this.e3,o)),n=a(i/this.ns0+this.long0),e.x=n,e.y=l,e},o.phi1z=function(e,t){var o,i,n,a,s,p=l(.5*t);if(r>e)return p;for(var c=e*e,u=1;25>=u;u++)if(o=Math.sin(p),i=Math.cos(p),n=e*o,a=1-n*n,s=.5*a*a/i*(t/(1-c)-o/a+.5/e*Math.log((1-n)/(1+n))),p+=s,Math.abs(s)<=1e-7)return p;return null},o.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/msfnz":15,"../common/qsfnz":20}],41:[function(e,t,o){var r=e("../common/adjust_lon"),i=Math.PI/2,n=1e-10,a=e("../common/mlfn"),l=e("../common/e0fn"),s=e("../common/e1fn"),p=e("../common/e2fn"),c=e("../common/e3fn"),u=e("../common/gN"),g=e("../common/asinz"),d=e("../common/imlfn");o.init=function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},o.forward=function(e){var t,o,g,d,h,f,y,m,v,C,T,_,S,E,x,P,L,w,R,A,b,M,I,O=e.x,N=e.y,D=Math.sin(e.y),F=Math.cos(e.y),k=r(O-this.long0);return this.sphere?Math.abs(this.sin_p12-1)>n?Math.abs(this.sin_p12+1)>n?(w=this.sin_p12*D+this.cos_p12*F*Math.cos(k),P=Math.acos(w),L=P/Math.sin(P),e.x=this.x0+this.a*L*F*Math.sin(k),e.y=this.y0+this.a*L*(this.cos_p12*D-this.sin_p12*F*Math.cos(k)),e):(e.x=this.x0+this.a*(i+N)*Math.sin(k),e.y=this.y0+this.a*(i+N)*Math.cos(k),e):(e.x=this.x0+this.a*(i-N)*Math.sin(k),e.y=this.y0-this.a*(i-N)*Math.cos(k),e):(t=l(this.es),o=s(this.es),g=p(this.es),d=c(this.es),Math.abs(this.sin_p12-1)>n?Math.abs(this.sin_p12+1)>n?(y=D/F,m=u(this.a,this.e,this.sin_p12),v=u(this.a,this.e,D),C=Math.atan((1-this.es)*y+this.es*m*this.sin_p12/(v*F)),T=Math.atan2(Math.sin(k),this.cos_p12*Math.tan(C)-this.sin_p12*Math.cos(k)),R=0===T?Math.asin(this.cos_p12*Math.sin(C)-this.sin_p12*Math.cos(C)):Math.abs(Math.abs(T)-Math.PI)>n?Math.asin(Math.sin(k)*Math.cos(C)/Math.sin(T)):-Math.asin(this.cos_p12*Math.sin(C)-this.sin_p12*Math.cos(C)),_=this.e*this.sin_p12/Math.sqrt(1-this.es),S=this.e*this.cos_p12*Math.cos(T)/Math.sqrt(1-this.es),E=_*S,x=S*S,A=R*R,b=A*R,M=b*R,I=M*R,P=m*R*(1-A*x*(1-x)/6+b/8*E*(1-2*x)+M/120*(x*(4-7*x)-3*_*_*(1-7*x))-I/48*E),e.x=this.x0+P*Math.sin(T),e.y=this.y0+P*Math.cos(T),e):(h=this.a*a(t,o,g,d,i),f=this.a*a(t,o,g,d,N),e.x=this.x0+(h+f)*Math.sin(k),e.y=this.y0+(h+f)*Math.cos(k),e):(h=this.a*a(t,o,g,d,i),f=this.a*a(t,o,g,d,N),e.x=this.x0+(h-f)*Math.sin(k),e.y=this.y0-(h-f)*Math.cos(k),e))},o.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t,o,h,f,y,m,v,C,T,_,S,E,x,P,L,w,R,A,b,M,I,O,N;if(this.sphere){if(t=Math.sqrt(e.x*e.x+e.y*e.y),t>2*i*this.a)return;return o=t/this.a,h=Math.sin(o),f=Math.cos(o),y=this.long0,Math.abs(t)>n?(m=g(f*this.sin_p12+e.y*h*this.cos_p12/t),v=Math.abs(this.lat0)-i,y=r(Math.abs(v)>n?this.long0+Math.atan2(e.x*h,t*this.cos_p12*f-e.y*this.sin_p12*h):this.lat0<0?this.long0-Math.atan2(-e.x,e.y):this.long0+Math.atan2(e.x,-e.y))):m=this.lat0,e.x=y,e.y=m,e}return C=l(this.es),T=s(this.es),_=p(this.es),S=c(this.es),Math.abs(this.sin_p12-1)>n?Math.abs(this.sin_p12+1)>n?(t=Math.sqrt(e.x*e.x+e.y*e.y),w=Math.atan2(e.x,e.y),P=u(this.a,this.e,this.sin_p12),R=Math.cos(w),A=this.e*this.cos_p12*R,b=-A*A/(1-this.es),M=3*this.es*(1-b)*this.sin_p12*this.cos_p12*R/(1-this.es),I=t/P,O=I-b*(1+b)*Math.pow(I,3)/6-M*(1+3*b)*Math.pow(I,4)/24,N=1-b*O*O/2-I*O*O*O/6,L=Math.asin(this.sin_p12*Math.cos(O)+this.cos_p12*Math.sin(O)*R),y=r(this.long0+Math.asin(Math.sin(w)*Math.sin(O)/Math.cos(L))),m=Math.atan((1-this.es*N*this.sin_p12/Math.sin(L))*Math.tan(L)/(1-this.es)),e.x=y,e.y=m,e):(E=this.a*a(C,T,_,S,i),t=Math.sqrt(e.x*e.x+e.y*e.y),x=t-E,m=d(x/this.a,C,T,_,S),y=r(this.long0+Math.atan2(e.x,e.y)),e.x=y,e.y=m,e):(E=this.a*a(C,T,_,S,i),t=Math.sqrt(e.x*e.x+e.y*e.y),x=E-t,m=d(x/this.a,C,T,_,S),y=r(this.long0+Math.atan2(e.x,-1*e.y)),e.x=y,e.y=m,e)},o.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],42:[function(e,t,o){var r=e("../common/mlfn"),i=e("../common/e0fn"),n=e("../common/e1fn"),a=e("../common/e2fn"),l=e("../common/e3fn"),s=e("../common/gN"),p=e("../common/adjust_lon"),c=e("../common/adjust_lat"),u=e("../common/imlfn"),g=Math.PI/2,d=1e-10;o.init=function(){this.sphere||(this.e0=i(this.es),this.e1=n(this.es),this.e2=a(this.es),this.e3=l(this.es),this.ml0=this.a*r(this.e0,this.e1,this.e2,this.e3,this.lat0))},o.forward=function(e){var t,o,i=e.x,n=e.y;if(i=p(i-this.long0),this.sphere)t=this.a*Math.asin(Math.cos(n)*Math.sin(i)),o=this.a*(Math.atan2(Math.tan(n),Math.cos(i))-this.lat0);else{var a=Math.sin(n),l=Math.cos(n),c=s(this.a,this.e,a),u=Math.tan(n)*Math.tan(n),g=i*Math.cos(n),d=g*g,h=this.es*l*l/(1-this.es),f=this.a*r(this.e0,this.e1,this.e2,this.e3,n);t=c*g*(1-d*u*(1/6-(8-u+8*h)*d/120)),o=f-this.ml0+c*a/l*d*(.5+(5-u+6*h)*d/24)}return e.x=t+this.x0,e.y=o+this.y0,e},o.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t,o,r=e.x/this.a,i=e.y/this.a;if(this.sphere){var n=i+this.lat0;t=Math.asin(Math.sin(n)*Math.cos(r)),o=Math.atan2(Math.tan(r),Math.cos(n))}else{var a=this.ml0/this.a+i,l=u(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(l)-g)<=d)return e.x=this.long0,e.y=g,0>i&&(e.y*=-1),e;var h=s(this.a,this.e,Math.sin(l)),f=h*h*h/this.a/this.a*(1-this.es),y=Math.pow(Math.tan(l),2),m=r*this.a/h,v=m*m;t=l-h*Math.tan(l)/f*m*m*(.5-(1+3*y)*m*m/24),o=m*(1-v*(y/3+(1+3*y)*y*v/15))/Math.cos(l)}return e.x=p(o+this.long0),e.y=c(t),e},o.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],43:[function(e,t,o){var r=e("../common/adjust_lon"),i=e("../common/qsfnz"),n=e("../common/msfnz"),a=e("../common/iqsfnz");o.init=function(){this.sphere||(this.k0=n(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},o.forward=function(e){var t,o,n=e.x,a=e.y,l=r(n-this.long0);if(this.sphere)t=this.x0+this.a*l*Math.cos(this.lat_ts),o=this.y0+this.a*Math.sin(a)/Math.cos(this.lat_ts);else{var s=i(this.e,Math.sin(a));t=this.x0+this.a*this.k0*l,o=this.y0+this.a*s*.5/this.k0}return e.x=t,e.y=o,e},o.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t,o;return this.sphere?(t=r(this.long0+e.x/this.a/Math.cos(this.lat_ts)),o=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(o=a(this.e,2*e.y*this.k0/this.a),t=r(this.long0+e.x/(this.a*this.k0))),e.x=t,e.y=o,e},o.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":13,"../common/msfnz":15,"../common/qsfnz":20}],44:[function(e,t,o){var r=e("../common/adjust_lon"),i=e("../common/adjust_lat");o.init=function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},o.forward=function(e){var t=e.x,o=e.y,n=r(t-this.long0),a=i(o-this.lat0);return e.x=this.x0+this.a*n*this.rc,e.y=this.y0+this.a*a,e},o.inverse=function(e){var t=e.x,o=e.y;return e.x=r(this.long0+(t-this.x0)/(this.a*this.rc)),e.y=i(this.lat0+(o-this.y0)/this.a),e},o.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5}],45:[function(e,t,o){var r=e("../common/e0fn"),i=e("../common/e1fn"),n=e("../common/e2fn"),a=e("../common/e3fn"),l=e("../common/msfnz"),s=e("../common/mlfn"),p=e("../common/adjust_lon"),c=e("../common/adjust_lat"),u=e("../common/imlfn"),g=1e-10;o.init=function(){Math.abs(this.lat1+this.lat2)<g||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=r(this.es),this.e1=i(this.es),this.e2=n(this.es),this.e3=a(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=l(this.e,this.sinphi,this.cosphi),this.ml1=s(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<g?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=l(this.e,this.sinphi,this.cosphi),this.ml2=s(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=s(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},o.forward=function(e){var t,o=e.x,r=e.y;if(this.sphere)t=this.a*(this.g-r);else{var i=s(this.e0,this.e1,this.e2,this.e3,r);t=this.a*(this.g-i)}var n=this.ns*p(o-this.long0),a=this.x0+t*Math.sin(n),l=this.y0+this.rh-t*Math.cos(n);return e.x=a,e.y=l,e},o.inverse=function(e){e.x-=this.x0,e.y=this.rh-e.y+this.y0;var t,o,r,i;this.ns<0?(o=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1):(o=Math.sqrt(e.x*e.x+e.y*e.y),t=1);var n=0;if(0!==o&&(n=Math.atan2(t*e.x,t*e.y)),this.sphere)return i=p(this.long0+n/this.ns),r=c(this.g-o/this.a),e.x=i,e.y=r,e;var a=this.g-o/this.a;return r=u(a,this.e0,this.e1,this.e2,this.e3),i=p(this.long0+n/this.ns),e.x=i,e.y=r,e},o.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/imlfn":12,"../common/mlfn":14,"../common/msfnz":15}],46:[function(e,t,o){var r=Math.PI/4,i=e("../common/srat"),n=Math.PI/2,a=20;o.init=function(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+r)/(Math.pow(Math.tan(.5*this.lat0+r),this.C)*i(this.e*e,this.ratexp))},o.forward=function(e){var t=e.x,o=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*o+r),this.C)*i(this.e*Math.sin(o),this.ratexp))-n,e.x=this.C*t,e},o.inverse=function(e){for(var t=1e-14,o=e.x/this.C,l=e.y,s=Math.pow(Math.tan(.5*l+r)/this.K,1/this.C),p=a;p>0&&(l=2*Math.atan(s*i(this.e*Math.sin(e.y),-.5*this.e))-n,Math.abs(l-e.y)>=t);--p)e.y=l;return p?(e.x=o,e.y=l,e):null},o.names=["gauss"]},{"../common/srat":22}],47:[function(e,t,o){var r=e("../common/adjust_lon"),i=1e-10,n=e("../common/asinz");o.init=function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},o.forward=function(e){var t,o,n,a,l,s,p,c,u=e.x,g=e.y;return n=r(u-this.long0),t=Math.sin(g),o=Math.cos(g),a=Math.cos(n),s=this.sin_p14*t+this.cos_p14*o*a,l=1,s>0||Math.abs(s)<=i?(p=this.x0+this.a*l*o*Math.sin(n)/s,c=this.y0+this.a*l*(this.cos_p14*t-this.sin_p14*o*a)/s):(p=this.x0+this.infinity_dist*o*Math.sin(n),c=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*o*a)),e.x=p,e.y=c,e},o.inverse=function(e){var t,o,i,a,l,s;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(a=Math.atan2(t,this.rc),o=Math.sin(a),i=Math.cos(a),s=n(i*this.sin_p14+e.y*o*this.cos_p14/t),l=Math.atan2(e.x*o,t*this.cos_p14*i-e.y*this.sin_p14*o),l=r(this.long0+l)):(s=this.phic0,l=0),e.x=l,e.y=s,e},o.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":6}],48:[function(e,t,o){var r=e("../common/adjust_lon");o.init=function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,
this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},o.forward=function(e){var t,o,i,n,a,l,s,p=e.x,c=e.y,u=r(p-this.long0);return t=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),o=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/t)-this.s45),i=-u*this.alfa,n=Math.asin(Math.cos(this.ad)*Math.sin(o)+Math.sin(this.ad)*Math.cos(o)*Math.cos(i)),a=Math.asin(Math.cos(o)*Math.sin(i)/Math.cos(n)),l=this.n*a,s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(n/2+this.s45),this.n),e.y=s*Math.cos(l)/1,e.x=s*Math.sin(l)/1,this.czech||(e.y*=-1,e.x*=-1),e},o.inverse=function(e){var t,o,r,i,n,a,l,s,p=e.x;e.x=e.y,e.y=p,this.czech||(e.y*=-1,e.x*=-1),a=Math.sqrt(e.x*e.x+e.y*e.y),n=Math.atan2(e.y,e.x),i=n/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),o=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(t)),e.x=this.long0-o/this.alfa,l=t,s=0;var c=0;do e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.e/2))-this.s45),Math.abs(l-e.y)<1e-10&&(s=1),l=e.y,c+=1;while(0===s&&15>c);return 15>c?e:null},o.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],49:[function(e,t,o){var r=Math.PI/2,i=Math.PI/4,n=1e-10,a=e("../common/qsfnz"),l=e("../common/adjust_lon");o.S_POLE=1,o.N_POLE=2,o.EQUIT=3,o.OBLIQ=4,o.init=function(){var e=Math.abs(this.lat0);if(this.mode=Math.abs(e-r)<n?this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<n?this.EQUIT:this.OBLIQ,this.es>0){var t;switch(this.qp=a(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=a(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},o.forward=function(e){var t,o,s,p,c,u,g,d,h,f,y=e.x,m=e.y;if(y=l(y-this.long0),this.sphere){if(c=Math.sin(m),f=Math.cos(m),s=Math.cos(y),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(o=this.mode===this.EQUIT?1+f*s:1+this.sinph0*c+this.cosph0*f*s,n>=o)return null;o=Math.sqrt(2/o),t=o*f*Math.sin(y),o*=this.mode===this.EQUIT?c:this.cosph0*c-this.sinph0*f*s}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(s=-s),Math.abs(m+this.phi0)<n)return null;o=i-.5*m,o=2*(this.mode===this.S_POLE?Math.cos(o):Math.sin(o)),t=o*Math.sin(y),o*=s}}else{switch(g=0,d=0,h=0,s=Math.cos(y),p=Math.sin(y),c=Math.sin(m),u=a(this.e,c),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(g=u/this.qp,d=Math.sqrt(1-g*g)),this.mode){case this.OBLIQ:h=1+this.sinb1*g+this.cosb1*d*s;break;case this.EQUIT:h=1+d*s;break;case this.N_POLE:h=r+m,u=this.qp-u;break;case this.S_POLE:h=m-r,u=this.qp+u}if(Math.abs(h)<n)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),o=this.mode===this.OBLIQ?this.ymf*h*(this.cosb1*g-this.sinb1*d*s):(h=Math.sqrt(2/(1+d*s)))*g*this.ymf,t=this.xmf*h*d*p;break;case this.N_POLE:case this.S_POLE:0>u?t=o=0:(t=(h=Math.sqrt(u))*p,o=s*(this.mode===this.S_POLE?h:-h))}}return e.x=this.a*t+this.x0,e.y=this.a*o+this.y0,e},o.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t,o,i,a,s,p,c,u=e.x/this.a,g=e.y/this.a;if(this.sphere){var d,h=0,f=0;if(d=Math.sqrt(u*u+g*g),o=.5*d,o>1)return null;switch(o=2*Math.asin(o),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(f=Math.sin(o),h=Math.cos(o)),this.mode){case this.EQUIT:o=Math.abs(d)>n?Math.asin(g*f/d):0,u*=f,g=h*d;break;case this.OBLIQ:o=Math.abs(d)>n?Math.asin(h*this.sinph0+g*f*this.cosph0/d):this.phi0,u*=f*this.cosph0,g=(h-Math.sin(o)*this.sinph0)*d;break;case this.N_POLE:g=-g,o=r-o;break;case this.S_POLE:o-=r}t=0!==g||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(u,g):0}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(u/=this.dd,g*=this.dd,p=Math.sqrt(u*u+g*g),n>p)return e.x=0,e.y=this.phi0,e;a=2*Math.asin(.5*p/this.rq),i=Math.cos(a),u*=a=Math.sin(a),this.mode===this.OBLIQ?(c=i*this.sinb1+g*a*this.cosb1/p,s=this.qp*c,g=p*this.cosb1*i-g*this.sinb1*a):(c=g*a/p,s=this.qp*c,g=p*i)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(g=-g),s=u*u+g*g,!s)return e.x=0,e.y=this.phi0,e;c=1-s/this.qp,this.mode===this.S_POLE&&(c=-c)}t=Math.atan2(u,g),o=this.authlat(Math.asin(c),this.apa)}return e.x=l(this.long0+t),e.y=o,e},o.P00=.3333333333333333,o.P01=.17222222222222222,o.P02=.10257936507936508,o.P10=.06388888888888888,o.P11=.0664021164021164,o.P20=.016415012942191543,o.authset=function(e){var t,o=[];return o[0]=e*this.P00,t=e*e,o[0]+=t*this.P01,o[1]=t*this.P10,t*=e,o[0]+=t*this.P02,o[1]+=t*this.P11,o[2]=t*this.P20,o},o.authlat=function(e,t){var o=e+e;return e+t[0]*Math.sin(o)+t[1]*Math.sin(o+o)+t[2]*Math.sin(o+o+o)},o.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":5,"../common/qsfnz":20}],50:[function(e,t,o){var r=1e-10,i=e("../common/msfnz"),n=e("../common/tsfnz"),a=Math.PI/2,l=e("../common/sign"),s=e("../common/adjust_lon"),p=e("../common/phi2z");o.init=function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,Math.abs(this.lat1+this.lat2)>=r){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var t=Math.sin(this.lat1),o=Math.cos(this.lat1),a=i(this.e,t,o),l=n(this.e,this.lat1,t),s=Math.sin(this.lat2),p=Math.cos(this.lat2),c=i(this.e,s,p),u=n(this.e,this.lat2,s),g=n(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>r?Math.log(a/c)/Math.log(l/u):t,isNaN(this.ns)&&(this.ns=t),this.f0=a/(this.ns*Math.pow(l,this.ns)),this.rh=this.a*this.f0*Math.pow(g,this.ns),this.title||(this.title="Lambert Conformal Conic")}},o.forward=function(e){var t=e.x,o=e.y;Math.abs(2*Math.abs(o)-Math.PI)>r||(o=l(o)*(a-2*r));var i,p,c=Math.abs(Math.abs(o)-a);if(c>r)i=n(this.e,o,Math.sin(o)),p=this.a*this.f0*Math.pow(i,this.ns);else{if(c=o*this.ns,0>=c)return null;p=0}var u=this.ns*s(t-this.long0);return e.x=this.k0*p*Math.sin(u)+this.x0,e.y=this.k0*(this.rh-p*Math.cos(u))+this.y0,e},o.inverse=function(e){var t,o,r,i,n,l=(e.x-this.x0)/this.k0,c=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(l*l+c*c),o=1):(t=-Math.sqrt(l*l+c*c),o=-1);var u=0;if(0!==t&&(u=Math.atan2(o*l,o*c)),0!==t||this.ns>0){if(o=1/this.ns,r=Math.pow(t/(this.a*this.f0),o),i=p(this.e,r),-9999===i)return null}else i=-a;return n=s(u/this.ns+this.long0),e.x=n,e.y=i,e},o.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],51:[function(e,t,o){function r(e){return e}o.init=function(){},o.forward=r,o.inverse=r,o.names=["longlat","identity"]},{}],52:[function(e,t,o){var r=e("../common/msfnz"),i=Math.PI/2,n=1e-10,a=57.29577951308232,l=e("../common/adjust_lon"),s=Math.PI/4,p=e("../common/tsfnz"),c=e("../common/phi2z");o.init=function(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):r(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},o.forward=function(e){var t=e.x,o=e.y;if(o*a>90&&-90>o*a&&t*a>180&&-180>t*a)return null;var r,c;if(Math.abs(Math.abs(o)-i)>n){if(this.sphere)r=this.x0+this.a*this.k0*l(t-this.long0),c=this.y0+this.a*this.k0*Math.log(Math.tan(s+.5*o));else{var u=Math.sin(o),g=p(this.e,o,u);r=this.x0+this.a*this.k0*l(t-this.long0),c=this.y0-this.a*this.k0*Math.log(g)}return e.x=r,e.y=c,e}return null},o.inverse=function(e){var t,o,r=e.x-this.x0,n=e.y-this.y0;if(this.sphere)o=i-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var a=Math.exp(-n/(this.a*this.k0));if(o=c(this.e,a),-9999===o)return null}return t=l(this.long0+r/(this.a*this.k0)),e.x=t,e.y=o,e},o.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/tsfnz":24}],53:[function(e,t,o){var r=e("../common/adjust_lon");o.init=function(){},o.forward=function(e){var t=e.x,o=e.y,i=r(t-this.long0),n=this.x0+this.a*i,a=this.y0+this.a*Math.log(Math.tan(Math.PI/4+o/2.5))*1.25;return e.x=n,e.y=a,e},o.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t=r(this.long0+e.x/this.a),o=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=o,e},o.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],54:[function(e,t,o){var r=e("../common/adjust_lon"),i=1e-10;o.init=function(){},o.forward=function(e){for(var t=e.x,o=e.y,n=r(t-this.long0),a=o,l=Math.PI*Math.sin(o),s=0;!0;s++){var p=-(a+Math.sin(a)-l)/(1+Math.cos(a));if(a+=p,Math.abs(p)<i)break}a/=2,Math.PI/2-Math.abs(o)<i&&(n=0);var c=.900316316158*this.a*n*Math.cos(a)+this.x0,u=1.4142135623731*this.a*Math.sin(a)+this.y0;return e.x=c,e.y=u,e},o.inverse=function(e){var t,o;e.x-=this.x0,e.y-=this.y0,o=e.y/(1.4142135623731*this.a),Math.abs(o)>.999999999999&&(o=.999999999999),t=Math.asin(o);var i=r(this.long0+e.x/(.900316316158*this.a*Math.cos(t)));i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),o=(2*t+Math.sin(2*t))/Math.PI,Math.abs(o)>1&&(o=1);var n=Math.asin(o);return e.x=i,e.y=n,e},o.names=["Mollweide","moll"]},{"../common/adjust_lon":5}],55:[function(e,t,o){var r=484813681109536e-20;o.iterations=1,o.init=function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},o.forward=function(e){var t,o=e.x,i=e.y,n=i-this.lat0,a=o-this.long0,l=n/r*1e-5,s=a,p=1,c=0;for(t=1;10>=t;t++)p*=l,c+=this.A[t]*p;var u,g,d=c,h=s,f=1,y=0,m=0,v=0;for(t=1;6>=t;t++)u=f*d-y*h,g=y*d+f*h,f=u,y=g,m=m+this.B_re[t]*f-this.B_im[t]*y,v=v+this.B_im[t]*f+this.B_re[t]*y;return e.x=v*this.a+this.x0,e.y=m*this.a+this.y0,e},o.inverse=function(e){var t,o,i,n=e.x,a=e.y,l=n-this.x0,s=a-this.y0,p=s/this.a,c=l/this.a,u=1,g=0,d=0,h=0;for(t=1;6>=t;t++)o=u*p-g*c,i=g*p+u*c,u=o,g=i,d=d+this.C_re[t]*u-this.C_im[t]*g,h=h+this.C_im[t]*u+this.C_re[t]*g;for(var f=0;f<this.iterations;f++){var y,m,v=d,C=h,T=p,_=c;for(t=2;6>=t;t++)y=v*d-C*h,m=C*d+v*h,v=y,C=m,T+=(t-1)*(this.B_re[t]*v-this.B_im[t]*C),_+=(t-1)*(this.B_im[t]*v+this.B_re[t]*C);v=1,C=0;var S=this.B_re[1],E=this.B_im[1];for(t=2;6>=t;t++)y=v*d-C*h,m=C*d+v*h,v=y,C=m,S+=t*(this.B_re[t]*v-this.B_im[t]*C),E+=t*(this.B_im[t]*v+this.B_re[t]*C);var x=S*S+E*E;d=(T*S+_*E)/x,h=(_*S-T*E)/x}var P=d,L=h,w=1,R=0;for(t=1;9>=t;t++)w*=P,R+=this.D[t]*w;var A=this.lat0+R*r*1e5,b=this.long0+L;return e.x=b,e.y=A,e},o.names=["New_Zealand_Map_Grid","nzmg"]},{}],56:[function(e,t,o){var r=e("../common/tsfnz"),i=e("../common/adjust_lon"),n=e("../common/phi2z"),a=Math.PI/2,l=Math.PI/4,s=1e-10;o.init=function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var e=Math.sin(this.lat0),t=Math.cos(this.lat0),o=this.e*e;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(t,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-o*o);var n=r(this.e,this.lat0,e),a=this.bl/t*Math.sqrt((1-this.es)/(1-o*o));1>a*a&&(a=1);var l,s;if(isNaN(this.longc)){var p=r(this.e,this.lat1,Math.sin(this.lat1)),c=r(this.e,this.lat2,Math.sin(this.lat2));this.el=this.lat0<0?(a-Math.sqrt(a*a-1))*Math.pow(n,this.bl):(a+Math.sqrt(a*a-1))*Math.pow(n,this.bl);var u=Math.pow(p,this.bl),g=Math.pow(c,this.bl);l=this.el/u,s=.5*(l-1/l);var d=(this.el*this.el-g*u)/(this.el*this.el+g*u),h=(g-u)/(g+u),f=i(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(d*Math.tan(.5*this.bl*f)/h)/this.bl,this.long0=i(this.long0);var y=i(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*y)/s),this.alpha=Math.asin(a*Math.sin(this.gamma0))}else l=this.lat0<0?a-Math.sqrt(a*a-1):a+Math.sqrt(a*a-1),this.el=l*Math.pow(n,this.bl),s=.5*(l-1/l),this.gamma0=Math.asin(Math.sin(this.alpha)/a),this.long0=this.longc-Math.asin(s*Math.tan(this.gamma0))/this.bl;this.uc=this.no_off?0:this.lat0<0?-1*this.al/this.bl*Math.atan2(Math.sqrt(a*a-1),Math.cos(this.alpha)):this.al/this.bl*Math.atan2(Math.sqrt(a*a-1),Math.cos(this.alpha))},o.forward=function(e){var t,o,n,p=e.x,c=e.y,u=i(p-this.long0);if(Math.abs(Math.abs(c)-a)>s){var g=r(this.e,c,Math.sin(c)),d=this.el/Math.pow(g,this.bl),h=.5*(d-1/d),f=.5*(d+1/d),y=Math.sin(this.bl*u),m=(h*Math.sin(this.gamma0)-y*Math.cos(this.gamma0))/f;o=Math.abs(Math.abs(m)-1)>s?.5*this.al*Math.log((1-m)/(1+m))/this.bl:Number.POSITIVE_INFINITY,t=Math.abs(Math.cos(this.bl*u))>s?this.al*Math.atan2(h*Math.cos(this.gamma0)+y*Math.sin(this.gamma0),Math.cos(this.bl*u))/this.bl:this.al*this.bl*u}else n=c>0?-1:1,o=this.al/this.bl*Math.log(Math.tan(l+n*this.gamma0*.5)),t=-1*n*a*this.al/this.bl;return this.no_rot?(e.x=this.x0+t,e.y=this.y0+o):(t-=this.uc,e.x=this.x0+o*Math.cos(this.alpha)+t*Math.sin(this.alpha),e.y=this.y0+t*Math.cos(this.alpha)-o*Math.sin(this.alpha)),e},o.inverse=function(e){var t,o;this.no_rot?(o=e.y-this.y0,t=e.x-this.x0):(o=(e.x-this.x0)*Math.cos(this.alpha)-(e.y-this.y0)*Math.sin(this.alpha),t=(e.y-this.y0)*Math.cos(this.alpha)+(e.x-this.x0)*Math.sin(this.alpha),t+=this.uc);var r=Math.exp(-1*this.bl*o/this.al),l=.5*(r-1/r),p=.5*(r+1/r),c=Math.sin(this.bl*t/this.al),u=(c*Math.cos(this.gamma0)+l*Math.sin(this.gamma0))/p,g=Math.pow(this.el/Math.sqrt((1+u)/(1-u)),1/this.bl);return Math.abs(u-1)<s?(e.x=this.long0,e.y=a):Math.abs(u+1)<s?(e.x=this.long0,e.y=-1*a):(e.y=n(this.e,g),e.x=i(this.long0-Math.atan2(l*Math.cos(this.gamma0)-c*Math.sin(this.gamma0),Math.cos(this.bl*t/this.al))/this.bl)),e},o.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":16,"../common/tsfnz":24}],57:[function(e,t,o){var r=e("../common/e0fn"),i=e("../common/e1fn"),n=e("../common/e2fn"),a=e("../common/e3fn"),l=e("../common/adjust_lon"),s=e("../common/adjust_lat"),p=e("../common/mlfn"),c=1e-10,u=e("../common/gN"),g=20;o.init=function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=r(this.es),this.e1=i(this.es),this.e2=n(this.es),this.e3=a(this.es),this.ml0=this.a*p(this.e0,this.e1,this.e2,this.e3,this.lat0)},o.forward=function(e){var t,o,r,i=e.x,n=e.y,a=l(i-this.long0);if(r=a*Math.sin(n),this.sphere)Math.abs(n)>c?(t=this.a*Math.sin(r)/Math.tan(n),o=this.a*(s(n-this.lat0)+(1-Math.cos(r))/Math.tan(n))):(t=this.a*a,o=-1*this.a*this.lat0);else if(Math.abs(n)>c){var g=u(this.a,this.e,Math.sin(n))/Math.tan(n);t=g*Math.sin(r),o=this.a*p(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+g*(1-Math.cos(r))}else t=this.a*a,o=-1*this.ml0;return e.x=t+this.x0,e.y=o+this.y0,e},o.inverse=function(e){var t,o,r,i,n,a,s,u,d;if(r=e.x-this.x0,i=e.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)>c){a=this.lat0+i/this.a,s=r*r/this.a/this.a+a*a,u=a;var h;for(n=g;n;--n)if(h=Math.tan(u),d=-1*(a*(u*h+1)-u-.5*(u*u+s)*h)/((u-a)/h-1),u+=d,Math.abs(d)<=c){o=u;break}t=l(this.long0+Math.asin(r*Math.tan(u)/this.a)/Math.sin(o))}else t=l(r/this.a+this.long0),o=0;else if(Math.abs(i+this.ml0)>c){a=(this.ml0+i)/this.a,s=r*r/this.a/this.a+a*a,u=a;var f,y,m,v,C;for(n=g;n;--n)if(C=this.e*Math.sin(u),f=Math.sqrt(1-C*C)*Math.tan(u),y=this.a*p(this.e0,this.e1,this.e2,this.e3,u),m=this.e0-2*this.e1*Math.cos(2*u)+4*this.e2*Math.cos(4*u)-6*this.e3*Math.cos(6*u),v=y/this.a,d=(a*(f*v+1)-v-.5*f*(v*v+s))/(this.es*Math.sin(2*u)*(v*v+s-2*a*v)/(4*f)+(a-v)*(f*m-2/Math.sin(2*u))-m),u-=d,Math.abs(d)<=c){o=u;break}f=Math.sqrt(1-this.es*Math.pow(Math.sin(o),2))*Math.tan(o),t=l(this.long0+Math.asin(r*f/this.a)/Math.sin(o))}else o=0,t=l(this.long0+r/this.a);return e.x=t,e.y=o,e},o.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/mlfn":14}],58:[function(e,t,o){var r=e("../common/adjust_lon"),i=e("../common/adjust_lat"),n=e("../common/pj_enfn"),a=20,l=e("../common/pj_mlfn"),s=e("../common/pj_inv_mlfn"),p=Math.PI/2,c=1e-10,u=e("../common/asinz");o.init=function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=n(this.es)},o.forward=function(e){var t,o,i=e.x,n=e.y;if(i=r(i-this.long0),this.sphere){if(this.m)for(var s=this.n*Math.sin(n),p=a;p;--p){var u=(this.m*n+Math.sin(n)-s)/(this.m+Math.cos(n));if(n-=u,Math.abs(u)<c)break}else n=1!==this.n?Math.asin(this.n*Math.sin(n)):n;t=this.a*this.C_x*i*(this.m+Math.cos(n)),o=this.a*this.C_y*n}else{var g=Math.sin(n),d=Math.cos(n);o=this.a*l(n,g,d,this.en),t=this.a*i*d/Math.sqrt(1-this.es*g*g)}return e.x=t,e.y=o,e},o.inverse=function(e){var t,o,n,a;return e.x-=this.x0,n=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,n/=this.C_x*(this.m+Math.cos(t)),this.m?t=u((this.m*t+Math.sin(t))/this.n):1!==this.n&&(t=u(Math.sin(t)/this.n)),n=r(n+this.long0),t=i(t)):(t=s(e.y/this.a,this.es,this.en),a=Math.abs(t),p>a?(a=Math.sin(t),o=this.long0+e.x*Math.sqrt(1-this.es*a*a)/(this.a*Math.cos(t)),n=r(o)):p>a-c&&(n=this.long0)),e.x=n,e.y=t,e},o.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":6,"../common/pj_enfn":17,"../common/pj_inv_mlfn":18,"../common/pj_mlfn":19}],59:[function(e,t,o){o.init=function(){var e=this.lat0;this.lambda0=this.long0;var t=Math.sin(e),o=this.a,r=this.rf,i=1/r,n=2*i-Math.pow(i,2),a=this.e=Math.sqrt(n);this.R=this.k0*o*Math.sqrt(1-n)/(1-n*Math.pow(t,2)),this.alpha=Math.sqrt(1+n/(1-n)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha);var l=Math.log(Math.tan(Math.PI/4+this.b0/2)),s=Math.log(Math.tan(Math.PI/4+e/2)),p=Math.log((1+a*t)/(1-a*t));this.K=l-this.alpha*s+this.alpha*a/2*p},o.forward=function(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),o=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),r=-this.alpha*(t+o)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),n=this.alpha*(e.x-this.lambda0),a=Math.atan(Math.sin(n)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(n))),l=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(n));return e.y=this.R/2*Math.log((1+Math.sin(l))/(1-Math.sin(l)))+this.y0,e.x=this.R*a+this.x0,e},o.inverse=function(e){for(var t=e.x-this.x0,o=e.y-this.y0,r=t/this.R,i=2*(Math.atan(Math.exp(o/this.R))-Math.PI/4),n=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),a=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),l=this.lambda0+a/this.alpha,s=0,p=n,c=-1e3,u=0;Math.abs(p-c)>1e-7;){if(++u>20)return;s=1/this.alpha*(Math.log(Math.tan(Math.PI/4+n/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(p))/2)),c=p,p=2*Math.atan(Math.exp(s))-Math.PI/2}return e.x=l,e.y=p,e},o.names=["somerc"]},{}],60:[function(e,t,o){var r=Math.PI/2,i=1e-10,n=e("../common/sign"),a=e("../common/msfnz"),l=e("../common/tsfnz"),s=e("../common/phi2z"),p=e("../common/adjust_lon");o.ssfn_=function(e,t,o){return t*=o,Math.tan(.5*(r+e))*Math.pow((1-t)/(1+t),.5*o)},o.init=function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1!==this.k0||isNaN(this.lat_ts)||Math.abs(this.coslat0)>i||(this.k0=.5*(1+n(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)>i||(this.con=this.lat0>0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1!==this.k0||isNaN(this.lat_ts)||Math.abs(this.coslat0)>i||(this.k0=.5*this.cons*a(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/l(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=a(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-r,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},o.forward=function(e){var t,o,n,a,s,c,u=e.x,g=e.y,d=Math.sin(g),h=Math.cos(g),f=p(u-this.long0);return Math.abs(Math.abs(u-this.long0)-Math.PI)>i||Math.abs(g+this.lat0)>i?this.sphere?(t=2*this.k0/(1+this.sinlat0*d+this.coslat0*h*Math.cos(f)),e.x=this.a*t*h*Math.sin(f)+this.x0,e.y=this.a*t*(this.coslat0*d-this.sinlat0*h*Math.cos(f))+this.y0,e):(o=2*Math.atan(this.ssfn_(g,d,this.e))-r,a=Math.cos(o),n=Math.sin(o),Math.abs(this.coslat0)>i?(Math.abs(this.sinlat0)<i?(t=2*this.a*this.k0/(1+a*Math.cos(f)),e.y=t*n):(t=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*n+this.cosX0*a*Math.cos(f))),e.y=t*(this.cosX0*n-this.sinX0*a*Math.cos(f))+this.y0),e.x=t*a*Math.sin(f)+this.x0,e):(s=l(this.e,g*this.con,this.con*d),c=2*this.a*this.k0*s/this.cons,e.x=this.x0+c*Math.sin(u-this.long0),e.y=this.y0-this.con*c*Math.cos(u-this.long0),e)):(e.x=0/0,e.y=0/0,e)},o.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t,o,n,a,l,c=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var u=2*Math.atan(c/(.5*this.a*this.k0));return t=this.long0,o=this.lat0,c>i?(o=Math.asin(Math.cos(u)*this.sinlat0+e.y*Math.sin(u)*this.coslat0/c),t=p(Math.abs(this.coslat0)<i?this.lat0>0?this.long0+Math.atan2(e.x,-1*e.y):this.long0+Math.atan2(e.x,e.y):this.long0+Math.atan2(e.x*Math.sin(u),c*this.coslat0*Math.cos(u)-e.y*this.sinlat0*Math.sin(u))),e.x=t,e.y=o,e):(e.x=t,e.y=o,e)}if(Math.abs(this.coslat0)>i)a=2*Math.atan(c*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,c>i?(l=Math.asin(Math.cos(a)*this.sinX0+e.y*Math.sin(a)*this.cosX0/c),t=p(this.long0+Math.atan2(e.x*Math.sin(a),c*this.cosX0*Math.cos(a)-e.y*this.sinX0*Math.sin(a)))):l=this.X0,o=-1*s(this.e,Math.tan(.5*(r+l)));else{if(i>=c)return o=this.lat0,t=this.long0,e.x=t,e.y=o,e;e.x*=this.con,e.y*=this.con,n=c*this.cons/(2*this.a*this.k0),o=this.con*s(this.e,n),t=this.con*p(this.con*this.long0+Math.atan2(e.x,-1*e.y))}return e.x=t,e.y=o,e},o.names=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],61:[function(e,t,o){var r=e("./gauss"),i=e("../common/adjust_lon");o.init=function(){r.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},o.forward=function(e){var t,o,n,a;return e.x=i(e.x-this.long0),r.forward.apply(this,[e]),t=Math.sin(e.y),o=Math.cos(e.y),n=Math.cos(e.x),a=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*o*n),e.x=a*o*Math.sin(e.x),e.y=a*(this.cosc0*t-this.sinc0*o*n),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e},o.inverse=function(e){var t,o,n,a,l;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,l=Math.sqrt(e.x*e.x+e.y*e.y)){var s=2*Math.atan2(l,this.R2);t=Math.sin(s),o=Math.cos(s),a=Math.asin(o*this.sinc0+e.y*t*this.cosc0/l),n=Math.atan2(e.x*t,l*this.cosc0*o-e.y*this.sinc0*t)}else a=this.phic0,n=0;return e.x=n,e.y=a,r.inverse.apply(this,[e]),e.x=i(e.x+this.long0),e},o.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":46}],62:[function(e,t,o){var r=e("../common/e0fn"),i=e("../common/e1fn"),n=e("../common/e2fn"),a=e("../common/e3fn"),l=e("../common/mlfn"),s=e("../common/adjust_lon"),p=Math.PI/2,c=1e-10,u=e("../common/sign"),g=e("../common/asinz");o.init=function(){this.e0=r(this.es),this.e1=i(this.es),this.e2=n(this.es),this.e3=a(this.es),this.ml0=this.a*l(this.e0,this.e1,this.e2,this.e3,this.lat0)},o.forward=function(e){var t,o,r,i=e.x,n=e.y,a=s(i-this.long0),p=Math.sin(n),c=Math.cos(n);if(this.sphere){var u=c*Math.sin(a);if(Math.abs(Math.abs(u)-1)<1e-10)return 93;o=.5*this.a*this.k0*Math.log((1+u)/(1-u)),t=Math.acos(c*Math.cos(a)/Math.sqrt(1-u*u)),0>n&&(t=-t),r=this.a*this.k0*(t-this.lat0)}else{var g=c*a,d=Math.pow(g,2),h=this.ep2*Math.pow(c,2),f=Math.tan(n),y=Math.pow(f,2);t=1-this.es*Math.pow(p,2);var m=this.a/Math.sqrt(t),v=this.a*l(this.e0,this.e1,this.e2,this.e3,n);o=this.k0*m*g*(1+d/6*(1-y+h+d/20*(5-18*y+Math.pow(y,2)+72*h-58*this.ep2)))+this.x0,r=this.k0*(v-this.ml0+m*f*d*(.5+d/24*(5-y+9*h+4*Math.pow(h,2)+d/30*(61-58*y+Math.pow(y,2)+600*h-330*this.ep2))))+this.y0}return e.x=o,e.y=r,e},o.inverse=function(e){var t,o,r,i,n,a,l=6;if(this.sphere){var d=Math.exp(e.x/(this.a*this.k0)),h=.5*(d-1/d),f=this.lat0+e.y/(this.a*this.k0),y=Math.cos(f);t=Math.sqrt((1-y*y)/(1+h*h)),n=g(t),0>f&&(n=-n),a=0===h&&0===y?this.long0:s(Math.atan2(h,y)+this.long0)}else{var m=e.x-this.x0,v=e.y-this.y0;for(t=(this.ml0+v/this.k0)/this.a,o=t,i=0;r=(t+this.e1*Math.sin(2*o)-this.e2*Math.sin(4*o)+this.e3*Math.sin(6*o))/this.e0-o,o+=r,Math.abs(r)>c;i++)if(i>=l)return 95;if(Math.abs(o)<p){var C=Math.sin(o),T=Math.cos(o),_=Math.tan(o),S=this.ep2*Math.pow(T,2),E=Math.pow(S,2),x=Math.pow(_,2),P=Math.pow(x,2);t=1-this.es*Math.pow(C,2);var L=this.a/Math.sqrt(t),w=L*(1-this.es)/t,R=m/(L*this.k0),A=Math.pow(R,2);n=o-L*_*A/w*(.5-A/24*(5+3*x+10*S-4*E-9*this.ep2-A/30*(61+90*x+298*S+45*P-252*this.ep2-3*E))),a=s(this.long0+R*(1-A/6*(1+2*x+S-A/20*(5-2*S+28*x-3*E+8*this.ep2+24*P)))/T)}else n=p*u(v),a=this.long0}return e.x=a,e.y=n,e},o.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/mlfn":14,"../common/sign":21}],63:[function(e,t,o){var r=.017453292519943295,i=e("./tmerc");o.dependsOn="tmerc",o.init=function(){this.zone&&(this.lat0=0,this.long0=(6*Math.abs(this.zone)-183)*r,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,i.init.apply(this),this.forward=i.forward,this.inverse=i.inverse)},o.names=["Universal Transverse Mercator System","utm"]},{"./tmerc":62}],64:[function(e,t,o){var r=e("../common/adjust_lon"),i=Math.PI/2,n=1e-10,a=e("../common/asinz");o.init=function(){this.R=this.a},o.forward=function(e){var t,o,l=e.x,s=e.y,p=r(l-this.long0);Math.abs(s)>n||(t=this.x0+this.R*p,o=this.y0);var c=a(2*Math.abs(s/Math.PI));Math.abs(p)>n&&Math.abs(Math.abs(s)-i)>n||(t=this.x0,o=0>s?this.y0+Math.PI*this.R*-Math.tan(.5*c):this.y0+Math.PI*this.R*Math.tan(.5*c));var u=.5*Math.abs(Math.PI/p-p/Math.PI),g=u*u,d=Math.sin(c),h=Math.cos(c),f=h/(d+h-1),y=f*f,m=f*(2/d-1),v=m*m,C=Math.PI*this.R*(u*(f-v)+Math.sqrt(g*(f-v)*(f-v)-(v+g)*(y-v)))/(v+g);0>p&&(C=-C),t=this.x0+C;var T=g+f;return C=Math.PI*this.R*(m*T-u*Math.sqrt((v+g)*(g+1)-T*T))/(v+g),o=0>s?this.y0-C:this.y0+C,e.x=t,e.y=o,e},o.inverse=function(e){var t,o,i,a,l,s,p,c,u,g,d,h,f;return e.x-=this.x0,e.y-=this.y0,d=Math.PI*this.R,i=e.x/d,a=e.y/d,l=i*i+a*a,s=-Math.abs(a)*(1+l),p=s-2*a*a+i*i,c=-2*s+1+2*a*a+l*l,f=a*a/c+(2*p*p*p/c/c/c-9*s*p/c/c)/27,u=(s-p*p/3/c)/c,g=2*Math.sqrt(-u/3),d=3*f/u/g,Math.abs(d)>1&&(d=0>d?-1:1),h=Math.acos(d)/3,o=e.y<0?-(-g*Math.cos(h+Math.PI/3)-p/3/c)*Math.PI:(-g*Math.cos(h+Math.PI/3)-p/3/c)*Math.PI,t=Math.abs(i)<n?this.long0:r(this.long0+Math.PI*(l-1+Math.sqrt(1+2*(i*i-a*a)+l*l))/2/i),e.x=t,e.y=o,e},o.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":6}],65:[function(e,t){var o=.017453292519943295,r=57.29577951308232,i=1,n=2,a=e("./datum_transform"),l=e("./adjust_axis"),s=e("./Proj"),p=e("./common/toPoint");t.exports=function c(e,t,u){function g(e,t){return(e.datum.datum_type===i||e.datum.datum_type===n)&&"WGS84"!==t.datumCode}var d;return Array.isArray(u)&&(u=p(u)),e.datum&&t.datum&&(g(e,t)||g(t,e))&&(d=new s("WGS84"),c(e,d,u),e=d),"enu"!==e.axis&&l(e,!1,u),"longlat"===e.projName?(u.x*=o,u.y*=o):(e.to_meter&&(u.x*=e.to_meter,u.y*=e.to_meter),e.inverse(u)),e.from_greenwich&&(u.x+=e.from_greenwich),u=a(e.datum,t.datum,u),t.from_greenwich&&(u.x-=t.from_greenwich),"longlat"===t.projName?(u.x*=r,u.y*=r):(t.forward(u),t.to_meter&&(u.x/=t.to_meter,u.y/=t.to_meter)),"enu"!==t.axis&&l(t,!0,u),u}},{"./Proj":2,"./adjust_axis":3,"./common/toPoint":23,"./datum_transform":31}],66:[function(e,t){function o(e,t,o){e[t]=o.map(function(e){var t={};return r(e,t),t}).reduce(function(e,t){return s(e,t)},{})}function r(e,t){var i;return Array.isArray(e)?(i=e.shift(),"PARAMETER"===i&&(i=e.shift()),void(1===e.length?Array.isArray(e[0])?(t[i]={},r(e[0],t[i])):t[i]=e[0]:e.length?"TOWGS84"===i?t[i]=e:(t[i]={},["UNIT","PRIMEM","VERT_DATUM"].indexOf(i)>-1?(t[i]={name:e[0].toLowerCase(),convert:e[1]},3===e.length&&(t[i].auth=e[2])):"SPHEROID"===i?(t[i]={name:e[0],a:e[1],rf:e[2]},4===e.length&&(t[i].auth=e[3])):["GEOGCS","GEOCCS","DATUM","VERT_CS","COMPD_CS","LOCAL_CS","FITTED_CS","LOCAL_DATUM"].indexOf(i)>-1?(e[0]=["name",e[0]],o(t,i,e)):e.every(function(e){return Array.isArray(e)})?o(t,i,e):r(e,t[i])):t[i]=!0)):void(t[e]=!0)}function i(e,t){var o=t[0],r=t[1];!(o in e)&&r in e&&(e[o]=e[r],3===t.length&&(e[o]=t[2](e[o])))}function n(e){return e*l}function a(e){function t(t){var o=e.to_meter||1;return parseFloat(t,10)*o}"GEOGCS"===e.type?e.projName="longlat":"LOCAL_CS"===e.type?(e.projName="identity",e.local=!0):e.projName="object"==typeof e.PROJECTION?Object.keys(e.PROJECTION)[0]:e.PROJECTION,e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),"metre"===e.units&&(e.units="meter"),e.UNIT.convert&&("GEOGCS"===e.type?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=parseFloat(e.UNIT.convert,10)*e.DATUM.SPHEROID.a):e.to_meter=parseFloat(e.UNIT.convert,10))),e.GEOGCS&&(e.datumCode=e.GEOGCS.DATUM?e.GEOGCS.DATUM.name.toLowerCase():e.GEOGCS.name.toLowerCase(),"d_"===e.datumCode.slice(0,2)&&(e.datumCode=e.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===e.datumCode||"new_zealand_1949"===e.datumCode)&&(e.datumCode="nzgd49"),"wgs_1984"===e.datumCode&&("Mercator_Auxiliary_Sphere"===e.PROJECTION&&(e.sphere=!0),e.datumCode="wgs84"),"_ferro"===e.datumCode.slice(-6)&&(e.datumCode=e.datumCode.slice(0,-6)),"_jakarta"===e.datumCode.slice(-8)&&(e.datumCode=e.datumCode.slice(0,-8)),~e.datumCode.indexOf("belge")&&(e.datumCode="rnb72"),e.GEOGCS.DATUM&&e.GEOGCS.DATUM.SPHEROID&&(e.ellps=e.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===e.ellps.toLowerCase().slice(0,13)&&(e.ellps="intl"),e.a=e.GEOGCS.DATUM.SPHEROID.a,e.rf=parseFloat(e.GEOGCS.DATUM.SPHEROID.rf,10)),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36")),e.b&&!isFinite(e.b)&&(e.b=e.a);var o=function(t){return i(e,t)},r=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",n],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",n],["x0","false_easting",t],["y0","false_northing",t],["long0","central_meridian",n],["lat0","latitude_of_origin",n],["lat0","standard_parallel_1",n],["lat1","standard_parallel_1",n],["lat2","standard_parallel_2",n],["alpha","azimuth",n],["srsCode","name"]];

r.forEach(o),e.long0||!e.longc||"Albers_Conic_Equal_Area"!==e.projName&&"Lambert_Azimuthal_Equal_Area"!==e.projName||(e.long0=e.longc),e.lat_ts||!e.lat1||"Stereographic_South_Pole"!==e.projName&&"Polar Stereographic (variant B)"!==e.projName||(e.lat0=n(e.lat1>0?90:-90),e.lat_ts=e.lat1)}var l=.017453292519943295,s=e("./extend");t.exports=function(e,t){var o=JSON.parse((","+e).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]').replace(/,\["VERTCS".+/,"")),i=o.shift(),n=o.shift();o.unshift(["name",n]),o.unshift(["type",i]),o.unshift("output");var l={};return r(o,l),a(l.output),s(t,l.output)}},{"./extend":34}],67:[function(e,t,o){function r(e){return e*(Math.PI/180)}function i(e){return 180*(e/Math.PI)}function n(e){var t,o,i,n,a,s,p,c,u,g=e.lat,d=e.lon,h=6378137,f=.00669438,y=.9996,m=r(g),v=r(d);u=Math.floor((d+180)/6)+1,180===d&&(u=60),g>=56&&64>g&&d>=3&&12>d&&(u=32),g>=72&&84>g&&(d>=0&&9>d?u=31:d>=9&&21>d?u=33:d>=21&&33>d?u=35:d>=33&&42>d&&(u=37)),t=6*(u-1)-180+3,c=r(t),o=f/(1-f),i=h/Math.sqrt(1-f*Math.sin(m)*Math.sin(m)),n=Math.tan(m)*Math.tan(m),a=o*Math.cos(m)*Math.cos(m),s=Math.cos(m)*(v-c),p=h*((1-f/4-3*f*f/64-5*f*f*f/256)*m-(3*f/8+3*f*f/32+45*f*f*f/1024)*Math.sin(2*m)+(15*f*f/256+45*f*f*f/1024)*Math.sin(4*m)-35*f*f*f/3072*Math.sin(6*m));var C=y*i*(s+(1-n+a)*s*s*s/6+(5-18*n+n*n+72*a-58*o)*s*s*s*s*s/120)+5e5,T=y*(p+i*Math.tan(m)*(s*s/2+(5-n+9*a+4*a*a)*s*s*s*s/24+(61-58*n+n*n+600*a-330*o)*s*s*s*s*s*s/720));return 0>g&&(T+=1e7),{northing:Math.round(T),easting:Math.round(C),zoneNumber:u,zoneLetter:l(g)}}function a(e){var t=e.northing,o=e.easting,r=e.zoneLetter,n=e.zoneNumber;if(0>n||n>60)return null;var l,s,p,c,u,g,d,h,f,y,m=.9996,v=6378137,C=.00669438,T=(1-Math.sqrt(1-C))/(1+Math.sqrt(1-C)),_=o-5e5,S=t;"N">r&&(S-=1e7),h=6*(n-1)-180+3,l=C/(1-C),d=S/m,f=d/(v*(1-C/4-3*C*C/64-5*C*C*C/256)),y=f+(3*T/2-27*T*T*T/32)*Math.sin(2*f)+(21*T*T/16-55*T*T*T*T/32)*Math.sin(4*f)+151*T*T*T/96*Math.sin(6*f),s=v/Math.sqrt(1-C*Math.sin(y)*Math.sin(y)),p=Math.tan(y)*Math.tan(y),c=l*Math.cos(y)*Math.cos(y),u=v*(1-C)/Math.pow(1-C*Math.sin(y)*Math.sin(y),1.5),g=_/(s*m);var E=y-s*Math.tan(y)/u*(g*g/2-(5+3*p+10*c-4*c*c-9*l)*g*g*g*g/24+(61+90*p+298*c+45*p*p-252*l-3*c*c)*g*g*g*g*g*g/720);E=i(E);var x=(g-(1+2*p+c)*g*g*g/6+(5-2*c+28*p-3*c*c+8*l+24*p*p)*g*g*g*g*g/120)/Math.cos(y);x=h+i(x);var P;if(e.accuracy){var L=a({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});P={top:L.lat,right:L.lon,bottom:E,left:x}}else P={lat:E,lon:x};return P}function l(e){var t="Z";return e>84||72>e?72>e&&e>=64?t="W":64>e&&e>=56?t="V":56>e&&e>=48?t="U":48>e&&e>=40?t="T":40>e&&e>=32?t="S":32>e&&e>=24?t="R":24>e&&e>=16?t="Q":16>e&&e>=8?t="P":8>e&&e>=0?t="N":0>e&&e>=-8?t="M":-8>e&&e>=-16?t="L":-16>e&&e>=-24?t="K":-24>e&&e>=-32?t="J":-32>e&&e>=-40?t="H":-40>e&&e>=-48?t="G":-48>e&&e>=-56?t="F":-56>e&&e>=-64?t="E":-64>e&&e>=-72?t="D":-72>e&&e>=-80&&(t="C"):t="X",t}function s(e,t){var o="00000"+e.easting,r="00000"+e.northing;return e.zoneNumber+e.zoneLetter+p(e.easting,e.northing,e.zoneNumber)+o.substr(o.length-5,t)+r.substr(r.length-5,t)}function p(e,t,o){var r=c(o),i=Math.floor(e/1e5),n=Math.floor(t/1e5)%20;return u(i,n,r)}function c(e){var t=e%y;return 0===t&&(t=y),t}function u(e,t,o){var r=o-1,i=m.charCodeAt(r),n=v.charCodeAt(r),a=i+e-1,l=n+t,s=!1;a>E&&(a=a-E+C-1,s=!0),(a===T||T>i&&a>T||(a>T||T>i)&&s)&&a++,(a===_||_>i&&a>_||(a>_||_>i)&&s)&&(a++,a===T&&a++),a>E&&(a=a-E+C-1),l>S?(l=l-S+C-1,s=!0):s=!1,(l===T||T>n&&l>T||(l>T||T>n)&&s)&&l++,(l===_||_>n&&l>_||(l>_||_>n)&&s)&&(l++,l===T&&l++),l>S&&(l=l-S+C-1);var p=String.fromCharCode(a)+String.fromCharCode(l);return p}function g(e){if(e&&0===e.length)throw"MGRSPoint coverting from nothing";for(var t,o=e.length,r=null,i="",n=0;!/[A-Z]/.test(t=e.charAt(n));){if(n>=2)throw"MGRSPoint bad conversion from: "+e;i+=t,n++}var a=parseInt(i,10);if(0===n||n+3>o)throw"MGRSPoint bad conversion from: "+e;var l=e.charAt(n++);if("A">=l||"B"===l||"Y"===l||l>="Z"||"I"===l||"O"===l)throw"MGRSPoint zone letter "+l+" not handled: "+e;r=e.substring(n,n+=2);for(var s=c(a),p=d(r.charAt(0),s),u=h(r.charAt(1),s);u<f(l);)u+=2e6;var g=o-n;if(g%2!==0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+e;var y,m,v,C,T,_=g/2,S=0,E=0;return _>0&&(y=1e5/Math.pow(10,_),m=e.substring(n,n+_),S=parseFloat(m)*y,v=e.substring(n+_),E=parseFloat(v)*y),C=S+p,T=E+u,{easting:C,northing:T,zoneLetter:l,zoneNumber:a,accuracy:y}}function d(e,t){for(var o=m.charCodeAt(t-1),r=1e5,i=!1;o!==e.charCodeAt(0);){if(o++,o===T&&o++,o===_&&o++,o>E){if(i)throw"Bad character: "+e;o=C,i=!0}r+=1e5}return r}function h(e,t){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var o=v.charCodeAt(t-1),r=0,i=!1;o!==e.charCodeAt(0);){if(o++,o===T&&o++,o===_&&o++,o>S){if(i)throw"Bad character: "+e;o=C,i=!0}r+=1e5}return r}function f(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(0>t)throw"Invalid zone letter: "+e;return t}var y=6,m="AJSAJS",v="AFAFAF",C=65,T=73,_=79,S=86,E=90;o.forward=function(e,t){return t=t||5,s(n({lat:e[1],lon:e[0]}),t)},o.inverse=function(e){var t=a(g(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]},o.toPoint=function(e){var t=a(g(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}},{}],68:[function(e,t){t.exports={name:"proj4",version:"2.3.14",description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",main:"lib/index.js",directories:{test:"test",doc:"docs"},scripts:{test:"./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"},repository:{type:"git",url:"git://github.com/proj4js/proj4js.git"},author:"",license:"MIT",jam:{main:"dist/proj4.js",include:["dist/proj4.js","README.md","AUTHORS","LICENSE.md"]},devDependencies:{"grunt-cli":"~0.1.13",grunt:"~0.4.2","grunt-contrib-connect":"~0.6.0","grunt-contrib-jshint":"~0.8.0",chai:"~1.8.1",mocha:"~1.17.1","grunt-mocha-phantomjs":"~0.4.0",browserify:"~12.0.1","grunt-browserify":"~4.0.1","grunt-contrib-uglify":"~0.11.1",curl:"git://github.com/cujojs/curl.git",istanbul:"~0.2.4",tin:"~0.4.0"},dependencies:{mgrs:"~0.0.2"}}},{}],"./includedProjections":[function(e,t){t.exports=e("hTEDpn")},{}],hTEDpn:[function(e,t){var o=[e("./lib/projections/tmerc"),e("./lib/projections/utm"),e("./lib/projections/sterea"),e("./lib/projections/stere"),e("./lib/projections/somerc"),e("./lib/projections/omerc"),e("./lib/projections/lcc"),e("./lib/projections/krovak"),e("./lib/projections/cass"),e("./lib/projections/laea"),e("./lib/projections/aea"),e("./lib/projections/gnom"),e("./lib/projections/cea"),e("./lib/projections/eqc"),e("./lib/projections/poly"),e("./lib/projections/nzmg"),e("./lib/projections/mill"),e("./lib/projections/sinu"),e("./lib/projections/moll"),e("./lib/projections/eqdc"),e("./lib/projections/vandg"),e("./lib/projections/aeqd")];t.exports=function(e){o.forEach(function(t){e.Proj.projections.add(t)})}},{"./lib/projections/aea":40,"./lib/projections/aeqd":41,"./lib/projections/cass":42,"./lib/projections/cea":43,"./lib/projections/eqc":44,"./lib/projections/eqdc":45,"./lib/projections/gnom":47,"./lib/projections/krovak":48,"./lib/projections/laea":49,"./lib/projections/lcc":50,"./lib/projections/mill":53,"./lib/projections/moll":54,"./lib/projections/nzmg":55,"./lib/projections/omerc":56,"./lib/projections/poly":57,"./lib/projections/sinu":58,"./lib/projections/somerc":59,"./lib/projections/stere":60,"./lib/projections/sterea":61,"./lib/projections/tmerc":62,"./lib/projections/utm":63,"./lib/projections/vandg":64}]},{},[36])(36)});!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function o(e){var t=e.length,o=Q.type(e);return"function"===o||Q.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===o||0===t||"number"==typeof t&&t>0&&t-1 in e}function r(e,t,o){if(Q.isFunction(t))return Q.grep(e,function(e,r){return!!t.call(e,r,e)!==o});if(t.nodeType)return Q.grep(e,function(e){return e===t!==o});if("string"==typeof t){if(le.test(t))return Q.filter(t,e,o);t=Q.filter(t,e)}return Q.grep(e,function(e){return Y.call(t,e)>=0!==o})}function i(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function n(e){var t=he[e]={};Q.each(e.match(de)||[],function(e,o){t[o]=!0});return t}function a(){Z.removeEventListener("DOMContentLoaded",a,!1);e.removeEventListener("load",a,!1);Q.ready()}function l(){Object.defineProperty(this.cache={},0,{get:function(){return{}}});this.expando=Q.expando+l.uid++}function s(e,t,o){var r;if(void 0===o&&1===e.nodeType){r="data-"+t.replace(Te,"-$1").toLowerCase();o=e.getAttribute(r);if("string"==typeof o){try{o="true"===o?!0:"false"===o?!1:"null"===o?null:+o+""===o?+o:Ce.test(o)?Q.parseJSON(o):o}catch(i){}ve.set(e,t,o)}else o=void 0}return o}function p(){return!0}function c(){return!1}function u(){try{return Z.activeElement}catch(e){}}function g(e,t){return Q.nodeName(e,"table")&&Q.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function d(e){e.type=(null!==e.getAttribute("type"))+"/"+e.type;return e}function h(e){var t=Fe.exec(e.type);t?e.type=t[1]:e.removeAttribute("type");return e}function f(e,t){for(var o=0,r=e.length;r>o;o++)me.set(e[o],"globalEval",!t||me.get(t[o],"globalEval"))}function y(e,t){var o,r,i,n,a,l,s,p;if(1===t.nodeType){if(me.hasData(e)){n=me.access(e);a=me.set(t,n);p=n.events;if(p){delete a.handle;a.events={};for(i in p)for(o=0,r=p[i].length;r>o;o++)Q.event.add(t,i,p[i][o])}}if(ve.hasData(e)){l=ve.access(e);s=Q.extend({},l);ve.set(t,s)}}}function m(e,t){var o=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&Q.nodeName(e,t)?Q.merge([e],o):o}function v(e,t){var o=t.nodeName.toLowerCase();"input"===o&&xe.test(e.type)?t.checked=e.checked:("input"===o||"textarea"===o)&&(t.defaultValue=e.defaultValue)}function C(t,o){var r,i=Q(o.createElement(t)).appendTo(o.body),n=e.getDefaultComputedStyle&&(r=e.getDefaultComputedStyle(i[0]))?r.display:Q.css(i[0],"display");i.detach();return n}function T(e){var t=Z,o=Be[e];if(!o){o=C(e,t);if("none"===o||!o){Ue=(Ue||Q("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement);t=Ue[0].contentDocument;t.write();t.close();o=C(e,t);Ue.detach()}Be[e]=o}return o}function _(e,t,o){var r,i,n,a,l=e.style;o=o||$e(e);o&&(a=o.getPropertyValue(t)||o[t]);if(o){""!==a||Q.contains(e.ownerDocument,e)||(a=Q.style(e,t));if(je.test(a)&&qe.test(t)){r=l.width;i=l.minWidth;n=l.maxWidth;l.minWidth=l.maxWidth=l.width=a;a=o.width;l.width=r;l.minWidth=i;l.maxWidth=n}}return void 0!==a?a+"":a}function S(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get;return void 0}}}function E(e,t){if(t in e)return t;for(var o=t[0].toUpperCase()+t.slice(1),r=t,i=He.length;i--;){t=He[i]+o;if(t in e)return t}return r}function x(e,t,o){var r=Ve.exec(t);return r?Math.max(0,r[1]-(o||0))+(r[2]||"px"):t}function P(e,t,o,r,i){for(var n=o===(r?"border":"content")?4:"width"===t?1:0,a=0;4>n;n+=2){"margin"===o&&(a+=Q.css(e,o+Se[n],!0,i));if(r){"content"===o&&(a-=Q.css(e,"padding"+Se[n],!0,i));"margin"!==o&&(a-=Q.css(e,"border"+Se[n]+"Width",!0,i))}else{a+=Q.css(e,"padding"+Se[n],!0,i);"padding"!==o&&(a+=Q.css(e,"border"+Se[n]+"Width",!0,i))}}return a}function L(e,t,o){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,n=$e(e),a="border-box"===Q.css(e,"boxSizing",!1,n);if(0>=i||null==i){i=_(e,t,n);(0>i||null==i)&&(i=e.style[t]);if(je.test(i))return i;r=a&&(z.boxSizingReliable()||i===e.style[t]);i=parseFloat(i)||0}return i+P(e,t,o||(a?"border":"content"),r,n)+"px"}function w(e,t){for(var o,r,i,n=[],a=0,l=e.length;l>a;a++){r=e[a];if(r.style){n[a]=me.get(r,"olddisplay");o=r.style.display;if(t){n[a]||"none"!==o||(r.style.display="");""===r.style.display&&Ee(r)&&(n[a]=me.access(r,"olddisplay",T(r.nodeName)))}else{i=Ee(r);"none"===o&&i||me.set(r,"olddisplay",i?o:Q.css(r,"display"))}}}for(a=0;l>a;a++){r=e[a];r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?n[a]||"":"none"))}return e}function R(e,t,o,r,i){return new R.prototype.init(e,t,o,r,i)}function A(){setTimeout(function(){ze=void 0});return ze=Q.now()}function b(e,t){var o,r=0,i={height:e};t=t?1:0;for(;4>r;r+=2-t){o=Se[r];i["margin"+o]=i["padding"+o]=e}t&&(i.opacity=i.width=e);return i}function M(e,t,o){for(var r,i=(ot[t]||[]).concat(ot["*"]),n=0,a=i.length;a>n;n++)if(r=i[n].call(o,t,e))return r}function I(e,t,o){var r,i,n,a,l,s,p,c,u=this,g={},d=e.style,h=e.nodeType&&Ee(e),f=me.get(e,"fxshow");if(!o.queue){l=Q._queueHooks(e,"fx");if(null==l.unqueued){l.unqueued=0;s=l.empty.fire;l.empty.fire=function(){l.unqueued||s()}}l.unqueued++;u.always(function(){u.always(function(){l.unqueued--;Q.queue(e,"fx").length||l.empty.fire()})})}if(1===e.nodeType&&("height"in t||"width"in t)){o.overflow=[d.overflow,d.overflowX,d.overflowY];p=Q.css(e,"display");c="none"===p?me.get(e,"olddisplay")||T(e.nodeName):p;"inline"===c&&"none"===Q.css(e,"float")&&(d.display="inline-block")}if(o.overflow){d.overflow="hidden";u.always(function(){d.overflow=o.overflow[0];d.overflowX=o.overflow[1];d.overflowY=o.overflow[2]})}for(r in t){i=t[r];if(Je.exec(i)){delete t[r];n=n||"toggle"===i;if(i===(h?"hide":"show")){if("show"!==i||!f||void 0===f[r])continue;h=!0}g[r]=f&&f[r]||Q.style(e,r)}else p=void 0}if(Q.isEmptyObject(g))"inline"===("none"===p?T(e.nodeName):p)&&(d.display=p);else{f?"hidden"in f&&(h=f.hidden):f=me.access(e,"fxshow",{});n&&(f.hidden=!h);h?Q(e).show():u.done(function(){Q(e).hide()});u.done(function(){var t;me.remove(e,"fxshow");for(t in g)Q.style(e,t,g[t])});for(r in g){a=M(h?f[r]:0,r,u);if(!(r in f)){f[r]=a.start;if(h){a.end=a.start;a.start="width"===r||"height"===r?1:0}}}}}function O(e,t){var o,r,i,n,a;for(o in e){r=Q.camelCase(o);i=t[r];n=e[o];if(Q.isArray(n)){i=n[1];n=e[o]=n[0]}if(o!==r){e[r]=n;delete e[o]}a=Q.cssHooks[r];if(a&&"expand"in a){n=a.expand(n);delete e[r];for(o in n)if(!(o in e)){e[o]=n[o];t[o]=i}}else t[r]=i}}function N(e,t,o){var r,i,n=0,a=tt.length,l=Q.Deferred().always(function(){delete s.elem}),s=function(){if(i)return!1;for(var t=ze||A(),o=Math.max(0,p.startTime+p.duration-t),r=o/p.duration||0,n=1-r,a=0,s=p.tweens.length;s>a;a++)p.tweens[a].run(n);l.notifyWith(e,[p,n,o]);if(1>n&&s)return o;l.resolveWith(e,[p]);return!1},p=l.promise({elem:e,props:Q.extend({},t),opts:Q.extend(!0,{specialEasing:{}},o),originalProperties:t,originalOptions:o,startTime:ze||A(),duration:o.duration,tweens:[],createTween:function(t,o){var r=Q.Tween(e,p.opts,t,o,p.opts.specialEasing[t]||p.opts.easing);p.tweens.push(r);return r},stop:function(t){var o=0,r=t?p.tweens.length:0;if(i)return this;i=!0;for(;r>o;o++)p.tweens[o].run(1);t?l.resolveWith(e,[p,t]):l.rejectWith(e,[p,t]);return this}}),c=p.props;O(c,p.opts.specialEasing);for(;a>n;n++){r=tt[n].call(p,e,c,p.opts);if(r)return r}Q.map(c,M,p);Q.isFunction(p.opts.start)&&p.opts.start.call(e,p);Q.fx.timer(Q.extend(s,{elem:e,anim:p,queue:p.opts.queue}));return p.progress(p.opts.progress).done(p.opts.done,p.opts.complete).fail(p.opts.fail).always(p.opts.always)}function D(e){return function(t,o){if("string"!=typeof t){o=t;t="*"}var r,i=0,n=t.toLowerCase().match(de)||[];if(Q.isFunction(o))for(;r=n[i++];)if("+"===r[0]){r=r.slice(1)||"*";(e[r]=e[r]||[]).unshift(o)}else(e[r]=e[r]||[]).push(o)}}function F(e,t,o,r){function i(l){var s;n[l]=!0;Q.each(e[l]||[],function(e,l){var p=l(t,o,r);if("string"==typeof p&&!a&&!n[p]){t.dataTypes.unshift(p);i(p);return!1}return a?!(s=p):void 0});return s}var n={},a=e===Ct;return i(t.dataTypes[0])||!n["*"]&&i("*")}function k(e,t){var o,r,i=Q.ajaxSettings.flatOptions||{};for(o in t)void 0!==t[o]&&((i[o]?e:r||(r={}))[o]=t[o]);r&&Q.extend(!0,e,r);return e}function G(e,t,o){for(var r,i,n,a,l=e.contents,s=e.dataTypes;"*"===s[0];){s.shift();void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"))}if(r)for(i in l)if(l[i]&&l[i].test(r)){s.unshift(i);break}if(s[0]in o)n=s[0];else{for(i in o){if(!s[0]||e.converters[i+" "+s[0]]){n=i;break}a||(a=i)}n=n||a}if(n){n!==s[0]&&s.unshift(n);return o[n]}}function U(e,t,o,r){var i,n,a,l,s,p={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)p[a.toLowerCase()]=e.converters[a];n=c.shift();for(;n;){e.responseFields[n]&&(o[e.responseFields[n]]=t);!s&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType));s=n;n=c.shift();if(n)if("*"===n)n=s;else if("*"!==s&&s!==n){a=p[s+" "+n]||p["* "+n];if(!a)for(i in p){l=i.split(" ");if(l[1]===n){a=p[s+" "+l[0]]||p["* "+l[0]];if(a){if(a===!0)a=p[i];else if(p[i]!==!0){n=l[0];c.unshift(l[1])}break}}}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(u){return{state:"parsererror",error:a?u:"No conversion from "+s+" to "+n}}}}return{state:"success",data:t}}function B(e,t,o,r){var i;if(Q.isArray(t))Q.each(t,function(t,i){o||xt.test(e)?r(e,i):B(e+"["+("object"==typeof i?t:"")+"]",i,o,r)});else if(o||"object"!==Q.type(t))r(e,t);else for(i in t)B(e+"["+i+"]",t[i],o,r)}function q(e){return Q.isWindow(e)?e:9===e.nodeType&&e.defaultView}var j=[],$=j.slice,W=j.concat,V=j.push,Y=j.indexOf,K={},X=K.toString,H=K.hasOwnProperty,z={},Z=e.document,J="2.1.3",Q=function(e,t){return new Q.fn.init(e,t)},ee=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,te=/^-ms-/,oe=/-([\da-z])/gi,re=function(e,t){return t.toUpperCase()};Q.fn=Q.prototype={jquery:J,constructor:Q,selector:"",length:0,toArray:function(){return $.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:$.call(this)},pushStack:function(e){var t=Q.merge(this.constructor(),e);t.prevObject=this;t.context=this.context;return t},each:function(e,t){return Q.each(this,e,t)},map:function(e){return this.pushStack(Q.map(this,function(t,o){return e.call(t,o,t)}))},slice:function(){return this.pushStack($.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,o=+e+(0>e?t:0);return this.pushStack(o>=0&&t>o?[this[o]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:V,sort:j.sort,splice:j.splice};Q.extend=Q.fn.extend=function(){var e,t,o,r,i,n,a=arguments[0]||{},l=1,s=arguments.length,p=!1;if("boolean"==typeof a){p=a;a=arguments[l]||{};l++}"object"==typeof a||Q.isFunction(a)||(a={});if(l===s){a=this;l--}for(;s>l;l++)if(null!=(e=arguments[l]))for(t in e){o=a[t];r=e[t];if(a!==r)if(p&&r&&(Q.isPlainObject(r)||(i=Q.isArray(r)))){if(i){i=!1;n=o&&Q.isArray(o)?o:[]}else n=o&&Q.isPlainObject(o)?o:{};a[t]=Q.extend(p,n,r)}else void 0!==r&&(a[t]=r)}return a};Q.extend({expando:"jQuery"+(J+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===Q.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!Q.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return"object"!==Q.type(e)||e.nodeType||Q.isWindow(e)?!1:e.constructor&&!H.call(e.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?K[X.call(e)]||"object":typeof e},globalEval:function(e){var t,o=eval;e=Q.trim(e);if(e)if(1===e.indexOf("use strict")){t=Z.createElement("script");t.text=e;Z.head.appendChild(t).parentNode.removeChild(t)}else o(e)},camelCase:function(e){return e.replace(te,"ms-").replace(oe,re)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,r){var i,n=0,a=e.length,l=o(e);if(r)if(l)for(;a>n;n++){i=t.apply(e[n],r);if(i===!1)break}else for(n in e){i=t.apply(e[n],r);if(i===!1)break}else if(l)for(;a>n;n++){i=t.call(e[n],n,e[n]);if(i===!1)break}else for(n in e){i=t.call(e[n],n,e[n]);if(i===!1)break}return e},trim:function(e){return null==e?"":(e+"").replace(ee,"")},makeArray:function(e,t){var r=t||[];null!=e&&(o(Object(e))?Q.merge(r,"string"==typeof e?[e]:e):V.call(r,e));return r},inArray:function(e,t,o){return null==t?-1:Y.call(t,e,o)},merge:function(e,t){for(var o=+t.length,r=0,i=e.length;o>r;r++)e[i++]=t[r];e.length=i;return e},grep:function(e,t,o){for(var r,i=[],n=0,a=e.length,l=!o;a>n;n++){r=!t(e[n],n);r!==l&&i.push(e[n])}return i},map:function(e,t,r){var i,n=0,a=e.length,l=o(e),s=[];if(l)for(;a>n;n++){i=t(e[n],n,r);null!=i&&s.push(i)}else for(n in e){i=t(e[n],n,r);null!=i&&s.push(i)}return W.apply([],s)},guid:1,proxy:function(e,t){var o,r,i;if("string"==typeof t){o=e[t];t=e;e=o}if(!Q.isFunction(e))return void 0;r=$.call(arguments,2);i=function(){return e.apply(t||this,r.concat($.call(arguments)))};i.guid=e.guid=e.guid||Q.guid++;return i},now:Date.now,support:z});Q.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){K["[object "+t+"]"]=t.toLowerCase()});var ie=function(e){function t(e,t,o,r){var i,n,a,l,s,p,u,d,h,f;(t?t.ownerDocument||t:B)!==I&&M(t);t=t||I;o=o||[];l=t.nodeType;if("string"!=typeof e||!e||1!==l&&9!==l&&11!==l)return o;if(!r&&N){if(11!==l&&(i=ve.exec(e)))if(a=i[1]){if(9===l){n=t.getElementById(a);if(!n||!n.parentNode)return o;if(n.id===a){o.push(n);return o}}else if(t.ownerDocument&&(n=t.ownerDocument.getElementById(a))&&G(t,n)&&n.id===a){o.push(n);return o}}else{if(i[2]){J.apply(o,t.getElementsByTagName(e));return o}if((a=i[3])&&_.getElementsByClassName){J.apply(o,t.getElementsByClassName(a));return o}}if(_.qsa&&(!D||!D.test(e))){d=u=U;h=t;f=1!==l&&e;if(1===l&&"object"!==t.nodeName.toLowerCase()){p=P(e);(u=t.getAttribute("id"))?d=u.replace(Te,"\\$&"):t.setAttribute("id",d);d="[id='"+d+"'] ";s=p.length;for(;s--;)p[s]=d+g(p[s]);h=Ce.test(e)&&c(t.parentNode)||t;f=p.join(",")}if(f)try{J.apply(o,h.querySelectorAll(f));return o}catch(y){}finally{u||t.removeAttribute("id")}}}return w(e.replace(se,"$1"),t,o,r)}function o(){function e(o,r){t.push(o+" ")>S.cacheLength&&delete e[t.shift()];return e[o+" "]=r}var t=[];return e}function r(e){e[U]=!0;return e}function i(e){var t=I.createElement("div");try{return!!e(t)}catch(o){return!1}finally{t.parentNode&&t.parentNode.removeChild(t);t=null}}function n(e,t){for(var o=e.split("|"),r=e.length;r--;)S.attrHandle[o[r]]=t}function a(e,t){var o=t&&e,r=o&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||K)-(~e.sourceIndex||K);if(r)return r;if(o)for(;o=o.nextSibling;)if(o===t)return-1;return e?1:-1}function l(e){return function(t){var o=t.nodeName.toLowerCase();return"input"===o&&t.type===e}}function s(e){return function(t){var o=t.nodeName.toLowerCase();return("input"===o||"button"===o)&&t.type===e}}function p(e){return r(function(t){t=+t;return r(function(o,r){for(var i,n=e([],o.length,t),a=n.length;a--;)o[i=n[a]]&&(o[i]=!(r[i]=o[i]))})})}function c(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function u(){}function g(e){for(var t=0,o=e.length,r="";o>t;t++)r+=e[t].value;return r}function d(e,t,o){var r=t.dir,i=o&&"parentNode"===r,n=j++;return t.first?function(t,o,n){for(;t=t[r];)if(1===t.nodeType||i)return e(t,o,n)}:function(t,o,a){var l,s,p=[q,n];if(a){for(;t=t[r];)if((1===t.nodeType||i)&&e(t,o,a))return!0}else for(;t=t[r];)if(1===t.nodeType||i){s=t[U]||(t[U]={});if((l=s[r])&&l[0]===q&&l[1]===n)return p[2]=l[2];s[r]=p;if(p[2]=e(t,o,a))return!0}}}function h(e){return e.length>1?function(t,o,r){for(var i=e.length;i--;)if(!e[i](t,o,r))return!1;return!0}:e[0]}function f(e,o,r){for(var i=0,n=o.length;n>i;i++)t(e,o[i],r);return r}function y(e,t,o,r,i){for(var n,a=[],l=0,s=e.length,p=null!=t;s>l;l++)if((n=e[l])&&(!o||o(n,r,i))){a.push(n);p&&t.push(l)}return a}function m(e,t,o,i,n,a){i&&!i[U]&&(i=m(i));n&&!n[U]&&(n=m(n,a));return r(function(r,a,l,s){var p,c,u,g=[],d=[],h=a.length,m=r||f(t||"*",l.nodeType?[l]:l,[]),v=!e||!r&&t?m:y(m,g,e,l,s),C=o?n||(r?e:h||i)?[]:a:v;o&&o(v,C,l,s);if(i){p=y(C,d);i(p,[],l,s);c=p.length;for(;c--;)(u=p[c])&&(C[d[c]]=!(v[d[c]]=u))}if(r){if(n||e){if(n){p=[];c=C.length;for(;c--;)(u=C[c])&&p.push(v[c]=u);n(null,C=[],p,s)}c=C.length;for(;c--;)(u=C[c])&&(p=n?ee(r,u):g[c])>-1&&(r[p]=!(a[p]=u))}}else{C=y(C===a?C.splice(h,C.length):C);n?n(null,a,C,s):J.apply(a,C)}})}function v(e){for(var t,o,r,i=e.length,n=S.relative[e[0].type],a=n||S.relative[" "],l=n?1:0,s=d(function(e){return e===t},a,!0),p=d(function(e){return ee(t,e)>-1},a,!0),c=[function(e,o,r){var i=!n&&(r||o!==R)||((t=o).nodeType?s(e,o,r):p(e,o,r));t=null;return i}];i>l;l++)if(o=S.relative[e[l].type])c=[d(h(c),o)];else{o=S.filter[e[l].type].apply(null,e[l].matches);if(o[U]){r=++l;for(;i>r&&!S.relative[e[r].type];r++);return m(l>1&&h(c),l>1&&g(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(se,"$1"),o,r>l&&v(e.slice(l,r)),i>r&&v(e=e.slice(r)),i>r&&g(e))}c.push(o)}return h(c)}function C(e,o){var i=o.length>0,n=e.length>0,a=function(r,a,l,s,p){var c,u,g,d=0,h="0",f=r&&[],m=[],v=R,C=r||n&&S.find.TAG("*",p),T=q+=null==v?1:Math.random()||.1,_=C.length;p&&(R=a!==I&&a);for(;h!==_&&null!=(c=C[h]);h++){if(n&&c){u=0;for(;g=e[u++];)if(g(c,a,l)){s.push(c);break}p&&(q=T)}if(i){(c=!g&&c)&&d--;r&&f.push(c)}}d+=h;if(i&&h!==d){u=0;for(;g=o[u++];)g(f,m,a,l);if(r){if(d>0)for(;h--;)f[h]||m[h]||(m[h]=z.call(s));m=y(m)}J.apply(s,m);p&&!r&&m.length>0&&d+o.length>1&&t.uniqueSort(s)}if(p){q=T;R=v}return f};return i?r(a):a}var T,_,S,E,x,P,L,w,R,A,b,M,I,O,N,D,F,k,G,U="sizzle"+1*new Date,B=e.document,q=0,j=0,$=o(),W=o(),V=o(),Y=function(e,t){e===t&&(b=!0);return 0},K=1<<31,X={}.hasOwnProperty,H=[],z=H.pop,Z=H.push,J=H.push,Q=H.slice,ee=function(e,t){for(var o=0,r=e.length;r>o;o++)if(e[o]===t)return o;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",oe="[\\x20\\t\\r\\n\\f]",re="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ie=re.replace("w","w#"),ne="\\["+oe+"*("+re+")(?:"+oe+"*([*^$|!~]?=)"+oe+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ie+"))|)"+oe+"*\\]",ae=":("+re+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ne+")*)|.*)\\)|)",le=new RegExp(oe+"+","g"),se=new RegExp("^"+oe+"+|((?:^|[^\\\\])(?:\\\\.)*)"+oe+"+$","g"),pe=new RegExp("^"+oe+"*,"+oe+"*"),ce=new RegExp("^"+oe+"*([>+~]|"+oe+")"+oe+"*"),ue=new RegExp("="+oe+"*([^\\]'\"]*?)"+oe+"*\\]","g"),ge=new RegExp(ae),de=new RegExp("^"+ie+"$"),he={ID:new RegExp("^#("+re+")"),CLASS:new RegExp("^\\.("+re+")"),TAG:new RegExp("^("+re.replace("w","w*")+")"),ATTR:new RegExp("^"+ne),PSEUDO:new RegExp("^"+ae),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+oe+"*(even|odd|(([+-]|)(\\d*)n|)"+oe+"*(?:([+-]|)"+oe+"*(\\d+)|))"+oe+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+oe+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+oe+"*((?:-\\d)?\\d*)"+oe+"*\\)|)(?=[^-]|$)","i")},fe=/^(?:input|select|textarea|button)$/i,ye=/^h\d$/i,me=/^[^{]+\{\s*\[native \w/,ve=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Ce=/[+~]/,Te=/'|\\/g,_e=new RegExp("\\\\([\\da-f]{1,6}"+oe+"?|("+oe+")|.)","ig"),Se=function(e,t,o){var r="0x"+t-65536;return r!==r||o?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},Ee=function(){M()};try{J.apply(H=Q.call(B.childNodes),B.childNodes);H[B.childNodes.length].nodeType}catch(xe){J={apply:H.length?function(e,t){Z.apply(e,Q.call(t))}:function(e,t){for(var o=e.length,r=0;e[o++]=t[r++];);e.length=o-1}}}_=t.support={};x=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1};M=t.setDocument=function(e){var t,o,r=e?e.ownerDocument||e:B;if(r===I||9!==r.nodeType||!r.documentElement)return I;I=r;O=r.documentElement;o=r.defaultView;o&&o!==o.top&&(o.addEventListener?o.addEventListener("unload",Ee,!1):o.attachEvent&&o.attachEvent("onunload",Ee));N=!x(r);_.attributes=i(function(e){e.className="i";return!e.getAttribute("className")});_.getElementsByTagName=i(function(e){e.appendChild(r.createComment(""));return!e.getElementsByTagName("*").length});_.getElementsByClassName=me.test(r.getElementsByClassName);_.getById=i(function(e){O.appendChild(e).id=U;return!r.getElementsByName||!r.getElementsByName(U).length});if(_.getById){S.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&N){var o=t.getElementById(e);return o&&o.parentNode?[o]:[]}};S.filter.ID=function(e){var t=e.replace(_e,Se);return function(e){return e.getAttribute("id")===t}}}else{delete S.find.ID;S.filter.ID=function(e){var t=e.replace(_e,Se);return function(e){var o="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return o&&o.value===t}}}S.find.TAG=_.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):_.qsa?t.querySelectorAll(e):void 0}:function(e,t){var o,r=[],i=0,n=t.getElementsByTagName(e);if("*"===e){for(;o=n[i++];)1===o.nodeType&&r.push(o);return r}return n};S.find.CLASS=_.getElementsByClassName&&function(e,t){return N?t.getElementsByClassName(e):void 0};F=[];D=[];if(_.qsa=me.test(r.querySelectorAll)){i(function(e){O.appendChild(e).innerHTML="<a id='"+U+"'></a><select id='"+U+"-\f]' msallowcapture=''><option selected=''></option></select>";e.querySelectorAll("[msallowcapture^='']").length&&D.push("[*^$]="+oe+"*(?:''|\"\")");e.querySelectorAll("[selected]").length||D.push("\\["+oe+"*(?:value|"+te+")");e.querySelectorAll("[id~="+U+"-]").length||D.push("~=");e.querySelectorAll(":checked").length||D.push(":checked");e.querySelectorAll("a#"+U+"+*").length||D.push(".#.+[+~]")});i(function(e){var t=r.createElement("input");t.setAttribute("type","hidden");e.appendChild(t).setAttribute("name","D");e.querySelectorAll("[name=d]").length&&D.push("name"+oe+"*[*^$|!~]?=");e.querySelectorAll(":enabled").length||D.push(":enabled",":disabled");e.querySelectorAll("*,:x");D.push(",.*:")})}(_.matchesSelector=me.test(k=O.matches||O.webkitMatchesSelector||O.mozMatchesSelector||O.oMatchesSelector||O.msMatchesSelector))&&i(function(e){_.disconnectedMatch=k.call(e,"div");k.call(e,"[s!='']:x");F.push("!=",ae)});D=D.length&&new RegExp(D.join("|"));F=F.length&&new RegExp(F.join("|"));t=me.test(O.compareDocumentPosition);G=t||me.test(O.contains)?function(e,t){var o=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(o.contains?o.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1};Y=t?function(e,t){if(e===t){b=!0;return 0}var o=!e.compareDocumentPosition-!t.compareDocumentPosition;if(o)return o;o=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1;return 1&o||!_.sortDetached&&t.compareDocumentPosition(e)===o?e===r||e.ownerDocument===B&&G(B,e)?-1:t===r||t.ownerDocument===B&&G(B,t)?1:A?ee(A,e)-ee(A,t):0:4&o?-1:1}:function(e,t){if(e===t){b=!0;return 0}var o,i=0,n=e.parentNode,l=t.parentNode,s=[e],p=[t];if(!n||!l)return e===r?-1:t===r?1:n?-1:l?1:A?ee(A,e)-ee(A,t):0;if(n===l)return a(e,t);o=e;for(;o=o.parentNode;)s.unshift(o);o=t;for(;o=o.parentNode;)p.unshift(o);for(;s[i]===p[i];)i++;return i?a(s[i],p[i]):s[i]===B?-1:p[i]===B?1:0};return r};t.matches=function(e,o){return t(e,null,null,o)};t.matchesSelector=function(e,o){(e.ownerDocument||e)!==I&&M(e);o=o.replace(ue,"='$1']");if(!(!_.matchesSelector||!N||F&&F.test(o)||D&&D.test(o)))try{var r=k.call(e,o);if(r||_.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(i){}
return t(o,I,null,[e]).length>0};t.contains=function(e,t){(e.ownerDocument||e)!==I&&M(e);return G(e,t)};t.attr=function(e,t){(e.ownerDocument||e)!==I&&M(e);var o=S.attrHandle[t.toLowerCase()],r=o&&X.call(S.attrHandle,t.toLowerCase())?o(e,t,!N):void 0;return void 0!==r?r:_.attributes||!N?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null};t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};t.uniqueSort=function(e){var t,o=[],r=0,i=0;b=!_.detectDuplicates;A=!_.sortStable&&e.slice(0);e.sort(Y);if(b){for(;t=e[i++];)t===e[i]&&(r=o.push(i));for(;r--;)e.splice(o[r],1)}A=null;return e};E=t.getText=function(e){var t,o="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)o+=E(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)o+=E(t);return o};S=t.selectors={cacheLength:50,createPseudo:r,match:he,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[1]=e[1].replace(_e,Se);e[3]=(e[3]||e[4]||e[5]||"").replace(_e,Se);"~="===e[2]&&(e[3]=" "+e[3]+" ");return e.slice(0,4)},CHILD:function(e){e[1]=e[1].toLowerCase();if("nth"===e[1].slice(0,3)){e[3]||t.error(e[0]);e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3]));e[5]=+(e[7]+e[8]||"odd"===e[3])}else e[3]&&t.error(e[0]);return e},PSEUDO:function(e){var t,o=!e[6]&&e[2];if(he.CHILD.test(e[0]))return null;if(e[3])e[2]=e[4]||e[5]||"";else if(o&&ge.test(o)&&(t=P(o,!0))&&(t=o.indexOf(")",o.length-t)-o.length)){e[0]=e[0].slice(0,t);e[2]=o.slice(0,t)}return e.slice(0,3)}},filter:{TAG:function(e){var t=e.replace(_e,Se).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=$[e+" "];return t||(t=new RegExp("(^|"+oe+")"+e+"("+oe+"|$)"))&&$(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,o,r){return function(i){var n=t.attr(i,e);if(null==n)return"!="===o;if(!o)return!0;n+="";return"="===o?n===r:"!="===o?n!==r:"^="===o?r&&0===n.indexOf(r):"*="===o?r&&n.indexOf(r)>-1:"$="===o?r&&n.slice(-r.length)===r:"~="===o?(" "+n.replace(le," ")+" ").indexOf(r)>-1:"|="===o?n===r||n.slice(0,r.length+1)===r+"-":!1}},CHILD:function(e,t,o,r,i){var n="nth"!==e.slice(0,3),a="last"!==e.slice(-4),l="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,o,s){var p,c,u,g,d,h,f=n!==a?"nextSibling":"previousSibling",y=t.parentNode,m=l&&t.nodeName.toLowerCase(),v=!s&&!l;if(y){if(n){for(;f;){u=t;for(;u=u[f];)if(l?u.nodeName.toLowerCase()===m:1===u.nodeType)return!1;h=f="only"===e&&!h&&"nextSibling"}return!0}h=[a?y.firstChild:y.lastChild];if(a&&v){c=y[U]||(y[U]={});p=c[e]||[];d=p[0]===q&&p[1];g=p[0]===q&&p[2];u=d&&y.childNodes[d];for(;u=++d&&u&&u[f]||(g=d=0)||h.pop();)if(1===u.nodeType&&++g&&u===t){c[e]=[q,d,g];break}}else if(v&&(p=(t[U]||(t[U]={}))[e])&&p[0]===q)g=p[1];else for(;u=++d&&u&&u[f]||(g=d=0)||h.pop();)if((l?u.nodeName.toLowerCase()===m:1===u.nodeType)&&++g){v&&((u[U]||(u[U]={}))[e]=[q,g]);if(u===t)break}g-=i;return g===r||g%r===0&&g/r>=0}}},PSEUDO:function(e,o){var i,n=S.pseudos[e]||S.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);if(n[U])return n(o);if(n.length>1){i=[e,e,"",o];return S.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,t){for(var r,i=n(e,o),a=i.length;a--;){r=ee(e,i[a]);e[r]=!(t[r]=i[a])}}):function(e){return n(e,0,i)}}return n}},pseudos:{not:r(function(e){var t=[],o=[],i=L(e.replace(se,"$1"));return i[U]?r(function(e,t,o,r){for(var n,a=i(e,null,r,[]),l=e.length;l--;)(n=a[l])&&(e[l]=!(t[l]=n))}):function(e,r,n){t[0]=e;i(t,null,n,o);t[0]=null;return!o.pop()}}),has:r(function(e){return function(o){return t(e,o).length>0}}),contains:r(function(e){e=e.replace(_e,Se);return function(t){return(t.textContent||t.innerText||E(t)).indexOf(e)>-1}}),lang:r(function(e){de.test(e||"")||t.error("unsupported lang: "+e);e=e.replace(_e,Se).toLowerCase();return function(t){var o;do if(o=N?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang")){o=o.toLowerCase();return o===e||0===o.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var o=e.location&&e.location.hash;return o&&o.slice(1)===t.id},root:function(e){return e===O},focus:function(e){return e===I.activeElement&&(!I.hasFocus||I.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){e.parentNode&&e.parentNode.selectedIndex;return e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!S.pseudos.empty(e)},header:function(e){return ye.test(e.nodeName)},input:function(e){return fe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:p(function(){return[0]}),last:p(function(e,t){return[t-1]}),eq:p(function(e,t,o){return[0>o?o+t:o]}),even:p(function(e,t){for(var o=0;t>o;o+=2)e.push(o);return e}),odd:p(function(e,t){for(var o=1;t>o;o+=2)e.push(o);return e}),lt:p(function(e,t,o){for(var r=0>o?o+t:o;--r>=0;)e.push(r);return e}),gt:p(function(e,t,o){for(var r=0>o?o+t:o;++r<t;)e.push(r);return e})}};S.pseudos.nth=S.pseudos.eq;for(T in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})S.pseudos[T]=l(T);for(T in{submit:!0,reset:!0})S.pseudos[T]=s(T);u.prototype=S.filters=S.pseudos;S.setFilters=new u;P=t.tokenize=function(e,o){var r,i,n,a,l,s,p,c=W[e+" "];if(c)return o?0:c.slice(0);l=e;s=[];p=S.preFilter;for(;l;){if(!r||(i=pe.exec(l))){i&&(l=l.slice(i[0].length)||l);s.push(n=[])}r=!1;if(i=ce.exec(l)){r=i.shift();n.push({value:r,type:i[0].replace(se," ")});l=l.slice(r.length)}for(a in S.filter)if((i=he[a].exec(l))&&(!p[a]||(i=p[a](i)))){r=i.shift();n.push({value:r,type:a,matches:i});l=l.slice(r.length)}if(!r)break}return o?l.length:l?t.error(e):W(e,s).slice(0)};L=t.compile=function(e,t){var o,r=[],i=[],n=V[e+" "];if(!n){t||(t=P(e));o=t.length;for(;o--;){n=v(t[o]);n[U]?r.push(n):i.push(n)}n=V(e,C(i,r));n.selector=e}return n};w=t.select=function(e,t,o,r){var i,n,a,l,s,p="function"==typeof e&&e,u=!r&&P(e=p.selector||e);o=o||[];if(1===u.length){n=u[0]=u[0].slice(0);if(n.length>2&&"ID"===(a=n[0]).type&&_.getById&&9===t.nodeType&&N&&S.relative[n[1].type]){t=(S.find.ID(a.matches[0].replace(_e,Se),t)||[])[0];if(!t)return o;p&&(t=t.parentNode);e=e.slice(n.shift().value.length)}i=he.needsContext.test(e)?0:n.length;for(;i--;){a=n[i];if(S.relative[l=a.type])break;if((s=S.find[l])&&(r=s(a.matches[0].replace(_e,Se),Ce.test(n[0].type)&&c(t.parentNode)||t))){n.splice(i,1);e=r.length&&g(n);if(!e){J.apply(o,r);return o}break}}}(p||L(e,u))(r,t,!N,o,Ce.test(e)&&c(t.parentNode)||t);return o};_.sortStable=U.split("").sort(Y).join("")===U;_.detectDuplicates=!!b;M();_.sortDetached=i(function(e){return 1&e.compareDocumentPosition(I.createElement("div"))});i(function(e){e.innerHTML="<a href='#'></a>";return"#"===e.firstChild.getAttribute("href")})||n("type|href|height|width",function(e,t,o){return o?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)});_.attributes&&i(function(e){e.innerHTML="<input/>";e.firstChild.setAttribute("value","");return""===e.firstChild.getAttribute("value")})||n("value",function(e,t,o){return o||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue});i(function(e){return null==e.getAttribute("disabled")})||n(te,function(e,t,o){var r;return o?void 0:e[t]===!0?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null});return t}(e);Q.find=ie;Q.expr=ie.selectors;Q.expr[":"]=Q.expr.pseudos;Q.unique=ie.uniqueSort;Q.text=ie.getText;Q.isXMLDoc=ie.isXML;Q.contains=ie.contains;var ne=Q.expr.match.needsContext,ae=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,le=/^.[^:#\[\.,]*$/;Q.filter=function(e,t,o){var r=t[0];o&&(e=":not("+e+")");return 1===t.length&&1===r.nodeType?Q.find.matchesSelector(r,e)?[r]:[]:Q.find.matches(e,Q.grep(t,function(e){return 1===e.nodeType}))};Q.fn.extend({find:function(e){var t,o=this.length,r=[],i=this;if("string"!=typeof e)return this.pushStack(Q(e).filter(function(){for(t=0;o>t;t++)if(Q.contains(i[t],this))return!0}));for(t=0;o>t;t++)Q.find(e,i[t],r);r=this.pushStack(o>1?Q.unique(r):r);r.selector=this.selector?this.selector+" "+e:e;return r},filter:function(e){return this.pushStack(r(this,e||[],!1))},not:function(e){return this.pushStack(r(this,e||[],!0))},is:function(e){return!!r(this,"string"==typeof e&&ne.test(e)?Q(e):e||[],!1).length}});var se,pe=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ce=Q.fn.init=function(e,t){var o,r;if(!e)return this;if("string"==typeof e){o="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:pe.exec(e);if(!o||!o[1]&&t)return!t||t.jquery?(t||se).find(e):this.constructor(t).find(e);if(o[1]){t=t instanceof Q?t[0]:t;Q.merge(this,Q.parseHTML(o[1],t&&t.nodeType?t.ownerDocument||t:Z,!0));if(ae.test(o[1])&&Q.isPlainObject(t))for(o in t)Q.isFunction(this[o])?this[o](t[o]):this.attr(o,t[o]);return this}r=Z.getElementById(o[2]);if(r&&r.parentNode){this.length=1;this[0]=r}this.context=Z;this.selector=e;return this}if(e.nodeType){this.context=this[0]=e;this.length=1;return this}if(Q.isFunction(e))return"undefined"!=typeof se.ready?se.ready(e):e(Q);if(void 0!==e.selector){this.selector=e.selector;this.context=e.context}return Q.makeArray(e,this)};ce.prototype=Q.fn;se=Q(Z);var ue=/^(?:parents|prev(?:Until|All))/,ge={children:!0,contents:!0,next:!0,prev:!0};Q.extend({dir:function(e,t,o){for(var r=[],i=void 0!==o;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&Q(e).is(o))break;r.push(e)}return r},sibling:function(e,t){for(var o=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&o.push(e);return o}});Q.fn.extend({has:function(e){var t=Q(e,this),o=t.length;return this.filter(function(){for(var e=0;o>e;e++)if(Q.contains(this,t[e]))return!0})},closest:function(e,t){for(var o,r=0,i=this.length,n=[],a=ne.test(e)||"string"!=typeof e?Q(e,t||this.context):0;i>r;r++)for(o=this[r];o&&o!==t;o=o.parentNode)if(o.nodeType<11&&(a?a.index(o)>-1:1===o.nodeType&&Q.find.matchesSelector(o,e))){n.push(o);break}return this.pushStack(n.length>1?Q.unique(n):n)},index:function(e){return e?"string"==typeof e?Y.call(Q(e),this[0]):Y.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(Q.unique(Q.merge(this.get(),Q(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});Q.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Q.dir(e,"parentNode")},parentsUntil:function(e,t,o){return Q.dir(e,"parentNode",o)},next:function(e){return i(e,"nextSibling")},prev:function(e){return i(e,"previousSibling")},nextAll:function(e){return Q.dir(e,"nextSibling")},prevAll:function(e){return Q.dir(e,"previousSibling")},nextUntil:function(e,t,o){return Q.dir(e,"nextSibling",o)},prevUntil:function(e,t,o){return Q.dir(e,"previousSibling",o)},siblings:function(e){return Q.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Q.sibling(e.firstChild)},contents:function(e){return e.contentDocument||Q.merge([],e.childNodes)}},function(e,t){Q.fn[e]=function(o,r){var i=Q.map(this,t,o);"Until"!==e.slice(-5)&&(r=o);r&&"string"==typeof r&&(i=Q.filter(r,i));if(this.length>1){ge[e]||Q.unique(i);ue.test(e)&&i.reverse()}return this.pushStack(i)}});var de=/\S+/g,he={};Q.Callbacks=function(e){e="string"==typeof e?he[e]||n(e):Q.extend({},e);var t,o,r,i,a,l,s=[],p=!e.once&&[],c=function(n){t=e.memory&&n;o=!0;l=i||0;i=0;a=s.length;r=!0;for(;s&&a>l;l++)if(s[l].apply(n[0],n[1])===!1&&e.stopOnFalse){t=!1;break}r=!1;s&&(p?p.length&&c(p.shift()):t?s=[]:u.disable())},u={add:function(){if(s){var o=s.length;!function n(t){Q.each(t,function(t,o){var r=Q.type(o);"function"===r?e.unique&&u.has(o)||s.push(o):o&&o.length&&"string"!==r&&n(o)})}(arguments);if(r)a=s.length;else if(t){i=o;c(t)}}return this},remove:function(){s&&Q.each(arguments,function(e,t){for(var o;(o=Q.inArray(t,s,o))>-1;){s.splice(o,1);if(r){a>=o&&a--;l>=o&&l--}}});return this},has:function(e){return e?Q.inArray(e,s)>-1:!(!s||!s.length)},empty:function(){s=[];a=0;return this},disable:function(){s=p=t=void 0;return this},disabled:function(){return!s},lock:function(){p=void 0;t||u.disable();return this},locked:function(){return!p},fireWith:function(e,t){if(s&&(!o||p)){t=t||[];t=[e,t.slice?t.slice():t];r?p.push(t):c(t)}return this},fire:function(){u.fireWith(this,arguments);return this},fired:function(){return!!o}};return u};Q.extend({Deferred:function(e){var t=[["resolve","done",Q.Callbacks("once memory"),"resolved"],["reject","fail",Q.Callbacks("once memory"),"rejected"],["notify","progress",Q.Callbacks("memory")]],o="pending",r={state:function(){return o},always:function(){i.done(arguments).fail(arguments);return this},then:function(){var e=arguments;return Q.Deferred(function(o){Q.each(t,function(t,n){var a=Q.isFunction(e[t])&&e[t];i[n[1]](function(){var e=a&&a.apply(this,arguments);e&&Q.isFunction(e.promise)?e.promise().done(o.resolve).fail(o.reject).progress(o.notify):o[n[0]+"With"](this===r?o.promise():this,a?[e]:arguments)})});e=null}).promise()},promise:function(e){return null!=e?Q.extend(e,r):r}},i={};r.pipe=r.then;Q.each(t,function(e,n){var a=n[2],l=n[3];r[n[1]]=a.add;l&&a.add(function(){o=l},t[1^e][2].disable,t[2][2].lock);i[n[0]]=function(){i[n[0]+"With"](this===i?r:this,arguments);return this};i[n[0]+"With"]=a.fireWith});r.promise(i);e&&e.call(i,i);return i},when:function(e){var t,o,r,i=0,n=$.call(arguments),a=n.length,l=1!==a||e&&Q.isFunction(e.promise)?a:0,s=1===l?e:Q.Deferred(),p=function(e,o,r){return function(i){o[e]=this;r[e]=arguments.length>1?$.call(arguments):i;r===t?s.notifyWith(o,r):--l||s.resolveWith(o,r)}};if(a>1){t=new Array(a);o=new Array(a);r=new Array(a);for(;a>i;i++)n[i]&&Q.isFunction(n[i].promise)?n[i].promise().done(p(i,r,n)).fail(s.reject).progress(p(i,o,t)):--l}l||s.resolveWith(r,n);return s.promise()}});var fe;Q.fn.ready=function(e){Q.ready.promise().done(e);return this};Q.extend({isReady:!1,readyWait:1,holdReady:function(e){e?Q.readyWait++:Q.ready(!0)},ready:function(e){if(e===!0?!--Q.readyWait:!Q.isReady){Q.isReady=!0;if(!(e!==!0&&--Q.readyWait>0)){fe.resolveWith(Z,[Q]);if(Q.fn.triggerHandler){Q(Z).triggerHandler("ready");Q(Z).off("ready")}}}}});Q.ready.promise=function(t){if(!fe){fe=Q.Deferred();if("complete"===Z.readyState)setTimeout(Q.ready);else{Z.addEventListener("DOMContentLoaded",a,!1);e.addEventListener("load",a,!1)}}return fe.promise(t)};Q.ready.promise();var ye=Q.access=function(e,t,o,r,i,n,a){var l=0,s=e.length,p=null==o;if("object"===Q.type(o)){i=!0;for(l in o)Q.access(e,t,l,o[l],!0,n,a)}else if(void 0!==r){i=!0;Q.isFunction(r)||(a=!0);if(p)if(a){t.call(e,r);t=null}else{p=t;t=function(e,t,o){return p.call(Q(e),o)}}if(t)for(;s>l;l++)t(e[l],o,a?r:r.call(e[l],l,t(e[l],o)))}return i?e:p?t.call(e):s?t(e[0],o):n};Q.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};l.uid=1;l.accepts=Q.acceptData;l.prototype={key:function(e){if(!l.accepts(e))return 0;var t={},o=e[this.expando];if(!o){o=l.uid++;try{t[this.expando]={value:o};Object.defineProperties(e,t)}catch(r){t[this.expando]=o;Q.extend(e,t)}}this.cache[o]||(this.cache[o]={});return o},set:function(e,t,o){var r,i=this.key(e),n=this.cache[i];if("string"==typeof t)n[t]=o;else if(Q.isEmptyObject(n))Q.extend(this.cache[i],t);else for(r in t)n[r]=t[r];return n},get:function(e,t){var o=this.cache[this.key(e)];return void 0===t?o:o[t]},access:function(e,t,o){var r;if(void 0===t||t&&"string"==typeof t&&void 0===o){r=this.get(e,t);return void 0!==r?r:this.get(e,Q.camelCase(t))}this.set(e,t,o);return void 0!==o?o:t},remove:function(e,t){var o,r,i,n=this.key(e),a=this.cache[n];if(void 0===t)this.cache[n]={};else{if(Q.isArray(t))r=t.concat(t.map(Q.camelCase));else{i=Q.camelCase(t);if(t in a)r=[t,i];else{r=i;r=r in a?[r]:r.match(de)||[]}}o=r.length;for(;o--;)delete a[r[o]]}},hasData:function(e){return!Q.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var me=new l,ve=new l,Ce=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Te=/([A-Z])/g;Q.extend({hasData:function(e){return ve.hasData(e)||me.hasData(e)},data:function(e,t,o){return ve.access(e,t,o)},removeData:function(e,t){ve.remove(e,t)},_data:function(e,t,o){return me.access(e,t,o)},_removeData:function(e,t){me.remove(e,t)}});Q.fn.extend({data:function(e,t){var o,r,i,n=this[0],a=n&&n.attributes;if(void 0===e){if(this.length){i=ve.get(n);if(1===n.nodeType&&!me.get(n,"hasDataAttrs")){o=a.length;for(;o--;)if(a[o]){r=a[o].name;if(0===r.indexOf("data-")){r=Q.camelCase(r.slice(5));s(n,r,i[r])}}me.set(n,"hasDataAttrs",!0)}}return i}return"object"==typeof e?this.each(function(){ve.set(this,e)}):ye(this,function(t){var o,r=Q.camelCase(e);if(n&&void 0===t){o=ve.get(n,e);if(void 0!==o)return o;o=ve.get(n,r);if(void 0!==o)return o;o=s(n,r,void 0);if(void 0!==o)return o}else this.each(function(){var o=ve.get(this,r);ve.set(this,r,t);-1!==e.indexOf("-")&&void 0!==o&&ve.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){ve.remove(this,e)})}});Q.extend({queue:function(e,t,o){var r;if(e){t=(t||"fx")+"queue";r=me.get(e,t);o&&(!r||Q.isArray(o)?r=me.access(e,t,Q.makeArray(o)):r.push(o));return r||[]}},dequeue:function(e,t){t=t||"fx";var o=Q.queue(e,t),r=o.length,i=o.shift(),n=Q._queueHooks(e,t),a=function(){Q.dequeue(e,t)};if("inprogress"===i){i=o.shift();r--}if(i){"fx"===t&&o.unshift("inprogress");delete n.stop;i.call(e,a,n)}!r&&n&&n.empty.fire()},_queueHooks:function(e,t){var o=t+"queueHooks";return me.get(e,o)||me.access(e,o,{empty:Q.Callbacks("once memory").add(function(){me.remove(e,[t+"queue",o])})})}});Q.fn.extend({queue:function(e,t){var o=2;if("string"!=typeof e){t=e;e="fx";o--}return arguments.length<o?Q.queue(this[0],e):void 0===t?this:this.each(function(){var o=Q.queue(this,e,t);Q._queueHooks(this,e);"fx"===e&&"inprogress"!==o[0]&&Q.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Q.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var o,r=1,i=Q.Deferred(),n=this,a=this.length,l=function(){--r||i.resolveWith(n,[n])};if("string"!=typeof e){t=e;e=void 0}e=e||"fx";for(;a--;){o=me.get(n[a],e+"queueHooks");if(o&&o.empty){r++;o.empty.add(l)}}l();return i.promise(t)}});var _e=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Se=["Top","Right","Bottom","Left"],Ee=function(e,t){e=t||e;return"none"===Q.css(e,"display")||!Q.contains(e.ownerDocument,e)},xe=/^(?:checkbox|radio)$/i;!function(){var e=Z.createDocumentFragment(),t=e.appendChild(Z.createElement("div")),o=Z.createElement("input");o.setAttribute("type","radio");o.setAttribute("checked","checked");o.setAttribute("name","t");t.appendChild(o);z.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked;t.innerHTML="<textarea>x</textarea>";z.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var Pe="undefined";z.focusinBubbles="onfocusin"in e;var Le=/^key/,we=/^(?:mouse|pointer|contextmenu)|click/,Re=/^(?:focusinfocus|focusoutblur)$/,Ae=/^([^.]*)(?:\.(.+)|)$/;Q.event={global:{},add:function(e,t,o,r,i){var n,a,l,s,p,c,u,g,d,h,f,y=me.get(e);if(y){if(o.handler){n=o;o=n.handler;i=n.selector}o.guid||(o.guid=Q.guid++);(s=y.events)||(s=y.events={});(a=y.handle)||(a=y.handle=function(t){return typeof Q!==Pe&&Q.event.triggered!==t.type?Q.event.dispatch.apply(e,arguments):void 0});t=(t||"").match(de)||[""];p=t.length;for(;p--;){l=Ae.exec(t[p])||[];d=f=l[1];h=(l[2]||"").split(".").sort();if(d){u=Q.event.special[d]||{};d=(i?u.delegateType:u.bindType)||d;u=Q.event.special[d]||{};c=Q.extend({type:d,origType:f,data:r,handler:o,guid:o.guid,selector:i,needsContext:i&&Q.expr.match.needsContext.test(i),namespace:h.join(".")},n);if(!(g=s[d])){g=s[d]=[];g.delegateCount=0;u.setup&&u.setup.call(e,r,h,a)!==!1||e.addEventListener&&e.addEventListener(d,a,!1)}if(u.add){u.add.call(e,c);c.handler.guid||(c.handler.guid=o.guid)}i?g.splice(g.delegateCount++,0,c):g.push(c);Q.event.global[d]=!0}}}},remove:function(e,t,o,r,i){var n,a,l,s,p,c,u,g,d,h,f,y=me.hasData(e)&&me.get(e);if(y&&(s=y.events)){t=(t||"").match(de)||[""];p=t.length;for(;p--;){l=Ae.exec(t[p])||[];d=f=l[1];h=(l[2]||"").split(".").sort();if(d){u=Q.event.special[d]||{};d=(r?u.delegateType:u.bindType)||d;g=s[d]||[];l=l[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)");a=n=g.length;for(;n--;){c=g[n];if(!(!i&&f!==c.origType||o&&o.guid!==c.guid||l&&!l.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector))){g.splice(n,1);c.selector&&g.delegateCount--;u.remove&&u.remove.call(e,c)}}if(a&&!g.length){u.teardown&&u.teardown.call(e,h,y.handle)!==!1||Q.removeEvent(e,d,y.handle);delete s[d]}}else for(d in s)Q.event.remove(e,d+t[p],o,r,!0)}if(Q.isEmptyObject(s)){delete y.handle;me.remove(e,"events")}}},trigger:function(t,o,r,i){var n,a,l,s,p,c,u,g=[r||Z],d=H.call(t,"type")?t.type:t,h=H.call(t,"namespace")?t.namespace.split("."):[];a=l=r=r||Z;if(3!==r.nodeType&&8!==r.nodeType&&!Re.test(d+Q.event.triggered)){if(d.indexOf(".")>=0){h=d.split(".");d=h.shift();h.sort()}p=d.indexOf(":")<0&&"on"+d;t=t[Q.expando]?t:new Q.Event(d,"object"==typeof t&&t);t.isTrigger=i?2:3;t.namespace=h.join(".");t.namespace_re=t.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;t.result=void 0;t.target||(t.target=r);o=null==o?[t]:Q.makeArray(o,[t]);u=Q.event.special[d]||{};if(i||!u.trigger||u.trigger.apply(r,o)!==!1){if(!i&&!u.noBubble&&!Q.isWindow(r)){s=u.delegateType||d;Re.test(s+d)||(a=a.parentNode);for(;a;a=a.parentNode){g.push(a);l=a}l===(r.ownerDocument||Z)&&g.push(l.defaultView||l.parentWindow||e)}n=0;for(;(a=g[n++])&&!t.isPropagationStopped();){t.type=n>1?s:u.bindType||d;c=(me.get(a,"events")||{})[t.type]&&me.get(a,"handle");c&&c.apply(a,o);c=p&&a[p];if(c&&c.apply&&Q.acceptData(a)){t.result=c.apply(a,o);t.result===!1&&t.preventDefault()}}t.type=d;if(!i&&!t.isDefaultPrevented()&&(!u._default||u._default.apply(g.pop(),o)===!1)&&Q.acceptData(r)&&p&&Q.isFunction(r[d])&&!Q.isWindow(r)){l=r[p];l&&(r[p]=null);Q.event.triggered=d;r[d]();Q.event.triggered=void 0;l&&(r[p]=l)}return t.result}}},dispatch:function(e){e=Q.event.fix(e);var t,o,r,i,n,a=[],l=$.call(arguments),s=(me.get(this,"events")||{})[e.type]||[],p=Q.event.special[e.type]||{};l[0]=e;e.delegateTarget=this;if(!p.preDispatch||p.preDispatch.call(this,e)!==!1){a=Q.event.handlers.call(this,e,s);t=0;for(;(i=a[t++])&&!e.isPropagationStopped();){e.currentTarget=i.elem;o=0;for(;(n=i.handlers[o++])&&!e.isImmediatePropagationStopped();)if(!e.namespace_re||e.namespace_re.test(n.namespace)){e.handleObj=n;e.data=n.data;r=((Q.event.special[n.origType]||{}).handle||n.handler).apply(i.elem,l);if(void 0!==r&&(e.result=r)===!1){e.preventDefault();e.stopPropagation()}}}p.postDispatch&&p.postDispatch.call(this,e);return e.result}},handlers:function(e,t){var o,r,i,n,a=[],l=t.delegateCount,s=e.target;if(l&&s.nodeType&&(!e.button||"click"!==e.type))for(;s!==this;s=s.parentNode||this)if(s.disabled!==!0||"click"!==e.type){r=[];for(o=0;l>o;o++){n=t[o];i=n.selector+" ";void 0===r[i]&&(r[i]=n.needsContext?Q(i,this).index(s)>=0:Q.find(i,this,null,[s]).length);r[i]&&r.push(n)}r.length&&a.push({elem:s,handlers:r})}l<t.length&&a.push({elem:this,handlers:t.slice(l)});return a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode);return e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var o,r,i,n=t.button;if(null==e.pageX&&null!=t.clientX){o=e.target.ownerDocument||Z;r=o.documentElement;i=o.body;e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0);e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)}e.which||void 0===n||(e.which=1&n?1:2&n?3:4&n?2:0);return e}},fix:function(e){if(e[Q.expando])return e;var t,o,r,i=e.type,n=e,a=this.fixHooks[i];a||(this.fixHooks[i]=a=we.test(i)?this.mouseHooks:Le.test(i)?this.keyHooks:{});r=a.props?this.props.concat(a.props):this.props;e=new Q.Event(n);t=r.length;for(;t--;){o=r[t];e[o]=n[o]}e.target||(e.target=Z);3===e.target.nodeType&&(e.target=e.target.parentNode);return a.filter?a.filter(e,n):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==u()&&this.focus){this.focus();return!1}},delegateType:"focusin"},blur:{trigger:function(){if(this===u()&&this.blur){this.blur();return!1}},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&Q.nodeName(this,"input")){this.click();return!1}},_default:function(e){return Q.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,o,r){var i=Q.extend(new Q.Event,o,{type:e,isSimulated:!0,originalEvent:{}});r?Q.event.trigger(i,null,t):Q.event.dispatch.call(t,i);i.isDefaultPrevented()&&o.preventDefault()}};Q.removeEvent=function(e,t,o){e.removeEventListener&&e.removeEventListener(t,o,!1)};Q.Event=function(e,t){if(!(this instanceof Q.Event))return new Q.Event(e,t);if(e&&e.type){this.originalEvent=e;this.type=e.type;this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?p:c}else this.type=e;t&&Q.extend(this,t);this.timeStamp=e&&e.timeStamp||Q.now();this[Q.expando]=!0};Q.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=p;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=p;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=p;e&&e.stopImmediatePropagation&&e.stopImmediatePropagation();this.stopPropagation()}};Q.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){Q.event.special[e]={delegateType:t,bindType:t,handle:function(e){var o,r=this,i=e.relatedTarget,n=e.handleObj;if(!i||i!==r&&!Q.contains(r,i)){e.type=n.origType;o=n.handler.apply(this,arguments);e.type=t}return o}}});z.focusinBubbles||Q.each({focus:"focusin",blur:"focusout"},function(e,t){var o=function(e){Q.event.simulate(t,e.target,Q.event.fix(e),!0)};Q.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=me.access(r,t);i||r.addEventListener(e,o,!0);me.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=me.access(r,t)-1;if(i)me.access(r,t,i);else{r.removeEventListener(e,o,!0);me.remove(r,t)}}}});Q.fn.extend({on:function(e,t,o,r,i){var n,a;if("object"==typeof e){if("string"!=typeof t){o=o||t;t=void 0}for(a in e)this.on(a,t,o,e[a],i);return this}if(null==o&&null==r){r=t;o=t=void 0}else if(null==r)if("string"==typeof t){r=o;o=void 0}else{r=o;o=t;t=void 0}if(r===!1)r=c;else if(!r)return this;if(1===i){n=r;r=function(e){Q().off(e);return n.apply(this,arguments)};r.guid=n.guid||(n.guid=Q.guid++)}return this.each(function(){Q.event.add(this,e,r,o,t)})},one:function(e,t,o,r){return this.on(e,t,o,r,1)},off:function(e,t,o){var r,i;if(e&&e.preventDefault&&e.handleObj){r=e.handleObj;Q(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler);return this}if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}if(t===!1||"function"==typeof t){o=t;t=void 0}o===!1&&(o=c);return this.each(function(){Q.event.remove(this,e,o,t)})},trigger:function(e,t){return this.each(function(){Q.event.trigger(e,t,this)})},triggerHandler:function(e,t){var o=this[0];return o?Q.event.trigger(e,t,o,!0):void 0}});var be=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Me=/<([\w:]+)/,Ie=/<|&#?\w+;/,Oe=/<(?:script|style|link)/i,Ne=/checked\s*(?:[^=]|=\s*.checked.)/i,De=/^$|\/(?:java|ecma)script/i,Fe=/^true\/(.*)/,ke=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ge={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ge.optgroup=Ge.option;Ge.tbody=Ge.tfoot=Ge.colgroup=Ge.caption=Ge.thead;Ge.th=Ge.td;Q.extend({clone:function(e,t,o){var r,i,n,a,l=e.cloneNode(!0),s=Q.contains(e.ownerDocument,e);if(!(z.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Q.isXMLDoc(e))){a=m(l);n=m(e);for(r=0,i=n.length;i>r;r++)v(n[r],a[r])}if(t)if(o){n=n||m(e);a=a||m(l);for(r=0,i=n.length;i>r;r++)y(n[r],a[r])}else y(e,l);a=m(l,"script");a.length>0&&f(a,!s&&m(e,"script"));return l},buildFragment:function(e,t,o,r){for(var i,n,a,l,s,p,c=t.createDocumentFragment(),u=[],g=0,d=e.length;d>g;g++){i=e[g];if(i||0===i)if("object"===Q.type(i))Q.merge(u,i.nodeType?[i]:i);else if(Ie.test(i)){n=n||c.appendChild(t.createElement("div"));a=(Me.exec(i)||["",""])[1].toLowerCase();l=Ge[a]||Ge._default;n.innerHTML=l[1]+i.replace(be,"<$1></$2>")+l[2];p=l[0];for(;p--;)n=n.lastChild;Q.merge(u,n.childNodes);n=c.firstChild;n.textContent=""}else u.push(t.createTextNode(i))}c.textContent="";g=0;for(;i=u[g++];)if(!r||-1===Q.inArray(i,r)){s=Q.contains(i.ownerDocument,i);n=m(c.appendChild(i),"script");s&&f(n);if(o){p=0;for(;i=n[p++];)De.test(i.type||"")&&o.push(i)}}return c},cleanData:function(e){for(var t,o,r,i,n=Q.event.special,a=0;void 0!==(o=e[a]);a++){if(Q.acceptData(o)){i=o[me.expando];if(i&&(t=me.cache[i])){if(t.events)for(r in t.events)n[r]?Q.event.remove(o,r):Q.removeEvent(o,r,t.handle);me.cache[i]&&delete me.cache[i]}}delete ve.cache[o[ve.expando]]}}});Q.fn.extend({text:function(e){return ye(this,function(e){return void 0===e?Q.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=g(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=g(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var o,r=e?Q.filter(e,this):this,i=0;null!=(o=r[i]);i++){t||1!==o.nodeType||Q.cleanData(m(o));if(o.parentNode){t&&Q.contains(o.ownerDocument,o)&&f(m(o,"script"));o.parentNode.removeChild(o)}}return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)if(1===e.nodeType){Q.cleanData(m(e,!1));e.textContent=""}return this},clone:function(e,t){e=null==e?!1:e;t=null==t?e:t;return this.map(function(){return Q.clone(this,e,t)})},html:function(e){return ye(this,function(e){var t=this[0]||{},o=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Oe.test(e)&&!Ge[(Me.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(be,"<$1></$2>");try{for(;r>o;o++){t=this[o]||{};if(1===t.nodeType){Q.cleanData(m(t,!1));t.innerHTML=e}}t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];this.domManip(arguments,function(t){
e=this.parentNode;Q.cleanData(m(this));e&&e.replaceChild(t,this)});return e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=W.apply([],e);var o,r,i,n,a,l,s=0,p=this.length,c=this,u=p-1,g=e[0],f=Q.isFunction(g);if(f||p>1&&"string"==typeof g&&!z.checkClone&&Ne.test(g))return this.each(function(o){var r=c.eq(o);f&&(e[0]=g.call(this,o,r.html()));r.domManip(e,t)});if(p){o=Q.buildFragment(e,this[0].ownerDocument,!1,this);r=o.firstChild;1===o.childNodes.length&&(o=r);if(r){i=Q.map(m(o,"script"),d);n=i.length;for(;p>s;s++){a=o;if(s!==u){a=Q.clone(a,!0,!0);n&&Q.merge(i,m(a,"script"))}t.call(this[s],a,s)}if(n){l=i[i.length-1].ownerDocument;Q.map(i,h);for(s=0;n>s;s++){a=i[s];De.test(a.type||"")&&!me.access(a,"globalEval")&&Q.contains(l,a)&&(a.src?Q._evalUrl&&Q._evalUrl(a.src):Q.globalEval(a.textContent.replace(ke,"")))}}}}return this}});Q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Q.fn[e]=function(e){for(var o,r=[],i=Q(e),n=i.length-1,a=0;n>=a;a++){o=a===n?this:this.clone(!0);Q(i[a])[t](o);V.apply(r,o.get())}return this.pushStack(r)}});var Ue,Be={},qe=/^margin/,je=new RegExp("^("+_e+")(?!px)[a-z%]+$","i"),$e=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):e.getComputedStyle(t,null)};!function(){function t(){a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute";a.innerHTML="";i.appendChild(n);var t=e.getComputedStyle(a,null);o="1%"!==t.top;r="4px"===t.width;i.removeChild(n)}var o,r,i=Z.documentElement,n=Z.createElement("div"),a=Z.createElement("div");if(a.style){a.style.backgroundClip="content-box";a.cloneNode(!0).style.backgroundClip="";z.clearCloneStyle="content-box"===a.style.backgroundClip;n.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute";n.appendChild(a);e.getComputedStyle&&Q.extend(z,{pixelPosition:function(){t();return o},boxSizingReliable:function(){null==r&&t();return r},reliableMarginRight:function(){var t,o=a.appendChild(Z.createElement("div"));o.style.cssText=a.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0";o.style.marginRight=o.style.width="0";a.style.width="1px";i.appendChild(n);t=!parseFloat(e.getComputedStyle(o,null).marginRight);i.removeChild(n);a.removeChild(o);return t}})}}();Q.swap=function(e,t,o,r){var i,n,a={};for(n in t){a[n]=e.style[n];e.style[n]=t[n]}i=o.apply(e,r||[]);for(n in t)e.style[n]=a[n];return i};var We=/^(none|table(?!-c[ea]).+)/,Ve=new RegExp("^("+_e+")(.*)$","i"),Ye=new RegExp("^([+-])=("+_e+")","i"),Ke={position:"absolute",visibility:"hidden",display:"block"},Xe={letterSpacing:"0",fontWeight:"400"},He=["Webkit","O","Moz","ms"];Q.extend({cssHooks:{opacity:{get:function(e,t){if(t){var o=_(e,"opacity");return""===o?"1":o}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,o,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,n,a,l=Q.camelCase(t),s=e.style;t=Q.cssProps[l]||(Q.cssProps[l]=E(s,l));a=Q.cssHooks[t]||Q.cssHooks[l];if(void 0===o)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:s[t];n=typeof o;if("string"===n&&(i=Ye.exec(o))){o=(i[1]+1)*i[2]+parseFloat(Q.css(e,t));n="number"}if(null!=o&&o===o){"number"!==n||Q.cssNumber[l]||(o+="px");z.clearCloneStyle||""!==o||0!==t.indexOf("background")||(s[t]="inherit");a&&"set"in a&&void 0===(o=a.set(e,o,r))||(s[t]=o)}}},css:function(e,t,o,r){var i,n,a,l=Q.camelCase(t);t=Q.cssProps[l]||(Q.cssProps[l]=E(e.style,l));a=Q.cssHooks[t]||Q.cssHooks[l];a&&"get"in a&&(i=a.get(e,!0,o));void 0===i&&(i=_(e,t,r));"normal"===i&&t in Xe&&(i=Xe[t]);if(""===o||o){n=parseFloat(i);return o===!0||Q.isNumeric(n)?n||0:i}return i}});Q.each(["height","width"],function(e,t){Q.cssHooks[t]={get:function(e,o,r){return o?We.test(Q.css(e,"display"))&&0===e.offsetWidth?Q.swap(e,Ke,function(){return L(e,t,r)}):L(e,t,r):void 0},set:function(e,o,r){var i=r&&$e(e);return x(e,o,r?P(e,t,r,"border-box"===Q.css(e,"boxSizing",!1,i),i):0)}}});Q.cssHooks.marginRight=S(z.reliableMarginRight,function(e,t){return t?Q.swap(e,{display:"inline-block"},_,[e,"marginRight"]):void 0});Q.each({margin:"",padding:"",border:"Width"},function(e,t){Q.cssHooks[e+t]={expand:function(o){for(var r=0,i={},n="string"==typeof o?o.split(" "):[o];4>r;r++)i[e+Se[r]+t]=n[r]||n[r-2]||n[0];return i}};qe.test(e)||(Q.cssHooks[e+t].set=x)});Q.fn.extend({css:function(e,t){return ye(this,function(e,t,o){var r,i,n={},a=0;if(Q.isArray(t)){r=$e(e);i=t.length;for(;i>a;a++)n[t[a]]=Q.css(e,t[a],!1,r);return n}return void 0!==o?Q.style(e,t,o):Q.css(e,t)},e,t,arguments.length>1)},show:function(){return w(this,!0)},hide:function(){return w(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ee(this)?Q(this).show():Q(this).hide()})}});Q.Tween=R;R.prototype={constructor:R,init:function(e,t,o,r,i,n){this.elem=e;this.prop=o;this.easing=i||"swing";this.options=t;this.start=this.now=this.cur();this.end=r;this.unit=n||(Q.cssNumber[o]?"":"px")},cur:function(){var e=R.propHooks[this.prop];return e&&e.get?e.get(this):R.propHooks._default.get(this)},run:function(e){var t,o=R.propHooks[this.prop];this.pos=t=this.options.duration?Q.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e;this.now=(this.end-this.start)*t+this.start;this.options.step&&this.options.step.call(this.elem,this.now,this);o&&o.set?o.set(this):R.propHooks._default.set(this);return this}};R.prototype.init.prototype=R.prototype;R.propHooks={_default:{get:function(e){var t;if(null!=e.elem[e.prop]&&(!e.elem.style||null==e.elem.style[e.prop]))return e.elem[e.prop];t=Q.css(e.elem,e.prop,"");return t&&"auto"!==t?t:0},set:function(e){Q.fx.step[e.prop]?Q.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[Q.cssProps[e.prop]]||Q.cssHooks[e.prop])?Q.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}};R.propHooks.scrollTop=R.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}};Q.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}};Q.fx=R.prototype.init;Q.fx.step={};var ze,Ze,Je=/^(?:toggle|show|hide)$/,Qe=new RegExp("^(?:([+-])=|)("+_e+")([a-z%]*)$","i"),et=/queueHooks$/,tt=[I],ot={"*":[function(e,t){var o=this.createTween(e,t),r=o.cur(),i=Qe.exec(t),n=i&&i[3]||(Q.cssNumber[e]?"":"px"),a=(Q.cssNumber[e]||"px"!==n&&+r)&&Qe.exec(Q.css(o.elem,e)),l=1,s=20;if(a&&a[3]!==n){n=n||a[3];i=i||[];a=+r||1;do{l=l||".5";a/=l;Q.style(o.elem,e,a+n)}while(l!==(l=o.cur()/r)&&1!==l&&--s)}if(i){a=o.start=+a||+r||0;o.unit=n;o.end=i[1]?a+(i[1]+1)*i[2]:+i[2]}return o}]};Q.Animation=Q.extend(N,{tweener:function(e,t){if(Q.isFunction(e)){t=e;e=["*"]}else e=e.split(" ");for(var o,r=0,i=e.length;i>r;r++){o=e[r];ot[o]=ot[o]||[];ot[o].unshift(t)}},prefilter:function(e,t){t?tt.unshift(e):tt.push(e)}});Q.speed=function(e,t,o){var r=e&&"object"==typeof e?Q.extend({},e):{complete:o||!o&&t||Q.isFunction(e)&&e,duration:e,easing:o&&t||t&&!Q.isFunction(t)&&t};r.duration=Q.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in Q.fx.speeds?Q.fx.speeds[r.duration]:Q.fx.speeds._default;(null==r.queue||r.queue===!0)&&(r.queue="fx");r.old=r.complete;r.complete=function(){Q.isFunction(r.old)&&r.old.call(this);r.queue&&Q.dequeue(this,r.queue)};return r};Q.fn.extend({fadeTo:function(e,t,o,r){return this.filter(Ee).css("opacity",0).show().end().animate({opacity:t},e,o,r)},animate:function(e,t,o,r){var i=Q.isEmptyObject(e),n=Q.speed(t,o,r),a=function(){var t=N(this,Q.extend({},e),n);(i||me.get(this,"finish"))&&t.stop(!0)};a.finish=a;return i||n.queue===!1?this.each(a):this.queue(n.queue,a)},stop:function(e,t,o){var r=function(e){var t=e.stop;delete e.stop;t(o)};if("string"!=typeof e){o=t;t=e;e=void 0}t&&e!==!1&&this.queue(e||"fx",[]);return this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",n=Q.timers,a=me.get(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&et.test(i)&&r(a[i]);for(i=n.length;i--;)if(n[i].elem===this&&(null==e||n[i].queue===e)){n[i].anim.stop(o);t=!1;n.splice(i,1)}(t||!o)&&Q.dequeue(this,e)})},finish:function(e){e!==!1&&(e=e||"fx");return this.each(function(){var t,o=me.get(this),r=o[e+"queue"],i=o[e+"queueHooks"],n=Q.timers,a=r?r.length:0;o.finish=!0;Q.queue(this,e,[]);i&&i.stop&&i.stop.call(this,!0);for(t=n.length;t--;)if(n[t].elem===this&&n[t].queue===e){n[t].anim.stop(!0);n.splice(t,1)}for(t=0;a>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete o.finish})}});Q.each(["toggle","show","hide"],function(e,t){var o=Q.fn[t];Q.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?o.apply(this,arguments):this.animate(b(t,!0),e,r,i)}});Q.each({slideDown:b("show"),slideUp:b("hide"),slideToggle:b("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Q.fn[e]=function(e,o,r){return this.animate(t,e,o,r)}});Q.timers=[];Q.fx.tick=function(){var e,t=0,o=Q.timers;ze=Q.now();for(;t<o.length;t++){e=o[t];e()||o[t]!==e||o.splice(t--,1)}o.length||Q.fx.stop();ze=void 0};Q.fx.timer=function(e){Q.timers.push(e);e()?Q.fx.start():Q.timers.pop()};Q.fx.interval=13;Q.fx.start=function(){Ze||(Ze=setInterval(Q.fx.tick,Q.fx.interval))};Q.fx.stop=function(){clearInterval(Ze);Ze=null};Q.fx.speeds={slow:600,fast:200,_default:400};Q.fn.delay=function(e,t){e=Q.fx?Q.fx.speeds[e]||e:e;t=t||"fx";return this.queue(t,function(t,o){var r=setTimeout(t,e);o.stop=function(){clearTimeout(r)}})};!function(){var e=Z.createElement("input"),t=Z.createElement("select"),o=t.appendChild(Z.createElement("option"));e.type="checkbox";z.checkOn=""!==e.value;z.optSelected=o.selected;t.disabled=!0;z.optDisabled=!o.disabled;e=Z.createElement("input");e.value="t";e.type="radio";z.radioValue="t"===e.value}();var rt,it,nt=Q.expr.attrHandle;Q.fn.extend({attr:function(e,t){return ye(this,Q.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Q.removeAttr(this,e)})}});Q.extend({attr:function(e,t,o){var r,i,n=e.nodeType;if(e&&3!==n&&8!==n&&2!==n){if(typeof e.getAttribute===Pe)return Q.prop(e,t,o);if(1!==n||!Q.isXMLDoc(e)){t=t.toLowerCase();r=Q.attrHooks[t]||(Q.expr.match.bool.test(t)?it:rt)}if(void 0===o){if(r&&"get"in r&&null!==(i=r.get(e,t)))return i;i=Q.find.attr(e,t);return null==i?void 0:i}if(null!==o){if(r&&"set"in r&&void 0!==(i=r.set(e,o,t)))return i;e.setAttribute(t,o+"");return o}Q.removeAttr(e,t)}},removeAttr:function(e,t){var o,r,i=0,n=t&&t.match(de);if(n&&1===e.nodeType)for(;o=n[i++];){r=Q.propFix[o]||o;Q.expr.match.bool.test(o)&&(e[r]=!1);e.removeAttribute(o)}},attrHooks:{type:{set:function(e,t){if(!z.radioValue&&"radio"===t&&Q.nodeName(e,"input")){var o=e.value;e.setAttribute("type",t);o&&(e.value=o);return t}}}}});it={set:function(e,t,o){t===!1?Q.removeAttr(e,o):e.setAttribute(o,o);return o}};Q.each(Q.expr.match.bool.source.match(/\w+/g),function(e,t){var o=nt[t]||Q.find.attr;nt[t]=function(e,t,r){var i,n;if(!r){n=nt[t];nt[t]=i;i=null!=o(e,t,r)?t.toLowerCase():null;nt[t]=n}return i}});var at=/^(?:input|select|textarea|button)$/i;Q.fn.extend({prop:function(e,t){return ye(this,Q.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[Q.propFix[e]||e]})}});Q.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,o){var r,i,n,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a){n=1!==a||!Q.isXMLDoc(e);if(n){t=Q.propFix[t]||t;i=Q.propHooks[t]}return void 0!==o?i&&"set"in i&&void 0!==(r=i.set(e,o,t))?r:e[t]=o:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]}},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||at.test(e.nodeName)||e.href?e.tabIndex:-1}}}});z.optSelected||(Q.propHooks.selected={get:function(e){var t=e.parentNode;t&&t.parentNode&&t.parentNode.selectedIndex;return null}});Q.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Q.propFix[this.toLowerCase()]=this});var lt=/[\t\r\n\f]/g;Q.fn.extend({addClass:function(e){var t,o,r,i,n,a,l="string"==typeof e&&e,s=0,p=this.length;if(Q.isFunction(e))return this.each(function(t){Q(this).addClass(e.call(this,t,this.className))});if(l){t=(e||"").match(de)||[];for(;p>s;s++){o=this[s];r=1===o.nodeType&&(o.className?(" "+o.className+" ").replace(lt," "):" ");if(r){n=0;for(;i=t[n++];)r.indexOf(" "+i+" ")<0&&(r+=i+" ");a=Q.trim(r);o.className!==a&&(o.className=a)}}}return this},removeClass:function(e){var t,o,r,i,n,a,l=0===arguments.length||"string"==typeof e&&e,s=0,p=this.length;if(Q.isFunction(e))return this.each(function(t){Q(this).removeClass(e.call(this,t,this.className))});if(l){t=(e||"").match(de)||[];for(;p>s;s++){o=this[s];r=1===o.nodeType&&(o.className?(" "+o.className+" ").replace(lt," "):"");if(r){n=0;for(;i=t[n++];)for(;r.indexOf(" "+i+" ")>=0;)r=r.replace(" "+i+" "," ");a=e?Q.trim(r):"";o.className!==a&&(o.className=a)}}}return this},toggleClass:function(e,t){var o=typeof e;return"boolean"==typeof t&&"string"===o?t?this.addClass(e):this.removeClass(e):this.each(Q.isFunction(e)?function(o){Q(this).toggleClass(e.call(this,o,this.className,t),t)}:function(){if("string"===o)for(var t,r=0,i=Q(this),n=e.match(de)||[];t=n[r++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else if(o===Pe||"boolean"===o){this.className&&me.set(this,"__className__",this.className);this.className=this.className||e===!1?"":me.get(this,"__className__")||""}})},hasClass:function(e){for(var t=" "+e+" ",o=0,r=this.length;r>o;o++)if(1===this[o].nodeType&&(" "+this[o].className+" ").replace(lt," ").indexOf(t)>=0)return!0;return!1}});var st=/\r/g;Q.fn.extend({val:function(e){var t,o,r,i=this[0];if(arguments.length){r=Q.isFunction(e);return this.each(function(o){var i;if(1===this.nodeType){i=r?e.call(this,o,Q(this).val()):e;null==i?i="":"number"==typeof i?i+="":Q.isArray(i)&&(i=Q.map(i,function(e){return null==e?"":e+""}));t=Q.valHooks[this.type]||Q.valHooks[this.nodeName.toLowerCase()];t&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i)}})}if(i){t=Q.valHooks[i.type]||Q.valHooks[i.nodeName.toLowerCase()];if(t&&"get"in t&&void 0!==(o=t.get(i,"value")))return o;o=i.value;return"string"==typeof o?o.replace(st,""):null==o?"":o}}});Q.extend({valHooks:{option:{get:function(e){var t=Q.find.attr(e,"value");return null!=t?t:Q.trim(Q.text(e))}},select:{get:function(e){for(var t,o,r=e.options,i=e.selectedIndex,n="select-one"===e.type||0>i,a=n?null:[],l=n?i+1:r.length,s=0>i?l:n?i:0;l>s;s++){o=r[s];if(!(!o.selected&&s!==i||(z.optDisabled?o.disabled:null!==o.getAttribute("disabled"))||o.parentNode.disabled&&Q.nodeName(o.parentNode,"optgroup"))){t=Q(o).val();if(n)return t;a.push(t)}}return a},set:function(e,t){for(var o,r,i=e.options,n=Q.makeArray(t),a=i.length;a--;){r=i[a];(r.selected=Q.inArray(r.value,n)>=0)&&(o=!0)}o||(e.selectedIndex=-1);return n}}}});Q.each(["radio","checkbox"],function(){Q.valHooks[this]={set:function(e,t){return Q.isArray(t)?e.checked=Q.inArray(Q(e).val(),t)>=0:void 0}};z.checkOn||(Q.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});Q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Q.fn[t]=function(e,o){return arguments.length>0?this.on(t,null,e,o):this.trigger(t)}});Q.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,o){return this.on(e,null,t,o)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,o,r){return this.on(t,e,o,r)},undelegate:function(e,t,o){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",o)}});var pt=Q.now(),ct=/\?/;Q.parseJSON=function(e){return JSON.parse(e+"")};Q.parseXML=function(e){var t,o;if(!e||"string"!=typeof e)return null;try{o=new DOMParser;t=o.parseFromString(e,"text/xml")}catch(r){t=void 0}(!t||t.getElementsByTagName("parsererror").length)&&Q.error("Invalid XML: "+e);return t};var ut=/#.*$/,gt=/([?&])_=[^&]*/,dt=/^(.*?):[ \t]*([^\r\n]*)$/gm,ht=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ft=/^(?:GET|HEAD)$/,yt=/^\/\//,mt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,vt={},Ct={},Tt="*/".concat("*"),_t=e.location.href,St=mt.exec(_t.toLowerCase())||[];Q.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_t,type:"GET",isLocal:ht.test(St[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Tt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Q.parseJSON,"text xml":Q.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?k(k(e,Q.ajaxSettings),t):k(Q.ajaxSettings,e)},ajaxPrefilter:D(vt),ajaxTransport:D(Ct),ajax:function(e,t){function o(e,t,o,a){var s,c,m,v,T,S=t;if(2!==C){C=2;l&&clearTimeout(l);r=void 0;n=a||"";_.readyState=e>0?4:0;s=e>=200&&300>e||304===e;o&&(v=G(u,_,o));v=U(u,v,_,s);if(s){if(u.ifModified){T=_.getResponseHeader("Last-Modified");T&&(Q.lastModified[i]=T);T=_.getResponseHeader("etag");T&&(Q.etag[i]=T)}if(204===e||"HEAD"===u.type)S="nocontent";else if(304===e)S="notmodified";else{S=v.state;c=v.data;m=v.error;s=!m}}else{m=S;if(e||!S){S="error";0>e&&(e=0)}}_.status=e;_.statusText=(t||S)+"";s?h.resolveWith(g,[c,S,_]):h.rejectWith(g,[_,S,m]);_.statusCode(y);y=void 0;p&&d.trigger(s?"ajaxSuccess":"ajaxError",[_,u,s?c:m]);f.fireWith(g,[_,S]);if(p){d.trigger("ajaxComplete",[_,u]);--Q.active||Q.event.trigger("ajaxStop")}}}if("object"==typeof e){t=e;e=void 0}t=t||{};var r,i,n,a,l,s,p,c,u=Q.ajaxSetup({},t),g=u.context||u,d=u.context&&(g.nodeType||g.jquery)?Q(g):Q.event,h=Q.Deferred(),f=Q.Callbacks("once memory"),y=u.statusCode||{},m={},v={},C=0,T="canceled",_={readyState:0,getResponseHeader:function(e){var t;if(2===C){if(!a){a={};for(;t=dt.exec(n);)a[t[1].toLowerCase()]=t[2]}t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===C?n:null},setRequestHeader:function(e,t){var o=e.toLowerCase();if(!C){e=v[o]=v[o]||e;m[e]=t}return this},overrideMimeType:function(e){C||(u.mimeType=e);return this},statusCode:function(e){var t;if(e)if(2>C)for(t in e)y[t]=[y[t],e[t]];else _.always(e[_.status]);return this},abort:function(e){var t=e||T;r&&r.abort(t);o(0,t);return this}};h.promise(_).complete=f.add;_.success=_.done;_.error=_.fail;u.url=((e||u.url||_t)+"").replace(ut,"").replace(yt,St[1]+"//");u.type=t.method||t.type||u.method||u.type;u.dataTypes=Q.trim(u.dataType||"*").toLowerCase().match(de)||[""];if(null==u.crossDomain){s=mt.exec(u.url.toLowerCase());u.crossDomain=!(!s||s[1]===St[1]&&s[2]===St[2]&&(s[3]||("http:"===s[1]?"80":"443"))===(St[3]||("http:"===St[1]?"80":"443")))}u.data&&u.processData&&"string"!=typeof u.data&&(u.data=Q.param(u.data,u.traditional));F(vt,u,t,_);if(2===C)return _;p=Q.event&&u.global;p&&0===Q.active++&&Q.event.trigger("ajaxStart");u.type=u.type.toUpperCase();u.hasContent=!ft.test(u.type);i=u.url;if(!u.hasContent){if(u.data){i=u.url+=(ct.test(i)?"&":"?")+u.data;delete u.data}u.cache===!1&&(u.url=gt.test(i)?i.replace(gt,"$1_="+pt++):i+(ct.test(i)?"&":"?")+"_="+pt++)}if(u.ifModified){Q.lastModified[i]&&_.setRequestHeader("If-Modified-Since",Q.lastModified[i]);Q.etag[i]&&_.setRequestHeader("If-None-Match",Q.etag[i])}(u.data&&u.hasContent&&u.contentType!==!1||t.contentType)&&_.setRequestHeader("Content-Type",u.contentType);_.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+Tt+"; q=0.01":""):u.accepts["*"]);for(c in u.headers)_.setRequestHeader(c,u.headers[c]);if(u.beforeSend&&(u.beforeSend.call(g,_,u)===!1||2===C))return _.abort();T="abort";for(c in{success:1,error:1,complete:1})_[c](u[c]);r=F(Ct,u,t,_);if(r){_.readyState=1;p&&d.trigger("ajaxSend",[_,u]);u.async&&u.timeout>0&&(l=setTimeout(function(){_.abort("timeout")},u.timeout));try{C=1;r.send(m,o)}catch(S){if(!(2>C))throw S;o(-1,S)}}else o(-1,"No Transport");return _},getJSON:function(e,t,o){return Q.get(e,t,o,"json")},getScript:function(e,t){return Q.get(e,void 0,t,"script")}});Q.each(["get","post"],function(e,t){Q[t]=function(e,o,r,i){if(Q.isFunction(o)){i=i||r;r=o;o=void 0}return Q.ajax({url:e,type:t,dataType:i,data:o,success:r})}});Q._evalUrl=function(e){return Q.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})};Q.fn.extend({wrapAll:function(e){var t;if(Q.isFunction(e))return this.each(function(t){Q(this).wrapAll(e.call(this,t))});if(this[0]){t=Q(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]);t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)}return this},wrapInner:function(e){return this.each(Q.isFunction(e)?function(t){Q(this).wrapInner(e.call(this,t))}:function(){var t=Q(this),o=t.contents();o.length?o.wrapAll(e):t.append(e)})},wrap:function(e){var t=Q.isFunction(e);return this.each(function(o){Q(this).wrapAll(t?e.call(this,o):e)})},unwrap:function(){return this.parent().each(function(){Q.nodeName(this,"body")||Q(this).replaceWith(this.childNodes)}).end()}});Q.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0};Q.expr.filters.visible=function(e){return!Q.expr.filters.hidden(e)};var Et=/%20/g,xt=/\[\]$/,Pt=/\r?\n/g,Lt=/^(?:submit|button|image|reset|file)$/i,wt=/^(?:input|select|textarea|keygen)/i;Q.param=function(e,t){var o,r=[],i=function(e,t){t=Q.isFunction(t)?t():null==t?"":t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};void 0===t&&(t=Q.ajaxSettings&&Q.ajaxSettings.traditional);if(Q.isArray(e)||e.jquery&&!Q.isPlainObject(e))Q.each(e,function(){i(this.name,this.value)});else for(o in e)B(o,e[o],t,i);return r.join("&").replace(Et,"+")};Q.fn.extend({serialize:function(){return Q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=Q.prop(this,"elements");return e?Q.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!Q(this).is(":disabled")&&wt.test(this.nodeName)&&!Lt.test(e)&&(this.checked||!xe.test(e))}).map(function(e,t){var o=Q(this).val();return null==o?null:Q.isArray(o)?Q.map(o,function(e){return{name:t.name,value:e.replace(Pt,"\r\n")}}):{name:t.name,value:o.replace(Pt,"\r\n")}}).get()}});Q.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var Rt=0,At={},bt={0:200,1223:204},Mt=Q.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in At)At[e]()});z.cors=!!Mt&&"withCredentials"in Mt;z.ajax=Mt=!!Mt;Q.ajaxTransport(function(e){var t;return z.cors||Mt&&!e.crossDomain?{send:function(o,r){var i,n=e.xhr(),a=++Rt;n.open(e.type,e.url,e.async,e.username,e.password);if(e.xhrFields)for(i in e.xhrFields)n[i]=e.xhrFields[i];e.mimeType&&n.overrideMimeType&&n.overrideMimeType(e.mimeType);e.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");for(i in o)n.setRequestHeader(i,o[i]);t=function(e){return function(){if(t){delete At[a];t=n.onload=n.onerror=null;"abort"===e?n.abort():"error"===e?r(n.status,n.statusText):r(bt[n.status]||n.status,n.statusText,"string"==typeof n.responseText?{text:n.responseText}:void 0,n.getAllResponseHeaders())}}};n.onload=t();n.onerror=t("error");t=At[a]=t("abort");try{n.send(e.hasContent&&e.data||null)}catch(l){if(t)throw l}},abort:function(){t&&t()}}:void 0});Q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){Q.globalEval(e);return e}}});Q.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1);e.crossDomain&&(e.type="GET")});Q.ajaxTransport("script",function(e){if(e.crossDomain){var t,o;return{send:function(r,i){t=Q("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",o=function(e){t.remove();o=null;e&&i("error"===e.type?404:200,e.type)});Z.head.appendChild(t[0])},abort:function(){o&&o()}}}});var It=[],Ot=/(=)\?(?=&|$)|\?\?/;Q.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=It.pop()||Q.expando+"_"+pt++;this[e]=!0;return e}});Q.ajaxPrefilter("json jsonp",function(t,o,r){var i,n,a,l=t.jsonp!==!1&&(Ot.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ot.test(t.data)&&"data");if(l||"jsonp"===t.dataTypes[0]){i=t.jsonpCallback=Q.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback;l?t[l]=t[l].replace(Ot,"$1"+i):t.jsonp!==!1&&(t.url+=(ct.test(t.url)?"&":"?")+t.jsonp+"="+i);t.converters["script json"]=function(){a||Q.error(i+" was not called");return a[0]};t.dataTypes[0]="json";n=e[i];e[i]=function(){a=arguments};r.always(function(){e[i]=n;if(t[i]){t.jsonpCallback=o.jsonpCallback;It.push(i)}a&&Q.isFunction(n)&&n(a[0]);a=n=void 0});return"script"}});Q.parseHTML=function(e,t,o){if(!e||"string"!=typeof e)return null;if("boolean"==typeof t){o=t;t=!1}t=t||Z;var r=ae.exec(e),i=!o&&[];if(r)return[t.createElement(r[1])];r=Q.buildFragment([e],t,i);i&&i.length&&Q(i).remove();return Q.merge([],r.childNodes)};var Nt=Q.fn.load;Q.fn.load=function(e,t,o){if("string"!=typeof e&&Nt)return Nt.apply(this,arguments);var r,i,n,a=this,l=e.indexOf(" ");if(l>=0){r=Q.trim(e.slice(l));e=e.slice(0,l)}if(Q.isFunction(t)){o=t;t=void 0}else t&&"object"==typeof t&&(i="POST");a.length>0&&Q.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){n=arguments;a.html(r?Q("<div>").append(Q.parseHTML(e)).find(r):e)}).complete(o&&function(e,t){a.each(o,n||[e.responseText,t,e])});return this};Q.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){Q.fn[t]=function(e){return this.on(t,e)}});Q.expr.filters.animated=function(e){return Q.grep(Q.timers,function(t){return e===t.elem}).length};var Dt=e.document.documentElement;Q.offset={setOffset:function(e,t,o){var r,i,n,a,l,s,p,c=Q.css(e,"position"),u=Q(e),g={};"static"===c&&(e.style.position="relative");l=u.offset();n=Q.css(e,"top");s=Q.css(e,"left");p=("absolute"===c||"fixed"===c)&&(n+s).indexOf("auto")>-1;if(p){r=u.position();a=r.top;i=r.left}else{a=parseFloat(n)||0;i=parseFloat(s)||0}Q.isFunction(t)&&(t=t.call(e,o,l));null!=t.top&&(g.top=t.top-l.top+a);null!=t.left&&(g.left=t.left-l.left+i);"using"in t?t.using.call(e,g):u.css(g)}};Q.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){Q.offset.setOffset(this,e,t)});var t,o,r=this[0],i={top:0,left:0},n=r&&r.ownerDocument;if(n){t=n.documentElement;if(!Q.contains(t,r))return i;typeof r.getBoundingClientRect!==Pe&&(i=r.getBoundingClientRect());o=q(n);return{top:i.top+o.pageYOffset-t.clientTop,left:i.left+o.pageXOffset-t.clientLeft}}},position:function(){if(this[0]){var e,t,o=this[0],r={top:0,left:0};if("fixed"===Q.css(o,"position"))t=o.getBoundingClientRect();else{e=this.offsetParent();t=this.offset();Q.nodeName(e[0],"html")||(r=e.offset());r.top+=Q.css(e[0],"borderTopWidth",!0);r.left+=Q.css(e[0],"borderLeftWidth",!0)}return{top:t.top-r.top-Q.css(o,"marginTop",!0),left:t.left-r.left-Q.css(o,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Dt;e&&!Q.nodeName(e,"html")&&"static"===Q.css(e,"position");)e=e.offsetParent;return e||Dt})}});Q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,o){var r="pageYOffset"===o;Q.fn[t]=function(i){return ye(this,function(t,i,n){var a=q(t);if(void 0===n)return a?a[o]:t[i];a?a.scrollTo(r?e.pageXOffset:n,r?n:e.pageYOffset):t[i]=n;return void 0},t,i,arguments.length,null)}});Q.each(["top","left"],function(e,t){Q.cssHooks[t]=S(z.pixelPosition,function(e,o){if(o){o=_(e,t);return je.test(o)?Q(e).position()[t]+"px":o}})});Q.each({Height:"height",Width:"width"},function(e,t){Q.each({padding:"inner"+e,content:t,"":"outer"+e},function(o,r){Q.fn[r]=function(r,i){var n=arguments.length&&(o||"boolean"!=typeof r),a=o||(r===!0||i===!0?"margin":"border");return ye(this,function(t,o,r){var i;if(Q.isWindow(t))return t.document.documentElement["client"+e];if(9===t.nodeType){i=t.documentElement;return Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])}return void 0===r?Q.css(t,o,a):Q.style(t,o,r,a)},t,n?r:void 0,n,null)}})});Q.fn.size=function(){return this.length};Q.fn.andSelf=Q.fn.addBack;"function"==typeof define&&define.amd&&define("jquery",[],function(){return Q});var Ft=e.jQuery,kt=e.$;Q.noConflict=function(t){e.$===Q&&(e.$=kt);t&&e.jQuery===Q&&(e.jQuery=Ft);return Q};typeof t===Pe&&(e.jQuery=e.$=Q);return Q});!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){if(!e.support.cors&&e.ajaxTransport&&window.XDomainRequest){var t=/^https?:\/\//i,o=/^get|post$/i,r=new RegExp("^"+location.protocol,"i");e.ajaxTransport("* text html xml json",function(i,n,a){if(i.crossDomain&&i.async&&o.test(i.type)&&t.test(i.url)&&r.test(i.url)){var l=null;return{send:function(t,o){var r="",a=(n.dataType||"").toLowerCase();l=new XDomainRequest;/^\d+$/.test(n.timeout)&&(l.timeout=n.timeout);l.ontimeout=function(){o(500,"timeout")};l.onload=function(){var t="Content-Length: "+l.responseText.length+"\r\nContent-Type: "+l.contentType,r={code:200,message:"success"},i={text:l.responseText};try{if("html"===a||/text\/html/i.test(l.contentType))i.html=l.responseText;else if("json"===a||"text"!==a&&/\/json/i.test(l.contentType))try{i.json=e.parseJSON(l.responseText)}catch(n){r.code=500;r.message="parseerror"}else if("xml"===a||"text"!==a&&/\/xml/i.test(l.contentType)){var s=new ActiveXObject("Microsoft.XMLDOM");s.async=!1;try{s.loadXML(l.responseText)}catch(n){s=void 0}if(!s||!s.documentElement||s.getElementsByTagName("parsererror").length){r.code=500;r.message="parseerror";throw"Invalid XML: "+l.responseText}i.xml=s}}catch(p){throw p}finally{o(r.code,r.message,i,t)}};l.onprogress=function(){};l.onerror=function(){o(500,"error",{text:l.responseText})};n.data&&(r="string"===e.type(n.data)?n.data:e.param(n.data));l.open(i.type,i.url);l.send(r)},abort:function(){l&&l.abort()}}}})}});!function(e){"use strict";var t=({defaults:{method:"GET",cancelRequests:!1,target:e(),source:null,callback:null,link:null,minLength:0,matchFromStart:!0},openXHR:{},cache:{}},function(t,r,i){var n=[];if(r)if(i.buildHTML)e(i.target).html(i.buildHTML({results:r}));else{for(var a=0;a<r.length;a++){var l=r[a];n[n.length]=e.isPlainObject(l)?'<li><a href="'+i.link+encodeURIComponent(l.id)+'">'+l.label+"</a></li>":'<li><a href="'+i.link+encodeURIComponent(l)+'">'+l+"</a></li>"}e(i.target).html(n.join(""))}null!==i.callback&&e.isFunction(i.callback)&&o(i);t.trigger(t.val().length>0?"targetUpdated.autocomplete":"targetCleared.autocomplete")}),o=function(t){e("li a",e(t.target)).on("click.autocomplete",function(e){e.stopPropagation();e.preventDefault();t.callback(e)})},r=function(e,t){t.html("").closest("fieldset").removeClass("ui-search-active");e.trigger("targetCleared.autocomplete")},i=function(o){var i,n,a,l,s=e(this),p=s.attr("id"),c=s.data("autocomplete");if(c){var u=c.settings,g=c.openXHR;i=s.val();if(i.length<u.minLength)r(s,e(u.target));else if(e.isArray(u.source)){n=u.source.sort().filter(function(t){l=u.matchFromStart?new RegExp("^"+i,"i"):new RegExp(i,"i");a=e.isPlainObject(t)?t.label:t;return l.test(a)});t(s,n,u)}else"function"==typeof u.source?u.source(i,function(e){t(s,e,u)}):e.ajax({type:u.method,url:u.source,data:{term:i},beforeSend:function(e){if(u.cancelRequests){if(g[p])g[p].abort();else{u.target.html('<li><a href="#">Searching...</a></li>');

u.target.closest("fieldset").addClass("ui-search-active")}g[p]=e}},success:function(e){t(s,e,u)},complete:function(e,t){u.cancelRequests&&(g[p]=null)},dataType:"json"})}},n={init:function(t){var o=this,n={settings:null};n.settings=e.extend({},n.defaults,t);o.data("autocomplete",n);var a=n.settings;return o.off("keyup.autocomplete").on("keyup.autocomplete",i).next(".ui-input-clear").on("click",function(t){r(o,e(a.target))})},update:function(t){var o=this.data("autocomplete");if(o){o.settings=e.extend(o.settings,t);this.data("autocomplete",o)}return this},clear:function(){var t=this.data("autocomplete");t&&r(this,e(t.settings.target));return this},destroy:function(){var t=this.data("autocomplete");if(t){r(this,e(t.settings.target));this.removeData("autocomplete");this.off(".autocomplete")}return this}};e.fn.autocomplete=function(e){return n[e]?n[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void 0:n.init.apply(this,arguments)}}(jQuery);!function(e){e.fn.drag=function(t,o,r){var i="string"==typeof t?t:"",n=e.isFunction(t)?t:e.isFunction(o)?o:null;0!==i.indexOf("drag")&&(i="drag"+i);r=(t==n?o:r)||{};return n?this.bind(i,r,n):this.trigger(i)};var t=e.event,o=t.special,r=o.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(t){var o=e.data(this,r.datakey),i=t.data||{};o.related+=1;e.each(r.defaults,function(e,t){void 0!==i[e]&&(o[e]=i[e])})},remove:function(){e.data(this,r.datakey).related-=1},setup:function(){if(!e.data(this,r.datakey)){var o=e.extend({related:0},r.defaults);e.data(this,r.datakey,o);t.add(this,"touchstart mousedown",r.init,o);this.attachEvent&&this.attachEvent("ondragstart",r.dontstart)}},teardown:function(){var o=e.data(this,r.datakey)||{};if(!o.related){e.removeData(this,r.datakey);t.remove(this,"touchstart mousedown",r.init);r.textselect(!0);this.detachEvent&&this.detachEvent("ondragstart",r.dontstart)}},init:function(i){if(!r.touched){var n,a=i.data;if(!(0!=i.which&&a.which>0&&i.which!=a.which||e(i.target).is(a.not)||a.handle&&!e(i.target).closest(a.handle,i.currentTarget).length)){r.touched="touchstart"==i.type?this:null;a.propagates=1;a.mousedown=this;a.interactions=[r.interaction(this,a)];a.target=i.target;a.pageX=i.pageX;a.pageY=i.pageY;a.dragging=null;n=r.hijack(i,"draginit",a);if(a.propagates){n=r.flatten(n);if(n&&n.length){a.interactions=[];e.each(n,function(){a.interactions.push(r.interaction(this,a))})}a.propagates=a.interactions.length;a.drop!==!1&&o.drop&&o.drop.handler(i,a);r.textselect(!1);r.touched?t.add(r.touched,"touchmove touchend",r.handler,a):t.add(document,"mousemove mouseup",r.handler,a);return!r.touched||a.live?!1:void 0}}}},interaction:function(t,o){var i=e(t)[o.relative?"position":"offset"]()||{top:0,left:0};return{drag:t,callback:new r.callback,droppable:[],offset:i}},handler:function(i){var n=i.data;switch(i.type){case!n.dragging&&"touchmove":i.preventDefault();case!n.dragging&&"mousemove":if(Math.pow(i.pageX-n.pageX,2)+Math.pow(i.pageY-n.pageY,2)<Math.pow(n.distance,2))break;i.target=n.target;r.hijack(i,"dragstart",n);n.propagates&&(n.dragging=!0);case"touchmove":i.preventDefault();case"mousemove":if(n.dragging){r.hijack(i,"drag",n);if(n.propagates){n.drop!==!1&&o.drop&&o.drop.handler(i,n);break}i.type="mouseup"}case"touchend":case"mouseup":default:r.touched?t.remove(r.touched,"touchmove touchend",r.handler):t.remove(document,"mousemove mouseup",r.handler);if(n.dragging){n.drop!==!1&&o.drop&&o.drop.handler(i,n);r.hijack(i,"dragend",n)}r.textselect(!0);n.click===!1&&n.dragging&&e.data(n.mousedown,"suppress.click",(new Date).getTime()+5);n.dragging=r.touched=!1}},hijack:function(o,i,n,a,l){if(n){var s,p,c,u={event:o.originalEvent,type:o.type},g=i.indexOf("drop")?"drag":"drop",d=a||0,h=isNaN(a)?n.interactions.length:a;o.type=i;o.originalEvent=null;n.results=[];do if(p=n.interactions[d]){if("dragend"!==i&&p.cancelled)continue;c=r.properties(o,n,p);p.results=[];e(l||p[g]||n.droppable).each(function(a,l){c.target=l;o.isPropagationStopped=function(){return!1};s=l?t.dispatch.call(l,o,c):null;if(s===!1){if("drag"==g){p.cancelled=!0;n.propagates-=1}"drop"==i&&(p[g][a]=null)}else"dropinit"==i&&p.droppable.push(r.element(s)||l);"dragstart"==i&&(p.proxy=e(r.element(s)||p.drag)[0]);p.results.push(s);delete o.result;return"dropinit"!==i?s:void 0});n.results[d]=r.flatten(p.results);"dropinit"==i&&(p.droppable=r.flatten(p.droppable));"dragstart"!=i||p.cancelled||c.update()}while(++d<h);o.type=u.type;o.originalEvent=u.event;return r.flatten(n.results)}},properties:function(e,t,o){var i=o.callback;i.drag=o.drag;i.proxy=o.proxy||o.drag;i.startX=t.pageX;i.startY=t.pageY;i.deltaX=e.pageX-t.pageX;i.deltaY=e.pageY-t.pageY;i.originalX=o.offset.left;i.originalY=o.offset.top;i.offsetX=i.originalX+i.deltaX;i.offsetY=i.originalY+i.deltaY;i.drop=r.flatten((o.drop||[]).slice());i.available=r.flatten((o.droppable||[]).slice());return i},element:function(e){return e&&(e.jquery||1==e.nodeType)?e:void 0},flatten:function(t){return e.map(t,function(t){return t&&t.jquery?e.makeArray(t):t&&t.length?r.flatten(t):t})},textselect:function(t){e(document)[t?"unbind":"bind"]("selectstart",r.dontstart).css("MozUserSelect",t?"":"none");document.unselectable=t?"off":"on"},dontstart:function(){return!1},callback:function(){}};r.callback.prototype={update:function(){o.drop&&this.available.length&&e.each(this.available,function(e){o.drop.locate(this,e)})}};var i=t.dispatch;t.dispatch=function(t){if(!(e.data(this,"suppress."+t.type)-(new Date).getTime()>0))return i.apply(this,arguments);e.removeData(this,"suppress."+t.type);return void 0};var n=t.fixHooks.touchstart=t.fixHooks.touchmove=t.fixHooks.touchend=t.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(t,o){if(o){var r=o.touches&&o.touches[0]||o.changedTouches&&o.changedTouches[0]||null;r&&e.each(n.props,function(e,o){t[o]=r[o]})}return t}};o.draginit=o.dragstart=o.dragend=r}(jQuery);!function(e){e.fn.drop=function(t,o,r){var i="string"==typeof t?t:"",n=e.isFunction(t)?t:e.isFunction(o)?o:null;0!==i.indexOf("drop")&&(i="drop"+i);r=(t==n?o:r)||{};return n?this.bind(i,r,n):this.trigger(i)};e.drop=function(t){t=t||{};r.multi=t.multi===!0?1/0:t.multi===!1?1:isNaN(t.multi)?r.multi:t.multi;r.delay=t.delay||r.delay;r.tolerance=e.isFunction(t.tolerance)?t.tolerance:null===t.tolerance?null:r.tolerance;r.mode=t.mode||r.mode||"intersect"};var t=e.event,o=t.special,r=e.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(t){var o=e.data(this,r.datakey);o.related+=1},remove:function(){e.data(this,r.datakey).related-=1},setup:function(){if(!e.data(this,r.datakey)){var t={related:0,active:[],anyactive:0,winner:0,location:{}};e.data(this,r.datakey,t);r.targets.push(this)}},teardown:function(){var t=e.data(this,r.datakey)||{};if(!t.related){e.removeData(this,r.datakey);var o=this;r.targets=e.grep(r.targets,function(e){return e!==o})}},handler:function(t,i){var n;if(i)switch(t.type){case"mousedown":case"touchstart":n=e(r.targets);"string"==typeof i.drop&&(n=n.filter(i.drop));n.each(function(){var t=e.data(this,r.datakey);t.active=[];t.anyactive=0;t.winner=0});i.droppable=n;o.drag.hijack(t,"dropinit",i);break;case"mousemove":case"touchmove":r.event=t;r.timer||r.tolerate(i);break;case"mouseup":case"touchend":r.timer=clearTimeout(r.timer);if(i.propagates){o.drag.hijack(t,"drop",i);o.drag.hijack(t,"dropend",i)}}},locate:function(t,o){var i=e.data(t,r.datakey),n=e(t),a=n.offset()||{},l=n.outerHeight(),s=n.outerWidth(),p={elem:t,width:s,height:l,top:a.top,left:a.left,right:a.left+s,bottom:a.top+l};if(i){i.location=p;i.index=o;i.elem=t}return p},contains:function(e,t){return(t[0]||t.left)>=e.left&&(t[0]||t.right)<=e.right&&(t[1]||t.top)>=e.top&&(t[1]||t.bottom)<=e.bottom},modes:{intersect:function(e,t,o){return this.contains(o,[e.pageX,e.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(e,t,o){return Math.max(0,Math.min(o.bottom,t.bottom)-Math.max(o.top,t.top))*Math.max(0,Math.min(o.right,t.right)-Math.max(o.left,t.left))},fit:function(e,t,o){return this.contains(o,t)?1:0},middle:function(e,t,o){return this.contains(o,[t.left+.5*t.width,t.top+.5*t.height])?1:0}},sort:function(e,t){return t.winner-e.winner||e.index-t.index},tolerate:function(t){var i,n,a,l,s,p,c,u,g=0,d=t.interactions.length,h=[r.event.pageX,r.event.pageY],f=r.tolerance||r.modes[r.mode];do if(u=t.interactions[g]){if(!u)return;u.drop=[];s=[];p=u.droppable.length;f&&(a=r.locate(u.proxy));i=0;do if(c=u.droppable[i]){l=e.data(c,r.datakey);n=l.location;if(!n)continue;l.winner=f?f.call(r,r.event,a,n):r.contains(n,h)?1:0;s.push(l)}while(++i<p);s.sort(r.sort);i=0;do if(l=s[i])if(l.winner&&u.drop.length<r.multi){if(!l.active[g]&&!l.anyactive)if(o.drag.hijack(r.event,"dropstart",t,g,l.elem)[0]!==!1){l.active[g]=1;l.anyactive+=1}else l.winner=0;l.winner&&u.drop.push(l.elem)}else if(l.active[g]&&1==l.anyactive){o.drag.hijack(r.event,"dropend",t,g,l.elem);l.active[g]=0;l.anyactive-=1}while(++i<p)}while(++g<d);r.last&&h[0]==r.last.pageX&&h[1]==r.last.pageY?delete r.timer:r.timer=setTimeout(function(){r.tolerate(t)},r.delay);r.last=r.event}};o.dropinit=o.dropstart=o.dropend=r}(jQuery);!function(e,t){e.fn.track=function(o){function r(t,o,r){t.each(function(){var t=e(this);if(window.MutationObserver){var o=t.data("__watcherObserver");if(null==o){o=new MutationObserver(r.fnc);t.data("__watcherObserver",o)}o.observe(this,{attributes:!0,subtree:n.watchChildren,childList:n.watchChildren,characterData:!0})}else r.intervalId=setInterval(r.fnc,interval)})}function i(o){var i=e(this),n=i.data(o);if(n){var a=this;if(n.func){var l=!1,s=0;for(s;s<n.props.length;s++){var p=n.props[s],c="";c=p.startsWith("attr_")?i.attr(p.replace("attr_","")):i.css(p);if(c!=t&&n.vals[s]!=c){n.vals[s]=c;l=!0;break}}if(l){i.untrack(o);n.func.call(a,n,s);r(i,o,n)}}}}var n=e.extend({properties:null,interval:100,id:"_watcher",watchChildren:!1,callback:null},o);return this.each(function(){var t=this,o=e(this),a=function(e,o){i.call(t,n.id)},l={id:n.id,props:n.properties.split(","),vals:[n.properties.split(",").length],func:n.callback,fnc:a,origProps:n.properties,interval:n.interval,intervalId:null};e.each(l.props,function(e){l.vals[e]=o.css(l.props[e])});o.data(n.id,l);r(o,n.id,l)})};e.fn.untrack=function(t){this.each(function(){var o=e(this),r=o.data(t);try{if(window.MutationObserver){var i=o.data("__watcherObserver");if(i){i.disconnect();o.removeData("__watcherObserver")}}else clearInterval(r.intervalId)}catch(n){}});return this};String.prototype.startsWith=function(e){return 0==this.length?!1:e==this.substr(0,e.length)}}(jQuery,void 0);var QRCode;!function(){function e(e){this.mode=p.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var t=[],o=0,r=this.data.length;r>o;o++){var i=this.data.charCodeAt(o);i>65536?(t[0]=240|(1835008&i)>>>18,t[1]=128|(258048&i)>>>12,t[2]=128|(4032&i)>>>6,t[3]=128|63&i):i>2048?(t[0]=224|(61440&i)>>>12,t[1]=128|(4032&i)>>>6,t[2]=128|63&i):i>128?(t[0]=192|(1984&i)>>>6,t[1]=128|63&i):t[0]=i,this.parsedData=this.parsedData.concat(t)}this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function t(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function o(e,t){if(void 0==e.length)throw new Error(e.length+"/"+t);for(var o=0;o<e.length&&0==e[o];)o++;this.num=new Array(e.length-o+t);for(var r=0;r<e.length-o;r++)this.num[r]=e[r+o]}function r(e,t){this.totalCount=e,this.dataCount=t}function i(){this.buffer=[],this.length=0}function n(){return"undefined"!=typeof CanvasRenderingContext2D}function a(){var e=!1,t=navigator.userAgent;return/android/i.test(t)&&(e=!0,aMat=t.toString().match(/android ([0-9]\.[0-9])/i),aMat&&aMat[1]&&(e=parseFloat(aMat[1]))),e}function l(e,t){for(var o=1,r=s(e),i=0,n=f.length;n>=i;i++){var a=0;switch(t){case c.L:a=f[i][0];break;case c.M:a=f[i][1];break;case c.Q:a=f[i][2];break;case c.H:a=f[i][3]}if(a>=r)break;o++}if(o>f.length)throw new Error("Too long data");return o}function s(e){var t=encodeURI(e).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=e?3:0)}e.prototype={getLength:function(){return this.parsedData.length},write:function(e){for(var t=0,o=this.parsedData.length;o>t;t++)e.put(this.parsedData[t],8)}},t.prototype={addData:function(t){var o=new e(t);this.dataList.push(o),this.dataCache=null},isDark:function(e,t){if(0>e||this.moduleCount<=e||0>t||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,o){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++)this.modules[r][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,o),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=t.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,o)},setupPositionProbePattern:function(e,t){for(var o=-1;7>=o;o++)if(!(-1>=e+o||this.moduleCount<=e+o))for(var r=-1;7>=r;r++)-1>=t+r||this.moduleCount<=t+r||(this.modules[e+o][t+r]=o>=0&&6>=o&&(0==r||6==r)||r>=0&&6>=r&&(0==o||6==o)||o>=2&&4>=o&&r>=2&&4>=r?!0:!1)},getBestMaskPattern:function(){for(var e=0,t=0,o=0;8>o;o++){this.makeImpl(!0,o);var r=g.getLostPoint(this);(0==o||e>r)&&(e=r,t=o)}return t},createMovieClip:function(e,t,o){var r=e.createEmptyMovieClip(t,o),i=1;this.make();for(var n=0;n<this.modules.length;n++)for(var a=n*i,l=0;l<this.modules[n].length;l++){var s=l*i,p=this.modules[n][l];p&&(r.beginFill(0,100),r.moveTo(s,a),r.lineTo(s+i,a),r.lineTo(s+i,a+i),r.lineTo(s,a+i),r.endFill())}return r},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=0==e%2);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=0==t%2)},setupPositionAdjustPattern:function(){for(var e=g.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var o=0;o<e.length;o++){var r=e[t],i=e[o];if(null==this.modules[r][i])for(var n=-2;2>=n;n++)for(var a=-2;2>=a;a++)this.modules[r+n][i+a]=-2==n||2==n||-2==a||2==a||0==n&&0==a?!0:!1}},setupTypeNumber:function(e){for(var t=g.getBCHTypeNumber(this.typeNumber),o=0;18>o;o++){var r=!e&&1==(1&t>>o);this.modules[Math.floor(o/3)][o%3+this.moduleCount-8-3]=r}for(var o=0;18>o;o++){var r=!e&&1==(1&t>>o);this.modules[o%3+this.moduleCount-8-3][Math.floor(o/3)]=r}},setupTypeInfo:function(e,t){for(var o=this.errorCorrectLevel<<3|t,r=g.getBCHTypeInfo(o),i=0;15>i;i++){var n=!e&&1==(1&r>>i);6>i?this.modules[i][8]=n:8>i?this.modules[i+1][8]=n:this.modules[this.moduleCount-15+i][8]=n}for(var i=0;15>i;i++){var n=!e&&1==(1&r>>i);8>i?this.modules[8][this.moduleCount-i-1]=n:9>i?this.modules[8][15-i-1+1]=n:this.modules[8][15-i-1]=n}this.modules[this.moduleCount-8][8]=!e},mapData:function(e,t){for(var o=-1,r=this.moduleCount-1,i=7,n=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var l=0;2>l;l++)if(null==this.modules[r][a-l]){var s=!1;n<e.length&&(s=1==(1&e[n]>>>i));var p=g.getMask(t,r,a-l);p&&(s=!s),this.modules[r][a-l]=s,i--,-1==i&&(n++,i=7)}if(r+=o,0>r||this.moduleCount<=r){r-=o,o=-o;break}}}},t.PAD0=236,t.PAD1=17,t.createData=function(e,o,n){for(var a=r.getRSBlocks(e,o),l=new i,s=0;s<n.length;s++){var p=n[s];l.put(p.mode,4),l.put(p.getLength(),g.getLengthInBits(p.mode,e)),p.write(l)}for(var c=0,s=0;s<a.length;s++)c+=a[s].dataCount;if(l.getLengthInBits()>8*c)throw new Error("code length overflow. ("+l.getLengthInBits()+">"+8*c+")");for(l.getLengthInBits()+4<=8*c&&l.put(0,4);0!=l.getLengthInBits()%8;)l.putBit(!1);for(;!(l.getLengthInBits()>=8*c)&&(l.put(t.PAD0,8),!(l.getLengthInBits()>=8*c));)l.put(t.PAD1,8);return t.createBytes(l,a)},t.createBytes=function(e,t){for(var r=0,i=0,n=0,a=new Array(t.length),l=new Array(t.length),s=0;s<t.length;s++){var p=t[s].dataCount,c=t[s].totalCount-p;i=Math.max(i,p),n=Math.max(n,c),a[s]=new Array(p);for(var u=0;u<a[s].length;u++)a[s][u]=255&e.buffer[u+r];r+=p;var d=g.getErrorCorrectPolynomial(c),h=new o(a[s],d.getLength()-1),f=h.mod(d);l[s]=new Array(d.getLength()-1);for(var u=0;u<l[s].length;u++){var y=u+f.getLength()-l[s].length;l[s][u]=y>=0?f.get(y):0}}for(var m=0,u=0;u<t.length;u++)m+=t[u].totalCount;for(var v=new Array(m),C=0,u=0;i>u;u++)for(var s=0;s<t.length;s++)u<a[s].length&&(v[C++]=a[s][u]);for(var u=0;n>u;u++)for(var s=0;s<t.length;s++)u<l[s].length&&(v[C++]=l[s][u]);return v};for(var p={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},c={L:1,M:0,Q:3,H:2},u={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},g={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;g.getBCHDigit(t)-g.getBCHDigit(g.G15)>=0;)t^=g.G15<<g.getBCHDigit(t)-g.getBCHDigit(g.G15);return(e<<10|t)^g.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;g.getBCHDigit(t)-g.getBCHDigit(g.G18)>=0;)t^=g.G18<<g.getBCHDigit(t)-g.getBCHDigit(g.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return g.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,o){switch(e){case u.PATTERN000:return 0==(t+o)%2;case u.PATTERN001:return 0==t%2;case u.PATTERN010:return 0==o%3;case u.PATTERN011:return 0==(t+o)%3;case u.PATTERN100:return 0==(Math.floor(t/2)+Math.floor(o/3))%2;case u.PATTERN101:return 0==t*o%2+t*o%3;case u.PATTERN110:return 0==(t*o%2+t*o%3)%2;case u.PATTERN111:return 0==(t*o%3+(t+o)%2)%2;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new o([1],0),r=0;e>r;r++)t=t.multiply(new o([1,d.gexp(r)],0));return t},getLengthInBits:function(e,t){if(t>=1&&10>t)switch(e){case p.MODE_NUMBER:return 10;case p.MODE_ALPHA_NUM:return 9;case p.MODE_8BIT_BYTE:return 8;case p.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(27>t)switch(e){case p.MODE_NUMBER:return 12;case p.MODE_ALPHA_NUM:return 11;case p.MODE_8BIT_BYTE:return 16;case p.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(41>t))throw new Error("type:"+t);switch(e){case p.MODE_NUMBER:return 14;case p.MODE_ALPHA_NUM:return 13;case p.MODE_8BIT_BYTE:return 16;case p.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},getLostPoint:function(e){for(var t=e.getModuleCount(),o=0,r=0;t>r;r++)for(var i=0;t>i;i++){for(var n=0,a=e.isDark(r,i),l=-1;1>=l;l++)if(!(0>r+l||r+l>=t))for(var s=-1;1>=s;s++)0>i+s||i+s>=t||(0!=l||0!=s)&&a==e.isDark(r+l,i+s)&&n++;n>5&&(o+=3+n-5)}for(var r=0;t-1>r;r++)for(var i=0;t-1>i;i++){var p=0;e.isDark(r,i)&&p++,e.isDark(r+1,i)&&p++,e.isDark(r,i+1)&&p++,e.isDark(r+1,i+1)&&p++,(0==p||4==p)&&(o+=3)}for(var r=0;t>r;r++)for(var i=0;t-6>i;i++)e.isDark(r,i)&&!e.isDark(r,i+1)&&e.isDark(r,i+2)&&e.isDark(r,i+3)&&e.isDark(r,i+4)&&!e.isDark(r,i+5)&&e.isDark(r,i+6)&&(o+=40);for(var i=0;t>i;i++)for(var r=0;t-6>r;r++)e.isDark(r,i)&&!e.isDark(r+1,i)&&e.isDark(r+2,i)&&e.isDark(r+3,i)&&e.isDark(r+4,i)&&!e.isDark(r+5,i)&&e.isDark(r+6,i)&&(o+=40);for(var c=0,i=0;t>i;i++)for(var r=0;t>r;r++)e.isDark(r,i)&&c++;var u=Math.abs(100*c/t/t-50)/5;return o+=10*u}},d={glog:function(e){if(1>e)throw new Error("glog("+e+")");return d.LOG_TABLE[e]},gexp:function(e){for(;0>e;)e+=255;for(;e>=256;)e-=255;return d.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},h=0;8>h;h++)d.EXP_TABLE[h]=1<<h;for(var h=8;256>h;h++)d.EXP_TABLE[h]=d.EXP_TABLE[h-4]^d.EXP_TABLE[h-5]^d.EXP_TABLE[h-6]^d.EXP_TABLE[h-8];for(var h=0;255>h;h++)d.LOG_TABLE[d.EXP_TABLE[h]]=h;o.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),r=0;r<this.getLength();r++)for(var i=0;i<e.getLength();i++)t[r+i]^=d.gexp(d.glog(this.get(r))+d.glog(e.get(i)));return new o(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var t=d.glog(this.get(0))-d.glog(e.get(0)),r=new Array(this.getLength()),i=0;i<this.getLength();i++)r[i]=this.get(i);for(var i=0;i<e.getLength();i++)r[i]^=d.gexp(d.glog(e.get(i))+t);return new o(r,0).mod(e)}},r.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],r.getRSBlocks=function(e,t){var o=r.getRsBlockTable(e,t);if(void 0==o)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);for(var i=o.length/3,n=[],a=0;i>a;a++)for(var l=o[3*a+0],s=o[3*a+1],p=o[3*a+2],c=0;l>c;c++)n.push(new r(s,p));return n},r.getRsBlockTable=function(e,t){switch(t){case c.L:return r.RS_BLOCK_TABLE[4*(e-1)+0];case c.M:return r.RS_BLOCK_TABLE[4*(e-1)+1];case c.Q:return r.RS_BLOCK_TABLE[4*(e-1)+2];case c.H:return r.RS_BLOCK_TABLE[4*(e-1)+3];default:return void 0}},i.prototype={get:function(e){var t=Math.floor(e/8);return 1==(1&this.buffer[t]>>>7-e%8)},put:function(e,t){for(var o=0;t>o;o++)this.putBit(1==(1&e>>>t-o-1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var f=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],y=function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){function t(e,t){var o=document.createElementNS("http://www.w3.org/2000/svg",e);for(var r in t)t.hasOwnProperty(r)&&o.setAttribute(r,t[r]);return o}var o=this._htOption,r=this._el,i=e.getModuleCount();Math.floor(o.width/i),Math.floor(o.height/i),this.clear();var n=t("svg",{viewBox:"0 0 "+String(i)+" "+String(i),width:"100%",height:"100%",fill:o.colorLight});n.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),r.appendChild(n),n.appendChild(t("rect",{fill:o.colorDark,width:"1",height:"1",id:"template"}));for(var a=0;i>a;a++)for(var l=0;i>l;l++)if(e.isDark(a,l)){var s=t("use",{x:String(a),y:String(l)});s.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),n.appendChild(s)}},e.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},e}(),m="svg"===document.documentElement.tagName.toLowerCase(),v=m?y:n()?function(){function e(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function t(e,t){var o=this;if(o._fFail=t,o._fSuccess=e,null===o._bSupportDataURI){var r=document.createElement("img"),i=function(){o._bSupportDataURI=!1,o._fFail&&_fFail.call(o)},n=function(){o._bSupportDataURI=!0,o._fSuccess&&o._fSuccess.call(o)};return r.onabort=i,r.onerror=i,r.onload=n,void(r.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}o._bSupportDataURI===!0&&o._fSuccess?o._fSuccess.call(o):o._bSupportDataURI===!1&&o._fFail&&o._fFail.call(o)}if(this._android&&this._android<=2.1){var o=1/window.devicePixelRatio,r=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(e,t,i,n,a,l,s,p){if("nodeName"in e&&/img/i.test(e.nodeName))for(var c=arguments.length-1;c>=1;c--)arguments[c]=arguments[c]*o;else"undefined"==typeof p&&(arguments[1]*=o,arguments[2]*=o,arguments[3]*=o,arguments[4]*=o);r.apply(this,arguments)}}var i=function(e,t){this._bIsPainted=!1,this._android=a(),this._htOption=t,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=t.width,this._elCanvas.height=t.height,e.appendChild(this._elCanvas),this._el=e,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return i.prototype.draw=function(e){var t=this._elImage,o=this._oContext,r=this._htOption,i=e.getModuleCount(),n=r.width/i,a=r.height/i,l=Math.round(n),s=Math.round(a);t.style.display="none",this.clear();for(var p=0;i>p;p++)for(var c=0;i>c;c++){var u=e.isDark(p,c),g=c*n,d=p*a;o.strokeStyle=u?r.colorDark:r.colorLight,o.lineWidth=1,o.fillStyle=u?r.colorDark:r.colorLight,o.fillRect(g,d,n,a),o.strokeRect(Math.floor(g)+.5,Math.floor(d)+.5,l,s),o.strokeRect(Math.ceil(g)-.5,Math.ceil(d)-.5,l,s)}this._bIsPainted=!0},i.prototype.makeImage=function(){this._bIsPainted&&t.call(this,e)},i.prototype.isPainted=function(){return this._bIsPainted},i.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},i.prototype.round=function(e){return e?Math.floor(1e3*e)/1e3:e},i}():function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){for(var t=this._htOption,o=this._el,r=e.getModuleCount(),i=Math.floor(t.width/r),n=Math.floor(t.height/r),a=['<table style="border:0;border-collapse:collapse;">'],l=0;r>l;l++){a.push("<tr>");for(var s=0;r>s;s++)a.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+i+"px;height:"+n+"px;background-color:"+(e.isDark(l,s)?t.colorDark:t.colorLight)+';"></td>');a.push("</tr>")}a.push("</table>"),o.innerHTML=a.join("");var p=o.childNodes[0],c=(t.width-p.offsetWidth)/2,u=(t.height-p.offsetHeight)/2;c>0&&u>0&&(p.style.margin=u+"px "+c+"px")},e.prototype.clear=function(){this._el.innerHTML=""},e}();QRCode=function(e,t){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:c.H},"string"==typeof t&&(t={text:t}),t)for(var o in t)this._htOption[o]=t[o];"string"==typeof e&&(e=document.getElementById(e)),this._android=a(),this._el=e,this._oQRCode=null,this._oDrawing=new v(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},QRCode.prototype.makeCode=function(e){this._oQRCode=new t(l(e,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(e),this._oQRCode.make(),this._el.title=e,this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=c}();var TC=TC||{};!function(){var e=[],t=[];TC.Map=TC.Map||function(e,t){var r=this;r.$events=$(r);r.isReady=!1;r.isLoaded=!1;r.controls=[];r.activeControl=null;r.layers=[];r.baseLayers=[];r.workLayers=[];r.baseLayer=null;r.vectors=null;var a=0;r.div=TC.Util.getDiv(e);r._$div=$(r.div);r._$div.addClass(TC.Consts.classes.LOADING);r._$div.data("map",r);r._$div.addClass(TC.Consts.classes.MAP);r._markerDeferreds=[];if(!TC.ready){TC.Cfg=$.extend({},TC.Defaults,TC.Cfg);TC.ready=!0}r.options=i(t);r._remainingLayers=0;var l=function(){if(r.options.stateful){s();r.state=r.checkLocation()}r.options.layout&&r.$events.trigger($.Event(TC.Consts.event.LAYOUTLOAD,{map:r}));t&&void 0!==t.workLayers&&(r.options.workLayers=t.workLayers);t&&void 0!==t.baseLayers&&(r.options.baseLayers=t.baseLayers);r._remainingLayers=r.options.baseLayers.length+r.options.workLayers.length;if(r.options.zoomToFeatures){var e=function i(e){clearTimeout(r._zoomToFeaturesTimeout);r._zoomToFeaturesTimeout=setTimeout(function(){r.zoomToFeatures(e.layer.features,{animate:!1});r.off(TC.Consts.event.FEATURESADD,i)},100)};r.on(TC.Consts.event.FEATURESADD,e)}else{var o=function n(e){if(e.layer.isBase&&e.layer===r.baseLayer){"undefined"!=typeof r.state&&r.setExtent(r.state.ext);r.off(TC.Consts.event.LAYERADD,n)}};r.on(TC.Consts.event.LAYERADD,o)}r.crs=r.options.crs;r.wrap=new TC.wrap.Map(r);TC.loadJS(!(TC.isLegacy?window[TC.Consts.PROJ4JSOBJ_LEGACY]:window[TC.Consts.PROJ4JSOBJ]),[TC.url.proj4js],function(){
TC.loadJSInOrder(!(TC.isLegacy?window[TC.Consts.OLNS_LEGACY]:window[TC.Consts.OLNS]),[TC.url.ol,TC.url.olConnector],function(){TC.loadProjDef(r.options.crs,function(){r.wrap.setMap();for(var e in r.options.controls)if(r.options.controls[e])if("boolean"==typeof r.options.controls[e])r.addControl(e);else{var t=r.options.controls[e];e=e.substr(0,1).toUpperCase()+e.substr(1);r.addControl(e,t)}r.on(TC.Consts.event.BEFORELAYERUPDATE,y);r.on(TC.Consts.event.LAYERUPDATE,m);var o,i,n;for(o=0;o<r.options.baseLayers.length;o++){n=r.options.baseLayers[o];if("string"==typeof n)for(i=0;i<TC.Cfg.availableBaseLayers.length;i++)if(TC.Cfg.availableBaseLayers[i].id===n){n=TC.Cfg.availableBaseLayers[i];break}r.addLayer($.extend({},n,{isBase:!0,map:r}))}var a=function(e){e.isRaster()&&!e.names&&e.setVisibility(!1)};for(o=0;o<r.options.workLayers.length;o++){var l=!1;n=$.extend({},r.options.workLayers[o],{map:r});if(r.state&&n.type!==TC.Consts.layerType.VECTOR)for(var o=0;o<r.state.layers.length;o++){var s=r.state.layers[o];if(s.u===n.url&&n.layerNames.indexOf(s.n)>=0){n.hideTitle=s.hideTitle;n.renderOptions={opacity:s.o,hide:!s.v};s.Added=!0;break}l=!0;r._remainingLayers--}l||$.when(r.addLayer(n)).then(a)}r.state&&r.state.layers&&r.state.layers.forEach(function(e){if(!e.Added){var t=e.o,o=e.v;r.addLayer({id:TC.getUID(),url:TC.Util.isOnCapabilities(e.u,e.u.indexOf(window.location.protocol)<0)||e.u,hideTitle:e.h,layerNames:e.n?e.n.split(","):"",renderOptions:{opacity:e.o,hide:!e.v}}).then(function(e){e.wrap.$events.on(TC.Consts.event.TILELOADERROR,function(e){var t=this.parent;(401===e.error.code||403===e.error.code)&&t.map.toast(e.error.text,{type:TC.Consts.msgType.ERROR});t.map.removeLayer(t)});var r=e.wrap.getRootLayerNode();e.title=r.Title||r.title;e.setOpacity(t);e.setVisibility(o)})}});r.isReady=!0;r.$events.trigger($.Event(TC.Consts.event.MAPREADY))})})});r.on(TC.Consts.event.FEATURECLICK,function(e){r.activeControl&&r.activeControl.isExclusive()||e.feature.showPopup()});r.on(TC.Consts.event.NOFEATURECLICK,function(e){e.layer._noFeatureClicked=!0;var t,o,i=!0;for(t=0;t<r.workLayers.length;t++){o=r.workLayers[t];if(o instanceof TC.layer.Vector&&!o._noFeatureClicked){i=!1;break}}if(i){for(t=0;t<r.workLayers.length;t++){o=r.workLayers[t];o instanceof TC.layer.Vector&&delete o._noFeatureClicked}for(var n=r.getControlsByClass(TC.control.Popup),t=0,a=n.length;a>t;t++)n[t].hide()}})};r.one(TC.Consts.event.MAPREADY,function(){g(r._$div)});r.one(TC.Consts.event.MAPLOAD,function(){r._$div.removeClass(TC.Consts.classes.LOADING)});var s=function(){var e=4;window.jsonpack||TC.syncLoadJS(TC.apiLocation+TC.Consts.url.JSONPACK);var t=[TC.Consts.event.LAYERADD,TC.Consts.event.LAYERORDER,TC.Consts.event.LAYERREMOVE,TC.Consts.event.LAYERVISIBILITY,TC.Consts.event.ZOOM,TC.Consts.event.BASELAYERCHANGE].join(" ");r.on(TC.Consts.event.MAPLOAD,function(){r.loaded(function(){r.replaceCurrent=!0;u();r.on(t,$.proxy(u,r));var o;r.on(TC.Consts.event.LAYEROPACITY,function(e){clearTimeout(o);o=setTimeout(function(){u(e)},500)});window.addEventListener("popstate",function(o){var i;i=r.loadingCtrl&&r.loadingCtrl.addWait();setTimeout(function(){if(o&&null!=o.state){r.off(t,$.proxy(u,r));$.when(f(o.state)).then(function(){setTimeout(function(){r.on(t,$.proxy(u,r))},200);r.loadingCtrl&&r.loadingCtrl.removeWait(i)})}},e)})})})},p=null,c=null,u=function(e){var t=".tc",o=d();if(r.replaceCurrent){window.history.replaceState(o,null,null);delete r.replaceCurrent}else{r.lastEventType=e.type;var i=function(){c=p;p=TC.Util.utf8ToBase64(o);window.history.pushState(o,null,window.location.href.split("#").shift()+"#"+p)};if(e)switch(!0){case e.type==TC.Consts.event.BASELAYERCHANGE.replace(t,""):case e.type==TC.Consts.event.ZOOM.replace(t,""):case e.type==TC.Consts.event.LAYERORDER.replace(t,""):i();break;case e.type.toLowerCase().indexOf("LAYER".toLowerCase())>-1:e.layer.type==TC.Consts.layerType.WMS&&i()}}},d=function(){for(var e={},t=r.getExtent(),o=0;o<t.length;o++)Math.abs(t[o])>180&&(t[o]=Math.floor(1e3*t[o])/1e3);e.ext=t;e.base=r.getBaseLayer().id;e.layers=[];for(var i,n,o=0;o<r.workLayers.length;o++){i=r.workLayers[o];if("WMS"==i.type&&!i.options.stateless&&i.layerNames&&i.layerNames.length){n={u:TC.Util.isOnCapabilities(i.url),n:$.isArray(i.names)?i.names.join(","):i.names,o:i.getOpacity(),v:i.getVisibility(),h:i.options.hideTitle};e.layers.push(n)}}window.jsonpack||TC.syncLoadJS(TC.apiLocation+TC.Consts.url.JSONPACK);return jsonpack.pack(e)},h=function(){var e=[];r.workLayers.forEach(function(t){"vector"!=t.type&&e.push(t)});for(var t=0;t<e.length;t++)r.removeLayer(e[t])},f=function(e){var t=new $.Deferred,o=[];r.loadingctrl||(r.loadingCtrl=r.getControlsByClass("TC.control.LoadingIndicator")[0]);r.hasWait||(r.hasWait=r.loadingCtrl&&r.loadingCtrl.addWait());var i,n=function(){r.loadingCtrl&&r.loadingCtrl.removeWait(r.hasWait);delete r.hasWait;t.resolve()};if("string"==typeof e)try{i=jsonpack.unpack(e)}catch(a){try{i=JSON.parse(e)}catch(l){TC.error(TC.Util.getLocaleString(r.options.locale,"mapStateNotValid"))}}else i=e;if(i){i.base!=r.getBaseLayer().id&&r.setBaseLayer(i.base);i.ext&&o.push(r.setExtent(i.ext));h();i.layers=i.layers||i.capas||[];if(i.layers.length>0)for(var s=0;s<i.layers.length;s++){var p=i.layers[s],c=p.o,u=p.v,g=!1;for(j=0;j<r.options.workLayers.length;j++){var d=$.extend({},r.options.workLayers[j],{map:r});if(d.type!==TC.Consts.layerType.VECTOR&&p.u===d.url&&d.layerNames.indexOf(p.n)){g=!0;d.renderOptions.opacity=p.o;d.renderOptions.hide=!p.v;o.push(r.addLayer(d).then(setVisibility));break}}g||o.push(r.addLayer({id:TC.getUID(),url:TC.Util.isOnCapabilities(p.u,p.u.indexOf(window.location.protocol)<0)||p.u,hideTitle:p.h,layerNames:p.n?p.n.split(","):"",renderOptions:{opacity:p.o,hide:!p.v}}).then(function(e){var t=e.wrap.getRootLayerNode();e.title=t.Title||t.title;e.setOpacity(c,!0);e.setVisibility(u)}))}$.when.apply($,o).done(function(){n()})}return t};n.getMapState=function(){var e=d();return TC.Util.utf8ToBase64(e)};n.getPreviousMapState=function(){return c};n.checkLocation=function(){var e=window.location.hash;if(e&&e.length>1){e=e.substr(1);var t;try{t=jsonpack.unpack(TC.Util.base64ToUtf8(e))}catch(o){try{t=JSON.parse(TC.Util.base64ToUtf8(e))}catch(i){TC.error(TC.Util.getLocaleString(r.options.locale,"mapStateNotValid"),TC.Consts.msgErrorMode.TOAST);return}}if(t){var n=!1;if(!t.hasOwnProperty("ext")){n=!0;t.ext=r.options.initialExtent}if(!t.hasOwnProperty("base")){n=!0;t.base=r.options.defaultBaseLayer}if(t.hasOwnProperty("layers"))for(var a=t.layers.length-1;a>=0;a--)if(t.layers[a]&&t.layers[a].hasOwnProperty("u")&&t.layers[a].hasOwnProperty("n")){if(!t.layers[a].hasOwnProperty("o")||!t.layers[a].hasOwnProperty("v")||!t.layers[a].hasOwnProperty("h")){n=!0;jQuery.extend(t.layers[a],{o:t.layers[a].o||1,v:t.layers[a].v||!0,h:t.layers[a].h||!1})}}else{n=!0;t.layers.length=t.layers.length-1}else{n=!0;t.layers=[]}n&&TC.error(TC.Util.getLocaleString(r.options.locale,"mapStateNotValid"),TC.Consts.msgErrorMode.TOAST);return t}TC.error(TC.Util.getLocaleString(r.options.locale,"mapStateNotValid"),TC.Consts.msgErrorMode.TOAST)}};var y=function(e){if(0>=a){a=0;r.$events.trigger($.Event(TC.Consts.event.BEFOREUPDATE))}a+=1},m=function(e){a-=1;if(0>=a){a=0;r.$events.trigger($.Event(TC.Consts.event.UPDATE))}},v=function(e){var t=$.Deferred();if("string"==typeof e){var o=e,r=function(e,t){var o=$.Deferred();$.ajax({type:"HEAD",url:e,complete:function(r,i){o.resolve({resource:t,found:404!==r.status,url:e})}});return o.promise()},i=/^(https?:)?\/\//i.test(o),n=function(t,n){var p=$.Deferred(),c=[s+o+"/"+n,l+o+"/"+n,l+"responsive/"+n];i&&c.unshift(o+"/"+n);var u=0;!function g(o){r(c[o],t).done(function(t){t.found?p.resolve(a(e,t)):g(++o)})}(u);return p.promise()},a=function(e,t){if(!(t.resource in e)){var r=($.extend(!0,{},e),t.found?t.url:l+o+"/"+p[t.resource]);e[t.resource]=r}return e},l=TC.apiLocation+"TC/layout/",s="layout/",e={},p={script:"script.js",style:"style.css",markup:"markup.html",config:"config.json",i18n:"resources"},c=Object.keys(p).length;for(var u in p)n(u,p[u]).done(function(e){Object.keys(e).length===c&&t.resolve(e)})}else t.resolve(e);return t.promise()};TC.i18n=TC.i18n||{};TC.i18n.loadResources=TC.i18n.loadResources||function(e,t,o){var r;e?r=$.ajax({url:t+o+".json",type:"GET",dataType:"json",success:function(e){TC.i18n[o]=TC.i18n[o]||{};$.extend(TC.i18n[o],e);"undefined"!=typeof dust&&dust.i18n.add(o,TC.i18n[o])}}):dust.i18n.add(o,TC.i18n[o]);return r};var C=[],T=r.options.locale,_=$.Deferred();C.push(_);TC.loadJSInOrder(!window.dust||!window.dust.i18n,TC.url.templating,function(){if(T){dust.i18n.setLanguages([T]);C.push(TC.i18n.loadResources(!TC.i18n[T],TC.apiLocation+"TC/resources/",T))}_.resolve()});$.when.apply(this,C).always(function(){r.options.layout?v(r.options.layout).done(function(e){r.$events.trigger($.Event(TC.Consts.event.BEFORELAYOUTLOAD,{map:r}));var o;"string"==typeof e?o={href:$.trim(e)}:(e.hasOwnProperty("config")||e.hasOwnProperty("markup")||e.hasOwnProperty("style")||e.hasOwnProperty("ie8Style")||e.hasOwnProperty("script")||e.hasOwnProperty("href")||e.hasOwnProperty("i18n"))&&(o=$.extend({},e));o.href&&(o.href+=o.href.match(/\/$/)?"":"/");o.config=o.config||o.href+"config.json";o.markup=o.markup||o.href+"markup.html";o.style=o.style||o.href+"style.css";o.ie8Style=o.ie8Style||o.href+"ie8.css";o.script=o.script||o.href+"script.js";o.i18n=o.i18n||o.href+"resources";o.i18n&&(o.i18n+=o.i18n.match(/\/$/)?"":"/");r.layout=o;var n=[],a=$.Deferred();n.push(a);o.config?n.push($.ajax({url:o.config,type:"GET",dataType:"json",success:function(e){a.resolve(e.i18n);r.options=i(e,t)},error:function(e,t,o){TC.error(t+": "+o);a.resolve(!1)}})):a.resolve(!1);if(o.markup){var s;if(T){s=$.Deferred();n.push(s)}n.push($.ajax({url:o.markup,type:"GET",dataType:"html",success:function(e){a.then(function(t){if(t&&T)TC.i18n.loadResources(!0,o.i18n,T).always(function(){var t="tc-markup";dust.loadSource(dust.compile(e,t));dust.render(t,null,function(e,t){if(e){TC.error(e);s.reject()}else{r._$div.append(t);s.resolve()}})});else{r._$div.append(e);T&&s.resolve()}})},error:function(){s.reject()}}))}$.when.apply(this,n).always(function(){TC.loadJS(o.script,o.script,function(){g(r._$div);o.style&&TC.loadCSS(o.style);!Modernizr.canvas&&o.ie8Style&&TC.loadCSS(o.ie8Style);l()})})}):l()});r.$events.on(TC.Consts.event.UPDATEPARAMS,function(e){o(e.layer)});r.$events.on(TC.Consts.event.ZOOM,function(){for(var e=0;e<r.workLayers.length;e++)o(r.workLayers[e])});var S=TC.error;TC.error=function(e,t,o){if(t){var i=function(e,t,o){switch(t){case TC.Consts.msgErrorMode.TOAST:if(!r.toast){console.warn("No existe el objeto Toast");return}r.toast(e,{type:TC.Consts.msgType.ERROR,duration:2*TC.Cfg.toastDuration});break;case TC.Consts.msgErrorMode.EMAIL:JL("onerrorLogger").fatalException(o?{msg:o,errorMsg:e}:e,null);break;case TC.Consts.msgErrorMode.CONSOLE:default:console.error(e)}};if($.isArray(t))for(var n=0;n<t.length;n++)i(e,t[n],o);else i(e,t,o)}else{S(e);r.toast(e,{type:TC.Consts.msgType.ERROR,duration:2*TC.Cfg.toastDuration})}}};var o=function(e){e.type===TC.Consts.layerType.WMS&&(e.tree=null)},r=function(e,t){var o=$.map(e,function(e){var o={};e&&(o[t]=e[t]);return o}),r={};r[t]=TC.Cfg[t];o.unshift(r);if("baseLayers"===t&&o[1].baseLayers){r=o[1];for(var i=0;i<r.baseLayers.length;i++)"object"==typeof r.baseLayers[i]&&$.extend(r.baseLayers[i],$.grep(TC.Cfg.availableBaseLayers,function(e){return e.id===r.baseLayers[i].id})[0])}else{o.unshift(!0);r=$.extend.apply(this,o)}return r[t]},i=function(){var e=$.extend.apply(this,$.merge([!0,{},TC.Cfg],arguments));e.baseLayers=r(arguments,"baseLayers");e.workLayers=r(arguments,"workLayers");return e},n=TC.Map.prototype;n.addLayer=function(o,r){var i=this,n=d(o);if(n){var a;for(a=0,len=e.length;a<len&&d(e[a]);a++);e.splice(a,0,o);t.splice(a,0,r)}else{e.push(o);t.push(r)}for(var l=new $.Deferred,s=function(e){return"string"==typeof e?e:e.id},p=s(o),c=!1,u=0;u<i.options.baseLayers.length&&!c;u++)s(i.options.baseLayers[u])===p&&(c=!0);for(var u=0;u<i.options.workLayers.length&&!c;u++)s(i.options.workLayers[u])===p&&(c=!0);c||i.isLoaded||(i._remainingLayers=i._remainingLayers+1);var g,h,f;if(n){h=!TC.layer||!TC.layer.Raster;f=TC.apiLocation+"TC/layer/Raster.js"}else{h=!TC.layer||!TC.layer.Vector;f=TC.apiLocation+"TC/layer/Vector.js"}TC.loadJS(h,[f],function(){if("string"==typeof o){for(var n=0;n<TC.Cfg.availableBaseLayers.length;n++)if(TC.Cfg.availableBaseLayers[n].id===o){g=new TC.layer.Raster($.extend({},TC.Cfg.availableBaseLayers[n],{map:i}));break}}else if(o instanceof TC.Layer){g=o;g.map=i}else{o.map=i;g=o.type===TC.Consts.layerType.VECTOR||o.type===TC.Consts.layerType.KML||o.type===TC.Consts.layerType.WFS?new TC.layer.Vector(o):new TC.layer.Raster(o)}var a=$.inArray(o,e);0>a&&(a=0);e[a]=g;t[a]=r;i.$events.trigger($.Event(TC.Consts.event.BEFORELAYERADD,{layer:g}));$.when(i.wrap.getMap(),g.wrap.getLayer()).then(function(){var o=$.grep(e,function(e){return e.wrap&&e.wrap.isNative(e.wrap.getLayer())});if(o.length===e.length)for(var r=e.length,n=0;r>n;n++){var a=e.shift(),s=t.shift(),p=-1;d(a)&&(p=i.wrap.indexOfFirstVector());-1===p&&(p=i.wrap.getLayerCount());if(a)if(a.isCompatible(i.crs)){i.layers[i.layers.length]=a;if(a.isBase){i.state?a.isDefault=i.state.base===a.id:"string"==typeof i.options.defaultBaseLayer?a.isDefault=i.options.defaultBaseLayer===a.id:"number"==typeof i.options.defaultBaseLayer&&(a.isDefault=i.options.defaultBaseLayer===i.baseLayers.length);if(a.isDefault){i.wrap.setBaseLayer(a.wrap.getLayer());i.baseLayer=a}i.baseLayers[i.baseLayers.length]=a;i.options.baseLayers.length!==i.baseLayers.length||i.baseLayer||i.wrap.setBaseLayer(i.baseLayers[0].wrap.getLayer())}else{i.wrap.insertLayer(a.wrap.getLayer(),p);i.workLayers[i.workLayers.length]=a}i.$events.trigger($.Event(TC.Consts.event.LAYERADD,{layer:a}));$.isFunction(s)&&s(a)}else{var c,u='Layer "'+a.title+'" ("'+a.names+'"): ';c=a.isValidFromNames()?"layerSrsNotCompatible":"layerNameNotValid";u+=TC.Util.getLocaleString(i.options.locale,c);TC.error(u);i.$events.trigger($.Event(TC.Consts.event.LAYERERROR,{layer:a,reason:c}))}i._remainingLayers=i._remainingLayers-1;if(0===i._remainingLayers&&!i.isLoaded){i.isLoaded=!0;i.$events.trigger($.Event(TC.Consts.event.MAPLOAD))}}l.resolve(g)})});return l.promise()};n.removeLayer=function(e){var t=this,o=new $.Deferred;$.when(e.wrap.getLayer()).then(function(r){for(var i=0;i<t.layers.length;i++)t.layers[i]===e&&t.layers.splice(i,1);if(e.isBase){for(var i=0;i<t.baseLayers.length;i++)if(t.baseLayers[i]===e){t.baseLayers.splice(i,1);t.baseLayer===e&&t.setBaseLayer(t.baseLayers[0]);break}}else{for(var i=0;i<t.workLayers.length;i++)if(t.workLayers[i]===e){t.workLayers.splice(i,1);break}e===t.vectors&&(t.vectors=null)}t.wrap.removeLayer(r);t.$events.trigger($.Event(TC.Consts.event.LAYERREMOVE,{layer:e}));o.resolve(e)});return o};n.insertLayer=function(e,t,o){for(var r=this,i=-1,n=0;n<r.layers.length;n++)if(e===r.layers[n]){i=n;break}var a=[];a.push(e.wrap.getLayer());var l=r.layers[t];l&&a.push(l.wrap.getLayer());$.when.apply(this,a).then(function(n,a){var l=-1;l=a?r.wrap.getLayerIndex(a):r.wrap.getLayerCount();if(l>=0){e.map=r;r.wrap.insertLayer(n,l);i>-1&&r.layers.splice(i,1);r.layers.splice(t,0,e);r.workLayers=$.grep(r.layers,function(e){return!e.isBase});r.$events.trigger($.Event(TC.Consts.event.LAYERORDER,{layer:e,oldIndex:i,newIndex:t}))}$.isFunction(o)&&o()})};n.setLayerIndex=function(e,t){this.wrap.setLayerIndex(e.wrap.getLayer(),t)};n.putLayerOnTop=function(e){var t=this,o=t.wrap.getLayerCount();t.setLayerIndex(e,o-1)};n.setBaseLayer=function(e,t){var o=this,r=null,i=!1;if("string"==typeof e){var n;for(n=0;n<o.layers.length;n++)if(o.layers[n].id===e){e=o.layers[n];i=!0;break}if(!i)for(n=0;n<TC.Cfg.availableBaseLayers.length;n++)if(TC.Cfg.availableBaseLayers[n].id===e){e=o.addLayer($.extend(!0,{},TC.Cfg.availableBaseLayers[n],{isDefault:!0,map:o}));i=!0;break}}else i=$.inArray(e,o.layers)>=0;if(i){o.$events.trigger($.Event(TC.Consts.event.BEFOREBASELAYERCHANGE,{oldLayer:o.getBaseLayer(),newLayer:e}));r=e;$.when(o.wrap.getMap(),e).then(function(e,r){$.when(r.wrap.getLayer()).then(function(e){o.wrap.setBaseLayer(e).then(function(){o.baseLayer=r;o.$events.trigger($.Event(TC.Consts.event.BASELAYERCHANGE,{layer:r}));$.isFunction(t)&&t()})})})}else TC.error("Base layer is not in layers collection");return r};n.on=function(e,t){var o=this;o.$events.on(e,t);return o};n.one=function(e,t){var o=this;o.$events.one(e,t);return o};n.off=function(e,t){var o=this;o.$events.off(e,t);return o};n.ready=function(e){var t=this;$.isFunction(e)&&(t.isReady?e():t.one(TC.Consts.event.MAPREADY,e))};n.loaded=function(e){var t=this;$.isFunction(e)&&(t.isLoaded?e():t.one(TC.Consts.event.MAPLOAD,e))};n.getLayerTree=function(){var e=this,t={baseLayers:[],workLayers:[]};e.baseLayer&&(t.baseLayers[0]=e.baseLayer.getTree());for(var o=0;o<e.workLayers.length;o++){var r=e.workLayers[o].getTree();r&&t.workLayers.unshift(r)}return t};n.addControl=function(e,t){var o=this,r=new $.Deferred,i=function(e){o.controls.push(e);e.register(o);$dv=$(e.div);0===$dv.parent().length&&$dv.appendTo(o._$div);o.$events.trigger($.Event(TC.Consts.event.CONTROLADD,{control:e}));r.resolve(e)};if("string"==typeof e){e=e.substr(0,1).toUpperCase()+e.substr(1);TC.loadJS(!TC.Control||!TC.control[e],[TC.apiLocation+"TC/control/"+e],function(){i(new TC.control[e](null,t))})}else i(e);return r.promise()};n.getControlsByClass=function(e){var t=this,o=[],r=e;if("string"==typeof e){r=window;for(var i=e.split("."),n=0;n<i.length;n++){r=r[i[n]];if(!r)break}}if($.isFunction(r))for(var n=0;n<t.controls.length;n++){var a=t.controls[n];a instanceof r&&o.push(a)}return o};n.getDefaultControl=function(){var e=this.getControlsByClass("TC.control.FeatureInfo");return e&&e.length?e[0]:null};n.getLoadingIndicator=function(){var e=null,t=this.getControlsByClass("TC.control.LoadingIndicator");t.length&&(e=t[0]);return e};n.setExtent=function(e,t){return this.wrap.setExtent(e,t)};n.getExtent=function(){return this.wrap.getExtent()};n.setCenter=function(e,t){this.wrap.setCenter(e,t)};n.getCenter=function(){return this.wrap.getCenter()};n.setRotation=function(e){this.wrap.setRotation(e)};n.getRotation=function(){return this.wrap.getRotation()};n.getViewHTML=function(){return this.wrap.getViewport()};n.getCoordinateFromPixel=function(e){return this.wrap.getCoordinateFromPixel(e)};n.getPixelFromCoordinate=function(e){return this.wrap.getPixelFromCoordinate(e)};n.zoomToFeatures=function(e,t){var o=this;if(e.length>0){var r=[1/0,1/0,-(1/0),-(1/0)],i=t||{},n=i.pointBoundsRadius||o.options.pointBoundsRadius;n=o.wrap.isGeo()?n/TC.Util.getMetersPerDegree(o.getExtent()):n;var a=i.extentMargin;"number"!=typeof a&&(a=o.options.extentMargin);for(var l=0;l<e.length;l++){var s=e[l].getBounds();if(s){r[0]=Math.min(r[0],s[0]);r[1]=Math.min(r[1],s[1]);r[2]=Math.max(r[2],s[2]);r[3]=Math.max(r[3],s[3])}}if(r[2]-r[0]===0){r[0]=r[0]-n;r[2]=r[2]+n}if(r[3]-r[1]===0){r[1]=r[1]-n;r[3]=r[3]+n}if(o.options.extentMargin){var p=(r[2]-r[0])*a/2,c=(r[3]-r[1])*a/2;r[0]=r[0]-p;r[1]=r[1]-c;r[2]=r[2]+p;r[3]=r[3]+c}if(o.options.maxExtent){r[0]=Math.max(r[0],o.options.maxExtent[0]);r[1]=Math.max(r[1],o.options.maxExtent[1]);r[2]=Math.min(r[2],o.options.maxExtent[2]);r[3]=Math.min(r[3],o.options.maxExtent[3])}o.wrap.setExtent(r,i);o.$events.trigger($.Event(TC.Consts.event.ZOOMTO,{extent:r}))}};n.zoomToMarkers=function(e){var t=this;$.when.apply(this,t._markerDeferreds).then(function(){for(var o=[],r=0;r<t.workLayers.length;r++){var i=t.workLayers[r];if(i.type===TC.Consts.layerType.VECTOR)for(var n=0;n<i.features.length;n++){var a=i.features[n];a instanceof TC.feature.Marker&&(o[o.length]=a)}}for(var r=0;r<arguments.length;r++)o[o.length]=arguments[r];t.zoomToFeatures(o,e);t._markerDeferreds=[]})};n.getLayer=function(e){var t=this,o=null;if("string"==typeof e){for(var r=0;r<t.layers.length;r++)if(t.layers[r].id===e){o=t.layers[r];break}}else TC.Layer&&e instanceof TC.Layer&&(o=e);return o};var a=function(e){var t;if(e.vectors)t=e.vectors;else{t=e.addLayer({id:TC.getUID(),title:TC.i18n[e.options.locale].vectors,type:TC.Consts.layerType.VECTOR});e.vectors=t;$.when(t).then(function(t){e.vectors=t})}return t};n.addPoint=function(e,t){var o=this;if(t&&t.layer){var r=o.getLayer(t.layer);r&&r.addPoint(e,t)}else $.when(a(o)).then(function(o){o.addPoint(e,t)})};n.addMarker=function(e,t){var o=this;if(t&&t.layer){var r=o.getLayer(t.layer);r&&o._markerDeferreds.push(r.addMarker(e,t))}else{var i=new $.Deferred;o._markerDeferreds.push(i);$.when(a(o)).then(function(o){$.when(o.addMarker(e,t)).then(function(e){i.resolve(e)})})}};n.addPolyline=function(e,t){var o=this;if(t&&t.layer){var r=o.getLayer(t.layer);r&&t.layer.addPolyline(e,t)}else $.when(a(o)).then(function(o){o.addPolyline(e,t)})};n.addPolygon=function(e,t){var o=this;if(t&&t.layer){var r=o.getLayer(t.layer);r&&t.layer.addPolygon(e,t)}else $.when(a(o)).then(function(o){o.addPolygon(e,t)})};n.getBaseLayer=function(){return this.baseLayer||this.baseLayers[0]};n.getResolutions=function(){return this.getBaseLayer().getResolutions()};n.getResolution=function(){return this.wrap.getResolution()};n.setResolution=function(e){this.wrap.setResolution(e)};n.exportFeatures=function(e,t){var o=this,r=t||{},i=o.getLoadingIndicator(),n=i&&i.addWait(),a=o.wrap.exportFeatures(e,r),l=TC.Consts.mimeType[r.format],s=r.format||"";TC.Util.downloadFile((r.fileName||TC.getUID())+"."+s.toLowerCase(),l,a);i&&i.removeWait(n)};var l="tc-toast-container",s="tc-toast",p={},c=function(){var e=$(this),t=e.parent("."+l),o=e.html();e.addClass(TC.Consts.classes.HIDDEN);void 0!==p[o]&&(p[o]=void 0);setTimeout(function(){e.remove();t.find("."+s).length||t.remove()},1e3)};n.toast=function(e,t){var o=this,r=t||{},i=r.duration||TC.Cfg.toastDuration,n=p[e];if(n){clearTimeout(n.timeout);n.$toast.remove()}var a=o._$div.find("."+l);a.length||(a=$("<div>").addClass(l).appendTo(o._$div));n=p[e]={$toast:$("<div>").addClass(s).html(e).appendTo(a).on(TC.Consts.event.CLICK,c)};var u="";switch(r.type){case TC.Consts.msgType.INFO:u=TC.Consts.classes.INFO;break;case TC.Consts.msgType.WARNING:u=TC.Consts.classes.WARNING;break;case TC.Consts.msgType.ERROR:u=TC.Consts.classes.ERROR}n.$toast.addClass(u);n.timeout=setTimeout(function(){c.call(n.$toast)},i)};var u=!1,g=function(e){if(/iPad/i.test(navigator.userAgent)){var t=window.innerHeight,o=e.height(),r=Modernizr.mq("only screen and (orientation : landscape)")?20:0;o===t+r&&(u=!0)}var i=function(){e.toggleClass(TC.Consts.classes.IPAD_IOS7_FIX,Modernizr.mq("only screen and (orientation : landscape)"))};if(u){i();$(window).on("resize",i)}else $(window).off("resize",i)},d=function(e){return"string"==typeof e||e.type!==TC.Consts.layerType.VECTOR&&e.type!==TC.Consts.layerType.KML&&e.type!==TC.Consts.layerType.WFS};n.exportImage=function(){var e=this,t=null,o="El mapa actual no es compatible con la exportaci\xf3n de im\xe1genes",r=e.wrap.getViewport({synchronous:!0}).getElementsByTagName("canvas")[0];if(r&&e.options.crossOrigin)try{t=r.toDataURL()}catch(i){TC.error(o+": "+i.message)}else TC.error(o);return t}}();var TC=TC||{};!function(e,t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):e.Util=t()}(TC,function(){Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};var e=Number.prototype.toLocaleString;Number.prototype.toLocaleString=function(t,o){if("eu-ES"!=t||TC.Util.detectIE())return e.apply(this,arguments);var r=e.apply(this,arguments);r=r.replace(/\,/g,".");Math.floor(this)==this&&Number.isInteger(Math.floor(this))||(r=r.replace(/.([^.]*)$/,",$1"));return r};var t={},o={},r=["Capability","Request","GetMap","DCPType","0","HTTP","Get","OnlineResource"],a=["OperationsMetadata","GetTile","DCP","HTTP","Get","0","href"],l=function(e,t,o){return o<t.length-1?e.hasOwnProperty(t[o])?l(e[t[o]],t,++o):null:e[t[o]]},s={getMapLocale:function(e){return e.options&&e.options.locale&&e.options.locale.replace("_","-")||"es-ES"},regex:{PROTOCOL:/(^https?:)/i},isOnCapabilities:function(e){var t=2==arguments.length?arguments[1]:!0,o=t?e:e.replace(TC.Util.regex.PROTOCOL,"");if(t){if(TC.capabilities[o])return e}else for(var i in TC.capabilities)if(i.replace(TC.Util.regex.PROTOCOL,"")==o)return i;for(i in TC.capabilities){var n=l(TC.capabilities[i],r,0)||l(TC.capabilities[i],a,0);if(n&&t&&e==n)return n;if(n&&e.replace(TC.Util.regex.PROTOCOL,"")==n.replace(TC.Util.regex.PROTOCOL,""))return n}return e},reqGetMapOnCapabilities:function(e){var t=2==arguments.length?arguments[1]:!0,o=(t?e:e.replace(TC.Util.regex.PROTOCOL,""),function(e){var o=l(e,r,0)||l(e,a,0);return o?t?o.split("?")[0]:o.split("?")[0].replace(TC.Util.regex.PROTOCOL,""):null});return TC.capabilities[e]?o(TC.capabilities[e]):null},getFNFromString:function(e){var t=window,o=e.split(".");for(i=0;i<o.length-1;i++){t=t[o[i]];if(void 0==t)return}return t[o[o.length-1]]},isURL:function(e){return/^(http|https|ftp|mailto)\:\/\//i.test(e)},isSecureURL:function(e){return/^(f|ht)tps?:\/\//i.test(e)?/^(f|ht)tps:\/\//i.test(e):!0},isSameOrigin:function(e){var t=0!==e.indexOf("http")&&0!==e.indexOf("//"),o=!t&&e.match(TC.Consts.url.SPLIT_REGEX);if(o){var r=window.location,i=o[1];t=(i==r.protocol||void 0==i)&&o[3]==r.hostname;var n=o[4],a=r.port;(80!=n&&""!==n||"80"!=a&&""!==a)&&(t=t&&n==a)}return t},formatNumber:function(e,t){var o=typeof e;if("number"===o)return e.toLocaleString(t);if("string"===o){n=parseFloat(e);if(n===new Number(e).valueOf())return n.toLocaleString(t)}return e},addProtocol:function(e){var t=e;e&&0===e.indexOf("//")&&(t=location.protocol+e);return t},getDiv:function(e){var t;t="string"==typeof e?document.getElementById(e):1==$(e).length?e:document.createElement("div");return t},getScriptLocation:function(){var e,t;if(document.currentScript)t=document.currentScript;else{var o=document.getElementsByTagName("script");t=o[o.length-1]}e=t.getAttribute("src");return e?e.substr(0,e.lastIndexOf("/")+1):""},getBackgroundUrlFromCss:function(e){var o="";if(void 0!==t[e])o=t[e];else{var r=$('<div style="display:none">').addClass(e).appendTo("body"),i=/^url\(['"]?(.*?)['"]?\)$/gi.exec(r.css("background-image"));i&&i.length>1&&(o=i[i.length-1]);r.remove();t[e]=o}return o},getPointIconUrl:function p(e){var t=null;if(e.url)t=e.url;else{var r;if("string"==typeof e.cssClass)r=e.cssClass;else{var i=e.classes||TC.Cfg.styles.marker.classes;r=i[0];if(e.group){if(void 0===o[e.group]){var n=0;for(var a in o)n++;n%=i.length;o[e.group]=i[n]}r=o[e.group]}}t=TC.Util.getBackgroundUrlFromCss(r)}t||e===TC.Cfg.styles.point||""===e.cssClass||(t=p(TC.Cfg.styles.point));return t},addArrayToTree:function c(e,t,o){var r=null,i=!1;o=o||0;var n=e[o];if(n){for(var a,l=0,s=t.children.length;s>l;l++){a=t.children[l];if(a.name===n){i=!0;var p=c(e,a,o+1);p&&(r=p);break}}if(!i){a={name:n,title:n,uid:"/"+e.slice(0,o+1).join("/"),children:[]};t.children.push(a);r=a}}return r},parseCoords:function(e){var t=null,o=function(e){var t=e,o={};o.type=TC.Consts.GEOGRAPHIC;var r=t.indexOf("\xb0");o.value=parseFloat(t.substr(0,r));t=t.substr(r+1);r=t.indexOf("'");if(r>=0){var i=parseFloat(t.substr(0,r))/60;o.value>=0?o.value+=i:o.value-=i;t=t.substr(r+1);r=t.indexOf("'");if(r>=0){i=parseFloat(t.substr(0,r).replace(",","."))/3600;o.value>=0?o.value+=i:o.value-=i}}return o},r=function(e){var t=$.trim(e);if(t.match(/^1?\d{0,2}\s*\u00B0(\s*\d{1,2}\s*'(\s*\d{1,2}([.,]\d+)?\s*'')?)?\s*[NnSsWwOoEe]$/g)){switch(t[t.length-1]){case"S":case"s":case"W":case"w":case"O":case"o":t="-"+t}t=t.substr(0,t.length-1);return o(t)}if(t.match(/^[+-]?1?\d{0,2}\s*\u00B0(\s*\d{1,2}\s*'(\s*\d{1,2}([.,]\d+)?\s*'')?)?$/g))return o(t);if(t.match(/^1?\d{0,2}([.,]\d+)?\s*\u00B0?\s*[NnSsWwOoEe]$/g)){var r={type:TC.Consts.GEOGRAPHIC,value:parseFloat(t.substr(0,t.length-1).replace(",","."))};t.match(/[SsWwOo]$/)&&(r.value=-r.value);return r}return t.match(/^[+-]?1?\d{0,2}([.,]\d+)?\s*\u00B0?$/g)?{type:TC.Consts.GEOGRAPHIC,value:parseFloat(t.replace(",","."))}:t.match(/^\d{6,7}([.,]\d+)?$/g)?{type:TC.Consts.UTM,value:parseFloat(t.replace(",","."))}:null};e=$.trim(e).toUpperCase();var i=e.split(",");4===i.length?i=[i.slice(0,1).join("."),i.slice(2,3).join(".")]:(1===i.length||3===i.length)&&(i=e.split(" "));if(2===i.length){var n=r(i[0]),a=r(i[1]);null!==n&&null!==a&&(t=[n,a])}return t},reproject:function(e,t,o){var r,i=!0;if(!$.isArray(e)||!$.isArray(e[0])){i=!1;e=[e]}TC.loadProjDef(t,!0);TC.loadProjDef(o,!0);var n=new Proj4js.Proj(t),a=new Proj4js.Proj(o);r=new Array(e.length);for(var l=0,s=e.length;s>l;l++){var p=Proj4js.transform(n,a,{x:e[l][0],y:e[l][1]});r[l]=[p.x,p.y]}i||(r=r[0]);return r},getMetersPerDegree:function(e){var t=void 0,o=6370997;if($.isArray(e)&&e.length>=4){var r=this.degToRad(e[3]-e[1]),i=Math.sin(r/2),n=i*i,a=2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n));t=o*a/(e[3]-e[1])}return t},radToDeg:function(e){return 180*e/Math.PI},degToRad:function(e){return e*Math.PI/180},mod:function(e){return(e%(2*Math.PI)+2*Math.PI)%(2*Math.PI)},getLocaleString:function(e,t,o){var r=t;if(TC.i18n&&TC.i18n[e]){var i=TC.i18n[e][t];if(i){r=i;if(o)for(var n in o)r=r.replace("{"+n+"}",o[n])}}return r},getSimpleMimeType:function(e){var t="";if(e){var o=e.indexOf(";");o>0&&(e=e.substring(0,o));t=e}return t},getQueryStringParams:function(e){var t;if(e){var o=e.indexOf("?");if(o>=0){t=e.substr(o);var r=t.indexOf("#");r>=0&&(t=t.substr(0,r))}else t="?"}else t=location.search;var i=$.map(t.replace(/(^\?)/,"").split("&"),function(e){return e=e.split("="),this[e[0]]=e[1],this}.bind({}))[0];delete i[""];return i},fastUnshift:function(e,t){for(var o=e.length;o;){e[o]=e[o-1];o--}e[0]=t},storage:{getCookie:function(e){return $.cookie(e)},setCookie:function(e,t,o){return $.cookie(e,t,o)},getLocalValue:function(e){var t=null;t=localStorage&&localStorage instanceof Storage?localStorage.getItem(e):TC.Util.storage.getCookie(e);return t},setLocalValue:function(e,t){if(localStorage&&localStorage instanceof Storage)void 0===t?localStorage.removeItem(e):localStorage.setItem(e,t);else if(void 0===t){var o=new Date;o.setDate(o.getDate()-1);TC.Util.storage.setCookie(e,"",{expires:o})}else TC.Util.storage.setCookie(e,t);return e},getSessionLocalValue:function(e){var t=null;t=sessionStorage&&sessionStorage instanceof Storage?sessionStorage.getItem(e):TC.Util.storage.getCookie(e);return t},setSessionLocalValue:function(e,t){if(sessionStorage&&sessionStorage instanceof Storage)void 0===t?sessionStorage.removeItem(e):sessionStorage.setItem(e,t);else if(void 0===t){var o=new Date;o.setDate(o.getDate()-1);TC.Util.storage.setCookie(e,"",{expires:o})}else TC.Util.storage.setCookie(e,t);return e}},detectFirefox:function(){return/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)?new Number(RegExp.$1):!1},detectIE:function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);var o=e.indexOf("Trident/");if(o>0){var r=e.indexOf("rv:");return parseInt(e.substring(r+3,e.indexOf(".",r)),10)}var i=e.indexOf("Edge/");return i>0?parseInt(e.substring(i+5,e.indexOf(".",i)),10):!1},detectChrome:function(){return window.chrome},detectSafari:function(){return!!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/)},detectMouse:function(){if(Modernizr.mq("(pointer:coarse)")&&Modernizr.mq("(pointer:fine)"))return!0;if(Modernizr.mq("(pointer:coarse)")&&!Modernizr.mq("(pointer:fine)")){var e=function(){var e,t="(hover: hover)",o=!Modernizr.touch;if("matchMedia"in window){e=window.matchMedia(t);e.media===t&&(o=e.matches)}else console.log("no dispone de matchMedia");return o};return e()?!0:!1}return!Modernizr.mq("(pointer:coarse)")&&Modernizr.mq("(pointer:fine)")?!0:Modernizr.mq("(pointer:none)")?!1:Modernizr.touch?void 0:!0},detectAndroid:function(){return navigator.userAgent.match(/Android/i)},detectBlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},detectIOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i);

},detectMobileWindows:function(){return navigator.userAgent.match(/IEMobile/i)},detectMobile:function(){return TC.Util.detectAndroid()||TC.Util.detectIOS()||TC.Util.detectMobileWindows()||TC.Util.detectBlackBerry()},getElementByNodeName:function(e,t){for(var o=t.indexOf(":"),r=t.substr(o+1),i=e.getElementsByTagNameNS("*",r),n=0;n<i.length;n++)if(i[n].nodeName==t)return i;return void 0},addURLParameters:function(e,t){if(!t)return e;var o=Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&"),r=e.split("?");if(r.length>=2){var i=r[1].split(/[&;]/g);i.push(o);e=r[0]+"?"+i.join("&");return e}r=e.split("#");if(r.length>=2){r.shift();e=r[0]+"?"+o+"#"+r.join("#");return e}e=e+"?"+o;return e},removeURLParameter:function(e,t){var o=e.split("?");if(o.length>=2){for(var r=encodeURIComponent(t.toLowerCase())+"=",i=o[1].toLowerCase().split(/[&;]/g),n=i.length;n-->0;)-1!==i[n].lastIndexOf(r,0)&&i.splice(n,1);e=o[0]+"?"+i.join("&");return e}return e},showModal:function(e,t){var o=$(e),t=t||{};o.off("click").removeAttr("hidden");o.fadeIn(250,function(){o.on("click",".tc-modal-close",function(e){e.stopPropagation();return TC.Util.closeModal(t.closeCallback)});$.isFunction(t.openCallback)&&t.openCallback()})},closeModal:function(e){$(".tc-modal").hide().find(".tc-modal-window").removeAttr("style").off();e&&e()},closeAlert:function(e){$(e).parents(".tc-alert").hide()},getParameterByName:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)","i"),o=t.exec(location.search);return null===o?"":decodeURIComponent(o[1].replace(/\+/g," "))},getLocaleUserChoice:function(e){var t="en_US";e=e||{};var o=e.cookieName||"SITNA.language",r=e.paramName||"lang",i=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language||navigator.userLanguage,n=TC.Util.getParameterByName(r)||TC.Util.storage.getCookie(o)||i,a=n.indexOf("-");a>=0&&(n=n.substr(0,a));var l=new Date((new Date).getTime()+31536e6);TC.Util.storage.setCookie(o,n,{expires:l});switch(n){case"eu":t="eu_ES";break;case"es":t="es_ES";break;default:t="en_US"}return t},downloadBlob:function(e,t){var o=document.createElement("a");if(void 0!==o.download){var r=URL.createObjectURL(t);o.setAttribute("href",r);o.setAttribute("download",e);o.style.visibility="hidden";document.body.appendChild(o);o.click();document.body.removeChild(o)}},downloadFile:function(e,t,o){var r=new Blob([o],{type:t});navigator.msSaveBlob?navigator.msSaveBlob(r,e):TC.Util.downloadBlob(e,r)},downloadDataURI:function(e,t,o){for(var r=atob(o.split(",")[1]),i=[],n=0;n<r.length;n++)i.push(r.charCodeAt(n));var a=new Blob([new Uint8Array(i)],{type:t});navigator.msSaveBlob?navigator.msSaveBlob(a,e):TC.Util.downloadBlob(e,a)},shortenUrl:function(e){var t;$.ajax({url:"https://api-ssl.bitly.com/v3/shorten",data:{access_token:"6c466047309f44bd8173d83e81491648b243ee3d",longUrl:e},async:!1}).done(function(e){t=e.data.url});return t},utf8ToBase64:function(e){return window.btoa(unescape(encodeURIComponent(e)))},base64ToUtf8:function(e){var t;try{t=decodeURIComponent(escape(window.atob(e)))}catch(o){t=null}return t},operation:function(e,t,o,r){for(var i=[],n=0;n<e.length;n++){for(var a=e[n],l=!1,s=0;s<t.length;s++)if(o(a,t[s])){l=!0;break}l===r&&i.push(a)}return i},isSecureURL:function(e){return/^(f|ht)tps?:\/\//i.test(e)?/^(f|ht)tps:\/\//i.test(e):!0},inBoth:function(e,t,o){return this.operation(e,t,o,!0)},inFirstOnly:function(e,t,o){return this.operation(e,t,o,!1)},inSecondOnly:function(e,t,o){return this.inFirstOnly(t,e,o)},toDataUrl:function(e,t){var o={type:"image/png",encoderOptions:.92},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o,i=r.type,n=r.encoderOptions,a=e.getContext("2d");if(!a)return"";var l=e.width,s=e.height,p=a.getImageData(0,0,l,s),c=a.globalCompositeOperation;if(t){a.globalCompositeOperation="destination-over";a.fillStyle=t;a.fillRect(0,0,l,s)}var u=e.toDataURL(i,n);if(t){a.clearRect(0,0,l,s);a.putImageData(p,0,0);a.globalCompositeOperation=c}return u},imgToDataUrl:function(e,t){var o=function(e){var t=document.createElement("CANVAS"),o=t.getContext("2d");t.height=e.height;t.width=e.width;o.drawImage(e,0,0);return t},r=$.Deferred(),i=new Image;i.crossOrigin="anonymous";i.onload=function(){var e,n=o(i);e=TC.Util.toDataUrl(n,"#ffffff",{type:t||"image/jpeg",encoderOptions:1});r.resolve(e,n)};i.onerror=function(n){var a=new XMLHttpRequest;a.open("GET",TC.proxify(e),!0);a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.responseType="arraybuffer";a.onload=function(e){if(200===this.status){for(var n=new Uint8Array(this.response),l=n.length,s=new Array(l);l--;)s[l]=String.fromCharCode(n[l]);var p=s.join(""),c=a.getResponseHeader("content-type");if(0===c.indexOf("image")){i.src="data:"+c+";base64,"+window.btoa(p);i.onload=function(){var e=o(i);dataURL=TC.Util.toDataUrl(e,"#ffffff",{type:t||"image/jpeg",encoderOptions:1});r.resolve(dataURL,e)}}}};a.onreadystatechange=function(){4===a.readyState&&200!==a.status&&r.reject()};a.send()};var n=e.replace(/^https?\:/i,"");i.src=n;if(i.complete||void 0===i.complete){i.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";i.src=n}return r.promise()},addToCanvas:function(e,t,o){var r=TC.Util.cloneCanvas(e),i=$.Deferred(),n=r.getContext("2d"),a=new Image;t.crossOrigin="anonymous";a.src=t;a.onload=function(){n.drawImage(a,o.x||0,o.y||0);i.resolve(r)};return i.promise()},cloneCanvas:function(e){var t=document.createElement("canvas"),o=t.getContext("2d");t.width=e.width;t.height=e.height;o.drawImage(e,0,0);return t},calculateAspectRatioFit:function(e,t,o,r){var i=Math.min(o/e,r/t);return{width:e*i,height:t*i}},getFormattedDate:function(e,t){function o(e){return 10>e?"0"+e:e}var r=new Date(e);return[r.getFullYear(),o(r.getMonth()+1),o(r.getDate())].concat(t?["_",o(r.getHours()),o(r.getMinutes()),o(r.getSeconds())]:[]).join("")},replaceAccent:function(e){var t={"\xe4":"a","\xf6":"o","\xfc":"u","\xc4":"A","\xd6":"O","\xdc":"U","\xe1":"a","\xe9":"e",i:"i","\xf3":"o","\xfa":"u","\xc1":"A","\xc9":"E","\xcd":"I","\xd3":"O","\xda":"U","\xf1":"n","\xd1":"N"};return e.replace(/[\xf6\xe4\u00fc\xd6\xc4\u00dc\u00e1\u00e9\u00ed\u00f3\u00fa\u00c1\u00c9\u00cd\u00d3\u00da\u00f1\u00d1]/g,function(e){return t[e]})},downloadFileForm:function(e,t){var o=function(e,t){var o=$("<form/>",{"class":"tc-ctl-download-form",method:"post",enctype:"text/plain",action:TC.Util.detectIE()?TC.proxify(e):e}),r=$("<input/>",{"class":"tc-ctl-download-query",name:t.substring(0,t.indexOf("="))});o.append(r);var i=$("iframe").filter(function(t,o){return $(o).data("url-download")===e});if(i.length>0)i=i.first();else{i=$('<iframe style="visibility: hidden; display:none;"></iframe>');i.data("url-download",e);$("body").append(i)}var n=i[0].contentDocument;n.open();n.write(o[0].outerHTML);n.close();$("input",n).val(t.substring(t.indexOf("=")+1));o=$("form",n);return o},r=[];if(jQuery.isArray(e))for(var i=e,n=0;n<i.length;n++)r.push(o(i[n].url,i[n].data));else r.push(o(e,t));$(r).submit();setTimeout(function(){$(".tc-ctl-download-form").remove()},1e3)},WFSQueryBuilder:function(e,t,o,r,i){$.isArray(e)||(e=[e]);var n='xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd" xmlns:ogc="http://www.opengis.net/ogc" service="WFS" {resultType} {format} ';switch(o.version){case"1.0.0":case"1.1.0":n+='xmlns:gml="http://www.opengis.net/gml" xmlns:wfs="http://www.opengis.net/wfs" ';break;case"2.0.0":n+='xmlns:wfs="http://www.opengis.net/wfs/2.0" xmlns:gml="http://www.opengis.net/gml/3.2" '}for(var a in o)"string"==typeof o[a]&&a.indexOf("gml")<0&&o[a].indexOf("wfs")<0&&(n+=a+'="'+o[a]+'" ');var l="<wfs:GetFeature "+n.format({resultType:i?'resultType="hits"':"",format:'outputFormat="'+r+'"'})+">",s="",p="<wfs:Query typeName"+("2.0.0"===o.version?"s":"")+'="{typeName}">{filter}</wfs:Query>';$.each(e,function(e,r){s+=p.format({typeName:r,filter:TC.Util.WFSFilterBuilder(t,o.version)})});l+=s+"</wfs:GetFeature>";return l},WFSFilterBuilder:function(e,t){var o="";if(jQuery.isPlainObject(e))o='<{prefix}:Filter><{prefix}:Intersects><fes:ValueReference></fes:ValueReference><{prefix}:Function name="querySingle"><{prefix}:Literal>{clipLayer}</{prefix}:Literal><{prefix}:Literal>{geometryName}</{prefix}:Literal><{prefix}:Literal>{where}</{prefix}:Literal></{prefix}:Function></{prefix}:Intersects></{prefix}:Filter>'.format({prefix:"2.0.0"===t?"fes":"ogc",clipLayer:e.clipLayer,geometryName:e.geometryName,where:e.where});else switch(!0){case!e:break;case $.isArray(e):var r="<gml:Envelope><gml:lowerCorner>{lowerCorner}</gml:lowerCorner><gml:upperCorner>{upperCorner}</gml:upperCorner></gml:Envelope>".format({lowerCorner:e[0]+" "+e[1],upperCorner:e[2]+" "+e[3]});switch(!0){case"1.0.0"===t:case"1.1.0"===t:o+="<ogc:Filter><ogc:BBOX>"+r+"</ogc:BBOX></ogc:Filter>";break;case"2.0.0"===t:o+="<fes:Filter><fes:BBOX>"+r+"</fes:BBOX></fes:Filter>"}break;case e instanceof TC.Feature:switch(!0){case"1.0.0"===t:case"1.1.0"===t:o+="<ogc:Filter><ogc:Intersects><ogc:PropertyName></ogc:PropertyName>"+TC.Util.writeGMLGeometry(e,"2.0")+"</ogc:Intersects></ogc:Filter>";break;case"2.0.0"===t:o+="<fes:Filter><fes:Intersects><fes:ValueReference></fes:ValueReference>"+TC.Util.writeGMLGeometry(e,"3.2")+"</fes:Intersects></fes:Filter>"}break;default:TC.error("Geometr\xeda no v\xe1lida")}return o},writeGMLGeometry:function(e,t){var o=function(e){var o;if(0===t.indexOf("3")){o=e.toString();for(;o.indexOf(",")>=0;)o=o.replace(","," ")}else{o=e;jQuery.each(o,function(e,t){return t.join(",")}).join(" ")}return o};switch(t){case"3.1.1":break;case"3.2":switch(!0){case TC.feature.Polyline&&e instanceof TC.feature.Polyline:return'<gml:LineString srsDimension="2"><gml:posList>'+o(e.geometry)+"</gml:posList></gml:LineString>";default:return'<gml:Polygon srsDimension="2"><gml:exterior><gml:LinearRing><gml:posList>'+o(e.geometry[0])+"</gml:posList></gml:LinearRing></gml:exterior></gml:Polygon>"}break;case"2.0":default:switch(!0){case TC.feature.Polyline&&e instanceof TC.feature.Polyline:return"<gml:LineString><gml:coordinates>"+o(e.geometry[0])+"</gml:coordinates></gml:LineString>";default:return"<gml:Polygon><gml:outerBoundaryIs><gml:LinearRing><gml:coordinates>"+o(e.geometry[0])+"</gml:coordinates></gml:LinearRing></gml:outerBoundaryIs></gml:Polygon>"}}}};String.prototype.format=function(){var e=this.toString();if(!arguments.length)return e;var t=typeof arguments[0],t="string"==t||"number"==t?arguments:arguments[0];for(arg in t)e=e.replace(RegExp("\\{"+arg+"\\}","gi"),t[arg]);return e};return s});!function(e,t){"use strict";function o(e,t){var o=e.length;~t&&o>t&&(o=t);return o}function r(e,t){_.setTimeout(e,t||0)}function i(e){r(function(){throw e})}function n(e){return/(^(https?:)?\/\/)|(\.(js|php)$)/.test(e)&&!/(\n|\r)/m.test(e)}function a(e){return e&&e.constructor&&e.call&&e.apply}function l(e){var t;return(t=Array.isArray)?t(e)?e:[e]:S.concat(e)}function s(e){return S.slice.call(e)}function p(){var e=s(arguments);return function(){return P.apply(P,e.concat(s(arguments)))}}function c(e,t){var o=this;if((!o.readyState||/^c|loade/.test(o.readyState))&&!o.loadStatus){o.onload=o.onreadystatechange=o.onerror=null;o.loadStatus=!0;if(t&&"error"===t.type){var r=o.src||"Resource",n=" fails to load.",a={name:"ConnectionError",source:r,evt:t,stack:r+n,message:n,toString:function(){return this.source+this.message}};i(a);e.reject(a)}else e.resolve()}}function u(e,t){var o="script",r=T.createElement(o),i=T.getElementsByTagName(o),n=i[i.length-1];r.async=!0;r.src=e;if(t){r.loadStatus=!1;var a=p(c,r,t);r.onload=r.onreadystatechange=r.onerror=a;var l=n;l=l||document.body.firstChild;l.parentNode.insertBefore(r,l)}}function g(e,t){x(function(){try{e.call(null,t)}catch(o){t.reject(o)}})}function d(e,t){if(!a(e)){if(n(e)){u(e,t);return}if(E){e=v+encodeURIComponent(e);u(e,t);return}}var o=a(e)?e:Function(e);if(!t.async){var r=o;o=function(e){try{r.call(null);e.resolve()}catch(t){e.reject(t)}}}g(o,t)}function h(e,t){var o=this;o.tasks=[];o.callbacks=[];o.errors=[];o.data={};o.nextTask=0;o.nextCallback=0;o.until=-1;o.digest=!1;o.add(e).whenDone(t)}function f(){var e=this;if(e.digest)r(p(f,e),50/3);else{e.digest=!0;for(var t,i,n=e.nextCallback;n<o(e.callbacks,e.until);n++)if(e.nextTask===e.tasks.length){i=e.nextCallback;t=e.callbacks[i];if(t){e.nextCallback=n+1;t.call(null,e.data,e.nextTask-1,e.errors);if(!t.untilThen)continue;e.nextCallback--;e.until=-1}e.callbacks.splice(i,1)}e.digest=!1}}function y(){var e=this;if(e.nextTask<e.tasks.length&&++e.nextTask!==e.tasks.length)return e;f.call(e);return e}function m(e,t){return new h(e,t)}var v="data:application/javascript,",C="OMITTED",T=document,_=window,S=Array.prototype,E=!0;T.all&&!T.addEventListener&&(E=!1);var x=_.requestAnimationFrame||_.webkitRequestAnimationFrame||_.mozRequestAnimationFrame||r,P=Function.call;h.prototype.resolve=function(e,t){var o=this;e&&e!==C&&(o.data[e]=t);return y.call(o)};h.prototype.reject=function(e){var t=this;if(e){i(e);t.errors.push(e)}return y.call(t)};h.prototype.whenDone=function(e){var t=this;if(!e)return t;if(t.nextTask>t.tasks.length)return t;t.callbacks.push(e);t.nextTask===t.tasks.length&&t.resolve();return t};h.prototype.add=function(e,t){var o=this;if(!e)return o;if(t&&o[t]){var r=new Error("Callback value name: "+t+" is registered");i(r);o.errors.push(r)}e=l(e);for(var n,a=({resolve:p(o.resolve,o,t),reject:o.reject,async:!!t},0);a<e.length;a++){n=e[a];if(n){o.tasks.push(n);d(n,o)}}return o};h.prototype.then=function(e,t){function o(){r.until=r.nextCallback;r.add(e,t)}var r=this;if(!e)return r;o.untilThen=!0;return r.whenDone(o)};"undefined"!=typeof module&&module.exports?module.exports=m:"function"==typeof define&&define.amd?define(function(){return m}):t[e]=m}("asyncJS",this);var TC=TC||{};TC.version="1.3.0";!function(){if(!TC.apiLocation){var e,t;if(document.currentScript)t=document.currentScript;else{var o=document.getElementsByTagName("script");t=o[o.length-1]}var e=t.getAttribute("src");TC.apiLocation=e.substr(0,e.lastIndexOf("/")+1)}}();if(!TC.Consts){TC.Consts={};TC.Consts.OLNS_LEGACY="OpenLayers";TC.Consts.OLNS="ol";TC.Consts.PROJ4JSOBJ_LEGACY="Proj4js";TC.Consts.PROJ4JSOBJ="proj4";TC.Consts.GEOGRAPHIC="geographic";TC.Consts.UTM="UTM";TC.Consts.OLD_BROWSER_ALERT="TC.oldBrowserAlert";TC.Consts.CLUSTER_ANIMATION_DURATION=200;TC.Consts.ZOOM_ANIMATION_DURATION=300;TC.Consts.URL_MAX_LENGTH=2048;TC.Consts.METER_PRECISION=0;TC.Consts.DEGREE_PRECISION=5;TC.Consts.EXTENT_TOLERANCE=.9998;TC.Consts.url={SPLIT_REGEX:/([^:]*:)?\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,MODERNIZR:"lib/modernizr.js",JQUERY_LEGACY:TC.apiLocation+"lib/jquery/jquery.1.10.2.js",JQUERY:"//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.js",OL_LEGACY:"lib/OpenLayers/OpenLayers.debug.js",OL:"lib/ol/build/ol-custom.js",OL_CONNECTOR_LEGACY:"TC/ol/ol2.js",OL_CONNECTOR:"TC/ol/ol.js",TEMPLATING:"lib/dust/dust-full-helpers.min.js",TEMPLATING_I18N:"lib/dust/dustjs-i18n.min.js",TEMPLATING_OVERRIDES:"lib/dust/dust.overrides.js",PROJ4JS_LEGACY:"lib/proj4js/legacy/proj4js-compressed.js",PROJ4JS:"lib/proj4js/proj4-src.js",SPATIALREFERENCE:"http://spatialreference.org/",LOCALFORAGE:TC.apiLocation+"lib/localForage/localforage.min.js",D3C3:TC.apiLocation+"lib/d3c3/d3c3.min.js",CESIUM:TC.apiLocation+"lib/cesium/release/Cesium.js",JSNLOG:"lib/jsnlog/jsnlog.min.js",ERROR_LOGGER:TC.apiLocation+"errors/logger.ashx",PDFMAKE:TC.apiLocation+"lib/pdfmake/pdfmake-fonts.min.js",JSONPACK:"lib/jsonpack/jsonpack.min.js"};TC.Consts.classes={MAP:"tc-map",POINT:"tc-point",MARKER:"tc-marker",VISIBLE:"tc-visible",HIDDEN:"tc-hidden",COLLAPSED:"tc-collapsed",CHECKED:"tc-checked",DISABLED:"tc-disabled",ACTIVE:"tc-active",LASTCHILD:"tc-lastchild",TRANSPARENT:"tc-transparent",DROP:"tc-drop",LOADING:"tc-loading",IPAD_IOS7_FIX:"tc-ipad-ios7-fix",INFO:"tc-msg-info",WARNING:"tc-msg-warning",ERROR:"tc-msg-error"};TC.Consts.msgType={INFO:"info",WARNING:"warning",ERROR:"error"};TC.Consts.msgErrorMode={TOAST:"toast",CONSOLE:"console",EMAIL:"email"};TC.Consts.event={MAPLOAD:"mapload.tc",MAPREADY:"mapready.tc",BEFORELAYERADD:"beforelayeradd.tc",LAYERADD:"layeradd.tc",LAYERREMOVE:"layerremove.tc",LAYERORDER:"layerorder.tc",BEFORELAYERUPDATE:"beforelayerupdate.tc",LAYERUPDATE:"layerupdate.tc",LAYERERROR:"layererror.tc",BEFOREBASELAYERCHANGE:"beforebaselayerchange.tc",BASELAYERCHANGE:"baselayerchange.tc",BEFOREUPDATE:"beforeupdate.tc",UPDATE:"update.tc",BEFOREZOOM:"beforezoom.tc",ZOOM:"zoom.tc",BEFOREUPDATEPARAMS:"beforeupdateparams.tc",UPDATEPARAMS:"updateparams.tc",VECTORUPDATE:"vectorupdate.tc",FEATUREADD:"featureadd.tc",BEFOREFEATURESADD:"beforefeaturesadd.tc",FEATURESADD:"featuresadd.tc",FEATUREREMOVE:"featureremove.tc",FEATURESCLEAR:"featuresclear.tc",FEATURESIMPORT:"featuresimport.tc",FEATURESIMPORTERROR:"featuresimporterror.tc",BEFORETILELOAD:"beforetileload.tc",TILELOAD:"tileload.tc",TILELOADERROR:"tileloaderror.tc",CONTROLADD:"controladd.tc",CONTROLACTIVATE:"controlactivate.tc",CONTROLDEACTIVATE:"controldeactivate.tc",BEFORECONTROLRENDER:"beforecontrolrender.tc",CONTROLRENDER:"controlrender.tc",BEFORELAYOUTLOAD:"beforelayoutload.tc",LAYOUTLOAD:"layoutload.tc",LAYERVISIBILITY:"layervisibility.tc",LAYEROPACITY:"layeropacity.tc",FEATURECLICK:"featureclick.tc",NOFEATURECLICK:"nofeatureclick.tc",FEATUREOVER:"featureover.tc",FEATUREOUT:"featureout.tc",BEFOREFEATUREINFO:"beforefeatureinfo.tc",FEATUREINFO:"featureinfo.tc",NOFEATUREINFO:"nofeatureinfo.tc",FEATUREINFOERROR:"featureinfoerror.tc",CLICK:"click.tc",MOUSEUP:"mouseup.tc",STARTLOADING:"startloading.tc",STOPLOADING:"stoploading.tc",EXTERNALSERVICEADDED:"externalserviceadded.tc",ZOOMTO:"zoomto.tc"};TC.Consts.layer={IDENA_ORTHOPHOTO:"ortofoto",IDENA_BASEMAP:"mapabase",IDENA_CADASTER:"catastro",IDENA_CARTO:"cartografia",IDENA_ORTHOPHOTO2012:"ortofoto2012",IDENA_DYNBASEMAP:"mapabase_dinamico",IDENA_BW_RELIEF:"relieve_bn",IDENA_BASEMAP_ORTHOPHOTO:"base_orto",BLANK:"ninguno"};TC.Consts.text={API_ERROR:"Error API SITNA",APP_ERROR:"Error de aplicaci\xf3n"};TC.Consts.layerType={WMS:"WMS",WMTS:"WMTS",WFS:"WFS",VECTOR:"vector",KML:"KML",GPX:"GPX",GEOJSON:"GeoJSON",GROUP:"group"};TC.Consts.geom={POINT:"point",MULTIPOINT:"multipoint",POLYLINE:"polyline",POLYGON:"polygon",MULTIPOLYLINE:"multipolyline",MULTIPOLYGON:"multipolygon",CIRCLE:"circle",RECTANGLE:"rectangle"};TC.Consts.searchType={CADASTRAL:"cadastral",COORDINATES:"coordinates",MUNICIPALITY:"municipality",COUNCIL:"council",LOCALITY:"locality",STREET:"street",NUMBER:"number",URBAN:"urban",COMMONWEALTH:"commonwealth",ROAD:"road",ROADPK:"roadpk"};TC.Consts.mapSearchType={MUNICIPALITY:TC.Consts.searchType.MUNICIPALITY,COUNCIL:TC.Consts.searchType.COUNCIL,URBAN:TC.Consts.searchType.URBAN,COMMONWEALTH:TC.Consts.searchType.COMMONWEALTH,GENERIC:"generic"};TC.Consts.comparison={EQUAL_TO:"=="};TC.Consts.WMTSEncoding={KVP:"KVP",RESTFUL:"RESTful"};TC.Consts.mimeType={PNG:"image/png",JPEG:"image/jpeg",JSON:"application/json",KML:"application/vnd.google-earth.kml+xml",GML:"application/gml+xml",XML:"application/xml"};TC.Consts.format={JSON:"JSON",KML:"KML",GML:"GML",GML2:"GML2",GML3:"GML2",GEOJSON:"GeoJSON",TOPOJSON:"TopoJSON",GPX:"GPX",WKT:"WKT"};TC.Consts.visibility={NOT_VISIBLE:0,NOT_VISIBLE_AT_RESOLUTION:1,HAS_VISIBLE:2,VISIBLE:4};TC.Consts.MARKER="marker";TC.Defaults=function(){var e={},t=function(t){var o=t.features.length,r=e[o];if(!r){r=Math.round(15*Math.sqrt(o));e[o]=r}return r},o={},r=function(e){var t=e.features.length,r=o[t];if(!r){var i=Math.round(100+155*Math.min(6,t)/6);i>255&&(i=255);var n=Math.round(255-155*Math.max(0,t-4)/6);100>n&&(n=100);var a=100;r="#"+i.toString(16)+n.toString(16)+a.toString(16);o[t]=r}return r};return{imageRatio:1.05,proxy:"",crs:"EPSG:25830",utmCrs:"EPSG:25830",geoCrs:"EPSG:4326",initialExtent:[541084.221,4640788.225,685574.4632,4796618.764],maxExtent:[480408,4599748,742552,4861892],baselayerExtent:[480408,4599748,742552,4861892],resolutions:[1024,512,256,128,64,32,16,8,4,2,1,.5,.25],pointBoundsRadius:30,extentMargin:.2,mouseWheelZoom:!0,attribution:'<a href="http://sitna.navarra.es/" target="_blank">SITNA</a>',oldBrowserAlert:!0,notifyApplicationErrors:!1,maxErrorCount:10,locale:"es_ES",screenSize:20,pixelTolerance:10,toastDuration:5e3,avgTileSize:31e3,availableBaseLayers:[{id:TC.Consts.layer.IDENA_BASEMAP,title:"Mapa base",type:TC.Consts.layerType.WMTS,url:"//idena.navarra.es/ogc/wmts/",matrixSet:"epsg25830extended",layerNames:"mapabase",encoding:TC.Consts.WMTSEncoding.RESTFUL,format:"image/png",isDefault:!0,hideTree:!0,thumbnail:TC.apiLocation+"TC/css/img/thumb-basemap.png"},{id:TC.Consts.layer.IDENA_ORTHOPHOTO,title:"Ortofoto 2014",type:TC.Consts.layerType.WMTS,url:"//idena.navarra.es/ogc/wmts/",matrixSet:"epsg25830reduced",layerNames:"ortofoto2014",encoding:TC.Consts.WMTSEncoding.RESTFUL,format:"image/jpeg",isDefault:!1,hideTree:!0,thumbnail:TC.apiLocation+"TC/css/img/thumb-orthophoto.jpg"},{id:TC.Consts.layer.IDENA_ORTHOPHOTO2012,title:"Ortofoto 2012",type:TC.Consts.layerType.WMTS,url:"//idena.navarra.es/ogc/wmts/",matrixSet:"epsg25830",layerNames:"ortofoto2012",encoding:TC.Consts.WMTSEncoding.RESTFUL,format:"image/jpeg",isDefault:!1,hideTree:!0,thumbnail:TC.apiLocation+"TC/css/img/thumb-ortho2012.jpg"},{id:TC.Consts.layer.IDENA_CADASTER,title:"Catastro",type:TC.Consts.layerType.WMS,url:"//idena.navarra.es/ogc/wms",layerNames:"catastro,regionesFronterizas",format:"image/png",isDefault:!1,hideTree:!0,thumbnail:TC.apiLocation+"TC/css/img/thumb-cadaster.png"},{id:TC.Consts.layer.IDENA_CARTO,title:"Cartograf\xeda topogr\xe1fica",type:TC.Consts.layerType.WMS,url:"//idena.navarra.es/ogc/wms",layerNames:"IDENA:cartografia_topografica",format:"image/jpeg",isDefault:!1,hideTree:!0,thumbnail:TC.apiLocation+"TC/css/img/thumb-carto.png"},{id:TC.Consts.layer.IDENA_BW_RELIEF,title:"Relieve",type:TC.Consts.layerType.WMS,url:"//idena.navarra.es/ogc/wms",layerNames:"IDENA:mapa_relieve_bn",format:"image/jpeg",isDefault:!1,hideTree:!0,thumbnail:TC.apiLocation+"TC/css/img/thumb-relief_bw.jpg"},{id:TC.Consts.layer.IDENA_BASEMAP_ORTHOPHOTO,title:"Mapa base/ortofoto 2014",type:TC.Consts.layerType.WMS,url:"//idena.navarra.es/ogc/wms",layerNames:"mapaBase_orto",format:"image/jpeg",isDefault:!1,hideTree:!0,thumbnail:TC.apiLocation+"TC/css/img/thumb-base_ortho.jpg"},{id:TC.Consts.layer.IDENA_DYNBASEMAP,title:"Mapa base",type:TC.Consts.layerType.WMS,url:"//idena.navarra.es/ogc/wms",layerNames:"mapaBase,regionesFronterizas",format:"image/jpeg",isDefault:!1,hideTree:!0,thumbnail:TC.apiLocation+"TC/css/img/thumb-basemap.png"},{id:TC.Consts.layer.BLANK,title:"Mapa en blanco",type:TC.Consts.layerType.VECTOR}],baseLayers:[TC.Consts.layer.IDENA_BASEMAP,TC.Consts.layer.IDENA_ORTHOPHOTO,TC.Consts.layer.IDENA_CADASTER,TC.Consts.layer.IDENA_CARTO],defaultBaseLayer:TC.Consts.layer.IDENA_BASEMAP,workLayers:[],controls:{loadingIndicator:!0,navBar:!1,scaleBar:!1,scale:!1,scaleSelector:!1,overviewMap:!1,basemapSelector:!1,attribution:!0,TOC:!1,coordinates:!0,legend:!1,popup:!1,search:{url:"//idena.navarra.es/ogc/wfs",allowedSearchTypes:{coordinates:{},municipality:{}}},measure:!1,streetView:!0,featureInfo:!0},layout:null,styles:{point:{fillColor:"#f00",fillOpacity:.5,strokeColor:"#f00",strokeWidth:2,radius:6},marker:{classes:[TC.Consts.classes.MARKER+1,TC.Consts.classes.MARKER+2,TC.Consts.classes.MARKER+3,TC.Consts.classes.MARKER+4,TC.Consts.classes.MARKER+5],anchor:[.5,1],width:32,height:32},line:{strokeColor:"#f00",strokeWidth:2},polygon:{strokeColor:"#f00",strokeWidth:2,fillColor:"#000",fillOpacity:.3},cluster:{point:{cssClass:"",anchor:[.5,.5],fillColor:r,fillOpacity:.6,width:t,height:t,label:"${features.length}",fontColor:"#000",fontSize:12}},selection:{point:{fillColor:"#00f",fillOpacity:.5,strokeColor:"#00f",strokeWidth:2,radius:6},line:{strokeColor:"#00f",strokeWidth:2},polygon:{strokeColor:"#00f",strokeWidth:2,fillColor:"#000",fillOpacity:.3}}}}}();!function(){Array.prototype.map||(Array.prototype.map=function(e){"use strict";if(void 0===this||null===this)throw new TypeError;var t=Object(this),o=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var r=new Array(o),i=arguments.length>=2?arguments[1]:void 0,n=0;o>n;n++)n in t&&(r[n]=e.call(i,t[n],n,t));return r});TC.proxify=function(e){e=$.trim(e);var t=e;if(TC.Cfg.proxy){var o=!1;if(TC.Cfg.proxyExceptions)for(var r=0;r<TC.Cfg.proxyExceptions.length;r++)if(e.indexOf(TC.Cfg.proxyExceptions[r])>-1){o=!0;break}if(!o&&!TC.Util.isSameOrigin(e))if("function"==typeof TC.Cfg.proxy)t=TC.Cfg.proxy(e);else{t=TC.Cfg.proxy;"http"!=e.substr(0,4)&&(t+=window.location.protocol);t+=encodeURIComponent(e)}}return t};var e=function(){var e,t=document,o=t.getElementsByTagName("head");if(0===o.length){e=t.createElement("head");t.documentElement.insertBefore(e,document.body)}else e=o[0];return e};"boolean"!=typeof TC.isDebug&&(TC.isDebug=!1);TC.syncLoadJS=function(t){/(\.js|\/)$/i.test(t)||(t+=TC.isDebug?".js":".min.js");var o=new XMLHttpRequest;o.open("GET",t,!1);o.send(null);var r=document.createElement("script");r.type="text/javascript";r.text=o.responseText;e().appendChild(r)};window.yepnope||TC.syncLoadJS(TC.apiLocation+TC.Consts.url.MODERNIZR);TC.isLegacy=!1;window.jQuery||TC.syncLoadJS(Modernizr.canvas&&!TC.isLegacy?TC.Consts.url.JQUERY:TC.Consts.url.JQUERY_LEGACY);$(document).ready(function(){var e,t="Unknown library",o="OpenLayers 2",r="OpenLayers 4";if(TC.Control){e="Compiled";TC.isLegacy?window.OpenLayers&&(t=o):window.ol&&(t=r)}else{e="On demand";t=TC.isLegacy?o:r}TC.version=TC.version+" ("+e+"; "+t+"; @ "+TC.apiLocation+")"});TC.downloadedJSs=[];TC.requestedJSs={};TC.loadJSInOrder=function(e,t,o){TC.loadJS(e,t,o,!0)};TC.loadJS=function(e,t,o,r){arguments.length<4&&(r=!1);var i=$.isArray(t)?t:[t];i=$.map(i,function(e){return/\.js$/i.test(e)?e:e+(TC.isDebug?".js":".min.js")});if(Modernizr.canvas)if(e){for(var n,a=[],l=[],s=0;s<i.length;s++){n=i[s];TC.downloadedJSs[n]||(TC.requestedJSs[n]?l.push(n):a.push(n))}if(0==a.length&&0==l.length)o();else if(a.length>0&&0==l.length){for(var p=asyncJS(),s=0;s<a.length;s++)TC.requestedJSs[a[s]]=p;if(r)for(var s=0;s<a.length;s++)0==s?p.add(a[s]):p.then(a[s]);else p.add(a);p.whenDone(function(){for(var e=0;e<a.length;e++){TC.downloadedJSs.push(a[e]);delete TC.requestedJSs[a[e]]}o()})}else if(0==a.length&&l.length>0)for(var c,u=l.length,g=0,s=0;s<l.length;s++){var c=l[s],p=TC.requestedJSs[c];p.whenDone(function(e,t,r){g++;g>=u&&o()})}else console.error("Mezcla de tareas en proceso y nuevas!!")}else o();else{if(e)for(var s=0;s<i.length;s++)TC.syncLoadJS(i[s]);o&&o()}};var t=function(e){for(var t=!1,o=0;o<document.styleSheets.length;o++){var r=document.styleSheets[o].href;if(r){var i=r.indexOf(e);if(i>=0&&i===r.length-e.length){t=!0;break}}}return t};TC.loadCSS=function(o){if(!t(o)){var r=document.createElement("link");r.rel="stylesheet";r.href=o;e().appendChild(r)}};TC.loadProjDef=function(t,o){var r,i="EPSG:",n="urn:ogc:def:crs:EPSG::",a="http://www.opengis.net/gml/srs/epsg.xml#",l=i+"25830",s=n+"25830",p=a+"25830";if(TC.isLegacy){window[TC.Consts.PROJ4JSOBJ_LEGACY]||TC.syncLoadJS(TC.url.proj4js);Proj4js.defs[l]="+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs";Proj4js.defs[s]=Proj4js.defs[l];Proj4js.defs[p]=Proj4js.defs[l];r=function(e){return Proj4js.defs[e]}}else{window[TC.Consts.PROJ4JSOBJ]||TC.syncLoadJS(TC.url.proj4js);proj4.defs(l,"+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs");proj4.defs(s,proj4.defs(l));proj4.defs(p,proj4.defs(l));r=function(e){return proj4.defs(e)}}window.Proj4js||(window.Proj4js={Proj:function(e){return proj4(Proj4js.defs[e])},defs:proj4.defs,transform:proj4});var c=function(e){l=i+e;s=n+e;p=a+e;Proj4js.defs[s]=Proj4js.defs[l];Proj4js.defs[p]=Proj4js.defs[l];if(!TC.isLegacy){proj4.defs(l,Proj4js.defs[l]);proj4.defs(s,Proj4js.defs[l]);proj4.defs(p,Proj4js.defs[l])}};if(r(t)){if($.isFunction(o)){c(g);o()}}else{var u=t.lastIndexOf("#");0>u&&(u=t.lastIndexOf(":"));var g=t.substr(u+1),d=TC.proxify(TC.Consts.url.SPATIALREFERENCE+"ref/epsg/"+g+"/proj4js/");if("boolean"==typeof o)if(o){var h=new XMLHttpRequest;h.open("GET",d,!1);h.send(null);var f=document.createElement("script");f.type="text/javascript";f.text=h.responseText;e().appendChild(f);c(g)}else TC.loadJS(!0,d);else TC.loadJS(!0,d,function(){c(g);o()})}};TC.url={templating:[TC.apiLocation+TC.Consts.url.TEMPLATING,TC.apiLocation+TC.Consts.url.TEMPLATING_I18N,TC.apiLocation+TC.Consts.url.TEMPLATING_OVERRIDES]};if(TC.isLegacy){TC.url.ol=TC.apiLocation+TC.Consts.url.OL_LEGACY;TC.url.olConnector=TC.apiLocation+TC.Consts.url.OL_CONNECTOR_LEGACY;TC.url.proj4js=TC.apiLocation+TC.Consts.url.PROJ4JS_LEGACY}else{TC.url.ol=TC.apiLocation+TC.Consts.url.OL;TC.url.olConnector=TC.apiLocation+TC.Consts.url.OL_CONNECTOR;TC.url.proj4js=TC.apiLocation+TC.Consts.url.PROJ4JS}TC.Cfg=$.extend(!0,{},TC.Defaults,TC.Cfg);TC.capabilities={};TC.WFScapabilities={};TC.cache={};TC.inherit=function(e,t){function o(){}o.prototype=t.prototype;e._super=t.prototype;e.prototype=new o;e.prototype.constructor=e};TC.alert=function(e){alert(e)};TC.prompt=function(e,t,o){var r=prompt(e,t);$.isFunction(o)&&o(r)};TC.confirm=function(e,t,o){confirm(e)?$.isFunction(t)&&t():$.isFunction(o)&&o()};TC.error=function(e){window.console&&console.error(e)};TC.Object=function(){var e=this;e.$events=$(e)};TC.Object.prototype.on=function(e,t){var o=this;o.$events.on(e,t);return o};TC.Object.prototype.one=function(e,t){var o=this;o.$events.one(e,t);return o};TC.Object.prototype.off=function(e,t){var o=this;o.$events.off(e,t);return o};TC.wrap={Map:function(e){var t=this;t.parent=e;t.map=null;t.mapDeferred=new $.Deferred;t.getMap=function(){return t.map||t.mapDeferred.promise()}},Layer:function(e){var t=this;t.parent=e;t.layer=null;t.layerDeferred=new $.Deferred;t.getLayer=function(){return t.layer||t.layerDeferred.promise()};t.setLayer=function(e){t.layer=e;e?t.layerDeferred.resolve(e):t.layerDeferred.reject()}},layer:{Raster:function(){TC.wrap.Layer.apply(this,arguments)},Vector:function(){TC.wrap.Layer.apply(this,arguments)}},Control:function(e){var t=this;t.parent=e},control:{Click:function(){TC.wrap.Control.apply(this,arguments)},ScaleBar:function(){TC.wrap.Control.apply(this,arguments)},NavBar:function(){TC.wrap.Control.apply(this,arguments)},Coordinates:function(){TC.wrap.Control.apply(this,arguments)},Search:function(){TC.wrap.Control.apply(this,arguments)},Measure:function(){TC.wrap.Control.apply(this,arguments)},OverviewMap:function(){TC.wrap.Control.apply(this,arguments)},FeatureInfo:function(){TC.wrap.Control.apply(this,arguments)},Popup:function(){TC.wrap.Control.apply(this,arguments)},GeometryFeatureInfo:function(){TC.wrap.Control.apply(this,arguments)},Geolocation:function(){TC.wrap.Control.apply(this,arguments)},Draw:function(){TC.wrap.Control.apply(this,arguments)},CacheBuilder:function(){TC.wrap.Control.apply(this,arguments)},Edit:function(){TC.wrap.Control.apply(this,arguments)}},Feature:function(){}};TC.inherit(TC.wrap.layer.Raster,TC.wrap.Layer);TC.inherit(TC.wrap.layer.Vector,TC.wrap.Layer);TC.inherit(TC.wrap.control.Click,TC.wrap.Control);TC.inherit(TC.wrap.control.ScaleBar,TC.wrap.Control);TC.inherit(TC.wrap.control.NavBar,TC.wrap.Control);TC.inherit(TC.wrap.control.Coordinates,TC.wrap.Control);TC.inherit(TC.wrap.control.Measure,TC.wrap.Control);TC.inherit(TC.wrap.control.OverviewMap,TC.wrap.Control);TC.inherit(TC.wrap.control.Popup,TC.wrap.Control);TC.inherit(TC.wrap.control.FeatureInfo,TC.wrap.control.Click);TC.inherit(TC.wrap.control.GeometryFeatureInfo,TC.wrap.control.Click);TC.inherit(TC.wrap.control.Geolocation,TC.wrap.Control);TC.inherit(TC.wrap.control.Draw,TC.wrap.Control);TC.inherit(TC.wrap.control.CacheBuilder,TC.wrap.Control);TC.inherit(TC.wrap.control.Edit,TC.wrap.Control);TC.loadCSS(TC.apiLocation+"TC/css/tcmap.css");TC.Map||TC.syncLoadJS(TC.apiLocation+"TC/Map");TC.Util||TC.syncLoadJS(TC.apiLocation+"TC/Util");var o=1;TC.getUID=function(){var e=o.toString();o+=1;return e}}();!function(e,t){function o(e){return e}function r(e){
return decodeURIComponent(e.replace(i," "))}var i=/\+/g;e.cookie=function(i,n,a){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(n))||null===n)){a=e.extend({},e.cookie.defaults,a);null===n&&(a.expires=-1);if("number"==typeof a.expires){var l=a.expires,s=a.expires=new Date;s.setDate(s.getDate()+l)}n=String(n);return t.cookie=[encodeURIComponent(i),"=",a.raw?n:encodeURIComponent(n),a.expires?";expires="+a.expires.toUTCString():"",a.path?";path="+a.path:"",a.domain?";domain="+a.domain:"",a.secure?";secure":""].join("")}a=n||e.cookie.defaults||{};for(var p,c=a.raw?o:r,u=t.cookie.split("; "),g=0;p=u[g]&&u[g].split("=");g++)if(c(p.shift())===i)return c(p.join("="));return null};e.cookie.defaults={}}(jQuery,document)}$(function(){var e=function(){var e,t,o,r=(navigator.appVersion,navigator.userAgent),i=navigator.appName,n=""+parseFloat(navigator.appVersion),a=parseInt(navigator.appVersion,10);if(-1!=(t=r.indexOf("Opera"))){i="Opera";n=r.substring(t+6);-1!=(t=r.indexOf("Version"))&&(n=r.substring(t+8))}else if(-1!=(t=r.indexOf("MSIE"))){i="Microsoft Internet Explorer";n=r.substring(t+5)}else if(-1!=(t=r.indexOf("Chrome"))){i="Chrome";n=r.substring(t+7)}else if(-1!=(t=r.indexOf("Safari"))){i="Safari";n=r.substring(t+7);-1!=(t=r.indexOf("Version"))&&(n=r.substring(t+8))}else if(-1!=(t=r.indexOf("Firefox"))){i="Firefox";n=r.substring(t+8)}else if((e=r.lastIndexOf(" ")+1)<(t=r.lastIndexOf("/"))){i=r.substring(e,t);n=r.substring(t+1);i.toLowerCase()==i.toUpperCase()&&(i=navigator.appName)}-1!=(o=n.indexOf(";"))&&(n=n.substring(0,o));-1!=(o=n.indexOf(" "))&&(n=n.substring(0,o));a=parseInt(""+n,10);if(isNaN(a)){n=""+parseFloat(navigator.appVersion);a=parseInt(navigator.appVersion,10)}return{name:i,version:a}};TC.browser=e();if(TC.Cfg.oldBrowserAlert&&!Modernizr.mq("only all")&&!TC.Util.storage.getCookie(TC.Consts.OLD_BROWSER_ALERT)){alert("Con su "+TC.browser.name+" "+TC.browser.version+" la aplicaci\xf3n no funcionar\xe1. Le recomendamos que utilice un navegador m\xe1s actualizado.");TC.Util.storage.setCookie(TC.Consts.OLD_BROWSER_ALERT,1)}/ip(ad|hone|od)/i.test(navigator.userAgent)&&(TC.Consts.event.CLICK="touchstart.tc");window.JL||TC.syncLoadJS(TC.apiLocation+TC.Consts.url.JSNLOG);JL.defaultAjaxUrl=TC.Consts.url.ERROR_LOGGER;window.addEventListener("error",function(){var e=0,t=$("."+TC.Consts.classes.MAP).data("map");return function(o){var r=o.message,i=o.filename,n=o.lineno,a=o.colno,l=o.error,s=i.indexOf(TC.apiLocation)>0;if((TC.Cfg.notifyApplicationErrors||s)&&e<TC.Cfg.maxErrorCount){var p=s?TC.Consts.text.API_ERROR:TC.Consts.text.APP_ERROR;JL("onerrorLogger").fatalException({msg:p,errorMsg:r,url:i,lineNumber:n,column:a,appUrl:location.href,prevState:t.getPreviousMapState(),userAgent:navigator.userAgent},l);e++;if(!TC.isDebug){var c="webmaster@itracasa.es";$.when(TC.i18n.loadResources(!TC.i18n[t.options.locale],TC.apiLocation+"TC/resources/",t.options.locale)).done(function(){TC.error(TC.Util.getLocaleString(t.options.locale,"genericError")+(t.options.contactEmail||c),{type:TC.Consts.msgType.ERROR})})}}return!1}}(),!1)});TC.Layer=function(e){var t=this;t.options=e||{};$.extend(t,t.options);t.id=t.options.id||TC.getUID();t.map=t.options.map;t.type=t.options.type||TC.Consts.layerType.WMS;var o=t.options.isBase?TC.Consts.mimeType.JPEG:TC.Consts.mimeType.PNG;t.options.format=t.options.format||o;void 0===t.options.hideTree&&(t.options.hideTree=!0);void 0===t.options.hideTitle&&(t.options.hideTitle=!1);t._cache={visibilityStates:{}};t.tree=null;t.wrap=null};TC.Layer.state={IDLE:"idle",LOADING:"loading"};TC.Layer.prototype.setVisibility=function(e){this.wrap.setVisibility(e)};TC.Layer.prototype.getVisibility=function(){var e=this,t=!1;e.map&&(e.isBase&&e.map.getBaseLayer()!==e||(t=e.wrap.getVisibility()));return t};TC.Layer.prototype.getOpacity=function(){var e=this,t=!1;e.map&&(e.isBase&&e.map.getBaseLayer()!==e||(t=e.wrap.getLayer().getOpacity()));return t};TC.Layer.prototype.setOpacity=function(e,t){var o=this;$.when(this.wrap.getLayer()).then(function(r){r.setOpacity(e);o.map&&!t&&o.map.$events.trigger($.Event(TC.Consts.event.LAYEROPACITY,{layer:o,opacity:e}))})};TC.Layer.prototype.isCompatible=function(e){return!0};TC.Layer.prototype.isValidFromNames=function(){return!0};TC.Layer.prototype.isRaster=function(){var e=!0,t=this;switch(t.type){case TC.Consts.layerType.VECTOR:case TC.Consts.layerType.KML:case TC.Consts.layerType.WFS:case TC.Consts.layerType.GROUP:e=!1}return e};TC.Layer.prototype.isVisibleByScale=function(e){return!0};TC.Layer.prototype.isVisibleByName=function(e){return!0};TC.Layer.prototype.getTree=function(){var e=this,t={name:e.name,title:e.title};return t};TC.Layer.prototype.findNode=function e(t,o){var r=null;if(o.uid==t)r=o;else for(var i=0;i<o.children.length;i++){var n=e(t,o.children[i]);if(n){r=n;break}}return r};TC.Layer.prototype.setNodeVisibility=function(e,t){this.setVisibility(t)};TC.Layer.prototype.getNodeVisibility=function(e){return TC.Consts.visibility.VISIBLE};TC.Layer.prototype.getResolutions=function(){return this.wrap.getResolutions?this.wrap.getResolutions():[]};TC.control=TC.control||{};TC.Control=function(){var e=this;e.$events=$(e);e.map=null;e.isActive=!1;e.isDisabled=!1;e._firstRender=$.Deferred();var t=arguments.length;e.options=$.extend({},t>1?arguments[1]:arguments[0]);e.div=TC.Util.getDiv(e.options.div?e.options.div:arguments[0]);e._$div=$(e.div);e._$div.addClass(TC.Control.prototype.CLASS).addClass(e.CLASS);e.template=e.options.template||e.template};TC.Control.prototype.on=function(e,t){var o=this;o.$events.on(e,t);return o};TC.Control.prototype.one=function(e,t){var o=this;o.$events.one(e,t);return o};TC.Control.prototype.off=function(e,t){var o=this;o.$events.off(e,t);return o};TC.Control.prototype.CLASS="tc-ctl";TC.Control.prototype.template="";TC.Control.prototype.show=function(){this._$div.show()};TC.Control.prototype.hide=function(){this._$div.hide()};TC.Control.prototype.render=function(e){var t=this;t.renderData(null,e)};TC.Control.prototype.renderData=function(e,t){var o=this;if(o.map){var r=$.Event(TC.Consts.event.BEFORECONTROLRENDER,{dataObject:e});o.$events.trigger(r)}o._$div.toggleClass(TC.Consts.classes.DISABLED,o.isDisabled);TC.loadJSInOrder(!window.dust,TC.url.templating,function(){var r,i=function(e){var t=$.Deferred(),o=[];for(var r in e){var i=e[r];if("string"==typeof i){var n=$.ajax({url:i,type:"get",dataType:"html"});n.templateKey=r;o.push(n)}else $.isFunction(i)&&i()}0==o.length?t.resolve():$.when.apply($,o).then(function(){if(3!=arguments.length||$.isArray(arguments[0]))for(var e=0;e<arguments.length;e++){var o=arguments[e],r=o[0],i=o[2].templateKey,n=dust.compile(r,i);dust.loadSource(n)}else{var r=arguments[0],i=arguments[2].templateKey,n=dust.compile(r,i);dust.loadSource(n)}t.resolve()},function(e,t,o){console.error("Deferred fallido")});return t};if("object"==typeof o.template)r=i(o.template);else{var n={};o.template&&(n[o.CLASS]=o.template);r=i(n)}r.then(function(){dust.cache[o.CLASS]&&dust.render(o.CLASS,e,function(e,t){o._$div.html(t);e&&TC.error(e)});o._firstRender.resolve();o.$events.trigger($.Event(TC.Consts.event.CONTROLRENDER));$.isFunction(t)&&t()})})};TC.Control.prototype.getRenderedHtml=function(e,t,o){var r=this,i=$.Deferred(),n=function(){dust.cache[e]&&dust.render(e,t,function(e,t){if(e){TC.error(e);i.reject()}else{$.isFunction(o)&&o(t);i.resolve(t)}})};TC.loadJSInOrder(!window.dust,TC.url.templating,function(){if(dust.cache[e])n();else{var t=r.template[e];if("string"==typeof t)$.ajax({url:t,type:"get",dataType:"html"}).done(function(){var t=arguments[0],o=dust.compile(t,e);dust.loadSource(o);n()});else if($.isFunction(t)){t();n()}}});return i};TC.Control.prototype.register=function(e){var t=this;t.map=e;t.render();t.options.active&&t.activate()};TC.Control.prototype.activate=function(){var e=this;if(e.map&&e.map.activeControl&&e.map.activeControl!=e){e.map.previousActiveControl=e.map.activeControl;e.map.activeControl.deactivate()}e.isActive=!0;if(e.map){e.map.activeControl=e;e.map.$events.trigger($.Event(TC.Consts.event.CONTROLACTIVATE,{control:e}));e.$events.trigger($.Event(TC.Consts.event.CONTROLACTIVATE,{control:e}))}};TC.Control.prototype.deactivate=function(e){0==arguments.length&&(e=!1);var t=this;t.isActive=!1;if(t.map){t.map.activeControl=null;if(!e){var o=t.map.getDefaultControl();o==t?o=null:t.map.previousActiveControl==t?o=null:o||(o=t.map.previousActiveControl);o&&o.activate()}t.map.$events.trigger($.Event(TC.Consts.event.CONTROLDEACTIVATE,{control:t}));t.$events.trigger($.Event(TC.Consts.event.CONTROLDEACTIVATE,{control:t}))}};TC.Control.prototype.enable=function(){var e=this;e.isDisabled=!1;e._$div&&e._$div.removeClass(TC.Consts.classes.DISABLED)};TC.Control.prototype.disable=function(){var e=this;e.isDisabled=!0;e._$div&&e._$div.addClass(TC.Consts.classes.DISABLED)};TC.Control.prototype.renderPromise=function(){return this._firstRender};TC.Control.prototype.isExclusive=function(){return!1};TC.Control.prototype.getLocaleString=function(e,t){var o=this,r=o.map?o.map.options.locale:TC.Cfg.locale;return TC.Util.getLocaleString(r,e,t)};TC.feature=TC.feature||{};TC.Feature=function(e,t){var o=this;o.wrap=new TC.wrap.Feature;o.wrap.parent=o;if($.isArray(e))o.geometry=e;else if(o.wrap.isNative(e)){o.wrap.feature=e;o.id=o.wrap.getId();o.geometry=o.wrap.getGeometry();o.folders=e._folders;o.data=o.wrap.getData()}var r=o.options=$.extend(!0,{},t);o.id=o.id||r.id||TC.getUID();o.data=r.data||o.data||null;o._visibilityState=TC.Consts.visibility.VISIBLE;o.showsPopup=void 0===r.showsPopup?!0:r.showsPopup;o.layer=r.layer||null;o._selected=!1;r.selected&&o.select()};TC.Feature.prototype.STYLETYPE=TC.Consts.geom.POLYGON;TC.Feature.prototype.CLASSNAME="TC.Feature";TC.Feature.prototype.getPath=function(){var e=[],t=this;t.folders?e=t.folders:t.options.group&&(e=[t.options.group]);return e};TC.Feature.prototype.setVisibility=function(e){var t=this;if(e&&t._visibilityState===TC.Consts.visibility.NOT_VISIBLE||!e&&t._visibilityState===TC.Consts.visibility.VISIBLE){t._visibilityState=e?TC.Consts.visibility.VISIBLE:TC.Consts.visibility.NOT_VISIBLE;t.layer.wrap.setFeatureVisibility(t,e)}};TC.Feature.prototype.setId=function(e){var t=this;t.id=e;t.wrap.setId(e)};TC.Feature.prototype.getBounds=function(){return this.wrap.getBounds()};TC.Feature.prototype.setStyle=function(e){var t=this;$.extend(!0,t.options,e);this.wrap.setStyle(t.options)};TC.Feature.prototype.getLegend=function(){var e=this;e._legend||(e._legend=e.wrap.getLegend());return e._legend};TC.Feature.prototype.getData=function(){var e=null,t=this;e=t.data?t.data:t.wrap.getData();return e};TC.Feature.prototype.setData=function(e){var t=this;t.data=$.extend(t.data,e);t.wrap.setData(e)};TC.Feature.prototype.getInfo=function(){var e=null,t=this,o=t.layer&&t.layer.map&&TC.Util.getMapLocale(t.layer.map),r=t.getData();if("object"==typeof r){var i=t.wrap.getTemplate();if(i)e=i.replace(/\$\[?(?:\w+\/)*(\w+)\]/g,function(e,t){return r[t]});else{var n=[];for(var a in r){var l=r[a];if("string"==typeof l||"number"==typeof l||"undefined"==typeof l){n[n.length]="<tr><th>";n[n.length]=a;n[n.length]="</th><td>";var s=TC.Util.isURL(l);if(s){n[n.length]='<a href="';n[n.length]=l;n[n.length]='" target="_blank">'}n[n.length]=void 0!==l?TC.Util.formatNumber(l,o):"&mdash;";s&&(n[n.length]="</a>");n[n.length]="</td></tr>"}}if(n.length>0){n.unshift("<table>");n[n.length]="</table>";e=n.join("")}}}else"string"==typeof r&&(e=r);if(!e){e=t.title;t.group&&(e+=" "+t.group)}e||(e=TC.Util.getLocaleString(o.replace("-","_"),"noData"));return e};TC.Feature.prototype.clone=function(){var e=this,t=e.wrap.cloneFeature();t._wrap=e.wrap;return new e.constructor(t,e.options)};TC.Feature.prototype.getStyle=function(){return this.wrap.getStyle()};TC.Feature.prototype.showPopup=function(e){var t=this;if(t.layer&&t.layer.map){var o,r=e||t.popup;if(!r)for(var i=t.layer.map.getControlsByClass("TC.control.Popup"),n=0,a=i.length;a>n;n++){var l=i[n];if(!l.caller){r=l;break}}if(r){o=$.Deferred();o.resolve(r)}else TC.loadJS(!TC.control||!TC.control.Popup,[TC.apiLocation+"TC/control/Popup"],function(){o=t.layer.map.addControl(new TC.control.Popup)});o.then(function(e){e.currentFeature=t;for(var o=t.layer.map.getControlsByClass(TC.control.Popup),r=0,i=o.length;i>r;r++){var n=o[r];n!==e&&n.hide()}t.wrap.showPopup(e);t.layer.map.$events.trigger($.Event(TC.Consts.event.POPUP,{control:e}));e.fitToView(!0)})}};TC.Feature.prototype.select=function(){var e=this;e._selected=!0;e.layer&&e.layer.selectedFeatures.push(e);var t=e.options.selection||{};e.setStyle($.extend({},TC.Cfg.styles.selection[e.STYLETYPE],t[e.STYLETYPE]))};TC.Feature.prototype.unselect=function(){var e=this;e._selected=!1;e.setStyle();if(e.layer){var t=$.inArray(e,e.layer.selectedFeatures);t>=0&&e.layer.selectedFeatures.splice(t,1)}};TC.Feature.prototype.isSelected=function(){return this._selected};TC.Feature.prototype.toGML=function(e,t){return this.wrap.toGML(e,t)};TC.feature=TC.feature||{};TC.Feature||TC.syncLoadJS(TC.apiLocation+"TC/Feature");TC.feature.Point=function(e,t){var o=this;TC.Feature.apply(o,arguments);var r;if(o.wrap.isNative(e)){e._wrap=o.wrap;o.wrap.feature=e}else{r=o.options=$.extend(!0,o.options,TC.Cfg.styles.point,t);o.wrap.createPoint(e,r)}};TC.inherit(TC.feature.Point,TC.Feature);!function(){var e=TC.feature.Point.prototype;e.STYLETYPE=TC.Consts.geom.POINT;e.CLASSNAME="TC.feature.Point";e.getCoords=function(){return this.wrap.getGeometry()};e.setCoords=function(e){return this.wrap.setGeometry(e)}}();TC.feature=TC.feature||{};TC.Feature||TC.syncLoadJS(TC.apiLocation+"TC/Feature");TC.feature.Circle=function(e,t){var o=this;TC.Feature.apply(o,arguments);var r;if(o.wrap.isNative(e)){e._wrap=o.wrap;o.wrap.feature=e}else{r=o.options=$.extend(!0,o.options,TC.Cfg.styles.polygon,t);o.wrap.createCircle(e,r)}};TC.inherit(TC.feature.Circle,TC.Feature);!function(){var e=TC.feature.Circle.prototype;e.STYLETYPE=TC.Consts.geom.POLYGON;e.CLASSNAME="TC.feature.Circle";e.getCoords=function(){return this.wrap.getGeometry()};e.setCoords=function(e){return this.wrap.setGeometry(e)}}();TC.feature=TC.feature||{};TC.feature.Point||TC.syncLoadJS(TC.apiLocation+"TC/feature/Point");TC.feature.Marker=function(e,t){var o=this;TC.Feature.apply(o,arguments);if(o.wrap.isNative(e)){e._wrap=o.wrap;o.wrap.feature=e}else{var r=o.options=$.extend(!0,o.options,TC.Cfg.styles.marker,t),i=o.layer&&o.layer.map?o.layer.map.options.locale:TC.Cfg.locale;o.title=r.title||TC.i18n[i][TC.Consts.MARKER];o.wrap.createMarker(e,r)}};TC.inherit(TC.feature.Marker,TC.feature.Point);TC.feature.Marker.prototype.STYLETYPE="marker";TC.feature.Marker.prototype.CLASSNAME="TC.feature.Marker";TC.feature=TC.feature||{};TC.Feature||TC.syncLoadJS(TC.apiLocation+"TC/Feature");TC.feature.MultiPolygon=function(e,t){var o=this;TC.Feature.apply(o,arguments);var r;if(o.wrap.isNative(e)){e._wrap=o.wrap;o.wrap.feature=e}else{r=o.options=$.extend(!0,o.options,TC.Cfg.styles.polygon,t);o.wrap.createMultiPolygon(e,r)}};TC.inherit(TC.feature.MultiPolygon,TC.Feature);TC.feature.MultiPolygon.prototype.STYLETYPE=TC.Consts.geom.POLYGON;TC.feature.MultiPolygon.prototype.CLASSNAME="TC.feature.MultiPolygon";TC.feature=TC.feature||{};TC.Feature||TC.syncLoadJS(TC.apiLocation+"TC/Feature");TC.feature.MultiPolyline=function(e,t){var o=this;TC.Feature.apply(o,arguments);var r;if(o.wrap.isNative(e)){e._wrap=o.wrap;o.wrap.feature=e}else{r=o.options=$.extend(!0,o.options,TC.Cfg.styles.line,t);o.wrap.createMultiPolyline(e,r)}};TC.inherit(TC.feature.MultiPolyline,TC.Feature);TC.feature.MultiPolyline.prototype.STYLETYPE=TC.Consts.geom.POLYLINE;TC.feature.MultiPolyline.prototype.CLASSNAME="TC.feature.MultiPolyline";TC.feature=TC.feature||{};TC.Feature||TC.syncLoadJS(TC.apiLocation+"TC/Feature");TC.feature.Polygon=function(e,t){var o=this;TC.Feature.apply(o,arguments);var r;if(o.wrap.isNative(e)){e._wrap=o.wrap;o.wrap.feature=e}else{r=o.options=$.extend(!0,o.options,TC.Cfg.styles.polygon,t);o.wrap.createPolygon(e,r)}};TC.inherit(TC.feature.Polygon,TC.Feature);TC.feature.Polygon.prototype.STYLETYPE=TC.Consts.geom.POLYGON;TC.feature.Polygon.prototype.CLASSNAME="TC.feature.Polygon";TC.feature=TC.feature||{};TC.Feature||TC.syncLoadJS(TC.apiLocation+"TC/Feature");TC.feature.Polyline=function(e,t){var o=this;TC.Feature.apply(o,arguments);var r;if(o.wrap.isNative(e)){e._wrap=o.wrap;o.wrap.feature=e}else{r=o.options=$.extend(!0,o.options,TC.Cfg.styles.line,t);o.wrap.createPolyline(e,r)}};TC.inherit(TC.feature.Polyline,TC.Feature);TC.feature.Polyline.prototype.STYLETYPE=TC.Consts.geom.POLYLINE;TC.feature.Polyline.prototype.CLASSNAME="TC.feature.Polyline";TC.filter={};TC.filter.Filter=function(e){this.tagName_=e};TC.filter.Filter.prototype.getTagName=function(){return this.tagName_};TC.filter.Filter.prototype.writeFilterCondition_=function(){var e=this;return'<{prefix}:Filter xmlns:ogc="http://www.opengis.net/ogc">{inner}</{prefix}:Filter>'.format({prefix:"ogc",tag:e.getTagName(),inner:this.writeInnerCondition_(e)})};TC.filter.Filter.prototype.writeInnerCondition_=function(e){return e instanceof TC.filter.LogicalNary?e.write():e instanceof TC.filter.ComparisonBinary?e.write():e instanceof TC.filter.Comparison?e.write():(e instanceof TC.filter.Spatial,e.write())};TC.filter.Filter.prototype.writeInnerArrayCondition_=function(e){return e.reduce(function(e,t,o){return(e instanceof TC.filter.Filter?e.writeInnerCondition_(e):e)+t.writeInnerCondition_(t)})};TC.filter.Filter.prototype.getText=function(){return this.writeFilterCondition_()};TC.filter.and=function(e){var t=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(TC.filter.And,t))};TC.filter.or=function(e){var t=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(TC.filter.Or,t))};TC.filter.not=function(e){return new TC.filter.Not(e)};TC.filter.bbox=function(e,t,o){return new TC.filter.Bbox(e,t,o)};TC.filter.intersects=function(e,t,o){return new TC.filter.Intersects(e,t,o)};TC.filter.within=function(e,t,o){return new TC.filter.Within(e,t,o)};TC.filter.equalTo=function(e,t,o){return new TC.filter.EqualTo(e,t,o)};TC.filter.notEqualTo=function(e,t,o){return new TC.filter.NotEqualTo(e,t,o)};TC.filter.lessThan=function(e,t){return new TC.filter.LessThan(e,t)};TC.filter.lessThanOrEqualTo=function(e,t){return new TC.filter.LessThanOrEqualTo(e,t)};TC.filter.greaterThan=function(e,t){return new TC.filter.GreaterThan(e,t)};TC.filter.greaterThanOrEqualTo=function(e,t){return new TC.filter.GreaterThanOrEqualTo(e,t)};TC.filter.isNull=function(e){return new TC.filter.IsNull(e)};TC.filter.between=function(e,t,o){return new TC.filter.IsBetween(e,t,o)};TC.filter["function"]=function(e,t){return new TC.filter.Function(e,t)};TC.filter.like=function(e,t,o,r,i,n){return new TC.filter.IsLike(e,t,o,r,i,n)};TC.filter.LogicalNary=function(e,t){TC.filter.Filter.call(this,e);this.conditions=Array.prototype.slice.call(arguments,1)};TC.inherit(TC.filter.LogicalNary,TC.filter.Filter);TC.filter.And=function(e){var t=["And"].concat(Array.prototype.slice.call(arguments));TC.filter.LogicalNary.apply(this,t)};TC.inherit(TC.filter.And,TC.filter.LogicalNary);TC.filter.Or=function(e){var t=["Or"].concat(Array.prototype.slice.call(arguments));TC.filter.LogicalNary.apply(this,t)};TC.inherit(TC.filter.Or,TC.filter.LogicalNary);TC.filter.LogicalNary.prototype.write=function(){return"<{prefix}:{tag}>{inner}</{prefix}:{tag}>".format({prefix:"ogc",tag:this.getTagName(),inner:this.writeInnerArrayCondition_(this.conditions)})};TC.filter.Not=function(e){TC.filter.Filter.call(this,"Not");this.condition=e};TC.inherit(TC.filter.Not,TC.filter.Filter);TC.filter.Bbox=function(e,t,o){TC.filter.Filter.call(this,"BBOX");this.geometryName=e;this.extent=t;this.srsName=o};TC.inherit(TC.filter.Bbox,TC.filter.Filter);TC.filter.Comparison=function(e,t){TC.filter.Filter.call(this,e);this.propertyName=t};TC.inherit(TC.filter.Comparison,TC.filter.Filter);TC.filter.Comparison.prototype.write=function(){var e="";this.lowerBoundary&&this.upperBoundary&&(e="<ogc:LowerBoundary><ogc:Literal>{LowerBoundary}</ogc:Literal></ogc:LowerBoundary><ogc:UpperBoundary><ogc:Literal>{UpperBoundary}</ogc:Literal></ogc:UpperBoundary>".format({LowerBoundary:this.lowerBoundary,UpperBoundary:this.upperBoundary}));this.pattern&&(e="<ogc:Literal>{Pattern}</ogc:Literal>".format({Pattern:this.pattern}));this.params&&(e=$.isArray(this.params)?this.params.reduce(function(e,t,o){var r=function(e){return"<ogc:Literal>{value}</ogc:Literal>".format({value:e})};return(o>0?e:r(e))+r(t)}):"<ogc:Literal>{value}</ogc:Literal>".format({value:this.params}));return"<{prefix}:{tag}{matchCase}{escape}{singleChar}{wildCard}><{prefix}:PropertyName>{name}</{prefix}:PropertyName>{values}</{prefix}:{tag}>".format({prefix:"ogc",tag:this.getTagName(),matchCase:"undefined"!=typeof this.matchCase?' matchCase="'+this.matchCase+'"':"",escape:"undefined"!=typeof this.escapeChar?' escape="'+this.escapeChar+'"':"",singleChar:"undefined"!=typeof this.singleChar?' singleChar="'+this.singleChar+'"':"",wildCard:"undefined"!=typeof this.wildCard?' wildCard="'+this.wildCard+'"':"",name:this.propertyName,values:e})};TC.filter.ComparisonBinary=function(e,t,o,r){TC.filter.Comparison.call(this,e,t);this.expression=o;this.matchCase=r};TC.inherit(TC.filter.ComparisonBinary,TC.filter.Comparison);TC.filter.ComparisonBinary.prototype.write=function(){return"<{prefix}:{tag}{matchCase}><{prefix}:PropertyName>{name}</{prefix}:PropertyName><{prefix}:Literal>{value}</{prefix}:Literal></{prefix}:{tag}>".format({prefix:"ogc",tag:this.getTagName(),matchCase:"undefined"!=typeof this.matchCase?' matchCase="'+this.matchCase+'"':"",name:this.propertyName,value:this.expression})};TC.filter.EqualTo=function(e,t,o){TC.filter.ComparisonBinary.call(this,"PropertyIsEqualTo",e,t,o)};TC.inherit(TC.filter.EqualTo,TC.filter.ComparisonBinary);TC.filter.GreaterThan=function(e,t){TC.filter.ComparisonBinary.call(this,"PropertyIsGreaterThan",e,t)};TC.inherit(TC.filter.GreaterThan,TC.filter.ComparisonBinary);TC.filter.GreaterThanOrEqualTo=function(e,t){TC.filter.ComparisonBinary.call(this,"PropertyIsGreaterThanOrEqualTo",e,t)};TC.inherit(TC.filter.GreaterThanOrEqualTo,TC.filter.ComparisonBinary);TC.filter.LessThan=function(e,t){TC.filter.ComparisonBinary.call(this,"PropertyIsLessThan",e,t)};TC.inherit(TC.filter.LessThan,TC.filter.ComparisonBinary);TC.filter.LessThanOrEqualTo=function(e,t){TC.filter.ComparisonBinary.call(this,"PropertyIsLessThanOrEqualTo",e,t)};TC.inherit(TC.filter.LessThanOrEqualTo,TC.filter.ComparisonBinary);TC.filter.NotEqualTo=function(e,t,o){TC.filter.ComparisonBinary.call(this,"PropertyIsNotEqualTo",e,t,o)};TC.inherit(TC.filter.NotEqualTo,TC.filter.ComparisonBinary);TC.filter.IsLike=function(e,t,o,r,i,n){TC.filter.Comparison.call(this,"PropertyIsLike",e);this.pattern=t;this.wildCard=void 0!==o?o:"*";this.singleChar=void 0!==r?r:".";this.escapeChar=void 0!==i?i:"!";this.matchCase=n};TC.inherit(TC.filter.IsLike,TC.filter.Comparison);TC.filter.IsNull=function(e){TC.filter.Comparison.call(this,"PropertyIsNull",e)};TC.inherit(TC.filter.IsNull,TC.filter.Comparison);TC.filter.IsBetween=function(e,t,o){TC.filter.Comparison.call(this,"PropertyIsBetween",e);this.lowerBoundary=t;this.upperBoundary=o};TC.inherit(TC.filter.IsBetween,TC.filter.Comparison);TC.filter.Function=function(e,t){TC.filter.Comparison.call(this,"Function",e);this.params=t};TC.inherit(TC.filter.Function,TC.filter.Comparison);TC.filter.Spatial=function(e,t,o,r){TC.filter.Filter.call(this,e);this.geometryName=t||"the_geom";this.geometry=o;this.srsName=r};TC.inherit(TC.filter.Spatial,TC.filter.Filter);TC.filter.Spatial.prototype.write=function(){return"<{prefix}:{tag}><{prefix}:PropertyName>{name}</{prefix}:PropertyName>{geometry}</{prefix}:{tag}>".format({prefix:"ogc",tag:this.getTagName(),name:this.geometryName,srsName:"undefined"!=typeof this.srsName?' srsName="'+this.srsName+'"':"",geometry:this.geometry.wrap.toGML()})};TC.filter.Bbox=function(e,t,o){TC.filter.Filter.call(this,"BBOX");this.geometryName=e;this.extent=t;this.srsName=o};TC.inherit(TC.filter.Bbox,TC.filter.Filter);TC.filter.Bbox.prototype.write=function(){var e="<gml:Envelope{srsName}><gml:lowerCorner>{lowerCorner}</gml:lowerCorner><gml:upperCorner>{upperCorner}</gml:upperCorner></gml:Envelope>".format({srsName:"undefined"!=typeof this.srsName?' srsName="'+this.srsName+'"':"",lowerCorner:this.extent[0]+" "+this.extent[1],upperCorner:this.extent[2]+" "+this.extent[3]});return"<{prefix}:{tag}><{prefix}:PropertyName>{name}</{prefix}:PropertyName>{BBOX}</{prefix}:{tag}>".format({prefix:"ogc",tag:this.getTagName(),name:this.geometryName,BBOX:e})};TC.filter.Intersects=function(e,t,o){TC.filter.Spatial.call(this,"Intersects",e,t,o)};TC.inherit(TC.filter.Intersects,TC.filter.Spatial);TC.filter.Within=function(e,t,o){TC.filter.Spatial.call(this,"Within",e,t,o)};TC.inherit(TC.filter.Within,TC.filter.Spatial);TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.MapContents=function(){var e=this;TC.Control.apply(e,arguments);e.layerTrees={}};TC.inherit(TC.control.MapContents,TC.Control);!function(){var e=TC.control.MapContents.prototype;e.CLASS="tc-ctl-mc";var t={layer:"tcLayer",img:"tcImg"};e.render=function(e){var t=this;t.map&&t.renderData(t.map.getLayerTree(),e)};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);t.render(function(){for(var o=0,r=e.layers.length;r>o;o++)t.updateLayerTree(e.layers[o]);e.on(TC.Consts.event.ZOOM,function(){t.updateScale()}).on(TC.Consts.event.UPDATEPARAMS,function(e){var o=e.layer.names,r=function i(e){var t=!1;if(e)if($.inArray(e.name,o)>=0)t=!0;else for(var r=0;r<e.children.length;r++)if(i(e.children[r])){t=!0;break}return t};r(t.layerTrees[e.layer.id])||0===o.length?t.update():t.updateLayerTree(e.layer)}).on(TC.Consts.event.LAYERVISIBILITY,function(e){t.updateLayerVisibility(e.layer)}).on(TC.Consts.event.LAYERADD,function(e){t.updateLayerTree(e.layer)}).on(TC.Consts.event.VECTORUPDATE+" "+TC.Consts.event.FEATUREADD+" "+TC.Consts.event.FEATURESADD,function(e){t._updateLayerTreeTimeout&&clearTimeout(t._updateLayerTreeTimeout);t._updateLayerTreeTimeout=setTimeout(function(){if(t.map.workLayers.indexOf(e.layer)>-1){t.updateLayerTree(e.layer);delete t._updateLayerTreeTimeout}},100)}).on(TC.Consts.event.LAYERREMOVE,function(e){t.removeLayer(e.layer)}).on(TC.Consts.event.LAYERORDER,function(e){t.updateLayerOrder(e.layer,e.oldIndex,e.newIndex)})})};e.updateScale=function(){};e.updateLayerVisibility=function(e){};e.updateLayerTree=function(e){this.layerTrees[e.id]=e.getTree()};e.updateLayerOrder=function(e,o,r){var i=this;if(o>=0&&o!==r)for(var n,a,l=i.getLayerUIElements(),s=i.map.workLayers.length-1;s>=0;s--){var p=i.map.workLayers[s];a=n;l.each(function(e,o){var r=$(o);if(r.data(t.layer)===p){n=r;return!1}});if(p===e){a?a.after(n):l.parent().prepend(n);break}}};e.removeLayer=function(e){this.update()};e.getLayerUIElements=function(){var e=this;return e._$div.find("ul").first().children()};var o=function(e){return/[&?]REQUEST=getLegendGraphic/i.test(e)},r=function(e,t,o){var r="error.tc";TC.Cfg.proxy&&e.off(r).on(r,function(){e.attr("src",TC.proxify(t))});var i=/^(https?:)?\/\//i;if(TC.Util.isSecureURL(document.location.href)&&!TC.Util.isSecureURL(t)){var n="";n=1==o?t.replace(i,"https://"):TC.isUsingServiceWorker()?TC.proxify(t):t;e.attr("src",n)}else e.attr("src",i.test(t)?t.substr(t.indexOf("//")):t)};e.styleLegendImage=function(e,i){if(!e.attr("src")){var n=e.data(t.img);if(i&&i.options.method&&"POST"===i.options.method)i.getLegendGraphicImage().done(function(t){r(e,t)}).fail(function(e){TC.error(e)});else{if(o(n)){var a=e.parent(),l=a.css("color"),s=l.indexOf("("),p=l.indexOf(")");if(s>=0&&p>s){color=l.substr(0,p).substr(s+1).split(",");l="0x";for(var c=0;3>c;c++){var u=parseInt(color[c]).toString(16);l+=1===u.length?"0"+u:u}}else l.replace("#","0x");n+="&LEGEND_OPTIONS=fontName:"+a.css("font-family")+";fontSize:"+parseInt(a.css("font-size"))+";fontColor:"+l+";fontAntiAliasing:true";i.params&&i.params.sld_body&&(n=TC.Util.addURLParameters(n,{sld_body:i.params.sld_body}));e.data(t.img,n)}r(e,n,i.usesSSL)}}}}();TC.control=TC.control||{};TC.control.MapContents||TC.syncLoadJS(TC.apiLocation+"TC/control/MapContents");TC.control.TOC=function(){var e=this;TC.control.MapContents.apply(e,arguments)};TC.inherit(TC.control.TOC,TC.control.MapContents);!function(){var e=TC.control.TOC.prototype;e.CLASS="tc-ctl-toc";e.template={};if(TC.isDebug){e.template[e.CLASS]=TC.apiLocation+"TC/templates/TOC.html";e.template[e.CLASS+"-branch"]=TC.apiLocation+"TC/templates/TOCBranch.html";e.template[e.CLASS+"-node"]=TC.apiLocation+"TC/templates/TOCNode.html"}else{e.template[e.CLASS]=function(){function t(e,t){return e.w("<h2>").h("i18n",t,{},{$key:"worklayers"}).w('</h2><div class="tc-ctl-toc-tree"><form><div class="tc-ctl-toc-empty">').h("i18n",t,{},{$key:"noData"}).w('</div><ul class="tc-ctl-toc-branch tc-ctl-toc-wl">').s(t.get(["workLayers"],!1),t,{block:o},{}).w("</ul></form></div>")}function o(e,t){return e.p("tc-ctl-toc-wlbranch",t,t.rebase(t.getPath(!0,[])),{})}dust.register(e.CLASS,t);t.__dustBody=!0;o.__dustBody=!0;return t};e.template[e.CLASS+"-branch"]=function(){function t(e,t){return e.w("<li ").x(t.get(["children"],!1),t,{"else":o,block:r},{}).w(' data-tc-layer-name="').f(t.get(["name"],!1),t,"h").w('" data-tc-layer-uid="').f(t.get(["uid"],!1),t,"h").w('"><input type="checkbox" class="tc-ctl-toc-branch-cb" name="toc" value="').f(t.get(["name"],!1),t,"h").w('"').x(t.get(["isVisible"],!1),t,{block:i},{}).w(" /><span>").f(t.get(["title"],!1),t,"h").w('</span><ul class="tc-ctl-toc-branch">').s(t.get(["children"],!1),t,{block:n},{}).w("</ul></li>")}function o(e,t){return e.w('class="tc-ctl-toc-node tc-ctl-toc-leaf"')}function r(e,t){return e.w('class="tc-ctl-toc-node"')}function i(e,t){return e.w(" checked")}function n(e,t){return e.p("tc-ctl-toc-node",t,t.rebase(t.getPath(!0,[])),{})}dust.register(e.CLASS+"-branch",t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;n.__dustBody=!0;return t};e.template[e.CLASS+"-node"]=function(){function t(e,t){return e.w("<li ").x(t.get(["children"],!1),t,{"else":o,block:r},{}).w(' data-tc-layer-name="').f(t.get(["name"],!1),t,"h").w('" data-tc-layer-uid="').f(t.get(["uid"],!1),t,"h").w('"><input type="checkbox" name="toc" value="').f(t.get(["name"],!1),t,"h").w('"').x(t.get(["isVisible"],!1),t,{block:i},{}).w(" /><span>").f(t.get(["title"],!1),t,"h").w('</span><ul class="tc-ctl-toc-branch">').s(t.get(["children"],!1),t,{block:n},{}).w("</ul></li>")}function o(e,t){return e.w('class="tc-ctl-toc-node tc-ctl-toc-leaf"')}function r(e,t){return e.w('class="tc-ctl-toc-node"')}function i(e,t){return e.w(" checked")}function n(e,t){return e.p("tc-ctl-toc-node",t,t.rebase(t.getPath(!0,[])),{})}dust.register(e.CLASS+"-node",t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;n.__dustBody=!0;return t}}var t={layer:"tcLayer",layerUid:"tcLayerUid"},o="click.tc";e.register=function(e){var t=this;TC.control.MapContents.prototype.register.call(t,e);t._addBrowserEventHandlers();e.on(TC.Consts.event.EXTERNALSERVICEADDED,function(o){if(o&&o.layer){o.layer.map=e;e.addLayer(o.layer);t.updateLayerTree(o.layer)}})};e._addBrowserEventHandlers=function(){var e=this;e._$div.on(o,"input[type=checkbox]",function(o){var r=$(o.target),i=r.closest("ul."+e.CLASS+"-wl").children("li").has(r).data(t.layer),n=r.parents("li").first().data(t.layerUid),a=r.prop("checked");i.setNodeVisibility(n,a);o.stopPropagation()}).on(TC.Consts.event.MOUSEUP,"li",function(t){var o=$(t.target);if(!o.hasClass(e.CLASS+"-leaf")){o.toggleClass(TC.Consts.classes.COLLAPSED);o.find("ul").first().toggleClass(TC.Consts.classes.COLLAPSED);t.stopPropagation()}})};e.update=function(){var e=this,o=function(e){return e.children("input[type=checkbox]")},r=e._$div.find("ul."+e.CLASS+"-wl").first();r.children("li").each(function(e,r){var i=$(r),n=i.data(t.layer);

if(n){var a=n.getVisibility();o(i).prop("checked",a);n.tree=null;i.find("li").each(function(e,r){var i=$(r),a=o(i),l=i.data(t.layerUid);switch(n.getNodeVisibility(l)){case TC.Consts.visibility.VISIBLE:a.prop("checked",!0);a.prop("indeterminate",!1);break;case TC.Consts.visibility.NOT_VISIBLE_AT_RESOLUTION:a.prop("checked",!0);a.prop("indeterminate",!1);break;case TC.Consts.visibility.HAS_VISIBLE:a.prop("checked",!1);a.prop("indeterminate",!0);break;default:a.prop("checked",!1);a.prop("indeterminate",!1)}})}});e.updateScale()};e.updateScale=function(){var e=this;e._$div.find("ul."+e.CLASS+"-wl").children("li").each(function(o,r){var i=$(r),n=i.data(t.layer);i.find("li").each(function(o,r){var i=$(r);i.toggleClass(e.CLASS+"-node-notvisible",!n.isVisibleByScale(i.data(t.layerUid)))})})};e.updateLayerTree=function(e){var o=this;if(!e.isBase&&!e.options.stealth){TC.control.MapContents.prototype.updateLayerTree.call(o,e);o._$div.find("."+o.CLASS+"-empty").addClass(TC.Consts.classes.HIDDEN);var r=o.CLASS+"-branch";TC.loadJSInOrder(!window.dust,TC.url.templating,function(){dust.render(r,o.layerTrees[e.id],function(r,i){var n=$(i);Modernizr.canvas||n.find("li:last-child").addClass(TC.Consts.classes.LASTCHILD);var a=n.data(t.layerUid),l=o._$div.find("."+o.CLASS+"-wl"),s=l.find('li[data-tc-layer-uid="'+a+'"]');if(1===s.length){s.html(n.html());s.data(t.layer)||s.data(t.layer,e)}else{n.data(t.layer,e);l.prepend(n)}r&&TC.error(r)});var i="ul."+o.CLASS+"-wl",n="ul."+o.CLASS+"-branch",a="li."+o.CLASS+"-node",l="li."+o.CLASS+"-leaf";o._$div.find(i+" "+n+" "+n+","+i+" "+n+" "+a).not(l).addClass(TC.Consts.classes.COLLAPSED);o.update()})}};e.removeLayer=function(e){if(!e.isBase){var o=this,r=function(){return o._$div.find("."+o.CLASS+"-wl").children("li")},i=r();i.each(function(o,n){var a=$(n);if(a.data(t.layer)===e){a.remove();i=r();return!1}});0===i.length&&o._$div.find("."+o.CLASS+"-empty").removeClass(TC.Consts.classes.HIDDEN)}};e.updateLayerVisibility=function(e){var o=this;o._$div.find("."+o.CLASS+"-wl").children("li").each(function(r,i){var n=$(i);if(n.data(t.layer)===e){var a=!e.getVisibility(),l=n.find("input[type=checkbox]"),s=l.filter("."+o.CLASS+"-branch-cb");s.prop("checked",!a);l.not(s).prop("disabled",a);return!1}})};e.updateLayerOrder=function(e,t,o){};e.render=function(e){var t=this;TC.Control.prototype.render.call(t,function(){var o=t.options.controls||[];if(o.length>0){var r=o[0],i=$("<div/>");t._$div.append(i);t.map.addControl(r.name,$.extend({div:i},r.options))}$.isFunction(e)&&e()})}}();TC.control=TC.control||{};TC.control.TOC||TC.syncLoadJS(TC.apiLocation+"TC/control/TOC");TC.control.ListTOC=function(){var e=this;TC.control.TOC.apply(e,arguments);e.layers=[]};TC.inherit(TC.control.ListTOC,TC.control.TOC);!function(){var e=TC.control.ListTOC.prototype;e.CLASS="tc-ctl-ltoc";e.CLICKEVENT="click.tc";TC.Consts.classes.DRAG=TC.Consts.classes.DRAG||"tc-drag";TC.Consts.classes.DRAGEND=TC.Consts.classes.DRAGEND||"tc-dragend";TC.Consts.event.TOOLSOPEN=TC.Consts.event.TOOLSOPEN||"toolsopen.tc";e.template={};if(TC.isDebug){e.template[e.CLASS]=TC.apiLocation+"TC/templates/ListTOC.html";e.template[e.CLASS+"-elm"]=TC.apiLocation+"TC/templates/ListTOCElement.html";e.template[e.CLASS+"-type-sgl"]=TC.apiLocation+"TC/templates/ListTOCTooltipSingle.html";e.template[e.CLASS+"-type-grp"]=TC.apiLocation+"TC/templates/ListTOCTooltipGroup.html";e.template[e.CLASS+"-type-grp-node"]=TC.apiLocation+"TC/templates/ListTOCTooltipGroupNode.html"}else{e.template[e.CLASS]=function(){function t(e,t){return e.w("<h2>").h("i18n",t,{},{$key:"loadedLayers"}).w('<span class="tc-ctl-ltoc-n"></span><button class="tc-ctl-ltoc-del-all tc-hidden" title="').h("i18n",t,{},{$key:"removeAllLayersFromMap"}).w('"></button></h2><div class="tc-ctl-ltoc-empty">').h("i18n",t,{},{$key:"noData"}).w('</div><div class="tc-ctl-ltoc-content"><form><ul>').s(t.get(["workLayers"],!1),t,{block:o},{}).w("</ul></form></div>")}function o(e,t){return e.p("tc-ctl-ltoc-elm",t,t.rebase(t.getPath(!0,[])),{})}dust.register(e.CLASS,t);t.__dustBody=!0;o.__dustBody=!0;return t};e.template[e.CLASS+"-elm"]=function(){function t(e,t){return e.w('<li class="tc-ctl-ltoc-elm" tabindex="-1"><div class="tc-ctl-ltoc-lyr">').x(t.get(["path"],!1),t,{block:o},{}).w('</div><div class="tc-ctl-ltoc-type"></div><div class="tc-ctl-ltoc-path" title="').s(t.get(["path"],!1),t,{"else":r,block:i},{}).w('">').s(t.get(["path"],!1),t,{"else":a,block:l},{}).w('</div><div><div class="tc-ctl-ltoc-btn-info" title="').h("i18n",t,{},{$key:"infoFromThisLayer"}).w('"></div><input type="range" value="').f(t.get(["opacity"],!1),t,"h").w('" title="').h("i18n",t,{},{$key:"transparencyOfThisLayer"}).w('" /><input type="checkbox" ').nx(t.get(["hide"],!1),t,{block:p},{}).w(' title="').h("i18n",t,{},{$key:"visibilityOfThisLayer"}).w('" /></div><div class="tc-ctl-ltoc-info tc-hidden">').x(t.get(["abstract"],!1),t,{block:c},{}).x(t.get(["legend"],!1),t,{block:u},{}).x(t.get(["metadata"],!1),t,{block:d},{}).w('</div><div class="tc-ctl-ltoc-dd ').x(t.get(["hide"],!1),t,{block:f},{}).w('" title="').h("i18n",t,{},{$key:"dragToReorder"}).w('"></div><div class="tc-ctl-ltoc-del ').nx(t.get(["hide"],!1),t,{block:y},{}).w('" title="').h("i18n",t,{},{$key:"removeLayerFromMap"}).w('"></div></li>')}function o(e,t){return e.f(t.get(["title"],!1),t,"h")}function r(e,t){return e.f(t.get(["title"],!1),t,"h")}function i(e,t){return e.f(t.getPath(!0,[]),t,"h").h("sep",t,{block:n},{})}function n(e,t){return e.w(" &bull; ")}function a(e,t){return e.f(t.get(["title"],!1),t,"h")}function l(e,t){return e.f(t.getPath(!0,[]),t,"h").h("sep",t,{block:s},{})}function s(e,t){return e.w(" &bull; ")}function p(e,t){return e.w('checked="checked"')}function c(e,t){return e.w('<div class="tc-ctl-ltoc-abstract"><h4>').h("i18n",t,{},{$key:"abstract"}).w("</h4><div>").f(t.get(["abstract"],!1),t,"h").w("</div></div>")}function u(e,t){return e.w('<div class="tc-ctl-ltoc-legend" data-tc-layer-name="').f(t.get(["layerNames"],!1),t,"h").w('"><h4>').h("i18n",t,{},{$key:"content"}).w("</h4>").s(t.get(["legend"],!1),t,{block:g},{}).w(" </div>")}function g(e,t){return e.w("<div><p>").f(t.get(["title"],!1),t,"h").w('</p><img data-tc-img="').f(t.get(["src"],!1),t,"h").w('" /></div>')}function d(e,t){return e.w('<div class="tc-ctl-ltoc-metadata"><h4>').h("i18n",t,{},{$key:"metadata"}).w("</h4><ul>").s(t.get(["metadata"],!1),t,{block:h},{}).w("</ul></div>")}function h(e,t){return e.w('<li><a href="').f(t.get(["url"],!1),t,"h",["s"]).w('" type="').f(t.get(["format"],!1),t,"h").w('" title="').f(t.get(["formatDescription"],!1),t,"h").w('" target="_blank">').f(t.get(["formatDescription"],!1),t,"h").w("</a></li>")}function f(e,t){return e.w("tc-hidden")}function y(e,t){return e.w("tc-hidden")}dust.register(e.CLASS+"-elm",t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;n.__dustBody=!0;a.__dustBody=!0;l.__dustBody=!0;s.__dustBody=!0;p.__dustBody=!0;c.__dustBody=!0;u.__dustBody=!0;g.__dustBody=!0;d.__dustBody=!0;h.__dustBody=!0;f.__dustBody=!0;y.__dustBody=!0;return t};e.template[e.CLASS+"-type-sgl"]=function(){function t(e,t){return e.h("i18n",t,{},{$key:"singleLayer"})}dust.register(e.CLASS+"-type-sgl",t);t.__dustBody=!0;return t};e.template[e.CLASS+"-type-grp"]=function(){function t(e,t){return e.w("<div>").h("i18n",t,{},{$key:"groupLayerThatContains"}).w(":</div><ul>").s(t.get(["Layer"],!1),t,{block:o},{}).w("</ul>")}function o(e,t){return e.p("tc-ctl-ltoc-type-grp-node",t,t.rebase(t.getPath(!0,[])),{})}dust.register(e.CLASS+"-type-grp",t);t.__dustBody=!0;o.__dustBody=!0;return t};e.template[e.CLASS+"-type-grp-node"]=function(){function t(e,t){return e.w('<li class="tc-ctl-ltoc-tip-grp-elm"><span>').f(t.get(["Title"],!1),t,"h").w("</span><ul>").s(t.get(["Layer"],!1),t,{block:o},{}).w("</ul></li>")}function o(e,t){return e.p("tc-ctl-ltoc-type-grp-node",t,t.rebase(t.getPath(!0,[])),{})}dust.register(e.CLASS+"-type-grp-node",t);t.__dustBody=!0;o.__dustBody=!0;return t}}var t={layer:"tcLayer"},o=function(e,o){var r;e._$div.find("li."+e.CLASS+"-elm").each(function(e,i){var n=$(i);if(n.data(t.layer)===o){r=n;return!1}});return r},r=function(e){return $.grep(e.map.workLayers,function(e){return!e.stealth}).length};e.register=function(e){var t=this;TC.control.TOC.prototype.register.call(t,e);e.off(TC.Consts.event.EXTERNALSERVICEADDED);e.on(TC.Consts.event.LAYEROPACITY,function(e){var r=o(t,e.layer);r&&r.find("input[type=range]").val(Math.round(100*e.opacity))}).on(TC.Consts.event.FEATURESIMPORT,function(o){var r=o.fileName;if(o.features&&o.features.length>0){var i="."+TC.Consts.format.GPX.toLowerCase();if(o.fileName.toLowerCase().indexOf(i)===o.fileName.length-i.length)return;e.one(TC.Consts.event.LAYERADD,function(e){if(e&&e.layer&&e.layer.title==r){if(t.map&&t.map.layout&&t.map.layout.accordion&&t._$div.hasClass(TC.Consts.classes.COLLAPSED))for(var o=0;o<t.map.controls.length;o++)t.map.controls[o]!==t&&t.map.controls[o]._$div.addClass(TC.Consts.classes.COLLAPSED);t.map.$events.trigger($.Event(TC.Consts.event.TOOLSOPEN),{});t._$div.removeClass(TC.Consts.classes.COLLAPSED)}})}})};e._addBrowserEventHandlers=function(){var e=this;e._$div.on(e.CLICKEVENT,"input[type=checkbox]",function(o){var r=$(o.target),i=r.parents("li."+e.CLASS+"-elm").first(),n=i.data(t.layer),a=r.prop("checked");n.setVisibility(a);o.stopPropagation()}).on("change input","input[type=range]",function(e){var o=$(e.target),r=o.parents("li").first().data(t.layer);r.setOpacity(o.val()/100)}).on(e.CLICKEVENT,"."+e.CLASS+"-del",function(o){var r=$(o.target).parents("li").first(),i=r.data(t.layer);e.map.removeLayer(i)}).on(e.CLICKEVENT,"."+e.CLASS+"-del-all",function(o){TC.confirm(e.getLocaleString("layersRemove.confirm"),function(){var o=e._$div.find("li."+e.CLASS+"-elm"),r=new Array(o.length);o.each(function(e,o){r[e]=$(o).data(t.layer)});for(var i=0,n=r.length;n>i;i++)e.map.removeLayer(r[i])})}).on(e.CLICKEVENT,"."+e.CLASS+"-btn-info",function(o){var r=$(o.target),i=r.parents("li").first(),n=i.find("."+e.CLASS+"-info");n.find("."+e.CLASS+"-legend img").each(function(o,r){var n=i.data(t.layer);e.styleLegendImage($(r),n)});n.toggleClass(TC.Consts.classes.HIDDEN);i.find('input[type="checkbox"]').is(":checked")&&i.find("."+e.CLASS+"-dd").toggleClass(TC.Consts.classes.HIDDEN,!n.hasClass(TC.Consts.classes.HIDDEN));r.toggleClass(TC.Consts.classes.CHECKED)})};e.updateLayerVisibility=function(e){var t=this,r=o(t,e);if(r){var i=e.getVisibility();r.find("."+t.CLASS+"-del").toggleClass(TC.Consts.classes.HIDDEN,i);r.find("."+t.CLASS+"-info").hasClass(TC.Consts.classes.HIDDEN)&&r.find("."+t.CLASS+"-dd").toggleClass(TC.Consts.classes.HIDDEN,!i)}};e.updateLayerTree=function(e){var o=this,i=function(e,r,i){if(e!==r){for(var n=e.data(t.layer),a=r.data(t.layer),l=-1,s=0;s<o.map.layers.length;s++)if(a===o.map.layers[s]){l=s;break}l>=1&&l<o.map.layers.length&&o.map.insertLayer(n,l,i)}},n=function(e){var t=$.Deferred();e&&e.options.method&&"POST"===e.options.method?e.getLegendGraphicImage().done(function(e){t.resolve(e)}).fail(function(e){TC.error(e)}):t.resolve();return t.promise()};if(!e.isBase&&!e.options.stealth){TC.control.MapContents.prototype.updateLayerTree.call(o,e);for(var a=!1,l=0,s=o.layers.length;s>l;l++)if(e===o.layers[l]){a=!0;break}if(!a){var p=o.CLASS+"-elm";o.layers.push(e);TC.loadJSInOrder(!window.dust,TC.url.templating,function(){TC.loadJS(!$.fn.drag,[TC.apiLocation+"lib/jQuery/jquery.event.drag.js"],function(){var r=e.title?e.title:e.capabilities.Service.Title,a={title:e.options.hideTitle?"":r,hide:e.renderOptions&&e.renderOptions.hide?!0:!1,opacity:e.renderOptions&&e.renderOptions.opacity?100*e.renderOptions.opacity:100},l=e.isRaster();if(l){a.layerNames=e.layerNames;var s=e.getPath();s.shift();a.path=s;var c=e.names[0],u=e.wrap.getInfo(c);a.legend=u.legend;a["abstract"]=u["abstract"];var g,d=u.hasOwnProperty("abstract")||u.hasOwnProperty("legend")||u.hasOwnProperty("metadata");if(e.tree&&e.tree.children&&e.tree.children.length&&e.tree.children[0].children&&e.tree.children[0].children.length)g=null;else{g=u.metadata;if(g)for(var h=0,f=g.length;f>h;h++){var y=g[h];y.formatDescription=o.getLocaleString(TC.Util.getSimpleMimeType(y.format))||o.getLocaleString("viewMetadata")}}a.metadata=g}n(e).done(function(r){r&&(legend.src=r);dust.render(p,a,function(r,n){var a,s=$(n),p=!1;if(l){p=e.names.length>1;if(!p)for(var u=e.wrap.getAllLayerNodes(),g=0;g<u.length;g++){var h=u[g];if(e.wrap.getName(h)===c){a=h;e.wrap.getLayerNodes(h).length>0&&(p=!0);break}}}var f=s.find("."+o.CLASS+"-type"),y=p?o.CLASS+"-type-grp":o.CLASS+"-type-sgl";f.addClass(y);d||s.find("."+o.CLASS+"-btn-info").addClass(TC.Consts.classes.HIDDEN);if(a){e.wrap.normalizeLayerNode(a);dust.render(y,a,function(e,t){var r;f.on("mouseover",function(e){var i=f.offset(),n=$(o.map.div).offset();r=$("<div>").addClass(o.CLASS+"-tip").html(t).css({top:i.top-n.top+"px",right:$(o.map.div).width()-(i.left-n.left)+"px"}).appendTo(o.map.div)}).on("mouseout",function(e){r.remove()})})}var m=o._$div.find("ul").first();s.data(t.layer,e);s.drag("start",function(e,t){var o=$(this),r=m.children("li");r.not(o).addClass(TC.Consts.classes.DRAGEND);r.index(o);o.css("zIndex",100).addClass(TC.Consts.classes.DRAG);var i=r.last(),n=o.position();t.limit={top:r.first().position().top-n.top,bottom:i.height()+i.position().top-n.top-o.height()-1};t.dropTargetIndex=-1}).drag("end",function(e,t){var o=$(this);o.removeClass(TC.Consts.classes.DRAG).addClass(TC.Consts.classes.DRAGEND);var r,n,a=function(e){return parseInt(e.substr(e.lastIndexOf(",")+1))},l=a(o.css("transform")),s=this.getBoundingClientRect().top-l;if(t.dropTargetIndex>=0){r=m.children("li").get(t.dropTargetIndex);n=$(r);var p=a(n.css("transform")),c=r.getBoundingClientRect().top-p}o.css("transform",n?"translateY("+(c-s)+"px)":"");var u="transitionend.tc";o.on(u,function g(e){if("transform"===e.originalEvent.propertyName){o.off(u,g).removeClass(TC.Consts.classes.DRAGEND).css("zIndex","");n&&i(o,n,function(){m.children("li").css("transform","").removeClass(TC.Consts.classes.DRAGEND)})}})}).drag(function(e,t){var o,r=$(this),i=Math.min(Math.max(t.limit.top,Math.round(t.deltaY)),t.limit.bottom),n=this.getBoundingClientRect(),a=n.height-1,l=(n.top+n.bottom)/2,s=[],p=m.children("li");p.each(function(e,r){var i=r.getBoundingClientRect();s[e]={elm:r,top:i.top,bottom:i.bottom};r===t.drag&&(o=e)});for(var c,u=-1,g=0,d=s.length;d>g;g++){var h=s[g];if(o>g){if(l<h.bottom)if(l>h.top&&t.deltaY>t.prevDeltaY)c="";else{c="translateY("+a+"px)";0>u&&(u=g)}else c="";$(h.elm).css("transform",c)}else if(g>o){if(l>h.top)if(l<h.bottom&&t.deltaY<t.prevDeltaY)c="";else{c="translateY(-"+a+"px)";u=g}else c="";$(h.elm).css("transform",c)}}t.dropTargetIndex=u;r.css("transform","translateY("+i+"px)");t.prevDeltaY=t.deltaY},{handle:"."+o.CLASS+"-dd"}).on("keydown",function(e){var t=this,o=function(){t.focus()},r=$(this);switch(!0){case/Up$/.test(e.key):var n=r.prev();n.length&&i(r,n,o);break;case/Down$/.test(e.key):var a=r.next();a.length&&i(r,a,o)}});m.prepend(s);o.updateScale()})})})});var c=r(o);$("."+o.CLASS+"-n").text(c).toggleClass(TC.Consts.classes.VISIBLE,c>0);o._$div.find("."+o.CLASS+"-empty").toggleClass(TC.Consts.classes.HIDDEN,c>0);o._$div.find("."+o.CLASS+"-del-all").toggleClass(TC.Consts.classes.HIDDEN,!1)}}};e.updateScale=function(){var e=this;e._$div.find("ul").find("li."+e.CLASS+"-elm").each(function(o,r){var i=$(r),n=i.data(t.layer);if(n.names){for(var a=!1,l=0;l<n.names.length;l++)if(n.isVisibleByScale(n.names[l])){a=!0;break}i.toggleClass(e.CLASS+"-elm-notvisible",!a)}})};e.updateLayerOrder=function(e,t,o){TC.control.MapContents.prototype.updateLayerOrder.call(this,e,t,o)};e.removeLayer=function(e){var o=this,i=o.layers.indexOf(e);i>=0&&o.layers.splice(i,1);var n=o._$div.find("ul").first();n.find("li."+o.CLASS+"-elm").each(function(o,r){var i=$(r);if(i.data(t.layer)===e){i.remove();return!1}});var a=r(o);o._$div.find("."+o.CLASS+"-del-all").toggleClass(TC.Consts.classes.HIDDEN,0===a);o._$div.find("."+o.CLASS+"-empty").toggleClass(TC.Consts.classes.HIDDEN,a>0);$("."+o.CLASS+"-n").text(a).toggleClass(TC.Consts.classes.VISIBLE,a>0)};e.getLayerUIElements=function(){var e=this;return e._$div.find("ul").first().children("li."+e.CLASS+"-elm")}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.Click=function(){var e=this;TC.Control.apply(e,arguments);e.callback=e.options&&e.options.callback||function(e,t){console.log("[Click]["+e[0]+", "+e[1]+"]["+t[0]+", "+t[1]+"]")};e.wrap=new TC.wrap.control.Click(e)};TC.inherit(TC.control.Click,TC.Control);!function(){var e=TC.control.Click.prototype;e.CLASS="tc-ctl-click";e.register=function(e){var t=this;t.wrap.register(e);TC.Control.prototype.register.call(t,e)};e.activate=function(){var e=this;TC.Control.prototype.activate.call(e);e.wrap.activate()};e.deactivate=function(){var e=this;e.wrap.deactivate();TC.Control.prototype.deactivate.call(e)}}();TC.control=TC.control||{};TC.control.Click||TC.syncLoadJS(TC.apiLocation+"TC/control/Click");TC.Consts.event.POPUPHIDE=TC.Consts.event.POPUPHIDE||"popuphide.tc";TC.Consts.event.RESULTSPANELCLOSE=TC.Consts.event.RESULTSPANELCLOSE||"resultspanelclose.tc";TC.control.FeatureInfoCommons=function(){var e=this;TC.control.Click.apply(e,arguments);e.resultsLayer=null;e.filterLayer=null;e._layersDeferred=$.Deferred();e.filterFeature=null;e.info=null;e.popup=null;e.resultsPanel=null;e.lastFeatureCount=null;e._$dialogDiv=$(TC.Util.getDiv(e.options.dialogDiv));e.options.dialogDiv||e._$dialogDiv.appendTo("body")};TC.control.FeatureInfoCommons.displayMode={POPUP:"popup",RESULTS_PANEL:"resultsPanel"};!function(){var e="ul.tc-ctl-finfo-features li",t=function(e){e.getDisplayTarget().find("ul."+e.CLASS+"-services li").removeClass(TC.Consts.classes.CHECKED).removeClass(TC.Consts.classes.DISABLED).removeClass(TC.Consts.classes.FROMLEFT).removeClass(TC.Consts.classes.FROMRIGHT)},o=function(o,r){if(!o._zooming){var i,n,a,l;if(this instanceof TC.Feature){i=this;o.getDisplayTarget().find(e).each(function(e,t){var r=$(t),s=r.parents("li").first(),p=s.parents("li").first(),c=o.getFeature(o.info,p.index(),s.index(),r.index());if(c===i){n=r;a=s;l=p}})}else n=$(this);a=a||n.parents("li").first();l=l||a.parents("li").first();t(o);n.addClass(TC.Consts.classes.CHECKED);a.addClass(TC.Consts.classes.CHECKED);l.addClass(TC.Consts.classes.CHECKED);if(r>0){n.addClass(TC.Consts.classes.FROMLEFT);a.addClass(TC.Consts.classes.FROMLEFT);l.addClass(TC.Consts.classes.FROMLEFT)}else if(0>r){n.addClass(TC.Consts.classes.FROMRIGHT);a.addClass(TC.Consts.classes.FROMRIGHT);l.addClass(TC.Consts.classes.FROMRIGHT)}i=i||o.getFeature(o.info,l.index(),a.index(),n.index());var s=o.resultsLayer.features.slice(),p=s.filter(function(e){return i&&i.id===e.id});if(p.length>0)return;for(var c=0;c<s.length;c++){var u=s[c];u!==o.filterFeature&&o.resultsLayer.removeFeature(u)}i&&i.geometry?o.resultsLayer.addFeature(i):n.addClass(TC.Consts.classes.DISABLED)}},r=function(e,t){var o=e.getDisplayTarget().find("ul."+e.CLASS+"-features > li"),r=o.length,i=o.filter("."+TC.Consts.classes.CHECKED),n=o.index(i.get(0));return o.get((n+t+r)%r)};TC.inherit(TC.control.FeatureInfoCommons,TC.control.Click);var i=TC.control.FeatureInfoCommons.prototype;i.CLASS="tc-ctl-finfo";i.template={};if(TC.isDebug){i.template[i.CLASS]=TC.apiLocation+"TC/templates/FeatureInfo.html";i.template[i.CLASS+"-dialog"]=TC.apiLocation+"TC/templates/FeatureInfoDialog.html";i.template[i.CLASS+"-del-btn"]=TC.apiLocation+"TC/templates/FeatureInfoDeleteButton.html"}else{i.template[i.CLASS]=function(){function e(e,r){return e.w('<ul class="tc-ctl-finfo-services">').s(r.get(["services"],!1),r,{"else":t,block:o},{}).w("</ul>").x(r.get(["featureCount"],!1),r,{block:L},{})}function t(e,t){return e.w('<li class="tc-ctl-finfo-empty">').h("i18n",t,{},{$key:"noData"}).w("</li>")}function o(e,t){return e.w("<li><h3>").x(t.getPath(!1,["mapLayer","title"]),t,{"else":r,block:n},{}).w('</h3><div class="tc-ctl-finfo-service-content">').s(t.get(["hasLimits"],!1),t,{"else":a,block:P},{}).w("</div></li>")}function r(e,t){return e.f(t.getPath(!1,["mapLayer","id"]),t,"h")}function n(e,t){return e.f(t.getPath(!1,["mapLayer","title"]),t,"h")}function a(e,t){return e.w('<ul class="tc-ctl-finfo-layers">').s(t.get(["layers"],!1),t,{"else":l,block:s},{}).w("</ul>")}function l(e,t){return e.w('<li class="tc-ctl-finfo-empty">').h("i18n",t,{},{$key:"noDataAtThisService"}).w("</li>")}function s(e,t){return e.w("<li><h4>").s(t.get(["path"],!1),t,{block:p},{}).w(' <span class="tc-ctl-finfo-layer-n">').f(t.getPath(!1,["features","length"]),t,"h").w('</span> </h4> <div class="tc-ctl-finfo-layer-content"><ul class="tc-ctl-finfo-features">').s(t.get(["features"],!1),t,{"else":u,block:g},{}).w("</ul></div></li>")}function p(e,t){return e.f(t.getPath(!0,[]),t,"h").h("sep",t,{block:c},{})}function c(e,t){return e.w(" &bull; ")}function u(e,t){return e.w('<li class="tc-ctl-finfo-empty">').h("i18n",t,{},{$key:"noDataInThisLayer"}).w("</li>")}function g(e,t){return e.w("<li>").x(t.get(["rawContent"],!1),t,{"else":d,block:C},{}).w("</li>")}function d(e,t){return e.x(t.get(["error"],!1),t,{"else":h,block:v},{})}function h(e,t){return e.w("<h5>").f(t.get(["id"],!1),t,"h").w("</h5><table").x(t.get(["geometry"],!1),t,{block:f},{}).w("><tbody>").s(t.get(["attributes"],!1),t,{block:y},{}).w("</tbody></table>").x(t.get(["geometry"],!1),t,{block:m},{})}function f(e,t){return e.w(' title="').h("i18n",t,{},{$key:"clickToCenter"}).w('"')}function y(e,t){return e.w('<tr><th class="tc-ctl-finfo-attr">').f(t.get(["name"],!1),t,"h").w('</th><td class="tc-ctl-finfo-val">').f(t.get(["value"],!1),t,"h").w("</td></tr>")}function m(e,t){return e.w('<div class="tc-ctl-finfo-tools"><button class="tc-ctl-finfo-tools-btn" title="').h("i18n",t,{},{$key:"tools"}).w('">').h("i18n",t,{},{$key:"tools"}).w("</button></div>")}function v(e,t){return e.w('<span class="tc-ctl-finfo-errors">').h("i18n",t,{},{$key:"fi.error"}).w('<span class="tc-ctl-finfo-error-text">').f(t.get(["error"],!1),t,"h").w("</span></span>")}function C(e,t){return e.w("<h5>").h("i18n",t,{},{$key:"feature"}).w("</h5>").h("eq",t,{"else":T,block:_},{key:t.get(["rawFormat"],!1),value:"text/html"})}function T(e,t){return e.w("<pre>").f(t.get(["rawContent"],!1),t,"h").w("</pre>")}function _(e,t){return e.w(" ").x(t.get(["expandUrl"],!1),t,{block:S},{})}function S(e,t){return e.h("ne",t,{"else":E,block:x},{key:t.get(["expandUrl"],!1),value:""})}function E(e,t){return e.w('<iframe src="').f(t.get(["rawUrl"],!1),t,"h").w('" />')}function x(e,t){return e.w('<div class="tc-ctl-finfo-features-iframe-cnt"><iframe src="').f(t.get(["rawUrl"],!1),t,"h").w('" /><a class="tc-ctl-finfo-open" onclick="window.open(\'').f(t.get(["expandUrl"],!1),t,"h").w("', '_blank')\" title=\"").h("i18n",t,{},{$key:"expand"}).w('"></a></div>')}function P(e,t){return e.w('<span class="tc-ctl-finfo-errors">').f(t.get(["hasLimits"],!1),t,"h").w("</span>")}function L(e,t){return e.h("gt",t,{block:w},{key:t.get(["featureCount"],!1),value:"1",type:"number"})}function w(e,t){return e.w('<a class="tc-ctl-btn tc-ctl-finfo-btn-prev">').h("i18n",t,{},{$key:"previous"}).w('</a><div class="tc-ctl-finfo-counter"><span class="tc-ctl-finfo-idx"></span>/').f(t.get(["featureCount"],!1),t,"h").w('</div><a class="tc-ctl-btn tc-ctl-finfo-btn-next">').h("i18n",t,{},{$key:"next"}).w("</a>")}dust.register(i.CLASS,e);e.__dustBody=!0;t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;n.__dustBody=!0;a.__dustBody=!0;l.__dustBody=!0;s.__dustBody=!0;p.__dustBody=!0;c.__dustBody=!0;u.__dustBody=!0;g.__dustBody=!0;d.__dustBody=!0;h.__dustBody=!0;f.__dustBody=!0;y.__dustBody=!0;m.__dustBody=!0;v.__dustBody=!0;C.__dustBody=!0;T.__dustBody=!0;_.__dustBody=!0;S.__dustBody=!0;E.__dustBody=!0;x.__dustBody=!0;P.__dustBody=!0;L.__dustBody=!0;w.__dustBody=!0;return e};i.template[i.CLASS+"-dialog"]=function(){function e(e,t){return e.w('<div class="tc-ctl-finfo-dialog tc-modal"><div class="tc-modal-background tc-modal-close"></div><div class="tc-modal-window"><div class="tc-modal-header"><h3>').h("i18n",t,{},{$key:"feature"}).w('</h3><div class="tc-ctl-popup-close tc-modal-close"></div></div><div class="tc-modal-body"><div class="tc-ctl-finfo-dialog-dl"><h2>').h("i18n",t,{},{$key:"download"}).w('</h2><div><button class="tc-button tc-ctl-finfo-dl-btn-kml" data-format="KML" title="KML">KML</button><button class="tc-button tc-ctl-finfo-dl-btn-gml" data-format="GML" title="GML">GML</button><button class="tc-button tc-ctl-finfo-dl-btn-geojson" data-format="GeoJSON" title="GeoJSON">GeoJSON</button><button class="tc-button tc-ctl-finfo-dl-btn-wkt" data-format="WKT" title="WKT">WKT</button></div></div><div class="tc-ctl-finfo-dialog-share"></div></div></div></div>')}dust.register(i.CLASS+"-dialog",e);e.__dustBody=!0;return e};i.template[i.CLASS+"-del-btn"]=function(){function e(e,t){return e.w('<button class="tc-ctl-finfo-del-btn" title="').h("i18n",t,{},{$key:"deleteFeature"}).w('">').h("i18n",t,{},{$key:"deleteFeature"}).w("</button>")}dust.register(i.CLASS+"-del-btn",e);e.__dustBody=!0;return e}}i.register=function(e){var t=this;TC.control.Click.prototype.register.call(t,e);var o;o=t.options.resultsLayer?t.options.resultsLayer:{id:TC.getUID(),title:t.CLASS+": Results layer",type:TC.Consts.layerType.VECTOR,stealth:!0};var r;r=t.options.filterLayer?t.options.filterLayer:{id:TC.getUID(),title:t.CLASS+": Filter layer",stealth:!0,type:TC.Consts.layerType.VECTOR,styles:{line:{strokeColor:t.lineColor,strokeWidth:2},polygon:{strokeColor:t.lineColor,strokeWidth:2,fillColor:"#000",fillOpacity:.3}}};e.loaded(function(){$.when(e.addLayer(o),e.addLayer(r)).then(function(e,o){t.resultsLayer=e;t.filterLayer=o;t._layersDeferred.resolve()})});t.displayMode=t.options.displayMode||TC.control.FeatureInfoCommons.displayMode.POPUP;t.setDisplayMode(t.displayMode);e.on(TC.Consts.event.BEFOREFEATUREINFO,function(e){t.querying=!0;t.beforeGetFeatureInfo(e)}).on(TC.Consts.event.FEATUREINFO,function(e){t.querying=!1;if(t.isActive){t.lastFeatureCount=t.countFeatures(e);t.responseCallback(e)}}).on(TC.Consts.event.NOFEATUREINFO,function(e){t.querying=!1;t.lastFeatureCount=0;t.closeResults()}).on(TC.Consts.event.POPUPHIDE+" "+TC.Consts.event.RESULTSPANELCLOSE,function(e){if(e.control===t.getDisplayControl()&&t.resultsLayer){t.resultsLayer.clearFeatures();clearTimeout(t._removeFilterFeatureTimeout);t._removeFilterFeatureTimeout=setTimeout(function(){t.querying||t.filterLayer.clearFeatures()},50)}})};i.render=function(e){var t=this;t.getRenderedHtml(t.CLASS+"-dialog",null,function(e){t._$dialogDiv.html(e).on(TC.Consts.event.CLICK,"button[data-format]",function(e){TC.Util.closeModal();var o=t.resultsLayer.features[t.resultsLayer.features.length-1];t.map.exportFeatures([o],{fileName:o.id,format:$(e.target).data("format")})})})};i.markerStyle={cssClass:TC.Consts.classes.POINT,anchor:[.5,.5],width:15,height:15,noPrint:!0};i.setDisplayMode=function(e){var t=this;t.displayMode=e;var o=t.map;switch(e){case TC.control.FeatureInfoCommons.displayMode.RESULTS_PANEL:if(!t.resultsPanel){var r=o.getControlsByClass("TC.control.ResultsPanel")[0];if(r)t.resultsPanel=r;else{var i=function n(e){if(TC.control.ResultsPanel&&e.control instanceof TC.control.ResultsPanel){t.resultsPanel=e.control;o.off(TC.Consts.event.CONTROLADD,n)}};o.on(TC.Consts.event.CONTROLADD,i)}}break;default:t.displayMode=TC.control.FeatureInfoCommons.displayMode.POPUP;t.popup||$.when(o.addControl("popup",{closeButton:!0,draggable:t.options.draggable})).then(function(e){t.popup=e;e.caller=t;o.on(TC.Consts.event.POPUP,function(e){t.onShowPopUp(e)});o.on(TC.Consts.event.POPUPHIDE,function(o){o.control===e&&t.popup.$popupDiv.css("width","auto")})})}};i.getDisplayControl=function(){var e=this;switch(e.displayMode){case TC.control.FeatureInfoCommons.displayMode.RESULTS_PANEL:return e.resultsPanel;default:return e.popup}};i.getDisplayTarget=function(){var e=this;switch(e.displayMode){case TC.control.FeatureInfoCommons.displayMode.RESULTS_PANEL:return e.resultsPanel.$divTable;default:return e.popup.$popupDiv}};i.displayResults=function(){var e=this;e.filterFeature.data=$("<div>").append(e._$div.clone()).html();switch(e.displayMode){case TC.control.FeatureInfoCommons.displayMode.RESULTS_PANEL:e.getDisplayTarget().html(e.filterFeature.data);e.resultsPanel.open();e.displayResultsCallback();break;default:e.popup&&e.filterFeature.showPopup(e.popup)}};i.closeResults=function(){var e=this;switch(e.displayMode){case TC.control.FeatureInfoCommons.displayMode.RESULTS_PANEL:e.resultsPanel&&e.resultsPanel.close();break;default:e.popup&&e.popup.isVisible()&&e.popup.hide()}};i.displayResultsCallback=function(){var i=this,n=i.getDisplayTarget(),a="ficHandlers",l=n.data(a);if(!l){var s,p="click";n.on(p,e,function(e){o.call(this,i.map.activeControl)});p="mouseenter";n.on(p,e,function(e){var t=this;$(t).parents("."+i.CLASS+"-layers > li").hasClass(TC.Consts.classes.CHECKED)&&o.call(t,i.map.activeControl)});p=TC.Consts.event.CLICK;s="."+i.CLASS+"-btn-next";n.on(p,s,function(e){o.call(r(i.map.activeControl,1),i.map.activeControl,1);return!1});s="."+i.CLASS+"-btn-prev";n.on(p,s,function(e){o.call(r(i.map.activeControl,-1),i.map.activeControl,-1);return!1});s="ul."+i.CLASS+"-layers h4";n.on(p,s,function(r){var a=$(r.target).parent();if(a.hasClass(TC.Consts.classes.CHECKED))"none"===n.find(".tc-ctl-finfo-btn-next").css("display")&&t(i.map.activeControl);else{o.call(a.find(e).first()[0],i.map.activeControl);i.displayMode===TC.control.FeatureInfoCommons.displayMode.POPUP&&i.popup.fitToView(!0)}});s="."+i.CLASS+"-tools-btn";n.on(p,s,function(e){var t=new $.Deferred;i.map.activeControl._shareCtl?t.resolve():i.map.addControl("share",{div:i.map.activeControl._$dialogDiv.find(".tc-modal-body .tc-ctl-finfo-dialog-share")}).then(function(e){i.map.activeControl._shareCtl=e;t.resolve()});$.when(t).then(function(){TC.Util.showModal(i.map.activeControl._$dialogDiv.find("."+i.map.activeControl.CLASS+"-dialog"),{openCallback:function(){i.map.activeControl.onShowModal()}})})});n.data(a,!0)}i.info&&(i.info.defaultFeature?o.call(i.info.defaultFeature,i):o.call(n.find(e).first()[0],i));n.find("table").on("click",function(e){if(!$(this).parent().hasClass(TC.Consts.classes.DISABLED)){if(i.resultsLayer.features[0]){var t=function o(){i._zooming=!1;i.map.off(TC.Consts.event.ZOOM,o)};i.map.on(TC.Consts.event.ZOOM,t);i._zooming=!0;i.map.zoomToFeatures([i.resultsLayer.features[0]],{animate:!0})}e.stopPropagation()}});n.find("table a").on("click",function(e){e.stopPropagation()})};i.onShowPopUp=function(e){{var t=this;t.map}if(e.control===t.popup){t.displayResultsCallback();t.fitSize()}};i.onShowModal=function(){};i.highlightFeature=function(e){o.call(e,this)};i.fitSize=function(){var e=this,t=e.getDisplayTarget(),o=0;t.find(".tc-ctl-finfo-features li").each(function(e,t){o=Math.max(o,$(t).position().left+$(t).width())});o&&t.width(o+50)};i.countFeatures=function(e){for(var t=0,o=0;o<e.services.length;o++)e.services[o].layers.forEach(function(e){t+=e.features.length});return t};i.getFeature=function(e,t,o,r){var i;if(e){i=e.services[t];if(i){i=i.layers[o];i&&(i=i.features[r])}}return i};i.getFeatureIdx=function(e,t,o,r){var i=-1;if(e)for(var n=0;t>n;n++)for(var a=e.services[n],l=n===t-1?o:a.layers.length,s=0;l>s;s++)for(var p=a.layers[s],c=s===o-1?r:p.features.length,u=0;c>u;u++)i+=1;return i};i.beforeGetFeatureInfo=function(e){var t=this;t.closeResults();if(e.control===t&&t.map&&t.resultsLayer){t.lastFeatureCount=null;t.resultsLayer.clearFeatures();t.info=null}};i.activate=function(){var e=this;e.wrap&&e.wrap.activate();TC.Control.prototype.activate.call(e)};i.deactivate=function(e){var t=this;t.popup&&t.popup.hide();t.resultsLayer.clearFeatures();t.filterLayer.clearFeatures();t.wrap&&t.wrap.deactivate();TC.Control.prototype.deactivate.call(t,e)}}();TC.control=TC.control||{};TC.Consts=TC.Consts||{};TC.Consts.SCREEN_SIZE_KEY="TC.Map.screenSize";TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.Scale=function(){
TC.Control.apply(this,arguments)};TC.inherit(TC.control.Scale,TC.Control);!function(){var e=TC.control.Scale.prototype;e.CLASS="tc-ctl-scl";e.template=TC.isDebug?TC.apiLocation+"TC/templates/Scale.html":function(){function t(e,t){return e.w('<div class="ol-scale-line ol-unselectable"><span>1:').h("math",t,{},{key:o,method:"round"}).w('</span> <input type="button" value="').f(t.get(["screenSize"],!1),t,"h").w("''\" title=\"").h("i18n",t,{},{$key:"estimatedMapSize"}).w('" /></div>')}function o(e,t){return e.f(t.get(["scale"],!1),t,"h")}dust.register(e.CLASS,t);t.__dustBody=!0;o.__dustBody=!0;return t};e.render=function(e){var t=this;$("input[type=button]",t._$div).off();t.renderData({scale:t.getScale(),screenSize:TC.Cfg.screenSize},function(){var o=t._$div.find("span");o.text("1:"+t.format(o.text().substr(2)));t._$div.find('input[type="button"]').on(TC.Consts.event.CLICK,function(){t.setScreenSize.call(t)});$.isFunction(e)&&e()})};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);var o=TC.Util.storage.getLocalValue(TC.Consts.SCREEN_SIZE_KEY);o&&(TC.Cfg.screenSize=o);t.render(function(){e.on(TC.Consts.event.ZOOM,function(){delete t.metersPerDegree;t.update()})})};e.update=function(){this.render()};e.setScreenSize=function(){var e=this;TC.prompt(e.getLocaleString("selectScreenSize"),TC.Cfg.screenSize,function(t){if(t){TC.Cfg.screenSize=parseFloat(t);TC.Util.storage.setLocalValue(TC.Consts.SCREEN_SIZE_KEY,TC.Cfg.screenSize);e.update()}})};e.getScale=function(e){var t=this,o=0,r=!e&&t.map?t.map.wrap.getResolution():e;if(r){o=r*t.getDpi(TC.Cfg.screenSize)/.0254;window.devicePixelRatio&&(o*=window.devicePixelRatio)}if(t.map&&t.map.wrap.isGeo()){if(!t.metersPerDegree){var i=t.map.getExtent();i&&(t.metersPerDegree=TC.Util.getMetersPerDegree(i))}t.metersPerDegree&&(o*=t.metersPerDegree)}return o};e.getDpi=function(e){var t=this;t.dpi=Math.sqrt(screen.width*screen.width+screen.height*screen.height)/e;return t.dpi};e.format=function(e){for(var t=new Number(e).toFixed(0),o=[];t.length>3;){var r=t.length-3;o.unshift(t.substr(r));t=t.substr(0,r)}t&&o.unshift(t);return o.join(".")}}();TC.control=TC.control||{};TC.control.MapContents||TC.syncLoadJS(TC.apiLocation+"TC/Control");!function(){TC.control.SWCacheClient=function(){var e=this;e.serviceWorkerEnabled=!1;e._serviceWorkerDeferred=$.Deferred()};TC.inherit(TC.control.SWCacheClient,TC.Control);var e=TC.control.SWCacheClient.prototype;e.CLASS="tc-ctl-swcc";e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);navigator.serviceWorker?navigator.serviceWorker.register("tc-cb-service-worker.js",{scope:"./"}).then(function(e){t.serviceWorkerEnabled=!0;e.installing?t._serviceWorkerDeferred.resolve(e.installing):e.waiting?t._serviceWorkerDeferred.resolve(e.waiting):e.active&&t._serviceWorkerDeferred.resolve(e.active);console.log(e.scope,"register")},function(e){t.serviceWorkerEnabled=!1;t._serviceWorkerDeferred.reject();console.error("Could not register service worker: "+e)}):t._serviceWorkerDeferred.reject()};e.getServiceWorker=function(){return this._serviceWorkerDeferred.promise()};var t=function(e,t,o,r){var i="message",n=function a(n){if(n.data.name===t){n.data.action===o&&n.data.event===r?e.resolve(t):"error"===n.data.event&&e.reject();navigator.serviceWorker.removeEventListener(i,a)}};navigator.serviceWorker.addEventListener(i,n)};e.createCache=function(e,o){var r=this,i=$.Deferred();r.getServiceWorker().then(function(r){var n="create",a=o||{};t(i,e,n,"cached");r.postMessage({action:n,name:e,list:a.urlList||[],silent:a.silent})},function(){i.resolve(!1)});return i.promise()};e.deleteCache=function(e,o){var r=this,i=$.Deferred();r.getServiceWorker().then(function(r){var n="delete",a=o||{};t(i,e,n,"deleted");r.postMessage({action:n,name:e,silent:a.silent})},function(){i.resolve(!1)});return i.promise()}}();!function(e,t){"function"==typeof define&&define.amd?define(["../../lib/ol/build/ol-debug"],t):"object"==typeof exports?module.exports=t(require("../../lib/ol/build/ol-debug")):e.ol=t(e.ol)}(this,function(e){Math.hypot=Math.hypot||function(){for(var e=0,t=arguments.length,o=0;t>o;o++){if(arguments[o]===1/0||arguments[o]===-(1/0))return 1/0;e+=arguments[o]*arguments[o]}return Math.sqrt(e)};for(var t=0,o=["ms","moz","webkit","o"],r=0;r<o.length&&!window.requestAnimationFrame;++r){window.requestAnimationFrame=window[o[r]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[o[r]+"CancelAnimationFrame"]||window[o[r]+"CancelRequestAnimationFrame"]}window.requestAnimationFrame||(window.requestAnimationFrame=function(e,o){var r=(new Date).getTime(),i=Math.max(0,16-(r-t)),n=window.setTimeout(function(){e(r+i)},i);t=r+i;return n});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)});var i="mousemove.tc",n="mouseout.tc",a="mouseover.tc",l=TC.url.ol.substr(0,TC.url.ol.lastIndexOf("/"));l=l.substr(0,l.lastIndexOf("/")+1)+"css/ol.css";e.proj.oldGet=e.proj.get;e.proj.get=function(t){if("string"==typeof t){for(var o=0,r=e.proj.EPSG4326.PROJECTIONS.length;r>o;o++){var i=e.proj.EPSG4326.PROJECTIONS[o];if(i.getCode()===t)return i}TC.loadProjDef(t,!0)}return e.proj.oldGet.call(this,t)};e.format.GMLBase.prototype.readGeometryElement=function(t,o){var r=o[0],i=r.srsName=t.firstElementChild.getAttribute("srsName");if((this instanceof e.format.GML2CRS84||this instanceof e.format.GML3CRS84)&&("EPSG:4326"!==i||!i))throw new Error("Conflicto de CRS");if(i){r.srsName=this.srsName||i;r.dataProjection=e.proj.get(r.srsName)}var n=e.xml.pushParseAndPop(null,this.GEOMETRY_PARSERS_,t,o,this);return n?e.format.Feature.transformWithOptions(n,!1,r):void 0};e.format.GMLBase.prototype.readFeatureElement=function(t,o){var r,i,n=t.getAttribute("fid")||e.xml.getAttributeNS(t,e.format.GMLBase.GMLNS,"id"),a={};for(r=t.firstElementChild;r;r=r.nextElementSibling){var l=r.localName;if(0===r.childNodes.length||1===r.childNodes.length&&(3===r.firstChild.nodeType||4===r.firstChild.nodeType)){var s=e.xml.getAllTextContent(r,!1);e.format.GMLBase.ONLY_WHITESPACE_RE_.test(s)&&(s=void 0);a[l]=s}else(a[l]=this.readGeometryElement(r,o))&&"boundedBy"!==l&&"referencePoint"!==l&&(i=l)}var p=new e.Feature(a);i&&p.setGeometryName(i);n&&p.setId(n);return p};var s="http://www.opengis.net/gml",p="http://www.opengis.net/gml/3.2";e.format.GMLBase.prototype.MULTIPOINT_PARSERS_[p]=e.format.GMLBase.prototype.MULTIPOINT_PARSERS_[s];e.format.GMLBase.prototype.MULTILINESTRING_PARSERS_[p]=e.format.GMLBase.prototype.MULTILINESTRING_PARSERS_[s];e.format.GMLBase.prototype.MULTIPOLYGON_PARSERS_[p]=e.format.GMLBase.prototype.MULTIPOLYGON_PARSERS_[s];e.format.GMLBase.prototype.POINTMEMBER_PARSERS_[p]=e.format.GMLBase.prototype.POINTMEMBER_PARSERS_[s];e.format.GMLBase.prototype.LINESTRINGMEMBER_PARSERS_[p]=e.format.GMLBase.prototype.LINESTRINGMEMBER_PARSERS_[s];e.format.GMLBase.prototype.POLYGONMEMBER_PARSERS_[p]=e.format.GMLBase.prototype.POLYGONMEMBER_PARSERS_[s];e.format.GMLBase.prototype.RING_PARSERS[p]=e.format.GMLBase.prototype.RING_PARSERS[s];e.format.GML3.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS_[p]=e.format.GML3.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS_[s];e.format.GML3.prototype.FLAT_LINEAR_RINGS_PARSERS_[p]=e.format.GML3.prototype.FLAT_LINEAR_RINGS_PARSERS_[s];e.format.GML3.prototype.GEOMETRY_PARSERS_[p]=e.format.GML3.prototype.GEOMETRY_PARSERS_[s];e.format.GML3.prototype.MULTICURVE_PARSERS_[p]=e.format.GML3.prototype.MULTICURVE_PARSERS_[s];e.format.GML3.prototype.MULTISURFACE_PARSERS_[p]=e.format.GML3.prototype.MULTISURFACE_PARSERS_[s];e.format.GML3.prototype.CURVEMEMBER_PARSERS_[p]=e.format.GML3.prototype.CURVEMEMBER_PARSERS_[s];e.format.GML3.prototype.SURFACEMEMBER_PARSERS_[p]=e.format.GML3.prototype.SURFACEMEMBER_PARSERS_[s];e.format.GML3.prototype.SURFACE_PARSERS_[p]=e.format.GML3.prototype.SURFACE_PARSERS_[s];e.format.GML3.prototype.CURVE_PARSERS_[p]=e.format.GML3.prototype.CURVE_PARSERS_[s];e.format.GML3.prototype.ENVELOPE_PARSERS_[p]=e.format.GML3.prototype.ENVELOPE_PARSERS_[s];e.format.GML3.prototype.PATCHES_PARSERS_[p]=e.format.GML3.prototype.PATCHES_PARSERS_[s];e.format.GML3.prototype.SEGMENTS_PARSERS_[p]=e.format.GML3.prototype.SEGMENTS_PARSERS_[s];e.format.KML._createStyleDefaults_=e.format.KML.createStyleDefaults_;e.format.KML.createStyleDefaults_=function(){e.format.KML._createStyleDefaults_();e.format.KML.DEFAULT_FILL_STYLE_.color_=T(TC.Cfg.styles.polygon.fillColor,TC.Cfg.styles.polygon.fillOpacity);e.format.KML.DEFAULT_TEXT_STYLE_.fill_=new e.style.Fill({color:e.format.KML.DEFAULT_COLOR_});e.format.KML.DEFAULT_STROKE_STYLE_.color_=T(TC.Cfg.styles.line.strokeColor,1);e.format.KML.DEFAULT_STROKE_STYLE_.width_=TC.Cfg.styles.line.strokeWidth;return e.format.KML.DEFAULT_STYLE_ARRAY_};e.format.KML.prototype._readDocumentOrFolder_=e.format.KML.prototype.readDocumentOrFolder_;e.format.KML.prototype.readDocumentOrFolder_=function(t,o){var r=e.format.KML.prototype._readDocumentOrFolder_.apply(this,arguments);if("Folder"==t.localName)for(var i=0;i<r.length;i++){var n=r[i];$.isArray(n._folders)||(n._folders=[]);var a=t.getElementsByTagName("name")[0];a&&TC.Util.fastUnshift(n._folders,a.innerHTML||a.textContent)}return r};e.format.KML.readText_=function(t,o){e.asserts.assert(t.nodeType==Node.ELEMENT_NODE);e.asserts.assert("text"==t.localName);var r=e.xml.getAllTextContent(t,!1);return r.trim()};e.format.KML.BALLOON_STYLE_PARSERS_=e.xml.makeStructureNS(e.format.KML.NAMESPACE_URIS_,{text:e.xml.makeObjectPropertySetter(e.format.KML.readText_)});e.format.KML.BalloonStyleParser_=function(t,o){e.asserts.assert(t.nodeType==Node.ELEMENT_NODE);e.asserts.assert("BalloonStyle"==t.localName);var r=e.xml.pushParseAndPop({},e.format.KML.BALLOON_STYLE_PARSERS_,t,o);if(goog.isDef(r)){var i=o[o.length-1];e.asserts.assert(goog.isObject(i));var n=new e.style.Text({text:r.text});i.balloonStyle=n}};for(var c in e.format.KML.STYLE_PARSERS_){var u=e.format.KML.STYLE_PARSERS_[c];u.BalloonStyle=e.format.KML.BalloonStyleParser_}e.format.KML.readStyle_=function(t,o){var r=e.xml.pushParseAndPop({},e.format.KML.STYLE_PARSERS_,t,o);if(!r)return null;var i="fillStyle"in r?r.fillStyle:e.format.KML.DEFAULT_FILL_STYLE_,n=r.fill;void 0===n||n||(i=null);var a="imageStyle"in r?r.imageStyle:e.format.KML.DEFAULT_IMAGE_STYLE_;a==e.format.KML.DEFAULT_NO_IMAGE_STYLE_&&(a=void 0);var l="textStyle"in r?r.textStyle:e.format.KML.DEFAULT_TEXT_STYLE_,s="strokeStyle"in r?r.strokeStyle:e.format.KML.DEFAULT_STROKE_STYLE_,p="balloonStyle"in r?r.balloonStyle:e.format.KML.DEFAULT_BALLOON_STYLE_,c=r.outline;void 0===c||c||(s=null);var u=new e.style.Style({fill:i,image:a,stroke:s,text:l,zIndex:void 0});u._balloon=p;return[u]};e.format.KML._readURI_=e.format.KML.readURI_;e.format.KML.readURI_=function(t){var o=e.format.KML._readURI_(t);"https:"===location.protocol&&0===o.indexOf("http://")&&(o=o.substr(5));return o};for(var c in e.format.KML.ICON_PARSERS_)e.format.KML.ICON_PARSERS_[c].href=e.xml.makeObjectPropertySetter(e.format.KML.readURI_);e.format.KML.whenParser_=function(t,o){e.asserts.assert(t.nodeType==Node.ELEMENT_NODE,"node.nodeType should be ELEMENT");e.asserts.assert("when"==t.localName,"localName should be when");var r=o[o.length-1];e.asserts.assert(goog.isObject(r),"gxTrackObject should be an Object");var r=r.whens,i=e.xml.getAllTextContent(t,!1);if(i=/^\s*(\d{4})($|-(\d{2})($|-(\d{2})($|T(\d{2}):(\d{2}):(\d{2})(?:.?\d{3})?(Z|(?:([+\-])(\d{2})(?::(\d{2}))?)))))\s*$/.exec(i)){var n=parseInt(i[1],10),a=i[3]?parseInt(i[3],10)-1:0,l=i[5]?parseInt(i[5],10):1,s=i[7]?parseInt(i[7],10):0,p=i[8]?parseInt(i[8],10):0,c=i[9]?parseInt(i[9],10):0,n=Date.UTC(n,a,l,s,p,c);i[10]&&"Z"!=i[10]&&(a="-"==i[11]?-1:1,n+=60*a*parseInt(i[12],10),i[13]&&(n+=3600*a*parseInt(i[13],10)));r.push(n)}else r.push(0)};e.format.KML.GX_TRACK_PARSERS_=e.xml.makeStructureNS(e.format.KML.NAMESPACE_URIS_,{when:e.format.KML.whenParser_},e.xml.makeStructureNS(e.format.KML.GX_NAMESPACE_URIS_,{coord:e.format.KML.gxCoordParser_}));var g=function(t,o){var r=e.xml.parse(t),i=r.getElementsByTagName(o.toLowerCase());if(i&&i.length>0){var n=i[0].getAttribute("xmlns");if(n&&n.indexOf(" ")>-1&&m.indexOf(n)>-1)for(var a=n.split(" "),l=[],s=0;s<a.length;s++)l.push("xmlns:"+o.toLowerCase()+s+'="'+a[s].trim()+'"')}return t};e.format.KML.prototype.readFeatures=function(t,o){if("string"==typeof t){var r="<kml",i=t.indexOf(r);if(i>=0){i+=r.length;{t.indexOf(">",i)}t.indexOf("xmlns:xsi=")<0&&(t=t.substr(0,i)+' xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"'+t.substr(i));t=g(t,"KML")}}return e.format.XMLFeature.prototype.readFeatures.call(this,t,o)};e.format.XSD.readDateTime=function(t){t=e.xml.getAllTextContent(t,!1);if(t=/^\s*(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(Z|(?:([+\-])(\d{2})(?::(\d{2}))?))\s*$/.exec(t)){var o=parseInt(t[1],10),r=parseInt(t[2],10)-1,i=parseInt(t[3],10),n=parseInt(t[4],10),a=parseInt(t[5],10),l=parseInt(t[6],10),o=Date.UTC(o,r,i,n,a,l);"Z"!=t[7]&&(r="-"==t[8]?-1:1,o+=60*r*parseInt(t[9],10),void 0!==t[10]&&(o+=3600*r*parseInt(t[10],10)));return o}};e.format.GPX.RTEPT_PARSERS_=e.xml.makeStructureNS(e.format.GPX.NAMESPACE_URIS_,{ele:e.xml.makeObjectPropertySetter(e.format.XSD.readDecimal),time:e.xml.makeObjectPropertySetter(e.format.XSD.readDateTime)});e.format.GPX.TRKPT_PARSERS_=e.xml.makeStructureNS(e.format.GPX.NAMESPACE_URIS_,{ele:e.xml.makeObjectPropertySetter(e.format.XSD.readDecimal),time:e.xml.makeObjectPropertySetter(e.format.XSD.readDateTime)});e.format.GPX.WPT_PARSERS_=e.xml.makeStructureNS(e.format.GPX.NAMESPACE_URIS_,{ele:e.xml.makeObjectPropertySetter(e.format.XSD.readDecimal),time:e.xml.makeObjectPropertySetter(e.format.XSD.readDateTime),magvar:e.xml.makeObjectPropertySetter(e.format.XSD.readDecimal),geoidheight:e.xml.makeObjectPropertySetter(e.format.XSD.readDecimal),name:e.xml.makeObjectPropertySetter(e.format.XSD.readString),cmt:e.xml.makeObjectPropertySetter(e.format.XSD.readString),desc:e.xml.makeObjectPropertySetter(e.format.XSD.readString),src:e.xml.makeObjectPropertySetter(e.format.XSD.readString),link:e.format.GPX.parseLink_,sym:e.xml.makeObjectPropertySetter(e.format.XSD.readString),type:e.xml.makeObjectPropertySetter(e.format.XSD.readString),fix:e.xml.makeObjectPropertySetter(e.format.XSD.readString),sat:e.xml.makeObjectPropertySetter(e.format.XSD.readNonNegativeInteger),hdop:e.xml.makeObjectPropertySetter(e.format.XSD.readDecimal),vdop:e.xml.makeObjectPropertySetter(e.format.XSD.readDecimal),pdop:e.xml.makeObjectPropertySetter(e.format.XSD.readDecimal),ageofdgpsdata:e.xml.makeObjectPropertySetter(e.format.XSD.readDecimal),dgpsid:e.xml.makeObjectPropertySetter(e.format.XSD.readNonNegativeInteger),extensions:e.format.GPX.parseExtensions_});e.format.XSD.writeDateTimeTextNode=function(t,o){var r=new Date(o),i=r.getUTCFullYear()+"-"+e.string.padNumber(r.getUTCMonth()+1,2)+"-"+e.string.padNumber(r.getUTCDate(),2)+"T"+e.string.padNumber(r.getUTCHours(),2)+":"+e.string.padNumber(r.getUTCMinutes(),2)+":"+e.string.padNumber(r.getUTCSeconds(),2)+"Z";t.appendChild(e.xml.DOCUMENT.createTextNode(i))};e.format.GPX.WPT_TYPE_SERIALIZERS_=e.xml.makeStructureNS(e.format.GPX.NAMESPACE_URIS_,{ele:e.xml.makeChildAppender(e.format.XSD.writeDecimalTextNode),time:e.xml.makeChildAppender(e.format.XSD.writeDateTimeTextNode),magvar:e.xml.makeChildAppender(e.format.XSD.writeDecimalTextNode),geoidheight:e.xml.makeChildAppender(e.format.XSD.writeDecimalTextNode),name:e.xml.makeChildAppender(e.format.XSD.writeStringTextNode),cmt:e.xml.makeChildAppender(e.format.XSD.writeStringTextNode),desc:e.xml.makeChildAppender(e.format.XSD.writeStringTextNode),src:e.xml.makeChildAppender(e.format.XSD.writeStringTextNode),link:e.xml.makeChildAppender(e.format.GPX.writeLink_),sym:e.xml.makeChildAppender(e.format.XSD.writeStringTextNode),type:e.xml.makeChildAppender(e.format.XSD.writeStringTextNode),fix:e.xml.makeChildAppender(e.format.XSD.writeStringTextNode),sat:e.xml.makeChildAppender(e.format.XSD.writeNonNegativeIntegerTextNode),hdop:e.xml.makeChildAppender(e.format.XSD.writeDecimalTextNode),vdop:e.xml.makeChildAppender(e.format.XSD.writeDecimalTextNode),pdop:e.xml.makeChildAppender(e.format.XSD.writeDecimalTextNode),ageofdgpsdata:e.xml.makeChildAppender(e.format.XSD.writeDecimalTextNode),dgpsid:e.xml.makeChildAppender(e.format.XSD.writeNonNegativeIntegerTextNode)});var d=function(e){for(var t=[],o=[],r=Math.pow(2,e.length),i=0;r>i;i++){o=[];for(var n=0;n<e.length;n++)i&Math.pow(2,n)&&-1==o.indexOf(e[n])&&o.push(e[n]);o.length>0&&-1==t.indexOf(o.join(" "))&&t.push(o.join(" "))}return t},h=function(e,t){if(e&&e.length>0)for(var o=0;o<t.length;o++){var r=e.indexOf(t[o]);r>-1&&e.splice(r,1)}},f=function(e,t){for(var o=0;o<e.length;o++)for(var r=e[o],i=0;i<t.length;i++){var n=t[i].split(" ")[0];r[t[i]]=r[n]}},y=[e.format.KML.DATA_PARSERS_,e.format.KML.EXTENDED_DATA_PARSERS_,e.format.KML.REGION_PARSERS_,e.format.KML.LAT_LON_ALT_BOX_PARSERS_,e.format.KML.LOD_PARSERS_,e.format.KML.EXTRUDE_AND_ALTITUDE_MODE_PARSERS_,e.format.KML.FLAT_LINEAR_RING_PARSERS_,e.format.KML.FLAT_LINEAR_RINGS_PARSERS_,e.format.KML.GX_TRACK_PARSERS_,e.format.KML.GEOMETRY_FLAT_COORDINATES_PARSERS_,e.format.KML.ICON_PARSERS_,e.format.KML.ICON_STYLE_PARSERS_,e.format.KML.INNER_BOUNDARY_IS_PARSERS_,e.format.KML.LABEL_STYLE_PARSERS_,e.format.KML.LINE_STYLE_PARSERS_,e.format.KML.MULTI_GEOMETRY_PARSERS_,e.format.KML.GX_MULTITRACK_GEOMETRY_PARSERS_,e.format.KML.NETWORK_LINK_PARSERS_,e.format.KML.LINK_PARSERS_,e.format.KML.OUTER_BOUNDARY_IS_PARSERS_,e.format.KML.PAIR_PARSERS_,e.format.KML.PLACEMARK_PARSERS_,e.format.KML.POLY_STYLE_PARSERS_,e.format.KML.SCHEMA_DATA_PARSERS_,e.format.KML.STYLE_PARSERS_,e.format.KML.STYLE_MAP_PARSERS_],m=d(e.format.KML.NAMESPACE_URIS_.slice().slice(1));h(m,e.format.KML.NAMESPACE_URIS_);e.format.KML.NAMESPACE_URIS_=e.format.KML.NAMESPACE_URIS_.concat(m);f(y,m);var v=[e.format.GPX.GPX_PARSERS_,e.format.GPX.LINK_PARSERS_,e.format.GPX.RTE_PARSERS_,e.format.GPX.RTEPT_PARSERS_,e.format.GPX.TRK_PARSERS_,e.format.GPX.TRKSEG_PARSERS_,e.format.GPX.TRKPT_PARSERS_,e.format.GPX.WPT_PARSERS_,e.format.GPX.LINK_SERIALIZERS_,e.format.GPX.RTE_SEQUENCE_,e.format.GPX.RTE_SERIALIZERS_,e.format.GPX.RTEPT_TYPE_SEQUENCE_,e.format.GPX.TRK_SEQUENCE_,e.format.GPX.TRK_SERIALIZERS_,e.format.GPX.TRKSEG_SERIALIZERS_,e.format.GPX.WPT_TYPE_SEQUENCE_,e.format.GPX.WPT_TYPE_SERIALIZERS_,e.format.GPX.GPX_SERIALIZERS_],C=d(e.format.GPX.NAMESPACE_URIS_.slice().slice(1));h(C,e.format.GPX.NAMESPACE_URIS_);e.format.GPX.NAMESPACE_URIS_=e.format.GPX.NAMESPACE_URIS_.concat(C);f(v,C);e.format.GML3Patched=function(t){var o=new e.format.GML(t);o.FEATURE_COLLECTION_PARSERS[e.format.GMLBase.GMLNS].featureMember=e.xml.makeArrayPusher(e.format.GMLBase.prototype.readFeaturesInternal);return o};e.format.GMLBase.prototype.readFeaturesInternal=function(t,o){e.DEBUG&&console.assert(t.nodeType==Node.ELEMENT_NODE,"node.nodeType should be ELEMENT");var r=t.localName,i=null;if("FeatureCollection"==r){var n=this.FEATURE_COLLECTION_PARSERS[e.format.GMLBase.GMLNS];n.member||(n.member=e.xml.makeArrayPusher(e.format.GMLBase.prototype.readFeaturesInternal));if("http://www.opengis.net/wfs"===t.namespaceURI)i=e.xml.pushParseAndPop([],this.FEATURE_COLLECTION_PARSERS,t,o,this);else{this.FEATURE_COLLECTION_PARSERS[t.namespaceURI]=this.FEATURE_COLLECTION_PARSERS[t.namespaceURI]||this.FEATURE_COLLECTION_PARSERS[e.format.GMLBase.GMLNS];i=e.xml.pushParseAndPop([],this.FEATURE_COLLECTION_PARSERS,t,o,this)}}else if("featureMembers"==r||"featureMember"==r||"member"==r){var a,l,s=o[0],p=s.featureType,c=s.featureNS,u="p",g="p0";if(t.childNodes){p=[],c={};for(a=0,l=t.childNodes.length;l>a;++a){var d=t.childNodes[a];if(1===d.nodeType){var h=d.nodeName.split(":").pop();if(-1===p.indexOf(h)){var f="",y=0,m=d.namespaceURI;for(var v in c){if(c[v]===m){f=v;break}++y}if(!f){f=u+y;c[f]=m}p.push(f+":"+h)}}}if("featureMember"!=r&&"member"!=r){s.featureType=p;s.featureNS=c}}if("string"==typeof c){var C=c;c={};c[g]=C}var T={},_=Array.isArray(p)?p:[p];for(var S in c){var E={};for(a=0,l=_.length;l>a;++a){var x=-1===_[a].indexOf(":")?g:_[a].split(":")[0];x===S&&(E[_[a].split(":").pop()]="featureMembers"==r?e.xml.makeArrayPusher(this.readFeatureElement,this):e.xml.makeReplacer(this.readFeatureElement,this))}T[c[S]]=E}i="featureMember"==r||"member"==r?e.xml.pushParseAndPop(void 0,T,t,o):e.xml.pushParseAndPop([],T,t,o)}null===i&&(i=[]);var P=function(e){var t=e.getGeometry();if(e.getProperties()[e.getGeometryName()]&&(!t||!t.flatCoordinates.length))throw"Geometr\xeda no v\xe1lida. \xbfPosible versi\xf3n incorrecta de GML?"};if(i instanceof e.Feature)P(i);else for(var a=0,L=i.length;L>a;a++)P(i[a]);return i};e.format.GML3CRS84=function(){e.format.GML3.call(this,{srsName:"CRS:84"})};e.inherits(e.format.GML3CRS84,e.format.GML3);e.format.GML2CRS84=function(){e.format.GML2.call(this,{srsName:"CRS:84"})};e.inherits(e.format.GML2CRS84,e.format.GML2);e.View.prototype.getValueForResolutionFunction=function(e){var t=e||2,o=this.maxResolution_,r=this.minResolution_,i=Math.log(o/r)/Math.log(t);return function(e){var r=Math.log(o/e)/Math.log(t)/i;r=Math.max(Math.min(1,r),0);return r}};e.control.OverviewMap.prototype._validateExtent_=e.control.OverviewMap.prototype.validateExtent_;e.control.OverviewMap.prototype.validateExtent_=function(){var e=this;e._validateExtent_();e._wrap&&e._wrap.parent.options.alwaysCentered&&e.recenter_()};e.control.OverviewMap.prototype._resetExtent_=e.control.OverviewMap.prototype.resetExtent_;e.control.OverviewMap.prototype.resetExtent_=function(){var t=this;t._resetExtent_.call(t);var o=t._wrap;if(o.is3D){var r=t.ovmap_,i=r.getView(),n=i.calculateExtent(),a=o.get3DCameraLayer().getSource().getFeatures()[0];if(a){coordinates=a.getGeometry().getCoordinates();var l=coordinates[0][0],s=coordinates[0][1];if(!e.extent.containsCoordinate(n,l)||!e.extent.containsCoordinate(n,s)){var p=Math.max(n[0]-l[0],n[1]-l[1],l[0]-n[2],l[1]-n[3],n[0]-s[0],n[1]-s[1],s[0]-n[2],s[1]-n[3]);i.fit(e.extent.buffer(n,p))}}}};var T=function(t,o){var r;if(t){r=e.color.asArray(t);r=r.slice();void 0!==o&&(r[3]=o)}else r=[0,0,0,1];return r},_=function(e,t){var o=e.map.getView(),r=o.getResolution(),i={projection:o.getProjection(),center:o.getCenter(),resolution:r,enableRotation:!1};e.parent.options.maxExtent&&(i.extent=e.parent.options.initialExtent);if(t instanceof TC.layer.Raster){var n,a,l=t.getResolutions();if(l&&l.length){n=t.maxResolution||l[0];a=t.minResolution||l[l.length-1];var s=l.indexOf(a),p=l.indexOf(n);i.resolutions=l.slice(p,s+1)}else{n=t.maxResolution;a=t.minResolution}if(a){i.minResolution=a;a>r&&(i.resolution=a)}if(n){i.maxResolution=n;r>n&&(i.resolution=n)}}return i};TC.wrap.Map.prototype.setMap=function(){var t=this,o=[(t.parent.options.initialExtent[0]+t.parent.options.initialExtent[2])/2,(t.parent.options.initialExtent[1]+t.parent.options.initialExtent[3])/2],r=proj4(t.parent.crs),i=function(){var o=t.parent.crs.substr(t.parent.crs.lastIndexOf(":")+1),i={units:r.oProj.units,extent:t.parent.options.baselayerExtent,global:!0,worldExtent:t.parent.options.baselayerExtent},n=[];i.code="EPSG:"+o;n.push(new e.proj.Projection(i));i.code="urn:ogc:def:crs:EPSG::"+o;n.push(new e.proj.Projection(i));e.proj.addEquivalentProjections(n);var a=function(e,t,o,r){for(var i=[],n=r||2,a=0;a<t.length;a+=n)i=i.concat(e(t.slice(a,a+n)));if($.isArray(o)){o.length=0;for(var a=0;a<i.length;a++)o[a]=i[a];i=o}return i},l=function(e,t,o){return a(r.forward,e,t,o)},s=function(e,t,o){return a(r.inverse,e,t,o)};e.proj.addEquivalentTransforms(e.proj.EPSG4326.PROJECTIONS,n,l,s)};i();var n={code:t.parent.crs,units:r.oProj.units,extent:t.parent.options.baselayerExtent};"EPSG:4326"===t.parent.crs&&(n.axisOrientation="neu");var a=new e.proj.Projection(n),l=e.interaction.defaults(),s={projection:a,center:o,enableRotation:!1};if(t.parent.options.maxExtent){var p=t.parent.options.maxExtent;s.extent=p;var c=t.parent.div.getBoundingClientRect(),u=(c.width/c.height,p[2]-p[0]),g=p[3]-p[1];s.resolution=c.width/c.height>u/g?u/c.width:g/c.height}else s.zoom=2;t.map=new e.Map({target:t.parent.div,renderer:e.renderer.Type.CANVAS,view:new e.View(s),controls:[],interactions:l});t.map.getView().fit(t.parent.options.initialExtent);t.map._wrap=t;var d=function(){t.map.updateSize()};$(t.parent.div).on(e.events.EventType.RESIZE,d);t.parent.$events.one(TC.Consts.event.MAPLOAD,d);t.map.on(e.MapBrowserEventType.SINGLECLICK,function(e){var o=$.map(t.parent.workLayers,function(){return!1});t.map.forEachFeatureAtPixel(e.pixel,function(e,r){if(e._wrap&&e._wrap.parent.showsPopup){for(var i=0;i<t.parent.workLayers.length;i++){var n=t.parent.workLayers[i];if(n.wrap.layer===r){o[i]=!0;break}}t.parent.$events.trigger($.Event(TC.Consts.event.FEATURECLICK,{feature:e._wrap.parent}));return e}});for(var r=0;r<o.length;r++)o[r]||t.parent.$events.trigger($.Event(TC.Consts.event.NOFEATURECLICK,{layer:t.parent.workLayers[r]}))});var h=t.map.getView();h.on("change:resolution",function(){t.parent.$events.trigger($.Event(TC.Consts.event.BEFOREZOOM))},t.parent);t.map.on(e.MapEventType.MOVEEND,function(){t.parent.$events.trigger($.Event(TC.Consts.event.ZOOM))});t.mapDeferred.resolve(t.map);var f=function(o,r){var i=(t.map.getView().getResolution(),t.map.getView().getZoom(),r||_(t,o)),n=new e.View(i);t.map.setView(n);t.map.render()};t.parent.$events.on(TC.Consts.event.BASELAYERCHANGE,function(e){f(e.layer)});t.parent.$events.on(TC.Consts.event.MAPLOAD,function(e){f(t.parent.getBaseLayer())})};TC.wrap.Map.prototype.insertLayer=function(t,o){for(var r=this,i=r.map.getLayers(),n=!1,a=0;a<i.getLength();a++)if(i.item(a)===t){n=!0;break}if(n){i.remove(t);i.insertAt(o,t)}else{i.insertAt(o,t);if(t instanceof e.layer.Tile){var l=t.getSource().getResolutions(),s=r.map.getView();s.maxResolution_=l[0];s.minResolution_=l[l.length-1]}var p=t._wrap,c=0,u=function(e){p.parent.state=TC.Layer.state.LOADING;if(0>=c){c=0;r.parent.$events.trigger($.Event(TC.Consts.event.BEFORELAYERUPDATE,{layer:p.parent}))}t._loadingTileCount=t._loadingTileCount+1};p.parent.state===TC.Layer.state.LOADING&&p.parent.isRaster()&&u();p.$events.on(TC.Consts.event.BEFORETILELOAD,u);p.$events.on(TC.Consts.event.TILELOAD,function(e){c-=1;if(0>=c){c=0;p.parent.state=TC.Layer.state.IDLE;r.parent.$events.trigger($.Event(TC.Consts.event.LAYERUPDATE,{layer:p.parent}))}})}};TC.wrap.Map.prototype.removeLayer=function(e){this.map.removeLayer(e)};TC.wrap.Map.prototype.getLayerCount=function(){return this.map.getLayerGroup().getLayers().getLength()};TC.wrap.Map.prototype.indexOfFirstVector=function(){var t=-1;this.map.getLayerGroup().getLayers().forEach(function(o,r){o instanceof e.layer.Vector&&-1===t&&(t=r)});return t};TC.wrap.Map.prototype.getLayerIndex=function(e){var t=-1;this.map.getLayerGroup().getLayers().forEach(function(o,r){o===e&&(t=r)});return t};TC.wrap.Map.prototype.setLayerIndex=function(e,t){var o=this.map.getLayers(),r=o.getArray(),i=r.indexOf(e);if(i>-1&&i!=t){this.map.removeLayer(e);this.insertLayer(e,t)}};TC.wrap.Map.prototype.setBaseLayer=function(e){var t=this,o=new $.Deferred,r=_(t,e._wrap.parent),i=t.map.getView(),n=function(){var r=t.parent.getBaseLayer();r&&t.map.removeLayer(r.wrap.getLayer());t.insertLayer(e,0);o.resolve()},a=i.getResolution();if(r.resolutions&&r.resolutions.indexOf(a)<0){r.resolution=$.grep(r.resolutions.sort(function(e,t){return e-t}),function(e){return e>r.resolution})[0];i.animate({resolution:r.resolution,duration:TC.Consts.ZOOM_ANIMATION_DURATION},function(){n()})}else n();return o.promise()};TC.wrap.Map.prototype.setExtent=function(t,o){var r=this;r.done&&r.done.resolve();r.done=new $.Deferred;var i=o||{};clearTimeout(r._timeout);r._timeout=setTimeout(function(){var o=r.map.getSize(),n=r.map.getView(),a=function(){r.done.resolve()},l=function(){var e=n.getResolutionForExtent(t,o);if(n.constrainResolution){var r=n.constrainResolution(e,0,0);e>r&&(r=r/e<TC.Consts.EXTENT_TOLERANCE?n.constrainResolution(r,-1,0):n.constrainResolution(e,0,0));e=r}n.animate({resolution:e,center:[(t[0]+t[2])/2,(t[1]+t[3])/2],duration:void 0===i.animate||i.animate?TC.Consts.ZOOM_ANIMATION_DURATION:0},a)};r.parent.baseLayer?$.when(r.parent.baseLayer.wrap.getLayer()).then(function(i){var a=i.getSource();if(a.getResolutions!=goog.abstractMethod){var s=n.getResolutionForExtent(t,o),p=r.parent.baseLayer.getResolutions();if(p&&p.length>0){var c=Math.min.apply(r,p);if(c>s){var u=.5*(c/s-1),g=e.extent.getWidth(t)*u,d=e.extent.getHeight(t)*u;t=t.slice(0);t[0]=t[0]-g;t[1]=t[1]-d;t[2]=t[2]+g;t[3]=t[3]+d}}}l()}):l()},50);return r.done};TC.wrap.Map.prototype.getExtent=function(){return this.map.getView().calculateExtent(this.map.getSize())};TC.wrap.Map.prototype.setCenter=function(e,t){var o=this,r=t||{},i=o.map.getView();r.animate?i.animate({center:e,duration:TC.Consts.ZOOM_ANIMATION_DURATION}):i.setCenter(e)};TC.wrap.Map.prototype.getCenter=function(){return this.map.getView().getCenter()};TC.wrap.Map.prototype.getResolution=function(){return this.map.getView().getResolution()};TC.wrap.Map.prototype.setResolution=function(e){$.when(this.getMap()).then(function(t){t.getView().setResolution(e)})};TC.wrap.Map.prototype.setRotation=function(e){$.when(this.getMap()).then(function(t){t.getView().setRotation(e)})};TC.wrap.Map.prototype.getRotation=function(){return this.map.getView().getRotation()};TC.wrap.Map.prototype.getCoordinateFromPixel=function(e){return this.map.getCoordinateFromPixel(e)};TC.wrap.Map.prototype.getPixelFromCoordinate=function(e){return this.map.getPixelFromCoordinate(e)};TC.wrap.Map.prototype.getViewport=function(e){var t=this,o=e||{};if(o.synchronous)r=t.map.getViewport();else{var r=new $.Deferred;$.when(this.getMap()).then(function(e){r.resolve(e.getViewport())})}return r};TC.wrap.Map.prototype.isNative=function(t){return t instanceof e.Map};TC.wrap.Map.prototype.isGeo=function(){return this.map.getView().getProjection().getUnits()===e.proj.Units.DEGREES};TC.wrap.Map.prototype.addPopup=function(t){var o=$.Deferred(),r=this,n=void 0===t.options.draggable||t.options.draggable;TC.loadJS(n&&!$.fn.drag,[TC.apiLocation+"lib/jQuery/jquery.event.drag.js"],function(){$.when(r.getMap()).then(function(o){if(!t.$popupDiv){var a=TC.Util.getDiv();t.$popupDiv=$(a);t.$popupDiv.addClass(TC.control.Popup.prototype.CLASS).appendTo(r.parent.div);t.$contentDiv=$(TC.Util.getDiv()).addClass(TC.control.Popup.prototype.CLASS+"-content").appendTo(t.$popupDiv);var l=new e.Overlay({element:a,positioning:e.OverlayPositioning.BOTTOM_LEFT});o.addOverlay(l);t.wrap.popup=l;var s=$(o.getViewport());if(n){var p=t.$popupDiv.parent();t.$popupDiv.addClass(TC.Consts.classes.DRAGGABLE);p.on("touchmove",function(e){$(e.target).parents(".tc-ctl-finfo-layer-content").length&&e.stopPropagation()}).drag("start",function(e,r){var i=e.target.getBoundingClientRect();if(i.left+e.target.clientWidth<e.clientX||i.top+e.target.clientHeight<e.clientY)return!1;t.setDragging(!0);t._currentOffset=l.getOffset();if(t._previousContainerPosition){var n=o.getSize();l.setPosition(o.getCoordinateFromPixel([t._previousContainerPosition[0],n[1]-t._previousContainerPosition[1]]));t._currentOffset=[0,0];l.setOffset(t._currentOffset);delete t._previousContainerPosition}else t._currentOffset=l.getOffset()}).drag("end",function(e,r){t.setDragging(!1);var i=o.getCoordinateFromPixel([0,0]),n=o.getCoordinateFromPixel(l.getOffset()),a=[n[0]-i[0],n[1]-i[1]],s=l.getPosition();l.setPosition([s[0]+a[0],s[1]+a[1]]);l.setOffset([0,0]);t._currentOffset=[0,0];t._previousContainerPosition=[parseInt(p.css("left")),parseInt(p.css("bottom"))]}).drag(function(e,o){if(!e.buttons&&!Modernizr.touch)return!1;l.setOffset([t._currentOffset[0]+o.deltaX,t._currentOffset[1]+o.deltaY]);return void 0},{not:"th,td, td *,input,select"}).on("mouseenter",function(e){s.off(i+".popup")}).on("mouseleave",function(e){s.on(i+".popup",c)})}var c=function(e){var t=o.getTarget(),i=!1;if(!r.parent.activeControl||!r.parent.activeControl.isExclusive()){var n=o.getEventPixel(e.originalEvent);i=o.forEachFeatureAtPixel(n,function(e,t){var o=!0;e=e;e._wrap&&!e._wrap.parent.showsPopup&&(o=!1);o&&e._wrap&&r.parent.$events.trigger($.Event(TC.Consts.event.FEATUREOVER,{
feature:e._wrap.parent}));return o})}if(i)t.style.cursor="pointer";else{t.style.cursor="";r.parent.$events.trigger($.Event(TC.Consts.event.FEATUREOUT))}};s.off(i+".popup").on(i+".popup",c)}});o.resolve()});o.promise()};TC.wrap.Map.prototype.hidePopup=function(e){var t=this;t.parent.currentFeature=null;e.$popupDiv&&e.$popupDiv.removeClass(TC.Consts.classes.VISIBLE)};var S=function(t){switch(t){case TC.Consts.layerType.KML:case TC.Consts.mimeType.KML:return new e.format.KML({showPointNames:!1});case TC.Consts.layerType.GPX:return new e.format.GPX;case TC.Consts.layerType.GEOJSON:case TC.Consts.mimeType.JSON:case TC.Consts.format.JSON:return new e.format.GeoJSON;case TC.Consts.format.GML2:return new e.format.GML2;case TC.Consts.format.GML3:return new e.format.GML3Patched;case TC.Consts.mimeType.GML:case TC.Consts.format.GML:return new e.format.GML;case TC.Consts.format.TOPOJSON:return new e.format.TopoJSON;case TC.Consts.format.WKT:return new e.format.WKT}};TC.wrap.Map.prototype.exportFeatures=function(t,o){var r=this,i=M({styles:r.parent.options.styles}),n=t.map(function(e){var t=e.wrap.feature;t.getStyle()||t.setStyle(i);return t}),a=S(o.format);if(a instanceof e.format.GMLBase){a.featureNS="sitna";a.featureType="getFeatureInfoResult";var l=a.writeFeaturesNode(n,{featureProjection:r.parent.crs}),s=e.xml.createElementNS("http://www.opengis.net/gml","FeatureCollection");e.xml.setAttributeNS(s,"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation",a.schemaLocation);l.removeAttribute("xmlns:xsi");l.removeAttribute("xsi:schemaLocation");s.appendChild(l);return s.outerHTML}return a.writeFeatures(n,{featureProjection:r.parent.crs})};var E=function(e){for(var t=0,o=e.dataTransfer.types.length;o>t;t++)if("Files"===e.dataTransfer.types[t])return!0;return!1},x=function(e){var t=this;if(E(e)){t.getMap()._wrap.parent._$div.addClass(TC.Consts.classes.DROP);e.preventDefault();e.stopPropagation()}},P=function(e){var t=this;if(E(e)){var o=t.getMap()._wrap.parent;e.target===t.target&&o._$div.removeClass(TC.Consts.classes.DROP)}};TC.wrap.Map.prototype.enableDragAndDrop=function(t){var o=this,r=t||{},i={formatConstructors:[e.format.KML,e.format.GPX,e.format.GML3CRS84,e.format.GML2CRS84,e.format.GML3Patched,e.format.GML2,e.format.GeoJSON,function(){return new e.format.WKT({splitCollection:!0})},e.format.TopoJSON]};i.target=r.dropTarget?TC.getDiv(r.dropTarget):o.parent.div;var n=new e.interaction.DragAndDrop(i);n.on(e.interaction.DragAndDrop.EventType_.ADD_FEATURES,function(e){var t=e.features?e.features.map(function(e){return TC.wrap.Feature.createFeature(e)}):[];$.when.apply(this,t).then(function(){var t=o.parent.getLoadingIndicator();t&&t.removeWait(o._featureImportWaitId);if(arguments.length){for(var r=new Array(arguments.length),i=0,n=r.length;n>i;i++)r[i]=arguments[i];o.parent.$events.trigger($.Event(TC.Consts.event.FEATURESIMPORT,{features:r,fileName:e.file.name}))}else o.parent.$events.trigger($.Event(TC.Consts.event.FEATURESIMPORTERROR,{file:e.file}))})});if(r.once)n.map_=o.map;else{o.map.addInteraction(n);var a=n.target?n.target:o.map.getViewport(),l=function(e){if(E(e)){var t=o.parent;if(n.target===e.target){var r=t.getLoadingIndicator();r&&(o._featureImportWaitId=r.addWait());e.stopPropagation()}else e.preventDefault();t._$div.removeClass(TC.Consts.classes.DROP)}};n.dropListenKeys_.push(e.events.listen(a,e.events.EventType.DRAGENTER,x,n));n.dropListenKeys_.push(e.events.listen(document.body,e.events.EventType.DRAGENTER,x,n));n.dropListenKeys_.push(e.events.listen(a,e.events.EventType.DRAGOVER,x,n));n.dropListenKeys_.push(e.events.listen(document.body,e.events.EventType.DRAGOVER,x,n));n.dropListenKeys_.push(e.events.listen(a,e.events.EventType.DROP,l,n));n.dropListenKeys_.push(e.events.listen(document.body,e.events.EventType.DROP,l,n));n.dropListenKeys_.push(e.events.listen(document.body,"dragleave",P,n));n.dropListenKeys_.push(e.events.listen(document.body,"dragend",P,n));n.dropListenKeys_.push(e.events.listen(document.body,"dragexit",P,n));document.addEventListener("mouseenter",function(e){e.buttons||o.parent._$div.removeClass(TC.Consts.classes.DROP)},!1);o.ddEnabled=!0}return n};TC.wrap.Map.prototype.loadFiles=function(t){var o,r=this;r.ddEnabled?r.map.getInteractions().forEach(function(t){t instanceof e.interaction.DragAndDrop&&(o=t)}):o=r.enableDragAndDrop({once:!0});var i=r.parent.getLoadingIndicator();i&&(r._featureImportWaitId=i.addWait());e.interaction.DragAndDrop.handleDrop_.call(o,{dataTransfer:{files:t}})};TC.wrap.Layer.prototype.getVisibility=function(e){var t=this,o=!1;t.layer&&(o=t.layer.getVisible());return o};TC.wrap.Layer.prototype.setVisibility=function(e){var t=this;$.when(t.getLayer()).then(function(t){t.setVisible(e)})};TC.wrap.Layer.prototype.isNative=function(t){return t instanceof e.layer.Layer};TC.wrap.layer.Raster.prototype.WmsParser=e.format.WMSCapabilities;TC.wrap.layer.Raster.prototype.WmtsParser=e.format.WMTSCapabilities;TC.wrap.Layer.prototype.addCommonEvents=function(e){var t=this;e.on("change:visible",function(){t.parent.map&&t.parent.map.$events.trigger($.Event(TC.Consts.event.LAYERVISIBILITY,{layer:t.parent}))},t.parent.map)};TC.wrap.layer.Raster.prototype.getGetMapUrl=function(){var e=null,t=this;switch(t.getServiceType()){case TC.Consts.layerType.WMS:for(var o=t.parent.capabilities.Capability.Request.GetMap.DCPType,r=0;r<o.length;r++)if(o[r].HTTP&&o[r].HTTP.Get){e=o[r].HTTP.Get.OnlineResource;break}break;case TC.Consts.layerType.WMTS:e=t.parent.capabilities.OperationsMetadata.GetTile.DCP.HTTP.Get[0].href}e=$("<textarea />").html(e).text();return e};TC.wrap.layer.Raster.prototype.getInfoFormats=function(){var e=null,t=this.parent.capabilities;t.Capability&&t.Capability.Request.GetFeatureInfo&&(e=t.Capability.Request.GetFeatureInfo.Format);return e};TC.wrap.layer.Raster.infoFormatPreference=["application/json","application/vnd.ogc.gml/3.1.1","application/vnd.ogc.gml","application/vnd.esri.wms_featureinfo_xml","text/html","text/plain","text/xml"];TC.wrap.layer.Raster.prototype.getWMTSLayer=function(){var e=null,t=this,o=t.parent.capabilities;if(o&&o.Contents)for(var r=0;r<o.Contents.Layer.length;r++)for(var i=o.Contents.Layer[r],n=0;n<i.TileMatrixSetLink.length;n++)if(t.parent.options.matrixSet===i.TileMatrixSetLink[n].TileMatrixSet){e=i;break}return e};TC.wrap.layer.Raster.prototype.getTileMatrix=function(e){var t=null,o=this,r=o.parent.capabilities;if(r&&r.Contents&&r.Contents.TileMatrixSet)for(var i=0;i<r.Contents.TileMatrixSet.length;i++){var n=r.Contents.TileMatrixSet[i];if(n.Identifier===e){t=n.TileMatrix;break}}return t};TC.wrap.layer.Raster.prototype.getScaleDenominators=function(e){var t=[],o=this;e.ScaleDenominator?t=[e.ScaleDenominator,e.ScaleDenominator]:(e.MinScaleDenominator||e.MaxScaleDenominator)&&(t=[e.MaxScaleDenominator,e.MinScaleDenominator]);if(!t.length&&!o.getName(e)){for(var r=o.getLayerNodes(e),i=-(1/0),n=1/0,a=0,l=r.length;l>a;a++){var s=o.getScaleDenominators(r[a]);s[0]>i&&(i=s[0]);s[1]<n&&(n=s[1])}i>-(1/0)&&1/0>n&&(t=[i,n])}return t};TC.wrap.layer.Raster.prototype.getAttribution=function(e){var t=null;e&&(t=e.ServiceIdentification?e.ServiceIdentification.Title:e.Service.Title);return t};TC.wrap.layer.Raster.prototype.getInfo=function(e){var t=this,o={},r=t.parent.capabilities;if(r&&r.Capability)for(var i=t.getAllLayerNodes(),n=0;n<i.length;n++){var a=i[n];if(t.parent.compareNames(t.getName(a),e)){a.Title&&(o.title=a.Title);a.Abstract&&(o["abstract"]=a.Abstract);o.legend=[];var l=function(e){var t=this.getLegend(e);t.src&&o.legend.push({src:t.src,title:e.Title})},s=function(e,o){if(e.Layer&&e.Layer.length>0)for(var r in e.Layer)s(e.Layer[r],o);else o.apply(t,[e])};s(a,l);if(a.MetadataURL&&a.MetadataURL.length){o.metadata=[];for(var p=0;p<a.MetadataURL.length;p++){var c=a.MetadataURL[p];o.metadata.push({format:c.Format,type:c.type,url:c.OnlineResource})}}o.queryable=a.queryable;break}}return o};TC.wrap.layer.Raster.prototype.getServiceType=function(){var e=null,t=this.parent.capabilities;t.Capability&&t.Capability.Request&&t.Capability.Request.GetMap?e=TC.Consts.layerType.WMS:t.OperationsMetadata&&t.OperationsMetadata.GetTile&&(e=TC.Consts.layerType.WMTS);return e};TC.wrap.layer.Raster.prototype.getServiceTitle=function(){var e=null,t=this.parent.capabilities;t.Capability&&t.Service?e=t.Service.Title:t.ServiceIdentification&&(e=t.ServiceIdentification.Title);return e};TC.wrap.layer.Raster.prototype.getRootLayerNode=function(){var e,t=this;t.getServiceType()===TC.Consts.layerType.WMS&&(e=t.parent.capabilities.Capability.Layer);return e};TC.wrap.layer.Raster.prototype.getName=function(e,t){var o=e.Name;if(o&&t){var r=o.indexOf(":");r>=0&&(o=o.substr(r+1))}return o};TC.wrap.layer.Raster.prototype.getIdentifier=function(e){return e.Identifier};TC.wrap.layer.Raster.prototype.getLayerNodes=function(e){var t=e.Layer;$.isArray(t)||(t=t?[t]:[]);return t};TC.wrap.layer.Raster.prototype.getAllLayerNodes=function(){var e=this;if(!e._layerList)switch(e.getServiceType()){case TC.Consts.layerType.WMS:var t=function r(t){for(var o=[t],i=e.getLayerNodes(t),n=0;n<i.length;n++)o=o.concat(r(i[n]));return o},o=e.getRootLayerNode();e._layerList=o?t(o):[];break;case TC.Consts.layerType.WMTS:e._layerList=e.parent.capabilities.Contents.Layer.slice();break;default:e._layerList=[]}return e._layerList};TC.wrap.layer.Raster.prototype.normalizeLayerNode=function(e){return e};TC.wrap.layer.Raster.prototype.normalizeCapabilities=function(e){return e};TC.wrap.layer.Raster.prototype.getLegend=function(e){var t={},o=e.Style;if(o&&o.length&&o.length&&o[0].LegendURL&&o[0].LegendURL.length){var r=o[0].LegendURL[0];t.src=$("<textarea />").html(r.OnlineResource).text()}return t};TC.wrap.layer.Raster.prototype.isCompatible=function(e){var t=this,o=!0,r=t.parent;switch(t.getServiceType()){case TC.Consts.layerType.WMS:if(r.capabilities&&r.capabilities.Capability&&r.capabilities.Capability.Layer&&r.names.length>0)for(var i=r.names.slice(0),n=function p(o,i,n){var a=!1;if(o)for(var l=0;l<o.length;l++){var s=o[l],c=n||$.inArray(e,s.CRS||s.SRS)>=0;if(r.compareNames(t.getName(s),i)){c&&(a=!0);break}if(p(s.Layer,i,c)){a=!0;break}}return a};i.length>0;)if(!n([r.capabilities.Capability.Layer],i.pop())){o=!1;break}break;case TC.Consts.layerType.WMTS:var a=new RegExp("^urn:ogc:def:crs:"+e.replace(":",":.*:")+"$|^"+e+"$","g");o=!1;if(r.capabilities&&r.capabilities.Contents&&r.capabilities.Contents.TileMatrixSet)for(var l=r.capabilities.Contents.TileMatrixSet,s=0;s<l.length;s++)if(l[s].Identifier===r.options.matrixSet){o=a.test(l[s].SupportedCRS);break}}return o};TC.wrap.layer.Raster.prototype.getCompatibleLayers=function(e){var t=this,o=[],r=t.parent;switch(t.getServiceType()){case TC.Consts.layerType.WMS:if(r.capabilities&&r.capabilities.Capability&&r.capabilities.Capability.Layer){var i=function(e,t,r){var n=r||$.inArray(t,e.CRS||e.SRS)>=0;n&&e.Name&&(o[o.length]=e.Name);if(e.Layer)for(var a=0;a<e.Layer.length;a++)i(e.Layer[a],t,n)};i(r.capabilities.Capability.Layer,e)}break;case TC.Consts.layerType.WMTS:var n=new RegExp("^urn:ogc:def:crs:"+e.replace(":",":.*:")+"$","g");if(r.capabilities&&r.capabilities.Contents&&r.capabilities.Contents.TileMatrixSet)for(var a=r.capabilities.Contents.TileMatrixSet,l=0;l<a.length;l++)n.test(a[l].SupportedCRS)&&(o[o.length]=a[l].Identifier)}return o};TC.wrap.layer.Raster.prototype.setWMTSUrl=function(){var e=this;$.when(e.getLayer()).then(function(t){e.parent.options=e.parent.options||{};var o=t.getSource().getUrls();e.parent.options.urlPattern=o[o.length-1]})};var L=function(e,t){function o(t){if(200===this.status){var o=URL.createObjectURL(this.response),r=function(t){URL.revokeObjectURL(t.target.src);i.$events.trigger($.Event(TC.Consts.event.TILELOAD,{tile:e}))};n.addEventListener("load",r);n.addEventListener("error",r);n.src=o}else this.status>=400&&this.status<500&&i.$events.trigger($.Event(TC.Consts.event.TILELOADERROR,{tile:e,error:{code:this.status,text:this.statusText}}))}function r(t){i.$events.trigger($.Event(TC.Consts.event.TILELOADERROR,{tile:e,error:{code:this.status,text:this.statusText}}))}var i=this,n=e.getImage();i.parent.usesSSL?t=t.replace(/^(f|ht)tp?:\/\//i,"https://"):i.parent.usesProxy&&TC.Util.isSecureURL(document.location.href)&&!TC.Util.isSecureURL(t)&&(t=TC.proxify(t));i.parent.map&&i.parent.map.options.crossOrigin&&TC.Util.detectIE()&&(t=TC.proxify(t));var a=new XMLHttpRequest;a.open("GET",t);a.responseType="blob";a.onload=o;a.onerror=r;try{a.send()}catch(l){r.call(l)}},w=function(e,t){var o=this;o.$events.trigger($.Event(TC.Consts.event.BEFORETILELOAD,{tile:e}));for(var r=e.getImage(),i=new XMLHttpRequest,n=t.split("?"),a=n[1].split("&"),l="",s=0;s<a.length;s++){var p=a[s].split("=");p&&p.length>1&&p[1]&&"LAYERS"!==p[0]&&(l+="&"+a[s])}i.open("POST",n[0],!0);i.responseType="blob";i.onload=function(t){if(200===this.status){var i=URL.createObjectURL(this.response),n=function(t){URL.revokeObjectURL(t.target.src);o.$events.trigger($.Event(TC.Consts.event.TILELOAD,{tile:e}))};r.addEventListener("load",n);r.addEventListener("error",n);r.src=i}else this.status>=400&&this.status<500&&o.$events.trigger($.Event(TC.Consts.event.TILELOADERROR,{tile:e,error:{code:this.status,text:this.statusText}}))};i.onerror=function(){o.$events.trigger($.Event(TC.Consts.event.TILELOADERROR,{tile:e,error:{code:this.status,text:this.statusText}}))};i.send(l)};TC.wrap.layer.Raster.prototype.createWmsLayer=function(t,o,r){var i=this,n=null,a=null,l=r&&r.method&&"POST"===r.method;i.$events=$(i);a=l?$.proxy(w,i):$.proxy(L,i);var s=new e.source.ImageWMS({url:t,crossOrigin:r.map?r.map.options.crossOrigin:void 0,params:o,extent:TC.Cfg.initialExtent,ratio:TC.Cfg.imageRatio,imageLoadFunction:a});s.on(e.source.Image.EventType_.IMAGELOADSTART,function(e){i.$events.trigger($.Event(TC.Consts.event.BEFORETILELOAD,{tile:e.image.getImage()}))});s.on(e.source.Image.EventType_.IMAGELOADEND,function(e){i.$events.trigger($.Event(TC.Consts.event.TILELOAD,{tile:e.image.getImage()}))});s.on(e.source.Image.EventType_.IMAGELOADERROR,function(e){i.$events.trigger($.Event(TC.Consts.event.TILELOAD,{tile:e.image.getImage()}))});var p={visible:!!o.LAYERS.length||l,source:s};r.minResolution&&(p.minResolution=r.minResolution);r.maxResolution&&(p.maxResolution=r.maxResolution);n=new e.layer.Image(p);n._wrap=i;i.addCommonEvents(n);return n};TC.wrap.layer.Raster.prototype.createWmtsLayer=function(t,o,r){var i=this,n=null;i.$events=$(i);var a=e.source.WMTS.optionsFromCapabilities(i.parent.capabilities,{layer:o,matrixSet:r.matrixSet,crossOrigin:r.map?r.map.options.crossOrigin:void 0,requestEncoding:r.encoding,format:r.format}),l="https:";location.protocol===l&&(a.urls=a.urls.map(function(e){return e.replace("http:",l)}));a.crossOrigin=r.map?r.map.options.crossOrigin:void 0;var s=new e.source.WMTS(a);s.setTileLoadFunction($.proxy(L,i));s.on(e.source.TileEventType.TILELOADSTART,function(e){i.$events.trigger($.Event(TC.Consts.event.BEFORETILELOAD,{tile:e.tile.getImage()}))});s.on(e.source.TileEventType.TILELOADEND,function(e){i.$events.trigger($.Event(TC.Consts.event.TILELOAD,{tile:e.tile.getImage()}))});s.on(e.source.TileEventType.TILELOADERROR,function(e){i.$events.trigger($.Event(TC.Consts.event.TILELOAD,{tile:e.tile.getImage()}))});var p={source:s};r.minResolution&&(p.minResolution=r.minResolution);r.maxResolution&&(p.maxResolution=r.maxResolution);n=new e.layer.Tile(p);n._wrap=i;var c=$.proxy(s.getResolutions,s);s.getResolutions=function(){var e=c(),t=n._wrap.parent.getLimitedMatrixSet();if(t&&t.length){var o=t[0].matrixIndex;e=e.slice(o,t.length+o)}return e};i.addCommonEvents(n);var u=s.getResolutions();n.setMaxResolution(u[0]+1);n.setMinResolution(u[u.length-1]);return n};TC.wrap.layer.Raster.prototype.getParams=function(){return this.layer.getSource().getParams()};TC.wrap.layer.Raster.prototype.setParams=function(e){this.layer.getSource().updateParams(e)};TC.wrap.layer.Raster.prototype.getResolutions=function(){if(this.layer.getSource){var e=this.layer.getSource();return e.getResolutions&&e.getResolutions!=goog.abstractMethod?e.getResolutions():[]}return[]};TC.wrap.Geometry={getNearest:function(t,o){var r=new e.geom.LineString(o);return r.getClosestPoint(t)}};var R=function(e,t,o){if(e){var r=function(r){var i=(o&&o._wrap?o._wrap.parent.options.width:null)||t;if(r>i){var n=i/r;e.setScale(n)}},i=e.getSize();if(i)r(i[0]);else{var n=e.getImage();n.naturalWidth?r(n.naturalWidth):$('<img src="'+e.getSrc()+'">').on("load",function(){r(this.naturalWidth)})}}},A=function(e,t){var o=e,r=t&&t.wrap&&t.wrap.feature;if("string"==typeof e){var i=e.match(/^\$\{(.+)\}$/);if(i&&r){for(var n=i[1].split("."),a=r.getProperties(),l=0;l<n.length&&void 0!==a;l++)a=a[n[l]];if(void 0===a){a=t.data;for(var l=0;l<n.length&&void 0!==a;l++)a=a[n[l]]}o=a}}else $.isFunction(e)&&(o=e(t));return o},b=function(e){var t=e.getStyle();$.isFunction(t)&&(t=t.call(e));$.isArray(t)&&(t=t[0]);return t},M=function(t,o){var r,i={};o&&(r=o._wrap?o._wrap.parent:{id:TC.wrap.Feature.prototype.getId.call({feature:o}),features:o.get("features"),getData:function(){return TC.wrap.Feature.prototype.getData.call({feature:o})}});var n,a=r&&$.isArray(r.features)&&r.features.length>1&&t.cluster;n=a?t.cluster.styles||TC.Cfg.styles.cluster:t.styles||TC.Cfg.styles;n.line&&(i.stroke=new e.style.Stroke({color:A(n.line.strokeColor,r),width:A(n.line.strokeWidth,r),lineDash:n.line.lineDash}));if(n.polygon){i.fill=new e.style.Fill({color:T(A(n.polygon.fillColor,r),A(n.polygon.fillOpacity,r))});i.stroke=new e.style.Stroke({color:A(n.polygon.strokeColor,r),width:A(n.polygon.strokeWidth,r),lineDash:n.polygon.lineDash})}var l=function(t){var o={text:""+A(t.label,r)};t.fontSize&&(o.font=A(t.fontSize,r)+"pt sans-serif");t.angle&&(o.rotation=-Math.PI*A(t.angle,r)/180);t.fontColor&&(o.fill=new e.style.Fill({color:T(A(t.fontColor,r),1)}));t.labelOutlineColor&&(o.stroke=new e.style.Stroke({color:T(A(t.labelOutlineColor,r),1),width:A(t.labelOutlineWidth,r)}));if(t.labelOffset){o.offsetX=t.labelOffset[0];o.offsetY=t.labelOffset[1]}return new e.style.Text(o)};if(n.point){var s=n.point,p={radius:A(s.radius,r)||(A(s.height,r)+A(s.width,r))/4};s.fillColor&&(p.fill=new e.style.Fill({color:T(A(s.fillColor,r),A(s.fillOpacity,r))}));s.strokeColor&&(p.stroke=new e.style.Stroke({color:A(s.strokeColor,r),width:A(s.strokeWidth,r),lineDash:s.lineDash}));isNaN(p.radius)||(i.image=new e.style.Circle(p));s.label&&(i.text=l(s))}if(n.marker){var c=n.marker;c.url&&(i.image=new e.style.Icon({crossOrigin:"anonymous",anchor:c.anchor,src:c.url}));c.label&&(i.text=l(c))}return[new e.style.Style(i)]},I=function(e){var t=e.toString(16);1===t.length&&(t="0"+t);return t},O=function(e){return"#"+I(e[0])+I(e[1])+I(e[2])},N=function(t){var o={};$.isArray(t)&&(t=t[0]);if(!$.isFunction(t)){var r=t.getStroke(),i=e.color.asArray(r.getColor());o.strokeColor=O(i);o.strokeWidth=r.getWidth();var n=t.getFill();i=e.color.asArray(n.getColor());o.fillColor=O(i);o.fillOpacity=i[3]}return o};TC.wrap.layer.Vector.prototype.getStyle=function(){return N(this.layer.getStyle())};TC.wrap.layer.Vector.prototype.reloadSource=function(){var t=this,o=new $.Deferred,r=t.createVectorSource(t.parent,t.createStyles(t.parent));if(t.parent.type===TC.Consts.layerType.WFS)var i=r.source.on("change",function(t){if("ready"==r.source.getState()){e.Observable.unByKey(i);o.resolve()}});var n=t.layer.getSource().getFeatures();t.layer.setSource(r.source);r.style&&t.layer.setStyle(r.style);if(t.parent.type!=TC.Consts.layerType.WFS){r.source.addFeatures(n);o.resolve()}return o};TC.wrap.layer.Vector.prototype["import"]=function(e){var t=this,o=$.extend({},e);o.type=e.format;var r=t.layer.getSource().getFeatures(),i=t.createVectorSource(o,t.createStyles(t.parent));t.layer.setSource(i.source);i.style&&t.layer.setStyle(i.style);i.source.addFeatures(r)};TC.wrap.layer.Vector.prototype.createVectorSource=function(t,o){var r,i,n=this,a=function(e){var t=e.indexOf("?");if(t>=0)e=e.substr(0,t);else{t=e.indexOf("#");t>=0&&(e=e.substr(0,t))}switch(e.substr(e.lastIndexOf(".")+1).toLowerCase()){case"kml":return TC.Consts.layerType.KML;case"gpx":return TC.Consts.layerType.GPX;case"json":case"geojson":return TC.Consts.layerType.GEOJSON;default:return TC.Consts.layerType.VECTOR}};if($.isArray(t.url)||t.urls){var l=t.urls||t.url;l=$.map(l,function(e,t){return TC.proxify(e)});i={url:l,format:new e.format.KML({showPointNames:!1}),projection:t.crs}}else if(t.url&&t.type!==TC.Consts.layerType.WFS){i={url:TC.proxify(t.url),projection:t.crs};i.format=S(a(t.url))||S(t.type)}else if(t.data){i={projection:t.crs,loader:function(e,o,r){var i=this.getFormat();try{var a=i.readFeatures(t.data,{featureProjection:r});this.addFeatures(a)}catch(l){n.parent.map&&n.parent.map.$events.trigger($.Event(TC.Consts.event.LAYERERROR,{layer:n.parent,reason:l.message}))}}};i.format=S(t.format)||S(t.type)}else if(t.type==TC.Consts.layerType.WFS){var s,p;switch(t.outputFormat){case TC.Consts.format.JSON:s=new e.format.GeoJSON({geometryName:t.geometryName});p="json";break;case TC.Consts.format.GML3:s=new e.format.GML3Patched;p=TC.Consts.mimeType.GML;break;default:s=new e.format.GML2;p=TC.Consts.mimeType.GML}i={format:s,loader:function(e,o,r){var i=this,a=t.url;if(a){n.parent.state=TC.Layer.state.LOADING;n.parent.map.$events.trigger($.Event(TC.Consts.event.BEFORELAYERUPDATE,{layer:n.parent}));var l={},c=r.getCode(),u=t.version||"1.1.0",g=a,d=$.isArray(t.featureType)?t.featureType:[t.featureType];if(!t.properties||t.properties instanceof Array&&!t.properties.length||!Object.keys(t.properties).length){g=g+"?service=WFS&version="+u+"&request=GetFeature&typename="+d.join(",")+"&outputFormat="+p+"&srsname="+c;e[0]!==-(1/0)&&e[1]!==-(1/0)&&e[2]!==1/0&&e[3]!==1/0&&(g=g+"&bbox="+e.join(",")+","+c);t.maxFeatures&&(g=g+"maxFeatures="+t.maxFeatures)}else{l.type="POST";l.contentType=TC.Consts.mimeType.XML;l.processData=!1;var h=[];h[h.length]='<wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" service="WFS" version="';h[h.length]=u;h[h.length]='" outputFormat="';h[h.length]=t.outputFormat;if(t.maxFeatures){h[h.length]='" maxFeatures="';h[h.length]=t.maxFeatures}h[h.length]='" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/';h[h.length]=u;h[h.length]='/wfs.xsd">';for(var f=0;f<d.length;f++){h[h.length]='<wfs:Query typeName="feature:';h[h.length]=d[f];h[h.length]='" srsName="';h[h.length]=c;h[h.length]='">';h[h.length]=t.properties.getText();h[h.length]="</wfs:Query>"}h[h.length]="</wfs:GetFeature>";l.data=h.join("")}l.url=g;n._requestUrl=g;$.ajax(l).done(function(e){i.addFeatures(s.readFeatures(e));n.parent.state=TC.Layer.state.IDLE;n.parent.map.$events.trigger($.Event(TC.Consts.event.LAYERUPDATE,{layer:n.parent,newData:e}))})}},projection:t.crs}}r=new e.source.Vector(i);r._tcLayer=n.parent;var c=t.style&&t.style.marker?t.style.marker:TC.Cfg.styles.marker;t.style&&t.style.marker||(c=$.extend({},c,{anchor:TC.Cfg.styles.point.anchor}));if(t.cluster){r=new e.source.Cluster({projection:t.crs,distance:t.cluster.distance,source:r});if(t.cluster.animation){var u=function(e,t,o,r){var i=Math.min((Date.now()-r)/o,1),n=(t[0]-e[0])*i,a=(t[1]-e[1])*i;return[e[0]+n,e[1]+a]},g=function(t,o){var r=Date.now(),i=t.getGeometry().getCoordinates(),n=o.getGeometry().getCoordinates();o.setGeometry(new e.geom.Point(i));var a=function l(){var a=u(i,n,TC.Consts.CLUSTER_ANIMATION_DURATION,r);o.setGeometry(new e.geom.Point(a));a[0]!==n[0]&&a[1]!==n[1]?requestAnimationFrame(l):d.splice($.inArray(t,d),1)};requestAnimationFrame(a)},d=[];r.addEventListener(e.source.VectorEventType.REMOVEFEATURE,function(e){var t=e.feature.get("features");t&&t.length>1&&d.push(e.feature)});r.addEventListener(e.source.VectorEventType.ADDFEATURE,function(e){var t=e.feature.get("features");if(t){var o=t[0].getGeometry().getCoordinates();if(t.length>1){var r=$.grep(d,function(e){var t=e.getGeometry().getCoordinates();return t[0]===o[0]&&t[1]===o[1]});r.length&&d.splice($.inArray(r[0],d),1)}var i=$.grep(d,function(e){var t=e.get("features");if(t&&t.length>0){var r=$.grep(t,function(e){var t=e.getGeometry().getCoordinates();return t[0]===o[0]&&t[1]===o[1]});return r.length>0}});i.length&&g(i[i.length-1],e.feature)}})}}var h=r;do{h.addEventListener(e.source.VectorEventType.ADDFEATURE,function(e){var t=e.feature,o=b(t);o&&R(o.getImage(),c.width,t)});h=$.isFunction(h.getSource)?h.getSource():null}while(h);var f=function(t){var o=null,r=b(t);if(r){var i=r.getImage();i instanceof e.style.Icon&&(o=i.getSrc())}return o};r.addEventListener(e.source.VectorEventType.ADDFEATURE,function(t){var o=t.feature;if(!o._wrap){o._wrapDeferred=$.Deferred();var r,i=o.getGeometry();i instanceof e.geom.Point?r=f(o)?n.parent.addMarker(o):n.parent.addPoint(o):i instanceof e.geom.LineString?r=n.parent.addPolyline(o):i instanceof e.geom.Polygon?r=n.parent.addPolygon(o):i instanceof e.geom.MultiLineString?r=n.parent.addMultiPolyline(o):i instanceof e.geom.MultiPolygon&&(r=n.parent.addMultiPolygon(o));var a;$.when(r).then(function(e){o._wrapDeferred.resolve(o._wrap);var t=o.get("features");$.isArray(t)&&(e.features=$.map(t,function(t){return new e.constructor(t)}));clearTimeout(a);a=setTimeout(function(){n.parent.map.$events.trigger($.Event(TC.Consts.event.FEATURESADD,{layer:n.parent,features:[e]}))},50)})}});r.addEventListener(e.source.VectorEventType.REMOVEFEATURE,function(e){var t=e.feature;if(t._wrap){var o=$.inArray(t._wrap.parent,n.parent.features);if(o>-1){n.parent.features.splice(o,1);n.parent.map.$events.trigger($.Event(TC.Consts.event.FEATUREREMOVE,{layer:n.parent,feature:t._wrap.parent}))}}});r.addEventListener(e.source.VectorEventType.ADDFEATURE,function(e){n.parent.map.$events.trigger($.Event(TC.Consts.event.VECTORUPDATE,{layer:n.parent}))});r.addEventListener(e.source.VectorEventType.REMOVEFEATURE,function(){n.parent.map.$events.trigger($.Event(TC.Consts.event.VECTORUPDATE,{layer:n.parent}))});r.addEventListener(e.source.VectorEventType.CLEAR,function(){n.parent.map.$events.trigger($.Event(TC.Consts.event.FEATURESCLEAR,{layer:n.parent}))});var y={source:r};i&&i.format instanceof e.format.KML||(y.style=o||t.styles);return y};TC.wrap.layer.Vector.prototype.createStyles=function(e){var t=this,o=!1;if($.isFunction(e)){o=!0;t.styleFunction=function(t){return M(e(t))}}else{e=$.extend({},e);e.crs=e.crs||TC.Cfg.crs;e.styles=e.styles||TC.Cfg.styles;var r=function n(e){for(var t in e){var o=e[t];switch(typeof o){case"string":if(/^\$\{(.+)\}$/.test(o))return!0;break;case"object":if(n(o))return!0;break;case"function":return!0}}return!1};o=!(!e.cluster||!e.cluster.styles)||r(e.styles);t.styleFunction=function(e){return M(t.parent.options,e)}}var i=o?t.styleFunction:t.styleFunction();return i};TC.wrap.layer.Vector.prototype.createVectorLayer=function(){var t=this,o=null;t.$events=$(t);var r=t.parent.options,i=t.createVectorSource(r,t.createStyles(r));o=new e.layer.Vector(i);o._wrap=t;t.addCommonEvents(o);return o};TC.wrap.layer.Vector.prototype.addFeatures=function(e){$.when(this.getLayer()).then(function(t){for(var o=t;$.isFunction(o.getSource);)o=o.getSource();o.addFeatures(e)})};TC.wrap.layer.Vector.prototype.getFeatures=function(){var t=this.getLayer();return t instanceof e.layer.Layer?t.getSource().getFeatures():[]};TC.wrap.layer.Vector.prototype.getFeatureById=function(t){var o=this.getLayer();return o instanceof e.layer.Layer?o.getSource().getFeatureById(t):null};TC.wrap.layer.Vector.prototype.removeFeature=function(e){$.when(this.getLayer()).then(function(t){var o=t.getSource();o.removeFeature(e.wrap.feature)})};TC.wrap.layer.Vector.prototype.clearFeatures=function(){$.when(this.getLayer()).then(function(e){var t=e.getSource();t.clearFeatures?t.clearFeatures():t.clear()})};TC.wrap.layer.Vector.prototype.setFeatureVisibility=function(t,o){var r=this,i={color:"rgba(0, 0, 0, 0)"},n={color:"rgba(0, 0, 0, 0)"},a=new e.style.Style({image:new e.style.Circle({radius:0,fill:new e.style.Fill(i),stroke:new e.style.Stroke(n)}),fill:new e.style.Fill(i),stroke:new e.style.Stroke(n)}),l=$.inArray(t,r.parent.features);if(l>=0){var s=t.wrap.feature;if(o&&s._originalStyle)s.setStyle(s._originalStyle);else{s._originalStyle=s.getStyle();s.setStyle(a)}$.when(r.getLayer()).then(function(e){r.parent.map.$events.trigger($.Event(TC.Consts.event.VECTORUPDATE,{layer:r.parent}))})}};TC.wrap.layer.Vector.prototype.getRGBA=function(e,t){return T(e,t)};TC.wrap.layer.Vector.prototype.findFeature=function(e){};TC.wrap.layer.Vector.prototype.getGetFeatureUrl=function(){return this._requestUrl};TC.wrap.layer.Vector.prototype.getDescribeFeatureTypeUrl=function(){var e=this,t=e.parent,o=t.options.version||"1.1.0",r=t.url,i=$.isArray(t.options.featureType)?t.options.featureType:[t.options.featureType];r=r+"?service=WFS&version="+o+"&request=DescribeFeatureType&typename="+i.join(",")+"&outputFormat=XMLSCHEMA";return r};TC.wrap.layer.Vector.prototype.sendTransaction=function(t,o,r){var i=this,n=$.Deferred(),a=function(e){return e.wrap.feature},l=$.map(t,a),s=$.map(o,a),p=$.map(r,a);t.length||o.length||r.length?$.when(i.getLayer()).then(function(t){var o=(t.getSource(),new e.format.WFS),r=i.parent.options,a=o.writeTransaction(l,s,p,{featurePrefix:r.featurePrefix,featureNS:r.featureNS,featureType:r.featureType[0]}),c={url:i.parent.url,type:"POST",contentType:TC.Consts.mimeType.XML,processData:!1,data:a.outerHTML};$.ajax(c).done(function(e){var t=e.getElementsByTagName("ExceptionReport")[0],r={reason:""};if(t){var i=t.getElementsByTagName("Exception")[0];if(i){r.code=i.getAttribute("exceptionCode");for(var a=i.getElementsByTagName("ExceptionText"),l=0,s=a.length;s>l;l++)r.reason+="\n"+a[l].innerHTML}n.reject(r)}else{var p=o.readTransactionResponse(e);n.resolve(p)}}).fail(function(){n.reject({code:"",reason:"unknown"})})}):n.resolve(i.parent);return n};TC.wrap.layer.Vector.prototype.setDraggable=function(t,o,r){var i=this;$.when(i.parent.map.wrap.getMap(),i.getLayer()).then(function(n,a){if(t){var l={layers:[a],features:new e.Collection(a.getSource().getFeatures())};i.interaction=new e.interaction.Translate(l);$.isFunction(o)&&i.interaction.on(e.interaction.TranslateEventType.TRANSLATEEND,function(e){e.features.getLength()&&o(e.features.item(0)._wrap.parent)});$.isFunction(r)&&i.interaction.on(e.interaction.TranslateEventType.TRANSLATESTART,function(e){e.features.getLength()&&r(e.features.item(0)._wrap.parent)});n.addInteraction(i.interaction)}else i.interaction&&n.removeInteraction(i.interaction)})};TC.wrap.control.Click.prototype.register=function(e){var t=this;t._trigger=function(o){var r=0;e.wrap.map.forEachFeatureAtPixel(o.pixel,function(e,t){e._wrap&&e._wrap.parent.showsPopup&&r++});if(!r){t.parent.map.$events.trigger($.Event(TC.Consts.event.CLICK,{coordinate:o.coordinate,pixel:o.pixel}));t.parent.callback(o.coordinate,o.pixel)}return 0===r}};TC.wrap.control.Click.prototype.activate=function(){var t=this;$.when(t.parent.map.wrap.getMap()).then(function(o){o.on(e.MapBrowserEventType.SINGLECLICK,t._trigger)})};TC.wrap.control.Click.prototype.deactivate=function(){var t=this;$.when(t.parent.map.wrap.getMap()).then(function(o){o.un(e.MapBrowserEventType.SINGLECLICK,t._trigger)})};TC.wrap.control.ScaleBar.prototype.render=function(){var t=this;t.ctl?t.ctl.updateElement_():t.ctl=new e.control.ScaleLine({target:t.parent.div})};TC.wrap.control.ScaleBar.prototype.getText=function(){var e=this;return e.ctl?e.ctl.renderedHTML_:void 0};TC.wrap.control.NavBar.prototype.register=function(t){var o=this;$.when(t.wrap.getMap()).then(function(r){var i=o.parent.div;o.zCtl=new e.control.Zoom({target:i});o.zsCtl=new e.control.ZoomSlider({target:i,render:function(t){if(!t.frameState||!t.frameState.viewState||r.getView().getMinResolution()<=t.frameState.viewState.resolution){var i=function(){if(this.element.offsetWidth>this.element.offsetHeight){o.requestSliderSize||(o.requestSliderSize=window.requestAnimationFrame(i.bind(this)));window.requestAnimationFrame(i.bind(this))}else if(this.element.offsetWidth<this.element.offsetHeight){
if(o.requestSliderSize){window.cancelAnimationFrame(o.requestSliderSize);delete o.requestSliderSize}e.control.ZoomSlider.render.call(this,t)}};i.call(this)}}});o.z2eCtl=new e.control.ZoomToExtent({target:i,extent:t.options.initialExtent,tipLabel:""});r.addControl(o.zCtl);r.addControl(o.zsCtl);r.addControl(o.z2eCtl);var n=o.parent._$div;$buttons=n.find("button").addClass("tc-ctl-btn "+o.parent.CLASS+"-btn").css("display","block").html("");$buttons.filter(".ol-zoom-in").addClass(o.parent.CLASS+"-btn-zoomin").attr("title",o.parent.getLocaleString("zoomIn"));$buttons.filter(".ol-zoom-out").addClass(o.parent.CLASS+"-btn-zoomout").attr("title",o.parent.getLocaleString("zoomOut"));n.find(".ol-zoom-extent button").addClass(o.parent.CLASS+"-btn-home").attr("title",o.parent.getLocaleString("zoomToInitialExtent"));$(t.div).find(".ol-zoomslider").addClass(o.parent.CLASS+"-bar").find(".ol-zoomslider-thumb").addClass(o.parent.CLASS+"-slider");t.on(TC.Consts.event.BASELAYERCHANGE,$.proxy(o.refresh,o))})};TC.wrap.control.NavBar.prototype.refresh=function(){var t=this,o=t.parent.map.wrap.map;if(t.zsCtl.sliderInitialized_){var r=o.getView().getResolution();t.zsCtl.setThumbPosition_(r)}else o.once(e.MapEventType.POSTRENDER,function(e){t.zsCtl.render(e)})};TC.wrap.control.Coordinates.prototype.register=function(t){var o=this,r=new $.Deferred;o.map=t;o._cleanCoordsTrigger=function(e){var t=o.map.getControlsByClass(TC.control.Popup)[0];e.toElement&&$(e.toElement).attr("class")&&t&&$(e.toElement).attr("class").indexOf(t.CLASS)>-1?o.parent.coordsToClick({coordinate:[(o.map.getExtent()[0]+o.map.getExtent()[2])/2,(o.map.getExtent()[1]+o.map.getExtent()[3])/2]}):o.parent.cleanCoordsPointer(e)};o._coordsTrigger=function(e){o.parent.coordsToClick(e)};$.when(t.wrap.getMap()).then(function(t){o.olMap=t;var a=t.getView().getProjection();o.parent.crs=a.getCode();o.parent.units=a.getUnits();o.parent.isGeo=o.parent.units===e.proj.Units.DEGREES;var l=t.getViewport();$(l).add(o.parent.div).on(i+".coords",function(e){var r=t.getEventCoordinate(e);if(r){o.parent.isGeo?o.parent.latLon=r.reverse():o.parent.xy=r;o.parent.update.apply(o.parent,arguments)}}).on(n,function(e){o.parent.clear.apply(o.parent,arguments)});r.resolve()});return r};TC.wrap.control.Geolocation.prototype.register=function(e){var t=this;t.map=e;t._snapTrigger=function(e){e.dragging||t.initSnap(t.olMap.getEventCoordinate(e.originalEvent))};t._postcomposeTrigger=function(e){t.duringTrackSnap(e)};$.when(e.wrap.getMap()).then(function(e){t.olMap=e})};TC.wrap.control.Geolocation.prototype.hasCoordinates=function(){var e=this;return e.trackData&&e.trackData.trackFeature&&e.trackData.trackFeature.getGeometry().getCoordinates().length>=1};var D=function(e,t){var o=t-e,r={s:Math.floor(o/1e3%60),m:Math.floor(o/6e4%60),h:Math.floor(o/36e5%24)};return $.extend({},r,{toString:("00000"+r.h).slice(-2)+":"+("00000"+r.m).slice(-2)+":"+("00000"+r.s).slice(-2)})};TC.wrap.control.Geolocation.prototype.getTooltip=function(t){var o=this;o.parent.elevationMarker||(o.parent.elevationMarker=new e.Overlay({element:o.parent.track.htmlElevationMarker,offset:[0,-11],positioning:e.OverlayPositioning.CENTER_CENTER,stopEvent:!1}));if(o.parent.layerTrack.getVisibility()&&o.parent.layerTrack.getOpacity()>0){$(o.parent.track.htmlElevationMarker).show();o.olMap.addOverlay(o.parent.elevationMarker);o.parent.elevationMarker.setPosition(o.parent.chart.coordinates[t[0].index])}var r=o.map.getExtent(),i=o.parent.chart.coordinates[t[0].index];r[0]<=i[0]&&i[0]<=r[2]&&r[1]<=i[1]&&i[1]<=r[3]||TC.loadJS(!TC.feature||TC.feature&&!TC.feature.Point,[TC.apiLocation+"TC/feature/Point"],function(){o.map.setCenter(i.slice(0,2),{animate:!0})});var n=t[0].x;n/=1e3;var a;4==o.parent.chart.coordinates[0].length&&o.parent.chart.coordinates[0][3]>0&&(a=D(o.parent.chart.coordinates[0][3],i[3]));var l,s,p=o.parent.map.options.locale&&o.parent.map.options.locale.replace("_","-")||void 0,c=parseInt(t[0].value.toFixed(0)).toLocaleString(p);if(1>n){l=Math.round(1e3*n);s=" m"}else{l=Math.round(100*n)/100;s=" km"}l=l.toLocaleString(p);return'<div class="track-elevation-tooltip"><div><span>'+c+" m </span><br><span>"+l+s+" </span></div>"+(a?"<span>"+a.toString+"</span><div/>":"")};TC.wrap.control.Geolocation.prototype.addWaypoint=function(t,o){var r=this,i=new e.Feature({geometry:new e.geom.Point([t[0],t[1],o.ele,o.time],"XYZM")});i.setProperties(o);r.parent.layerTracking.wrap.layer.getSource().addFeature(i)};var F=!0,k=function(t,o){var r=t.getGeometry(),i=r.getType().toLowerCase(),n=!F,a=[];a.push(new e.style.Style({stroke:new e.style.Stroke({width:2,color:"rgba(0,206,209, "+(n&&t.get("tracking")?0:1)+")",lineDash:[.1,6]})}));"point"!=i||n||a.push(new e.style.Style({image:new e.style.Circle({radius:3,fill:new e.style.Fill({color:"rgba(0,206,209, "+(n&&t.get("tracking")?0:.5)+")"}),stroke:new e.style.Stroke({color:"rgba(255, 255, 255, "+(n&&t.get("tracking")?0:1)+")",width:1})}),text:new e.style.Text({textAlign:"center",textBaseline:"middle",font:"bold 14px Arial",text:n&&t.get("tracking")?"":t.get("name"),fill:new e.style.Fill({color:"rgba(0,206,209, "+(n&&t.get("tracking")?0:1)+")"}),stroke:new e.style.Stroke({color:"rgba(255, 255, 255, "+(n&&t.get("tracking")?0:1)+")",width:parseInt(3,10)}),offsetX:parseInt(0,10),offsetY:parseInt(0,10)})}));return a};TC.wrap.control.Geolocation.prototype.setTrackOnMapVisibility=function(e){var t=this;F=e;t.parent.layerTracking.wrap.layer.setStyle(k)};TC.wrap.control.Geolocation.prototype.addPosition=function(e,t,o,r,i,n,a){var l=this,s=Math.round(e[0]),p=Math.round(e[1]);if(l.trackData&&l.trackData.trackFeature){var c=l.trackData.trackFeature.getGeometry().getLastCoordinate();if(c&&0==c.length)l.trackData.trackFeature.getGeometry().appendCoordinate([s,p,t,o]);else{var u=Math.round(c[0]),g=Math.round(c[1]);(s!=u||p!=g)&&l.trackData.trackFeature.getGeometry().appendCoordinate([s,p,t,o])}}l.parent.$events.trigger($.Event(l.parent.Const.Event.STATEUPDATED,{moving:void 0!=t&&void 0!=r&&r>0&&t>0}))};TC.wrap.control.Geolocation.prototype.positionChangehandler=function(e){var t,o,r,i,n,a=this,l=$.Deferred();if(e&&e.coords){a.parent.layerGPS.clearFeatures();t=e.coords.accuracy||0;o=e.coords.heading||e[2]||0;r=e.coords.speed?3.6*e.coords.speed:0;i=e.coords.altitude||0;n=e.coords.altitudeAccuracy||0;if(a.trackData&&a.trackData.trackFeature){var s=[e.coords&&e.coords.longitude||e[0],e.coords&&e.coords.latitude||e[1]],p=TC.Util.reproject(s,"EPSG:4326",a.parent.map.crs);a.addPosition(p,o,(new Date).getTime(),r,t,n,i);var c=a.trackData.trackFeature.getGeometry().getCoordinates(),u=c.length;u>=2&&(a.parent.deltaMean=(c[u-1][3]-c[0][3])/(u-1));a.parent.$events.trigger($.Event(a.parent.Const.Event.POSITIONCHANGE,{pd:{position:[p[0],p[1]],altitude:i,accuracy:t,heading:TC.Util.radToDeg(o),speed:r}}));$.when(a.parent.layerGPS.addPoint(p,{radius:4,fillColor:"#00CED1",fillOpacity:1,strokeColor:"#ffffff",strokeWidth:2,showsPopup:!1}),a.parent.layerGPS.addCircle([p,t],{strokeColor:"#00CED1",strokeWidth:.4,fillColor:"#ffffff",fillOpacity:.2,showsPopup:!1})).done(function(e,t){a.parent.geopositionTracking=!0;if(0==a.parent.firstPosition){a.parent.firstPosition=!0;if(a.parent.$centerDiv)a.parent.$centerDiv.toggleClass(TC.Consts.classes.HIDDEN,!1);else{a.parent.$centerDiv=a.parent._$div.find("."+a.parent.CLASS+"-track-center");a.parent.$button=a.parent._$div.find("."+a.parent.CLASS+"-track-center button");a.parent.$button.on("click",function(){a.parent.layerGPS.map.zoomToFeatures(a.parent.layerGPS.features);a.parent.track.$info.find(".prsidebar-body").fadeIn("slide");a.parent.track.$info.find(".prcollapsed").hide()});a.parent.$centerDiv.appendTo(a.parent.map._$div);a.parent.$centerDiv.toggleClass(TC.Consts.classes.HIDDEN,!1)}a.parent.layerGPS.map.zoomToFeatures(a.parent.layerGPS.features)}l.resolve({marker:e,accuracy:t})})}else l.resolve(null)}else l.resolve(null);return l.promise()};TC.wrap.control.Geolocation.prototype.setTracking=function(t){function o(){var e=p++;navigator.geolocation.getCurrentPosition(function(e){clearInterval(s);r.parent.getLoadingIndicator().removeWait(r.parent.currentPositionWaiting);r.positionChangehandler(e).then(function(e){1==r.parent.geopositionTracking&&e&&e.marker&&e.accuracy&&(r.currentPositionTrk=navigator.geolocation.watchPosition(r.positionChangehandler.bind(r),r.parent.onGeolocateError.bind(r.parent),c))})},function(e){switch(e.code){case e.TIMEOUT:o();break;default:clearInterval(s);r.parent.onGeolocateError.call(r.parent,e)}},{timeout:5e3+e,maximumAge:10,enableHighAccuracy:!0})}var r=this;if(t){r.parent.firstPosition=!1;r.trackData={};var i=[];if(r.parent.sessionTracking)for(var n=(new e.format.GeoJSON).readFeatures(r.parent.sessionTracking),a=0;a<n.length;a++){var l=n[a].getGeometry().getType().toLowerCase();if("point"==l)i.push(n[a]);else if("linestring"==l){r.trackData.trackFeature=n[a];r.trackData.trackFeature.setProperties({tracking:!0})}}else r.trackData.trackFeature=new e.Feature({geometry:new e.geom.LineString([],"XYZM"),tracking:!0});r.parent.layerTracking.wrap.layer.setSource(new e.source.Vector({features:[r.trackData.trackFeature]}));i.length>0&&r.parent.layerTracking.wrap.addFeatures(i);r.parent.layerTracking.wrap.layer.setStyle(k);r.trackData.trackFeature.getGeometry().getCoordinates().length>1&&r.parent.map.setExtent(r.parent.layerTracking.wrap.layer.getSource().getExtent());r.parent.currentPositionWaiting=r.parent.getLoadingIndicator().addWait();var s,p=0,c={enableHighAccuracy:!0,timeout:6e5};s=setInterval(o,1e3);setTimeout(function(){if(r.trackData&&0==r.trackData.trackFeature.getGeometry().getLastCoordinate().length){clearInterval(s);r.parent.getLoadingIndicator().removeWait(r.parent.currentPositionWaiting);r.map.toast(r.parent.getLocaleString("geo.error.permission_denied"),{type:TC.Consts.msgType.WARNING});r.parent.track.$activateButton.toggleClass(TC.Consts.classes.HIDDEN,!1);r.parent.track.$deactivateButton.toggleClass(TC.Consts.classes.HIDDEN,!0)}},c.timeout+1e3)}else{F=!0;r.parent.firstPosition=!1;window.navigator.geolocation.clearWatch(r.currentPositionTrk);delete r.trackData;r.parent.$centerDiv&&r.parent.$centerDiv.toggleClass(TC.Consts.classes.HIDDEN,!0)}};TC.wrap.control.Geolocation.prototype.activateSnapping=function(){var t=this;F=!0;if(!TC.Util.detectMobile()){t.olMap.on([e.MapBrowserEventType.POINTERMOVE,e.MapBrowserEventType.SINGLECLICK],t._snapTrigger);t.olMap.on(e.render.EventType.POSTCOMPOSE,t._postcomposeTrigger)}};TC.wrap.control.Geolocation.prototype.deactivateSnapping=function(){var t=this;$.when(t.parent.map.wrap.getMap()).then(function(o){if(!TC.Util.detectMobile()){o.un([e.MapBrowserEventType.POINTERMOVE,e.MapBrowserEventType.SINGLECLICK],t._snapTrigger);o.un(e.render.EventType.POSTCOMPOSE,t._postcomposeTrigger)}t.snapInfo&&o.removeOverlay(t.snapInfo);t.snapInfoElement&&(t.snapInfoElement.style.display="none");if(t.snapLine){delete t.snapLine;o.render()}})};TC.wrap.control.Geolocation.prototype.clear=function(t){var o=this;if(t&&t.wrap.layer){t.wrap.layer.getSource().clear();t.wrap.layer.setSource(new e.source.Vector)}attachedDTD=!1;o.deactivateSnapping.call(o)};var G;TC.wrap.control.Geolocation.prototype.duringTrackSnap=function(t){var o=this,r=G=t.vectorContext;if(r&&o.snapLine){"function"==typeof r.setFillStrokeStyle&&r.setFillStrokeStyle(null,new e.style.Stroke({color:"rgba(197, 39, 55, 1)",width:1}));"function"==typeof r.drawGeometry&&r.drawGeometry(o.snapLine.wrap.feature.getGeometry())}};TC.wrap.control.Geolocation.prototype.initSnap=function(t){var o=this;if(o.parent.layerTrack){var r=o.parent.layerTrack.wrap.layer.getSource(),i=r.getClosestFeatureToCoordinate(t);if(null!==i){var n=i.getGeometry(),a=n.getClosestPoint(t),l=[t,[a[0],a[1]]];o.snapLine?o.snapLine.wrap.feature.getGeometry().setCoordinates(l):o.snapLine=new TC.feature.Polyline(l);o.snapInfoElement||(o.snapInfoElement=document.getElementsByClassName("tc-ctl-geolocation-track-snap-info")[0]);o.snapInfoElement.style.display="block";if(!o.snapInfo){o.snapInfo=new e.Overlay({element:o.snapInfoElement,offset:[5,18]});o.olMap.addOverlay(o.snapInfo)}void 0==o.snapInfo.getMap()&&o.snapInfo.setMap(o.olMap);o.snapInfo.setPosition(t);var s={};"LineString"!=i.getGeometry().getType()&&i.getKeys().indexOf("name")>-1&&(s.n=i.get("name"));var p=o.parent.map.options.locale&&o.parent.map.options.locale.replace("_","-")||void 0;s.x=Math.round(a[0]).toLocaleString(p);s.y=Math.round(a[1]).toLocaleString(p);s.z=a.length>=3?(Math.round(100*a[2])/100).toLocaleString(p):void 0;s.m=4==a.length&&a[3]>0?new Date(a[3]).toLocaleString(p):void 0;s&&o.parent.getRenderedHtml(o.parent.CLASS+"-track-snapping-node",s,function(e){o.snapInfoElement.innerHTML=e})}o.olMap.render()}};TC.wrap.control.Geolocation.prototype.drawTrackingData=function(e){var t=this,o=$.Deferred(),r=[],i=new TC.wrap.parser.JSON,n=i.parser.readFeatures(e);t.activateSnapping.call(t);for(var a=0,l=n.length;l>a;a++)r.push(TC.wrap.Feature.createFeature(n[a]));$.when.apply($,r).then(function(){for(var e=0;e<arguments.length;e++){var r=arguments[e];r&&t.parent.layerTrack.addFeature(r)}t.parent.map.zoomToFeatures(t.parent.layerTrack.features);o.resolve()});return o.promise()};TC.wrap.control.Geolocation.prototype.formattedToStorage=function(e,t){var o=new TC.wrap.parser.JSON;o=o.parser;var r=e.wrap.layer.getSource().getFeatures();if(t)for(var i=0;i<r.length;i++)r[i].get("tracking")&&r[i].set("tracking",!1);return o.writeFeatures(r)};TC.wrap.control.Geolocation.prototype["export"]=function(t,o){var r=this,i=new $.Deferred,n=[];r.parent.getTrackingData(o).then(function(a){if(a){var l=new e.source.Vector({features:(new e.format.GeoJSON).readFeatures(a)});if(l.getFeatures().length>0)l.forEachFeature(function(t){var o=t.clone();o.getGeometry().transform(r.parent.map.crs,"EPSG:4326");if("linestring"==o.getGeometry().getType().toLowerCase()){var i=new e.geom.MultiLineString([],o.getGeometry().getLayout());i.appendLineString(o.getGeometry());n.push(new e.Feature({geometry:i}))}else n.push(o)});else{var s=r.parent.getTrackingData(o),p=new e.source.Vector({features:(new e.format.GeoJSON).readFeatures(s)});p.forEachFeature(function(t){var o=t.clone();o.getGeometry().transform(r.parent.map.crs,"EPSG:4326");if("linestring"==o.getGeometry().getType().toLowerCase()){var i=new e.geom.MultiLineString([],o.getGeometry().getLayout());i.appendLineString(o.getGeometry());n.push(new e.Feature({geometry:i}))}else n.push(o)})}}switch(t){case"GPX":i.resolve(n?(new e.format.GPX).writeFeatures(n):null);break;case"KML":i.resolve(n?(new e.format.KML).writeFeatures(n):null)}});return i};var U=function(e){var t=[],o=[];if(e.length>1){4==e[0].length&&(e=e.sort(function(e,t){return e[0][3]==t[0][3]?0:e[0][3]<t[0][3]?-1:1}));for(var r=0;r<e.length;r++){for(var i=e[r],n=-1,a=1/0,l=i.getLastCoordinate(),s=r+1;s<e.length;s++){var p=e[s].getFirstCoordinate(),c=Math.hypot(l[0]-p[0],l[1]-p[1]);if(a>c){n=s;a=c}}if(t.length<e.length){if(-1==t.indexOf(r)){t.push(r);o=o.concat(i.getCoordinates())}if(-1==t.indexOf(n)){t.push(n);o=o.concat(e[n].getCoordinates())}}}return o}return e[0].getCoordinates()};TC.wrap.control.Geolocation.prototype.processImportedFeatures=function(t){for(var o=this,r=o.parent.layerTrack.wrap.layer.getSource(),i=o.parent.importedFileName,n=[],a=[],l=[],s=[],p=r.getFeatures(),c=[],u=[],g=0;g<p.length;g++){var d=p[g];d instanceof TC.Feature&&(d=p[g].wrap.feature);if(d.getGeometry()instanceof e.geom.Point){u.push(d.getGeometry().getCoordinates());s.push(d)}else if(d.getGeometry()instanceof e.geom.LineString){c.push(d.getGeometry());l.push(d)}else if(d.getGeometry()instanceof e.geom.MultiLineString){var h=d.clone();n.push(h.getProperties().hasOwnProperty("name")?h.getProperties().name.trim().length>0?h.getProperties().name:i:i);var f=h.getGeometry().getLineStrings(),y=U(f);a.push(new e.Feature({geometry:new e.geom.LineString(y)}));l.push(d)}}if(c.length>0){var y=U(c);a.push(new e.Feature({geometry:new e.geom.LineString(y)}))}u.length>0&&s.length==p.length&&a.push(new e.Feature({geometry:new e.geom.LineString(u)}));if(l.length>0)for(var m=0;m<l.length;m++)r.removeFeature(l[m]);if(a.length>0){var v,C=function(e,t){for(var o=[],r=e.indexOf(t);-1!=r;){o.push(r);r=e.indexOf(t,r+1);if(o.length>1)return!0}return o.length>1?!0:!1},T=(new $.Deferred,0),_=function(){var e=[];$.each(a,function(t){var l=new $.Deferred;v&&r.removeFeature(v);var s;if(n.length>t){var s=n[t];C(n,s)&&(s="["+(t+1)+"] "+s)}o.parent.importedFileName=s?s:i;v=a[t];r.addFeature(v);o.parent.saveTrack(o.parent.getLocaleString("geo.trk.upload.ok",{trackName:o.parent.importedFileName})).then(function(e){0==t&&(T=e);l.resolve()});e.push(l)});return $.when.apply(void 0,e).promise()};_().then(function(){o.parent.$events.trigger(o.parent.Const.Event.IMPORTEDTRACK,T);delete o.parent.importedFileName;var e=o.parent.layerTrack.features;if(e&&e.length>0)for(var i=0;i<e.length;i++)e[i].showsPopup=!1;o.parent.map.setExtent(r.getExtent());o.parent.getLoadingIndicator().removeWait(t)})}else{if(o.parent.layerTrack){o.parent.map.removeLayer(o.parent.layerTrack);o.parent.layerTrack=void 0}delete o.parent.importedFileName;o.parent.getLoadingIndicator().removeWait(t);TC.alert(o.parent.getLocaleString("geo.trk.upload.error4"))}};TC.wrap.control.Geolocation.prototype["import"]=function(t,o,r){var i,n,a=this;if(o&&o.text){var l=a.parent.layerTrack.wrap.createVectorSource({data:o.text,type:r});i=l.source;n=i.on("change",function(o){if("ready"==i.getState()){e.Observable.unByKey(n);a.processImportedFeatures(t)}});var s=a.parent.layerTrack.wrap.layer;s.setSource(i)}else{if(a.parent.layerTrack){a.parent.map.removeLayer(a.parent.layerTrack);a.parent.layerTrack=void 0}delete a.parent.importedFileName;a.parent.getLoadingIndicator().removeWait(t);TC.alert(a.parent.getLocaleString("geo.trk.upload.error4"))}};var B;TC.wrap.control.Geolocation.prototype.simulateTrackEnd=function(){var e=this;$(e.miProgressTextDiv).remove();$(e.miProgressDiv).remove();$(e.miDiv).remove();if(e.simulateMarker){window.cancelAnimationFrame(B);e.simulateMarker.layer.wrap.layer.getSource().getFeatures().length>0&&e.simulateMarker.layer.removeFeature(e.simulateMarker);delete e.simulateMarker}};TC.wrap.control.Geolocation.prototype.simulateTrack=function(){for(var t,o=this,r=o.parent.layerTrack.wrap.layer.getSource().getFeatures(),i=0;i<r.length;i++)if(r[i].getGeometry()instanceof e.geom.LineString){t=r[i].getGeometry().getCoordinates();break}if(t&&t.length>0){var n=t[0],a=function(){var e=new $.Deferred;if(o.simulateMarker){o.simulateMarker.setCoords(n.slice(0,2));e.resolve(o.simulateMarker)}else o.parent.layerTrack.addPoint(n.slice(0,2),{radius:7,fillColor:"#ff0000",strokeColor:"#ffffff",strokeWidth:2}).then(function(t){e.resolve(t)});return e};a().then(function(r){o.simulateMarker=r;var i=function(){var r,i,n,a=(t.length,!1);if(o.parent.hasElevation){var l=d3.select(".c3-event-rects,.c3-event-rects-single").node().getBoundingClientRect();$("body").append('<div class="miDiv">');o.miDiv=$("div.miDiv");o.miDiv.width(l.width);o.miDiv.height(l.height);o.miDiv.append('<div class="miProgressDiv">');o.miProgressDiv=$("div.miProgressDiv");o.miProgressDiv.addClass("tc-ctl-geolocation-track-elevation-chart-progress");o.miProgressDiv.width("0%");o.miProgressDiv.height(l.height);o.miProgressDiv.append('<div class="miProgressTextDiv">');o.miProgressTextDiv=$("div.miProgressTextDiv");o.miProgressTextDiv.addClass("tc-ctl-geolocation-track-elevation-chart-progress text");o.miProgressTextDiv.width(l.width);o.miProgressTextDiv.height(l.height);o.miDiv.css({top:l.top,left:l.left,bottom:l.bottom,right:l.right,position:"absolute","z-index":1e4})}var s=t;if(4==s[0].length&&s[0][3]>0){r=s[0][3];i=s[s.length-1][3];a=!0}else{s[0][3]=Date.now();for(var p=1;p<s.length;p++){var c;s[p][3]=0;c=p+1<s.length?new e.geom.LineString(s.slice(p-1,p+1)).getLength():new e.geom.LineString(s.slice(p-1)).getLength();s[p][3]=s[p-1][3]+36e5*c/o.parent.walkingSpeed}r=s[0][3];i=s[s.length-1][3]}var u=new e.geom.LineString(s),g=r,d=u.getLength(),c=0,h=function(t){for(var o=0;o<s.length;o++)if(s[o][3]>t)return{d:new e.geom.LineString(s.slice(0,o)).getLength(),p:s[o-1].slice(0,2)}},f=function(){if(!o.parent.simulate_paused){var e=u.getCoordinateAtM(g),t=h(g);if(n>=1||!e||!t){o.simulateTrackEnd();var r=o.parent.getSelectedTrack();r&&o.parent.uiSimulate(!1,r);$(o.miProgressTextDiv).remove();$(o.miProgressDiv).remove();$(o.miDiv).remove();return}if(o.parent.hasElevation){c=t.d;var i=(c+Math.hypot(t.p[0]-e[0],t.p[1]-e[1]))/d*100;o.miProgressDiv.width(i+"%");var l;a&&(l=D(s[0][3],e[3]));var p,y,m=o.parent.map.options.locale&&o.parent.map.options.locale.replace("_","-")||void 0,v=parseInt(e[2].toFixed(0)).toLocaleString(m);if(1>c/1e3){p=Math.round(c/1e3*1e3);y=" m"}else{p=Math.round(c/1e3*100)/100;y=" km"}p=p.toLocaleString(m);o.miProgressTextDiv.html("<div><span>"+v+" m</span><br><span>"+p+y+"</span></div>"+(a?"<br><span>"+l.toString+"</span>":""))}if(o.simulateMarker){{var C=o.simulateMarker.getCoords(),T=e;180*Math.atan2(T[1]-C[1],T[0]-C[0])/Math.PI}o.simulateMarker.setCoords(e)}g+=1!==o.parent.simulate_speed?o.parent.delta*o.parent.simulate_speed:o.parent.delta}B=requestAnimationFrame(f)};B=requestAnimationFrame(f)},n=new $.Deferred;window.d3?n.resolve():TC.loadJS(!window.d3,[TC.Consts.url.D3C3],function(){n.resolve()});n.then(function(){B=requestAnimationFrame(i)})})}};TC.wrap.control.Geolocation.prototype.headingChangehandler=function(e){var t=this;t.parent.track.$infoOnMap||(t.parent.track.$infoOnMap=$('<div style="overflow-y: scroll; height: 200px; width: 200px; top: 0; left: 100px; background-color: fuchsia; position: absolute;"></div>').appendTo(t.parent.map._$div));t.parent.track.$infoOnMap.show();t.parent.track.$infoOnMap.html(t.parent.track.$infoOnMap.html()+"<br> <p> salta headingChangehandler </p>");t.parent.track.$infoOnMap.html(t.parent.track.$infoOnMap.html()+"<br> <p> evt.target.getHeading(): "+e.target.getHeading()+" </p>");t.heading=e.target.getHeading();$.when(t.map.wrap.getMap()).then(function(e){e.getView().setRotation(-t.heading)});t.parent.$events.trigger($.Event(t.parent.Const.Event.STATEUPDATED,{moving:void 0!=heading&&heading>0}))};TC.wrap.control.Geolocation.prototype.orientationChangehandler=function(e){var t=this,o=t.map.wrap.map.getView(),r=o.getCenter(),i=o.getResolution(),n=e.target.getBeta()||0,a=e.target.getGamma()||0;r[0]-=i*a*25;r[1]+=i*n*25;o.setCenter(o.constrainCenter(r));t.parent.$events.trigger($.Event(t.parent.Const.Event.STATEUPDATED,{moving:void 0!=heading&&heading>0}))};TC.wrap.control.Geolocation.prototype.pulsate=function(t){var o=this;o.pulsated=!0;var r,i=t.wrap.feature.getGeometry().getRadius(),n=(new Date).getTime(),a=500,l=function(e){switch(!0){case 50>=e:return i;case e>50&&100>=e:return 1.02*i;case e>100&&150>=e:return 1.05*i;case e>150&&200>=e:return 1.02*i;case e>200&&300>=e:return i;case e>300&&350>=e:return 1.02*i;case e>350&&400>=e:return 1.05*i;case e>400&&450>=e:return 1.02*i;case e>450&&500>=e:return 1*i;default:return i}};r=o.olMap.on(e.render.EventType.POSTCOMPOSE,function(o){var i=o.vectorContext,s=o.frameState,p=s.time-n,c=t.wrap.feature.getGeometry().clone(),u=l(p);c.setRadius(u);i.setFillStrokeStyle(new e.style.Fill({color:"rgba(0, 0, 0, 0.1)"}),new e.style.Stroke({color:"rgba(255, 0, 0, .8)",width:1}));i.drawCircleGeometry(c);p>a?e.Observable.unByKey(r):s.animate=!0})};TC.wrap.control.Coordinates.prototype.coordsActivate=function(){var t=this;t.olMap.on(e.MapBrowserEventType.SINGLECLICK,t._coordsTrigger);var o=t.olMap.getViewport();$(o).on(n,t._cleanCoordsTrigger)};TC.wrap.control.Coordinates.prototype.coordsDeactivate=function(){var t=this;t.olMap.un(e.MapBrowserEventType.SINGLECLICK,t._coordsTrigger);var o=t.olMap.getViewport();$(o).off(n,t._cleanCoordsTrigger)};TC.wrap.Parser=function(){};TC.wrap.Parser.prototype.read=function(e){var t=[],o=this;if(o.parser){TC.Feature||TC.syncLoadJS(TC.apiLocation+"TC/Feature");t=$.map(o.parser.readFeatures(e),function(e){return new TC.Feature(null,{id:e.getId(),data:e.getProperties()})})}return t};TC.wrap.parser={WFS:function(t){this.parser=new e.format.WFS(t)},JSON:function(t){this.parser=new e.format.GeoJSON(t)}};TC.inherit(TC.wrap.parser.WFS,TC.wrap.Parser);TC.inherit(TC.wrap.parser.JSON,TC.wrap.Parser);TC.wrap.control.OverviewMap.prototype.register=function(t){var o=this;$.when(o.parent.layer.wrap.getLayer()).then(function(r){o.ovMap=new e.control.OverviewMap({target:o.parent.div,collapsed:!1,collapsible:!1,className:o.parent.CLASS+" ol-overviewmap",layers:[r]});o.ovMap._wrap=o;o.ovMap.ovmap_.removeOverlay(o.ovMap.boxOverlay_);var i=document.createElement("DIV");i.className="ol-overviewmap-box";i.style.boxSizing="border-box";o.ovMap.boxOverlay_=new e.Overlay({position:[0,0],positioning:e.OverlayPositioning.BOTTOM_LEFT,element:i});o.ovMap.ovmap_.addOverlay(o.ovMap.boxOverlay_);o._$boxElm=$(o.ovMap.boxOverlay_.getElement()).parents(".ol-overlay-container").first();TC.loadJS(!$.fn.drag,[TC.apiLocation+"lib/jquery/jquery.event.drag.js",TC.apiLocation+"lib/jquery/jquery.event.drop.js"],function(){var e,r,i=o.ovMap.ovmap_;o._$boxElm.drag("start",function(o,n){var a=$(this);n.$dragged=a.clone().addClass(TC.Consts.classes.ACTIVE);a.after(n.$dragged);e=parseInt(a.css("bottom"));r=parseInt(a.css("left"));var l=i.getPixelFromCoordinate([t.options.maxExtent[0],t.options.maxExtent[1]]),s=i.getPixelFromCoordinate([t.options.maxExtent[2],t.options.maxExtent[3]]),p=i.getSize();n.limit={bottom:p[1]-l[1],left:l[0],top:p[1]-s[1]-a.height(),right:s[0]-a.width()}}).drag("end",function(e,r){r.$dragged.remove();var n=o.ovMap.getMap(),a=n.getView(),l=i.getPixelFromCoordinate(a.getCenter()),s=i.getCoordinateFromPixel([l[0]+r.deltaX,l[1]+r.deltaY]),p=t.getExtent(),c=(p[2]-p[0])/2,u=(p[3]-p[1])/2;s[0]+c>t.options.maxExtent[2]?s[0]=t.options.maxExtent[2]-c:s[0]-c<t.options.maxExtent[0]&&(s[0]=t.options.maxExtent[0]+c);s[1]+u>t.options.maxExtent[3]?s[1]=t.options.maxExtent[3]-u:s[1]-u<t.options.maxExtent[1]&&(s[1]=t.options.maxExtent[1]+u);t.setCenter(s,{animate:!0})}).drag(function(t,o){parseInt(o.$dragged.css("bottom")),parseInt(o.$dragged.css("left"));if(o.limit.top){o.$dragged.css("bottom",Math.min(Math.max(e-o.deltaY,o.limit.bottom),o.limit.top)+"px");o.$dragged.css("left",Math.min(Math.max(r+o.deltaX,o.limit.left),o.limit.right)+"px")}else{o.$dragged.css("bottom",e-o.deltaY+"px");o.$dragged.css("left",r+o.deltaX+"px")}})});$.when(t.wrap.getMap()).then(function(i){o.ovMap.ovmap_.setView(new e.View(_(t.wrap,r._wrap.parent)));var n=$(o.parent.div).find("."+o.parent.CLASS+"-load");r._wrap.$events.on(TC.Consts.event.BEFORETILELOAD,function(){n.removeClass(TC.Consts.classes.HIDDEN).addClass(TC.Consts.classes.VISIBLE)});r._wrap.$events.on(TC.Consts.event.TILELOAD,function(){n.removeClass(TC.Consts.classes.VISIBLE).addClass(TC.Consts.classes.HIDDEN)});i.addControl(o.ovMap);o.parent.isLoaded=!0;o.parent.$events.trigger($.Event(TC.Consts.event.MAPLOAD))})})};TC.wrap.control.OverviewMap.prototype.get3DCameraLayer=function(){var t=this,o=null,r="3DCamera",i=t.ovMap.getOverviewMap();i.getLayers().forEach(function(e){e.get("id")===r&&(o=e)});if(!o){var i=t.ovMap.getOverviewMap(),n=M({});n[0].getFill().setColor([0,0,0,0]);o=new e.layer.Vector({id:r,source:new e.source.Vector,style:n});i.addLayer(o)}return o};TC.wrap.control.OverviewMap.prototype.draw3DCamera=function(t){var o=this;o.is3D=!!t;var r=o.get3DCameraLayer();if(r){var i;t=t||{};var n=t.fov,a=r.getSource();if(n&&n.length){var l=a.getFeatures();if(l.length)i=l[0];else{i=new e.Feature;a.addFeature(i)}i.setGeometry(new e.geom.Polygon([n]))}else a.clear();var s="number"==typeof t.heading?t.heading:0;o._$boxElm.css("transform","rotate("+s+"rad)")}};TC.wrap.control.OverviewMap.prototype.enable=function(){var e=this;if(e.parent.layer&&e.parent.layer.setVisibility){e.parent.layer.setVisibility(!0);$(e.parent.map.div).trigger("resize")}};TC.wrap.control.OverviewMap.prototype.disable=function(){var e=this;e.parent.layer&&e.parent.layer.setVisibility&&e.parent.layer.setVisibility(!1)};TC.wrap.control.FeatureInfo.prototype.register=function(e){var t=this;$.when(e.wrap.getMap()).then(function(o){TC.wrap.control.Click.prototype.register.call(t,e);var r=t._trigger;t._trigger=function(o){t.hasElegibleLayers().then(function(i){i&&r.call(t,o)&&e.$events.trigger($.Event(TC.Consts.event.BEFOREFEATUREINFO,{xy:o.pixel,control:t.parent}))})}})};TC.wrap.control.FeatureInfo.prototype.hasElegibleLayers=function(){var e=$.Deferred(),t=this.parent.map,o=!1;$.when(t.wrap.getMap()).then(function(r){r.getLayers().forEach(function(e){var r=e._wrap.parent,i=e.getSource();if(i.getGetFeatureInfoUrl&&$.inArray(r,t.workLayers)>=0){o=!0;return!1}});e.resolve(o)});return e};var q,j=function(e){var t=e.innerHTML||e.textContent;q=q||document.createElement("textarea");q.innerHTML=t;return q.value},W={readFeatures:function(t){var o=[],r=(new DOMParser).parseFromString(t,"text/xml");if("FeatureInfoResponse"===r.documentElement.tagName)for(var i=r.documentElement.getElementsByTagName("FeatureInfoCollection"),n=0,a=i.length;a>n;n++)for(var l=i[n],s=l.getAttribute("layername"),p=l.getElementsByTagName("FeatureInfo"),c=0,u=p.length;u>c;c++){for(var g=p[c].getElementsByTagName("Field"),d={},h=0,f=g.length;f>h;h++){var y=g[h];d[j(y.getElementsByTagName("FieldName")[0])]=j(y.getElementsByTagName("FieldValue")[0])}var m=new e.Feature(d);m.setId(s+"."+TC.getUID());o[o.length]=m}return o}},V=function(e,t,o){var r=t.getPath(o);e.layers.push({name:o,title:r[r.length-1],path:r.slice(1),features:[]})};TC.wrap.control.FeatureInfo.prototype.getFeatureInfo=function(t,o){var r=this,i=o||{},n=r.parent.map;$.when(n.wrap.getMap()).then(function(o){for(var a={},l={},s=[],p=[],c=o.getLayers().getArray(),u=0;u<c.length;u++){var g=c[u];if(g.getVisible()){var d=g._wrap.parent,h=g.getSource();if(h.getGetFeatureInfoUrl&&$.inArray(d,n.workLayers)>=0&&d.names.length>0&&(!i.serviceUrl||i.serviceUrl===d.url)){var f={};if(a[d.title])f=a[d.title];else{f={layers:[],mapLayer:d,request:null};a[d.title]=f;l[d.title]={source:jQuery.extend(!0,{},h),layers:[]}}var y=d.getDisgregatedLayerNames();if(i.layerName){if(y.indexOf(i.layerName)>=0&&g._wrap.getInfo(i.layerName).queryable){V(f,d,i.layerName);l[d.title].layers.push(i.layerName)}}else{for(var m=0;m<y.length;m++){var v=y[m];if(g._wrap.getInfo(v).queryable)V(f,d,v);else{y.splice(m,1);m-=1}}l[d.title].layers=l[d.title].layers.concat(y)}}}}var C=i.mapSize||o.getSize(),T=Math.round(t[0]),_=Math.round(t[1]),S=i.boundingBox||n.getExtent(),E=o.getView().getResolution();for(var x in a){var f=a[x],h=l[x].source,c=l[x].layers,P=h.getParams();h.params_.LAYERS=c.join(",");var L=h.getGetFeatureInfoUrl(t,E,n.crs,{QUERY_LAYERS:c.join(","),INFO_FORMAT:P.INFO_FORMAT,FEATURE_COUNT:1e3,radius:n.options.pixelTolerance,buffer:n.options.pixelTolerance});L=L.replace(/I=\d+(\.\d+)?/,"I="+T).replace(/J=\d+(\.\d+)?/,"J="+_).replace(/WIDTH=\d+/,"WIDTH="+C[0]).replace(/HEIGHT=\d+/,"HEIGHT="+C[1]).replace(/BBOX=-?\d+(\.\d+)?\%2C-?\d+(\.\d+)?\%2C-?\d+(\.\d+)?\%2C-?\d+(\.\d+)?/,"BBOX="+S.join("%2C")).replace(/sld_body=[a-zA-Z%0-9._]*/);var w=L;f.mapLayer.usesProxy?L=TC.proxify(L):f.mapLayer.usesSSL&&(L=L.replace(/^(f|ht)tp?:\/\//i,"https://"));var R=$.ajax({url:L});R.originalUrl=L;R.title=x;R.requestedFormat=P.INFO_FORMAT;R.expandUrl=w;s.push(R)}s.length>0?$.when.apply(r,s).then(function(){for(var o=s.length>1?arguments:[arguments],l=!1,c=0,u=[],g=0;g<o.length;g++){var d=o[g],h=a[s[g].title],f=d[2];if("success"===d[1]){l=!0;h.text=f.responseText;var y,m=f.getResponseHeader("Content-type");m&&m.indexOf(";")>-1&&(m=m.substr(0,m.indexOf(";")).trim());m||(m=f.requestedFormat);if(m===f.requestedFormat){switch(m){case"application/json":y=new e.format.GeoJSON;break;case"application/vnd.ogc.gml":y=f.responseText.indexOf("FeatureCollection")>-1?new e.format.WFS({gmlFormat:new e.format.GML2({srsName:n.crs})}):new e.format.WMSGetFeatureInfo;break;case"application/vnd.ogc.gml/3.1.1":y=new e.format.GML3Patched({srsName:n.crs});break;case"application/vnd.esri.wms_featureinfo_xml":
y=W;break;default:y=null}if(y){var v=y.readFeatures(f.responseText,{featureProjection:e.proj.get(n.crs)});c+=v.length;for(var C=function(e,t,o){var r=!1;if(t===o)r=!0;else{var i=e.getNodePath(t),n=e.getNodePath(o);if(i.length>0&&n.length>=i.length){r=!0;for(var a=0;a<i.length;a++)if(e.wrap.getName(i[a])!==e.wrap.getName(n[a])){r=!1;break}}}return r},T={},_=0;_<v.length;_++){var S=v[_];if(S instanceof e.Feature){for(var E=S.getId()||TC.getUID(),x=!1,P=E.substr(0,E.lastIndexOf(".")),L=0;L<h.layers.length;L++){var w=h.layers[L],R=w.name.substr(w.name.indexOf(":")+1);if(C(h.mapLayer,R,P)){x=!0;if(!i.featureId||S.getId()===i.featureId){p.push(TC.wrap.Feature.createFeature(S));u.push(w.features)}break}}if(!x){var A;if(T[P])A=T[P];else{A={name:P,title:P,path:[P],features:[]};T[P]=A;h.layers.push(A)}if(!i.featureId||S.getId()===i.featureId){p.push(TC.wrap.Feature.createFeature(S));u.push(A.features)}}}}}else{var b={name:"layer"+TC.getUID(),title:"Datos en el punto",features:[]};h.layers[h.layers.length]=b;b.features[0]={rawUrl:f.originalUrl,expandUrl:f.expandUrl,rawContent:f.responseText,rawFormat:m};c+=1}}else n.$events.trigger($.Event(TC.Consts.event.FEATUREINFOERROR,{xy:t,control:r.parent,layer:h.mapLayer,message:f.responseText}))}else n.$events.trigger($.Event(TC.Consts.event.FEATUREINFOERROR,{xy:t,control:r.parent,layer:h.mapLayer,message:f.responseText}))}if(l){var M=p;if(p.length){var I=$.Deferred();M=M.concat(I);TC.loadJS(!TC.Geometry,TC.apiLocation+"TC/Geometry",function(){I.resolve()})}$.when.apply(this,M).then(function(){var e;if(arguments.length)for(var o=n.wrap.getCoordinateFromPixel(t),i=0;i<arguments.length;i++){var l=arguments[i];if(l){l.attributes=[];for(var s in l.data){var p=l.data[s];"object"!=typeof p&&l.attributes.push({name:s,value:"number"==typeof p?p.toLocaleString(TC.Util.getMapLocale(r.parent.map)):p})}l.showsPopup=!1;!e&&TC.Geometry.isInside(o,l.geometry)&&(e=l);u[i].push(l)}}var g=[];for(var d in a)a.hasOwnProperty(d)&&g.push(a[d]);n.$events.trigger($.Event(TC.Consts.event.FEATUREINFO,{xy:t||null,services:g,featureCount:c,defaultFeature:e,control:r.parent}))})}},function(e,t,o){n.$events.trigger(TC.Consts.event.NOFEATUREINFO);n.toast(r.parent.getLocaleString("featureInfo.error"),{type:TC.Consts.msgType.ERROR})}):n.$events.trigger($.Event(TC.Consts.event.FEATUREINFO,{xy:t,services:a,featureCount:0,control:r.parent}))})};TC.wrap.control.GeometryFeatureInfo.prototype.register=function(t){var o=this;$.when(t.wrap.getMap()).then(function(r){TC.wrap.control.Click.prototype.register.call(o,t);var i=o._trigger;o._trigger=function(t){o.hasElegibleLayers().then(function(r){r&&(o.parent._isSearching||t.type!=e.MapBrowserEventType.SINGLECLICK||o.parent._isDrawing||o.parent._isSearching||i.call(o,t))})}})};TC.wrap.control.GeometryFeatureInfo.prototype.hasElegibleLayers=function(){var e=$.Deferred(),t=this.parent.map,o=!1;$.when(t.wrap.getMap()).then(function(r){r.getLayers().forEach(function(e){var r=e._wrap.parent,i=e.getSource();if(i.getGetFeatureInfoUrl&&$.inArray(r,t.workLayers)>=0){o=!0;return!1}});e.resolve(o)});return e};TC.wrap.control.GeometryFeatureInfo.prototype.beginDraw=function(t){var o=this;t=t||{};var r=t.xy,i=t.layer,n=t.callback,a=t.geometryType,l=!1;if(o.drawCtrl){o.drawCtrl.setActive(!0);o.drawCtrl.startDrawing_({coordinate:r})}else $.when(i.wrap.getLayer()).then(function(t){var i;switch(a){case TC.Consts.geom.POLYLINE:i=e.geom.GeometryType.LINE_STRING;break;default:i=e.geom.GeometryType.POLYGON}o.drawCtrl=new e.interaction.Draw({source:t.getSource(),type:i,style:t.getStyle()});var s=function(e){e.parent.showsPopup=!1};t.getSource().on(e.source.VectorEventType.ADDFEATURE,function(e){e.feature._wrap?s(e.feature._wrap):e.feature._wrapDeferred.then(s)});o.drawCtrl.handleEvent=function(t){if(t.type==e.MapBrowserEventType.SINGLECLICK){var o=i===e.geom.GeometryType.POLYGON?this.sketchCoords_[0]:this.sketchCoords_;l&&2==o.length&&null!==this.sketchFeature_?this.addToDrawing_(t):l=!0}return e.interaction.Draw.handleEvent.call(this,t)};o.parent.map.wrap.getMap().addInteraction(o.drawCtrl);o.drawCtrl.on("drawstart",function(t){o.parent._isDrawing=!0;var r=o.parent.map;$.when(r.wrap.getMap()).then(function(t){t.getInteractions().forEach(function(t,o){t instanceof e.interaction.DoubleClickZoom&&t.setActive(!1)})})});o.drawCtrl.startDrawing_({coordinate:r});o.drawCtrl.on("drawend",function(r){o.parent._isDrawing=!1;var i=o.parent.map;$.when(i.wrap.getMap()).then(function(t){t.getInteractions().forEach(function(t,o){t instanceof e.interaction.DoubleClickZoom&&t.setActive(!1)})});n&&TC.wrap.Feature.createFeature(r.feature).then(function(e){n(e)});this.setActive(!1);o.parent.map.wrap.getMap().removeInteraction(o.drawCtrl);o.drawCtrl=null;t.getSource().clear();o.parent._drawToken=!0;setTimeout(function(){o.parent._drawToken=!1},500)})})};TC.wrap.control.GeometryFeatureInfo.prototype.cancelDraw=function(e,t,o){var r=this;if(r.drawCtrl&&r.parent._isDrawing){r.parent._isDrawing=!1;r.drawCtrl.setActive(!1);r.drawCtrl.source_.clear()}};var Y=function(e,t,o,r){var i=[],n={};$.when(e.wrap.getMap()).then(function(a){a.getLayers().forEach(function(a){var l=a._wrap.parent;if(a.getVisible()&&!($.inArray(l,e.workLayers)<0)&&l.type===TC.Consts.layerType.WMS){var s=l.getDisgregatedLayerNames()||l.availableNames;n[l.url.toLowerCase()]||(n[l.url.toLowerCase()]={layers:[],mapLayer:l,layerNames:[]});for(var p=0;p<s.length;p++){var c=s[p];if((l.isVisibleByScale(c)||r)&&l.wrap.getInfo(c).queryable){n[l.url.toLowerCase()].layerNames.push(c);var u=l.getPath(c);n[l.url.toLowerCase()].layers.push({name:c,title:u[u.length-1],path:u.slice(1),features:[]})}}if(0!=n[l.url.toLowerCase()].layerNames.length&&"undefined"==typeof n[l.url.toLowerCase()].request){n[l.url.toLowerCase()].request=l.getWFSCapabilitiesPromise();n[l.url.toLowerCase()].defer=$.Deferred();i.push(n[l.url.toLowerCase()].defer);$.when(n[l.url.toLowerCase()].request).then(function(e){var i=null;for(var a in n)n[a].request&&n[a].request.promise()==this&&(i=n[a]);var l=null,s=i.layerNames,p=i.defer;if(s instanceof Array&&s.length)if("undefined"!=typeof e.Operations.GetFeature){for(var c=[],u=0;u<s.length;u++){for(var g=s[u].substring(s[u].indexOf(":")+1);"_"===g[g.length-1];)g=g.substring(0,g.lastIndexOf("_"));e.FeatureTypes.hasOwnProperty(g)?c.indexOf(g)<0&&c.push(g):TC.error("El servicio "+i.mapLayer.title+" no dispone de la capa "+g)}if(0!=c.length){e.Operations.GetFeature.CountDefault&&(l=e.Operations.GetFeature.CountDefault.DefaultValue);(("1.0.0"===e.version||"1.1.0"===e.version)&&!e.Operations.GetFeature.Operations.hasOwnProperty("Query")||"2.0.0"===e.version&&e.Operations.QueryExpressions.AllowedValues.Value.indexOf("wfs:Query")<0)&&TC.error("El servicio "+i.mapLayer.title+" no tiene habilitado el Query de WFS");var a=e.Operations.GetFeature.DCPType?e.Operations.GetFeature.DCPType[1].HTTP.Post.onlineResource:e.Operations.GetFeature.DCP.HTTP.Post["xlink:href"],d=i.mapLayer.usesProxy?TC.proxify(a):i.mapLayer.usesSSL?a.replace(/^(f|ht)tp?:\/\//i,"https://"):a;l?jQuery.ajax({url:d,data:TC.Util.WFSQueryBuilder(c,t,e,o,!0),cache:!1,contentType:"application/xml",type:"POST"}).then(function(){var n=xml2json(arguments[0]);if(n.Exception)p.resolve({err:n.Exception.exceptionCode,errorThrown:n.Exception.ExceptionText,service:i});else{var s=parseInt(n.numberMatched||n.numberOfFeatures,10);isNaN(s)||s>parseInt(l,10)?p.resolve({err:"NumMaxFeatures",limit:l,service:i}):r&&p.resolve({url:a,data:TC.Util.WFSQueryBuilder(c,t,e,o,!1),service:i,numFeatures:s})}},function(e,t,o){p.resolve({err:t,errorThrown:o,service:i})}):r||p.resolve({url:d,data:TC.Util.WFSQueryBuilder(c,t,e,o,!1),service:i});r&&!l&&p.resolve({url:a,data:TC.Util.WFSQueryBuilder(c,t,e,o,!1),service:i});r||jQuery.ajax({url:d,data:TC.Util.WFSQueryBuilder(c,t,e,o,!1),cache:!1,contentType:"application/xml",type:"POST"}).then(function(){"success"==arguments[1]?p.resolve({service:i,response:arguments}):p.reject(arguments)},function(e,t,o){p.resolve({err:t,errorThrown:o,service:i})})}else{TC.error("No hay ninguna capa v\xe1lida para el servicio "+i.mapLayer.title+" por lo que no se consultar\xe1 dicho servicio");p.resolve(null)}}else p.resolve("El servicio "+i.mapLayer.title+" no tiene habilitado el GetFeature de WFS")},function(e,t,o){var r=null;for(var i in n)n[i].request&&n[i].request.promise()==this&&(r=n[i]);r.defer.resolve({err:o,service:r})})}}})});return i};TC.WFSGetFeatureBuilder=Y;var K=function(t,o,r){var i,n=r.getResponseHeader("Content-type");n&&n.indexOf(";")>-1&&(n=n.substr(0,n.indexOf(";")).trim());n||(n=o.requestedFormat);switch(n){case"application/json":i=new e.format.GeoJSON;break;case"application/vnd.ogc.gml":i=o.responseText.indexOf("FeatureCollection")>-1?new e.format.WFS({gmlFormat:new e.format.GML2({srsName:t.crs})}):new e.format.WMSGetFeatureInfo;break;case"application/vnd.ogc.gml/3.1.1":i=new e.format.GML3Patched({srsName:t.crs});break;case"text/xml":case"application/xml":var r=xml2json(o);r.ServiceException&&TC.error(r.ServiceException);i=null;break;default:i=null}return i?i.readFeatures(r.responseText,{featureProjection:e.proj.get(t.crs)}):null},X=function(t,o){for(var r=[],i=[],n=$.Deferred(),a=function(e,t,o){var r=!1;if(t===o||0===t.indexOf(o))r=!0;else{var i=e.getPath(t),n=e.getPath(o);if(i.length>0&&n.length>=i.length){r=!0;for(var a=0;a<i.length;a++)if(i[a]!==n[a]){r=!1;break}}}return r},l=0;l<t.length;l++){var s=t[l];if(s instanceof e.Feature){for(var p=s.getId()||TC.getUID(),c=!1,u=p.substr(0,p.lastIndexOf(".")),g=0;g<o.layers.length;g++){var d=o.layers[g],h=d.name.substr(d.name.indexOf(":")+1);if(a(o.mapLayer,h,u)){c=!0;r.push(TC.wrap.Feature.createFeature(s));i[s.id_]=d.features;break}}if(!c){var f;if(fakeLayers[u])f=fakeLayers[u];else{f={name:u,title:u,features:[]};fakeLayers[u]=f;o.layers.push(f)}if(!opts.featureId||s.getId()===opts.featureId){r.push(TC.wrap.Feature.createFeature(s));i.push(f.features)}}}}$.when.apply(this,r).done(function(){if(arguments.length)for(var e=0;e<arguments.length;e++){var t=arguments[e];t.attributes=[];for(var r in t.data){var a=t.data[r];"object"!=typeof a&&t.attributes.push({name:r,value:a})}i[t.id].push(t)}n.resolve({service:o})});return n};TC.wrap.control.GeometryFeatureInfo.prototype.getFeaturesByGeometry=function(t,o){var r=this,i=r.parent.map;r.parent.filterFeature=t;t.layer=r.parent.filterLayer;$.when(i.wrap.getMap()).then(function(n){var a=t.wrap.feature.getGeometry(),l=a.stride,s=a.getFlatCoordinates();if(!o){for(var p=null,c=1,u=s.length;u>c;c+=l)(!p||p[1]<s[c])&&(p=[s[c-1],s[c]]);o=n.getPixelFromCoordinate(new e.geom.Point(p).getCoordinates())}i.$events.trigger($.Event(TC.Consts.event.BEFOREFEATUREINFO,{xy:o,control:r.parent}));var g=Y(i,t,"JSON"),d=[];$.when.apply($,g).then(function(){for(var e=[],t=0,n=!1,a=0;a<arguments.length;a++)if(arguments[a])if(arguments[a].err){n=!0;var l=new $.Deferred;d[d.length]=l;e.push(arguments[a].service);switch(arguments[a].err){case"NumMaxFeatures":i.toast(r.parent.getLocaleString("featureInfo.tooManyFeatures").format(arguments[a].limit,arguments[a].service.mapLayer.title),{type:TC.Consts.msgType.WARNING});break;case"NameResolutionFailure":i.toast(r.parent.getLocaleString("featureInfo.inValidService").format(arguments[a].service.mapLayer.title),{type:TC.Consts.msgType.WARNING})}e.push(arguments[a].service);l.resolve()}else{var s=K(i,arguments[a].response[0],arguments[a].response[2]);d[d.length]=X(s,arguments[a].service);e.push(arguments[a].service);for(var p=0;p<arguments[a].service.layers.length;p++)t+=s.length}$.when.apply($,d).then(function(){i.$events.trigger(t||n?$.Event(TC.Consts.event.FEATUREINFO,{xy:o||null,services:e,featureCount:t,control:r.parent}):$.Event(TC.Consts.event.NOFEATUREINFO,{xy:o,control:r.parent}))})},function(e){i.$events.trigger($.Event(TC.Consts.event.NOFEATUREINFO,{xy:o,control:r.parent}))})})};TC.wrap.control.Popup.prototype=function(){this.popup=null};TC.Consts.event.PANANIMATIONSTART="pananimationstart.tc";TC.Consts.event.PANANIMATIONEND="pananimationend.tc";TC.wrap.control.Popup.prototype.fitToView=function(){var t=this,o=t.parent.map,r=t.parent.map.wrap.map,i=t.parent.$popupDiv[0].getBoundingClientRect(),n=o._$div[0].getBoundingClientRect(),a=r.getCoordinateFromPixel([i.left-n.left,i.top-n.top]),l=r.getCoordinateFromPixel([i.right-n.left,i.bottom-n.top]),s=a[0],p=a[1],c=l[0],u=l[1],g=[s,u,c,p],d=o.getExtent();if(!e.extent.containsExtent(d,g)){var h={left:Math.max(d[0]-g[0],0),bottom:Math.max(d[1]-g[1],0),right:Math.max(g[2]-d[2],0),top:Math.max(g[3]-d[3],0)};if(t.parent.dragged){var f=t.popup.getPosition();h.right?f[0]=f[0]-h.right:h.left&&(f[0]=f[0]+h.left);h.top?f[1]=f[1]-h.top:h.bottom&&(f[1]=f[1]+h.bottom);var y=r.getPixelFromCoordinate(f);y[1]=r.getSize()[1]-y[1];t.parent._previousContainerPosition=y;t.popup._oldUpdatePixelPosition(f)}else if(t.parent.isVisible()){var m=r.getView(),v=m.getCenter().slice();h.top?v[1]+=h.top:h.bottom&&(v[1]-=h.bottom);h.right?v[0]+=h.right:h.left&&(v[0]-=h.left);m.animate({center:v,easing:function(e){0===e&&t.parent.map.$events.trigger($.Event(TC.Consts.event.PANANIMATIONSTART));1===e&&t.parent.map.$events.trigger($.Event(TC.Consts.event.PANANIMATIONEND));return e}})}}};TC.wrap.control.Popup.prototype.setDragged=function(t){var o=this.popup;if(t){if(!o._oldUpdatePixelPosition){o._oldUpdatePixelPosition=o.updatePixelPosition;o.updatePixelPosition=function(){}}if(!o._newHandleOffsetChanged){o._newHandleOffsetChanged=function(){this._oldUpdatePixelPosition()};e.events.unlisten(o,e.Object.getChangeEventType(e.Overlay.Property_.OFFSET),o.handleOffsetChanged,o);e.events.listen(o,e.Object.getChangeEventType(e.Overlay.Property_.OFFSET),o._newHandleOffsetChanged,o)}}else{delete this.parent._previousContainerPosition;if(o._oldUpdatePixelPosition){o.updatePixelPosition=o._oldUpdatePixelPosition;delete o._oldUpdatePixelPosition}if(o._newHandleOffsetChanged){e.events.unlisten(o,e.Object.getChangeEventType(e.Overlay.Property_.OFFSET),o._newHandleOffsetChanged,o);e.events.listen(o,e.Object.getChangeEventType(e.Overlay.Property_.OFFSET),o.handleOffsetChanged,o);delete o._newHandleOffsetChanged}}};TC.wrap.Feature.prototype.getLegend=function(){var t=this,o={},r=b(t.feature);if(r){var i=r.getImage();if(i){if(i instanceof e.style.Icon){o.src=i.getSrc();var n=i.getScale();if(n){o.scale=n;var a=i.getImage();if(a.width){o.width=a.width*n;o.height=a.height*n}}}else i instanceof e.style.Circle&&(o.src=i.canvas_.toDataURL());if(t.parent.options.radius)o.height=o.width=2*t.parent.options.radius;else{o.width=o.width||t.parent.options.width;o.height=o.height||t.parent.options.height}}else{var l=r.getStroke(),s=r.getFill();if(l){var p=l.getColor();p&&(o.strokeColor=e.color.asString(p));var c=l.getWidth();c&&(o.strokeWidth=c)}if(s){var u=s.getColor();u&&(o.fillColor=e.color.asString(u))}}}return o};var H=function(t,o,r){var i,n={},a=r||"geometry";n[a]=new o(t);i=new e.Feature(n);r&&i.setGeometryName(r);return i};TC.wrap.Feature.prototype.createPoint=function(t,o){var r=this;if($.isArray(t))r.feature=H(t,e.geom.Point,o.geometryName);else if(r.isNative(t)){r.feature=t;r.parent.geometry=t.getGeometry().getCoordinates()}r.feature._wrap=r;r.feature.setStyle(M({styles:{point:o}},r.feature))};TC.wrap.Feature.prototype.createMarker=function(t,o){var r=this,i=TC.Util.getPointIconUrl(o);if(i){o.url=i;if($.isArray(t))r.feature=H(t,e.geom.Point,o.geometryName);else if(r.isNative(t)){r.feature=t;r.parent.geometry=t.getGeometry().getCoordinates()}r.feature._wrap=r;r.feature.setStyle(M({styles:{marker:o}},r.feature))}else r.createPoint(t,o)};TC.wrap.Feature.prototype.createPolyline=function(t,o){var r=this;if($.isArray(t))r.feature=H(t,e.geom.LineString,o.geometryName);else if(r.isNative(t)){r.feature=t;r.parent.geometry=t.getGeometry().getCoordinates()}r.feature._wrap=r;o&&r.feature.setStyle(M({styles:{line:o}},r.feature))};TC.wrap.Feature.prototype.createPolygon=function(t,o){var r=this;if($.isArray(t)){if(t.length){var i=t[0];if($.isArray(i)&&i.length){var n=i[0];$.isArray(n)||(t=[t]);for(var a=0;a<t.length;a++){i=t[a];var l=i[0],s=i[i.length-1];(l[0]!==s[0]||l[1]!==s[1])&&(i[i.length]=l);r.parent.geometry=t;r.feature=H(t,e.geom.MultiLineString,o.geometryName)}r.parent.geometry=t;r.feature=H(t,e.geom.Polygon,o.geometryName)}}}else if(r.isNative(t)){r.feature=t;r.parent.geometry=t.getGeometry().getCoordinates()}r.feature._wrap=r;var p=o||{};(p.strokeColor||p.strokeWidth||p.fillColor||p.fillOpacity)&&r.feature.setStyle(M({styles:{polygon:p}},r.feature))};TC.wrap.Feature.prototype.createMultiPolyline=function(t,o){var r=this;if($.isArray(t)){if(t.length){var i=t[0];if($.isArray(i)&&i.length){var n=i[0];$.isArray(n)||(t=[t]);r.parent.geometry=t;r.feature=H(t,e.geom.MultiLineString,o.geometryName)}}}else if(r.isNative(t)){r.feature=t;r.parent.geometry=t.getGeometry().getCoordinates()}r.feature._wrap=r;o&&r.feature.setStyle(M({styles:{line:o}},r.feature))};TC.wrap.Feature.prototype.createMultiPolygon=function(t,o){var r=this;if($.isArray(t)){if(t.length){var i=t[0];if($.isArray(i)&&i.length){var n=i[0];if($.isArray(n)&&n.length){var a=n[0];$.isArray(a)||(t=[t])}else t=[[t]];for(var l=0,s=t.length;s>l;l++){i=t[l];for(var p=0,c=i.length;c>p;p++){n=i[p];var u=n[0],g=n[n.length-1];(u[0]!==g[0]||u[1]!==g[1])&&(n[n.length]=u)}}r.parent.geometry=t;r.feature=H(t,e.geom.MultiPolygon,o.geometryName)}}}else if(r.isNative(t)){r.feature=t;r.parent.geometry=t.getGeometry().getCoordinates()}r.feature._wrap=r;var d=o||{};(d.strokeColor||d.strokeWidth||d.fillColor||d.fillOpacity)&&r.feature.setStyle(M({styles:{polygon:d}},r.feature))};TC.wrap.Feature.prototype.createCircle=function(t,o){var r=this;if($.isArray(t)&&$.isArray(t[0])&&"number"==typeof t[0][0]&&"number"==typeof t[0][1]&&"number"==typeof t[1]){var i={},n=o.geometryName||"geometry";i[n]=new e.geom.Circle(t[0],t[1]);r.feature=new e.Feature(i);o.geometryName&&r.feature.setGeometryName(o.geometryName)}else if(r.isNative(t)){r.feature=t;var a=t.getGeometry();r.parent.geometry=[a.getCenter(),a.getRadius()]}r.feature._wrap=r;o&&r.feature.setStyle(new e.style.Style({stroke:new e.style.Stroke({color:o.strokeColor,width:o.strokeWidth,lineDash:o.lineDash}),fill:new e.style.Fill({color:T(o.fillColor,o.fillOpacity)})}))};TC.wrap.Feature.createFeature=function(t){var o,r=new $.Deferred,i=t.getGeometry(),n={id:t.getId()};switch(!0){case i instanceof e.geom.Point:var a=t.getStyle();$.isFunction(a)&&(a=a.call(t));for(var l=a?$.isArray(a)?a:[a]:[],s=0,p=l.length;p>s;s++){a=l[s];if(a.getImage()instanceof e.style.Icon){o="Marker";break}}o=o||"Point";break;case i instanceof e.geom.LineString:o="Polyline";break;case i instanceof e.geom.Polygon:o="Polygon";break;case i instanceof e.geom.MultiLineString:o="MultiPolyline";break;case i instanceof e.geom.MultiPolygon:o="MultiPolygon"}o?TC.loadJS(!TC.feature||TC.feature&&!TC.feature[o],[TC.apiLocation+"TC/feature/"+o],function(){var e=new TC.feature[o](t,n);e.data=e.wrap.getData();r.resolve(e)}):TC.loadJS(!TC.Feature,[TC.apiLocation+"TC/Feature"],function(){var e=new TC.Feature(t,n);e.data=e.wrap.getData();r.resolve(e)});return r};TC.wrap.Feature.prototype.cloneFeature=function(){return this.feature.clone()};TC.wrap.Feature.prototype.getStyle=function(){var t=this,o={},r=t.feature.getStyle();$.isFunction(r)&&(r=r.call(t.feature));for(var i=r?$.isArray(r)?r:[r]:[],n=0,a=i.length;a>n;n++){r=i[n];var l=r.getFill();if(l){o.fillColor=l.getColor();$.isArray(o.fillColor)&&(o.fillOpacity=o.fillColor[3])}var s=r.getStroke();if(s){o.strokeColor=s.getColor();o.strokeWidth=s.getWidth()}var p=r.getImage();if(p instanceof e.style.Icon){o.url=p.getSrc();var c=p.getSize(),u=p.getAnchor();if(u){o.anchor=[u[0],u[1]];p.anchorXUnits_===e.style.IconAnchorUnits.PIXELS&&(o.anchor[0]=o.anchor[0]/c[0]);p.anchorYUnits_===e.style.IconAnchorUnits.PIXELS&&(o.anchor[1]=o.anchor[1]/c[1])}}var g=r.getText();if(g){o.label=g.getText();var d=g.getFont();d&&(o.fontSize=parseInt(d.match(/\d+pt/))||.75*parseInt(d.match(/\d+px/)));var h=g.getRotation();h&&(o.angle=-180*h/Math.PI);o.labelOffset=[g.getOffsetX(),g.getOffsetY()];l=g.getFill();l&&(o.fontColor=l.getColor());s=g.getStroke();if(s){o.labelOutlineColor=s.getColor();o.labelOutlineWidth=s.getWidth()}}}$.extend(t.parent.options,o);return o};TC.wrap.Feature.prototype.getGeometry=function(){var t,o=this;if(o.feature&&o.feature.getGeometry){var r=o.feature.getGeometry();r&&(r.getCoordinates?t=r.getCoordinates():r instanceof e.geom.Circle&&(t=[r.getCenter(),r.getRadius()]))}return t};TC.wrap.Feature.prototype.setGeometry=function(t){var o=!1,r=this;if(r.feature&&r.feature.getGeometry){var i,n,a,l,s,p,c,u=r.feature.getGeometry();switch(!0){case u instanceof e.geom.MultiPolygon:s=!0;l=t;$.isArray(l)&&(a=t[0]);case u instanceof e.geom.Polygon||u instanceof e.geom.MultiLineString:p=!0;a=s?a:t;$.isArray(a)&&(n=a[0]);case u instanceof e.geom.LineString:c=!0;n=p?n:t;$.isArray(n)&&(i=n[0]);case u instanceof e.geom.Point:i=c?i:t;if($.isArray(i)&&"number"==typeof i[0]&&"number"==typeof i[1]){u.setCoordinates(t);o=!0}break;case u instanceof e.geom.Circle:if($.isArray(t)&&$.isArray(t[0])&&"number"==typeof t[0][0]&&"number"==typeof t[0][1]&&"number"==typeof t[1]){u.setCenterAndRadius(t[0],t[1]);o=!0}}}return o};TC.wrap.Feature.prototype.getId=function(){var e,t=this;t.feature&&(e=t.feature.getId());return e};TC.wrap.Feature.prototype.setId=function(e){var t=this;t.feature&&t.feature.setId(e)};TC.wrap.Feature.prototype.setStyle=function(t){var o=this,r=o.feature,i=o.parent,n=r.getGeometry();if(n instanceof e.geom.Point){var a;if(t.anchor){var l={anchor:A(t.anchor,i),src:TC.Util.getPointIconUrl(t),size:[A(t.width,i),A(t.height,i)]};t.angle&&(l.angle=t.angle);a=new e.style.Icon(l)}else{var s={radius:A(t.radius,i)||(A(t.height,i)+A(t.width,i))/4};t.fillColor&&(s.fill=new e.style.Fill({color:T(A(t.fillColor,i),A(t.fillOpacity,i))}));t.strokeColor&&(s.stroke=new e.style.Stroke({color:A(t.strokeColor,i),width:A(t.strokeWidth,i),lineDash:t.lineDash}));isNaN(s.radius)||(a=new e.style.Circle(s))}r.setStyle(new e.style.Style({image:a}))}else n instanceof e.geom.LineString||n instanceof e.geom.MultiLineString?r.setStyle(new e.style.Style({stroke:new e.style.Stroke({color:A(t.strokeColor,i),width:A(t.strokeWidth,i),lineDash:t.lineDash})})):(n instanceof e.geom.Polygon||n instanceof e.geom.MultiPolygon)&&r.setStyle(new e.style.Style({stroke:new e.style.Stroke({color:A(t.strokeColor,i),width:A(t.strokeWidth,i),lineDash:t.lineDash}),fill:new e.style.Fill({color:T(A(t.fillColor,i),A(t.fillOpacity,i))})}))};TC.wrap.Feature.prototype.getInnerPoint=function(t){var o,r=t||{},i=this.feature,n=i.getGeometry(),a=function(e){var t=r.clipBox;e[0]=Math.min(Math.max(e[0],t[0]),t[2]);e[1]=Math.min(Math.max(e[1],t[1]),t[3])},l=function d(e){if(r.clipBox&&$.isArray(e))if($.isArray(e[0]))for(var t=0,o=e.length;o>t;t++)d(e[t]);else a(e)};o=n.getFirstCoordinate();switch(n.getType()){case e.geom.GeometryType.MULTI_POLYGON:n=n.getPolygon(0);case e.geom.GeometryType.POLYGON:var s=function(e,t){for(var o=!1,r=0,i=t.length-1;r<t.length;i=r++){var n=t[r][0],a=t[r][1],l=t[i][0],s=t[i][1],p=a>e[1]!=s>e[1]&&e[0]<(l-n)*(e[1]-a)/(s-a)+n;p&&(o=!o)}return o},p=n.getCoordinates();l(p);n=new e.geom.Polygon(p);o=n.getInteriorPoint().getCoordinates();for(var c=n.getLinearRings(),u=1;u<c.length;u++)if(s(o,c[u].getCoordinates())){o=n.getClosestPoint(o);break}break;case e.geom.GeometryType.MULTI_LINE_STRING:n=n.getLineString(0);case e.geom.GeometryType.LINE_STRING:var g=[0,0],p=n.getCoordinates();l(p);n=new e.geom.LineString(p);for(var u=0;u<p.length;u++){g[0]+=p[u][0];g[1]+=p[u][1]}g[0]/=p.length;g[1]/=p.length;o=n.getClosestPoint(g)}return o};TC.wrap.Feature.prototype.showPopup=function(t){var o=this,r=t.map;if(r){var i=o.feature;if(i){r.currentFeature=o.parent;var n=r.getExtent();o._innerCentroid=o.getInnerPoint({clipBox:n});t.$contentDiv.html(o.parent.getInfo());if(t.options.closeButton){var a=t.$popupDiv.find("."+t.CLASS+"-close").length;if(0==a){var l=$("<div>").addClass(t.CLASS+"-close").attr("title",t.getLocaleString("close")).appendTo(t.$popupDiv);l.on(TC.Consts.event.CLICK,function(){t.hide()});t.$contentDiv.addClass(t.CLASS+"-has-btn");t.$contentDiv.find(".tc-ctl-finfo").css("width","auto").css("height","auto")}}var s,p=o.parent.options;if(p.anchor)s=p.anchor;else{for(var c,u=i._wrap.parent,g=0;g<r.workLayers.length;g++){var d=r.workLayers[g];if(!d.isRaster()&&$.inArray(u,d.features)>=0){c=d.wrap.styleFunction(i);break}}if($.isArray(c)){var h=c[0].getImage();s=!h||h instanceof e.style.Icon?[.5,0]:[.5,.5]}}t.wrap.popup.setOffset(s&&p.height?[0,-p.height*s[1]]:[0,0]);t.wrap.popup.setPosition(o._innerCentroid);t.$popupDiv.addClass(TC.Consts.classes.VISIBLE)}else r.wrap.hidePopup(t)}};TC.wrap.Feature.prototype.isNative=function(t){return t instanceof e.Feature};TC.wrap.Feature.prototype.getPath=function(){var e=[],t=this;t.feature&&t.feature._folders&&(e=t.feature._folders);return e};TC.wrap.Feature.prototype.getBounds=function(){var e=null,t=this;t.feature&&(e=t.feature.getGeometry().getExtent());return e};TC.wrap.Feature.prototype.getTemplate=function(){var e=null,t=this,o=t.feature.getStyle();"function"==typeof o&&(o=o.call(t.feature));if($.isArray(o))for(var r=0;r<o.length;r++)if(o[r]._balloon){var i=o[r]._balloon.getText();if(i){o=o[r]._balloon;break}}o&&!$.isArray(o)&&o.getText&&(e=o.getText());return e};TC.wrap.Feature.prototype.getData=function(){var e=this,t=e.feature.getProperties();$.isArray(t.features)&&(t=1===t.features.length?t.features[0].getProperties():t.features.length+" elementos");var o=e.feature.getGeometryName();t[o]&&delete t[o];return t};TC.wrap.Feature.prototype.setData=function(e){this.feature.setProperties(e)};TC.wrap.control.Draw.prototype.mouseMoveHandler=function(e){var t=e.data;t.sketch&&t.parent.$events.trigger($.Event(TC.Consts.event.MEASUREPARTIAL,t.getMeasureData()))};TC.wrap.control.Draw.prototype.mouseOverHandler=function(e){var t=e.data;if(t.sketch&&t.hoverCoordinate){t.pushCoordinate(t.hoverCoordinate);t.hoverCoordinate=null}};TC.wrap.control.Draw.prototype.clickHandler=function(e){var t=e.data;if(t.sketch){var o=t.sketch.getGeometry().getCoordinates();t.parent.$events.trigger($.Event(TC.Consts.event.POINT,{point:o[o.length-1]}))}};TC.wrap.control.Draw.prototype.getGeometry=function(){var t={};if(this.sketch){var o=this.sketch.getGeometry();o instanceof e.geom.Polygon?t.geometry=new TC.feature.Polygon(o.getCoordinates()):o instanceof e.geom.LineString?t.geometry=new TC.feature.Polyline(o.getCoordinates()):o instanceof e.geom.Point&&(t.geometry=new TC.feature.Point(o.getCoordinates()))}return t};TC.wrap.control.Draw.prototype.getMeasureData=function(){var t=this,o=function(o,r){r.length=o.getLength();r.units=t.units;if(r.length>100&&t.units===e.proj.Units.METERS){r.length=r.length/1e3;r.units="km"}},r=function(o,r){r.area=o.getArea();var i=o.getLinearRing(0);r.perimeter=e.geom.flat.length.linearRing(i.flatCoordinates,0,i.flatCoordinates.length,i.stride);r.units=t.units;if(r.area>1e4&&t.units===e.proj.Units.METERS){r.area=r.area/1e6;r.perimeter=r.perimeter/1e3;r.units="km"}},i={};if(this.sketch){var n=this.sketch.getGeometry();n instanceof e.geom.Polygon?r(n,i):n instanceof e.geom.LineString&&o(n,i)}return i};TC.wrap.control.Draw.prototype.activate=function(t){var o,r=this;switch(t){case TC.Consts.geom.POLYGON:o=e.geom.GeometryType.POLYGON;break;case TC.Consts.geom.POINT:o=e.geom.GeometryType.POINT;break;default:o=e.geom.GeometryType.LINE_STRING}r.parent.map&&$.when(r.parent.map.wrap.getMap(),r.parent.getLayer()).then(function(n,l){r.units=n.getView().getProjection().getUnits();$.when(l&&l.wrap.getLayer()).then(function(l){r.$viewport||(r.$viewport=$(n.getViewport()));if(r.interaction){n.removeInteraction(r.interaction);r.$viewport.off(TC.Consts.event.CLICK,r.clickHandler);r.parent.measure&&r.$viewport.off(i+".draw",r.mouseMoveHandler).off(a,r.mouseOverHandler)}r.snapInteraction&&n.removeInteraction(r.snapInteraction);if(t){r.$viewport.on(TC.Consts.event.CLICK,r,r.clickHandler);r.parent.measure&&r.$viewport.on(i+".draw",r,r.mouseMoveHandler).on(a,r,r.mouseOverHandler);var s={type:o,snapTolerance:0,condition:function(){e.events.condition.shiftKeyOnly(arguments[0])&&(hole=n.forEachFeatureAtPixel(n.getPixelFromCoordinate(arguments[0].coordinate),function(t){return e.geom.GeometryType.POLYGON==t.getGeometry().getType()||e.geom.GeometryType.MULTI_POLYGON==t.getGeometry().getType()?t:null}));return!0}};if(l){s.source=l.getSource();s.style=l.getStyle()}else{var p=r.parent.map.options.styles.selection;s.style=M({styles:{point:$.extend({},p.point,{fillOpacity:0}),line:p.line,polygon:p.polygon}})}if(t===TC.Consts.geom.RECTANGLE){s.type=e.geom.GeometryType.LINE_STRING;s.maxPoints=2;s.geometryFunction=function(t,o){o||(o=new e.geom.Polygon(null));var r=t[0],i=t[1];o.setCoordinates([[r,[r[0],i[1]],i,[i[0],r[1]],r]]);return o}}r.interaction=new e.interaction.Draw(s);r.interaction.on("drawstart",function(e){r.sketch=e.feature;r.parent.$events.trigger($.Event(TC.Consts.event.DRAWSTART))},this);r.interaction.on("drawend",function(e){r.parent.$events.trigger(r.parent.measure?$.Event(TC.Consts.event.MEASURE,r.getMeasureData()):$.Event(TC.Consts.event.DRAWEND,r.getGeometry()));r.sketch=null},this);n.addInteraction(r.interaction);if(r.parent.snapping){var c={};l?c.source=l.getSource():r.parent.snapping instanceof TC.Layer&&(c.source=r.parent.snapping.wrap.layer.getSource());r.snapInteraction=new e.interaction.Snap(c);n.addInteraction(r.snapInteraction)}}r.redoStack=[]})})};TC.wrap.control.Draw.prototype.deactivate=function(){var e=this;e.parent.map&&$.when(e.parent.map.wrap.getMap(),e.parent.getLayer()).then(function(t,o){e.$viewport&&e.$viewport.off(TC.Consts.event.CLICK,e.clickHandler);o&&o.clearFeatures();if(e.interaction){t.removeInteraction(e.interaction);e.interaction=null}})};TC.wrap.control.Draw.prototype.popCoordinate=function(){var t=this,o=null;if(t.interaction){var r=t.interaction.sketchFeature_;if(r){var i,n=r.getGeometry();n instanceof e.geom.Polygon?i=n.getCoordinates()[0]:n instanceof e.geom.LineString&&(i=n.getCoordinates());if(i.length>1){var a;n instanceof e.geom.Polygon?a=t.interaction.sketchCoords_[0]:n instanceof e.geom.LineString&&(a=t.interaction.sketchCoords_);var l=!1;if(t.interaction.sketchPoint_)for(var s=t.interaction.sketchPoint_.getGeometry().getCoordinates(),p=0;p<i.length;p++)if(i[p][0]==s[0]&&i[p][1]==s[1]){l=!0;break}var c;c=l?a.length-2:a.length-1;o=a[c];a.splice(c,1);if(n instanceof e.geom.Polygon){n.setCoordinates([a]);t.interaction.sketchLine_.getGeometry().setCoordinates(a)}else n.setCoordinates(a);r.setGeometry(n)}}}return o};TC.wrap.control.Draw.prototype.pushCoordinate=function(t){var o=this,r=!1;if(o.interaction){var i=o.interaction.sketchFeature_;if(i){var n,a=i.getGeometry();a instanceof e.geom.Polygon?n=a.getCoordinates()[0]:a instanceof e.geom.LineString&&(n=a.getCoordinates());var l;a instanceof e.geom.Polygon?l=o.interaction.sketchCoords_[0]:a instanceof e.geom.LineString&&(l=o.interaction.sketchCoords_);var s=!1;if(o.interaction.sketchPoint_)for(var p=o.interaction.sketchPoint_.getGeometry().getCoordinates(),c=0;c<n.length;c++)if(n[c][0]==p[0]&&n[c][1]==p[1]){s=!0;break}index=s?l.length-1:l.length;l.splice(index,0,t);if(a instanceof e.geom.LineString)a.setCoordinates(l,e.geom.GeometryLayout.XY);else{a.setCoordinates([l],e.geom.GeometryLayout.XY);o.interaction.sketchLine_.getGeometry().setCoordinates(l)}r=!0}}return r};TC.wrap.control.Draw.prototype.undo=function(){var e=this,t=!1,o=e.popCoordinate();if(o){e.redoStack.push(o);t=!0}e.parent.$events.trigger($.Event(TC.Consts.event.MEASUREPARTIAL,e.getMeasureData()));return t};TC.wrap.control.Draw.prototype.redo=function(){var e=this,t=!1;if(e.redoStack.length>0){e.pushCoordinate(e.redoStack.pop());t=!0}e.parent.$events.trigger($.Event(TC.Consts.event.MEASUREPARTIAL,e.getMeasureData()));return t};TC.wrap.control.Draw.prototype.end=function(){var e=this;e.interaction&&e.interaction.sketchFeature_&&e.interaction.finishDrawing();

};TC.wrap.control.CacheBuilder.prototype.getRequestSchemas=function(e){for(var t=e.extent,o=e.layers,r=new Array(o.length),i=0,n=r.length;n>i;i++){var a=o[i],l={layerId:a.id},s=a.wrap.layer.getSource();s.getUrls&&(l.url=s.getUrls()[0]);if(s.getTileGrid){for(var p=s.getTileGrid(),c=p.getResolutions(),u=p.getMatrixIds(),g=a.getLayerNodeByName(a.layerNames),d=null,h=0,f=g.TileMatrixSetLink.length;f>h;h++){var y=g.TileMatrixSetLink[h];if(y.TileMatrixSet===a.matrixSet){d=y.TileMatrixSetLimits;break}}l.tileMatrixLimits=[];for(var h=0,m=c.length;m>h;h++){var v=p.getOrigin(h),C=p.getTileSize(h),T=c[h],_=C*T,S={mId:u[h],res:T,origin:v,tSize:C,cl:Math.floor((t[0]-v[0])/_),cr:Math.floor((t[2]-v[0])/_),rt:Math.floor((v[1]-t[3])/_),rb:Math.floor((v[1]-t[1])/_)};if(d){var E=d[h];if(E){S.cl=Math.max(S.cl,E.MinTileCol);S.cr=Math.min(S.cr,E.MaxTileCol);S.rt=Math.max(S.rt,E.MinTileRow);S.rb=Math.min(S.rb,E.MaxTileRow)}}S.cl<=S.cr&&S.rt<=S.rb&&l.tileMatrixLimits.push(S)}}r[i]=l}return r};TC.wrap.control.CacheBuilder.prototype.getGetTilePattern=function(e){var t="",o=e.wrap.layer.getSource();o.getUrls&&(t=o.getUrls()[0]);if(e.options.encoding!==TC.Consts.WMTSEncoding.RESTFUL){t.indexOf("?")<0&&(t+="?");t.indexOf("?")===t.length-1&&(t=t+"layer="+e.layerNames+"&style=default&tilematrixset="+encodeURIComponent(e.matrixSet)+"&Service=WMTS&Request=GetTile&Version=1.0.0&Format="+encodeURIComponent(e.format)+"&TileMatrix={TileMatrix}&TileCol={TileCol}&TileRow={TileRow}")}return t};TC.wrap.control.Edit.prototype.activate=function(t){var o=this;o.cancel(!0);t===TC.Consts.editMode.SELECT&&o.parent.map&&$.when(o.parent.map.wrap.getMap(),o.parent.layer.wrap.getLayer()).then(function(t,r){var i=o.parent.map.options.styles.selection;o.selectInteraction&&t.removeInteraction(o.selectInteraction);var n=new e.interaction.Select({layers:[r],style:M({styles:{point:$.extend({},i.point,{fillOpacity:0}),line:i.line,polygon:i.polygon}})});o.selectInteraction=n;t.addInteraction(n);var a=function(e){return e._wrap.parent};n.on("select",function(e){e.selected.length>0&&o.parent.$events.trigger($.Event(TC.Consts.event.FEATURESSELECT,{ctrl:o,features:e.selected.map(a)}));e.deselected.length>0&&0==e.selected.length&&o.parent.$events.trigger($.Event(TC.Consts.event.FEATURESUNSELECT,{ctrl:o.parent,features:e.deselected.map(a)}))});o.modifyInteraction&&t.removeInteraction(o.modifyInteraction);var l=new e.interaction.Modify({features:n.getFeatures(),style:M({styles:{point:$.extend({},i.point,{fillOpacity:0}),line:i.line,polygon:i.polygon}})});l.on(e.interaction.ModifyEventType.MODIFYEND,function(e){e.features.forEach(function(e){e._wrap.parent.geometry=e._wrap.getGeometry();o.parent.$events.trigger($.Event(TC.Consts.event.FEATUREMODIFY,{feature:e._wrap.parent,layer:o.parent.layer}))})});o.modifyInteraction=l;t.addInteraction(l);o.snapInteraction&&t.removeInteraction(o.snapInteraction);if(o.parent.snapping){o.snapInteraction=new e.interaction.Snap({source:r.getSource()});t.addInteraction(o.snapInteraction)}})};TC.wrap.control.Edit.prototype.deactivate=function(){var e=this;if(e.modifyInteraction){e.modifyInteraction.setActive(!1);e.selectInteraction.setActive(!1);$.when(e.parent.map.wrap.getMap()).then(function(t){t.removeInteraction(e.modifyInteraction);e.modifyInteraction=null;e.selectInteraction=null})}if(e.drawInteraction){e.drawInteraction.abortDrawing_();e.drawInteraction.setActive(!1);$.when(e.parent.map.wrap.getMap()).then(function(t){t.removeInteraction(e.drawInteraction);e.drawInteraction=null})}e.parent.$events.trigger($.Event(TC.Consts.event.CONTROLDEACTIVATE,{ctrl:e}))};TC.wrap.control.Edit.prototype.cancel=function(e,t){var o=this;o.points=[];o.histPoints=[];o.control&&o.control.layer||o.modifyInteraction&&o.modifyInteraction.layer;if(o.selectInteraction){var r=o.selectInteraction.getFeatures();o.parent.$events.trigger($.Event(TC.Consts.event.FEATURESUNSELECT,{ctrl:o.parent,feature:r.get(0)}));r.clear();o.selectInteraction.setActive(!1)}};TC.wrap.control.Edit.prototype.getSelectedFeatures=function(){var e=this,t=[];e.selectInteraction&&e.selectInteraction.getFeatures().forEach(function(e){t[t.length]=e._wrap.parent});return t};TC.wrap.control.Edit.prototype.setSelectedFeatures=function(e){var t=this;if(t.selectInteraction){var o=t.selectInteraction.featureOverlay_.getSource();o.clear();o.addFeatures(e.map(function(e){return e.wrap.feature}))}};TC.wrap.control.Edit.prototype.deleteFeatures=function(e){var t=this;if($.isArray(e)){var o=e.map(function(e){return e.wrap.feature});$.when(t.parent.layer.wrap.getLayer()).then(function(e){for(var r=t.selectInteraction?t.selectInteraction.getFeatures():null,i=0,n=o.length;n>i;i++){var a=o[i];if(r){r.remove(a);t.parent.$events.trigger($.Event(TC.Consts.event.FEATURESUNSELECT,{feature:a._wrap.parent}))}e.getSource().removeFeature(a);t.parent.$events.trigger($.Event(TC.Consts.event.FEATUREREMOVE,{feature:a._wrap.parent}))}})}};TC.wrap.Feature.prototype.toGML=function(t,o){var r=new e.format.GML,i=r.writeGeometryNode(this.feature.getGeometry());return(new XMLSerializer).serializeToString(i.firstChild)};return e});TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.Attribution=function(){var e=this;TC.Control.apply(e,arguments);e.apiAttribution="";e.mainDataAttribution="";e.dataAttributions=e.options.dataAttributions&&e.options.dataAttributions instanceof Array?e.options.dataAttributions:[e.options.dataAttributions]||[]};TC.inherit(TC.control.Attribution,TC.Control);!function(){var e=TC.control.Attribution.prototype;e.CLASS="tc-ctl-attrib";e.template=TC.isDebug?TC.apiLocation+"TC/templates/Attribution.html":function(){function t(e,t){return e.w("<div><span>&copy; ").f(t.get(["api"],!1),t,"h",["s"]).w("</span> - ").h("i18n",t,{},{$key:"data"}).w(": <span>").f(t.get(["mainData"],!1),t,"h",["s"]).w("</span>").x(t.get(["otherData"],!1),t,{block:o},{}).w('<div class="tc-ctl-attrib-other tc-collapsed">').s(t.get(["otherData"],!1),t,{block:r},{}).w("</div></div>")}function o(e,t){return e.w(' - <span class="tc-ctl-attrib-cmd">').h("i18n",t,{},{$key:"others"}).w("...</span>")}function r(e,t){return e.w("<span>").f(t.getPath(!1,["otherData",t.get(["$idx"],!1)]),t,"h",["s"]).w("</span>").h("sep",t,{block:i},{})}function i(e,t){return e.w(", ")}dust.register(e.CLASS,t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;return t};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);t.apiAttribution=t.map.options.attribution||t.apiAttribution;var o=function(e){if(e){var o=$("<div/>").html($.trim(e.wrap.getAttribution(TC.capabilities[e.url]))).text();if(o)if(/IDENA/.test(o))t.mainDataAttribution='<a href="http://idena.navarra.es/" target="_blank">IDENA</a>';else{for(var r=!1,i=0;i<t.dataAttributions.length;i++)if(o===t.dataAttributions[i]){r=!0;break}r||t.dataAttributions.push(o)}}},r=function(e){if(e){var o=function(){if(e.map.workLayers.length>0){for(var t=e.map.workLayers.slice().reverse(),o=0;o<t.length;o++)if(t[o].url==e.url&&t[o].getVisibility())return!1;return!0}return!0};if(o()){var r=$("<div/>").html($.trim(e.wrap.getAttribution(TC.capabilities[e.url]))).text();if(r){var i=t.dataAttributions.indexOf(r);i>-1&&t.dataAttributions.splice(i,1)}}}};t.render();e.on(TC.Consts.event.LAYERADD,function(e){if(e.layer.wrap.getAttribution){o(e.layer);t.render()}});e.on(TC.Consts.event.LAYERREMOVE,function(e){if(e.layer.wrap.getAttribution){r(e.layer);t.render()}});e.on(TC.Consts.event.LAYERVISIBILITY,function(e){if(e.layer.wrap.getAttribution){e.layer.getVisibility()?o(e.layer):r(e.layer);t.render()}})};e.render=function(e){var t=this;t.renderData({api:t.apiAttribution,mainData:t.mainDataAttribution,otherData:t.dataAttributions},function(){t._$div.find("."+t.CLASS+"-cmd").on(TC.Consts.event.CLICK,function(){t._$div.find("."+t.CLASS+"-other").toggleClass(TC.Consts.classes.COLLAPSED)});$.isFunction(e)&&e()})}}();TC.control=TC.control||{};TC.control.MapContents||TC.syncLoadJS(TC.apiLocation+"TC/control/MapContents");TC.control.BasemapSelector=function(){var e=this;TC.control.MapContents.apply(e,arguments)};TC.inherit(TC.control.BasemapSelector,TC.control.MapContents);!function(){var e=TC.control.BasemapSelector.prototype;e.CLASS="tc-ctl-bms";e.template={};if(TC.isDebug){e.template[e.CLASS]=TC.apiLocation+"TC/templates/BasemapSelector.html";e.template[e.CLASS+"-node"]=TC.apiLocation+"TC/templates/BasemapSelectorNode.html"}else{e.template[e.CLASS]=function(){function t(e,t){return e.w("<h2>").h("i18n",t,{},{$key:"backgroundMaps"}).w('</h2><div class="tc-ctl-bms-tree"><form><ul class="tc-ctl-bms-branch">').s(t.get(["baseLayers"],!1),t,{block:o},{}).w("</ul></form></div>")}function o(e,t){return e.p("tc-ctl-bms-node",t,t.rebase(t.getPath(!0,[])),{})}dust.register(e.CLASS,t);t.__dustBody=!0;o.__dustBody=!0;return t};e.template[e.CLASS+"-node"]=function(){function t(e,t){return e.w('<li class="tc-ctl-bms-node" data-tc-layer-name="').f(t.get(["name"],!1),t,"h").w('" data-tc-layer-uid="').f(t.get(["uid"],!1),t,"h").w('"><label').x(t.get(["legend"],!1),t,{block:o},{}).w('><input type="radio" name="bms" value="').f(t.get(["name"],!1),t,"h").w('" /><span>').f(t.get(["title"],!1),t,"h").w("</span></label></li>")}function o(e,t){return e.w(' style="background-size: 100% 100%; background-image: url(').f(t.getPath(!1,["legend","src"]),t,"h").w(')"')}dust.register(e.CLASS+"-node",t);t.__dustBody=!0;o.__dustBody=!0;return t}}e.register=function(e){var t=this;TC.control.MapContents.prototype.register.call(t,e);e.on(TC.Consts.event.BASELAYERCHANGE,function(){t.update()});t._$div.on("change","input[type=radio]",function(e){var o=$(e.target);if(!Modernizr.canvas){t._$div.find("label > span").removeClass(TC.Consts.classes.CHECKED);o.next().addClass(TC.Consts.classes.CHECKED)}var r=o.closest("li").data("layer");r!=r.map.getBaseLayer()&&r.map.setBaseLayer(r);e.stopPropagation()})};e.update=function(){var e=this;e._$div.find("ul."+e.CLASS+"-branch").children("li").each(function(t,o){var r=$(o),i=r.data("layer"),n=r.find("input[type=radio]").first(),a=e.map.baseLayer===i;n.prop("checked",a);Modernizr.canvas||n.next().toggleClass(TC.Consts.classes.CHECKED,a)});e.updateScale()};e.updateLayerTree=function(e){var t=this;if(e.isBase&&!e.options.stealth){TC.control.MapContents.prototype.updateLayerTree.call(t,e);var o=t.CLASS+"-node";TC.loadJSInOrder(!window.dust,TC.url.templating,function(){dust.render(o,t.layerTrees[e.id],function(o,r){var i=$(r),n=i.data("tcLayerUid"),a=t._$div.find("."+t.CLASS+"-branch"),l=a.find('li[data-tc-layer-uid="'+n+'"]');if(1===l.length)l.html(i.html());else{i.data("layer",e);a.append(i)}o&&TC.error(o)});t.update()})}};e.updateLayerOrder=function(e,t,o){};e.removeLayer=function(e){var t=this;if(e.isBase){var o=t._$div.find("."+t.CLASS+"-branch").children("li");o.each(function(t,o){var r=$(o);if(r.data("layer")===e){r.remove();return!1}})}}}();TC.control=TC.control||{};TC.control.SWCacheClient||TC.syncLoadJS(TC.apiLocation+"TC/control/SWCacheClient");!function(){TC.Consts.classes.CONNECTION_OFFLINE=TC.Consts.classes.CONNECTION_OFFLINE||"tc-conn-offline";TC.Consts.classes.CONNECTION_WIFI=TC.Consts.classes.CONNECTION_WIFI||"tc-conn-wifi";TC.Consts.classes.CONNECTION_MOBILE=TC.Consts.classes.CONNECTION_MOBILE||"tc-conn-mobile";TC.Consts.classes.OFFLINE=TC.Consts.classes.OFFLINE||"tc-offline";var e="already_exists",t=window.applicationCache;TC._appCacheBuilders||(TC._appCacheBuilders=[]);TC._appCacheUpdater||(TC._appCacheUpdater=function(t,o){for(var r=(TC.Util.getQueryStringParams(o),0),i=TC._appCacheBuilders.length;i>r;r++){var n=TC._appCacheBuilders[r];switch(t.type){case"cached":n.$events.trigger($.Event(TC.Consts.event.MAPCACHEDOWNLOAD,{url:o}));break;case"obsolete":n.$events.trigger($.Event(TC.Consts.event.MAPCACHEDELETE,{url:o}));break;case"checking":break;case"progress":n.$events.trigger($.Event(TC.Consts.event.MAPCACHEPROGRESS,{url:o,loaded:t.loaded,total:t.total}));break;case"error":n.$events.trigger($.Event(TC.Consts.event.MAPCACHEERROR,{url:o,reason:t.reason,status:t.status}));break;case"noupdate":case"updateready":n.$events.trigger($.Event(TC.Consts.event.MAPCACHEERROR,{url:o,reason:e,status:t.status}))}}});var o,r=function(){var e=window.parent!==window&&document.referrer&&TC.Util.isSameOrigin(document.referrer)&&parent.TC&&parent.TC._appCacheUpdater;return function(t){e&&parent.TC._appCacheUpdater(t,location.href)}}(),i=function(){var e=$.Deferred();if(o&&o.length)e.resolve(o);else{var t=$("html").attr("manifest");t?$.ajax({url:t,type:"GET",dataType:"text"}).done(function(t){var o=t.indexOf("NETWORK:");o>=0&&(t=t.substr(0,o));o=t.indexOf("FALLBACK:");o>=0&&(t=t.substr(0,o));o=t.indexOf("SETTINGS:");o>=0&&(t=t.substr(0,o));var r=$.grep(t.split(/[\n\r]/),function(e){return e.length>0&&0!==e.indexOf("#")&&"CACHE:"!==e});r.shift();e.resolve(r)}).fail(function(){e.reject()}):e.reject()}return e};t.addEventListener("cached",r,!1);t.addEventListener("error",r,!1);t.addEventListener("noupdate",r,!1);t.addEventListener("obsolete",r,!1);t.addEventListener("progress",r,!1);t.addEventListener("updateready",r,!1);TC.control.CacheBuilder=function(){var e=this;TC.control.SWCacheClient.apply(this,arguments);var t=e._classSelector="."+e.CLASS;e._selectors={DRAW:t+"-draw",DRAWING:t+"-drawing",PROGRESS:t+"-progress",NEW:t+"-new",LIST:t+"-list",LISTITEM:t+"-list > li",DELBTN:t+"-btn-del",OKBTN:t+"-btn-ok",NEWBTN:t+"-btn-new",SAVEBTN:".tc-btn-save",CANCELBTN:".tc-btn-cancel",EDITBTN:".tc-btn-edit",VIEWBTN:".tc-btn-view",DELETEBTN:".tc-btn-delete",TILECOUNT:t+"-tile-count",NAMETB:t+"-txt-name",TEXTBOX:"input.tc-textbox",EXIT:t+"-link-exit",OFFPANEL:t+"-off-panel",BLLIST:t+"-bl-list",BLLISTITEM:t+"-bl-list > li",BLLISTTEXT:t+"-bl-panel-txt",RNGMAXRES:t+"-rng-maxres",SEARCH:t+"-map-available-srch",EMPTYLIST:t+"-map-available-empty",OFFLINEHIDDEN:"[data-no-cb]"};e.storedMaps=[];TC._appCacheBuilders.push(e);try{if(window.localStorage){for(var o=0,r=localStorage.length;r>o;o++){var i=localStorage.key(o);if(0===i.indexOf(e.LOCAL_STORAGE_KEY_PREFIX)){var n=localStorage.getItem(i).split(" "),l=a(n.shift()),s=n.join(" "),p={name:s,extent:l,url:decodeURIComponent(i.substr(e.LOCAL_STORAGE_KEY_PREFIX.length))};e.storedMaps.push(p)}}e.storedMaps.sort(function(e,t){return e.name>t.name?1:e.name<t.name?-1:0})}}catch(c){TC.error(e.getLocaleString("couldNotAccessLocalStorage"))}var u=$.extend({},r>1?arguments[1]:arguments[0]);e._$dialogDiv=$(TC.Util.getDiv(u.dialogDiv));u.dialogDiv||e._$dialogDiv.appendTo("body");e.mapIsOffline=location.pathname.indexOf("/"+e.CACHE_REQUEST_PATH)===location.pathname.length-e.CACHE_REQUEST_PATH.length-1;e.mapIsOffline&&$(e._selectors.OFFLINEHIDDEN).addClass(TC.Consts.classes.HIDDEN);TC.Control.apply(e,arguments);e.wrap=new TC.wrap.control.CacheBuilder(e);e.isDownloading=!1;e.baseLayers=[];e.options.avgTileSize=e.options.avgTileSize||TC.Cfg.avgTileSize;e.requestSchemas=[];e.minResolution=0;e.currentMap=null;e._loadedCount=0;var g=history.pushState;history.pushState=function(t){var o;o=g.apply(history,arguments);if(e._$offlinePanelDiv){var r=location.pathname.replace("/"+e.CACHE_REQUEST_PATH,"/"),i=TC.Util.getQueryStringParams();delete i[e.MAP_DEFINITION_PARAM_NAME];delete i[e.MAP_EXTENT_PARAM_NAME];delete i[e.SERVICE_WORKER_FLAG];var n=$.param(i);n.length&&(n="?"+n);var a=r+n+location.hash;e._$offlinePanelDiv.find(e._selectors.EXIT).attr("href",a)}return o};var d=navigator.connection||navigator.mozConnection||navigator.webkitConnection||{},h=function(){if(e._$offlinePanelDiv){var t=e._$offlinePanelDiv.find(e._selectors.OFFPANEL);t.removeClass(TC.Consts.classes.CONNECTION_OFFLINE).removeClass(TC.Consts.classes.CONNECTION_MOBILE).removeClass(TC.Consts.classes.CONNECTION_WIFI);var o=d.type;switch(o){case 1:case 2:case void 0:t.addClass(TC.Consts.classes.CONNECTION_WIFI);break;default:t.addClass(TC.Consts.classes.CONNECTION_MOBILE)}}};d.addEventListener&&d.addEventListener("typechange",h);window.addEventListener("online",h);window.addEventListener("offline",function(){e._$offlinePanelDiv&&e._$offlinePanelDiv.find(e._selectors.OFFPANEL).addClass(TC.Consts.classes.CONNECTION_OFFLINE).removeClass(TC.Consts.classes.CONNECTION_MOBILE).removeClass(TC.Consts.classes.CONNECTION_WIFI)})};TC.inherit(TC.control.CacheBuilder,TC.control.SWCacheClient);var n=TC.control.CacheBuilder.prototype;n.CLASS="tc-ctl-cbuild";n.MAP_DEFINITION_PARAM_NAME="map-def";n.MAP_EXTENT_PARAM_NAME="map-extent";n.LOCAL_STORAGE_KEY_PREFIX="TC.offline.map.";n.COOKIE_KEY_PREFIX="TC.offline.map.";n.CACHE_REQUEST_PATH="offline";n.SERVICE_WORKER_FLAG="sw";n._states={READY:"ready",EDIT:"editing",DOWNLOADING:"downloading",DELETING:"deleting"};n._actions={CREATE:"create",DELETE:"delete"};n.offlineControls=["attribution","basemapSelector","cacheBuilder","click","coordinates","draw","edit","geolocation","loadingIndicator","measure","navBar","popup","print","scale","scaleBar","scaleSelector","state","fullScreen"];TC.Consts.event.MAPCACHEDOWNLOAD=TC.Consts.event.MAPCACHEDOWNLOAD||"mapcachedownload.tc";TC.Consts.event.MAPCACHEDELETE=TC.Consts.event.MAPCACHEDELETE||"mapcachedelete.tc";TC.Consts.event.MAPCACHEPROGRESS=TC.Consts.event.MAPCACHEPROGRESS||"mapcacheprogress.tc";TC.Consts.event.MAPCACHEERROR=TC.Consts.event.MAPCACHEERROR||"mapcacheerror.tc";n.template={};if(TC.isDebug){n.template[n.CLASS]=TC.apiLocation+"TC/templates/CacheBuilder.html";n.template[n.CLASS+"-map-node"]=TC.apiLocation+"TC/templates/CacheBuilderMapNode.html";n.template[n.CLASS+"-bl-node"]=TC.apiLocation+"TC/templates/CacheBuilderBaseLayerNode.html";n.template[n.CLASS+"-dialog"]=TC.apiLocation+"TC/templates/CacheBuilderDialog.html";n.template[n.CLASS+"-off-panel"]=TC.apiLocation+"TC/templates/CacheBuilderOfflinePanel.html"}else{n.template[n.CLASS]=function(){function e(e,n){return e.w("<h2>").h("i18n",n,{},{$key:"offlineMaps"}).w('</h2><div class="tc-ctl-cbuild-content"><div class="tc-ctl-cbuild-draw tc-hidden"></div><i class="tc-ctl-cbuild-map-search-icon"></i><input type="search" list="').f(n.get(["listId"],!1),n,"h").w('" class="tc-ctl-cbuild-map-available-srch tc-textbox" placeholder="').h("i18n",n,{},{$key:"cb.filter.plhr"}).w('"').x(n.get(["storedMaps"],!1),n,{"else":t,block:o},{}).w(' maxlength="200" /> <ul id="').f(n.get(["listId"],!1),n,"h").w('" class="tc-ctl-cbuild-list"><li class="tc-ctl-cbuild-map-available-empty"').x(n.get(["storedMaps"],!1),n,{block:r},{}).w("><span>").h("i18n",n,{},{$key:"cb.noMaps"}).w('</span></li><li class="tc-ctl-cbuild-map-not" hidden><span>').h("i18n",n,{},{$key:"noMatches"}).w("</span></li>").s(n.get(["storedMaps"],!1),n,{block:i},{}).w('</ul><div class="tc-ctl-cbuild-new"><button class="tc-button tc-icon-button tc-ctl-cbuild-btn-new" disabled title="').h("i18n",n,{},{$key:"newofflinemap"}).w('">').h("i18n",n,{},{$key:"newOfflineMap"}).w('</button></div><div class="tc-ctl-cbuild-drawing tc-hidden"><div class="tc-ctl-cbuild-tile-cmd"><button class="tc-button tc-icon-button tc-ctl-cbuild-btn-cancel-draw" title="').h("i18n",n,{},{$key:"cancel"}).w('">').h("i18n",n,{},{$key:"cancel"}).w('</button></div></div><div class="tc-ctl-cbuild-progress tc-hidden"><p>').h("i18n",n,{},{$key:"cb.DownloadingMap|s"}).w(': <span class="tc-ctl-cbuild-progress-count"></span></p><div class="tc-ctl-cbuild-progress-bar"><div class="tc-ctl-cbuild-progress-ratio" style="width:0"></div></div><button class="tc-button tc-icon-button tc-ctl-cbuild-btn-cancel-dl" title="').h("i18n",n,{},{$key:"cancel"}).w('">').h("i18n",n,{},{$key:"cancel"}).w("</button></div></div>")}function t(e,t){return e.w(" disabled")}function o(e,t){return e}function r(e,t){return e.w(" hidden")}function i(e,t){return e.p("tc-ctl-cbuild-map-node",t,t.rebase(t.getPath(!0,[])),{})}dust.register(n.CLASS,e);e.__dustBody=!0;t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;return e};n.template[n.CLASS+"-map-node"]=function(){function e(e,t){return e.w('<li data-extent="').f(t.get(["extent"],!1),t,"h").w('"><span><a href="').f(t.get(["url"],!1),t,"h").w('" title="').f(t.get(["name"],!1),t,"h").w('">').f(t.get(["name"],!1),t,"h").w('</a></span><input class="tc-textbox tc-hidden" type="text" value="').f(t.get(["name"],!1),t,"h").w('" /><button class="tc-btn-save tc-hidden" title="').h("i18n",t,{},{$key:"save"}).w('"></button><button class="tc-btn-cancel tc-hidden" title="').h("i18n",t,{},{$key:"cancel"}).w('"></button><button class="tc-btn-edit" title="').h("i18n",t,{},{$key:"editMapName"}).w('">').h("i18n",t,{},{$key:"editMapName"}).w('</button><button class="tc-btn-view" title="').h("i18n",t,{},{$key:"viewMapExtent"}).w('">').h("i18n",t,{},{$key:"viewMapExtent"}).w('</button><button class="tc-btn-delete" title="').h("i18n",t,{},{$key:"deleteMap"}).w('">').h("i18n",t,{},{$key:"deleteMap"}).w("</button></li>")}dust.register(n.CLASS+"-map-node",e);e.__dustBody=!0;return e};n.template[n.CLASS+"-bl-node"]=function(){function e(e,t){return e.w('<li class="tc-ctl-cbuild-bl-node" data-tc-layer-uid="').f(t.get(["id"],!1),t,"h").w('"><label style="background-size: 100% 100%; background-image: url(').f(t.get(["thumbnail"],!1),t,"h").w(')"><input type="checkbox" name="cbbl" value="').f(t.get(["id"],!1),t,"h").w('" disabled><span>').f(t.get(["title"],!1),t,"h").w("</span></label></li>")}dust.register(n.CLASS+"-bl-node",e);e.__dustBody=!0;return e};n.template[n.CLASS+"-dialog"]=function(){function e(e,t){return e.w('<div class="tc-ctl-cbuild-dialog tc-modal"><div class="tc-modal-background tc-modal-close"></div><div class="tc-modal-window"><div class="tc-modal-header"><h3>').h("i18n",t,{},{$key:"newOfflineMap"}).w('</h3><div class="tc-ctl-popup-close tc-modal-close"></div></div><div class="tc-modal-body"><input type="text" class="tc-ctl-cbuild-txt-name" placeholder="').h("i18n",t,{},{$key:"nameRequired"}).w('" required /><div class="tc-ctl-cbuild-bl-panel"><h4>').h("i18n",t,{},{$key:"availableOfflineMaps"}).w("</h4><p>").h("i18n",t,{},{$key:"selectAtLeastOne"}).w(':</p><ul class="tc-ctl-cbuild-bl-list"></ul></div><div class="tc-ctl-cbuild-res-panel"><h4>').h("i18n",t,{},{$key:"maxRes"}).w('</h4><div class="tc-ctl-cbuild-res"></div><input type="range" class="tc-ctl-cbuild-rng-maxres" disabled value="0" title="').h("i18n",t,{},{$key:"maxRes"}).w('"></div><div class="tc-ctl-cbuild-tile-count"></div></div><div class="tc-modal-footer"><button class="tc-button tc-modal-close tc-ctl-cbuild-btn-ok" disabled>').h("i18n",t,{},{$key:"ok"}).w('</button><button type="button" class="tc-button tc-modal-close tc-ctl-cbuild-btn-cancel">').h("i18n",t,{},{$key:"cancel"}).w("</button></div></div></div>")}dust.register(n.CLASS+"-dialog",e);e.__dustBody=!0;return e};n.template[n.CLASS+"-off-panel"]=function(){function e(e,t){return e.w('<div class="tc-ctl-cbuild-off-panel tc-conn-wifi"><span>').h("i18n",t,{},{$key:"offlineMap"}).w('</span> <a href="" class="tc-ctl-cbuild-link-exit" title="').h("i18n",t,{},{$key:"returnToOnlineMaps"}).w('"><span>').h("i18n",t,{},{$key:"returnToOnlineMaps"}).w("</span></a></div>")}dust.register(n.CLASS+"-off-panel",e);e.__dustBody=!0;return e}}var a=function(e){return $.map(decodeURIComponent(e).split(","),function(e){return parseFloat(e)})},l=function(e){e._state=e._states.READY;e.showDownloadProgress(0,1);e._$div.find(e._selectors.DRAWING).addClass(TC.Consts.classes.HIDDEN);e._$div.find(e._selectors.PROGRESS).addClass(TC.Consts.classes.HIDDEN);e._$div.find(e._selectors.NEW).removeClass(TC.Consts.classes.HIDDEN);e._$div.find(e._selectors.LISTITEM).removeClass(TC.Consts.classes.DISABLED);e._$div.find(e._selectors.DELBTN).prop("disabled",!1);e._$dialogDiv.find(e._selectors.OKBTN).prop("disabled",!0);e._$div.find(e._selectors.NEWBTN).prop("disabled",!1);e._$dialogDiv.find(e._selectors.TILECOUNT).html("");e.extent=null;e._loadedCount=0;e.boxDraw&&e.boxDraw.cancel()},s=function(e){e._state=e._states.EDITING;e.showDownloadProgress(0,1);e._$div.find(e._selectors.NEW).addClass(TC.Consts.classes.HIDDEN);e._$div.find(e._selectors.PROGRESS).addClass(TC.Consts.classes.HIDDEN);e._$div.find(e._selectors.DRAWING).removeClass(TC.Consts.classes.HIDDEN);e.map.toast(e.getLocaleString("clickOnDownloadAreaFirstCorner"),{type:TC.Consts.msgType.INFO});e._$dialogDiv.find(e._selectors.OKBTN).prop("disabled",!0);e._$div.find(e._selectors.NEWBTN).prop("disabled",!0);e._$dialogDiv.find(e._selectors.NAMETB).val("");e.boxDraw.activate()},p=function(e){e._state=e._states.DOWNLOADING;TC.Util.closeModal();e.showDownloadProgress(0,1);e._$div.find(e._selectors.NEW).addClass(TC.Consts.classes.HIDDEN);e._$div.find(e._selectors.DRAWING).addClass(TC.Consts.classes.HIDDEN);e._$div.find(e._selectors.PROGRESS).removeClass(TC.Consts.classes.HIDDEN);e._$dialogDiv.find(e._selectors.OKBTN).prop("disabled",!0);e._$div.find(e._selectors.NEWBTN).prop("disabled",!0);e.layer.clearFeatures();e.boxDraw.cancel()},c=function(e){e._state=e._states.DELETING;e.showDownloadProgress(0,1);e._$div.find(e._selectors.DRAWING).addClass(TC.Consts.classes.HIDDEN);e._$div.find(e._selectors.PROGRESS).addClass(TC.Consts.classes.HIDDEN);e._$div.find(e._selectors.NEW).removeClass(TC.Consts.classes.HIDDEN);e._$div.find(e._selectors.LISTITEM).addClass(TC.Consts.classes.DISABLED);e._$div.find(e._selectors.DELBTN).prop("disabled",!0);e._$dialogDiv.find(e._selectors.OKBTN).prop("disabled",!0);e._$div.find(e._selectors.NEWBTN).prop("disabled",!1);e._$dialogDiv.find(e._selectors.TILECOUNT).html("");e.boxDraw.cancel()},u=function(e,t){t.find("span").first().addClass(TC.Consts.classes.HIDDEN);t.find(e._selectors.TEXTBOX).removeClass(TC.Consts.classes.HIDDEN).val(t.find("span a").html()).focus();t.find(e._selectors.SAVEBTN).removeClass(TC.Consts.classes.HIDDEN);t.find(e._selectors.CANCELBTN).removeClass(TC.Consts.classes.HIDDEN);t.find(e._selectors.EDITBTN).addClass(TC.Consts.classes.HIDDEN);t.find(e._selectors.VIEWBTN).addClass(TC.Consts.classes.HIDDEN);t.find(e._selectors.DELETEBTN).addClass(TC.Consts.classes.HIDDEN)},g=function(e,t){t.find("span").first().removeClass(TC.Consts.classes.HIDDEN);t.find(e._selectors.TEXTBOX).addClass(TC.Consts.classes.HIDDEN);t.find(e._selectors.SAVEBTN).addClass(TC.Consts.classes.HIDDEN);t.find(e._selectors.CANCELBTN).addClass(TC.Consts.classes.HIDDEN);t.find(e._selectors.EDITBTN).removeClass(TC.Consts.classes.HIDDEN);t.find(e._selectors.VIEWBTN).removeClass(TC.Consts.classes.HIDDEN);t.find(e._selectors.DELETEBTN).removeClass(TC.Consts.classes.HIDDEN)},d=function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},h=function(e,t){var o,r,i,n=t||{},a=e._$dialogDiv.find(e._classSelector+"-res"),l=e._$dialogDiv.find(e._selectors.RNGMAXRES),s=e.getResolutions();if(s.length){if(e.minResolution){if(void 0===n.rangeValue)for(var p=0,c=s.length;c>p;p++)if(e.minResolution>=s[p]){l.val(p);break}}else void 0===n.rangeValue&&l.val(Math.floor(s.length/2));r=parseInt(l.attr("max",s.length-1).val());var u=Math.floor(1e3*new Number(s[r]))/1e3;o=e.getLocaleString("metersPerPixel",{value:u.toLocaleString((e.map?e.map.options.locale:TC.Cfg.locale).replace("_","-"))});i=100*(r+1)/(s.length+1)+"%";l.prop("disabled",!1);e.minResolution=s[l.val()]}else{r=0;o="";l.val(0);i="0";e.minResolution=0;l.prop("disabled",!0)}a.css("left",i).html(o)},f=function(e,t){for(var o=null,r=0,i=e.tileMatrixLimits.length;i>r;r++){o=e.tileMatrixLimits[r];if(o.res<=t)break}return o},y=function(e){var t=e._$dialogDiv.find(e._classSelector+"-bl-node input[type=checkbox]");t.each(function(t,o){var r=$(o);if(r.prop("checked")){var i=e.requestSchemas.filter(function(e){return e.layerId===r.val()})[0];if(i){var n=f(i,e.minResolution);if(n){var a="{TileMatrix}",l="{TileRow}",s="{TileCol}",p=i.url;if(p.indexOf(a)<0){var c=p.indexOf("?");c>=0&&(p=p.substr(0,c));for(var u=0,g=e.baseLayers.length;g>u;u++){var d=e.baseLayers[u];if(d.id===i.layerId){p=p+"?layer="+d.layerNames+"&style=default&tilematrixset="+d.matrixSet+"&Service=WMTS&Request=GetTile&Version=1.0.0&Format="+d.format+"&TileMatrix="+a+"&TileRow="+l+"&TileCol="+s;break}}}r.parent("label").css("background-size","auto").css("background-position","left bottom").css("background-image","url("+p.replace("{TileMatrix}",n.mId).replace(l,n.rt).replace(s,n.cl)+")")}}}})},v=function(e,t){var o;o=1>t?e.getLocaleString("lessThan1Mb"):e.getLocaleString("approxXMb",{quantity:d(t)});return o},C=function(e){var t="";e.tileCount=0;for(var o=0,r=e.requestSchemas.length;r>o;o++)for(var i=e.requestSchemas[o],n=0,a=i.tileMatrixLimits.length;a>n;n++){var l=i.tileMatrixLimits[n];e.tileCount+=(l.cr-l.cl+1)*(l.rb-l.rt+1);if(l.res<e.minResolution)break}if(e.tileCount){e.estimatedMapSize=Math.round(e.tileCount*e.options.avgTileSize/1048576);t=e.getLocaleString("xTiles",{quantity:d(e.tileCount)})+" ("+v(e,e.estimatedMapSize)+")"}e._$dialogDiv.find(e._selectors.TILECOUNT).html(t)},T=function(e,t){return e._$div.find(e._selectors.LISTITEM).filter(function(e,o){return $(o).find("a").first().html()===t})},_=function(e,t){var o=t.indexOf("#");o>=0&&(t=t.substr(0,o));return e._$div.find(e._selectors.LISTITEM).filter(function(e,o){return $(o).find("a").first().attr("href")===t})},S=function(e,t){$("<iframe>").css("display","none").attr("src",t).appendTo(e._$div)},E=function(e,t){var o=e._$div.find('iframe[src="'+t+'"]');o.remove()},x=function(e,t){var o=!1;if(window.localStorage){localStorage.setItem(e.LOCAL_STORAGE_KEY_PREFIX+encodeURIComponent(t.url),t.extent+" "+t.name);o=!0}return o},P=function(e,t){var o=!1;if(window.localStorage){localStorage.removeItem(e.LOCAL_STORAGE_KEY_PREFIX+encodeURIComponent(t));o=!0}return o},L=function(e){var t=e.currentMap;if(x(e,t)){e.getRenderedHtml(e.CLASS+"-map-node",{name:t.name,url:t.url},function(t){e._$div.find(e._selectors.LIST).append(t);e._$div.find(e._selectors.EMPTYLIST).attr("hidden","hidden");e._$div.find(e._selectors.SEARCH).prop("disabled",!1)});e.storedMaps.push(t)}},w=function(e,t){var o=e.findStoredMap({url:t});if(o){P(e,t)&&T(e,o.name).remove();var r=$.inArray(o,e.storedMaps);e.storedMaps.splice(r,1);if(!e.storedMaps.length){e._$div.find(e._selectors.SEARCH).prop("disabled",!0);e._$div.find(e._selectors.EMPTYLIST).removeAttr("hidden")}return o.name}return null},R=function(e){e._$dialogDiv.find(e._selectors.OKBTN).prop("disabled",!e.extent||0===e._$dialogDiv.find(e._selectors.NAMETB).val().length||e._$dialogDiv.find(e._selectors.RNGMAXRES).prop("disabled"))};n.render=function(e){var t=this,o={storedMaps:t.storedMaps,listId:t.CLASS+"-list-"+TC.getUID()};t.getRenderedHtml(t.CLASS+"-dialog",null,function(e){t._$dialogDiv.html(e);t._$dialogDiv.find(t._selectors.NAMETB).on(TC.Consts.event.CLICK,function(e){e.preventDefault();this.selectionStart=0;this.selectionEnd=this.value.length;this.focus()})}).then(function(){t.renderData(o,function(){t._$dialogDiv.find(t._selectors.OKBTN).on(TC.Consts.event.CLICK,function(){var e={mapName:t._$dialogDiv.find(t._selectors.NAMETB).val()};if(t.findStoredMap({name:e.mapName}))TC.alert(t.getLocaleString("cb.mapNameAlreadyExists.error",e));else{var o=function(){t._$div.find(t._classSelector+"-name").html(e.mapName);t.map.toast(t.getLocaleString("downloadingMap",{mapName:e.mapName}));p(t);t.requestCache(e)},r=navigator.temporaryStorage||navigator.webkitTemporaryStorage||{};if(r.queryUsageAndQuota)r.queryUsageAndQuota(function(r,i){var n=(i-r)/1048576;t.estimatedMapSize<n?o():TC.confirm(t.getLocaleString("cb.mapCreation.warning.reasonSize",{mapName:e.mapName,mapSize:v(t,t.estimatedMapSize),availableStorage:v(t,Math.round(n))}),o)},function(e){TC.error(e)});else{var n=TC.Util.detectIE();if(n){var a=12>n?1e3:2e3,l=0,s=function(){var r=t.tileCount+l;r>a?TC.confirm(t.getLocaleString("cb.mapCreation.warning.reasonCount",{mapName:e.mapName,resourceCount:d(r),maxResourceCount:d(a)}),o):o()};i().done(function(e){l=e.length;s()}).fail(s)}else o()}}});t._$dialogDiv.find(t._selectors.NAMETB).on("input",function(){R(t)});t._$div.find(t._selectors.NEWBTN).on(TC.Consts.event.CLICK,function(){s(t)});t._$div.find(t._classSelector+"-btn-cancel-draw").on(TC.Consts.event.CLICK,function(){l(t)});t._$div.find(t._classSelector+"-btn-cancel-dl").on(TC.Consts.event.CLICK,function(){
t.cancelCacheRequest()});t._$div.find(t._selectors.LIST).on(TC.Consts.event.CLICK,t._selectors.DELETEBTN,function(e){if(navigator.onLine){$btn=$(e.target);var o=$btn.parent().find("a").html();if(o){var r=t.getLocaleString("cb.delete.confirm",{mapName:o});t.serviceWorkerEnabled||(r=r+" "+t.getLocaleString("cb.delete.confirm.connect.warning"));if(confirm(r))if(navigator.onLine){c(t);t.deleteMap(o)}else TC.alert(t.getLocaleString("cb.delete.conn.alert"))}}else TC.alert(t.getLocaleString("cb.delete.conn.alert"))}).on(TC.Consts.event.CLICK,t._selectors.EDITBTN,function(e){u(t,$(e.target).parent())}).on(TC.Consts.event.CLICK,t._selectors.CANCELBTN,function(e){var o=$(e.target).parent();o.find(t._selectors.TEXTBOX).val(o.find("a").html());g(t,$(e.target).parent())}).on(TC.Consts.event.CLICK,t._selectors.SAVEBTN,function(e){var o=$(e.target).parent();g(t,o);var r=o.find("a"),i=(r.html(),o.find(t._selectors.TEXTBOX).val()),n=t.findStoredMap({url:r.attr("href")});if(n){n.name=i;r.html(i);r.attr("title",i);x(t,n)}}).on(TC.Consts.event.CLICK,t._selectors.VIEWBTN,function(e){$btn=$(e.target);var o=!$btn.hasClass(TC.Consts.classes.ACTIVE);t._$div.find(t._selectors.VIEWBTN).removeClass(TC.Consts.classes.ACTIVE).parent().removeClass(TC.Consts.classes.ACTIVE);var r=$btn.parent().find("a").html();if(r){var i=t.findStoredMap({name:r});if(i){var n=a(i.extent);t.layer.clearFeatures();if(o){t.layer.addPolygon([[[n[0],n[1]],[n[0],n[3]],[n[2],n[3]],[n[2],n[1]]]],{showsPopup:!1}).then(function(){t.layer.map.zoomToFeatures(t.layer.features)});$btn.addClass(TC.Consts.classes.ACTIVE);$btn.parent().addClass(TC.Consts.classes.ACTIVE);$btn.attr("title",t.getLocaleString("removeMapExtent"))}}}});var o=function(e){e=e.toLowerCase();var o=t._$div.find(t._selectors.LISTITEM).hide(),r=o.filter("li:not([class]),li."+TC.Consts.classes.ACTIVE);if(0===e.length){r.show();t._$div.find(t._classSelector+"-map-search-icon").css("visibility","visible")}else{t._$div.find(t._classSelector+"-map-search-icon").css("visibility","hidden");var i=new RegExp(e,"i");r.each(function(){var e=$(this);e.toggle(i.test(e.find("a").text()))});0===r.filter(":visible").length&&o.filter('[class^="tc-ctl-cbuild-map-not"]').show()}},r=t._$div.find(t._selectors.SEARCH);r.on("keyup search",function(){o($(this).val().toLowerCase().trim())});try{if(r.has($("::-ms-clear"))){var n;r.on("mouseup",function(e){n=r.val();""!==n&&setTimeout(function(){var e=r.val();""===e&&o(e)},1)})}}catch(f){}t._$dialogDiv.find(t._selectors.BLLIST).on("change","input[type=checkbox]",function(e){t.baseLayers.length=0;t._$dialogDiv.find(t._selectors.BLLIST+" input[type=checkbox]").each(function(e,o){var r=$(o);if(r.prop("checked"))for(var i=r.val(),n=0,a=t.map.baseLayers.length;a>n;n++){var l=t.map.baseLayers[n];if(l.id===i&&l.type===TC.Consts.layerType.WMTS){t.baseLayers[t.baseLayers.length]=l;break}}});t.updateRequestSchemas();h(t);y(t);R(t);C(t)});t._$dialogDiv.find(t._selectors.RNGMAXRES).on("input change",function(e){h(t,{rangeValue:$(e.target).val()});y(t);C(t)});TC.Util.getQueryStringParams();_(t,location.href).addClass(TC.Consts.classes.ACTIVE);$.isFunction(e)&&e()})});window.addEventListener("beforeunload",function(e){if(t.isDownloading){var o=t.getLocaleString("cb.mapDownloading.warning");e.returnValue=o;return o}},!0)};n.register=function(o){var r=this;TC.control.SWCacheClient.prototype.register.call(r,o);if(navigator.serviceWorker){navigator.serviceWorker.addEventListener("message",function(e){switch(e.data.event){case"progress":r.$events.trigger($.Event(TC.Consts.event.MAPCACHEPROGRESS,{url:e.data.name,loaded:e.data.count,total:e.data.total}));break;case"cached":r.$events.trigger($.Event(TC.Consts.event.MAPCACHEDOWNLOAD,{url:e.data.name}));break;case"deleted":r.$events.trigger($.Event(TC.Consts.event.MAPCACHEDELETE,{url:e.data.name}));break;case"error":e.data.action===r._actions.CREATE&&TC.error(r.getLocaleString("cb.resourceDownload.error",{url:e.data.url}))}});var n=function(){i().then(function(e){r.cacheUrlList(e,{silent:!0})})},s=function(){r.deleteCache(r.LOCAL_STORAGE_KEY_PREFIX,{silent:!0})};if(t.status===t.CACHED||t.status===t.UPDATEREADY||t.status===t.UNCACHED)n();else{t.addEventListener("cached",n,!1);t.addEventListener("updateready",n,!1);t.addEventListener("downloading",s,!1);t.addEventListener("obsolete",s,!1)}}if(r.mapIsOffline){o._$div.addClass(TC.Consts.classes.OFFLINE);r._$offlinePanelDiv=$(TC.Util.getDiv(r.options.offlinePanelDiv));r.options.offlinePanelDiv||r._$offlinePanelDiv.appendTo(o._$div);r.getRenderedHtml(r.CLASS+"-off-panel",null,function(e){r._$offlinePanelDiv.html(e);navigator.onLine||r._$offlinePanelDiv.find(r._selectors.OFFPANEL).addClass(TC.Consts.classes.CONNECTION_OFFLINE).removeClass(TC.Consts.classes.CONNECTION_MOBILE).removeClass(TC.Consts.classes.CONNECTION_WIFI);r._$offlinePanelDiv.find(r._selectors.EXIT).on(TC.Consts.event.CLICK,function(e){TC.confirm(r.getLocaleString("offlineMapExit.confirm"),null,function(){e.preventDefault()})})})}r.layer=null;o.addLayer({id:TC.getUID(),type:TC.Consts.layerType.VECTOR,stealth:!0}).then(function(e){r.layer=e;TC.loadJS(!TC.control.Draw,TC.apiLocation+"TC/control/Draw",function(){r.boxDraw=new TC.control.Draw({div:r._$div.find(r._selectors.DRAW),mode:TC.Consts.geom.RECTANGLE,layer:r.layer});r.boxDraw.$events.on(TC.Consts.event.DRAWSTART,function(e){r.map.toast(r.getLocaleString("clickOnDownloadAreaOppositeCorner"),{type:TC.Consts.msgType.INFO})}).on(TC.Consts.event.DRAWEND,function(e){var t=e.geometry.geometry[0],o=t[0],i=t[2],n=Math.min(o[0],i[0]),a=Math.max(o[0],i[0]),l=Math.min(o[1],i[1]),s=Math.max(o[1],i[1]);r.setExtent([n,l,a,s]);var p=r._$dialogDiv.find("input[type=checkbox]");p.each(function(e,t){for(var o=0,i=r.map.baseLayers.length;i>o;o++){var n=r.map.baseLayers[o];if(t.value===n.id){var a=$(t),l=a.parents("li").first(),s=n.getResolutions(),p=r.wrap.getRequestSchemas({extent:r.extent,layers:[n]})[0].tileMatrixLimits;if(p.length&&s[s.length-1]==p[p.length-1].res)l.removeClass(TC.Consts.classes.HIDDEN);else{a.prop("checked",!1);l.addClass(TC.Consts.classes.HIDDEN)}break}}});var c;c=r._$dialogDiv.find(r._selectors.BLLISTITEM).filter(":not(."+TC.Consts.classes.HIDDEN+")").length?"selectAtLeastOne":"cb.noMapsAtSelectedExtent";r._$dialogDiv.find(r._selectors.BLLISTTEXT).html(r.getLocaleString(c));y(r);C(r);TC.Util.showModal(r._$dialogDiv.find(r._classSelector+"-dialog"),{openCallback:function(){p.prop("disabled",!1);var e;if(Date.prototype.toLocaleString){var t={};t.year=t.month=t.day=t.hour=t.minute=t.second="numeric";e=(new Date).toLocaleString(r.map.options.locale.replace("_","-"),t)}else e=(new Date).toString();r._$dialogDiv.find(r._selectors.NAMETB).val(e)[0];R(r)},closeCallback:function(){p.prop("disabled",!0);r.layer.clearFeatures()}})});o.on(TC.Consts.event.CONTROLDEACTIVATE,function(e){r.boxDraw===e.control&&r._state===r._states.EDITING&&l(r)});o.addControl(r.boxDraw)})});var p=function(e){var t=!1,o=r._$dialogDiv.find(r._selectors.BLLIST),i=function(){return o.find('li[data-tc-layer-uid="'+e.id+'"]').length>0},n=e.type===TC.Consts.layerType.WMTS;TC.Util.detectSafari()&&TC.Util.detectIOS()&&(n=n&&TC.Util.isSameOrigin(e.url));if(n&&!i()){t=!0;r.getRenderedHtml(r.CLASS+"-bl-node",e,function(e){i()||o.append(e)})}return t};o.on(TC.Consts.event.LAYERADD,function(e){p(e.layer)}).on(TC.Consts.event.LAYERREMOVE,function(e){e.layer.type===TC.Consts.layerType.WMTS&&r._$dialogDiv.find(r._selectors.BLLIST).find('li[data-tc-layer-uid="'+e.layer.id+'"]').remove()});var c=TC.Util.getQueryStringParams(),u=c[r.MAP_DEFINITION_PARAM_NAME],g=c[r.MAP_EXTENT_PARAM_NAME];o.ready(function(){if(r.mapIsOffline){for(var e=[],t=0,i=r.offlineControls.length;i>t;t++){var n=r.offlineControls[t];n=n.substr(0,1).toUpperCase()+n.substr(1);e=e.concat(o.getControlsByClass("TC.control."+n))}for(var t=0,i=o.controls.length;i>t;t++){var a=o.controls[t];e.indexOf(a)<0&&a.disable()}$(r._selectors.OFFLINEHIDDEN).addClass(TC.Consts.classes.HIDDEN)}});o.loaded(function(){o.putLayerOnTop(r.layer);r._firstRender.then(function(){r._$div.find(r._selectors.NEWBTN).prop("disabled",!1);for(var e=0,t=o.baseLayers.length;t>e;e++)p(o.baseLayers[e])});if(r.mapIsOffline){var e=JSON.parse(window.atob(decodeURIComponent(u))),t=[],i=$.grep(o.baseLayers,function(o){var r=!1;if(o.type===TC.Consts.layerType.WMTS)for(var i=0,n=e.layers.length;n>i;i++){var a=e.layers[i],l=0===o.url.indexOf("//")?location.protocol+o.url:o.url;if(l===e.url[a.urlIdx]&&o.layerNames===a.id&&o.matrixSet===e.tms[a.tmsIdx]){r=!0;break}}r||o.type!==TC.Consts.layerType.VECTOR&&(t[t.length]=o);return r})[0];i&&o.setBaseLayer(i);for(var n=0,l=t.length;l>n;n++)o.removeLayer(t[n]);o.setExtent(a(g))}});r.$events.on(TC.Consts.event.MAPCACHEDOWNLOAD,function(e){r.isDownloading=!1;var t=function(e){var t=e.indexOf("#");return t>=0?e.substr(0,t):e},i=t(e.url),n=_(r,i);if(n.length&&!r.serviceWorkerEnabled){n.removeClass(TC.Consts.classes.DISABLED);n.find(r._selectors.DELBTN).prop("disabled",!1);TC.alert(r.getLocaleString("cb.delete.error"))}else if(r.currentMap&&i===r.currentMap.url){L(r);o.toast(r.getLocaleString("mapDownloaded",{mapName:r.currentMap.name}))}r.currentMap=null;E(r,e.url);l(r)}).on(TC.Consts.event.MAPCACHEDELETE,function(e){r.isDownloading=!1;var t=w(r,e.url)||r.currentMap&&r.currentMap.name;E(r,e.url);r.currentMap=null;if(t){document.cookie=r.COOKIE_KEY_PREFIX+"delete=; expires=Thu, 01 Jan 1970 00:00:01 GMT;";o.toast(r.getLocaleString("mapDeleted",{mapName:t}))}l(r)}).on(TC.Consts.event.MAPCACHEPROGRESS,function(e){var t=e.total;!t&&r.requestSchemas&&(t=r.requestSchemas[0].tileCount);var o=e.loaded;if(o)r._loadedCount=o;else{r._loadedCount+=1;o=r._loadedCount}r.showDownloadProgress(o,t)}).on(TC.Consts.event.MAPCACHEERROR,function(t){r.isDownloading=!1;E(r,t.url);l(r);var o=r.getLocaleString("cb.mapCreation.error"),i=!0;switch(t.reason){case"quota":o+=". "+r.getLocaleString("cb.mapCreation.error.reasonQuota");break;case"resource":o+=". "+r.getLocaleString("cb.mapCreation.error.reasonResource");break;case"manifest":"410"==t.status&&w(r,t.url);i=!1;break;case e:o+=". "+r.getLocaleString("cb.mapCreation.error.reasonAlreadyExists")}if(i)if(TC.Util.detectIE()){TC.error(o);TC.alert(r.getLocaleString("cb.mapCreation.error.reasonIE"))}else TC.alert(o);r.currentMap=null})};n.setExtent=function(e){var t=this;if($.isArray(e)&&e.length>=4){t.extent=e;t.updateRequestSchemas()}};n.cacheUrlList=function(e,t){var o=this,r=t||{};o.createCache(r.name||o.LOCAL_STORAGE_KEY_PREFIX+"common",{urlList:e,silent:r.silent})};n.requestCache=function(e){var t=this,o=e||{};if(t.map){var r=o.extent||t.extent||t.map.getExtent();t.updateRequestSchemas({extent:r});if(t.requestSchemas){for(var i=function(e,o,r){var i=e.res>=t.minResolution;!i&&o>0&&(i=r[o-1].res>t.minResolution);return i},n=function(e){return{mId:e.mId,cl:e.cl,cr:e.cr,rt:e.rt,rb:e.rb}},a=t.requestSchemas.map(function(e){return{layerId:e.layerId,tileMatrixLimits:e.tileMatrixLimits.filter(i)}}),l=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],s=0,p=a.length;p>s;s++){var c=a[s],u=c.tileMatrixLimits[c.tileMatrixLimits.length-1],g=u.res*u.tSize;l[0]=Math.min(l[0],u.origin[0]+g*u.cl);l[1]=Math.min(l[1],u.origin[1]-g*(u.rb+1));l[2]=Math.max(l[2],u.origin[0]+g*(u.cr+1));l[3]=Math.max(l[3],u.origin[1]-g*u.rt);c.tileMatrixLimits=c.tileMatrixLimits.map(n)}var d=Math.pow(10,t.map.wrap.isGeo()?TC.Consts.DEGREE_PRECISION:TC.Consts.METER_PRECISION);l=l.map(function(e,t){var o=3>t?Math.ceil:Math.floor;return o(e*d)/d});for(var h={bBox:l,res:Math.floor(1e3*t.minResolution)/1e3,url:[],tms:[],format:[],layers:new Array(t.baseLayers.length)},s=0,p=t.baseLayers.length;p>s;s++){var f=t.baseLayers[s],y=0===f.url.indexOf("//")?location.protocol+f.url:f.url,v=$.inArray(y,h.url);0>v&&(v=h.url.push(y)-1);var C=$.inArray(f.matrixSet,h.tms);0>C&&(C=h.tms.push(f.matrixSet)-1);var T=f.format.substr(f.format.indexOf("/")+1),_=$.inArray(T,h.format);0>_&&(_=h.format.push(T)-1);h.layers[s]={urlIdx:v,id:f.layerNames,tmsIdx:C,formatIdx:_}}var E=TC.Util.getQueryStringParams(),x=E[t.MAP_EXTENT_PARAM_NAME]=l.toString();E[t.MAP_DEFINITION_PARAM_NAME]=btoa(JSON.stringify(h));t.serviceWorkerEnabled&&(E[t.SERVICE_WORKER_FLAG]=1);var P=location.origin+location.pathname.substr(0,location.pathname.lastIndexOf("/")+1)+t.CACHE_REQUEST_PATH+"?"+$.param(E);t.currentMap={name:o.mapName,extent:x,url:P};t.isDownloading=!0;if(t.serviceWorkerEnabled)for(var s=0,p=a.length;p>s;s++){for(var L=a[s],w=null,R=0,A=t.baseLayers.length;A>R;R++){var b=t.baseLayers[R];if(b.id===L.layerId){w=t.wrap.getGetTilePattern(b);break}}if(w){urlList=[];var M=0;for(k=0,lenk=L.tileMatrixLimits.length;k<lenk;k++){var u=L.tileMatrixLimits[k];for(b=u.cl;b<=u.cr;b++)for(m=u.rt;m<=u.rb;m++)urlList[M++]=w.replace("{TileMatrix}",u.mId).replace("{TileCol}",b).replace("{TileRow}",m)}urlList.push(P);t.cacheUrlList(urlList,{name:P})}}else S(t,P)}}};n.cancelCacheRequest=function(){var e=this;if(e.currentMap){E(e,e.currentMap.url);e.deleteCache(e.currentMap.url).then(function(t){t||(e.currentMap=null)})}e.isDownloading=!1;l(e)};n.deleteMap=function(e){var t=this,o=t.findStoredMap({name:e});if(o){var r=TC.Util.getQueryStringParams(o.url);t.deleteCache(o.url).then(function(e){if(!e){document.cookie=t.COOKIE_KEY_PREFIX+"delete="+atob(decodeURIComponent(r[t.MAP_DEFINITION_PARAM_NAME]));S(t,o.url)}})}};n.findStoredMap=function(e){var t=this;return $.grep(t.storedMaps,function(t){var o=!0;e.name&&e.name!==t.name&&(o=!1);o&&e.url&&e.url!==t.url&&(o=!1);return o})[0]};n.showDownloadProgress=function(e,t){var o=this,r=o._classSelector,i=o._$div.find(r+"-progress-count");if(t){var n=Math.min(Math.round(100*e/t),100),a=n+"%";o._$div.find(r+"-progress-ratio").css("width",a);i.html(a)}else{o._$div.find(r+"-progress-bar").addClass(TC.Consts.classes.HIDDEN);i.html(o.getLocaleString("xFiles",{quantity:e}))}};n.updateRequestSchemas=function(e){var t=this,o=e||{};o.extent=o.extent||t.extent;o.layers=o.layers||t.baseLayers;t.requestSchemas=t.wrap.getRequestSchemas(o);return t.requestSchemas};n.getResolutions=function(){for(var e=this,t=[],o=function(e){return e.res},r=e.requestSchemas.map(function(e){return e.tileMatrixLimits.map(o)}),i=Number.POSITIVE_INFINITY,n=0,a=0,l=r.length;l>a;a++){var s=r[a];i=Math.min(i,s[0]);n=Math.max(n,s[s.length-1])}for(var a=0,l=r.length;l>a;a++)t=t.concat(r[a].filter(function(e){return i>=e&&e>=n&&t.indexOf(e)<0}));t.sort(function(e,t){return t-e});return t}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.Coordinates=function(){var e=this;e.crs="";e.xy=[0,0];e.latLon=[0,0];e.units="m";e.isGeo=!1;TC.Control.apply(e,arguments);e.geoCrs=e.options.geoCrs||TC.Cfg.geoCrs};TC.inherit(TC.control.Coordinates,TC.Control);!function(){var e=TC.control.Coordinates.prototype;e.CLASS="tc-ctl-coords";e.template=TC.isDebug?TC.apiLocation+"TC/templates/Coordinates.html":function(){function t(e,t){return e.w('<div>CRS: <span class="tc-ctl-coords-crs">').f(t.get(["crs"],!1),t,"h").w('</span></div><div class="tc-ctl-coords-xy">').x(t.get(["isGeo"],!1),t,{"else":o,block:r},{}).w("</div>").x(t.get(["showGeo"],!1),t,{block:i},{})}function o(e,t){return e.w('X: <span class="tc-ctl-coords-x">').f(t.get(["x"],!1),t,"h").w('</span> Y: <span class="tc-ctl-coords-y">').f(t.get(["y"],!1),t,"h").w("</span>")}function r(e,t){return e.h("i18n",t,{},{$key:"lat"}).w(': <span class="tc-ctl-coords-lat">').f(t.get(["lat"],!1),t,"h").w("</span> ").h("i18n",t,{},{$key:"lon"}).w(': <span class="tc-ctl-coords-lon">').f(t.get(["lon"],!1),t,"h").w("</span>")}function i(e,t){return e.w('<div class="tc-ctl-coords-alt">CRS: <span class="tc-ctl-coords-geocrs">').f(t.get(["geoCrs"],!1),t,"h").w('</span></div><div class="tc-ctl-coords-xy">').h("i18n",t,{},{$key:"lat"}).w(': <span class="tc-ctl-coords-lat">').f(t.get(["lat"],!1),t,"h").w("</span> ").h("i18n",t,{},{$key:"lon"}).w(': <span class="tc-ctl-coords-lon">').f(t.get(["lon"],!1),t,"h").w("</span></div>")}dust.register(e.CLASS,t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;return t};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);t.crs=t.map.crs;t.wrap||(t.wrap=new TC.wrap.control.Coordinates(t));t.clear();e.loaded(function(){t.wrap.register(e).then(function(){t.render(function(){t.update();t.clear()})});if(TC.Util.detectMobile()){$.when(e.addLayer({id:TC.getUID(),type:TC.Consts.layerType.VECTOR,stealth:!0,title:"Coordenadas"})).then(function(e){t.layer=e});t.activateCoords()}})};e.render=function(e){var t=this;t.renderData({x:t.xy[0],y:t.xy[1],lat:t.latLon[0],lon:t.latLon[1],crs:t.crs,geoCrs:t.geoCrs,isGeo:t.isGeo,showGeo:t.options.showGeo},function(){t.$crs=t._$div.find("."+t.CLASS+"-crs");t.$geoCrs=t._$div.find("."+t.CLASS+"-geocrs");t.$x=t._$div.find("."+t.CLASS+"-x");t.$y=t._$div.find("."+t.CLASS+"-y");t.$lat=t._$div.find("."+t.CLASS+"-lat");t.$lon=t._$div.find("."+t.CLASS+"-lon");$.isFunction(e)&&e()})};e.formatCoord=function(e,t){var o;o=e.toFixed(t);3>=t&&(o=o.replace(/\B(?=(\d{3})+(?!\d))/g,"|"));o=o.replace(".",",").replace(/\|/g,".");return o};e.update=function(){var e=this;e.renderPromise().then(function(){if(e.$crs){!e.isGeo&&e.options.showGeo&&(e.latLon=TC.Util.reproject(e.xy,e.crs,e.geoCrs).reverse());e.$crs.text(e.crs);e.$geoCrs.text(e.geoCrs);if(!e.isGeo){e.$x.text(e.formatCoord(e.xy[0],TC.Consts.METER_PRECISION));e.$y.text(e.formatCoord(e.xy[1],TC.Consts.METER_PRECISION))}if(e.isGeo||e.options.showGeo){e.$lat.text(e.formatCoord(e.latLon[0],TC.Consts.DEGREE_PRECISION));e.$lon.text(e.formatCoord(e.latLon[1],TC.Consts.DEGREE_PRECISION))}TC.Util.detectMobile()||e._$div.removeClass(TC.Consts.classes.HIDDEN)}})};e.clear=function(){var e=this;TC.Util.detectMobile()||e._$div.addClass(TC.Consts.classes.HIDDEN)};e.deactivateCoords=function(){var e=this;e._$div.toggleClass(TC.Consts.classes.HIDDEN,!0);e.clear();e.wrap.coordsDeactivate();e.cleanCoordsPointer()};e.cleanCoordsPointer=function(){var e=this;delete e.currentCoordsMarker;$.when(e.getLayer()).then(function(e){e&&e.clearFeatures()})};e.activateCoords=function(){var e=this;e.wrap.coordsActivate()};e.getCoords=function(){var e=this,t=e.map.getControlsByClass(TC.control.Popup);if(t&&t.length>0&&t[0].isVisible())e.coordsToPopup(t[0]);else{e.updateCoordsCtrl([(e.map.getExtent()[0]+e.map.getExtent()[2])/2,(e.map.getExtent()[1]+e.map.getExtent()[3])/2]);e.coordsToClick.call(e,{coordinate:e.xy})}};e.coordsToPopup=function(e){var t=this;e&&t.updateCoordsCtrl(e.wrap.popup.getPosition())};e.updateCoordsCtrl=function(e){var t=this;if(e){t.x=e[0];t.y=e[1];t.xy=[t.x,t.y];t.update()}};var t,o;e.coordsToClick=function(e){var r=this;if(!$(r.map._$div).hasClass("tc-ctl-sv-active tc-collapsed")){$(r._$div).stop(!0,!0);t&&clearTimeout(t);if(0==r._$div.find("span.close").length){o=r._$div.append('<span class="close"></span>');$(o).click(function(){r._$div.toggleClass(TC.Consts.classes.HIDDEN,!0);r.clear();r.cleanCoordsPointer()})}r.updateCoordsCtrl(e.coordinate);r.coordsMarkerAdd(e.coordinate);r._$div.removeClass(TC.Consts.classes.HIDDEN);t=setTimeout(function(){$(r._$div).animate({opacity:0},3e3,"linear",function(){$(r._$div).css({opacity:.7});r._$div.toggleClass(TC.Consts.classes.HIDDEN,!0);r.clear();r.cleanCoordsPointer()})},5e3)}};e.coordsMarkerAdd=function(e){var t=this;t.currentCoordsMarker?t.currentCoordsMarker.setCoords(e):$.when(t.getLayer()).then(function(o){o&&$.when(o.addMarker(e,{title:"Coord",showsPopup:!1,cssClass:TC.Consts.classes.POINT,anchor:[.5,.5]})).then(function(e){t.currentCoordsMarker=e})})};e.getLayer=function(){var e=this,t=new $.Deferred;void 0==e.layer?$.when(e.map.addLayer({id:TC.getUID(),type:TC.Consts.layerType.VECTOR,stealth:!0,title:"Coordenadas"})).then(function(o){e.layer=o;e.layer.map.putLayerOnTop(e.layer);t.resolve(e.layer)}):t.resolve(e.layer);return t}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.Download=function(e){var t=this;t._classSelector="."+t.CLASS;TC.Control.apply(t,arguments);var o=e||{};t._$dialogDiv=$(TC.Util.getDiv(o.dialogDiv));o.dialogDiv||t._$dialogDiv.appendTo("body")};TC.inherit(TC.control.Download,TC.Control);!function(){var e=TC.control.Download.prototype;e.CLASS="tc-ctl-download";e.template={};if(TC.isDebug){e.template[e.CLASS]=TC.apiLocation+"TC/templates/Download.html";e.template[e.CLASS+"-dialog"]=TC.apiLocation+"TC/templates/DownloadDialog.html"}else{e.template[e.CLASS]=function(){function t(e,t){return e.w("<h2>").h("i18n",t,{},{$key:"download"}).w(' <span class="tc-beta">').h("i18n",t,{},{$key:"beta"}).w('</span> </h2><div class="tc-ctl-sctnr tc-ctl-sctnr-select"><form><label class="tc-ctl-sctnr-tab tc-ctl-download-image" style="width:calc(100%/2 - 1px)"><input type="radio" name="sctnr-sel" value="image" /><span>').h("i18n",t,{},{$key:"dl.export.map"}).w('</span></label><label class="tc-ctl-sctnr-tab tc-ctl-download-data" style="width:calc(100%/2 - 1px)"><input type="radio" name="sctnr-sel" value="data" /><span>').h("i18n",t,{},{$key:"dl.export.vector"}).w('</span></label></form></div><div class="tc-ctl tc-ctl-sctnr-elm tc-ctl-sctnr-elm-image tc-group tc-ctl-download-cnt tc-ctl-download-image tc-hidden"><label>').h("i18n",t,{},{$key:"format"}).w(':</label><select id="download-format-image" class="tc-combo"><option value="image/png">PNG</option><option value="image/jpeg">JPEG</option></select><div class="tc-ctl-download-div"><input id="tc-ctl-download-image-qr" class="tc-hidden" type="checkbox" checked style="display:none;" /><label for="tc-ctl-download-image-qr" class="tc-ctl-download-image-qr-label" title="').h("i18n",t,{},{$key:"createQrCodeToImage"}).w('">').h("i18n",t,{},{$key:"appendQRCode"}).w('</label></div><div class="tc-group tc-group tc-ctl-download-cnt" style="text-align:right;"><button type="button" class="tc-ctl-download-btn tc-button tc-icon-button" title="').h("i18n",t,{},{$key:"downloadImageFromCurrentMap"}).w('" name="descargar">').h("i18n",t,{},{$key:"download"}).w('</button></div></div><div class="tc-ctl tc-ctl-sctnr-elm tc-ctl-sctnr-elm-data tc-group tc-ctl-download-cnt tc-hidden"><label>').h("i18n",t,{},{$key:"format"}).w(':</label><select id="download-format" class="tc-combo"><option value="GML32">GML</option><option value="application/json">GeoJSON</option><option value="application/vnd.google-earth.kml+xml">KML (Google Earth)</option><option value="shape-zip">Shape (ESRI)</option></select><div class="tc-ctl-download-div"><i class="tc-ctl-download-help icon-question-sign" data-toggle="tooltip" data-placement="top" title="').h("i18n",t,{},{$key:"showDownloadHelp"}).w('"></i></div><div class="tc-group tc-group tc-ctl-download-cnt" style="text-align:right;"><button type="button" class="tc-ctl-download-btn tc-button tc-icon-button" title="').h("i18n",t,{},{$key:"downloadLayersFromCurrentExtent"}).w('" name="descargar">').h("i18n",t,{},{$key:"download"}).w('</button></div><div class="tc-alert alert-warning tc-hidden"><p id="zoom-msg"><strong>').h("i18n",t,{},{$key:"tooManyFeatures"}).w(": </strong>").h("i18n",t,{},{$key:"tooManyFeatures.instructions"}).w('</p><p id="layers-msg"><strong>').h("i18n",t,{},{$key:"noLayersLoaded"}).w(": </strong>").h("i18n",t,{},{$key:"noLayersLoaded.instructions"}).w('</p><p id="url-msg"><strong>').h("i18n",t,{},{$key:"tooManySelectedLayers"}).w(": </strong>").h("i18n",t,{},{$key:"tooManySelectedLayers.instructions"}).w('</p><p id="noFeatures-msg"><strong>').h("i18n",t,{},{$key:"noData"}).w(": </strong>").h("i18n",t,{},{$key:"noData.instructions"}).w('</p><p id="novalid-msg"><strong>').h("i18n",t,{},{$key:"noValidService"}).w(": </strong>").h("i18n",t,{},{$key:"noValidService.instructions"}).w("</p></div></div>")}dust.register(e.CLASS,t);t.__dustBody=!0;return t};e.template[e.CLASS+"-dialog"]=function(){function t(e,t){return e.w(' <div class="tc-ctl-download-help-dialog tc-modal"><div class="tc-modal-background tc-modal-close"></div><div class="tc-modal-window"><div class="tc-modal-header"><h3>').h("i18n",t,{},{$key:"downloadData"}).w('</h3><div class="tc-ctl-popup-close tc-modal-close"></div></div><div class="tc-modal-body"><p>').h("i18n",t,{},{$key:"dl.instructions.1|s"}).w("</p><ul><li>").h("i18n",t,{},{$key:"dl.instructions.2|s"}).w("</li><li>").h("i18n",t,{},{$key:"dl.instructions.3|s"}).w("</li><li>").h("i18n",t,{},{$key:"dl.instructions.4|s"}).w("<ul><li>").h("i18n",t,{},{$key:"dl.instructions.5|s"}).w("</li><li>").h("i18n",t,{},{$key:"dl.instructions.6|s"}).w('</li></ul></li></ul></div><div class="tc-modal-footer"><button type="button" class="tc-button tc-modal-close">').h("i18n",t,{},{$key:"close"}).w("</button></div></div></div>")}dust.register(e.CLASS+"-dialog",t);t.__dustBody=!0;return t}}e.render=function(e){var t=this;t.getRenderedHtml(t.CLASS+"-dialog",null,function(e){t._$dialogDiv.html(e)}).then(function(){TC.Control.prototype.render.call(t,function(){var o=(t.CLASS+"-seldisabled",".tc-ctl-sctnr");t._selectors={TAB:o+"-tab",RADIOBUTTON:"input[type=radio][name=sctnr-sel]",ELEMENT:o+"-elm"};var r=function(e){var o=$(this).closest(t._selectors.TAB).find(t._selectors.RADIOBUTTON),r=o.val(),i=t._$div.find(t._selectors.ELEMENT);if(t._oldValue===r&&t.options.deselectable){setTimeout(function(){o.prop("checked",!1)},0);t._oldValue=null;$active=$();$hidden=i}else{$active=i.filter(t._selectors.ELEMENT+"-"+r);$hidden=i.not($active);t._oldValue=r}$active.removeClass(TC.Consts.classes.HIDDEN);$hidden.addClass(TC.Consts.classes.HIDDEN);o.prop("checked",!0)};t._$div.find("span").on(TC.Consts.event.CLICK,r);e&&e()})})};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);var o=function(){var e=window.location.href,t=e.indexOf("?"),o=e.indexOf("#");t>0&&(e=o>t?e.replace(e.substring(t,o),""):e.replace(e.substring(t,e.length-1),""));return e},r=function(e){var t=$.Deferred(),o=150;e?TC.loadJS("undefined"==typeof QRCode,[TC.apiLocation+"lib/qrcode/qrcode.min.js"],function(){e.length>o&&(e=TC.Util.shortenUrl(e));$("body").append('<div id="qrcode"></div>');{var r=$("#qrcode");new QRCode(r.get(0),{text:e,width:85,height:85})}setTimeout(function(){var e=r.find("img").attr("src");r.remove();t.resolve(e)},100)}):t.resolve(imgBase64);return t.promise()},i=function(){var e=t.map.getLoadingIndicator().addWait(),i=$active.find("select").val();if($active.find("select").val().indexOf("image")>-1){var l,s=$.Deferred(),p=t.map.wrap.getViewport({synchronous:!0}).getElementsByTagName("canvas")[0],c=TC.Util.cloneCanvas(p),u=t.map.getControlsByClass(TC.control.ScaleBar);if(0==u.length){u=new TC.control.ScaleBar;u.register(t.map);u.render()}if(u){var g=c.getContext("2d");g.save();var d=document.getElementsByClassName("ol-scale-line-inner"),h=d.item(0),f=$.extend({},h.getBoundingClientRect());d=document.getElementsByClassName(u[0].CLASS);var y=d.item(0),m=$.extend({},y.getBoundingClientRect()),v=h.textContent;g.beginPath();g.strokeStyle=window.getComputedStyle(h).borderColor;var C,T;if(f.width>f.height){C=f.width;T=f.height}else{C=f.height;T=f.width}m.left=f.left=15;m.left=m.left-2;m.top=f.top=15;m.top--;g.moveTo(f.left,f.top);g.lineTo(f.left,f.top+T);g.lineTo(f.left+C,f.top+T);g.lineTo(f.left+C,f.top);g.stroke();var _=(g.measureText(v),{x:f.left+C/2,y:f.top+T/2});g.globalAlpha=.5;g.fillStyle=window.getComputedStyle(y).backgroundColor;C+=4;T+=4;g.fillRect(m.left,m.top,C,T);g.globalAlpha=1;g.fillStyle=window.getComputedStyle(h).color;g.font=window.getComputedStyle(h).fontSize+" "+window.getComputedStyle(h).fontFamily;g.textAlign="center";g.textBaseline="middle";g.fillText(v,_.x,_.y)}$active.find("#tc-ctl-download-image-qr:checked").length>0?$.when(r(o())).then(function(o){if(o){var r=c.getContext("2d");r.fillStyle="#ffffff";r.fillRect(c.width-91,c.height-91,91,91);$.when(TC.Util.addToCanvas(c,o,{x:c.width-88,y:c.height-88})).then(function(e){s.resolve(e)})}else{TC.error(t.getLocaleString("dl.export.map.error")+": QR");t.map.getLoadingIndicator().removeWait(e)}}):s.resolve(c);$.when(s).then(function(o){try{l=o.toDataURL(i);TC.Util.downloadDataURI(window.location.hostname+"_"+TC.Util.getFormattedDate((new Date).toString(),!0)+"."+i.split("/")[1],i,l)}catch(r){TC.error(t.getLocaleString("dl.export.map.error")+": "+r.message)}t.map.getLoadingIndicator().removeWait(e)})}else{var S=(n(),t.map.getExtent()),E=TC.WFSGetFeatureBuilder(t.map,S,i,!0);$.when.apply($,E).then(function(){var o=$.grep(arguments,function(e){return null!=e});if(0!==o.length){for(var r=[],i=0;i<o.length;i++)if(o[i].err)switch(o[i].err){case"NumMaxFeatures":a({zoom:!0,serviceName:o[i].service.mapLayer.title},e);break;case"NameResolutionFailure":a({noValid:!0,serviceName:o[i].service.mapLayer.title},e);break;default:a({noValid:!0,serviceName:o[i].service.mapLayer.title},e)}else{var n=o[i].data,l=o[i].url;n&&l&&r.push({url:l+"?download=zip",data:n})}TC.Util.downloadFileForm(r);t.map.getLoadingIndicator().removeWait(e)}else a({layers:!0},e)})}},n=function(){for(var e=[],o=0;o<t.map.workLayers.length;o++){var r=t.map.workLayers[o];r.type===TC.Consts.layerType.WMS&&r.getVisibility()&&r.names.length>0&&e.push(r)}return e},a=function(e,o){var r,i=t._$div.find(".alert-warning");e.zoom?r=i.find("#zoom-msg").html().format({serviceName:e.serviceName}):e.layers?r=t.getLocaleString("noLayersLoaded"):e.url?r=t.getLocaleString("tooManySelectedLayers"):e.noFeatures?r=i.find("#noFeatures-msg").html():e.noValid&&(r=i.find("#novalid-msg").html().format({serviceName:e.serviceName}));t.map.toast(r,{type:TC.Consts.msgType.WARNING});t.map.getLoadingIndicator().removeWait(o)},l=function(e){e.stopPropagation();TC.Util.showModal(t._$dialogDiv.find(t._classSelector+"-help-dialog"))};t._$div.on(TC.Consts.event.CLICK,".tc-ctl-download-btn",i);t._$div.on(TC.Consts.event.CLICK,".tc-ctl-download-help",l)}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.Feature&&TC.feature.Point||TC.syncLoadJS(TC.apiLocation+"TC/feature/Point");TC.Feature&&TC.feature.Polyline||TC.syncLoadJS(TC.apiLocation+"TC/feature/Polyline");TC.Feature&&TC.feature.Polygon||TC.syncLoadJS(TC.apiLocation+"TC/feature/Polygon");TC.Consts.event.DRAWSTART="drawstart.tc";TC.Consts.event.DRAWEND="drawend.tc";TC.Consts.event.DRAWCANCEL="drawcancel.tc";TC.Consts.event.MEASURE="measure.tc";TC.Consts.event.MEASUREPARTIAL="measurepartial.tc";!function(){TC.control.Draw=function(){var e=this;TC.Control.apply(e,arguments);e._classSelector="."+e.CLASS;e._pointClass=e.CLASS+"-point";e._lineClass=e.CLASS+"-line";e._polygonClass=e.CLASS+"-polygon";e.history=[];e.historyIndex=0;this.renderPromise().then(function(){e.reset=!0;e.callBack=null;e.measure=!1;e._cancelClick=!1;e.mode=e.options.mode||TC.Consts.geom.POLYLINE;e.options.measure&&(e.measure=e.options.measure);$.isFunction(e.options.callback)&&(e.callBack=e.options.callback);e.wrap=new TC.wrap.control.Draw(e);e._$newBtn=e._$div.find(e._classSelector+"-btn-new").on(TC.Consts.event.CLICK,function(){e["new"]()});e._$cancelBtn=e._$div.find(e._classSelector+"-btn-cancel").on(TC.Consts.event.CLICK,function(){e.cancel()});e._$endBtn=e._$div.find(e._classSelector+"-btn-end").on(TC.Consts.event.CLICK,function(){e.end()});e._$undoBtn=e._$div.find(e._classSelector+"-btn-undo").on(TC.Consts.event.CLICK,function(){e.undo()});e._$redoBtn=e._$div.find(e._classSelector+"-btn-redo").on(TC.Consts.event.CLICK,function(){e.redo()});e.$events.on(TC.Consts.event.MEASURE,function(t){e.resetValues()});e.$events.on(TC.Consts.event.POINT,function(o){if(e.layer&&e.layer.features&&e.layer.features.length>0){e.layer.clearFeatures();e.resetValues()}e.history.length=e.historyIndex;e.history[e.historyIndex++]=o.point;t(e)});e.$events.on(TC.Consts.event.DRAWEND,function(t){o(e);e.callBack&&e.callBack(t.geometry)})})};TC.inherit(TC.control.Draw,TC.Control);var e=TC.control.Draw.prototype;e.CLASS="tc-ctl-draw";var t=function(e){e._$endBtn.prop("disabled",0===e.historyIndex||e.mode===TC.Consts.geom.POLYGON&&e.historyIndex<3||e.mode===TC.Consts.geom.POLYLINE&&e.historyIndex<2);e._$redoBtn.prop("disabled",e.history.length===e.historyIndex);

e._$undoBtn.prop("disabled",0===e.historyIndex)},o=function(e){e.resetValues();e._$endBtn.prop("disabled",!0);e._$cancelBtn.prop("disabled",!1)};e.template=TC.isDebug?TC.apiLocation+"TC/templates/Draw.html":function(){function t(e,t){return e.w(' <button class="tc-ctl-btn tc-ctl-draw-btn-new" title="').f(t.get(["tooltip"],!1),t,"h").w('">').h("i18n",t,{},{$key:"new"}).w('</button><button class="tc-ctl-btn tc-ctl-draw-btn-undo" disabled title="').h("i18n",t,{},{$key:"undo"}).w('">').h("i18n",t,{},{$key:"undo"}).w('</button><button class="tc-ctl-btn tc-ctl-draw-btn-redo" disabled title="').h("i18n",t,{},{$key:"redo"}).w('">').h("i18n",t,{},{$key:"redo"}).w('</button><button class="tc-ctl-btn tc-ctl-draw-btn-end" title="').h("i18n",t,{},{$key:"end"}).w('">').h("i18n",t,{},{$key:"end"}).w('</button><button class="tc-ctl-btn tc-ctl-draw-btn-cancel" title="').h("i18n",t,{},{$key:"cancel"}).w('">').h("i18n",t,{},{$key:"cancel"}).w("</button> ")}dust.register(e.CLASS,t);t.__dustBody=!0;return t};e.render=function(e){var t,o=this;switch(o.options.mode){case TC.Consts.geom.POLYLINE:case TC.Consts.geom.MULTIPOLYLINE:t=o.getLocaleString("drawLine");o._$div.addClass(o._lineClass);break;case TC.Consts.geom.POLYGON:case TC.Consts.geom.MULTIPOLYGON:t=o.getLocaleString("drawPolygon");o._$div.addClass(o._polygonClass);break;case TC.Consts.geom.POINT:case TC.Consts.geom.MULTIPOINT:t=o.getLocaleString("draw");o._$div.addClass(o._pointClass);break;default:t=o.getLocaleString("draw")}o.renderData({tooltip:t},function(){$.isFunction(e)&&e()})};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);e.loaded(function(){t.options.layer?t.setLayer(t.options.layer):"boolean"!=typeof t.options.layer&&e.loaded(function(){t.layerPromise=e.addLayer({id:TC.getUID(),title:"DrawControl",stealth:!0,type:TC.Consts.layerType.VECTOR,styles:{point:$.extend({},e.options.styles.point,{fillOpacity:0}),line:e.options.styles.line,polygon:e.options.styles.polygon}});$.when(t.layerPromise).then(function(o){t.layer=o;e.putLayerOnTop(t.layer)})})})};e["new"]=function(){var e=this;e.layer&&e.layer.clearFeatures();e.setMode(e.mode,!0)};e.undo=function(){var e=this,o=e.wrap.undo();if(o){e.historyIndex--;t(e);e.historyIndex<=0&&e.resetValues()}return o};e.redo=function(){var e=this,o=this.wrap.redo();if(o){e.historyIndex++;t(e)}return o};e.cancel=function(){var e=this;e._cancelClick=!0;this.setMode(null,!1);e.resetValues();o(e);e.$events.trigger($.Event(TC.Consts.event.DRAWCANCEL,{ctrl:e}))};e.activate=function(){var e=this;e._$newBtn.addClass(TC.Consts.classes.ACTIVE);TC.Control.prototype.activate.call(e);e.wrap.activate(e.mode);e._$div.removeClass(e._pointClass).removeClass(e._lineClass).removeClass(e._polygonClass);switch(e.mode){case TC.Consts.geom.POINT:e._$div.addClass(e._pointClass);break;case TC.Consts.geom.POLYLINE:e._$div.addClass(e._lineClass);break;case TC.Consts.geom.POLYGON:e._$div.addClass(e._polygonClass)}};e.deactivate=function(){var e=this;e._$newBtn&&e._$newBtn.removeClass(TC.Consts.classes.ACTIVE);TC.Control.prototype.deactivate.call(e,!e._cancelClick);e.wrap&&e.wrap.deactivate();e.resetValues();e._cancelClick=!1};e.isExclusive=function(){return!0};e.end=function(){var e=this;e.wrap.end();e.resetValues()};e.setMode=function(e,t){var o=this;e&&(o.mode=e);if(t&&e){o.layer&&o.layer.map.putLayerOnTop(o.layer);o.activate()}else o.deactivate();var r=t?TC.Consts.event.CONTROLACTIVATE:TC.Consts.event.CONTROLDEACTIVATE;o.map&&o.map.$events.trigger($.Event(r,{control:o}))};e.getLayer=function(){var e=this;return e.options&&"boolean"==typeof e.options.layer&&!e.options.layer?null:e.layer?e.layer:e.layerPromise};e.setLayer=function(e){var t=this;t.map&&(t.layer="string"==typeof e?t.map.getLayer(e):e)};e.resetValues=function(){var e=this;e.history.length=0;e.historyIndex=0;t(e)}}();TC.control=TC.control||{};TC.control.SWCacheClient||TC.syncLoadJS(TC.apiLocation+"TC/control/SWCacheClient");TC.Consts.editMode={SELECT:"select",ADDPOINT:"addpoint",ADDLINE:"addline",ADDPOLYGON:"addpolygon"};TC.Consts.editStyles={NEW:"temporary",SELECTED:"select",DEFAULT:"default"};TC.Consts.event.POINT="point.tc";TC.Consts.event.BEFOREFEATUREMODIFY="beforefeaturemodify.tc";TC.Consts.event.FEATUREMODIFY="featuremodify.tc";TC.Consts.event.FEATURESSELECT="featureselect.tc";TC.Consts.event.FEATURESUNSELECT="featureunselect.tc";!function(){var e=0,t=function(){return"NewFeature."+e++},o=function(e,t){var o=$.Deferred();TC.loadJS(!window.localforage,[TC.Consts.url.LOCALFORAGE],function(){var r,i;switch(!0){case t instanceof TC.feature.Polygon:i=TC.Consts.geom.POLYGON;break;case t instanceof TC.feature.Polyline:i=TC.Consts.geom.POLYLINE;break;case t instanceof TC.feature.Point:i=TC.Consts.geom.POINT;break;case t instanceof TC.feature.MultiPolygon:i=TC.Consts.geom.MULTIPOLYGON;break;case t instanceof TC.feature.MultiPolyline:i=TC.Consts.geom.MULTIPOLYLINE}r={id:t.id||t.provId,attributes:t.data,type:i,geometry:t.geometry};localforage.setItem(e,r).then(function(){o.resolve({feature:t})})["catch"](function(e){o.reject({feature:t,error:e})})});return o.promise()},r=function(e){var t=$.Deferred();TC.loadJS(!window.localforage,[TC.Consts.url.LOCALFORAGE],function(){localforage.removeItem(e).then(function(){t.resolve(e)})["catch"](function(e){t.reject(e)})});return t.promise()},i=function(e){var t=$.Deferred();TC.loadJS(!window.localforage,[TC.Consts.url.LOCALFORAGE],function(){localforage.getItem(e).then(function(o){t.resolve({key:e,feature:o})})["catch"](function(e){t.reject(e)})});return t.promise()},n=function(e,t){return e.LOCAL_STORAGE_KEY_PREFIX+(t||e.layer.id)},a=function(e,t){return n(e,t)+e.LOCAL_STORAGE_ADDED_KEY_PREFIX},l=function(e,t){return n(e,t)+e.LOCAL_STORAGE_MODIFIED_KEY_PREFIX},s=function(e,t){return n(e,t)+e.LOCAL_STORAGE_REMOVED_KEY_PREFIX},p=function(e){e._$deleteBtn.prop("disabled",!0);e._$joinBtn.prop("disabled",!0);e._$splitBtn.prop("disabled",!0)},c=function(e){var t=!1;(TC.feature.MultiPolygon&&e instanceof TC.feature.MultiPolygon||TC.feature.MultiPolyline&&e instanceof TC.feature.MultiPolyline)&&e.geometry.length>1&&(t=!0);return t},u=function(e,t){e._$deleteBtn.prop("disabled",0===t.length);e._$joinBtn.prop("disabled",t.length<2);e._$splitBtn.prop("disabled",0===t.filter(c).length)},g=function(e,t){e._$saveBtn.prop("disabled",t);e._$discardBtn.prop("disabled",t);self.checkedOut=!t},d=function(e,t){"undefined"!=typeof t?g(e,!t):TC.loadJS(!window.localforage,[TC.Consts.url.LOCALFORAGE],function(){var t=n(e);localforage.keys().then(function(o){if(o){for(var r=!0,i=0,n=o.length;n>i;i++)if(0===o[i].indexOf(t)){r=!1;break}g(e,r)}})})},h=function(e,t){var o=$.Deferred(),r=e._changesLayers[t.id];if(r)o.resolve(r);else{r=e._changesLayers[t.id]=new TC.layer.Vector({id:TC.getUID(),title:t.title+" - cambios pendientes",stealth:!0,styles:e.getChangesLayerStyle(t)});var i=e.map.layers.indexOf(t);e.map.insertLayer(r,i+1,function(){o.resolve(r)})}return o.promise()};TC.control.Edit=function(){var e=this;TC.control.SWCacheClient.apply(this,arguments);e._classSelector="."+e.CLASS;e.$events=$(e);e.wrap=new TC.wrap.control.Edit(e);e._layerDeferred=$.Deferred();e.layer=null;e.checkedOut=!1;e.callback=arguments[2]&&$.isFunction(arguments[2])?arguments[2]:e.options.callback?e.options.callback:null;e.multi=e.options.multi?e.options.multi:!1;e.eraseActionConfirmTxt=e.options.eraseText?e.options.eraseText:"\xbfEst\xe1 seguro de eliminar esta(s) geometr\xeda(s)?";e.cancelActionConfirmTxt=e.options.cancelText?e.options.eraseText:"Si continua todos los cambios se perder\xe1n. \xbfDesea continuar?";e.styles=e.options.styles;e.features={};e.attributeEditor=null;e.pointDraw=null;e.lineDraw=null;e.polygonDraw=null;e.snapping="boolean"==typeof e.options.snapping?e.options.snapping:!0;e._changesLayers={};e._showsChanges="boolean"==typeof e.options.showChanges?e.options.showChanges:!0;$.isFunction(e.options.getChangesLayerStyleFunction)&&(e.getChangesLayerStyleFunction=e.getChangesLayerStyle);e.$events.on(TC.Consts.event.FEATUREADD,function(r){var i=r.feature;i.provId=t();var n=e._changesLayers[e.layer.id];e.features[e.layer.id].added.push(i);n.addFeature(i);o(a(e)+i.provId,i).then(function(){d(e,!0);TC.toast("Adici\xf3n guardada")},function(){TC.error("Fallo al guardar adici\xf3n")})}).on(TC.Consts.event.FEATUREREMOVE,function(t){var i=t.feature,n=i.provId||i.id,p=function(){d(e);TC.toast("Eliminaci\xf3n guardada")},c=function(){TC.error("Fallo al guardar eliminaci\xf3n")},u=e._changesLayers[e.layer.id],g=e.features[e.layer.id],h=g.added.indexOf(i);if(0>h){var f=s(e);h=g.modified.indexOf(i);if(0>h){h=g.removed.indexOf(i);if(0>h){g.removed.push(i);u.addFeature(i);o(f+i.id,i).then(p,c)}}else{g.modified.splice(h,1);g.removed.push(i);r(l(e)+i.id).then(function(){p();o(f+i.id,i).then(p,c)},c)}}else{u.removeFeature(i);g.added.splice(h,1);r(a(e)+n).then(p,c)}}).on(TC.Consts.event.FEATUREMODIFY,function(t){var r=t.feature,i=r.provId||r.id,n=function(){d(e,!0);TC.toast("Modificaci\xf3n guardada")},s=function(){TC.error("Fallo al guardar modificaci\xf3n")},p=e._changesLayers[e.layer.id],c=e.features[e.layer.id],u=c.added.indexOf(r);if(0>u){u=c.modified.indexOf(r);if(0>u){p.addFeature(r);c.modified.push(r)}o(l(e)+i,r).then(n,s)}else o(a(e)+i,r).then(n,s)}).on(TC.Consts.event.FEATUREADD+" "+TC.Consts.event.FEATUREREMOVE+" "+TC.Consts.event.FEATUREMODIFY,function(t){if(e.serviceWorkerEnabled&&navigator.onLine){var o=e.layer.wrap.getGetFeatureUrl(),r=e.layer.wrap.getDescribeFeatureTypeUrl();o&&r&&e.createCache(e.LOCAL_STORAGE_KEY_PREFIX+e.layer.id,{urlList:[o,r]})}}).on(TC.Consts.event.CONTROLDEACTIVATE,function(e){}).on(TC.Consts.event.FEATURESSELECT,function(t){var o=e.getSelectedFeatures();u(e,o);o.length&&o[0].showPopup(e.attributeEditor)}).on(TC.Consts.event.FEATURESUNSELECT,function(t){u(e,e.getSelectedFeatures())})};TC.inherit(TC.control.Edit,TC.control.SWCacheClient);var f=TC.control.Edit.prototype;f.CLASS="tc-ctl-edit";f.LOCAL_STORAGE_KEY_PREFIX="TC.offline.edit.";f.LOCAL_STORAGE_ADDED_KEY_PREFIX=".added.";f.LOCAL_STORAGE_MODIFIED_KEY_PREFIX=".modified.";f.LOCAL_STORAGE_REMOVED_KEY_PREFIX=".removed.";f.template={};if(TC.isDebug){f.template[f.CLASS]=TC.apiLocation+"TC/templates/Edit.html";f.template[f.CLASS+"-attr"]=TC.apiLocation+"TC/templates/EditAttributes.html"}else{f.template[f.CLASS]=function(){function e(e,r){return e.w("<h2>").h("i18n",r,{},{$key:"featureEdit"}).w(' <span class="tc-beta">').h("i18n",r,{},{$key:"beta"}).w('</span></h2><div class="tc-ctl-edit-layer"><select class="tc-combo tc-ctl-edit-layer-sel"><option value="">').h("i18n",r,{},{$key:"selectLayerToEdit"}).w("</option>").s(r.get(["layers"],!1),r,{block:t},{}).w('</select><input type="checkbox" id="tc-ctl-edit-view-changes-cb"').x(r.get(["showChanges"],!1),r,{block:o},{}).w(' /><label class="tc-ctl-edit-view-changes" for="tc-ctl-edit-view-changes-cb">').h("i18n",r,{},{$key:"highlightUnsyncedChanges"}).w('</label></div><div class="tc-ctl-edit-mode"><form><label class="tc-ctl-edit-btn-select" title="').h("i18n",r,{},{$key:"select"}).w('"><input type="radio" name="mode" value="select" /><span>').h("i18n",r,{},{$key:"select"}).w('</span></label><label class="tc-ctl-edit-btn-point" title="').h("i18n",r,{},{$key:"newPoint"}).w('"><input type="radio" name="mode" value="addpoint" /><span>').h("i18n",r,{},{$key:"newPoint"}).w('</span></label><label class="tc-ctl-edit-btn-line" title="').h("i18n",r,{},{$key:"newLine"}).w('"><input type="radio" name="mode" value="addline" /><span>').h("i18n",r,{},{$key:"newLine"}).w('</span></label><label class="tc-ctl-edit-btn-polygon" title="').h("i18n",r,{},{$key:"newPolygon"}).w('"><input type="radio" name="mode" value="addpolygon" /><span>').h("i18n",r,{},{$key:"newPolygon"}).w('</span></label></form></div><div class="tc-ctl-edit-select tc-hidden"><button class="tc-ctl-btn tc-ctl-edit-btn-delete" disabled title="').h("i18n",r,{},{$key:"delete"}).w('">').h("i18n",r,{},{$key:"delete"}).w('</button><button class="tc-ctl-btn tc-ctl-edit-btn-join" disabled title="').h("i18n",r,{},{$key:"joinGeometries.tooltip"}).w('">').h("i18n",r,{},{$key:"joinGeometries"}).w('</button><button class="tc-ctl-btn tc-ctl-edit-btn-split" disabled title="').h("i18n",r,{},{$key:"splitGeometry"}).w('">').h("i18n",r,{},{$key:"splitGeometry"}).w('</button><button class="tc-ctl-btn tc-ctl-edit-btn-cancel" disabled title="').h("i18n",r,{},{$key:"cancel"}).w('">').h("i18n",r,{},{$key:"cancel"}).w('</button></div><div class="tc-ctl-edit-point tc-hidden"></div><div class="tc-ctl-edit-line tc-hidden"></div><div class="tc-ctl-edit-polygon tc-hidden"></div><div class="tc-ctl-edit-save"><button class="tc-button tc-icon-button tc-ctl-edit-btn-save" disabled title="').h("i18n",r,{},{$key:"syncChanges"}).w('">').h("i18n",r,{},{$key:"syncChanges"}).w('</button><button class="tc-button tc-icon-button tc-ctl-edit-btn-discard" disabled title="').h("i18n",r,{},{$key:"discardChanges"}).w('">').h("i18n",r,{},{$key:"discardChanges"}).w("</button></div>")}function t(e,t){return e.w('<option value="').f(t.get(["id"],!1),t,"h").w('">').f(t.get(["title"],!1),t,"h").w("</option>")}function o(e,t){return e.w(" checked")}dust.register(f.CLASS,e);e.__dustBody=!0;t.__dustBody=!0;o.__dustBody=!0;return e};f.template[f.CLASS+"-attr"]=function(){function e(e,o){o=o.shiftBlocks(F);return e.w('<div class="tc-ctl-edit-attr"><h3>').h("i18n",o,{},{$key:"attributeEdit"}).w('</h3><div class="tc-ctl-edit-attr-body"><table><tbody>').s(o.get(["data"],!1),o,{block:t},{}).w('</tbody></table></div><div class="tc-ctl-edit-attr-footer"><button class="tc-button tc-ctl-edit-btn-attr-ok">').h("i18n",o,{},{$key:"ok"}).w('</button><button class="tc-button tc-ctl-edit-btn-attr-cancel">').h("i18n",o,{},{$key:"cancel"}).w("</button></div></div>")}function t(e,t){t=t.shiftBlocks(F);return e.w("<tr><th>").f(t.get(["name"],!1),t,"h").w("</th><td>").x(t.get(["readOnly"],!1),t,{"else":o,block:D},{}).w("</td></tr>")}function o(e,t){t=t.shiftBlocks(F);return e.x(t.get(["availableValues"],!1),t,{block:r},{}).h("select",t,{block:n},{key:t.get(["type"],!1)})}function r(e,t){t=t.shiftBlocks(F);return e.w('<select class="tc-combo" name="').f(t.get(["name"],!1),t,"h").w('"><option value=""></option>').s(t.get(["availableValues"],!1),t,{block:i},{}).w("</select>")}function i(e,t){t=t.shiftBlocks(F);return e.w('<option value="').f(t.getPath(!0,[]),t,"h").w('">').f(t.getPath(!0,[]),t,"h").w("</option>")}function n(e,t){t=t.shiftBlocks(F);return e.h("none",t,{block:a},{}).h("eq",t,{block:l},{value:"int"}).h("eq",t,{block:s},{value:"integer"}).h("eq",t,{block:p},{value:"double"}).h("eq",t,{block:c},{value:"boolean"}).h("eq",t,{block:u},{value:"date"}).h("eq",t,{block:g},{value:"time"}).h("eq",t,{block:d},{value:"dateTime"}).h("eq",t,{block:h},{value:"byte"}).h("eq",t,{block:y},{value:"long"}).h("eq",t,{block:m},{value:"negativeInteger"}).h("eq",t,{block:v},{value:"nonNegativeInteger"}).h("eq",t,{block:C},{value:"nonPositiveInteger"}).h("eq",t,{block:T},{value:"positiveInteger"}).h("eq",t,{block:_},{value:"short"}).h("eq",t,{block:S},{value:"unsignedLong"}).h("eq",t,{block:E},{value:"unsignedInt"}).h("eq",t,{block:x},{value:"unsignedShort"}).h("eq",t,{block:P},{value:"unsignedByte"}).h("eq",t,{block:L},{value:"float"}).h("eq",t,{block:w},{value:"decimal"})}function a(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputText"),t,{},{})}function l(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputNumber"),t,{},{})}function s(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputNumber"),t,{},{})}function p(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputNumber"),t,{},{})}function c(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputCheckbox"),t,{},{})}function u(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputDate"),t,{},{})}function g(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputTime"),t,{},{})}function d(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputDatetime"),t,{},{})}function h(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputNumber"),t,{},{})}function y(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputNumber"),t,{},{})}function m(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputNumber"),t,{},{})}function v(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputNumber"),t,{},{})}function C(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputNumber"),t,{},{})}function T(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputNumber"),t,{},{})}function _(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputNumber"),t,{},{})}function S(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputNumber"),t,{},{})}function E(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputNumber"),t,{},{})}function x(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputNumber"),t,{},{})}function P(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputNumber"),t,{},{})}function L(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputNumber"),t,{},{})}function w(e,t){t=t.shiftBlocks(F);return e.b(t.getBlock("inputNumber"),t,{},{})}function R(e,t){t=t.shiftBlocks(F);return e.w('<input type="text" class="tc-textbox" name="').f(t.get(["name"],!1),t,"h").w('" value="').f(t.get(["value"],!1),t,"h").w('" />')}function A(e,t){t=t.shiftBlocks(F);return e.w('<input type="number" class="tc-textbox" name="').f(t.get(["name"],!1),t,"h").w('" value="').f(t.get(["value"],!1),t,"h").w('" />')}function b(e,t){t=t.shiftBlocks(F);return e.w('<input type="checkbox" name="').f(t.get(["name"],!1),t,"h").w('"').x(t.get(["value"],!1),t,{block:M},{}).w("/>")}function M(e,t){t=t.shiftBlocks(F);return e.w(" checked")}function I(e,t){t=t.shiftBlocks(F);return e.w('<input type="date" class="tc-textbox" name="').f(t.get(["name"],!1),t,"h").w('" value="').f(t.get(["value"],!1),t,"h").w('" />')}function O(e,t){t=t.shiftBlocks(F);return e.w('<input type="time" class="tc-textbox" name="').f(t.get(["name"],!1),t,"h").w('" value="').f(t.get(["value"],!1),t,"h").w('" />')}function N(e,t){t=t.shiftBlocks(F);return e.w('<input type="datetime" class="tc-textbox" name="').f(t.get(["name"],!1),t,"h").w('" value="').f(t.get(["value"],!1),t,"h").w('" />')}function D(e,t){t=t.shiftBlocks(F);return e.f(t.get(["value"],!1),t,"h")}dust.register(f.CLASS+"-attr",e);var F={inputText:R,inputNumber:A,inputCheckbox:b,inputDate:I,inputTime:O,inputDatetime:N};e.__dustBody=!0;t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;n.__dustBody=!0;a.__dustBody=!0;l.__dustBody=!0;s.__dustBody=!0;p.__dustBody=!0;c.__dustBody=!0;u.__dustBody=!0;g.__dustBody=!0;d.__dustBody=!0;h.__dustBody=!0;y.__dustBody=!0;m.__dustBody=!0;v.__dustBody=!0;C.__dustBody=!0;T.__dustBody=!0;_.__dustBody=!0;S.__dustBody=!0;E.__dustBody=!0;x.__dustBody=!0;P.__dustBody=!0;L.__dustBody=!0;w.__dustBody=!0;R.__dustBody=!0;A.__dustBody=!0;b.__dustBody=!0;M.__dustBody=!0;I.__dustBody=!0;O.__dustBody=!0;N.__dustBody=!0;D.__dustBody=!0;return e}}f.register=function(t){var o=this;TC.control.SWCacheClient.prototype.register.call(o,t);t.addControl("popup",{closeButton:!0}).then(function(e){o.attributeEditor=e});t.on(TC.Consts.event.LAYERUPDATE,function(t){if(t.layer.type===TC.Consts.layerType.WFS&&!t.layer.options.stealth){var r=t.layer,p=o.features[t.layer.id]=o.features[t.layer.id]||{added:[],modified:[],removed:[]};h(o,r).then(function(t){o.layer!==r&&t.setVisibility(!1);var c=n(o,r.id),u=a(o,r.id),g=l(o,r.id),d=s(o,r.id);TC.loadJS(!window.localforage,[TC.Consts.url.LOCALFORAGE],function(){TC.getUID();localforage.keys().then(function(o){if(o)for(var n=0,a=o.length;a>n;n++){var l=o[n];0===l.indexOf(c)&&i(l).then(function(o){var i,n=o.key;if(0===n.indexOf(d)){i=n.substr(d.length);var a=r.getFeatureById(i);r.removeFeature(a);t.addFeature(a);p.removed.push(a)}else if(0===n.indexOf(g)){i=n.substr(g.length);var a=r.getFeatureById(i);if(a){t.addFeature(a);p.modified.push(a);a.wrap.setGeometry(o.feature.geometry);a.setData(o.feature.attributes)}}else if(0===n.indexOf(u)){i=n.substr(u.length);var l=parseInt(i.substr(i.lastIndexOf(".")+1));e=Math.max(e,l+1);var s;switch(o.feature.type){case TC.Consts.geom.POINT:s=r.addPoint(o.feature.geometry);break;case TC.Consts.geom.POLYLINE:s=r.addPolyline(o.feature.geometry);break;case TC.Consts.geom.POLYGON:s=r.addPolygon(o.feature.geometry);break;case TC.Consts.geom.MULTIPOLYLINE:s=r.addMultiPolyline(o.feature.geometry);break;case TC.Consts.geom.MULTIPOLYGON:s=r.addMultiPolygon(o.feature.geometry)}s.then(function(e){t.addFeature(e);p.added.push(e);e.provId=i;e.setData(o.feature.attributes)})}})}})})})}}).on(TC.Consts.event.LAYERADD,function(e){if(e.layer.type===TC.Consts.layerType.WFS&&!e.layer.options.stealth){o.features[e.layer.id]=o.features[e.layer.id]||{added:[],modified:[],removed:[]};$("<option>").attr("value",e.layer.id).html(e.layer.title||e.layer.id).appendTo(o._$layerSelect)}}).on(TC.Consts.event.LAYERREMOVE,function(e){if(e.layer.type===TC.Consts.layerType.WFS&&!e.layer.options.stealth){var t=o._$layerSelect.find("option[value="+e.layer.id+"]");t.filter(":selected").length>0&&o.setLayer(null);t.remove()}}).on(TC.Consts.event.POPUP,function(e){if(e.control===o.attributeEditor){for(var t=e.control.currentFeature,r=o.attributes.slice(),i={},n=o._joinedFeatureAttributes||[],a=0,l=r.length;l>a;a++){var s=t.getData()||{},p=r[a];p.value=s[p.name];"id"===p.name&&(p.readOnly=!0);p.availableValues=[];for(var c=0,u=n.length;u>c;c++){var g=n[c][p.name];void 0!==g&&""!==g&&(p.availableValues[p.availableValues.length]=g)}i[p.name]=p.type}r.sort(function(e,t){return(e.readOnly?!t.readOnly:t.readOnly)?!e.readOnly-!t.readOnly:e.name>t.name?1:e.name<t.name?-1:0});o.getRenderedHtml(o.CLASS+"-attr",{data:r},function(e){var r=o.attributeEditor.$contentDiv;r.html(e);var n=r.find("input"),a=r.find("select");n.on("input",function(e){var t=$(e.target),o=a.filter("[name="+t.attr("name")+"]");o.val()!==t.val()&&o.val("")});a.on("change",function(e){var t=$(e.target);n.filter("[name="+t.attr("name")+"]").val(t.val())});r.find("."+o.CLASS+"-btn-attr-ok").on("click",function(){var e={};n.each(function(t,o){n=$(o);var r=n.attr("name"),a=n.val();switch(i[r]){case"int":case"integer":case"byte":case"long":case"negativeInteger":case"nonNegativeInteger":case"nonPositiveInteger":case"positiveInteger":case"short":case"unsignedLong":case"unsignedInt":case"unsignedShort":case"unsignedByte":a=parseInt(a);Number.isNaN(a)||(e[r]=a);break;case"double":case"float":case"decimal":a=parseFloat(a);Number.isNaN(a)||(e[r]=a);break;case"date":case"time":case"dateTime":e[r]=new Date(a);break;case"boolean":e[r]=!!a;break;case void 0:break;default:e[r]=a}});t.setData(e);o.$events.trigger($.Event(TC.Consts.event.FEATUREMODIFY,{feature:t,layer:o.layer}));o.attributeEditor.hide()});r.find("."+o.CLASS+"-btn-attr-cancel").on("click",function(){o.attributeEditor.hide()})})}});t.loaded(function(){if(o.options.layer)o.setLayer(o.options.layer);else{var e=t.workLayers.filter(function(e){return e.type===TC.Consts.layerType.WFS&&!e.options.stealth});o.setLayer(1===e.length?e[0].id:null)}o.showChanges(o._showsChanges);o.renderPromise().then(function(){var e="draw";$.when.apply(o,[t.addControl(e,{div:o._$div.find("."+o.CLASS+"-point"),mode:TC.Consts.geom.POINT,layer:!1}),t.addControl(e,{div:o._$div.find("."+o.CLASS+"-line"),mode:TC.Consts.geom.POLYLINE,layer:!1}),t.addControl(e,{div:o._$div.find("."+o.CLASS+"-polygon"),mode:TC.Consts.geom.POLYGON,layer:!1})]).then(function(e,t,r){o.pointDraw=e;o.lineDraw=t;o.polygonDraw=r;var i=function(e){var t,r=e.geometry;switch(o.geometryType){case TC.Consts.geom.POINT:t=TC.feature.Point;break;case TC.Consts.geom.POLYLINE:t=TC.feature.Polyline;break;case TC.Consts.geom.POLYGON:t=TC.feature.Polygon;break;case TC.Consts.geom.MULTIPOLYLINE:t=TC.feature.MultiPolyline;break;case TC.Consts.geom.MULTIPOLYGON:t=TC.feature.MultiPolygon}t&&(r=new t(r.geometry,{geometryName:o.layer.options.geometryName}));o.layer.addFeature(r);o.$events.trigger($.Event(TC.Consts.event.FEATUREADD,{feature:r}))},n=function(){o.cancel()};e.on(TC.Consts.event.DRAWEND,i).on(TC.Consts.event.DRAWCANCEL,n);t.on(TC.Consts.event.DRAWEND,i).on(TC.Consts.event.DRAWCANCEL,n);r.on(TC.Consts.event.DRAWEND,i).on(TC.Consts.event.DRAWCANCEL,n);o.options.modes&&$.isArray(o.options.modes)&&1==o.options.modes.length&&o.setMode(o.options.modes[0],null)})})})};f.render=function(e){var t=this,o=[];if(t.map)for(var r=0,i=t.map.workLayers.length;i>r;r++){var n=t.map.workLayers[r];n.type!==TC.Consts.layerType.WFS||n.options.stealth||o.push({id:n.id,title:n.title||n.id})}TC.Control.prototype.renderData.call(t,{layers:o,showChanges:t.showChanges},function(){t._$layerDiv=t._$div.find(t._classSelector+"-layer");t._$layerSelect=t._$layerDiv.find(t._classSelector+"-layer-sel").on("change",function(e){t.setLayer(t._$layerSelect.val())});t._$layerDiv.find("#"+t.CLASS+"-view-changes-cb").on("change",function(e){t.showChanges($(e.target).prop("checked"))});t._$cancelBtn=t._$div.find(t._classSelector+"-btn-cancel").on("click",function(){t.cancel()});t._$deleteBtn=t._$div.find(t._classSelector+"-btn-delete").on("click",function(){TC.confirm(t.eraseActionConfirmTxt,function(){t.deleteFeatures(t.getSelectedFeatures())})});t._$joinBtn=t._$div.find(t._classSelector+"-btn-join").on("click",function(){t.joinFeatures(t.getSelectedFeatures())});t._$splitBtn=t._$div.find(t._classSelector+"-btn-split").on("click",function(){t.splitFeatures(t.getSelectedFeatures())});t._$saveBtn=t._$div.find(t._classSelector+"-btn-save").on("click",function(){t.applyEdits()});t._$discardBtn=t._$div.find(t._classSelector+"-btn-discard").on("click",function(){t.discardEdits()});if(t.options.modes&&$.isArray(t.options.modes)&&t.options.modes.length>0){for(var o in TC.Consts.editMode)if("string"==typeof o&&t.options.modes.indexOf(TC.Consts.editMode[o])<0){$("label"+t._classSelector+"-btn-"+TC.Consts.editMode[o],t._$div).remove();$("div"+t._classSelector+"-"+TC.Consts.editMode[o],t._$div).remove()}if(1==t.options.modes.length){var r=t.options.modes[0];$("label"+t._classSelector+"-btn-"+r,t._$div).css("display","none")}}t._$div.find("input[type=radio][name=mode]").on("change",function(){var e=$(this),o=e.val(),r=t.mode===o?void 0:o;t.setMode(r)});$.isFunction(e)&&e()})};f.setLayer=function(e){var t=this;t.layer=map.getLayer(e);t.setMode(null);var o="input[type=radio][name=mode]";if(t.layer){h(t,t.layer).then(function(e){for(var o in t._changesLayers){var r=t._changesLayers[o];r.setVisibility(t._showsChanges&&r===e)}});t.layer.describeFeatureType().then(function(e){t.attributes=e.filter(function(e){switch(e.type){case"gml:LinearRingPropertyType":case"gml:PolygonPropertyType":t.geometryType=TC.Consts.geom.POLYGON;return!1;case"gml:MultiPolygonPropertyType":case"gml:MultiSurfacePropertyType":t.geometryType=TC.Consts.geom.MULTIPOLYGON;return!1;case"gml:LineStringPropertyType":t.geometryType=TC.Consts.geom.POLYLINE;return!1;case"gml:MultiLineStringPropertyType":t.geometryType=TC.Consts.geom.MULTIPOLYLINE;return!1;case"gml:PointPropertyType":case"gml:MultiPointPropertyType":t.geometryType=TC.Consts.geom.POINT;return!1;case"gml:BoxPropertyType":t.geometryType=TC.Consts.geom.RECTANGLE;return!1;case"gml:GeometryCollectionPropertyType":case"gml:GeometryAssociationType":return!1;default:return!0}});for(var r=0,i=t.attributes.length;i>r;r++){var n=t.attributes[r];n.type=n.type.substr(n.type.indexOf(":")+1)}t.renderPromise().then(function(){d(t);t._$div.find(t._classSelector+"-layer-sel").val(t.layer.id);$rb=t._$div.find(o);var e;switch(t.geometryType){case TC.Consts.geom.POINT:e="[value=select],[value="+TC.Consts.editMode.ADDPOINT+"]";break;case TC.Consts.geom.POLYLINE:case TC.Consts.geom.MULTIPOLYLINE:e="[value=select],[value="+TC.Consts.editMode.ADDLINE+"]";break;case TC.Consts.geom.POLYGON:case TC.Consts.geom.MULTIPOLYGON:e="[value=select],[value="+TC.Consts.editMode.ADDPOLYGON+"]";break;default:e="[value]"}var r=$rb.filter(e).attr("disabled",!1);$rb.not(r).attr("disabled",!0)})});t._layerDeferred.resolve(t.layer)}else{t.renderPromise().then(function(){d(t,!1);$rb=t._$div.find(o).attr("disabled",!0);$rb.each(function(e,t){$(t).prop("checked",!1)})});t._layerDeferred.resolve(null)}};f.setMode=function(e){var t=this;t.mode=e;p(t);var o,r,i=function(e){if(e){t.snapping&&(e.snapping=t.layer);e.activate()}};switch(e){case TC.Consts.editMode.SELECT:o=t._$div.find(t._classSelector+"-select");r=t._$div.find(t._classSelector+"-point,"+t._classSelector+"-line,"+t._classSelector+"-polygon");t.activate();break;case TC.Consts.editMode.ADDPOINT:o=t._$div.find(t._classSelector+"-point");r=t._$div.find(t._classSelector+"-select,"+t._classSelector+"-line,"+t._classSelector+"-polygon");i(t.pointDraw);break;case TC.Consts.editMode.ADDLINE:o=t._$div.find(t._classSelector+"-line");r=t._$div.find(t._classSelector+"-select,"+t._classSelector+"-point,"+t._classSelector+"-polygon");i(t.lineDraw);break;case TC.Consts.editMode.ADDPOLYGON:o=t._$div.find(t._classSelector+"-polygon");r=t._$div.find(t._classSelector+"-select,"+t._classSelector+"-point,"+t._classSelector+"-line");i(t.polygonDraw);break;default:o=$();r=t._$div.find(t._classSelector+"-select,"+t._classSelector+"-point,"+t._classSelector+"-line,"+t._classSelector+"-polygon");t.isActive&&t.deactivate();t.pointDraw&&t.pointDraw.isActive&&t.pointDraw.deactivate();t.lineDraw&&t.lineDraw.isActive&&t.lineDraw.deactivate();t.polygonDraw&&t.polygonDraw.isActive&&t.polygonDraw.deactivate()}var n;if(e){n=t._$div.find("input[type=radio][name=mode][value="+e+"]").prop("checked",!0).addClass(TC.Consts.classes.CHECKED);n.next().addClass(TC.Consts.classes.CHECKED)}else{n=t._$div.find("input[type=radio][name=mode]").prop("checked",!1).removeClass(TC.Consts.classes.CHECKED);n.next().removeClass(TC.Consts.classes.CHECKED)}o.removeClass(TC.Consts.classes.HIDDEN);r.addClass(TC.Consts.classes.HIDDEN)};f.showChanges=function(e){var t=this;t._showsChanges=e;for(var o in t._changesLayers){var r=t._changesLayers[o];r.setVisibility(e&&t.layer&&o===t.layer.id)}};f.cancel=function(){var e=this;e.options.modes&&$.isArray(e.options.modes)&&1==e.options.modes.length?e.setMode(e.options.modes[0],null):e.setMode(null,!1);e.wrap.cancel(!0,e.cancelActionConfirmTxt)};f.onFeatureClick=function(e){self.activeControl&&self.activeControl.isExclusive()||e.feature.show()};f.activate=function(e){var t=this;TC.Control.prototype.activate.call(t);var o=e||{};t._$cancelBtn.prop("disabled",!1);$.when(t.getLayer()).then(function(){t.wrap.activate(o.mode?o.mode:t.mode);TC.Control.prototype.activate.call(t)})};f.deactivate=function(){var e=this;TC.Control.prototype.deactivate.call(e);e.wrap.cancel(!0);e._$cancelBtn.prop("disabled",!0);e.wrap.deactivate()};f.isExclusive=function(){return!0};f.joinFeatures=function(e){var t=this;if(t.geometryType===TC.Consts.geom.MULTIPOLYLINE||t.geometryType===TC.Consts.geom.MULTIPOLYGON||t.geometryType===TC.Consts.geom.MULTIPOINT){t._joinedFeatureAttributes=[];if(e.length>1){for(var o=e.map(function(e){t._joinedFeatureAttributes[t._joinedFeatureAttributes.length]=e.getData();return e.geometry}),r=o.reduce(function(e,t){return e.concat(t)}),i=new e[0].constructor(r),n=0,a=e.length;a>n;n++){var l=e[n];t.layer.removeFeature(l);t.$events.trigger($.Event(TC.Consts.event.FEATUREREMOVE,{feature:l}))}t.layer.addFeature(i).then(function(e){t.setSelectedFeatures([i]);t.$events.trigger($.Event(TC.Consts.event.FEATUREADD,{feature:e}));e.showPopup(t.attributeEditor)})}u(t,[i])}};f.splitFeatures=function(e){for(var t=this,o=e.filter(c),r=o.map(function(e){return e.geometry}),i=[],n=0,a=o.length;a>n;n++)for(var l=o[n],s=l.getData(),p=r[n],g=0,d=p.length;d>g;g++)i[i.length]=new l.constructor([p[g]],{data:s});for(var n=0,h=o.length;h>n;n++){var l=o[n];t.layer.removeFeature(l);t.$events.trigger($.Event(TC.Consts.event.FEATUREREMOVE,{feature:l}))}for(var f=new Array(i.length),n=0,h=i.length;h>n;n++){var y=f[n]=t.layer.addFeature(i[n]);y.then(function(e){t.$events.trigger($.Event(TC.Consts.event.FEATUREADD,{feature:e}))})}$.when.apply(this,f).then(function(){t.setSelectedFeatures(i)});u(t,i)};f.deleteFeatures=function(e){var t=this;t.wrap.deleteFeatures(e);

0===t.layer.features.length&&t._$deleteBtn.prop("disabled",!0)};f.applyEdits=function(){var e=this;if(e.layer){var t=e.features[e.layer.id];e.layer.applyEdits(t.added,t.modified,t.removed).then(function(){e.discardEdits();e.map.toast("Cambios sincronizados con \xe9xito con el servidor")},function(e){TC.error("Error ["+e.code+"] al guardar cambios: "+e.reason)})}};f.discardEdits=function(){var e=this;e._joinedFeatureAttributes=[];var t=n(e);TC.loadJS(!window.localforage,[TC.Consts.url.LOCALFORAGE],function(){localforage.keys().then(function(o){if(o){for(var r=0,i=o.length;i>r;r++){var n=o[r];0===n.indexOf(t)&&localforage.removeItem(n)}if(e.layer){var a=e.features[e.layer.id];a.added.length=0;a.modified.length=0;a.removed.length=0;e.setSelectedFeatures([]);e.attributeEditor.hide();var l=e._changesLayers[e.layer.id];l.clearFeatures();e.deleteCache(t).then(function(){e.layer.refresh()})}d(e,!1)}})})};f.getSelectedFeatures=function(){return this.wrap.getSelectedFeatures()};f.setSelectedFeatures=function(e){return this.wrap.setSelectedFeatures(e)};f.getLayer=function(){var e=this;return e.layer||e._layerDeferred};f.getChangesLayerStyle=function(e){var t=function(t){for(var o,r=e.wrap.getRGBA(t),i=0;3>i;i++)r[i]=255-r[i];o=(65536*r[0]+256*r[1]+r[2]).toString(16);4===o.length?o="00"+o:5===o.length&&(o="0"+o);return"#"+o},o=[1,3],r=$.extend(!0,{},e.options.styles);if(r.point){r.point.strokeColor=t(r.point.strokeColor);r.point.lineDash=o}if(r.line){r.line.strokeColor=t(r.line.strokeColor);r.line.lineDash=o}if(r.polygon){r.polygon.strokeColor=t(r.polygon.strokeColor);r.polygon.lineDash=o}return r}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.ExternalWMS=function(e){if(TC.isLegacy)console.warn("El control ExternalWMS no soporta modo legacy");else{var t=this;this.count=0;this._addedUrls=[];TC.Control.apply(t,arguments)}};TC.inherit(TC.control.ExternalWMS,TC.Control);!function(){var e=TC.control.ExternalWMS.prototype;e.CLASS="tc-ctl-xwms";e.markServicesAsSelected=function(e){if(e.length>0){var t=$(e[0]);t.attr("disabled","true");t.addClass("tc-ctl-xwms-option-selected")}};e.register=function(e){if(TC.isLegacy)console.warn("El control ExternalWMS no soporta modo legacy");else{var t=this;TC.Control.prototype.register.call(t,e);t._$div.on("change","select",function(e){if(""!=this.value){var o=this.value;0===o.indexOf("//")&&(o=location.protocol+o);t._$div.find("input").val(o);$(this).val("")}});var o=function(e){for(var t=["version","service","request"],o=0;o<t.length;o++)e=TC.Util.removeURLParameter(e,t[o]);e.match(/\?$/)&&(e=e.substr(0,e.length-1));return e};t._$div.on("click","button[name='agregar']",function(e){var r=t._$div.find("input").val();if(r)if(/^((https?|ftp):)?(\/\/)?(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(r))if(t._addedUrls.indexOf(r)>-1)TC.alert(t.getLocaleString("serviceAlreadyAdded"));else{r=o(r);var i=t.map.getControlsByClass("TC.control.LoadingIndicator")[0];i.show();var n=t._$div.find("button");n.attr("disabled","true");for(var a={id:"xwms"+ ++t.count,type:"WMS",url:r,hideTree:!1},l=0;l<t.options.suggestions.length;l++){var s=$.grep(t.options.suggestions[l].items,function(e,t){return e.url===r});if(s.length>0&&s[0].layerNames){a.layerNames=s[0].layerNames;break}}var p=new TC.layer.Raster(a);p.getCapabilitiesPromise().then(function(e){if("undefined"!=typeof e.Capability){var o=e.Capability.Layer;if(o.CRS&&-1==o.CRS.indexOf(t.map.crs)){TC.alert(t.getLocaleString("serviceSrsNotCompatible"));i.hide();n.removeAttr("disabled")}else{t.map.$events.trigger($.Event(TC.Consts.event.EXTERNALSERVICEADDED,{layer:p}));t._$div.find("input").val("");var a=t._$div.find("select option[value='"+r+"']");t.markServicesAsSelected(a);t._addedUrls.push(r);i.hide();n.removeAttr("disabled")}}else{TC.alert(t.getLocaleString("noLayersFoundInService"));i.hide();n.removeAttr("disabled")}},function(e){TC.alert(t.getLocaleString("serviceCouldNotBeLoaded")+":\n"+e);i.hide();n.removeAttr("disabled")})}else TC.alert(t.getLocaleString("typeAValidAddress"));else TC.alert(t.getLocaleString("typeAnAddress"))});e.on(TC.Consts.event.LAYERADD,function(e){if(e.layer&&!e.layer.isBase){var o=e.layer.url,r=t._$div.find("select option").filter(function(e,t){return TC.Util.addProtocol(t.value)===TC.Util.addProtocol(o)});t.markServicesAsSelected(r);t._addedUrls.push(o)}})}};e.template={};e.template[e.CLASS]=TC.isDebug?TC.apiLocation+"TC/templates/ExternalWMS.html":function(){function t(e,t){return e.x(t.get(["title"],!1),t,{block:o},{}).w('<div><div class="tc-group tc-ctl-xwms-cnt"> <select id="add-wms-select" class="tc-combo" title="WMS (Web Map Service)"><option value="">WMS</option>').s(t.get(["suggestions"],!1),t,{block:r},{}).w('</select><input type="text" class="tc-textbox" placeholder="').h("i18n",t,{},{$key:"writeAddressOrSelect"}).w('" /></div><div class="tc-group tc-group tc-ctl-xwms-cnt" style="text-align:right;"><button type="button" class="tc-button tc-icon-button" title="').h("i18n",t,{},{$key:"addService.title"}).w('" name="agregar">').h("i18n",t,{},{$key:"addService"}).w("</button></div></div>")}function o(e,t){return e.w("<h2>").h("i18n",t,{},{$key:"addMaps"}).w("</h2>")}function r(e,t){return e.x(t.get(["group"],!1),t,{block:i},{}).s(t.get(["items"],!1),t,{block:n},{}).x(t.get(["group"],!1),t,{block:a},{})}function i(e,t){return e.w('<optgroup label="').f(t.get(["group"],!1),t,"h").w('">')}function n(e,t){return e.w('<option value="').f(t.get(["url"],!1),t,"h").w('">').f(t.get(["name"],!1),t,"h").w("</option>")}function a(e,t){return e.w("	</optgroup>")}dust.register(e.CLASS,t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;n.__dustBody=!0;a.__dustBody=!0;return t};e.render=function(e){var t=this;t.renderData(t.options)}}();TC.control=TC.control||{};TC.control.FeatureInfoCommons||TC.syncLoadJS(TC.apiLocation+"TC/control/FeatureInfoCommons");!function(){TC.control.FeatureInfo=function(){var e=this;TC.control.FeatureInfoCommons.apply(this,arguments);e.wrap=new TC.wrap.control.FeatureInfo(e);TC.Consts.classes.FROMLEFT="tc-fromleft";TC.Consts.classes.FROMRIGHT="tc-fromright";e.callback=function(t,o){for(var r=!1,i=0;i<e.map.workLayers.length;i++){var n=e.map.workLayers[i];if(n.type===TC.Consts.layerType.WMS&&n.getVisibility()&&n.names.length>0){r=!0;break}}r?e.wrap.getFeatureInfo(o):e.map.$events.trigger($.Event(TC.Consts.event.NOFEATUREINFO,{xy:o,control:e}))}};TC.inherit(TC.control.FeatureInfo,TC.control.FeatureInfoCommons);var e=TC.control.FeatureInfo.prototype;e.FEATURE_PARAM="showfeature";var t=TC.apiLocation+"lib/jshash/md5-min.js",o=function(e,o){if(0!==jQuery.grep(e.map.workLayers,function(e,t){return e.type===TC.Consts.layerType.WMS&&e.url===o.s&&e.getDisgregatedLayerNames().indexOf(o.l)>=0}).length){e.sharedFeatureInfo=o;TC.loadJS(!window.hex_md5,[t],function(){var t=e.map.options.pixelTolerance||TC.Cfg.pixelTolerance,r=2*t+1,i=[t,t],n=r*o.r/2,a=[o.xy[0]-n,o.xy[1]-n,o.xy[0]+n,o.xy[1]+n];e.beforeGetFeatureInfo({xy:i,control:e});e.wrap.getFeatureInfo(i,{serviceUrl:o.s,layerName:o.l,featureId:o.f,mapSize:[r,r],boundingBox:a})})}else TC.error(TC.Util.getLocaleString(e.map.options.locale,"sharedFeatureNotValid"),TC.Consts.msgErrorMode.TOAST)},r=function i(e,t){var o;if($.isArray(e)){o=e.slice();for(var r=0,n=o.length;n>r;r++)o[r]=i(o[r])}else o="number"==typeof e?Math.round(e.toFixed(t)):e;return o};e.register=function(e){var t=this;TC.control.FeatureInfoCommons.prototype.register.call(t,e);t._$div.appendTo("<div>");e.loaded(function(){t._layersDeferred.then(function(){var e=TC.Util.getParameterByName(t.FEATURE_PARAM);if(e){var r;try{r=JSON.parse(decodeURIComponent(escape(window.atob(e))))}catch(i){TC.error(TC.Util.getLocaleString(t.map.options.locale,"sharedFeatureNotValid"),TC.Consts.msgErrorMode.TOAST)}r&&o(t,r)}})})};e.beforeGetFeatureInfo=function(e){var t=this;TC.control.FeatureInfoCommons.prototype.beforeGetFeatureInfo.call(t,e);if(e.control===t&&t.map&&t.filterLayer){for(var o=null;!o;)o=t.map.getCoordinateFromPixel(e.xy);var r=t.getLocaleString("featureInfo"),i=$.extend({},t.map.options.styles.marker,t.markerStyle,{title:r,set:r});t.displayMode!==TC.control.FeatureInfoCommons.POPUP&&(i.showsPopup=!1);t.filterLayer.clearFeatures();$.when(t.filterLayer.addMarker(o,i)).then(function(e){if(null===t.lastFeatureCount){t.map.putLayerOnTop(t.filterLayer);t.filterFeature=e}else t.filterLayer.clearFeatures()})}};e.onShowModal=function(){var e=this,o=e.getDisplayTarget().find("ul."+e.CLASS+"-features li."+TC.Consts.classes.CHECKED),i=e._shareCtl;i.extraParams=null;var n=o.parents("li").first(),a=n.parents("li").first(),l=e.info.services[a.index()];if(l){var s=l.layers[n.index()];if(s){var p=s.features[o.index()];TC.loadJS(!window.hex_md5,[t],function(){var t=hex_md5(JSON.stringify({data:p.getData(),geometry:r(p.geometry,TC.Consts.DEGREE_PRECISION)}));i.extraParams={};i.extraParams[e.FEATURE_PARAM]=window.btoa(unescape(encodeURIComponent(JSON.stringify({xy:p.wrap.getInnerPoint(),r:e.map.getResolution(),s:l.mapLayer.url,l:s.name,f:p.id,h:t}))));var o=i._$div;o.find(".tc-url input[type=text]").val(i.generateLink());o.find(".tc-iframe input[type=text]").val(i.generateIframe())})}}};e.responseCallback=function(e){var t=this;if(t.filterFeature){var o=e.services;t.info={services:o,defaultFeature:e.defaultFeature};for(var i=0;i<o.length;i++){for(var n=o[i],a=0;a<n.layers.length;a++)if(!n.layers[a].features.length){n.layers.splice(a,1);a-=1}if(!n.layers.length){o.splice(i,1);i-=1}}if(o.length)t.renderData(e,function(){t._$div.find("td."+t.CLASS+"-val").each(function(e,o){var r=$(o),i=r.text();TC.Util.isURL(i)&&r.html('<a href="'+i+'" target="_blank" title="'+t.getLocaleString("linkInNewWindow")+'">'+i+"</a>")});if(t.sharedFeatureInfo){t._$div.find("ul."+t.CLASS+"-services li").addClass(TC.Consts.classes.CHECKED);for(var e,o=t.sharedFeatureInfo,i=0,n=t.info.services.length;n>i;i++){var a=t.info.services[i];if(a.mapLayer.url===o.s){for(var l=0,s=a.layers.length;s>l;l++){var p=a.layers[l];if(p.name===o.l){for(var c=0,u=p.features.length;u>c;c++){var g=p.features[c];if(g.id===o.f){e=g;var d=hex_md5(JSON.stringify({data:g.getData(),geometry:r(g.geometry,TC.Consts.DEGREE_PRECISION)}));o.h!==d&&TC.alert(t.getLocaleString("finfo.featureChanged.warning"));break}}break}}break}}e&&t.map.addControl(new TC.control.Popup({div:TC.Util.getDiv(),closeButton:!0})).then(function(o){e.data=t._$div.html();o.$popupDiv.addClass(t.CLASS+"-lite");t.getLocaleString("deleteFeature");t.getRenderedHtml(t.CLASS+"-del-btn",null,function(e){o.$popupDiv.append(e);o.$popupDiv.find("."+t.CLASS+"-del-btn").on(TC.Consts.event.CLICK,function(e){TC.confirm(t.getLocaleString("deleteFeature.confirm"),function(){t.map.removeLayer(t.sharedFeatureLayer);delete t.sharedFeatureLayer})})});e.showsPopup=!0;e.popup=o;t.map.addLayer({id:TC.getUID(),type:TC.Consts.layerType.VECTOR,title:t.getLocaleString("foi")}).then(function(o){t.sharedFeatureLayer=o;t.filterLayer.clearFeatures();o.addFeature(e);t.map.zoomToFeatures([e])});t.map.on(TC.Consts.event.POPUP,function(r){r.control===o&&o.$popupDiv.find("table").on(TC.Consts.event.CLICK,function(o){t.map.zoomToFeatures([e])})})});delete t.sharedFeatureInfo}else t.displayResults()});else{t.resultsLayer.clearFeatures();t.filterLayer.clearFeatures()}}}}();TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.FileImport=function(){var e=this;TC.Control.apply(e,arguments);e.formats=$.isArray(e.options.formats)?e.options.formats:[TC.Consts.format.KML,TC.Consts.format.GML,TC.Consts.format.GML2,TC.Consts.format.GEOJSON,TC.Consts.format.WKT,TC.Consts.format.GPX];e.apiAttribution="";e.mainDataAttribution="";e.dataAttributions=[]};TC.inherit(TC.control.FileImport,TC.Control);!function(){var e=TC.control.FileImport.prototype;e.CLASS="tc-ctl-file";e.template=TC.isDebug?TC.apiLocation+"TC/templates/FileImport.html":function(){function t(e,t){return e.w("<h2>").h("i18n",t,{},{$key:"openFile"}).w("</h2><div><p>").h("i18n",t,{},{$key:"fileImport.instructions"}).w('</p><div class="tc-ctl-file-open"><label class="tc-button tc-ctl-file-open-label tc-icon-button"><input type="file" class="tc-ctl-file-open-ipt tc-button" accept="').s(t.get(["formats"],!1),t,{block:o},{}).w('" />').h("i18n",t,{},{$key:"openFile"}).w("</label></div></div>")}function o(e,t){return e.w(".").f(t.getPath(!0,[]),t,"h").h("sep",t,{block:r},{})}function r(e,t){return e.w(",")}dust.register(e.CLASS,t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;return t};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);t.options.enableDragAndDrop&&e.wrap.enableDragAndDrop(t.options);e.on(TC.Consts.event.FEATURESIMPORT,function(o){var r="."+TC.Consts.format.GPX.toLowerCase();o.fileName.toLowerCase().indexOf(r)!==o.fileName.length-r.length&&e.addLayer({id:TC.getUID(),title:o.fileName,type:TC.Consts.layerType.VECTOR}).then(function(r){for(var i="EPSG:4326",n=function(e){var o=e.geometry;if(o){var r=/^([-+]?\d{1,3}([.,]\d+)?)\,?\s*([-+]?\d{1,2}([.,]\d+)?)$/.exec(o.join(" "));r&&r.length>=3&&Math.abs(r[1])<=180&&Math.abs(r[3])<=90&&e.setCoords(TC.Util.reproject(o,i,t.map.crs))}return e},a=0,l=o.features.length;l>a;a++){var s=n(o.features[a]);r.addFeature(s)}setTimeout(function(){e.zoomToFeatures(r.features)},100)})}).on(TC.Consts.event.FEATURESIMPORTERROR,function(e){var o,r=e.file.name;o=".kmz"===r.toLowerCase().substr(r.length-4)?"fileImport.error.reasonKmz":"fileImport.error.reasonUnknown";TC.error(t.getLocaleString(o,{fileName:r}),TC.Consts.msgErrorMode.TOAST);var i=new FileReader;i.onload=function(e){TC.error("Nombre del archivo: "+r+" \n Contenido del archivo: \n\n"+e.target.result,TC.Consts.msgErrorMode.EMAIL,"Error en la subida de un archivo")};i.readAsText(e.file)})};e.render=function(){var e=this;e.renderData({formats:e.formats},function(){e._$div.find("input[type=file]").on(TC.Consts.event.CLICK,function(e){$(this).wrap("<form>").closest("form").get(0).reset();$(this).unwrap()}).on("change",function(t){if(e.map){console.log("salta el change");e.map.wrap.loadFiles(t.target.files)}})})}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.FullScreen=function(){var e=this;TC.Control.apply(e,arguments);e.fullScreenElement=document.documentElement};TC.inherit(TC.control.FullScreen,TC.Control);!function(){var e=TC.control.FullScreen.prototype;e.CLASS="tc-ctl-fscreen";e.template=TC.isDebug?TC.apiLocation+"TC/templates/FullScreen.html":function(){function t(e,t){return e.w('<button class="tc-ctl-fscreen-btn" title="').h("i18n",t,{},{$key:"fscreen.tip"}).w('"></button>')}dust.register(e.CLASS,t);t.__dustBody=!0;return t};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);t.renderPromise().then(function(){var e=t._$div.find("."+t.CLASS+"-btn");if(t.enabledFullScreen()){e.on("click",function(){t.toggleFullScreen()});$(document).on("fullscreenchange mozfullscreenchange webkitfullscreenchange MSFullscreenChange",function(){e.toggleClass(TC.Consts.classes.ACTIVE,t.isFullScreen());e.attr("title",t.getLocaleString(t.isFullScreen()?"fscreen.tip.return":"fscreen.tip"))})}else e.addClass(TC.Consts.classes.HIDDEN)})};e.requestFullScreen=function(){var e=this,t=e.fullScreenElement;document.documentElement.requestFullScreen?t.requestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):t.msRequestFullscreen&&t.msRequestFullscreen()};e.cancelFullScreen=function(){document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()};e.isFullScreen=function(){return document.fullScreenElement||document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement};e.toggleFullScreen=function(){var e=this;e.isFullScreen()?e.cancelFullScreen():e.requestFullScreen()};e.enabledFullScreen=function(){var e=this,t=e.fullScreenElement,o=document.documentElement.requestFullScreen||t.mozRequestFullScreen||t.webkitRequestFullScreen||t.msRequestFullscreen;return o&&"function"==typeof o}}();!function(){Math.hypot=Math.hypot||function(){for(var e=0,t=arguments.length,o=0;t>o;o++){if(arguments[o]===1/0||arguments[o]===-(1/0))return 1/0;e+=arguments[o]*arguments[o]}return Math.sqrt(e)}}();!function(){for(var e=0,t=["ms","moz","webkit","o"],o=!(!window.performance||!window.performance.now),r=0,i=t.length;i>r&&!window.requestAnimationFrame;r+=1){window.requestAnimationFrame=window[t[r]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[t[r]+"CancelAnimationFrame"]||window[t[r]+"CancelRequestAnimationFrame"]}window.requestAnimationFrame||(window.requestAnimationFrame=function(t,o){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),n=window.setTimeout(function(){t(r+i)},i);e=r+i;return n});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)});if(!o){var n=window.requestAnimationFrame,a=+new Date;window.requestAnimationFrame=function(e,t){var o=function(t){var o=1e12>t?t:t-a;return e(o)};n(o,t)}}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.Geolocation=function(e){var t=this;t.$events=$(t);t._classSelector="."+t.CLASS;t.Const={Classes:{ACTIVE:"tc-ctl-geolocation-active",CLOSED:"closed",SELECTEDTRACK:"selectedTrack",DRAWACTIVATED:"draw-activated",SIMULATIONACTIVATED:"simulation-activated"},Selector:{SIMULATE:".tc-btn-simulate",DRAW:".tc-draw",EDIT:".tc-btn-edit",DELETE:".tc-btn-delete",SAVE:".tc-btn-save",CANCEL:".tc-btn-cancel",EXPORT_GPX:".tc-btn-export-gpx",EXPORT_KML:".tc-btn-export-kml",STOP:".tc-btn-stop",PAUSE:".tc-btn-pause",BACKWARD:".tc-btn-backward",FORWARD:".tc-btn-forward",SPEED:".tc-spn-speed"},LocalStorageKey:{TRACKING:"trk",TRACKINGTEMP:"trktemp",TRACKINGSHOWADVERTISEMENT:"trkAdvertisement",GPSSHOWADVERTISEMENT:"gpsAdvertisement",TEST:"test"},Message:{VALIDATENAME:""},Event:{POSITIONCHANGE:"positionchange.tc.geolocation",GPSPOSITIONCHANGE:"gpspositionchange.tc.geolocation",GPSPOSITIONERROR:"positionerror.tc.geolocation",STATEUPDATED:"stateupdated.tc.geolocation",GPSADD:"gpsadd.tc.geolocation",TRACKSNAPPING:"tracksnapping.tc.geolocation",DRAWTRACK:"drawtrack.tc.geolocation",CLEARTRACK:"cleartrack.tc.geolocation",IMPORTEDTRACK:"importedtrack.tc.geolocation"},MimeMap:{KML:"application/vnd.google-earth.kml+xml",GPX:"application/gpx+xml"},SupportedFileExtensions:[".kml",".gpx"],Tabs:{GPS:"gps"},Layers:{GPS:"gps",TRACK:"track",TRACKING:"tracking"}};TC.Control.apply(t,arguments);var o=e||{};t._$dialogDiv=$(TC.Util.getDiv(o.dialogDiv));o.dialogDiv||t._$dialogDiv.appendTo("body");t.delta=500;t.walkingSpeed=5e3;t.gapHill=t.options.gapHill||20};TC.inherit(TC.control.Geolocation,TC.Control);!function(){var e=TC.control.Geolocation.prototype;e.CLASS="tc-ctl-geolocation";TC.Consts.event.TOOLSCLOSE=TC.Consts.event.TOOLSCLOSE||"toolsclose.tc";TC.Consts.event.TOOLSOPEN=TC.Consts.event.TOOLSOPEN||"toolsopen.tc";e.template={};if(TC.isDebug){e.template[e.CLASS]=TC.apiLocation+"TC/templates/Geolocation.html";e.template[e.CLASS+"-track-node"]=TC.apiLocation+"TC/templates/GeolocationTrackNode.html";e.template[e.CLASS+"-track-snapping-node"]=TC.apiLocation+"TC/templates/GeolocationTrackSnappingNode.html";e.template[e.CLASS+"-dialog"]=TC.apiLocation+"TC/templates/GeolocationDialog.html";e.template[e.CLASS+"-tracking-toast"]=TC.apiLocation+"TC/templates/GeolocationTrackingToast.html"}else{e.template[e.CLASS]=function(){function t(e,t){return e.w("<h2>").h("i18n",t,{},{$key:"geo"}).w('</h2><div class="tc-ctl-geolocation-content"> <div class="tc-ctl-geolocation-track"><div class="tc-ctl-geolocation-track-snap-info"></div><div class="tc-ctl-geolocation-info-tracking tc-hidden"><div class="tc-ctl-p-results"><div class="prpanel-group prsidebar-body "><div class="prpanel prpanel-default"><div class="prpanel-heading"><h4 class="prpanel-title"><label>').h("i18n",t,{},{$key:"geo.mylocation"}).w('</label> <span id="trackingInfoClose" class="prcollapsed-pull-right prcollapsed-slide-submenu prcollapsed-slide-submenu-close" title="').h("i18n",t,{},{$key:"close"}).w('"><i class="fa fa-times"></i></span><span id="trackingInfoMin" class="prcollapsed-pull-right prcollapsed-slide-submenu prcollapsed-slide-submenu-min" title="').h("i18n",t,{},{$key:"hide"}).w('"><i class="fa fa-chevron-left"></i></span> </h4></div><div id="results" class="prpanel-collapse"><div class="prpanel-body list-group"> </div> </div></div></div><div id="trackingInfoMax" class="prcollapsed prcollapsed-max prcollapsed-pull-left" style="display: none;" title="').h("i18n",t,{},{$key:"geo.trk.panel.3"}).w('"><i class="fa fa-list-alt"></i></div></div></div><!-- img se insertan en el div del mapa--> <div id="tc-ctl-geolocation-track-elevation-marker" class="tc-ctl-geolocation-trackMarker elevation" style="display: none;" /> <div class="tc-ctl-geolocation-track-panel-block"><input id="tc-ctl-geolocation-track-panel-opened" type="checkbox" checked/><label for="tc-ctl-geolocation-track-panel-opened" title="').h("i18n",t,{},{$key:"geo.trk.panel.help.1"}).w('">').h("i18n",t,{},{$key:"geo.trk.panel.help.2"}).w('</label><i class="tc-ctl-geolocation-track-panel-help icon-question-sign" title="').h("i18n",t,{},{$key:"geo.trk.panel.help.3"}).w('"></i></div><div class="tc-ctl-geolocation-track-mng"><div class="tc-ctl-geolocation-select"><form> <label class="tc-ctl-geolocation-btn-track" title="').h("i18n",t,{},{$key:"geo.track.title"}).w('"><input type="radio" name="mode" value="tracks" /><span>').h("i18n",t,{},{$key:"geo.gps"}).w('</span></label><label class="tc-ctl-geolocation-btn-tracks" title="').h("i18n",t,{},{$key:"geo.tracks.title"}).w('"><input type="radio" name="mode" value="track-available" /><span>').h("i18n",t,{},{$key:"geo.tracks"}).w('</span></label> </form></div> <div class="tc-ctl-geolocation-track-available tc-ctl-geolocation-track-cnt tc-ctl-geolocation-panel tc-hidden"><i class="tc-ctl-geolocation-track-search-icon"></i><input id="tc-ctl-geolocation-track-available-srch" type="search" list="tc-ctl-geolocation-track-available-lst" class="tc-ctl-geolocation-track-available-srch tc-textbox" placeholder="').h("i18n",t,{},{$key:"geo.filter.plhr"}).w('" maxlength="200" /> <ol id="tc-ctl-geolocation-track-available-lst" class="tc-ctl-geolocation-track-available-lst"><li class="tc-ctl-geolocation-track-available-empty"><span>').h("i18n",t,{},{$key:"geo.noTracks"}).w('</span></li><li class="tc-ctl-geolocation-track-not" hidden><span>').h("i18n",t,{},{$key:"noMatches"}).w('</span></li></ol><div class="tc-ctl-geolocation-track-cnt"><input name="uploaded-file" id="uploaded-file" type="file" class="tc-ctl-geolocation-track-import tc-button" accept=".gpx,.kml" disabled /><label class="tc-button tc-icon-button" for="uploaded-file" title="').h("i18n",t,{},{$key:"geo.trk.import.upload"}).w('">').h("i18n",t,{},{$key:"geo.trk.import.lbl"}).w('</label></div></div><div class="tc-ctl-geolocation-tracks tc-ctl-geolocation-panel tc-hidden"> <div class="tc-alert alert-warning tc-hidden"><p id="panel-msg">').h("i18n",t,{},{$key:"geo.trk.panel.1"}).w(" <ul><li>").h("i18n",t,{},{$key:"geo.trk.panel.2"}).w("</li><li>").h("i18n",t,{},{$key:"geo.trk.panel.3"}).w("</li><li>").h("i18n",t,{},{$key:"geo.trk.panel.4"}).w("</li><li>").h("i18n",t,{},{$key:"geo.trk.panel.5"}).w('</li></ul></p></div> <div class="tc-ctl-geolocation-track-ui"> <div class="tc-ctl-geolocation-track-render"><input id="tc-ctl-geolocation-track-render" type="checkbox" hidden checked /><label for="tc-ctl-geolocation-track-render" class="tc-ctl-geolocation-track-render" title="').h("i18n",t,{},{$key:"geo.trk.render"}).w('">').h("i18n",t,{},{$key:"geo.trk.render"}).w('</label></div><button class="tc-button tc-icon-button tc-ctl-geolocation-track-ui-activate" title="').h("i18n",t,{},{$key:"geo.track.activate.title"}).w('">').h("i18n",t,{},{$key:"geo.track.activate"}).w('</button><button class="tc-button tc-icon-button tc-ctl-geolocation-track-ui-deactivate tc-hidden" title="').h("i18n",t,{},{$key:"geo.track.deactivate.title"}).w('">').h("i18n",t,{},{$key:"geo.track.deactivate"}).w('</button></div><div class="tc-ctl-geolocation-track-current tc-ctl-geolocation-track-cnt"><input type="text" class="tc-ctl-geolocation-track-title tc-textbox" disabled placeholder="').h("i18n",t,{},{$key:"geo.trk.name.plhr"}).w('" maxlength="200" /><button class="tc-button tc-icon-button tc-ctl-geolocation-track-save" disabled title="').h("i18n",t,{},{$key:"geo.trk.name.save"}).w('"></button><input type="text" class="tc-ctl-geolocation-track-waypoint tc-textbox" disabled placeholder="').h("i18n",t,{},{$key:"geo.trk.wyp.plhr"}).w('" maxlength="200" /><button class="tc-button tc-icon-button tc-ctl-geolocation-track-add-wpt" disabled title="').h("i18n",t,{},{$key:"geo.trk.wyp.save"}).w('"></button></div></div></div></div></div><!--se inserta en el div del mapa--><div class="tc-ctl-geolocation-track-center tc-hidden"> <button class="tc-ctl-btn tc-button tc-icon-button" title="').h("i18n",t,{},{$key:"geo.trk.center"}).w('"></button></div>')}dust.register(e.CLASS,t);t.__dustBody=!0;return t};e.template[e.CLASS+"-track-node"]=function(){function t(e,t){return e.w('<li data-id="').f(t.get(["id"],!1),t,"h").w('" data-uid="').f(t.get(["uid"],!1),t,"h").w('"><span class="tc-draw tc-selectable" title="').f(t.get(["name"],!1),t,"h").w('">').f(t.get(["name"],!1),t,"h").w('</span><input class="tc-textbox tc-hidden" type="text" value="').f(t.get(["name"],!1),t,"h").w('" /> <button class="tc-btn-simulate" title="').h("i18n",t,{},{$key:"tr.lst.simulate"}).w('"></button><button hidden class="tc-btn-stop" title="').h("i18n",t,{},{$key:"tr.lst.stop"}).w('"></button><button class="tc-btn-edit" title="').h("i18n",t,{},{$key:"tr.lst.edit"}).w('"></button><button hidden class="tc-btn-pause" title="').h("i18n",t,{},{$key:"tr.lst.pause"}).w('"></button> <button hidden class="tc-btn-backward" title="').h("i18n",t,{},{$key:"tr.lst.backward"}).w('"></button><label hidden class="tc-spn-speed" title="').h("i18n",t,{},{$key:"tr.lst.velocity"}).w('"></label><button hidden class="tc-btn-forward" title="').h("i18n",t,{},{$key:"tr.lst.forward"}).w('"></button> <button class="tc-btn-save tc-hidden" title="').h("i18n",t,{},{$key:"save"}).w('"></button><button class="tc-btn-cancel tc-hidden" title="').h("i18n",t,{},{$key:"tr.lst.cancel"}).w('"></button><button class="tc-btn-delete" title="').h("i18n",t,{},{$key:"tr.lst.delete"}).w('"></button><button class="tc-btn-export-gpx" title="').h("i18n",t,{},{$key:"tr.lst.exportGPX"}).w('"></button><button class="tc-btn-export-kml" title="').h("i18n",t,{},{$key:"tr.lst.exportKML"}).w('"></button> </li>')}dust.register(e.CLASS+"-track-node",t);t.__dustBody=!0;return t};e.template[e.CLASS+"-track-snapping-node"]=function(){function t(e,t){return e.w("<ul>").x(t.get(["n"],!1),t,{block:o},{}).w("<li> <span>X:</span> ").f(t.get(["x"],!1),t,"h").w(" </li><li> <span>Y:</span> ").f(t.get(["y"],!1),t,"h").w(" </li>").x(t.get(["z"],!1),t,{block:r},{}).x(t.get(["m"],!1),t,{block:n},{}).w("</ul>")}function o(e,t){return e.w("<li> <span>").h("i18n",t,{},{$key:"geo.trk.snapping.name"}).w(":</span> ").f(t.get(["n"],!1),t,"h").w(" </li>")}function r(e,t){return e.h("ne",t,{block:i},{key:t.get(["z"],!1),value:0}).w(" ")}function i(e,t){return e.w("<li> <span>Z:</span> ").f(t.get(["z"],!1),t,"h").w(" </li>")}function n(e,t){return e.w("<li> ").f(t.get(["m"],!1),t,"h").w(" </li>")}dust.register(e.CLASS+"-track-snapping-node",t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;n.__dustBody=!0;return t};e.template[e.CLASS+"-dialog"]=function(){function t(e,t){return e.w('<div class="tc-ctl-geolocation-continue-track-dialog tc-modal"><div class="tc-modal-background tc-modal-close"></div><div class="tc-modal-window"><div class="tc-modal-header"><h3>').h("i18n",t,{},{$key:"geo.gps"}).w('</h3><div class="tc-ctl-popup-close tc-modal-close"></div></div><div class="tc-modal-body"><button class="tc-button tc-ctl-geolocation-track-continue"> ').h("i18n",t,{},{$key:"geo.trk.dialog.cnt"}).w(' </button><button class="tc-button tc-ctl-geolocation-track-new"> ').h("i18n",t,{},{$key:"geo.trk.dialog.new"}).w(' </button> <button class="tc-button tc-modal-close"> ').h("i18n",t,{},{$key:"geo.trk.dialog.cancel"}).w(' </button></div></div></div><div class="tc-ctl-geolocation-track-advert-dialog tc-modal"><div class="tc-modal-background tc-modal-close"></div><div class="tc-modal-window"><div class="tc-modal-header"><h3>').h("i18n",t,{},{$key:"geo.track.activate.title"}).w('</h3><div class="tc-ctl-popup-close tc-modal-close"></div></div><div class="tc-modal-body"><p id="pageBlurMsg">').h("i18n",t,{},{$key:"geo.trk.page.blur"}).w('</p><p class="tc-ctl-geolocation-track-advertisement p"> <label> <input type="checkbox" name="checkbox" id="advertisement"> ').h("i18n",t,{},{$key:"geo.trk.dialog.advertisement"}).w(' </label> </p></div><div class="tc-modal-footer"><button class="tc-button tc-ctl-geolocation-track-advert-ok"> ').h("i18n",t,{},{$key:"ok"}).w(" </button></div></div></div>")}dust.register(e.CLASS+"-dialog",t);t.__dustBody=!0;return t};e.template[e.CLASS+"-tracking-toast"]=function(){function t(e,t){return e.w("<ul><li><span>X:</span> ").f(t.get(["x"],!1),t,"h").w("<br /><span>Y:</span> ").f(t.get(["y"],!1),t,"h").w("<br />").x(t.get(["z"],!1),t,{block:o},{}).w("</li><li>").x(t.get(["accuracy"],!1),t,{block:r},{}).x(t.get(["speed"],!1),t,{block:i},{}).w("</li></ul>")}function o(e,t){return e.w("<span>Z:</span> ").f(t.get(["z"],!1),t,"h").w(" m<br />")}function r(e,t){return e.w("<span>").h("i18n",t,{},{$key:"geo.trk.accuracy"}).w(":</span> ").f(t.get(["accuracy"],!1),t,"h").w(" m<br />")}function i(e,t){return e.w("<span>").h("i18n",t,{},{$key:"geo.trk.speed"}).w(":</span> ").f(t.get(["speed"],!1),t,"h").w(" km/h<br />")}dust.register(e.CLASS+"-tracking-toast",t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;return t}}e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);t.wrap=new TC.wrap.control.Geolocation(t);t.wrap.register(e);e.loaded(function(){$.when(e.addLayer({id:TC.getUID(),type:TC.Consts.layerType.VECTOR,stealth:!0,title:"Posicionar.GPS"})).then(function(e){t.layerGPS=e});$.when(e.addLayer({id:TC.getUID(),type:TC.Consts.layerType.VECTOR,stealth:!0,title:"Posicionar.Tracking"})).then(function(e){t.layerTracking=e});e.on(TC.Consts.event.FEATURESIMPORT,function(e){var t=this;if(t.isDisabled)/.gpx$/g.test(e.fileName.toLowerCase())&&t.map.toast(t.getLocaleString("geo.trk.import.disabled"),{type:TC.Consts.msgType.WARNING});else if(e.fileName&&e.features&&e.features.length>0){var o=/.kml$/g.test(e.fileName.toLowerCase())&&t.importedByMe||!1;if(/.gpx$/g.test(e.fileName.toLowerCase())||o){if(t.layerTrack){t.map.removeLayer(t.layerTrack);

t.layerTrack=void 0}if(o){for(var r=0;r<t.map.workLayers.slice().reverse().length;r++){var i=t.map.workLayers.slice().reverse()[r];if(i.title&&i.title.toLowerCase().trim()===e.fileName.toLowerCase().trim()){t.map.removeLayer(i);break}}t.importedByMe=!1}t.getLayer(t.Const.Layers.TRACK).then(function(o){var r=t.getLoadingIndicator().addWait();t.importedFileName=e.fileName;for(var i=0,n=e.features.length;n>i;i++)t.layerTrack.addFeature(e.features[i]);t.wrap.processImportedFeatures(r);if(t.layerTrack){if(t.map&&t.map.layout&&t.map.layout.accordion&&t._$div.hasClass(TC.Consts.classes.COLLAPSED))for(var i=0;i<t.map.controls.length;i++)t.map.controls[i]!==t&&t.map.controls[i]._$div.addClass(TC.Consts.classes.COLLAPSED);t._$div.removeClass(TC.Consts.classes.COLLAPSED);$("."+t.CLASS+"-btn-tracks > span").click();t.map.$events.trigger($.Event(TC.Consts.event.TOOLSOPEN),{})}})}}}.bind(t));e.on(TC.Consts.event.LAYERVISIBILITY+" "+TC.Consts.event.LAYEROPACITY+" "+TC.Consts.event.LAYERREMOVE,function(e){var t=this;if(e.layer==t.layerTrack)switch(!0){case e.type+"."+e.namespace===TC.Consts.event.LAYERREMOVE:t.wrap.deactivateSnapping();var o=t.getSelectedTrack();o&&t.clearSelectedTrack();t.resultsPanelChart&&t.resultsPanelChart.close();t.layerTrack=void 0;break;case e.opacity>0&&e.opacity<1:return;case 0==e.layer.getVisibility():t.resultsPanelChart&&t.resultsPanelChart.minimize();case 0==e.opacity:t.wrap.deactivateSnapping();break;case 1==e.layer.getVisibility():t.resultsPanelChart&&t.resultsPanelChart.maximize();case 1==e.opacity:t.wrap.activateSnapping()}}.bind(t))})};e.render=function(e){var t=this;t.getRenderedHtml(t.CLASS+"-dialog",null,function(e){t._$dialogDiv.html(e)}).then(function(){TC.Control.prototype.render.call(t,e)})};var t=!0;e.renderData=function(a,l){var s=this,p=function(e,t){return(t.match(/(moveTop.*)/g)||[]).join(" ")};s.trackingActive={isTrackingActive:!1,get:function(){return this.isTrackingActive},set:function(e){this.isTrackingActive=e;s.$geoInfoResult||(s.$geoInfoResult=$("."+s.CLASS+"-info-tracking div.tc-ctl-p-results"));switch(this.isTrackingActive){case!0:if(s.elevationActiveCollapsed.get()){s.$geoInfoResult.removeClass(p).addClass("moveTop57");s.$geoInfoResult.find(".prcollapsed").removeClass("prcollapsed-samehw");s.$geoInfoResult.find(".prpanel-heading").removeClass("prpanel-heading-samehw")}else if(s.elevationActive.get()){s.$geoInfoResult.removeClass(p).addClass("moveTop159");s.$geoInfoResult.find(".prcollapsed").addClass("prcollapsed-samehw");s.$geoInfoResult.find(".prpanel-heading").addClass("prpanel-heading-samehw")}else{s.$geoInfoResult.removeClass(p).addClass("moveTop33");s.$geoInfoResult.find(".prcollapsed").removeClass("prcollapsed-samehw");s.$geoInfoResult.find(".prpanel-heading").removeClass("prpanel-heading-samehw")}break;case!1:}}};s.elevationActive={isElevationActive:!1,get:function(){return this.isElevationActive},set:function(e){this.isElevationActive=e;s.$geoInfoResult||(s.$geoInfoResult=$("."+s.CLASS+"-info-tracking div.tc-ctl-p-results"));switch(this.isElevationActive){case!0:if(s.trackingActive.get()){s.$geoInfoResult.removeClass(p).addClass("moveTop159");s.$geoInfoResult.find(".prcollapsed").addClass("prcollapsed-samehw");s.$geoInfoResult.find(".prpanel-heading").addClass("prpanel-heading-samehw")}break;case!1:if(s.trackingActive.get()){s.$geoInfoResult.removeClass(p).addClass("moveTop33");s.$geoInfoResult.find(".prcollapsed").removeClass("prcollapsed-samehw");s.$geoInfoResult.find(".prpanel-heading").removeClass("prpanel-heading-samehw")}}}};s.elevationActiveCollapsed={isElevationActiveCollapsed:!1,get:function(){return this.isElevationActiveCollapsed},set:function(e){this.isElevationActiveCollapsed=e;s.$geoInfoResult||(s.$geoInfoResult=$("."+s.CLASS+"-info-tracking div.tc-ctl-p-results"));switch(this.isElevationActiveCollapsed){case!0:if(s.trackingActive.get()){s.$geoInfoResult.removeClass(p).addClass("moveTop57");s.$geoInfoResult.find(".prcollapsed").removeClass("prcollapsed-samehw");s.$geoInfoResult.find(".prpanel-heading").removeClass("prpanel-heading-samehw")}break;case!1:if(s.trackingActive.get()){s.$geoInfoResult.removeClass(p).addClass("moveTop159");s.$geoInfoResult.find(".prcollapsed").addClass("prcollapsed-samehw");s.$geoInfoResult.find(".prpanel-heading").addClass("prpanel-heading-samehw")}}}};var u=s.Const.Selector;TC.Control.prototype.renderData.call(s,a,function(){var a=s._$div.find(s._classSelector+"-panel");s._$div.find(".tc-ctl-geolocation-select span").on(TC.Consts.event.CLICK,function(e){var t=$(this).closest("label").find("input[type=radio][name=mode]"),o=t.val();a.removeClass(TC.Consts.classes.HIDDEN);a.not(".tc-ctl-geolocation-"+o).addClass(TC.Consts.classes.HIDDEN)});s.gps={};s.gps.$activateButton=s._$div.find(s._classSelector+"-locate-show");s.gps.$deactivateButton=s._$div.find(s._classSelector+"-locate-hide");s.track={};s.track.$activateButton=s._$div.find(s._classSelector+"-track-ui-activate");s.track.$deactivateButton=s._$div.find(s._classSelector+"-track-ui-deactivate");s.track.$info=s._$div.find(s._classSelector+"-info-tracking").appendTo(s.map._$div);$(document).on("click","#trackingInfoMin",function(){var e=$(this).closest("div.tc-ctl-p-results");e.find(".prsidebar-body").toggle("slide",function(){e.find(".prcollapsed-max").fadeIn()})});$(document).on("click","#trackingInfoMax",function(){var e=$(this).closest("div.tc-ctl-p-results");e.find(".prsidebar-body").toggle("slide");e.find(".prcollapsed-max").hide()});$(document).on("click","#trackingInfoClose",function(){$(this).closest("div.tc-ctl-p-results").find(".prsidebar-body").fadeOut("slide")});s.track.$trackSearch=s._$div.find(s._classSelector+"-track-available-srch");s.track.$trackList=s._$div.find(s._classSelector+"-track-available-lst");s.track.$trackToolPanelOpened=s._$div.find("#tc-ctl-geolocation-track-panel-opened");s._$div.find("."+e.CLASS+"-track-panel-help").click(function(){n.call(s)});s.track.$trackName=s._$div.find(s._classSelector+"-track-title");s.track.$trackSave=s._$div.find(s._classSelector+"-track-save");s.track.$trackWPT=s._$div.find(s._classSelector+"-track-waypoint");s.track.$trackAdd=s._$div.find(s._classSelector+"-track-add-wpt");s.track.$trackContinue=s._$dialogDiv.find(".tc-ctl-geolocation-track-continue");s.track.$trackRenew=s._$dialogDiv.find(".tc-ctl-geolocation-track-new");s.track.$trackClose=s._$dialogDiv.find(".tc-ctl-geolocation-continue-track-dialog button.tc-modal-close");s.track.$trackAddSegment=s._$div.find("#tc-ctl-geolocation-track-segment");s.track.$trackAdvertisementOK=s._$dialogDiv.find(".tc-ctl-geolocation-track-advert-ok");s.track.$trackImportFile=s._$div.find(s._classSelector+"-track-import");TC.Util.detectMobile()&&Modernizr.mq("screen and (max-height: 50em) and (max-width: 50em)")&&s.track.$trackToolPanelOpened.prop("checked",!1);if(window.File&&window.FileReader&&window.FileList&&window.Blob){s.track.$trackImportFile.removeAttr("disabled");s.track.$trackImportFile.on(TC.Consts.event.CLICK,function(e){$(this).wrap("<form>").closest("form").get(0).reset();$(this).unwrap()});s.track.$trackImportFile.on("change",function(e){if(!s._cleaning){s.clear(s.Const.Layers.TRACK);if(s.map){s.map.on(TC.Consts.event.LAYERERROR,o);s.importedByMe=!0;s.map.wrap.loadFiles(e.target.files)}}})}else console.log("no es posible la importaci\xf3n");s.gps.$activateButton.on("click",function(){s.activateGPS()});s.gps.$deactivateButton.on("click",function(){s.deactivateGPS()});s.track.$activateButton.on("click",function(){s.activateTracking();r.call(s)});s.track.$deactivateButton.on("click",function(){s.deactivateTracking();i.call(s)});var l=function(e){e=e.toLowerCase();var t=s.track.$trackList.find("li").hide(),o=t.filter("li:not([class]),li."+s.Const.Classes.SELECTEDTRACK);if(0===e.length){o.show();s._$div.find(s._classSelector+"-track-search-icon").css("visibility","visible")}else{s._$div.find(s._classSelector+"-track-search-icon").css("visibility","hidden");var r=new RegExp(e,"i");o.each(function(){var e=$(this);e.toggle(r.test(e.children("span").text()))});0===o.filter(":visible").length&&t.filter('[class^="tc-ctl-geolocation-track-not"]').show()}};s.track.$trackSearch.on("keyup search",function(){l($(this).val().toLowerCase().trim())});try{if(s.track.$trackSearch.has($("::-ms-clear"))){var p;s.track.$trackSearch.on("mouseup",function(e){p=s.track.$trackSearch.val();""!==p&&setTimeout(function(){var e=s.track.$trackSearch.val();""===e&&l(e)},1)})}}catch(g){}s.track.$trackSave.on("click",$.proxy(s.saveTrack,s));s.track.$trackAdd.on("click",$.proxy(s.addWaypoint,s));var d=function(e,t){t.is("li")||(t=t.parent());if(e){t.find("input").first().removeClass(TC.Consts.classes.HIDDEN);t.find("span").first().addClass(TC.Consts.classes.HIDDEN);t.find("input").first().focus().val(t.find("span").first().text());t.find(u.SIMULATE).first().addClass(TC.Consts.classes.HIDDEN);t.find(u.EDIT).first().addClass(TC.Consts.classes.HIDDEN);t.find(u.DELETE).first().addClass(TC.Consts.classes.HIDDEN);t.find(u.DRAW).first().addClass(TC.Consts.classes.HIDDEN);t.find(u.EXPORT_GPX).first().addClass(TC.Consts.classes.HIDDEN);t.find(u.EXPORT_KML).first().addClass(TC.Consts.classes.HIDDEN);t.find(u.SAVE).first().removeClass(TC.Consts.classes.HIDDEN);t.find(u.CANCEL).first().removeClass(TC.Consts.classes.HIDDEN)}else{t.find("input").first().addClass(TC.Consts.classes.HIDDEN);t.find("span").first().removeClass(TC.Consts.classes.HIDDEN);t.find(u.SIMULATE).first().removeClass(TC.Consts.classes.HIDDEN);t.find(u.EDIT).first().removeClass(TC.Consts.classes.HIDDEN);t.find(u.DELETE).first().removeClass(TC.Consts.classes.HIDDEN);t.find(u.DRAW).first().removeClass(TC.Consts.classes.HIDDEN);t.find(u.EXPORT_GPX).first().removeClass(TC.Consts.classes.HIDDEN);t.find(u.EXPORT_KML).first().removeClass(TC.Consts.classes.HIDDEN);t.find(u.SAVE).first().addClass(TC.Consts.classes.HIDDEN);t.find(u.CANCEL).first().addClass(TC.Consts.classes.HIDDEN)}};s.uiSimulate=function(e,t){var o=[u.SIMULATE,u.EDIT,u.DELETE,u.EXPORT_GPX,u.EXPORT_KML],r=[u.STOP,u.PAUSE,u.BACKWARD,u.FORWARD,u.SPEED],i=t.is("li")?t:t.parent();if(e){for(var n=0;n<o.length;n++)$(i).find(o[n]).first().attr("hidden","hidden");for(var n=0;n<r.length;n++)$(i).find(r[n]).first().removeAttr("hidden")}else{for(var n=0;n<r.length;n++)$(i).find(r[n]).first().attr("hidden","hidden");for(var n=0;n<o.length;n++)$(i).find(o[n]).first().removeAttr("hidden")}};$(document).on("click",u.SIMULATE,function(){var e=s.getLoadingIndicator().addWait();$(this).parent().find(u.SPEED).text("x 1");$.when(y(s,this)).then(function(){s.getLoadingIndicator().removeWait(e)})});$(document).on("click",u.DRAW,function(){var e=s.getLoadingIndicator().addWait();$.when(f(s,this)).then(function(){s.getLoadingIndicator().removeWait(e)})});s.$events.on(s.Const.Event.IMPORTEDTRACK,function(e,t){if(s.isDisabled)s.map.toast(s.getLocaleString("geo.trk.import.disabled"),{type:TC.Consts.msgType.WARNING});else{var o=s.track.$trackList.find('li[data-id="'+t+'"]');f(s,o.find(u.DRAW));s.track.$trackList.animate({scrollTop:t*o.outerHeight()},"slow")}});var h=function(e,t){for(var o=e.track.$trackList.find("li[data-id]"),r=0;r<o.length;r++){var i=$(o[r]);if(i&&i.attr("data-id")!==t){var n=i.find(u.SIMULATE),a=i.find(u.PAUSE);n.toggleClass(e.Const.Classes.SIMULATIONACTIVATED,!1);n.attr("title",e.getLocaleString("tr.lst.simulate"));a.toggleClass("play",!1);a.attr("title",e.getLocaleString("tr.lst.pause"));e.uiSimulate(!1,i);d(!1,i)}}e.clear(e.Const.Layers.TRACK)},f=function(e,t){var o=$.Deferred(),r=$(t).parent();setTimeout(function(){if(r.hasClass(e.Const.Classes.SELECTEDTRACK)){e.uiSimulate(!1,$(t));e.clear(e.Const.Layers.TRACK);$(t).attr("title",$(t).text());e.elevationActive.set(!1);if(void 0!==e.layerTrack){e.map.removeLayer(e.layerTrack);e.layerTrack=void 0}}else if(e.getSelectedTrack().length>0){h(e,r.attr("data-id"));e.drawTrack(r)}else e.drawTrack(r);o.resolve()},0);return o.promise()},y=function(e,t){var o=$.Deferred();setTimeout(function(){var r=$(t).parent();e.getLayer(e.Const.Layers.TRACK).then(function(i){h(e,r.attr("data-id"));e.uiSimulate(!1,e.getSelectedTrack());$(this).parent().addClass(e.Const.Classes.SELECTEDTRACK);e.uiSimulate(!0,$(t));e.simulate_paused=!1;e.simulateTrack($(t).parent());o.resolve()})},0);return o.promise()};$(document).on("click",s._classSelector+" "+u.EDIT,function(){d(!0,$(this))});$(document).on("click",s._classSelector+" "+u.DELETE,function(){s.removeTrack($(this).parent())});$(document).on("click",s._classSelector+" "+u.SAVE,function(){var e=$(this).parent().find("input").first().val();if(0==e.trim().length)TC.alert(s.getLocaleString("geo.trk.edit.alert"));else{s.editTrackName($(this).parent().attr("data-id"),$(this).parent().find("input").first().val());d(!1,$(this))}});$(document).on("click",s._classSelector+" "+u.CANCEL,function(){d(!1,$(this))});$(document).on("click",s._classSelector+" "+u.EXPORT_GPX+","+s._classSelector+" "+u.EXPORT_KML,function(){var e=this,t="tc-btn-export-",o=$.grep($(this).attr("class").split(" "),function(e){return 0===e.indexOf(t)})[0],r=o.replace(t,"").toUpperCase();s["export"](r,$(this).parent()).then(function(t){if(t){var o=$(e).parent().find("span").first().text(),i=new RegExp(s.Const.SupportedFileExtensions.join("|"),"gi"),n=o.replace(i,"");TC.Util.downloadFile(n+"."+r.toLowerCase(),s.Const.MimeMap[r],t)}else TC.alert(s.getLocaleString("geo.error.export"))})});$(document).on("click",s._classSelector+" "+u.STOP,function(){s.uiSimulate(!1,$(this));s.wrap.simulateTrackEnd();var e=$(this).parent().find(u.PAUSE);e.toggleClass("play",!1);e.attr("title",s.getLocaleString("tr.lst.pause"));$(this).parent().find(u.SPEED).text("x 1");s.simulate_speed=1});$(document).on("click",s._classSelector+" "+u.PAUSE,function(){s.simulate_paused=!$(this).hasClass("play");s.simulate_paused&&(s.simulate_pausedElapse=-1);$(this).attr("title",s.getLocaleString(s.simulate_paused?"tr.lst.play":"tr.lst.pause"));$(this).toggleClass("play",s.simulate_paused)});var m=.5;$(document).on("click",s._classSelector+" "+u.BACKWARD,function(){s.simulate_speed=1==s.simulate_speed?m:s.simulate_speed/2;$(s._classSelector+" "+u.FORWARD).removeAttr("disabled");$(this).parent().find(u.SPEED).text(s.simulate_speed<1?"/ "+1/s.simulate_speed:"x "+s.simulate_speed);.000244140625==s.simulate_speed&&$(this).attr("disabled","disabled")});$(document).on("click",s._classSelector+" "+u.FORWARD,function(){s.simulate_speed=s.simulate_speed/m;$(this).parent().find(u.SPEED).text(s.simulate_speed<1?"/ "+1/s.simulate_speed:"x "+s.simulate_speed);$(s._classSelector+" "+u.BACKWARD).removeAttr("disabled");4096==s.simulate_speed&&$(this).attr("disabled","disabled")});s.track.$trackContinue.on("click",function(){TC.Util.closeModal();c.call(s)});s.track.$trackRenew.on("click",function(){delete s.sessionTracking;TC.Util.storage.setSessionLocalValue(s.Const.LocalStorageKey.TRACKINGTEMP,void 0);localforage.removeItem(s.Const.LocalStorageKey.TRACKINGTEMP);TC.Util.closeModal();c.call(s)});s.track.$trackClose.on("click",function(){i.call(s)});s.track.$trackAddSegment.on("click",function(){TC.alert("pendiente");TC.Util.closeModal()});s.track.$trackAdvertisementOK.on("click",function(){var e=$(body).find('input[name*="Advertisement"]:checked');if(e.length>0){var t=new $.Deferred;window.localforage?t.resolve():TC.loadJS(!window.localforage,[TC.Consts.url.LOCALFORAGE],function(){t.resolve()});t.then(function(){localforage.setItem(e.first().attr("name"),!1)})}TC.Util.closeModal()});s.track.renderTrack=$("#tc-ctl-geolocation-track-render").change(function(){s.track.$activateButton.hasClass(TC.Consts.classes.HIDDEN)&&s.wrap.setTrackOnMapVisibility(this.checked);t=this.checked});window.localforage?s.bindTracks():TC.loadJS(!window.localforage,[TC.Consts.url.LOCALFORAGE],function(){s.bindTracks()})});$.isFunction(l)&&l()};e.activate=function(){var e=this;TC.Control.prototype.activate.call(e)};e.deactivate=function(){var e=this;e.clearSelection();e.deactivateTracking();TC.Control.prototype.deactivate.call(e)};var o=function(){var e=this;e.map.off(TC.Consts.event.LAYERERROR,o);e.clearFileInput(e.track.$trackImportFile);TC.alert(e.getLocaleString("geo.trk.upload.error3"))},r=function(){var e=this;e.track.$activateButton.toggleClass(TC.Consts.classes.HIDDEN,!0);e.track.$deactivateButton.toggleClass(TC.Consts.classes.HIDDEN,!1)},i=function(){var e=this;e.track.$activateButton.toggleClass(TC.Consts.classes.HIDDEN,!1);e.track.$deactivateButton.toggleClass(TC.Consts.classes.HIDDEN,!0)},n=function(){var e=this;e.map.toast(e._$div.find(".alert-warning").html(),{duration:1e4})};e.getLayer=function(e){var t,o=this,r=!0,i="";switch(!0){case e==o.Const.Layers.TRACKING:r=void 0!==o.layerTracking;i="layerTracking";break;case e==o.Const.Layers.TRACK:r=void 0!==o.layerTrack;i="layerTrack";t={line:{strokeWidth:2,strokeColor:"#C52737"},point:{radius:3,fillColor:"#C52737",strokeColor:"#ffffff",fontColor:"#C52737",fontSize:10,fontWeight:"bold",labelOutlineColor:"#ffffff",labelOutlineWidth:2,label:function(e){var t=e.getData().name;t=t&&(t+"").trim().length>0?(t+"").trim().toLowerCase():"";return t}}};break;case e==o.Const.Layers.GPS:r=void 0!==o.layerGPS;i="layerGPS"}if(this[i]){var n=new $.Deferred;n.resolve(this[i]);return n}if(o.layerPromise&&"resolved"!==o.layerPromise.state())return o.layerPromise;o.layerPromise=new $.Deferred;var a={id:TC.getUID(),type:TC.Consts.layerType.VECTOR,title:o.getLocaleString("geo")+" - "+e,stealth:!0};t&&(a.styles=t);$.when(o.map.addLayer(a)).then(function(e){this[i]=e;this[i].map.putLayerOnTop(e);o.layerPromise.resolve(this[i])}.bind(o));return o.layerPromise};e.activateGPS=function(){var e=this;e.deactivateTracking();_.call(e,e.Const.LocalStorageKey.GPSSHOWADVERTISEMENT);u.apply(e);m.apply(e);e.gps.$activateButton.toggleClass(TC.Consts.classes.HIDDEN,!0);e.gps.$deactivateButton.toggleClass(TC.Consts.classes.HIDDEN,!1);e.track.$trackToolPanelOpened.prop("checked")||e.map.$events.trigger($.Event(TC.Consts.event.TOOLSCLOSE),{});$.when(e.getLayer(e.Const.Layers.GPS)).then(function(t){e.currentPositionWaiting=e.getLoadingIndicator().addWait();if(navigator.geolocation){var o={timeout:6e4},r=function(o){o=o.coords;e.geopositionGPS=!0;var r=TC.Util.reproject([o.longitude,o.latitude],"EPSG:4326",e.map.crs);e.getLoadingIndicator().removeWait(e.currentPositionWaiting);t&&t.clearFeatures();var i=function(t){var o=function(e,t){return e instanceof Array?t[0]>=e[0]&&t[0]<=e[2]&&t[1]>=e[1]&&t[1]<=e[3]:!0};return o(e.map.options.maxExtent,t)?!0:!1};i(r)?$.when(t.addCircle([r,o.accuracy]),t.addMarker(r,{title:"GPS",cssClass:TC.Consts.classes.POINT,anchor:[.5,.5]})).then(function(o,r){e.gps.accuracyCircle=o;e.gps.geoPosition=r;if(!e.wrap.pulsated){e.map.zoomToFeatures(t.features,{animate:!1});e.wrap.pulsate(o)}}):TC.alert(e.getLocaleString("geo.error.out"))};if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(t){e.data=t;r(t);e.currentPosition=navigator.geolocation.watchPosition(r,e.onGeolocateError.bind(e))},e.onGeolocateError.bind(e));setTimeout(function(){if(!e.data){e.getLoadingIndicator().removeWait(e.currentPositionWaiting);e.map.toast(e.getLocaleString("geo.error.permission_denied"),{type:TC.Consts.msgType.WARNING});e.gps.$activateButton.toggleClass(TC.Consts.classes.HIDDEN,!1);e.gps.$deactivateButton.toggleClass(TC.Consts.classes.HIDDEN,!0)}},o.timeout+1e3)}else alert("not supported")}else e.onGeolocateError()})};e.deactivateGPS=function(){var e=this;delete e.geopositionGPS;g();v();delete e.wrap.pulsated;navigator.geolocation&&e.currentPosition&&navigator.geolocation.clearWatch(e.currentPosition);$.when(e.getLayer(e.Const.Layers.GPS)).then(function(e){e&&e.clearFeatures()});e.gps.$activateButton.toggleClass(TC.Consts.classes.HIDDEN,!1);e.gps.$deactivateButton.toggleClass(TC.Consts.classes.HIDDEN,!0);e.currentPositionWaiting&&e.getLoadingIndicator().removeWait(e.currentPositionWaiting);return!0};var a,l,s,p=function(){var e=this;e.track.$trackToolPanelOpened.prop("checked")||e.map.$events.trigger($.Event(TC.Consts.event.TOOLSCLOSE),{})},c=function(){var e=this;e.activate();r.call(e);p.call(e);e.track.$info.find(".prsidebar-body").show();e.$events.on(e.Const.Event.POSITIONCHANGE,function(t){e.currentPoint=t.pd;var o={},r=TC.Util.getMapLocale(e.map);o.x=Math.round(t.pd.position[0]).toLocaleString(r);o.y=Math.round(t.pd.position[1]).toLocaleString(r);o.z=Math.round(t.pd.altitude).toLocaleString(r);o.accuracy=Math.round(t.pd.accuracy).toLocaleString(r);o.speed=t.pd.speed.toLocaleString(r,{minimumFractionDigits:1,maximumFractionDigits:1});o&&e.getRenderedHtml(e.CLASS+"-tracking-toast",o,function(t){e.track.$info.find(".prpanel-body").html(t);e.track.$info.hasClass(TC.Consts.classes.HIDDEN)&&e.track.$info.removeClass(TC.Consts.classes.HIDDEN);e.trackingActive.set(!0)});e.track.$trackName.removeAttr("disabled");e.track.$trackSave.removeAttr("disabled");e.track.$trackWPT.removeAttr("disabled");e.track.$trackAdd.removeAttr("disabled");TC.Util.storage.setSessionLocalValue(e.Const.LocalStorageKey.TRACKINGTEMP,e.wrap.formattedToStorage(e.layerTracking))});e.$events.on(e.Const.Event.STATEUPDATED,function(e){});e.clear(e.Const.Layers.TRACKING);_.call(e,e.Const.LocalStorageKey.TRACKINGSHOWADVERTISEMENT);e.wrap.setTracking(!0)},u=function(){var e=this;if(!e.videoScreenOn){var t={WebM:"data:video/webm;base64,GkXfo0AgQoaBAUL3gQFC8oEEQvOBCEKCQAR3ZWJtQoeBAkKFgQIYU4BnQI0VSalmQCgq17FAAw9CQE2AQAZ3aGFtbXlXQUAGd2hhbW15RIlACECPQAAAAAAAFlSua0AxrkAu14EBY8WBAZyBACK1nEADdW5khkAFVl9WUDglhohAA1ZQOIOBAeBABrCBCLqBCB9DtnVAIueBAKNAHIEAAIAwAQCdASoIAAgAAUAmJaQAA3AA/vz0AAA=",MP4:"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAAG21kYXQAAAGzABAHAAABthADAowdbb9/AAAC6W1vb3YAAABsbXZoZAAAAAB8JbCAfCWwgAAAA+gAAAAAAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIVdHJhawAAAFx0a2hkAAAAD3wlsIB8JbCAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAIAAAACAAAAAABsW1kaWEAAAAgbWRoZAAAAAB8JbCAfCWwgAAAA+gAAAAAVcQAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAAAVxtaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAEcc3RibAAAALhzdHNkAAAAAAAAAAEAAACobXA0dgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAIAAgASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAAFJlc2RzAAAAAANEAAEABDwgEQAAAAADDUAAAAAABS0AAAGwAQAAAbWJEwAAAQAAAAEgAMSNiB9FAEQBFGMAAAGyTGF2YzUyLjg3LjQGAQIAAAAYc3R0cwAAAAAAAAABAAAAAQAAAAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAFHN0c3oAAAAAAAAAEwAAAAEAAAAUc3RjbwAAAAAAAAABAAAALAAAAGB1ZHRhAAAAWG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAK2lsc3QAAAAjqXRvbwAAABtkYXRhAAAAAQAAAABMYXZmNTIuNzguMw=="};e.videoScreenOn=document.createElement("video");e.videoScreenOn.setAttribute("loop","");e.videoScreenOn.setAttribute("muted","");e.videoScreenOn.setAttribute("webkit-playsinline","");e.videoScreenOn.setAttribute("playsinline","");e.videoScreenOn.setAttribute("style","transform: translateZ(0px);");var o=document.createElement("source");o.src=t.WebM;o.type="video/webm";e.videoScreenOn.appendChild(o);var r=document.createElement("source");r.src=t.MP4;r.type="video/mp4";e.videoScreenOn.appendChild(r)}e.videoScreenOn.play()},g=function(){var e=this;e.videoScreenOn&&e.videoScreenOn.pause()},d=function(){var e=this;console.log("onWindowBlurred");console.log("video is: "+e.videoScreenOn.paused);C.apply(e);return"Texto de aviso"},h=function(){var e=this;console.log("onWindowFocused");console.log("video is: "+e.videoScreenOn.paused);e.videoScreenOn.paused&&e.videoScreenOn.play();T.apply(e);console.log("video is: "+e.videoScreenOn.paused)},f=function(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++)if(e[t]+"Hidden"in document)return e[t]+"Hidden";return null},y=function(){var e=this,t=f();document[t]||h.apply(e);console.log("video is: "+e.videoScreenOn.paused)},m=function(){var e=this;s||(s=y.bind(e));a||(a=d.bind(e));l||(l=h.bind(e));window.addEventListener("visibilitychange",s,!1);if(TC.Util.detectSafari()&&Modernizr.touch&&!navigator.userAgent.match(/Android/i)&&!navigator.userAgent.match(/CriOS/i)){window.addEventListener("pagehide",a,!1);window.addEventListener("pageshow",l,!1)}else{window.addEventListener("blur",a,!1);window.addEventListener("focus",l,!1)}},v=function(){window.removeEventListener("visibilitychange",s,!1);if(TC.Util.detectSafari()&&Modernizr.touch&&!navigator.userAgent.match(/Android/i)&&!navigator.userAgent.match(/CriOS/i)){window.removeEventListener("pagehide",a,!1);window.removeEventListener("pageshow",l,!1)}else{window.removeEventListener("blur",a,!1);window.removeEventListener("focus",l,!1)}},C=function(){var e=this,t=TC.Util.storage.getSessionLocalValue(e.Const.LocalStorageKey.TRACKINGTEMP);t&&t.length>0&&localforage.setItem(e.Const.LocalStorageKey.TRACKINGTEMP,"string"==typeof t?t:JSON.stringify(t))},T=function(){var e=this;localforage.getItem(e.Const.LocalStorageKey.TRACKINGTEMP).then(function(t){null!==t&&"null"!==t&&t.length>0&&TC.Util.storage.setSessionLocalValue(e.Const.LocalStorageKey.TRACKINGTEMP,t)})},_=function(e){var t=this,o=new $.Deferred;window.localforage?o.resolve():TC.loadJS(!window.localforage,[TC.Consts.url.LOCALFORAGE],function(){o.resolve()});o.then(function(){localforage.getItem(e).then(function(o){if(null==o){var r=t._$dialogDiv.find(".tc-ctl-geolocation-track-advert-dialog");r.find('input[type="checkbox"]').first().attr("name",e).removeAttr("checked");$("#pageBlurMsg").text(TC.Util.detectMobile()?t.getLocaleString("geo.trk.page.blur"):t.getLocaleString("geo.trk.page.blur.desktop"));r.find("h3").text(e==t.Const.LocalStorageKey.GPSSHOWADVERTISEMENT?t.getLocaleString("geo.track.activate")+" "+t.getLocaleString("geo.gps"):t.getLocaleString("geo.track.activate.title"));TC.Util.showModal(t._$dialogDiv.find(".tc-ctl-geolocation-track-advert-dialog"))}})});t.map.toast(t.getLocaleString(TC.Util.detectMobile()?"geo.trk.page.blur":"geo.trk.page.blur.desktop"),{type:TC.Consts.msgType.WARNING})};e.activateTracking=function(){var e=this,t=!0;e.clear(e.Const.Layers.TRACKING);try{TC.Util.storage.setSessionLocalValue(e.Const.LocalStorageKey.TEST,e.Const.LocalStorageKey.TEST)}catch(o){o.code===DOMException.QUOTA_EXCEEDED_ERR?TC.alert(e.getLocaleString("geo.error.trackinglocalstorage")):TC.error(o);t=!1}if(t){u.apply(e);m.apply(e);e.sessionTracking=TC.Util.storage.getSessionLocalValue(e.Const.LocalStorageKey.TRACKINGTEMP);e.sessionTracking?TC.Util.showModal(e._$dialogDiv.find(".tc-ctl-geolocation-continue-track-dialog"),{closeCallback:function(){i.call(e)}}):c.call(e)}else i.call(e)};e.deactivateTracking=function(){var e=this,o=function(){e.track.$info.addClass(TC.Consts.classes.HIDDEN);$("#trackingInfoMax").hide();C.apply(e);e.wrap.setTracking(!1);delete e.geopositionTracking;t||$(e._classSelector+"-track-render").find("label").click();g.apply(e);v.apply(e);e.$events.off(e.Const.Event.POSITIONCHANGE);e.$events.off(e.Const.Event.STATEUPDATED);i.call(e);e.trackingActive.set(!1);e.track.$trackName.val("");e.track.$trackName.attr("disabled","disabled");e.track.$trackSave.attr("disabled","disabled");e.track.$trackWPT.val("");e.track.$trackWPT.attr("disabled","disabled");e.track.$trackAdd.attr("disabled","disabled");e.clear(e.Const.Layers.TRACKING);e.clear(e.Const.Layers.GPS);return!0};if(e.wrap.hasCoordinates()){e.map.toast(e.getLocaleString("geo.trk.deactivate.alert"),{duration:1e4});return o()}return o()};e.getStoredTracks=function(){var e=this,t=new $.Deferred,o=[];localforage.keys().then(function(r){var i=[];r=r.filter(function(t){if(!t.startsWith(e.Const.LocalStorageKey.TRACKINGTEMP)&&t.startsWith(e.Const.LocalStorageKey.TRACKING)){i.push(new $.Deferred);return!0}return!1});if(0==r.length){e.availableTracks=o;t.resolve(o)}i.forEach(function(e,t){localforage.getItem(r[t],function(t,o){e.resolve(o)})});$.when.apply($,i).then(function(){var r=Array.prototype.slice.call(arguments,0);if(r&&r.length){r.forEach(function(e){var e=JSON.parse(e);e instanceof Array?o=o.concat(e):o.push(e)});var i=S(o);e.availableTracks=i;t.resolve(i)}})});return t};var S=function(e){var t=[];for(var o in e)if(e[o]){t.push(e[o]);t.sort(function(e,t){return e.name.localeCompare(t.name)})}return t};e.setStoredTracks=function(e){var t=this,o=new $.Deferred,r=[];e.forEach(function(e){r.push(new $.Deferred);var o=r[r.length-1];localforage.setItem(t.Const.LocalStorageKey.TRACKING+"#"+e.uid,JSON.stringify(e),function(e,t){o.resolve(t)})});$.when.apply($,r).then(function(){t.getStoredTracks().then(function(){t.bindTracks();o.resolve()})});return o};e.getAvailableTracks=function(){var e=this,t=new $.Deferred;e.availableTracks?t.resolve(e.availableTracks):e.getStoredTracks().then(function(e){t.resolve(e)});return t};e.bindTracks=function(){var e=this;e.track.$trackList.find('li:not([class^="tc-ctl-geolocation-track-available-empty"])').hide();e.track.$trackList.find('li[class^="tc-ctl-geolocation-track-available-empty"]').hide();e.getAvailableTracks().then(function(t){if(E(t)){e.track.$trackList.find('li[class^="tc-ctl-geolocation-track-available-empty"]').show();e.track.$trackSearch.attr("disabled","disabled")}else{var o=$(e.getSelectedTrack()[0]).attr("data-uid");e.track.$trackList.find("li[data-id]").remove();for(var r in t)e.getRenderedHtml(e.CLASS+"-track-node",{id:r,uid:t[r].uid,name:t[r].name?t[r].name.trim():""},function(t){e.track.$trackList.append(t)});e.setSelectedTrack(e.track.$trackList.find('li[data-uid="'+o+'"]'));e.track.$trackSearch.removeAttr("disabled")}})};e.simulateTrack=function(e){var t=this;t.simulate_speed=1;t.drawTrack(e,!1);t.wrap.simulateTrack()};e.drawTrack=function(e,t){var o=this;p.call(o);o.getLayer(o.Const.Layers.TRACK).then(function(t){o.setSelectedTrack(e);o.drawTrackingData(e);o.elevationTrack(e);o.activate()})};e.elevationTrack=function(e,t){var o=this;if(t){o.wrap.simulateTrackEnd();o.uiSimulate(!1,e)}if(!o.onResize){o.onResize=o.elevationTrack.bind(o,e,!0);window.addEventListener("resize",o.onResize,!1)}var r={},i={},n=0;o.chart={coordinates:[]};o.track.elevationChart&&(o.track.elevationChart=o.track.elevationChart.destroy());var a=function(e){var t,a,l=new $.Deferred;t=[];a=[];o.getTrackingData(e).then(function(e){if(e)for(var s=(new ol.format.GeoJSON).readFeatures(e),p=0;p<s.length;p++){var c=s[p].getGeometry(),u=function(){var e=c.getLength();return parseFloat((e/1e3).toFixed(2))},g=function(){if(c.getLayout()==ol.geom.GeometryLayout.XYZM){var e=c.getLastCoordinate()[3]-c.getFirstCoordinate()[3];return{s:Math.floor(e/1e3%60),m:Math.floor(e/6e4%60),h:Math.floor(e/36e5%24)}}return null},d=function(e){if(e&&e.length>0&&e[0].length>2){for(var t=0,r=0,i=0,n=0,a=0,l=!0,s=0;s<e.length;s++){var p=e[s],c=p[2];if(0==s){i=c;n=c;a=c}n=Math.min(n,c);a=Math.max(a,c);var u=c-i;if(u>o.gapHill||u>0&&s==e.length-1){if(l)t+=u;else{r-=n-i;t+=c-n;l=!0}i=c;n=c;a=c}else if(u<-o.gapHill||0>u&&s==e.length-1){if(l){t+=a-i;r-=c-a;l=!1}else r-=u;i=c;n=c;a=c}}return{upHill:Math.round(t),downHill:Math.round(r)}}return null};switch(c.getType().toLowerCase()){case"point":continue;case"linestring":i=g(c);n=u(c);r=d(c.getCoordinates());o.chart.coordinates=o.chart.coordinates.concat(c.getCoordinates());break;case"multilinestring":for(var h,f=c.getLineStrings(),p=0;p<f.length;p++){n+=u(f[p]);f[p].getLayout()==ol.geom.GeometryLayout.XYZM&&(h+=f[p].getLastCoordinate()[3]-f[p].getFirstCoordinate()[3]);o.chart.coordinates=o.chart.coordinates.concat(f[p].getCoordinates())}h&&(i=g(h));break;default:return null}if(o.chart.coordinates.length>0){var y=0;t.push(y);for(var p=1;p<=o.chart.coordinates.length-1;p++){var m=o.chart.coordinates[p],v=o.chart.coordinates[p-1];y+=Math.hypot(m[0]-v[0],m[1]-v[1]);t.push(parseFloat(y.toFixed(2)))}}for(var C,T,_=!0,p=0;p<o.chart.coordinates.length;p++){if(!(o.chart.coordinates[p].length>2))return l.resolve(null);var S=Math.round(10*o.chart.coordinates[p][2])/10;_&&S>0&&(_=!1);a.push(S);0==p&&(C=T=S);C=Math.min(C,S);T=Math.max(T,S)}}a instanceof Array&&0==a.length&&(_=!0);
o.chartData=_?null:$.extend({},{time:i,ele:a,x:t,miny:C,maxy:T},r);return l.resolve(o.chartData)});return l};a(e).then(function(e){var t=TC.Util.getMapLocale(o.map);if(null!=e){e.time&&(e.time=("00000"+e.time.h).slice(-2)+":"+("00000"+e.time.m).slice(-2)+":"+("00000"+e.time.s).slice(-2));var r=(o.map.options.pointBoundsRadius,document.documentElement.clientWidth/100*40);o.elevationChartSize={height:r>445?128:70,width:r>445?445:r>310?310:215};e=$.extend({},e,{size:{height:o.elevationChartSize.height,width:o.elevationChartSize.width},data:{x:"x",columns:[["x"].concat(e.x),["ele"].concat(e.ele)],types:{ele:"area-spline"},colors:{ele:"url(#grad1)"}},point:{show:!1},axis:{x:{tick:{count:5,format:function(e){e/=1e3;var o,r;if(1>e){o=Math.round(1e3*e);r=" m"}else{o=Math.round(100*e)/100;r=" km"}o=o.toLocaleString(t);return o+r}}},y:{padding:{top:0,bottom:0},max:e.maxy,min:e.miny,tick:{count:2,format:function(e){return parseInt(e.toFixed(0)).toLocaleString(t)+"m"}}}}});o.hasElevation=!0;o.elevationActive.set(!0)}else{o.hasElevation=!1;e={msg:o.getLocaleString("geo.trk.chart.chpe.empty")};o.elevationActive.set(!1)}if(o.resultsPanelChart)o.map.$events.trigger($.Event(o.Const.Event.DRAWTRACK),{data:e});else{TC.control.ResultsPanel||TC.syncLoadJS(TC.apiLocation+"TC/control/ResultsPanel");window.c3||TC.syncLoadJS(TC.Consts.url.D3C3||TC.apiLocation+"lib/d3c3/d3c3.min.js");o.resultsPanelChart=new TC.control.ResultsPanel({div:"results-panel",content:"chart",titles:{main:o.getLocaleString("geo.trk.chart.chpe"),max:o.getLocaleString("geo.trk.chart.chpe")},openOn:o.Const.Event.DRAWTRACK,closeOn:o.Const.Event.CLEARTRACK,chart:{ctx:o,onmouseout:TC.control.Geolocation.prototype.removeTooltip,tooltip:TC.control.Geolocation.prototype.getTooltip}});o.resultsPanelChart.register(o.map);o.resultsPanelChart.render(function(){o.resultsPanelChart.activateSnapping=function(e){o.layerTrack.getVisibility()||0!=o.layerTrack.getOpacity()||o.wrap.deactivateSnapping.call(o.wrap)};o.resultsPanelChart.deactivateSnapping=function(e){o.layerTrack.getVisibility()&&o.layerTrack.getOpacity()>0&&o.wrap.activateSnapping.call(o.wrap)};o.resultsPanelChart._$div.on("mouseover",o.resultsPanelChart.deactivateSnapping);o.resultsPanelChart._$div.on("mouseout",o.resultsPanelChart.activateSnapping);o.track.htmlElevationMarker=document.getElementById("tc-ctl-geolocation-track-elevation-marker");o.map.on(TC.Consts.event.RESULTSPANELMIN,function(){$(o.wrap.miDiv).hide();o.elevationActiveCollapsed.set(!0)});o.map.on(TC.Consts.event.RESULTSPANELMAX,function(){$(o.wrap.miDiv).show();o.elevationActiveCollapsed.set(!1)});o.map.on(TC.Consts.event.RESULTSPANELCLOSE,function(){$(o.wrap.miDiv).hide();o.elevationActive.set(!1)});o.map.on(TC.Consts.event.DRAWCHART,function(e,t){function r(){if(d3.select(".c3-axis-x").length&&!d3.select(".c3-axis-x").node())o.elevationChartLabelsRAF=requestAnimationFrame(r);else if(d3.select(".c3-axis-x").length&&d3.select(".c3-axis-x").node()&&!d3.select(".c3-axis-x").node().getBoundingClientRect().width)o.elevationChartLabelsRAF=requestAnimationFrame(r);else{window.cancelAnimationFrame(o.elevationChartLabelsRAF);o.elevationChartLabelsRAF=void 0;(d3.select(".c3-axis-x").node().getBoundingClientRect().width>=o.elevationChartSize.width-d3.select(".c3-axis-y").node().getBoundingClientRect().width||100*d3.select(".c3-axis-x").node().getBoundingClientRect().width/(o.elevationChartSize.width-d3.select(".c3-axis-y").node().getBoundingClientRect().width)>90)&&g()}}var i=t.svg.getElementsByTagName("defs")[0],n="http://www.w3.org/2000/svg",a=document.createElementNS(n,"linearGradient");a.setAttributeNS(null,"id","grad1");a.setAttributeNS(null,"x1","0%");a.setAttributeNS(null,"x2","0%");a.setAttributeNS(null,"y1","0%");a.setAttributeNS(null,"y2","100%");a.setAttributeNS(null,"gradientUnits","userSpaceOnUse");var l=document.createElementNS(n,"stop");l.setAttributeNS(null,"offset","0%");l.setAttributeNS(null,"stop-color","red");l.setAttributeNS(null,"stop-opacity","0.7");a.appendChild(l);var s=document.createElementNS(n,"stop");s.setAttributeNS(null,"offset","50%");s.setAttributeNS(null,"stop-color","orange");s.setAttributeNS(null,"stop-opacity","0.9");a.appendChild(s);var p=document.createElementNS(n,"stop");p.setAttributeNS(null,"offset","100%");p.setAttributeNS(null,"stop-color","green");p.setAttributeNS(null,"stop-opacity","1");a.appendChild(p);i.appendChild(a);$(d3.select(".c3-brush").node()).remove();d3.select(".c3-event-rects,.c3-event-rects-single").selectAll("rect").style("cursor","pointer").on("click",function(e){d3.event.stopPropagation();var t=this.chart.coordinates[e.index].slice(0,2);t&&TC.loadJS(!TC.feature||TC.feature&&!TC.feature.Point,[TC.apiLocation+"TC/feature/Point"],function(){this.map.zoomToFeatures([new TC.feature.Point(t)])}.bind(o))}.bind(o));var c=d3.select(".c3-axis.c3-axis-x").select("path").attr("d"),u=/^M\d\,(\d)V\dH\d{3}V(\d)$/i.exec(c);if(u){c=c.replace(/(M\d\,)\d/i,"$10").replace(/(H\d{3}V)(\d)/i,"$10");d3.select(".c3-axis.c3-axis-x").select("path").attr("d",c)}else{var u=/^M\s\d\s(\d)\sV\s\d\sH\s\d{3}\sV\s(\d)$/i.exec(c);if(u){c=c.replace(/(M\s\d\s)\d/i,"$10").replace(/(H\s\d{3}\sV\s)(\d)/i,"$10");d3.select(".c3-axis.c3-axis-x").select("path").attr("d",c)}}var g=function(){var e=d3.scale.ordinal().rangeRoundBands([0,o.elevationChartSize.width],.1,.3);d3.select(".c3-axis-x").selectAll("text:not(.c3-axis-x-label)").call(function(e,t){e.each(function(){e.each(function(e,t){if(0!=t){d3text=d3.select(this);if(!d3text.attr("edited")){d3text.attr("edited",!0);var o=d3text.select("tspan").node().cloneNode(),r=d3text.text().split(" ");d3text.select("tspan").text(r[0]);o.textContent=r[1];var i=o.getAttribute("dy");i=i?parseFloat(o.getAttribute("dy")):.71;i=i+.18+"em";o.setAttribute("dy",i);d3text.node().appendChild(o)}}})})},e.rangeBand())};if(d3.select(".c3-axis-x").node().getBoundingClientRect().width)(d3.select(".c3-axis-x").node().getBoundingClientRect().width>=o.elevationChartSize.width-d3.select(".c3-axis-y").node().getBoundingClientRect().width||100*d3.select(".c3-axis-x").node().getBoundingClientRect().width/(o.elevationChartSize.width-d3.select(".c3-axis-y").node().getBoundingClientRect().width)>90)&&g();else{if(o.elevationChartLabelsRAF){window.cancelAnimationFrame(o.elevationChartLabelsRAF);o.elevationChartLabelsRAF=void 0}o.elevationChartLabelsRAF=requestAnimationFrame(r)}});o.map.$events.trigger($.Event(o.Const.Event.DRAWTRACK),{data:e})})}})};e.clear=function(e){var t=this;if(t.onResize){window.removeEventListener("resize",t.onResize,!1);t.onResize=void 0}if(e==t.Const.Layers.TRACK){t.resultsPanelChart&&t.resultsPanelChart.close();delete t.chartData;t.wrap.simulateTrackEnd();t.track.$trackList.find("li").removeClass(t.Const.Classes.SELECTEDTRACK);if(void 0!==t.layerTrack){t.map.removeLayer(t.layerTrack);t.layerTrack=void 0}t.map.$events.trigger($.Event(t.Const.Event.CLEARTRACK),{})}else t.getLayer(e).then(function(e){t.wrap.clear(e)})};e.saveTrack=function(){var e=this,t=new $.Deferred,o=arguments.length>0&&"string"==typeof arguments[0]?arguments[0]:e.getLocaleString("geo.trk.save.alert"),r=function(r){e.getLayer(r).then(function(r){var i;i=e.getLoadingIndicator().addWait();var n=e.importedFileName||e.track.$trackName.val().trim(),a=e.availableTracks;a||(a={});var l=TC.getUID();a.push({name:n,data:e.wrap.formattedToStorage(r,!0),uid:parseInt(l)});a=S(a);var s=function(t){e.track.$trackName.val("");e.track.$trackName.attr("disabled","disabled");e.track.$trackSave.attr("disabled","disabled");e.track.$trackWPT.val("");e.track.$trackWPT.attr("disabled","disabled");e.track.$trackAdd.attr("disabled","disabled");e.getLoadingIndicator().removeWait(t);p.call(e)};try{e.setStoredTracks(a).then(function(){e.map.toast(o,{duration:3e3});s(i);for(var r,n=0;n<a.length;n++)if(parseInt(a[n].uid)===parseInt(l)){r=n;break}t.resolve(r)})}catch(c){TC.alert(e.getLocaleString("geo.error.savelocalstorage")+": "+c.message);s(i);t.reject()}})};if(e.importedFileName)r(e.Const.Layers.TRACK);else if(0==e.track.$trackName.val().trim().length){e.track.$trackName.val((new Date).toLocaleString());r(e.Const.Layers.TRACKING)}else r(e.Const.Layers.TRACKING);return t};e.addWaypoint=function(){var e=this,t=e.track.$trackWPT.val().trim();t||(t=(new Date).toLocaleString());var o=e.getLoadingIndicator().addWait();p.call(e);e.wrap.addWaypoint(e.currentPoint.position,{name:t,ele:e.currentPoint.heading,time:(new Date).getTime()});e.track.$trackWPT.val("");e.track.$trackWPT.attr("disabled","disabled");e.track.$trackAdd.attr("disabled","disabled");TC.Util.storage.setSessionLocalValue(e.Const.LocalStorageKey.TRACKINGTEMP,e.wrap.formattedToStorage(e.layerTracking));e.getLoadingIndicator().removeWait(o)};e.editTrackName=function(e,t){var o=this;o.getAvailableTracks().then(function(r){if(r&&r[e]){r[e].name=t;o.setStoredTracks(r)}})};e.removeTrack=function(e){var t=this;t.getAvailableTracks().then(function(o){if(o){var r=$(e).attr("data-id");if(o[r]){var i=o[r].uid;TC.confirm(t.getLocaleString("geo.trk.delete.alert"),function(){t.getSelectedTrack().length>0&&$(t.getSelectedTrack()[0]).attr("data-id")==r&&t.clear(t.Const.Layers.TRACK);localforage.removeItem(t.Const.LocalStorageKey.TRACKING+"#"+i);1==$(e).parent().find('li[class=""]').length?t.getStoredTracks().then(function(){t.bindTracks()}):$(e).remove()},function(){})}}})};e.setSelectedTrack=function(e){var t=this;t.track.$trackList.find("li[data-id] > span").each(function(){$(this).attr("title",$(this).text())});t.track.$trackList.find("li").removeClass(t.Const.Classes.SELECTEDTRACK);e.addClass(t.Const.Classes.SELECTEDTRACK);$(e).attr("title",t.getLocaleString("tr.lst.clear")+$(e).find("span").text());$(e).find(t.Const.Selector.DRAW).attr("title",$(e).attr("title"))};e.getSelectedTrack=function(){var e=this;return e.track.$trackList.find("li."+e.Const.Classes.SELECTEDTRACK)};e.clearSelectedTrack=function(){var e=this,t=e.getSelectedTrack();if(t){if(e.onResize){window.removeEventListener("resize",e.onResize,!1);e.onResize=void 0}t.removeClass(e.Const.Classes.SELECTEDTRACK);t.attr("title",t.text());t.find(e.Const.Selector.DRAW).attr("title",t.attr("title"))}};e.clearSelection=function(){var e=this;e.wrap.deactivateSnapping();var t=e.getSelectedTrack();t&&e.clearSelectedTrack();if(e.resultsPanelChart){e.resultsPanelChart._$div.off("mouseover",e.resultsPanelChart.deactivateSnapping);e.resultsPanelChart._$div.off("mouseout",e.resultsPanelChart.activateSnapping);e.resultsPanelChart.close();delete e.resultsPanelChart}e.clear(e.Const.Layers.TRACK)};e.drawTrackingData=function(e){var t=this;t.wrap.clear();t.getTrackingData(e).then(function(e){e&&t.wrap.drawTrackingData(e).then(function(){var e=t.layerTrack.features;if(e&&e.length>0)for(var o,r=0;r<e.length;r++){e[r].STYLETYPE.indexOf("line")>-1&&(o=e[r]);e[r].showsPopup=!1}if(o&&o.geometry){var i=o.geometry[0],n=o.geometry[o.geometry.length-1];i&&i!==n&&t.layerTrack.addMarker(i.slice().splice(0,2),{showsPopup:!1,cssClass:t.CLASS+"-track-marker-icon-end",anchor:[.5,1]});n&&t.layerTrack.addMarker(n.slice().splice(0,2),{showsPopup:!1,cssClass:t.CLASS+"-track-marker-icon",anchor:[.5,1]})}})})};e.getTrackingData=function(e){var t=this,o=e,r=new $.Deferred;t.getAvailableTracks().then(function(e){if(e){var t=$(o).attr("data-id");if(e[t])return r.resolve(e[t].data)}return r.resolve()});return r};e["export"]=function(e,t){var o=this;return o.wrap["export"](e,t)};e.getTooltip=function(e){var t=this;return t.wrap.getTooltip(e)};e.removeTooltip=function(){var e=this;$(e.track.htmlElevationMarker).hide()};e.clearFileInput=function(e){var t=$(e);t.wrap("<form>").closest("form").get(0).reset();t.unwrap()};e.getLoadingIndicator=function(){var e=this;if(!e.loading){e.loading=e.map.getControlsByClass(TC.control.LoadingIndicator);e.loading&&e.loading.length>0&&(e.loading=e.loading[0])}return e.loading};e.onGeolocateError=function(e){var t=this;if(navigator.geolocation){t.currentPosition&&navigator.geolocation.clearWatch(t.currentPosition);t.currentPositionTrk&&navigator.geolocation.clearWatch(t.currentPositionTrk)}t.currentPositionWaiting&&t.getLoadingIndicator().removeWait(t.currentPositionWaiting);var o;switch(e.code){case e.PERMISSION_DENIED:o=t.getLocaleString("geo.error.permission_denied");break;case e.POSITION_UNAVAILABLE:o=t.getLocaleString("geo.error.position_unavailable");break;case e.TIMEOUT:o=t.getLocaleString("geo.error.timeout");break;default:o=t.getLocaleString("geo.error.default")}t.map.toast(o,{type:TC.Consts.msgType.WARNING});if(!t.geopositionTracking&&t.track){t.track.$activateButton.toggleClass(TC.Consts.classes.HIDDEN,!1);t.track.$deactivateButton.toggleClass(TC.Consts.classes.HIDDEN,!0)}};var E=function(e){return!e||0===e.length}}();TC.control=TC.control||{};TC.control.FeatureInfoCommons||TC.syncLoadJS(TC.apiLocation+"TC/control/FeatureInfoCommons");!function(){TC.control.GeometryFeatureInfo=function(){var e=this;TC.control.FeatureInfoCommons.apply(this,arguments);e.wrap=new TC.wrap.control.GeometryFeatureInfo(e);e.lineColor=e.options.lineColor?e.options.lineColor:"#c00";e.callback=function(t,o){if(!e._drawToken){e.closeResults();for(var r=!1,i=0;i<e.map.workLayers.length;i++){var n=e.map.workLayers[i];if(n.type===TC.Consts.layerType.WMS&&n.getVisibility()&&n.names.length>0){r=!0;break}}if(r){e.closeResults();e.wrap.beginDraw({geometryType:e.geometryType,xy:t,layer:e.filterLayer,callback:function(t){e.wrap.getFeaturesByGeometry(t)}})}}};e._isDrawing=!1;e._isSearching=!1;e._drawToken=!1};TC.inherit(TC.control.GeometryFeatureInfo,TC.control.FeatureInfoCommons);var e=TC.control.GeometryFeatureInfo.prototype;e.register=function(e){var t=this;TC.control.FeatureInfoCommons.prototype.register.call(t,e);e.on(TC.Consts.event.FEATUREINFOERROR,function(o){o.xhr&&404===o.xhr.status&&e.toast(o.control.getLocaleString("featureInfo.tooManyLayers"),{type:TC.Consts.msgType.ERROR});t.lastFeatureCount=0;t.closeResults()});t.$events.on(TC.Consts.event.CONTROLDEACTIVATE,function(e){t.wrap.cancelDraw()})};e.responseCallback=function(e){var t=this;if(t.filterFeature){var o=e.services;t.info={services:o};for(var r=0;r<o.length;r++){var i=o[r];if(i.hasLimits){delete i.layers;i.hasLimits=i.hasLimits}else{for(var n=0;n<i.layers.length;n++)if(!i.layers[n].features.length){i.layers.splice(n,1);n-=1}if(!i.layers.length){o.splice(r,1);r-=1}}}o.length?t.renderData(e,function(){t._$div.find("td."+t.CLASS+"-val").each(function(e,t){var o=$(t),r=o.text();TC.Util.isURL(r)&&o.html('<a href="'+r+'" target="_blank">'+r+"</a>")});t.displayResults()}):t.resultsLayer.clearFeatures()}}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.LayerCatalog=function(){var e=this;e.layers=[];e.searchInit=!1;TC.Control.apply(e,arguments);e._readyDeferred=$.Deferred();TC.Consts.classes.SELECTABLE||(TC.Consts.classes.SELECTABLE="tc-selectable");TC.Consts.classes.INCOMPATIBLE||(TC.Consts.classes.INCOMPATIBLE="tc-incompatible");TC.Consts.classes.ACTIVE||(TC.Consts.classes.ACTIVE="tc-active");e._$div.on("mouseup.tc","li",function(t){var o=$(t.target);if(!o.hasClass(e.CLASS+"-leaf")){o.toggleClass(TC.Consts.classes.COLLAPSED);o.find("ul").first().toggleClass(TC.Consts.classes.COLLAPSED);t.stopPropagation()}})};TC.inherit(TC.control.LayerCatalog,TC.Control);!function(){var e=TC.control.LayerCatalog.prototype;e.CLASS="tc-ctl-lcat";e.template={};if(TC.isDebug){e.template[e.CLASS]=TC.apiLocation+"TC/templates/LayerCatalog.html";e.template[e.CLASS+"-branch"]=TC.apiLocation+"TC/templates/LayerCatalogBranch.html";e.template[e.CLASS+"-node"]=TC.apiLocation+"TC/templates/LayerCatalogNode.html";e.template[e.CLASS+"-info"]=TC.apiLocation+"TC/templates/LayerCatalogInfo.html";e.template[e.CLASS+"-results"]=TC.apiLocation+"TC/templates/LayerCatalogResults.html"}else{e.template[e.CLASS]=function(){function t(e,t){return e.w("<h2>").h("i18n",t,{},{$key:"availableLayers"}).x(t.get(["enableSearch"],!1),t,{block:o},{}).w('</h2><div class="tc-ctl-lcat-search tc-hidden tc-collapsed"><div class="tc-group"><input type="search" class="tc-ctl-lcat-input tc-textbox" placeholder="').h("i18n",t,{},{$key:"textToSearchInLayers"}).w('" /></div><ul></ul></div><div class="tc-ctl-lcat-tree">').x(t.get(["layerTrees"],!1),t,{"else":i,block:n},{}).w('</div><div class="tc-ctl-lcat-info tc-hidden">').p("tc-ctl-lcat-info",t,t.rebase(t.getPath(!0,[])),{}).w("</div>")}function o(e,t){return e.x(t.get(["layerTrees"],!1),t,{block:r},{})}function r(e,t){return e.w('<button class="tc-ctl-lcat-btn-search" title="').h("i18n",t,{},{$key:"searchlayersbytext"}).w('"></button>')}function i(e,t){return e.w('<div class="tc-ctl tc-ctl-lcat-loading"><span>').h("i18n",t,{},{$key:"loadingLayerTree"}).w("...</span></div>")}function n(e,t){return e.w('<ul class="tc-ctl-lcat-branch">').s(t.get(["layerTrees"],!1),t,{block:a},{}).w("</ul>")}function a(e,t){return e.p("tc-ctl-lcat-branch",t,t.rebase(t.getPath(!0,[])),{})}dust.register(e.CLASS,t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;n.__dustBody=!0;a.__dustBody=!0;return t};e.template[e.CLASS+"-branch"]=function(){function t(e,t){return e.w("<li ").x(t.get(["children"],!1),t,{"else":o,block:r},{}).w(' data-tc-layer-name="').f(t.get(["name"],!1),t,"h").w('" data-tc-layer-uid="').f(t.get(["uid"],!1),t,"h").w('"><span>').f(t.get(["title"],!1),t,"h").w('</span><ul class="tc-ctl-lcat-branch tc-collapsed">').s(t.get(["children"],!1),t,{block:i},{}).w("</ul></li>")}function o(e,t){return e.w('class="tc-ctl-lcat-node tc-ctl-lcat-leaf"')}function r(e,t){return e.w('class="tc-ctl-lcat-node tc-collapsed"')}function i(e,t){return e.p("tc-ctl-lcat-node",t,t.rebase(t.getPath(!0,[])),{})}dust.register(e.CLASS+"-branch",t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;return t};e.template[e.CLASS+"-node"]=function(){function t(e,t){return e.x(t.get(["isVisible"],!1),t,{block:o},{})}function o(e,t){return e.w("<li ").x(t.get(["children"],!1),t,{"else":r,block:i},{}).w(' data-tc-layer-name="').f(t.get(["name"],!1),t,"h").w('" data-tc-layer-uid="').f(t.get(["uid"],!1),t,"h").w('"><span data-tooltip="').x(t.get(["name"],!1),t,{block:n},{}).w('">').f(t.get(["title"],!1),t,"h").w("</span>").x(t.get(["name"],!1),t,{block:a},{}).w('<ul class="tc-ctl-lcat-branch tc-collapsed">').s(t.get(["children"],!1),t,{block:l},{}).w("</ul></li>")}function r(e,t){return e.w('class="tc-ctl-lcat-node tc-ctl-lcat-leaf"')}function i(e,t){return e.w('class="tc-ctl-lcat-node tc-collapsed"')}function n(e,t){return e.h("i18n",t,{},{$key:"clickToAddToMap"})}function a(e,t){return e.w('<button class="tc-ctl-lcat-btn-info"/>')}function l(e,t){return e.p("tc-ctl-lcat-node",t,t.rebase(t.getPath(!0,[])),{})}dust.register(e.CLASS+"-node",t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;n.__dustBody=!0;a.__dustBody=!0;l.__dustBody=!0;return t};e.template[e.CLASS+"-info"]=function(){function t(e,t){return e.w('<a class="tc-ctl-lcat-info-close"></a><h2>').h("i18n",t,{},{$key:"layerInfo"}).w('</h2><h3 class="tc-ctl-lcat-title">').f(t.get(["title"],!1),t,"h").w("</h3>").x(t.get(["abstract"],!1),t,{block:o},{}).x(t.get(["metadata"],!1),t,{block:r},{})}function o(e,t){return e.w('<div class="tc-ctl-lcat-abstract"><h4>').h("i18n",t,{},{$key:"abstract"}).w("</h4><div>").f(t.get(["abstract"],!1),t,"h").w("</div></div>")}function r(e,t){return e.w('<div class="tc-ctl-lcat-metadata"><h4>').h("i18n",t,{},{$key:"metadata"}).w("</h4><ul>").s(t.get(["metadata"],!1),t,{block:i},{}).w("</ul></div>")}function i(e,t){return e.w('<li><a href="').f(t.get(["url"],!1),t,"h",["s"]).w('" type="').f(t.get(["format"],!1),t,"h").w('" title="').f(t.get(["formatDescription"],!1),t,"h").w('" target="_blank">').f(t.get(["formatDescription"],!1),t,"h").w("</a></li>")}dust.register(e.CLASS+"-info",t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;return t};e.template[e.CLASS+"-results"]=function(){function t(e,t){return e.s(t.get(["servicesFound"],!1),t,{"else":o,block:r},{})}function o(e,t){return e.w('<li class="tc-ctl-lcat-no-results"><h5>').h("i18n",t,{},{$key:"noMatches"}).w("</h5></li>")}function r(e,t){return e.h("gt",t,{block:i},{key:t.get(["servicesLooked"],!1),value:1}).s(t.get(["founds"],!1),t,{block:a},{}).h("gt",t,{block:p},{key:t.get(["servicesLooked"],!1),value:1})}function i(e,t){return e.w('<li class="tc-ctl-lcat-search-group ').x(t.getPath(!1,["service","isCollapsed"]),t,{block:n},{}).w('" data-tc-service-index="').f(t.getPath(!1,["service","index"]),t,"h").w('"><h5>').f(t.getPath(!1,["service","title"]),t,"h").w("</h5><ul>")}function n(e,t){return e.w("tc-collapsed")}function a(e,t){return e.w('<li data-tc-layer-name="').f(t.get(["Name"],!1),t,"h").w('" ').x(t.get(["alreadyAdded"],!1),t,{"else":l,block:s},{}).w('><h5 class="tc-selectable">').f(t.get(["Title"],!1),t,"h").w('</h5><button class="tc-ctl-lcat-search-btn-info" /></li>')}function l(e,t){return e.w(' data-tooltip="').h("i18n",t,{},{$key:"clickToAddToMap"}).w('" ')}function s(e,t){return e.w(' data-tooltip="').h("i18n",t,{},{$key:"layerAlreadyAdded"}).w('" class="tc-checked" ')}function p(e,t){return e.w("</ul></li>")}dust.register(e.CLASS+"-results",t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;n.__dustBody=!0;a.__dustBody=!0;l.__dustBody=!0;s.__dustBody=!0;p.__dustBody=!0;return t}}!function(){var t={LAYER:"tcLayer",LAYERNAME:"tcLayerName",LAYERINFO:"tcLayerInfo",SERVICEINDEX:"tcServiceIndex"},o=3,r="data-tooltip";e.register=function(e){var o=this;TC.Control.prototype.register.call(o,e);var i=function(){if($.isArray(o.options.layers)){for(var e=0;e<o.options.layers.length;e++){var t=o.options.layers[e];if(!t.type||t.type===TC.Consts.layerType.WMS){t.id||(t.id=TC.getUID());$.isPlainObject(t)&&(t=new TC.layer.Raster(t));o.layers.push(t)}}o.render(function(){o._readyDeferred.resolve()})}else o._readyDeferred.resolve()},n=function(t){if(t.layer===e.baseLayer){i();e.off(TC.Consts.event.LAYERUPDATE,n)}};e.loaded(function(){e.baseLayer.state&&e.baseLayer.state!==TC.Layer.state.IDLE?e.on(TC.Consts.event.LAYERUPDATE,n):i()});var a=function(e){var r=$();if(!e.isBase){var i=e.options.url;o._$roots&&o._$roots.each(function(o,n){var a=$(n),l=a.data(t.LAYER);l&&l.type===e.type&&l.options.url===i&&(r=r.add(a))})}return r},l=function(e,t){var o=$(),r=t||a(e);if(r.length)for(var i=0;i<e.names.length;i++){var n=r.find('li[data-tc-layer-name="'+e.names[i]+'"]');o=o.add(n);o=o.add(n.find("li"))}return o},s=function(e){var r=$();if(!e.isBase){var i=e.options.url;o.$list&&o.$list.find("li").each(function(o,n){var a=$(n),l=a.data(t.LAYER);if(l&&l.type===e.type&&l.options.url===i)for(var s=0;s<e.names.length;s++)a.is('li[data-tc-layer-name="'+e.names[s]+'"]')&&(r=r.add(a))})}return r},p=function(){if("createEvent"in document){var e=document.createEvent("HTMLEvents");e.initEvent("keyup",!1,!0);o.$text&&o.$text[0].dispatchEvent(e)}else o.$text&&o.$text[0].fireEvent("keyup")},c=function(e){var t=o.map.getControlsByClass(TC.control.ListTOC)[0];if(t)for(var i=t.layers,n=0;n<i.length;n++){var a=i[n];a!==e&&l(a).addClass(TC.Consts.classes.CHECKED).find("span").attr(r,u)}},u=o.getLocaleString("layerAlreadyAdded"),g=o.getLocaleString("clickToAddToMap");e.on(TC.Consts.event.BEFORELAYERADD+" "+TC.Consts.event.BEFOREUPDATEPARAMS,function(e){l(e.layer).hasClass(TC.Consts.classes.LOADING)||l(e.layer).addClass(TC.Consts.classes.LOADING).find("span").removeAttr(r)}).on(TC.Consts.event.LAYERADD+" "+TC.Consts.event.UPDATEPARAMS,function(e){var t=e.layer;t.isBase||t.type!==TC.Consts.layerType.WMS||o._readyDeferred.then(function(){var e=a(t),i=function(){l(t,e).removeClass(TC.Consts.classes.LOADING).addClass(TC.Consts.classes.CHECKED).find("span").attr(r,u);p()};if(e.length)i();else{for(var n=!1,s=0,c=o.layers.length;c>s;s++){var g=o.layers[s];if(g.type===t.type&&g.options.url===t.options.url){n=!0;break}}n||o.addLayer(new TC.layer.Raster({url:t.options.url,type:t.type,layerNames:[],title:t.title||t.wrap.getServiceTitle(),hideTitle:!0,hideTree:!1})).then(function(){e=a(t);i()})}})}).on(TC.Consts.event.LAYERERROR,function(e){e.reason&&TC.alert(o.getLocaleString(e.reason,{url:e.layer.url}));l(e.layer).removeClass(TC.Consts.classes.LOADING)}).on(TC.Consts.event.LAYERREMOVE,function(e){l(e.layer).removeClass(TC.Consts.classes.CHECKED).find("span").attr(r,g);s(e.layer).removeClass(TC.Consts.classes.CHECKED).attr(r,g);c(e.layer);p()}).on(TC.Consts.event.EXTERNALSERVICEADDED,function(e){if(e&&e.layer){o.addLayer(e.layer);o._$div.removeClass("tc-collapsed")}});o._$div.on(TC.Consts.event.CLICK,"span",function(i){var n=$(i.target),a=n.parent();if(!a.hasClass(TC.Consts.classes.LOADING)&&!a.hasClass(TC.Consts.classes.CHECKED)){i.preventDefault;var l=a.data(t.LAYERNAME);l=void 0!==l?l.toString():"";var s=o._$roots.has(a).data(t.LAYER);s||(s=a.data(t.LAYER));if(s&&l){var p=1;/iPad/i.test(navigator.userAgent)?p=10:TC.Util.detectFirefox()&&(p=250);s.title||(s.title=s.getTree().title);a.addClass(TC.Consts.classes.LOADING).find("span").attr(r,"");var c=function(e){var t=new $.Deferred;setTimeout(function(){e[0].offsetHeight=e[0].offsetHeight;e[0].offsetWidth=e[0].offsetWidth;t.resolve()},p);return t.promise()};c(a).then(function(){var t=$.extend({},s.options);t.id=TC.getUID();t.layerNames=[l];e.addLayer(t).then(function(e){e.wrap.$events.on(TC.Consts.event.TILELOADERROR,function(e){var t=this.parent;(401===e.error.code||403===e.error.code)&&t.map.toast(e.error.text,{type:TC.Consts.msgType.ERROR});t.map.removeLayer(t)})});i.stopPropagation()})}}})};e.render=function(e){var i=this,n=$.map(i.layers,function(e){return e.wrap.getLayer()});$.when.apply(i,n).then(function(){var n=$.map(i.layers,function(e){var t=e.getTree(),o=function r(t){for(var o=!1,i=0;i<t.children.length;i++)r(t.children[i])&&(o=!0);t.hasOwnProperty("isVisible")&&(t.isVisible=!e.names||!e.names.length||o||t.isVisible);return t.isVisible};o(t);return t});i.renderData({layerTrees:n,enableSearch:i.options.enableSearch},function(){var n=i.getLocaleString("layerAlreadyAdded");i._$roots=i._$div.find("div."+i.CLASS+"-tree > ul."+i.CLASS+"-branch > li."+i.CLASS+"-node");i._$roots.each(function(e,o){var a=i.layers[e],l=$(o).data(t.LAYER,a),s=l.find("."+i.CLASS+"-btn-info"),p={};s.each(function(e,o){var l=$(o),s=l.parent().find("span").first(),c=l.parent().data(t.LAYERNAME).toString();if(c){s.addClass(TC.Consts.classes.SELECTABLE);var u=a.wrap.getInfo(c);if(u.hasOwnProperty("abstract")||u.hasOwnProperty("legend")||u.hasOwnProperty("metadata")){if(u.metadata)for(var g=0,d=u.metadata.length;d>g;g++){var h=u.metadata[g];h.formatDescription=p[h.format]=p[h.format]||i.getLocaleString(TC.Util.getSimpleMimeType(h.format))||i.getLocaleString("viewMetadata")}l.data(t.LAYERINFO,u);l.on(TC.Consts.event.CLICK,function(){if($(this).hasClass(TC.Consts.classes.CHECKED)){$(this).removeClass(TC.Consts.classes.CHECKED);i.hideLayerInfo()}else{i.showLayerInfo(a,c);$(this).addClass(TC.Consts.classes.CHECKED)}})}else l.remove();a.compatibleLayers&&a.compatibleLayers.indexOf(c)<0&&s.parent().append('<span class="'+TC.Consts.classes.INCOMPATIBLE+'" title="'+i.getLocaleString("srsNotCompatible")+'"></span>');if(i.map)for(var g=0,d=i.map.workLayers.length;d>g;g++){var f=i.map.workLayers[g];if(f.type===TC.Consts.layerType.WMS&&f.url===a.url&&1===f.names.length&&f.names[0]===c){s.parent().addClass(TC.Consts.classes.CHECKED);s.attr(r,n)}}}else{s.attr(r,"");l.remove()}})});i.$text=i._$div.find("."+i.CLASS+"-input");i.$list=i._$div.find("."+i.CLASS+"-search ul");i.$text.on("mouseup",function(e){var t=i.$text.val();""!==t&&setTimeout(function(){var e=i.$text.val();""===e&&i.$list.empty()},1)});var a=[];TC._search=TC._search||{};TC._search.retryTimeout=null;TC.loadJS(!i.$text.autocomplete,[TC.apiLocation+"lib/jQuery/autocomplete.js"],function(){i.$text.autocomplete({link:"#",target:i.$list,minLength:0,source:function(e,r){a=[];i._$roots.find("li."+TC.Consts.classes.CHECKED).each(function(e,o){a.push($(o).data(t.LAYERNAME).toString())});e=e.trim();if(e.length<o)i.$list.html("");else if(e.length>=o){TC._search.retryTimeout&&clearTimeout(TC._search.retryTimeout);TC._search.retryTimeout=setTimeout(function(){for(var t=[],o=0;o<i.layers.length;o++){var n=i.layers[o].searchSubLayers(e);n.length&&t.push({service:{index:o,title:i.layers[o].title||i.layers[o].id},founds:n})}r({servicesFound:t,servicesLooked:i.layers.length})},TC._search.interval)}},callback:function(e){i.$text.val(e.target.text||e.target.innerText);TC._search.lastPattern=i.$text.val();i.goToResult(unescape(e.target.hash).substring(1));i.$text.autocomplete("clear")},buildHTML:function(e){if(e.results&&e.results.servicesFound.length>0)for(var t=i.map.getLayerTree().workLayers,o=0;o<e.results.servicesFound.length;o++){for(var r=e.results.servicesFound[o].founds,n=0;n<r.length;n++){delete r[n].alreadyAdded;for(var l=0;l<t.length;l++)if(a.indexOf(r[n].Name)>=0){r[n].alreadyAdded=!0;break}if(!r[n].Name){r.splice(n,1);n--}}e.results.servicesFound[o].founds.length?e.results.servicesFound[o].service.isCollapsed=$(i._$div.find(".tc-ctl-lcat-search-group")[o]).hasClass(TC.Consts.classes.COLLAPSED):e.results.servicesFound.splice(o,1)}var s="";dust.render(i.CLASS+"-results",e.results,function(e,t){s=t});return s}})});if(!i.searchInit){i._$div.on("click","h2 button",function(){var e=i._$div.hasClass("tc-collapsed");i._$div.removeClass("tc-collapsed");var t=i._$div.find("."+i.CLASS+"-search"),o=i._$div.find("."+i.CLASS+"-tree"),r=i._$div.find("."+i.CLASS+"-info");if(t.hasClass(TC.Consts.classes.HIDDEN)||e){t.removeClass(TC.Consts.classes.HIDDEN);o.addClass(TC.Consts.classes.HIDDEN);i.$text[0].focus();$(this).addClass(i.CLASS+"-btn-tree");$(this).attr("title",i.getLocaleString("viewAvailableLayersTree"));$(this).removeClass(i.CLASS+"-btn-search");var n=$(".tc-ctl-lcat-search li button.tc-checked").length;0===n&&r.addClass(TC.Consts.classes.HIDDEN)}else{t.addClass(TC.Consts.classes.HIDDEN);o.removeClass(TC.Consts.classes.HIDDEN);$(this).addClass(i.CLASS+"-btn-search");$(this).attr("title",i.getLocaleString("searchLayersByText"));$(this).removeClass(i.CLASS+"-btn-tree");var n=$(".tc-ctl-lcat-tree li button.tc-checked").length;n>0&&r.removeClass(TC.Consts.classes.HIDDEN)}});i._$div.on("click","."+i.CLASS+"-search button."+i.CLASS+"-search-btn-info",function(e){e.stopPropagation();if($(this).hasClass(TC.Consts.classes.CHECKED)){$(this).removeClass(TC.Consts.classes.CHECKED);i.hideLayerInfo()}else{var o=$(this).parent();i.showLayerInfo(i.layers[o.parents("li").data(t.SERVICEINDEX)],o.data(t.LAYERNAME));$(this).addClass(TC.Consts.classes.CHECKED)}});i._$div.on("click",".tc-ctl-lcat-search li",function(e){e.stopPropagation();var o=$(this);if(!o.hasClass("tc-ctl-lcat-no-results"))if(o.hasClass("tc-ctl-lcat-search-group"))o.toggleClass(TC.Consts.classes.COLLAPSED);else{var a=o.data(t.LAYERNAME);a=void 0!==a?a.toString():"";if(!$(this).hasClass(TC.Consts.classes.CHECKED)){var l=o.parents("li.tc-ctl-lcat-search-group"),s=i.layers[0==l.length?0:l.data(t.SERVICEINDEX)].options.url,p=i.layers[0==l.length?0:l.data(t.SERVICEINDEX)].title;i.map.addLayer({id:TC.getUID(),url:s,title:p,hideTitle:!0,layerNames:[a]},function(e){o.data(t.LAYER,e);e.wrap.$events.on(TC.Consts.event.TILELOADERROR,function(e){var t=this.parent;(401===e.error.code||403===e.error.code)&&t.map.toast(e.error.text,{type:TC.Consts.msgType.ERROR});t.map.removeLayer(t)})});$(this).addClass(TC.Consts.classes.CHECKED);$(this).attr(r,n)}}});i.searchInit=!0}$.isFunction(e)&&e()})})};e.showLayerInfo=function(e,o){var r=this,i=null,n=r._$div.find("."+r.CLASS+"-info"),a=function(e,o){{var i=!1;n.data(t.LAYERNAME)}if(o){i=!0;n.data(t.LAYERNAME,e);n.removeClass(TC.Consts.classes.HIDDEN);dust.render(r.CLASS+"-info",o,function(e,t){n.html(t);e&&TC.error(e);n.find("."+r.CLASS+"-info-close").on(TC.Consts.event.CLICK,function(){r.hideLayerInfo()})})}return i};r._$div.find("."+r.CLASS+"-btn-info, ."+r.CLASS+"-search-btn-info").removeClass(TC.Consts.classes.CHECKED);r._$roots.each(function(n,l){var s=$(l);if(s.data(t.LAYER)===e){var p=s.find("."+r.CLASS+"-btn-info");

p.each(function(e,n){var l=$(n),s=l.parent().data(t.LAYERNAME).toString();if(s===o){var p=l.data(t.LAYERINFO);r._$div.find('li [data-tc-layer-name="'+s+'"] > button').toggleClass(TC.Consts.classes.CHECKED,a(s,p));i=p;return!1}});return!1}});return i}}();e.hideLayerInfo=function(){var e=this;e._$div.find("."+e.CLASS+"-btn-info, ."+e.CLASS+"-search-btn-info").removeClass(TC.Consts.classes.CHECKED);e._$div.find("."+e.CLASS+"-info").addClass(TC.Consts.classes.HIDDEN)};e.addLayer=function(e){var t=$.Deferred(),o=this,r=[];o.options.layers&&o.options.layers.length&&(r=$.grep(o.options.layers,function(t){var o=TC.Util.reqGetMapOnCapabilities(t.url);return o&&o.replace(TC.Util.regex.PROTOCOL)==e.url.replace(TC.Util.regex.PROTOCOL)}));0==r.length&&(r=$.grep(o.layers,function(t){return t.url.replace(TC.Util.regex.PROTOCOL)==e.url.replace(TC.Util.regex.PROTOCOL)}));if(0==r.length){o.layers.push(e);e.getCapabilitiesPromise().then(function(){e.compatibleLayers=e.wrap.getCompatibleLayers(o.map.crs);e.title=e.title||e.wrap.getServiceTitle();o.render(function(){t.resolve()})})}else t.resolve();return t};e.loaded=function(){return this._readyDeferred.promise()}}();TC.control=TC.control||{};TC.control.MapContents||TC.syncLoadJS(TC.apiLocation+"TC/control/MapContents");TC.control.Legend=function(){TC.control.MapContents.apply(this,arguments)};TC.inherit(TC.control.Legend,TC.control.MapContents);!function(){var e=TC.control.Legend.prototype;e.CLASS="tc-ctl-legend";e.template={};if(TC.isDebug){e.template[e.CLASS]=TC.apiLocation+"TC/templates/Legend.html";e.template[e.CLASS+"-node"]=TC.apiLocation+"TC/templates/LegendNode.html"}else{e.template[e.CLASS]=function(){function t(e,t){return e.w("<h2>").h("i18n",t,{},{$key:"legend"}).w('</h2><div class="tc-ctl-legend-tree"><ul class="tc-ctl-legend-branch">').s(t.get(["workLayers"],!1),t,{"else":o,block:r},{}).w("</ul></div>")}function o(e,t){return e.w('<li class="tc-ctl-legend-empty">').h("i18n",t,{},{$key:"noData"}).w("</li>")}function r(e,t){return e.p("tc-ctl-legend-node",t,t.rebase(t.getPath(!0,[])),{})}dust.register(e.CLASS,t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;return t};e.template[e.CLASS+"-node"]=function(){function t(e,t){return e.w("<li ").x(t.get(["children"],!1),t,{"else":o,block:r},{}).w(' data-tc-layer-name="').f(t.get(["name"],!1),t,"h").w('" data-tc-layer-uid="').f(t.get(["uid"],!1),t,"h").w('"><div class="tc-ctl-legend-title">').f(t.get(["title"],!1),t,"h").w("</div>").x(t.get(["legend"],!1),t,{block:i},{}).w('<ul class="tc-ctl-legend-branch">').s(t.get(["children"],!1),t,{block:p},{}).w("</ul></li>")}function o(e,t){return e.w('class="tc-ctl-legend-node tc-ctl-legend-leaf" ')}function r(e,t){return e.w('class="tc-ctl-legend-node" ')}function i(e,t){return e.w('<div class="tc-ctl-legend-watch">').x(t.getPath(!1,["legend","src"]),t,{"else":n,block:l},{}).w('</div><div class="tc-ctl-legend-nvr">').h("i18n",t,{},{$key:"notVisibleAtCurrentResolution"}).w("</div>")}function n(e,t){return e.w('<div class="tc-ctl-legend-img" style="border:solid ').f(t.getPath(!1,["legend","strokeWidth"]),t,"h").w("px ").f(t.getPath(!1,["legend","strokeColor"]),t,"h").w(";background-color:").f(t.getPath(!1,["legend","fillColor"]),t,"h").x(t.getPath(!1,["legend","width"]),t,{block:a},{}).w('"></div>')}function a(e,t){return e.w(";width:").f(t.getPath(!1,["legend","width"]),t,"h").w("px;height:").f(t.getPath(!1,["legend","height"]),t,"h").w("px;border-radius:50%")}function l(e,t){return e.w('<img src="" data-tc-img="').f(t.getPath(!1,["legend","src"]),t,"h").w('" ').x(t.getPath(!1,["legend","width"]),t,{block:s},{}).w(" />")}function s(e,t){return e.w('style="width:').f(t.getPath(!1,["legend","width"]),t,"h").w("px;height:").f(t.getPath(!1,["legend","height"]),t,"h").w('px;"')}function p(e,t){return e.p("tc-ctl-legend-node",t,t.rebase(t.getPath(!0,[])),{})}dust.register(e.CLASS+"-node",t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;n.__dustBody=!0;a.__dustBody=!0;l.__dustBody=!0;s.__dustBody=!0;p.__dustBody=!0;return t}}var t={layer:"tcLayer",layerUid:"tcLayerUid"};e.register=function(e){var t=this;TC.control.MapContents.prototype.register.call(t,e)};e.loadGraphics=function(){var e=this;e._$div.find("ul."+e.CLASS+"-branch").first().children("li").not("."+e.CLASS+"-empty").each(function(o,r){var i=$(r),n=i.data(t.layer);i.find("li").each(function(t,o){var r=$(o),i=r.find("img").first();i&&void 0!=i.attr("src")&&0==i.attr("src").length&&e.styleLegendImage(i,n)})})};e.updateScale=function(){var e=this,o=e.CLASS+"-node-inscale",r=e.CLASS+"-node-outofscale";e._$div.find("ul."+e.CLASS+"-branch").first().children("li").not("."+e.CLASS+"-empty").each(function(i,n){var a=$(n),l=a.data(t.layer);if(l){var s=!1;a.find("li").each(function(i,n){var a=$(n);if(a.hasClass(e.CLASS+"-node-visible")){var p=a.data(t.layerUid);if(l.isVisibleByScale(p)){s=!0;a.removeClass(r).addClass(o);var c=a.find("img").first();c.length>0&&e.styleLegendImage(c,l)}else a.addClass(r).removeClass(o)}});a.toggleClass(o,s);a.toggleClass(r,!s)}})};e.update=function(){var e=this;e._$div.find("ul."+e.CLASS+"-branch").first().children("li").each(function(o,r){var i=$(r),n=i.data(t.layer);if(n){n.getTree();i.find("li").each(function(o,r){var i=$(r),a=i.data(t.layerUid),l=e.CLASS+"-node-visible",s=e.CLASS+"-node-notvisible",p=e.CLASS+"-node-hasvisible";switch(n._cache.visibilityStates[a]){case TC.Consts.visibility.NOT_VISIBLE:i.removeClass(l+" "+p).addClass(s);break;case TC.Consts.visibility.HAS_VISIBLE:i.removeClass(l+" "+s).addClass(p);break;default:i.removeClass(s+" "+p).addClass(l)}});e.updateLayerVisibility(n)}});e.updateScale()};e.updateLayerTree=function(e){var o=this;if(!e.isBase&&!e.options.stealth){TC.control.MapContents.prototype.updateLayerTree.call(o,e);o._$div.find("."+o.CLASS+"-empty").addClass(TC.Consts.classes.HIDDEN);TC.loadJSInOrder(!window.dust,TC.url.templating,function(){dust.render(o.CLASS+"-node",o.layerTrees[e.id],function(r,i){var n=$(i),a=n.data(t.layerUid),l=o._$div.find("ul."+o.CLASS+"-branch").first(),s=l.find('li[data-tc-layer-uid="'+a+'"]');if(1===s.length)s.html(n.html());else{n.data(t.layer,e);l.prepend(n)}r&&TC.error(r)});o.update()})}};e.removeLayer=function(e){var o=this,r=function(){return o._$div.find("."+o.CLASS+"-branch").first().children("li").not("."+o.CLASS+"-empty")};if(!e.isBase){var i=r();i.each(function(o,n){var a=$(n);if(a.data(t.layer)===e){a.remove();i=r();return!1}});0===i.length&&o._$div.find("."+o.CLASS+"-empty").removeClass(TC.Consts.classes.HIDDEN)}};e.updateLayerVisibility=function(e){var o=this;o._$div.find("."+o.CLASS+"-branch").first().children("li").each(function(r,i){var n=$(i);if(n.data(t.layer)===e){n.toggleClass(o.CLASS+"-node-notvisible",!e.getVisibility());return!1}})};e.getLayerUIElements=function(){var e=this;return e._$div.find("ul."+e.CLASS+"-branch").first().children("li."+e.CLASS+"-node")}}();TC.control=TC.control||{};TC.control.GeometryFeatureInfo||TC.syncLoadJS(TC.apiLocation+"TC/control/GeometryFeatureInfo");!function(){TC.control.LineFeatureInfo=function(){var e=this;TC.control.GeometryFeatureInfo.apply(this,arguments);e.geometryType=TC.Consts.geom.POLYLINE};TC.inherit(TC.control.LineFeatureInfo,TC.control.GeometryFeatureInfo);var e=TC.control.LineFeatureInfo.prototype;e.CLASS="tc-ctl-finfo";e.template={};if(TC.isDebug){e.template[e.CLASS]=TC.apiLocation+"TC/templates/FeatureInfo.html";e.template[e.CLASS+"-dialog"]=TC.apiLocation+"TC/templates/FeatureInfoDialog.html"}else{e.template[e.CLASS]=function(){function t(e,t){return e.w('<ul class="tc-ctl-finfo-services">').s(t.get(["services"],!1),t,{"else":o,block:r},{}).w("</ul>").x(t.get(["featureCount"],!1),t,{block:L},{})}function o(e,t){return e.w('<li class="tc-ctl-finfo-empty">').h("i18n",t,{},{$key:"noData"}).w("</li>")}function r(e,t){return e.w("<li><h3>").x(t.getPath(!1,["mapLayer","title"]),t,{"else":i,block:n},{}).w('</h3><div class="tc-ctl-finfo-service-content">').s(t.get(["hasLimits"],!1),t,{"else":a,block:P},{}).w("</div></li>")}function i(e,t){return e.f(t.getPath(!1,["mapLayer","id"]),t,"h")}function n(e,t){return e.f(t.getPath(!1,["mapLayer","title"]),t,"h")}function a(e,t){return e.w('<ul class="tc-ctl-finfo-layers">').s(t.get(["layers"],!1),t,{"else":l,block:s},{}).w("</ul>")}function l(e,t){return e.w('<li class="tc-ctl-finfo-empty">').h("i18n",t,{},{$key:"noDataAtThisService"}).w("</li>")}function s(e,t){return e.w("<li><h4>").s(t.get(["path"],!1),t,{block:p},{}).w(' <span class="tc-ctl-finfo-layer-n">').f(t.getPath(!1,["features","length"]),t,"h").w('</span> </h4> <div class="tc-ctl-finfo-layer-content"><ul class="tc-ctl-finfo-features">').s(t.get(["features"],!1),t,{"else":u,block:g},{}).w("</ul></div></li>")}function p(e,t){return e.f(t.getPath(!0,[]),t,"h").h("sep",t,{block:c},{})}function c(e,t){return e.w(" &bull; ")}function u(e,t){return e.w('<li class="tc-ctl-finfo-empty">').h("i18n",t,{},{$key:"noDataInThisLayer"}).w("</li>")}function g(e,t){return e.w("<li>").x(t.get(["rawContent"],!1),t,{"else":d,block:C},{}).w("</li>")}function d(e,t){return e.x(t.get(["error"],!1),t,{"else":h,block:v},{})}function h(e,t){return e.w("<h5>").f(t.get(["id"],!1),t,"h").w("</h5><table").x(t.get(["geometry"],!1),t,{block:f},{}).w("><tbody>").s(t.get(["attributes"],!1),t,{block:y},{}).w("</tbody></table>").x(t.get(["geometry"],!1),t,{block:m},{})}function f(e,t){return e.w(' title="').h("i18n",t,{},{$key:"clickToCenter"}).w('"')}function y(e,t){return e.w('<tr><th class="tc-ctl-finfo-attr">').f(t.get(["name"],!1),t,"h").w('</th><td class="tc-ctl-finfo-val">').f(t.get(["value"],!1),t,"h").w("</td></tr>")}function m(e,t){return e.w('<div class="tc-ctl-finfo-tools"><button class="tc-ctl-finfo-tools-btn" title="').h("i18n",t,{},{$key:"download"}).w("/").h("i18n",t,{},{$key:"share"}).w('">').h("i18n",t,{},{$key:"download"}).w("/").h("i18n",t,{},{$key:"share"}).w("</button></div>")}function v(e,t){return e.w('<span class="tc-ctl-finfo-errors">').h("i18n",t,{},{$key:"fi.error"}).w('<span class="tc-ctl-finfo-error-text">').f(t.get(["error"],!1),t,"h").w("</span></span>")}function C(e,t){return e.w("<h5>").h("i18n",t,{},{$key:"feature"}).w("</h5>").h("eq",t,{"else":T,block:_},{key:t.get(["rawFormat"],!1),value:"text/html"})}function T(e,t){return e.w("<pre>").f(t.get(["rawContent"],!1),t,"h").w("</pre>")}function _(e,t){return e.w(" ").x(t.get(["expandUrl"],!1),t,{block:S},{})}function S(e,t){return e.h("ne",t,{"else":E,block:x},{key:t.get(["expandUrl"],!1),value:""})}function E(e,t){return e.w('<iframe src="').f(t.get(["rawUrl"],!1),t,"h").w('" />')}function x(e,t){return e.w('<div class="tc-ctl-finfo-features-iframe-cnt"><iframe src="').f(t.get(["rawUrl"],!1),t,"h").w('" /><a class="tc-ctl-finfo-open" onclick="window.open(\'').f(t.get(["expandUrl"],!1),t,"h").w("', '_blank')\" title=\"").h("i18n",t,{},{$key:"expand"}).w('"></a></div>')}function P(e,t){return e.w('<span class="tc-ctl-finfo-errors">').f(t.get(["hasLimits"],!1),t,"h").w("</span>")}function L(e,t){return e.h("gt",t,{block:w},{key:t.get(["featureCount"],!1),value:"1",type:"number"})}function w(e,t){return e.w('<a class="tc-ctl-btn tc-ctl-finfo-btn-prev">').h("i18n",t,{},{$key:"previous"}).w('</a><div class="tc-ctl-finfo-counter"><span class="tc-ctl-finfo-idx"></span>/').f(t.get(["featureCount"],!1),t,"h").w('</div><a class="tc-ctl-btn tc-ctl-finfo-btn-next">').h("i18n",t,{},{$key:"next"}).w("</a>")}dust.register(e.CLASS,t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;n.__dustBody=!0;a.__dustBody=!0;l.__dustBody=!0;s.__dustBody=!0;p.__dustBody=!0;c.__dustBody=!0;u.__dustBody=!0;g.__dustBody=!0;d.__dustBody=!0;h.__dustBody=!0;f.__dustBody=!0;y.__dustBody=!0;m.__dustBody=!0;v.__dustBody=!0;C.__dustBody=!0;T.__dustBody=!0;_.__dustBody=!0;S.__dustBody=!0;E.__dustBody=!0;x.__dustBody=!0;P.__dustBody=!0;L.__dustBody=!0;w.__dustBody=!0;return t};e.template[e.CLASS+"-dialog"]=function(){function t(e,t){return e.w('<div class="tc-ctl-finfo-dialog tc-modal"><div class="tc-modal-background tc-modal-close"></div><div class="tc-modal-window"><div class="tc-modal-header"><h3>').h("i18n",t,{},{$key:"feature"}).w('</h3><div class="tc-ctl-popup-close tc-modal-close"></div></div><div class="tc-modal-body"><div class="tc-ctl-finfo-dialog-dl"><h2>').h("i18n",t,{},{$key:"download"}).w('</h2><div><button class="tc-button tc-ctl-finfo-dl-btn-kml" data-format="KML" title="KML">KML</button><button class="tc-button tc-ctl-finfo-dl-btn-gml" data-format="GML" title="GML">GML</button><button class="tc-button tc-ctl-finfo-dl-btn-geojson" data-format="GeoJSON" title="GeoJSON">GeoJSON</button><button class="tc-button tc-ctl-finfo-dl-btn-wkt" data-format="WKT" title="WKT">WKT</button></div></div><div class="tc-ctl-finfo-dialog-share"></div></div><div class="tc-modal-footer"><button type="button" class="tc-button tc-modal-close">').h("i18n",t,{},{$key:"close"}).w("</button></div></div></div>")}dust.register(e.CLASS+"-dialog",t);t.__dustBody=!0;return t}}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.LoadingIndicator=function(){var e=this;TC.Control.apply(e,arguments);window.addEventListener("error",function(){e.reset();return!1},!1)};TC.inherit(TC.control.LoadingIndicator,TC.Control);!function(){var e=TC.control.LoadingIndicator.prototype;e.CLASS="tc-ctl-load";e.template=TC.isDebug?TC.apiLocation+"TC/templates/LoadingIndicator.html":function(){function t(e,t){return e.w('<div class="tc-ctl-load-bar"><div class="tc-ctl-load-dots tc-ctl-load-dot1"> </div><div class="tc-ctl-load-dots tc-ctl-load-dot2"> </div><div class="tc-ctl-load-dots tc-ctl-load-dot3"> </div><div class="tc-ctl-load-dots tc-ctl-load-dot4"> </div><div class="tc-ctl-load-dots tc-ctl-load-dot5"> </div><div class="tc-ctl-load-dots tc-ctl-load-dot6"> </div><div class="tc-ctl-load-dots tc-ctl-load-dot7"> </div><div class="tc-ctl-load-dots tc-ctl-load-dot8"> </div></div>')}dust.register(e.CLASS,t);t.__dustBody=!0;return t};e.waits={};e.startWait=function(t){var o=this;void 0===e.waits[t.layer.id]&&(e.waits[t.layer.id]=0);e.waits[t.layer.id]=e.waits[t.layer.id]+1;o.show();o.map.$events.trigger($.Event(TC.Consts.event.STARTLOADING))};e.stopWait=function(t){var o=this,r=e.waits[t.layer.id];r>0&&(r=e.waits[t.layer.id]=r-1);r||delete e.waits[t.layer.id];var i=0;for(var n in e.waits)i++;if(!i){o.map?o.map.isLoaded&&o.hide():o.hide();o.map.$events.trigger($.Event(TC.Consts.event.STOPLOADING))}};e.reset=function(t){var o=this;e.waits={};o.hide();o.map.$events.trigger($.Event(TC.Consts.event.STOPLOADING))};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);e.on(TC.Consts.event.BEFORELAYERADD+" "+TC.Consts.event.BEFORELAYERUPDATE+" "+TC.Consts.event.BEFOREFEATURESADD,function(e){t.startWait(e)}).on(TC.Consts.event.LAYERADD+" "+TC.Consts.event.LAYERERROR+" "+TC.Consts.event.LAYERUPDATE+" "+TC.Consts.event.FEATURESADD,function(e){t.stopWait(e)}).on(TC.Consts.event.BEFOREFEATUREINFO,function(e){t.addWait(TC.Consts.event.FEATUREINFO)}).on(TC.Consts.event.FEATUREINFO+" "+TC.Consts.event.NOFEATUREINFO+" "+TC.Consts.event.FEATUREINFOERROR,function(e){t.removeWait(TC.Consts.event.FEATUREINFO)});if(!TC.isDebug){window.addEventListener("error",function(e,o,r,i,n){t.reset();return!1});$(document).ajaxError(function(e,o,r){t.reset()})}};e.addWait=function(e){var t,o=this,t=e||TC.getUID();o.startWait({layer:{id:t}});return t};e.removeWait=function(e){this.stopWait({layer:{id:e}})}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.Consts.event.POINT="point.tc";TC.control.Measure=function(){var e=this;TC.Control.apply(e,arguments);this.renderPromise().then(function(){e.measureMode=e.options.mode;e.history=[];e.historyIndex=0;e.reset=!0;e.wrap=new TC.wrap.control.Measure(e);e._$len=e._$div.find(".tc-ctl-meas-val-len");e._$area=e._$div.find(".tc-ctl-meas-val-area");e._$peri=e._$div.find(".tc-ctl-meas-val-peri");e.setMode(e.options.mode)})};TC.inherit(TC.control.Measure,TC.Control);!function(){var e=TC.control.Measure.prototype;e.CLASS="tc-ctl-meas";e.template=TC.isDebug?TC.apiLocation+"TC/templates/Measure.html":function(){function t(e,t){return e.w("<h2>").h("i18n",t,{},{$key:"measure"}).w('</h2><div class="tc-ctl-meas-select"><form><label class="tc-ctl-meas-btn-len"><input type="radio" name="mode" value="polyline" /><span>').h("i18n",t,{},{$key:"length"}).w('</span></label><label class="tc-ctl-meas-btn-area"><input type="radio" name="mode" value="polygon" /><span>').h("i18n",t,{},{$key:"areaAndPerimeter"}).w('</span></label></form></div><div class="tc-ctl-meas-len tc-hidden"><div class="tc-ctl-meas-lines"></div><div class="tc-ctl-meas-txt">').h("i18n",t,{},{$key:"length"}).w(': <span class="tc-ctl-meas-val-len"></span></div></div><div class="tc-ctl-meas-area tc-hidden"><div class="tc-ctl-meas-polygon"></div><div class="tc-ctl-meas-txt">').h("i18n",t,{},{$key:"area"}).w(': <span class="tc-ctl-meas-val-area"></span>, ').h("i18n",t,{},{$key:"perimeter"}).w(': <span class="tc-ctl-meas-val-peri"></span></div></div>')}dust.register(e.CLASS,t);t.__dustBody=!0;return t};e.render=function(e){var t=this;TC.Control.prototype.render.call(t,function(){TC.loadJS(!TC.control.Draw,TC.apiLocation+"TC/control/Draw",function(){t.options.mode&&t._$div.find(".tc-ctl-meas-select").addClass(TC.Consts.classes.HIDDEN);t._$div.find("span").on(TC.Consts.event.CLICK,function(e){var o=$(this).closest("label").find("input[type=radio][name=mode]"),r=o.val();o.prop("checked",!0);t.setMode(r,!0)});$.isFunction(e)&&e()})})};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);t.renderPromise().then(function(){e.loaded(function(){t.layerPromise=e.addLayer({id:TC.getUID(),title:"Medici\xf3n",stealth:!0,type:TC.Consts.layerType.VECTOR,styles:{point:$.extend({},e.options.styles.point,{fillOpacity:0}),line:e.options.styles.line,polygon:e.options.styles.polygon}});$.when(t.layerPromise).then(function(o){t.layer=o;t.layer.map.putLayerOnTop(t.layer);TC.loadJS(!TC.control.Draw,TC.apiLocation+"TC/control/Draw",function(){t.drawLines=new TC.control.Draw({div:t._$div.find(".tc-ctl-meas-lines"),mode:TC.Consts.geom.POLYLINE,measure:!0,layer:t.layer});t.drawPolygons=new TC.control.Draw({div:t._$div.find(".tc-ctl-meas-polygon"),mode:TC.Consts.geom.POLYGON,measure:!0,layer:t.layer});$.when(e.addControl(t.drawLines),e.addControl(t.drawPolygons)).then(function(){var e=function(e){var o="m"===e.units?0:3;e.area?t._$area.html(e.area.toFixed(o).replace(".",",")+" "+e.units+"&sup2;"):0===e.area&&t.resetValues();e.perimeter?t._$peri.html(e.perimeter.toFixed(o).replace(".",",")+" "+e.units):0===e.perimeter&&t.resetValues();e.length?t._$len.html(e.length.toFixed(o).replace(".",",")+" "+e.units):0===e.length&&t.resetValues()};t.drawLines.$events.on(TC.Consts.event.MEASURE+" "+TC.Consts.event.MEASUREPARTIAL,function(t){e(t)}).on(TC.Consts.event.DRAWCANCEL,function(){t.cancel()});t.drawPolygons.$events.on(TC.Consts.event.MEASURE+" "+TC.Consts.event.MEASUREPARTIAL,function(t){e(t)}).on(TC.Consts.event.DRAWCANCEL,function(){t.cancel()})});t.setMode(t.options.mode)})})})})};e.activate=function(){var e=this;TC.Control.prototype.activate.call(e)};e.deactivate=function(){var e=this;TC.Control.prototype.deactivate.call(e)};e.setMode=function(e,t){var o=this;o.mode=e;var r,i,n;switch(e){case TC.Consts.geom.POLYLINE:o.drawLines.activate();r=o._$div.find(".tc-ctl-meas-len");i=o._$div.find(".tc-ctl-meas-area");n=TC.Consts.event.CONTROLACTIVATE;break;case TC.Consts.geom.POLYGON:o.drawPolygons.activate();r=o._$div.find(".tc-ctl-meas-area");i=o._$div.find(".tc-ctl-meas-len");n=TC.Consts.event.CONTROLACTIVATE;break;case null:case void 0:o.drawLines&&o.drawLines.isActive&&o.drawLines.cancel();o.drawPolygons&&o.drawPolygons.isActive&&o.drawPolygons.cancel();r=$();i=o._$div.find(".tc-ctl-meas-area,.tc-ctl-meas-len");n=TC.Consts.event.CONTROLDEACTIVATE;break;default:o.drawLines.activate();r=o._$div.find(".tc-ctl-meas-area,.tc-ctl-meas-len");i=$();n=TC.Consts.event.CONTROLACTIVATE}o.resetValues();var a;if(e){a=o._$div.find("input[type=radio][name=mode][value="+e+"]").prop("checked",!0).addClass(TC.Consts.classes.CHECKED);a.next().addClass(TC.Consts.classes.CHECKED)}else{a=o._$div.find("input[type=radio][name=mode]").prop("checked",!1).removeClass(TC.Consts.classes.CHECKED);a.next().removeClass(TC.Consts.classes.CHECKED)}r.removeClass(TC.Consts.classes.HIDDEN);i.addClass(TC.Consts.classes.HIDDEN);n&&o.map&&o.map.$events.trigger($.Event(n,{control:o}));window.meas=o};e.cancel=function(){this.setMode(null,!1)};e.resetValues=function(){var e=this;e.NOMEASURE="-";if(e._$len){e._$len.text(e.NOMEASURE);e._$area.text(e.NOMEASURE);e._$peri.text(e.NOMEASURE)}}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");!function(){TC.control.MultiFeatureInfo=function(){var e=this;e.lineColor=null;TC.Control.apply(e,arguments);e.modes=e.options.modes||{};"undefined"==typeof e.modes[TC.Consts.geom.POINT]&&(e.modes[TC.Consts.geom.POINT]=!0);"undefined"==typeof e.modes[TC.Consts.geom.POLYGON]&&(e.modes[TC.Consts.geom.POLYGON]=!0);e.fInfoCtrl=null;e.lineFInfoCtrl=null;e.polygonFInfoCtrl=null;e.lastCtrlActive=null;e.listTOCCtrl=null;e.popup=null};TC.inherit(TC.control.MultiFeatureInfo,TC.Control);var e=TC.control.MultiFeatureInfo.prototype;e.CLASS="tc-ctl-m-finfo";e.template=TC.isDebug?TC.apiLocation+"TC/templates/MultiFeatureInfo.html":function(){function t(e,t){return e.w('<div class="tc-ctl-m-finfo-select"><form><span>').h("i18n",t,{},{$key:"selection"}).w("</span>").x(t.get(["pointSelectValue"],!1),t,{block:o},{}).x(t.get(["lineSelectValue"],!1),t,{block:r},{}).x(t.get(["polygonSelectValue"],!1),t,{block:i},{}).w("</form></div>")}function o(e,t){return e.w('<label class="tc-ctl-m-finfo-btn-point" title="').h("i18n",t,{},{$key:"selectionByPoint"}).w('"><input type="radio" name="selectmode" value="').f(t.get(["pointSelectValue"],!1),t,"h").w('" checked /><span class="tc-ctl-btn">').h("i18n",t,{},{$key:"byPoint"}).w("</span></label>")}function r(e,t){return e.w('<label class="tc-ctl-m-finfo-btn-line" title="').h("i18n",t,{},{$key:"selectionByLine"}).w('"><input type="radio" name="selectmode" value="').f(t.get(["lineSelectValue"],!1),t,"h").w('" /><span class="tc-ctl-btn">').h("i18n",t,{},{$key:"byLine"}).w("</span></label>")}function i(e,t){return e.w('<label class="tc-ctl-m-finfo-btn-polygon" title="').h("i18n",t,{},{$key:"selectionByPrecinct"}).w('"><input type="radio" name="selectmode" value="').f(t.get(["polygonSelectValue"],!1),t,"h").w('" /><span class="tc-ctl-btn">').h("i18n",t,{},{$key:"byPrecinct"}).w("</span></label>")}dust.register(e.CLASS,t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;return t};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);e.loaded(function(){var o=[];if(t.modes[TC.Consts.geom.POINT]){var r=$.Deferred();o.push(r);$.when(e.addControl("featureInfo",{displayMode:t.options.displayMode})).then(function(e){t.fInfoCtrl=e;r.resolve()})}if(t.modes[TC.Consts.geom.POLYLINE]){var i=$.Deferred();o.push(i);$.when(e.addControl("lineFeatureInfo",{displayMode:t.options.displayMode,lineColor:t.lineColor})).then(function(e){t.lineFInfoCtrl=e;i.resolve()})}if(t.modes[TC.Consts.geom.POLYGON]){var n=$.Deferred();o.push(n);$.when(e.addControl("polygonFeatureInfo",{displayMode:t.options.displayMode,lineColor:t.lineColor})).then(function(e){t.polygonFInfoCtrl=e;n.resolve()})}$.when.apply(this,o).then(function(){if(t.fInfoCtrl){t.fInfoCtrl.activate();t.lastCtrlActive=t.fInfoCtrl;t.lastCtrlActive.popup=t.popup}})});$.when(e.addControl("popup",{closeButton:!0,draggable:t.options.draggable})).then(function(e){t.popup=e;e.caller=t})};e.render=function(e){var t=this;t.lineColor=t.options.lineColor?t.options.lineColor:"#c00";var o={};t.modes[TC.Consts.geom.POINT]&&(o.pointSelectValue=TC.Consts.geom.POINT);t.modes[TC.Consts.geom.POLYLINE]&&(o.lineSelectValue=TC.Consts.geom.POLYLINE);t.modes[TC.Consts.geom.POLYGON]&&(o.polygonSelectValue=TC.Consts.geom.POLYGON);TC.Control.prototype.renderData.call(t,o,function(){var o=function(){switch(this.value){case TC.Consts.geom.POLYLINE:console.log("seleccion por l\xednea");(t.map.activeControl===t.fInfoCtrl||t.map.activeControl===t.polygonFInfoCtrl)&&t.lineFInfoCtrl.activate();t.lastCtrlActive=t.lineFInfoCtrl;break;case TC.Consts.geom.POLYGON:console.log("seleccion por pol\xedgono");(t.map.activeControl===t.fInfoCtrl||t.map.activeControl===t.lineFInfoCtrl)&&t.polygonFInfoCtrl.activate();t.lastCtrlActive=t.polygonFInfoCtrl;break;default:console.log("seleccion por punto");(t.map.activeControl===t.polygonFInfoCtrl||t.map.activeControl===t.lineFInfoCtrl)&&t.fInfoCtrl.activate();t.lastCtrlActive=t.fInfoCtrl}};t._$div.find("input[type=radio]").on("change",o);$.isFunction(e)&&e()})};e.activate=function(){var e=this;e.lastCtrlActive&&e.lastCtrlActive.activate()};e.deactivate=function(){var e=this;e.lastCtrlActive.deactivate(!1)};TC.Map.prototype.getDefaultControl=function(){var e=this.getControlsByClass("TC.control.MultiFeatureInfo");if(e&&e.length)return e[0].lastCtrlActive;e=this.getControlsByClass("TC.control.FeatureInfo");return e&&e.length?e[0]:null}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.NavBar=function(){TC.Control.apply(this,arguments)};TC.inherit(TC.control.NavBar,TC.Control);!function(){var e=TC.control.NavBar.prototype;e.CLASS="tc-ctl-nav";e.render=function(){var e=this;e.wrap||(e.wrap=new TC.wrap.control.NavBar(e))};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);t.wrap.register(e);e.loaded(function(){t.wrap.refresh()})}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.OverviewMap=function(){var e=this;TC.Control.apply(e,arguments);e.$events=$(e);e.isLoaded=!1;e.layer=null;e.wrap=new TC.wrap.control.OverviewMap(e)};TC.inherit(TC.control.OverviewMap,TC.Control);!function(){var e=TC.control.OverviewMap.prototype;e.CLASS="tc-ctl-ovmap";e.template=TC.isDebug?TC.apiLocation+"TC/templates/OverviewMap.html":function(){function t(e,t){return e.w('<div class="tc-ctl-ovmap-load tc-hidden"></div>')}dust.register(e.CLASS,t);t.__dustBody=!0;return t};e.register=function(e){var t=this,o=t.options.layer;TC.Control.prototype.register.call(t,e);e.loaded(function(){var r;if("string"==typeof o){var i=function(e,t){for(var o=null,r=0;r<t.length;r++){var i=t[r],n=i.id||i;if(n===e){o=i;break}}return o},n=i(o,TC.Cfg.availableBaseLayers);$.isPlainObject(n)||(n=i(o,e.options.baseLayers));$.isPlainObject(n)&&(r=new TC.layer.Raster(n))}else r=o instanceof TC.Layer?o:o.type===TC.Consts.layerType.VECTOR||o.type===TC.Consts.layerType.KML||o.type===TC.Consts.layerType.WFS?new TC.layer.Vector(o):new TC.layer.Raster(o);t.layer=r;t.wrap.register(e)})};e.loaded=function(e){var t=this;$.isFunction(e)&&(t.isLoaded&&t.map&&t.map.isLoaded?e():t.$events.on(TC.Consts.event.MAPLOAD,e))};e.activate=function(){this.enable()};e.deactivate=function(){this.disable()};e.enable=function(){var e=this;TC.Control.prototype.enable.call(e);e.wrap.enable()};e.disable=function(){var e=this;TC.Control.prototype.disable.call(e);e.wrap.disable()}}();TC.control=TC.control||{};TC.control.GeometryFeatureInfo||TC.syncLoadJS(TC.apiLocation+"TC/control/GeometryFeatureInfo");!function(){TC.control.PolygonFeatureInfo=function(){var e=this;TC.control.GeometryFeatureInfo.apply(this,arguments);e.geometryType=TC.Consts.geom.POLYGON};TC.inherit(TC.control.PolygonFeatureInfo,TC.control.GeometryFeatureInfo);var e=TC.control.PolygonFeatureInfo.prototype;e.CLASS="tc-ctl-finfo";e.template={};if(TC.isDebug){e.template[e.CLASS]=TC.apiLocation+"TC/templates/FeatureInfo.html";e.template[e.CLASS+"-dialog"]=TC.apiLocation+"TC/templates/FeatureInfoDialog.html"}else{e.template[e.CLASS]=function(){function t(e,t){return e.w('<ul class="tc-ctl-finfo-services">').s(t.get(["services"],!1),t,{"else":o,block:r},{}).w("</ul>").x(t.get(["featureCount"],!1),t,{block:L},{})}function o(e,t){return e.w('<li class="tc-ctl-finfo-empty">').h("i18n",t,{},{$key:"noData"}).w("</li>")}function r(e,t){return e.w("<li><h3>").x(t.getPath(!1,["mapLayer","title"]),t,{"else":i,block:n},{}).w('</h3><div class="tc-ctl-finfo-service-content">').s(t.get(["hasLimits"],!1),t,{"else":a,block:P},{}).w("</div></li>")}function i(e,t){return e.f(t.getPath(!1,["mapLayer","id"]),t,"h")}function n(e,t){return e.f(t.getPath(!1,["mapLayer","title"]),t,"h")}function a(e,t){return e.w('<ul class="tc-ctl-finfo-layers">').s(t.get(["layers"],!1),t,{"else":l,block:s},{}).w("</ul>")}function l(e,t){return e.w('<li class="tc-ctl-finfo-empty">').h("i18n",t,{},{$key:"noDataAtThisService"}).w("</li>")}function s(e,t){return e.w("<li><h4>").s(t.get(["path"],!1),t,{block:p},{}).w(' <span class="tc-ctl-finfo-layer-n">').f(t.getPath(!1,["features","length"]),t,"h").w('</span> </h4> <div class="tc-ctl-finfo-layer-content"><ul class="tc-ctl-finfo-features">').s(t.get(["features"],!1),t,{"else":u,block:g},{}).w("</ul></div></li>")}function p(e,t){return e.f(t.getPath(!0,[]),t,"h").h("sep",t,{block:c},{})}function c(e,t){return e.w(" &bull; ")}function u(e,t){return e.w('<li class="tc-ctl-finfo-empty">').h("i18n",t,{},{$key:"noDataInThisLayer"}).w("</li>")}function g(e,t){return e.w("<li>").x(t.get(["rawContent"],!1),t,{"else":d,block:C},{}).w("</li>")}function d(e,t){return e.x(t.get(["error"],!1),t,{"else":h,block:v},{})}function h(e,t){return e.w("<h5>").f(t.get(["id"],!1),t,"h").w("</h5><table").x(t.get(["geometry"],!1),t,{block:f},{}).w("><tbody>").s(t.get(["attributes"],!1),t,{block:y},{}).w("</tbody></table>").x(t.get(["geometry"],!1),t,{block:m},{})}function f(e,t){return e.w(' title="').h("i18n",t,{},{$key:"clickToCenter"}).w('"')}function y(e,t){return e.w('<tr><th class="tc-ctl-finfo-attr">').f(t.get(["name"],!1),t,"h").w('</th><td class="tc-ctl-finfo-val">').f(t.get(["value"],!1),t,"h").w("</td></tr>")}function m(e,t){return e.w('<div class="tc-ctl-finfo-tools"><button class="tc-ctl-finfo-tools-btn" title="').h("i18n",t,{},{$key:"download"}).w("/").h("i18n",t,{},{$key:"share"}).w('">').h("i18n",t,{},{$key:"download"}).w("/").h("i18n",t,{},{$key:"share"}).w("</button></div>")}function v(e,t){return e.w('<span class="tc-ctl-finfo-errors">').h("i18n",t,{},{$key:"fi.error"}).w('<span class="tc-ctl-finfo-error-text">').f(t.get(["error"],!1),t,"h").w("</span></span>")}function C(e,t){return e.w("<h5>").h("i18n",t,{},{$key:"feature"}).w("</h5>").h("eq",t,{"else":T,block:_},{key:t.get(["rawFormat"],!1),value:"text/html"})}function T(e,t){return e.w("<pre>").f(t.get(["rawContent"],!1),t,"h").w("</pre>")}function _(e,t){return e.w(" ").x(t.get(["expandUrl"],!1),t,{block:S},{})}function S(e,t){return e.h("ne",t,{"else":E,block:x},{key:t.get(["expandUrl"],!1),value:""})}function E(e,t){return e.w('<iframe src="').f(t.get(["rawUrl"],!1),t,"h").w('" />')}function x(e,t){return e.w('<div class="tc-ctl-finfo-features-iframe-cnt"><iframe src="').f(t.get(["rawUrl"],!1),t,"h").w('" /><a class="tc-ctl-finfo-open" onclick="window.open(\'').f(t.get(["expandUrl"],!1),t,"h").w("', '_blank')\" title=\"").h("i18n",t,{},{$key:"expand"}).w('"></a></div>')}function P(e,t){return e.w('<span class="tc-ctl-finfo-errors">').f(t.get(["hasLimits"],!1),t,"h").w("</span>")}function L(e,t){return e.h("gt",t,{block:w},{key:t.get(["featureCount"],!1),value:"1",type:"number"})}function w(e,t){return e.w('<a class="tc-ctl-btn tc-ctl-finfo-btn-prev">').h("i18n",t,{},{$key:"previous"}).w('</a><div class="tc-ctl-finfo-counter"><span class="tc-ctl-finfo-idx"></span>/').f(t.get(["featureCount"],!1),t,"h").w('</div><a class="tc-ctl-btn tc-ctl-finfo-btn-next">').h("i18n",t,{},{$key:"next"}).w("</a>")}dust.register(e.CLASS,t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;n.__dustBody=!0;a.__dustBody=!0;l.__dustBody=!0;s.__dustBody=!0;p.__dustBody=!0;c.__dustBody=!0;u.__dustBody=!0;g.__dustBody=!0;d.__dustBody=!0;h.__dustBody=!0;f.__dustBody=!0;y.__dustBody=!0;m.__dustBody=!0;

v.__dustBody=!0;C.__dustBody=!0;T.__dustBody=!0;_.__dustBody=!0;S.__dustBody=!0;E.__dustBody=!0;x.__dustBody=!0;P.__dustBody=!0;L.__dustBody=!0;w.__dustBody=!0;return t};e.template[e.CLASS+"-dialog"]=function(){function t(e,t){return e.w('<div class="tc-ctl-finfo-dialog tc-modal"><div class="tc-modal-background tc-modal-close"></div><div class="tc-modal-window"><div class="tc-modal-header"><h3>').h("i18n",t,{},{$key:"feature"}).w('</h3><div class="tc-ctl-popup-close tc-modal-close"></div></div><div class="tc-modal-body"><div class="tc-ctl-finfo-dialog-dl"><h2>').h("i18n",t,{},{$key:"download"}).w('</h2><div><button class="tc-button tc-ctl-finfo-dl-btn-kml" data-format="KML" title="KML">KML</button><button class="tc-button tc-ctl-finfo-dl-btn-gml" data-format="GML" title="GML">GML</button><button class="tc-button tc-ctl-finfo-dl-btn-geojson" data-format="GeoJSON" title="GeoJSON">GeoJSON</button><button class="tc-button tc-ctl-finfo-dl-btn-wkt" data-format="WKT" title="WKT">WKT</button></div></div><div class="tc-ctl-finfo-dialog-share"></div></div><div class="tc-modal-footer"><button type="button" class="tc-button tc-modal-close">').h("i18n",t,{},{$key:"close"}).w("</button></div></div></div>")}dust.register(e.CLASS+"-dialog",t);t.__dustBody=!0;return t}}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.Consts.event.POPUP="popup.tc";TC.Consts.event.POPUPHIDE="popuphide.tc";TC.Consts.classes.DRAG=TC.Consts.classes.DRAG||"tc-drag";TC.Consts.classes.DRAGGED=TC.Consts.classes.DRAGGED||"tc-dragged";TC.Consts.classes.DRAGGABLE=TC.Consts.classes.DRAGGABLE||"tc-draggable";TC.control.Popup=function(){var e=this;TC.Control.apply(e,arguments);e.currentFeature=null;e.wrap=new TC.wrap.control.Popup(e)};TC.inherit(TC.control.Popup,TC.Control);!function(){var e=TC.control.Popup.prototype;e.CLASS="tc-ctl-popup";e.render=function(){};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);$.when(e.wrap.addPopup(t)).then(function(){e.on(TC.Consts.event.LAYERVISIBILITY,function(e){t.currentFeature&&t.currentFeature.layer===e.layer&&!e.layer.getVisibility()&&t.hide()});e.on(TC.Consts.event.LAYERREMOVE,function(e){t.currentFeature&&t.currentFeature.layer===e.layer&&t.hide()});e.on(TC.Consts.event.UPDATE,function(){t.currentFeature&&t.currentFeature._visibilityState!==TC.Consts.visibility.NOT_VISIBLE||t.hide()});e.on(TC.Consts.event.FEATUREREMOVE,function(e){t.currentFeature===e.feature&&t.hide()})})};e.fitToView=function(e){var t=this;e?setTimeout(function(){t.wrap.fitToView()},1e3):t.wrap.fitToView()};e.hide=function(){var e=this;if(e.map){e.map.wrap.hidePopup(e);e.setDragged(!1);e.map.$events.trigger($.Event(TC.Consts.event.POPUPHIDE,{control:e}))}};e.setDragged=function(e){var t=this;t.dragged=e;t.$popupDiv&&t.$popupDiv.toggleClass(TC.Consts.classes.DRAGGED,e);t.wrap.setDragged(e)};e.setDragging=function(e){var t=this;e&&t.setDragged(!0);t.$popupDiv.toggleClass(TC.Consts.classes.DRAG,e)};e.isVisible=function(){var e=this;return e.$popupDiv&&e.$popupDiv.hasClass(TC.Consts.classes.VISIBLE)}}();TC.control=TC.control||{};TC.Consts.classes.PRINTABLE="tc-printable";TC.control.Print=function(e){var t=this,o=e||{};t.ready=!1;t.title=o.title||"P\xe1gina de impresi\xf3n";t.cssUrl=o.cssUrl||TC.apiLocation+"TC/css/print.css";if(o.target){for(var r in t.template)dust.cache[r]||t.template[r]();var i=$(o.target);i.addClass(TC.Consts.classes.PRINTABLE);var n=function(e){var o=open(null,t.CLASS),r=i.html();dust.render(t.CLASS+"-page",{title:t.title,content:r,cssUrl:t.cssUrl},function(e,t){o.document.write(t);o.document.close();o.focus();e&&TC.error(e)})};dust.render(t.CLASS,null,function(e,o){i.append(o);i.find("."+t.CLASS+"-btn").on("click",n)})}};!function(){var e=TC.control.Print.prototype;e.CLASS="tc-ctl-print";e.template={};e.template[e.CLASS]=function(){function t(e,t){return e.w('<a class="tc-ctl-print-btn" title="').h("i18n",t,{},{$key:"printThisWindow"}).w('">').h("i18n",t,{},{$key:"print"}).w("</a>")}dust.register(e.CLASS,t);t.__dustBody=!0;return t};e.template[e.CLASS+"-page"]=function(){function t(e,t){return e.w('<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title>').f(t.get(["title"],!1),t,"h").w('</title><link rel="stylesheet" href="').f(t.get(["cssUrl"],!1),t,"h").w('" /></head><body onload="print()" class="tc-ctl-print-page"><h1>').f(t.get(["title"],!1),t,"h").w("</h1>").f(t.get(["content"],!1),t,"h",["s"]).w("</body></html>")}dust.register(e.CLASS+"-page",t);t.__dustBody=!0;return t}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.PrintMap=function(){var e=this;TC.Control.apply(e,arguments)};TC.inherit(TC.control.PrintMap,TC.Control);!function(){var e=TC.control.PrintMap.prototype;e.CLASS="tc-ctl-printMap";e.template={};e.template[e.CLASS]=TC.isDebug?TC.apiLocation+"TC/templates/PrintMap.html":function(){function t(e,t){return e.w("<h2>").h("i18n",t,{},{$key:"print"}).w('</h2><div><div class="tc-ctl-printMap-div"><div class="tc-group tc-ctl-printMap-cnt"><label>').h("i18n",t,{},{$key:"title"}).w(':</label><input type="text" class="tc-ctl-printMap-title tc-textbox" maxlength="30" placeholder="').h("i18n",t,{},{$key:"mapTitle"}).w('" /></div><div class="tc-group tc-ctl-printMap-cnt"><label>').h("i18n",t,{},{$key:"layout"}).w(':</label><select id="print-design" class="tc-combo"><option value="landscape">').h("i18n",t,{},{$key:"landscape"}).w('</option><option value="portrait">').h("i18n",t,{},{$key:"portrait"}).w('</option></select></div><div class="tc-group tc-ctl-printMap-cnt"><label>').h("i18n",t,{},{$key:"size"}).w(':</label><select id="print-size" class="tc-combo"><option value="a4">A4</option><option value="a3">A3</option></select></div><div class="tc-group tc-ctl-printMap-cnt"><button class="tc-ctl-printMap-btn tc-button tc-icon-button" title="').h("i18n",t,{},{$key:"printMap"}).w('">').h("i18n",t,{},{$key:"print"}).w("</button></div></div></div>")}dust.register(e.CLASS,t);t.__dustBody=!0;return t};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);var o=function(){var o="?";$.isEmptyObject(TC.Util.getQueryStringParams(window.location.href))||(o="&");o+="layout=print&orientation="+$("#print-design").val()+"&title="+$("input.tc-ctl-printMap-title").val()+"&size="+$("#print-size").val();var r;r=window.location.hash?window.location.href.replace(window.location.hash,o+window.location.hash):window.location.href+o;t.printWindow&&void 0!==t.printWindow&&t.printWindow.close();TC.printPreview={};TC.printPreview.refererMap=e;for(var i,n=[],a=0;a<e.workLayers.length;a++){i=e.workLayers[a];if((i.type===TC.Consts.layerType.VECTOR||i.type===TC.Consts.layerType.WFS)&&i.getVisibility()&&i.features.length>0)for(var l=i.features,s=0;s<l.length;s++){var p=l[s],c={};if(!(TC.feature.Marker&&p instanceof TC.feature.Marker&&p.options.noPrint)){if(p.layer.styles){var u=void 0==p.layer.styles[p.STYLETYPE]?p.layer.styles["polyline"===p.STYLETYPE?"line":p.STYLETYPE]:p.layer.styles["multipolygon"===p.STYLETYPE?"polygon":p.STYLETYPE];for(var g in u)c[g]="function"==typeof u[g]?u[g](p):u[g]}n.push({geometry:p.geometry,CLASSNAME:p.CLASSNAME,options:$.extend({},p.options,c,p.getStyle(),{layer:null})})}}}TC.printPreview.mapFeatures=n;t.printWindow=window.open(r,"print");t.printWindow.onbeforeunload=function(){delete this.printWindow}.bind(this)};t._$div.on("click",".tc-ctl-printMap-btn",o)}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.PrintPdf=function(){var e=this;TC.Control.apply(e,arguments)};TC.inherit(TC.control.PrintPdf,TC.Control);!function(){var e=TC.control.PrintPdf.prototype;e.CLASS="tc-ctl-print-pdf";var t={marginTop:20,marginLeft:55,a4:{width:596,height:842},a3:{width:842,height:1191},qrCode:{sideLength:85},headerHeight:20},o={PORTRAIT:"portrait",LANDSCAPE:"landscape"},r={A4:"a4",A3:"a3"},i=TC.Util.getParameterByName("orientation"),n=TC.Util.getParameterByName("size"),a=function(e,r){return e===o.PORTRAIT?t[r].width:t[r].height},l=function(e,r){return e===o.PORTRAIT?t[r].height:t[r].width};e.template=TC.isDebug?TC.apiLocation+"TC/templates/PrintPdf.html":function(){function t(e,t){return e.w('<button disabled class="disabled tc-button tc-ctl-print-pdf-btn" title="').h("i18n",t,{},{$key:"printpdf"}).w('"></button>')}dust.register(e.CLASS,t);t.__dustBody=!0;return t};var s=function(){var e=window.location.href,t=e.indexOf("?"),o=e.indexOf("#");t>0&&(e=o>t?e.replace(e.substring(t,o),""):e.replace(e.substring(t,e.length-1),""));return e},p=function(e){var o=$.Deferred(),r=150;e?TC.loadJS("undefined"==typeof QRCode,[TC.apiLocation+"lib/qrcode/qrcode.min.js"],function(){e.length>r&&(e=TC.Util.shortenUrl(e));var i=$("#qrcode");i.empty();new QRCode(i.get(0),{text:e,width:t.qrCode.sideLength,height:t.qrCode.sideLength});setTimeout(function(){var e=i.find("img").attr("src");o.resolve(e)},100)}):o.resolve(imgBase64);return o.promise()};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);t.pdfLibPromise=function(){var e=$.Deferred();window.pdfMake?e.resolve():TC.loadJS(!window.pdfMake,[TC.Consts.url.PDFMAKE],function(){e.resolve()});return e.promise()}();var o=!0;e._$div.on("mouseover",function(){if(o){e.toast(t.getLocaleString("print.advice.title")+": "+t.getLocaleString("print.advice.desc"),{type:TC.Consts.msgType.INFO,duration:7e3});o=!1}});var r="."+t.CLASS+"-btn";t.map.$events.on(TC.Consts.event.STARTLOADING,function(){var e=t._$div.find(r);e.addClass("disabled");e.attr("disabled","disabled")});t.map.$events.on(TC.Consts.event.STOPLOADING,function(){var e=t._$div.find(r);e.removeClass("disabled");e.removeAttr("disabled")});t.getLayersFromOpener();t.options.qrCode&&p(s());t._$div.on("click","."+t.CLASS+"-btn",function(){t.createPdf()})};var c=function(){var e=$.Deferred(),a={pageOrientation:i||o.LANDSCAPE,pageSize:n||r.A4,pageMargins:[t.marginLeft,t.marginTop]};e.resolve(a);return e.promise()};e.createPdf=function(){var e=this,o=a(i,n),r=l(i,n);e.canvas=$(".tc-map .ol-viewport canvas")[0];e.mapSize=TC.Util.calculateAspectRatioFit(e.canvas.width,e.canvas.height,o-2*t.marginLeft,r-2*t.marginTop-t.headerHeight);var u=function(t){TC.error(e.getLocaleString("print.error"));TC.error("No se ha podido generar el base64 correspondiente a la imagen: "+t,TC.Consts.msgErrorMode.EMAIL,"Error en la impresi\xf3n")},g=function(o){o.content=o.content||[];var r=$.Deferred(),i=e.map.getControlsByClass(TC.control.ScaleBar)[0];if(i)var n=$(".tc-ctl-sb .ol-scale-line-inner"),a=e.canvas.width/e.mapSize.width,l=n.width()/a;var s=function(e){var t;e&&(t=[[e]]);t[0].push({text:TC.Util.getParameterByName("title"),alignment:"center",fontSize:11});i&&t[0].push({table:{widths:[l],body:[[{text:i.getText(),fontSize:10,alignment:"center"}]]},layout:{hLineWidth:function(e,t){return 0===e?0:1},paddingLeft:function(e,t){return 0},paddingRight:function(e,t){return 0},paddingTop:function(e,t){return 0},paddingBottom:function(e,t){return 0}}});o.content.push({table:{widths:[l,"*",l]},layout:"noBorders"});o.content[0].table.body=t;r.resolve(o)};e.options.logo?$.when(TC.Util.imgToDataUrl(e.options.logo,"image/png")).then(function(e,o){var r=(t.headerHeight,o.width*t.headerHeight/o.height,TC.Util.calculateAspectRatioFit(o.width,o.height,l,t.headerHeight));s({image:e,height:r.height,width:r.width})},function(){u(e.options.logo);r.reject()}):s();return r.promise()},d=function(o){var r=$.Deferred();o.content=o.content||[];var i=function(t){o.content.push({table:{widths:["*"],body:[[{image:TC.Util.toDataUrl(t),width:e.mapSize.width}]]},layout:{paddingLeft:function(e,t){return 0},paddingRight:function(e,t){return 0},paddingTop:function(e,t){return.1},paddingBottom:function(e,t){return 0}}});r.resolve(o)};e.options.qrCode?$.when(p(s())).then(function(o){if(o)$.when(TC.Util.addToCanvas(e.canvas,o,{x:e.canvas.width-t.qrCode.sideLength,y:e.canvas.height-t.qrCode.sideLength})).then(function(e){i(e)});else{TC.error(e.getLocaleString("print.qr.error"));i(e.canvas)}}):i(e.canvas);return r.promise()},h=function(t){var o=$.Deferred(),r=function(e,t,o){if(t.isVisibleByScale(e.name)){var r,i;t.options&&t.options.params&&t.options.params.base64LegendSrc?i=t.options.params.base64LegendSrc:e.legend&&(r=e.legend.src);result.push({src:r,title:e.title,level:o,srcBase64:i})}},n=function(e,t,o,r){if(Array.isArray(e))for(var i=0;i<e.length;i++)n(e[i],t,o,r);else if(e&&e.hasOwnProperty("children")&&e.children.length>0){e.title&&e.name&&result.push({header:e.title,level:r});n(e.children,t,o,++r)}if(e&&e.hasOwnProperty("children")&&0==e.children.length){t.apply(this,[e,o,r]);r--}},a=function(){for(var t=[],o=0;o<p.length;o++)for(var r=p[o].layers,i=0;i<r.length;i++)!function(o,r){var i=p[o].layers[r],n=i.src||i.srcBase64;if(n){e.map.options.crossOrigin&&TC.Util.detectIE()&&(n=TC.proxify(n));var a=TC.Util.imgToDataUrl(n,"image/png");t.push(a);a.then(function(e,t){i.image={base64:e,canvas:t}},function(){u(n)})}}(o,i);return t};if(e.options.legend&&e.options.legend.visible){var l=e.options.legend.orientation||i,s=e.map.workLayers,p=[],c=7;t.content=t.content||{};if(s.length>0){for(var g=s.length-1;g>=0;g--){var d=s[g];if(d.type===TC.Consts.layerType.WMS&&d.getVisibility()){result=[];n(d.getTree(),r,d,0);result.length>0&&p.push({title:d.title,layers:result})}}$.when.apply($,a()).then(function(){p.length>0&&t.content.push({text:" ",pageBreak:"before",pageOrientation:l});for(var e=0;e<p.length;e++){var r=p[e],i=10;t.content.push({text:r.title,fontSize:11,margin:[0,0,0,5]});for(var n=0;n<r.layers.length;n++){var a=r.layers[n];i=c*a.level;if(a.header)t.content.push({text:a.header,fontSize:10,margin:[i,0,0,3]});else{t.content.push({text:a.title,fontSize:9,margin:[i,0,0,2]});if(a.image){var s=a.image.canvas.width/2,u=s*a.image.canvas.height/a.image.canvas.width;t.content.push({image:a.image.base64,width:s,height:u,margin:[i,0,0,2]})}}}}o.resolve(t)},function(){o.reject()})}else o.resolve(t)}else o.resolve(t);return o.promise()},f=function(e){var t=window.location.host+"_",o=TC.Util.getParameterByName("title");if(o)t+=o;else{var r=TC.Util.getFormattedDate((new Date).toString(),!0);t+=r}pdfMake.createPdf(e).download(t.replace(/[\\\/:*?"<>\|]/g,"")+".pdf")},y=e.map.getControlsByClass(TC.control.LoadingIndicator)[0],m=y.addWait(),v=function(){y.removeWait(m)};$.when(e.pdfLibPromise).then(c).then(g).fail(v).then(d).then(h).fail(v).then(f).then(v)};e.getLayersFromOpener=function(e){var t=this,o=window.opener;if(o){var r=o.TC,i=r.printPreview?r.printPreview.refererMap:null;i&&t.map.loaded(function(){0===o.location.hash.length&&t.map.setExtent(i.options.initialExtent);for(var e=0;e<t.map.baseLayers.length;e++)t.map.removeLayer(t.map.baseLayers[e]);var n=i.getBaseLayer();t.map.addLayer({id:n.id,title:n.title,type:n.type,url:n.url,encoding:n.encoding,layerNames:n.layerNames,matrixSet:n.matrixSet,format:n.format,minResolution:n.minResolution,maxZoom:n.maxZoom,isBase:!0});for(var a,l=i.workLayers,e=0;e<l.length;e++){a=l[e];a.type===r.Consts.layerType.WMS&&a.options.stateless&&t.map.addLayer({id:a.id,title:a.title,type:a.type,method:a.method,url:a.url,format:a.format,stateless:a.stateless,params:a.params,layerNames:a.layerNames},function(e){e.setVisibility(a.getVisibility());e.setOpacity(a.getOpacity())})}var s=r.printPreview.mapFeatures;s&&t.map.addLayer({id:r.getUID(),type:r.Consts.layerType.VECTOR},function(e){r.loadJS(!r.feature,[r.apiLocation+"TC/Feature",r.apiLocation+"TC/feature/Point",r.apiLocation+"TC/feature/Polyline",r.apiLocation+"TC/feature/Polygon",r.apiLocation+"TC/feature/MultiPolygon",r.apiLocation+"TC/feature/MultiPolyline",r.apiLocation+"TC/feature/Circle",r.apiLocation+"TC/feature/Marker"],function(){for(var t=0;t<s.length;t++){var o=s[t];switch(o.CLASSNAME){case"TC.feature.Point":e.addPoint(o.geometry,o.options);break;case"TC.feature.Polyline":e.addPolyline(o.geometry,o.options);break;case"TC.feature.Polygon":e.addPolygon(o.geometry,o.options);break;case"TC.feature.MultiPolygon":e.addMultiPolygon(o.geometry,o.options);break;case"TC.feature.MultiPolyline":e.addMultiPolyline(o.geometry,o.options);break;case"TC.feature.Circle":e.addCircle(o.geometry,o.options);break;case"TC.feature.Marker":e.addMarker(o.geometry,o.options)}}})})})}}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.Consts.event.RESULTTOOLTIP="resulttooltip.tc";TC.Consts.event.RESULTTOOLTIPEND="resulttooltipend.tc";TC.Consts.event.DRAWCHART="drawchart.tc";TC.Consts.event.DRAWTABLE="drawtable.tc";TC.Consts.event.RESULTSPANELMIN="resultspanelmin.tc";TC.Consts.event.RESULTSPANELMAX="resultspanelmax.tc";TC.Consts.event.RESULTSPANELCLOSE="resultspanelclose.tc";TC.control.ResultsPanel=function(){var e=this;TC.Control.apply(e,arguments);e.data={};e.classes={FA:"fa"};e.contentType={TABLE:{fnOpen:TC.control.ResultsPanel.prototype.openTable,collapsedClass:".fa-list-alt"},CHART:{fnOpen:TC.control.ResultsPanel.prototype.openChart,collapsedClass:".fa-area-chart"}};e.content=e.contentType.TABLE;if(e.options){e.options.content&&(e.content=e.contentType[e.options.content.toUpperCase()]);e.options.chart&&(e.chart=e.options.chart);e.options.table&&(e.table=e.options.table)}};TC.inherit(TC.control.ResultsPanel,TC.Control);TC.control.ResultsPanel.prototype.CLASS="tc-ctl-p-results";TC.control.ResultsPanel.prototype.template={};if(TC.isDebug){TC.control.ResultsPanel.prototype.template[TC.control.ResultsPanel.prototype.CLASS]=TC.apiLocation+"TC/templates/ResultsPanel.html";TC.control.ResultsPanel.prototype.template[TC.control.ResultsPanel.prototype.CLASS+"-table"]=TC.apiLocation+"TC/templates/ResultsPanelTable.html";TC.control.ResultsPanel.prototype.template[TC.control.ResultsPanel.prototype.CLASS+"-chart"]=TC.apiLocation+"TC/templates/ResultsPanelChart.html"}else{TC.control.ResultsPanel.prototype.template[TC.control.ResultsPanel.prototype.CLASS]=function(){function e(e,t){return e.w('<div class="prpanel-group prsidebar-body " style="display: none" data-no-cb data-no-3d><div class="prpanel prpanel-default"><div class="prpanel-heading"><h4 class="prpanel-title"><label>').h("i18n",t,{},{$key:"geo.trk.chart.chpe"}).w('</label> <span class="prcollapsed-pull-right prcollapsed-slide-submenu prcollapsed-slide-submenu-close" title="').h("i18n",t,{},{$key:"close"}).w('"><i class="fa fa-times"></i></span><span class="prcollapsed-pull-right prcollapsed-slide-submenu prcollapsed-slide-submenu-min" title="').h("i18n",t,{},{$key:"hide"}).w('"><i class="fa fa-chevron-left"></i></span><span class="prcollapsed-pull-right prcollapsed-slide-submenu prcollapsed-slide-submenu-csv" hidden title="Exportar a Excel"><i class="fa fa-file-excel-o"></i></span></h4></div><div id="results" class="prpanel-collapse collapse in"><div class="prpanel-body list-group tc-ctl-p-results-table">').p("tc-ctl-p-results-table",t,t.rebase(t.getPath(!0,[])),{}).w('</div><div class="prpanel-body list-group tc-ctl-p-results-chart"></div></div></div></div><div class="prcollapsed prcollapsed-max prcollapsed-pull-left" style="display: none;" title="').h("i18n",t,{},{$key:"expand"}).w('" data-no-cb data-no-3d><i class="fa-list-alt" hidden></i><i class="fa-area-chart" hidden></i></div>')}dust.register(TC.control.ResultsPanel.prototype.CLASS,e);e.__dustBody=!0;return e};TC.control.ResultsPanel.prototype.template[TC.control.ResultsPanel.prototype.CLASS+"-table"]=function(){function e(e,r){return e.w('<table class="table" style="display:none;"><thead>').s(r.get(["columns"],!1),r,{block:t},{}).w("</thead><tbody>").s(r.get(["results"],!1),r,{block:o},{}).w("</tbody></table>")}function t(e,t){return e.w("<th>").f(t.getPath(!0,[]),t,"h").w("</th>")}function o(e,t){return e.w("<tr>").h("iterate",t,{block:r},{on:t.getPath(!0,[])}).w("</tr>")}function r(e,t){return e.w("<td>").f(t.get(["value"],!1),t,"h").w("</td>")}dust.register(TC.control.ResultsPanel.prototype.CLASS+"-table",e);e.__dustBody=!0;t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;return e};TC.control.ResultsPanel.prototype.template[TC.control.ResultsPanel.prototype.CLASS+"-chart"]=function(){function e(e,r){return e.w('<div id="track-chart">').x(r.get(["msg"],!1),r,{"else":t,block:o},{}).w("</div>")}function t(e,t){return e.w('<span id="elevationGain" >').h("i18n",t,{},{$key:"geo.trk.chart.elevationGain"}).w(": +").f(t.get(["upHill"],!1),t,"h").w("m, -").f(t.get(["downHill"],!1),t,"h").w('m</span><div id="chart"></div>')}function o(e,t){return e.f(t.get(["msg"],!1),t,"h")}dust.register(TC.control.ResultsPanel.prototype.CLASS+"-chart",e);e.__dustBody=!0;t.__dustBody=!0;o.__dustBody=!0;return e}}TC.control.ResultsPanel.prototype.render=function(e){var t=this;TC.Control.prototype.render.call(t,function(){t.$mainTitle=t._$div.find("label");t.$minimize=t._$div.find(".prcollapsed-slide-submenu-min");t.$minimize.on("click",function(){t.minimize()});t.$close=t._$div.find(".prcollapsed-slide-submenu-close");t.$close.on("click",function(){t.close()});t.$maximize=t._$div.find(".prcollapsed-max");t.$maximize.on("click",function(){t.maximize()});if(t.content){t.content=t.content;if(t.options.titles){if(t.options.titles.main){t.$mainTitle.attr("title",t.options.titles.main);t.$mainTitle.html(t.options.titles.main)}t.options.titles.max&&t.$maximize.attr("title",t.options.titles.max)}}t._$div.find(t.content.collapsedClass).removeAttr("hidden").addClass(t.classes.FA);t.$divTable=t._$div.find("."+t.CLASS+"-table");t.$divChart=t._$div.find("."+t.CLASS+"-chart");TC.loadJS(Modernizr.touch,TC.apiLocation+"lib/jQuery/jquery.touchSwipe.min.js",function(){if(Modernizr.touch){t._$div.swipe({swipeLeft:function(){t.minimize()}})}});e&&"function"==typeof e&&e.call()})};TC.control.ResultsPanel.prototype.minimize=function(){var e=this;if(0==e._$div.find(e.content.collapsedClass+":visible").length){e._$div.find(e.content.collapsedClass).hasClass(e.classes.FA)||e._$div.find(e.content.collapsedClass).addClass(e.classes.FA);e._$div.find(e.content.collapsedClass).removeAttr("hidden");e._$div.find(".prsidebar-body").toggle("slide",function(){e._$div.find(".prcollapsed-max").fadeIn()});e.map.$events.trigger($.Event(TC.Consts.event.RESULTSPANELMIN),{})}};TC.control.ResultsPanel.prototype.maximize=function(){var e=this;if(0==e._$div.find(e.content.collapsedClass+":hidden").length){e._$div.find(e.content.collapsedClass).attr("hidden","hidden");e._$div.find(".prsidebar-body").toggle("slide");e._$div.find(".prcollapsed-max").hide();e.map.$events.trigger($.Event(TC.Consts.event.RESULTSPANELMAX),{})}};TC.control.ResultsPanel.prototype.close=function(){var e=this;e._$div.find(".prsidebar-body").fadeOut("slide");e._$div.find(".prcollapsed-max").hide();e._$div.find(e.content.collapsedClass).attr("hidden","hidden").removeClass(e.classes.FA);e.chart&&e.chart.chart&&(e.chart.chart=e.chart.chart.destroy());e.map.$events.trigger($.Event(TC.Consts.event.RESULTSPANELCLOSE,{control:e}))};TC.control.ResultsPanel.prototype.openChart=function(){var self=this,data=arguments.data||arguments[0].data;if(data)if(data.msg)self.map.toast(data.msg);else{var locale=TC.Util.getMapLocale(self.map);self.getRenderedHtml(TC.control.ResultsPanel.prototype.CLASS+"-chart",{upHill:data.upHill.toLocaleString(locale),downHill:data.downHill.toLocaleString(locale)},function(out){console.log(self._$div.find("."+TC.control.ResultsPanel.prototype.CLASS+"-chart").length);self._$div.find("."+TC.control.ResultsPanel.prototype.CLASS+"-chart").html(out);var chartOptions={bindto:"#chart",padding:{top:0,right:15,bottom:0,left:45},legend:{show:!1}};self.chart.tooltip&&(chartOptions.tooltip={contents:function(d){var fn=self.chart.tooltip;"function"!=typeof fn&&(fn=TC.Util.getFNFromString(self.chart.tooltip));return fn.call(eval(self.chart.ctx),d)}});self.chart&&self.chart.onmouseout&&(chartOptions.onmouseout=function(){var fn=self.chart.onmouseout;"function"!=typeof fn&&(fn=TC.Util.getFNFromString(self.chart.onmouseout));fn.call(eval(self.chart.ctx))});chartOptions=$.extend({},chartOptions,data);chartOptions.onrendered=function(){self.map.$events.trigger($.Event(TC.Consts.event.DRAWCHART),{svg:this.svg[0][0]});self._$div.find(".prsidebar-body").fadeIn("slide");self._$div.find("."+self.CLASS+"-table").hide()};if(window.c3){window.c3.chart.internal.fn.generateDrawLine=function(e,t){var o=this,r=o.config,i=o.d3.svg.line(),n=o.generateGetLinePoints(e,t),a=t?o.getSubYScale:o.getYScale,l=function(e){return(t?o.subxx:o.xx).call(o,e)},s=function(e,t){return r.data_groups.length>0?n(e,t)[0][1]:a.call(o,e.id)(e.value)};i=r.axis_rotated?i.x(s).y(l):i.x(l).y(s);r.line_connectNull||(i=i.defined(function(e){return null!=e.value}));return function(e){var n,l=r.line_connectNull?o.filterRemoveNull(e.values):e.values,s=t?o.x:o.subX,p=a.call(o,e.id),c=0,u=0;if(o.isLineType(e))if(r.data_regions[e.id])n=o.lineWithRegions(l,s,p,r.data_regions[e.id]);else{o.isStepType(e)&&(l=o.convertValuesToStep(l));n=i.interpolate("linear")(l)}else{if(l[0]){c=s(l[0].x);u=p(l[0].value)}n=r.axis_rotated?"M "+u+" "+c:"M "+c+" "+u}return n?n:"M 0 0"}};window.c3.chart.internal.fn.generateDrawArea=function(e,t){var o=this,r=o.config,i=o.d3.svg.area(),n=o.generateGetAreaPoints(e,t),a=t?o.getSubYScale:o.getYScale,l=function(e){return(t?o.subxx:o.xx).call(o,e)},s=function(e,t){return r.data_groups.length>0?n(e,t)[0][1]:a.call(o,e.id)(0)},p=function(e,t){return r.data_groups.length>0?n(e,t)[1][1]:a.call(o,e.id)(e.value)};i=r.axis_rotated?i.x0(s).x1(p).y(l):i.x(l).y0(s).y1(p);r.line_connectNull||(i=i.defined(function(e){return null!==e.value}));return function(e){var t,n=r.line_connectNull?o.filterRemoveNull(e.values):e.values,a=0,l=0;if(o.isAreaType(e)){o.isStepType(e)&&(n=o.convertValuesToStep(n));t=i.interpolate("linear")(n)}else{if(n[0]){a=o.x(n[0].x);l=o.getYScale(e.id)(n[0].value)}t=r.axis_rotated?"M "+l+" "+a:"M "+a+" "+l}return t?t:"M 0 0"}};self.chart.chart=c3.generate(chartOptions)}})}else self.map.toast(data.msg);self.map.getLoadingIndicator().hide()};TC.control.ResultsPanel.prototype.openTable=function(){var e=this,t=arguments[0];if(t){var o,r=function(){for(var e=0;e<t.length;e++)for(var o in t[e])i.indexOf(o)<0&&delete t[e][o]};t.css&&(o=t.css);var i=t.columns,t=t.data;if(t&&t.length>0){if(!i){i=[];for(var n in t[0])i.push(n)}r();e.tableData={columns:i,results:t,css:o};e.getRenderedHtml(e.CLASS+"-table",e.tableData,function(t){e._$div.find("."+e.CLASS+"-table").html(t)});e._$div.find("."+e.CLASS+"-chart").hide();e._$div.find(".prsidebar-body").fadeIn("slide")}}e.map.getLoadingIndicator().hide()};TC.control.ResultsPanel.prototype.open=function(e){var t=this,o=t._$div.find("."+t.CLASS+"-table"),r=function(){var e=o[0].getBoundingClientRect();if(e&&e.width>100){window.cancelAnimationFrame(this.requestIsRendered);this.map.$events.trigger($.Event(TC.Consts.event.DRAWTABLE),{})}};t.requestIsRendered=window.requestAnimationFrame(r.bind(t));t._$div.find("."+t.CLASS+"-table").html(e);t._$div.find("."+t.CLASS+"-chart").hide();1==t._$div.find(t.content.collapsedClass+":visible").length&&t.maximize();t._$div.find(".prsidebar-body").fadeIn("slide");t.map.getLoadingIndicator().hide()};TC.control.ResultsPanel.prototype.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);t.openOn&&t.map.$events.one(t.openOn,function(e,o){t.content.fnOpen.call(t,o)});t.closeOn&&t.map.$events.one(t.closeOn,function(e,o){t.close()});t.options.openOn&&t.map.$events.on(t.options.openOn,function(e,o){t.content.fnOpen.call(t,o)});t.options.closeOn&&t.map.$events.on(t.options.closeOn,function(e,o){t.close()})};TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.ScaleBar=function(){TC.Control.apply(this,arguments)};TC.inherit(TC.control.ScaleBar,TC.Control);!function(){var e=TC.control.ScaleBar.prototype;e.CLASS="tc-ctl-sb";e.render=function(){var e=this;e.wrap||(e.wrap=new TC.wrap.control.ScaleBar(e));e.wrap.render()};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);e.wrap.getMap().addControl(t.wrap.ctl)};e.getText=function(){var e=this;return e.wrap.getText()}}();TC.control=TC.control||{};TC.control.Scale||TC.syncLoadJS(TC.apiLocation+"TC/control/Scale");TC.control.ScaleSelector=function(){var e=this;TC.control.Scale.apply(e,arguments);e.scales=null};TC.inherit(TC.control.ScaleSelector,TC.control.Scale);!function(){var e=TC.control.ScaleSelector.prototype;e.CLASS="tc-ctl-ss";e.template=TC.isDebug?TC.apiLocation+"TC/templates/ScaleSelector.html":function(){function t(e,t){return e.w('<div class="ol-scale-line ol-unselectable"><nobr><select>').s(t.get(["scales"],!1),t,{block:o},{}).w('</select> <input type="button" value="').f(t.get(["screenSize"],!1),t,"h").w("''\" title=\"").h("i18n",t,{},{$key:"estimatedMapSize"}).w('" /></nobr></div>')}function o(e,t){return e.w('<option value="').f(t.getPath(!0,[]),t,"h").w('"').h("eq",t,{block:r},{key:i,value:n}).w(">1:").h("math",t,{},{key:a,method:"round"}).w("</option>\n")}function r(e,t){return e.w(' selected="true"')}function i(e,t){return e.f(t.getPath(!0,[]),t,"h")}function n(e,t){return e.f(t.get(["scale"],!1),t,"h")}function a(e,t){return e.f(t.getPath(!0,[]),t,"h")}dust.register(e.CLASS,t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;i.__dustBody=!0;n.__dustBody=!0;a.__dustBody=!0;return t};e.render=function(e){var t=this;if(t.map){!t.scales&&t.map.options.resolutions&&(t.scales=t.map.options.resolutions.map(t.getScale,t));var o=function(){t.scales=t.map.wrap.getResolutions().map(t.getScale,t);$("input[type=button]",t._$div).off();$("select",t._$div).off();t.renderData({scale:t.getScale(),screenSize:TC.Cfg.screenSize,scales:t.scales},function(){t._$div.find("option").each(function(e,o){$elm=$(o);$elm.text("1:"+t.format($elm.text().substr(2)))});t._$div.find('input[type="button"]').on(TC.Consts.event.CLICK,function(){t.setScreenSize.call(t)});$("select",t._$div).on("change",function(){t.setScale($(this).val())});$.isFunction(e)&&e()})};t.scales?o():$.when(t.map.wrap.getMap()).then(o)}};e.setScale=function(e){var t=this,o=.0254*e/t.getDpi(TC.Cfg.screenSize);window.devicePixelRatio&&(o/=window.devicePixelRatio);t.metersPerDegree&&(o/=t.metersPerDegree);t.map.wrap.setResolution(o);return o}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.Search=function(){var e=this;TC.Control.apply(e,arguments);TC.Consts.event.TOOLSCLOSE=TC.Consts.event.TOOLSCLOSE||"toolsclose.tc";e.url="//idena.navarra.es/ogc/wfs";e.version="1.1.0";e.featurePrefix="IDENA";e._LIKE_PATTERN="*";e.UTMX="X";e.UTMY="Y";e.LON="Lon";e.LAT="Lat";e.UTMX_LABEL="X: ";e.UTMY_LABEL="Y: ";e.LON_LABEL="Lon: ";e.LAT_LABEL="Lat: ";e.MUN="M";e.POL="P";e.PAR="Par";e.MUN_LABEL="Mun: ";e.POL_LABEL="Pol: ";e.PAR_LABEL="Par: ";e.availableSearchTypes={};e.availableSearchTypes[TC.Consts.searchType.CADASTRAL]={suggestionRoot:null,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:["CATAST_Pol_ParcelaRusti","CATAST_Pol_ParcelaUrba","CATAST_Pol_ParcelaMixta"],municipality:{featureType:"CATAST_Pol_Municipio",outputProperties:["CMUNICIPIO","MUNICIPIO"]},queryProperties:{municipality:"CMUNICIPIO",polygon:"POLIGONO",parcel:"PARCELA"},suggestionListHead:function(){return{label:e.getLocaleString("search.list.cadastral"),color:{"#e5475f":e.getLocaleString("search.list.cadastral.mixed"),"#0c8b3d":e.getLocaleString("search.list.cadastral.rustic"),"#136278":e.getLocaleString("search.list.cadastral.urban")}}},styles:{CATAST_Pol_ParcelaUrba:{polygon:{fillColor:"#000000",fillOpacity:.1,strokeColor:"#136278",strokeWidth:2,strokeOpacity:1}},CATAST_Pol_ParcelaRusti:{polygon:{fillColor:"#000000",fillOpacity:.1,strokeColor:"#0c8b3d",strokeWidth:2,strokeOpacity:1}},CATAST_Pol_ParcelaMixta:{polygon:{fillColor:"#000000",fillOpacity:.1,strokeColor:"#e5475f",strokeWidth:2,strokeOpacity:1}}},parser:e.getCadastralRef,goTo:e.goToCadastralRef,goToIdFormat:"M{0}P{1}Par{2}",idPropertiesIdentifier:"#"};e.availableSearchTypes[TC.Consts.searchType.COORDINATES]={
parser:e.getCoordinates,goTo:e.goToCoordinates,label:null,suggestionListHead:function(t){return{label:e.availableSearchTypes[TC.Consts.searchType.COORDINATES].label||e.getLocaleString("search.list.coordinates")}}};e.availableSearchTypes[TC.Consts.searchType.MUNICIPALITY]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:"CATAST_Pol_Municipio",dataIdProperty:["CMUNICIPIO"],queryProperties:{tProperty:["MUNINOAC","MUNICIPIO"]},suggestionListHead:function(){return{label:e.getLocaleString("search.list.municipality"),color:{"#fe06a5":e.getLocaleString("search.list.municipality")}}},outputProperties:["MUNICIPIO"],outputFormatLabel:"{0}",searchWeight:2,styles:{CATAST_Pol_Municipio:{polygon:{fillColor:"#000000",fillOpacity:.1,strokeColor:"#fe06a5",strokeWidth:2,strokeOpacity:1}}},parser:e.getAddress,goTo:e.goToAddress};e.availableSearchTypes[TC.Consts.searchType.LOCALITY]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:["CATAST_Pol_Municipio","ESTADI_Pol_EntidadPob"],renderFeatureType:["CATAST_Pol_Municipio"],dataIdProperty:{CATAST_Pol_Municipio:["CMUNICIPIO"],ESTADI_Pol_EntidadPob:["CMUNICIPIO","CENTIDAD"]},queryProperties:{tProperty:{CATAST_Pol_Municipio:["MUNINOAC","MUNICIPIO"],ESTADI_Pol_EntidadPob:["ENTINOAC","ENTIDAD"]}},suggestionListHead:function(){return{label:e.getLocaleString("search.list.locality"),color:{"#feba1e":e.getLocaleString("search.list.locality")}}},outputProperties:{CATAST_Pol_Municipio:["MUNICIPIO"],ESTADI_Pol_EntidadPob:["MUNICIPIO","ENTIDAD"]},outputFormatLabel:{CATAST_Pol_Municipio:"{0}",ESTADI_Pol_EntidadPob:"{1} ({0})"},searchWeight:2,styles:{CATAST_Pol_Municipio:{polygon:{fillColor:"#000000",fillOpacity:0,strokeColor:"#ffffff",strokeWidth:5,strokeOpacity:1}},ESTADI_Pol_EntidadPob:{polygon:{fillColor:"#000000",fillOpacity:.1,strokeColor:"#feba1e",strokeWidth:2,strokeOpacity:1}}},parser:e.getAddress,goTo:e.goToAddress};e.availableSearchTypes[TC.Consts.searchType.COUNCIL]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:"CATAST_Pol_Concejo",renderFeatureType:"",dataIdProperty:["CMUNICIPIO","CCONCEJO"],queryProperties:{tProperty:["CONCEJO"]},outputProperties:["MUNICIPIO","CONCEJO"],outputFormatLabel:"{1} ({0})",searchWeight:2,parser:e.getAddress,goTo:e.goToAddress,idPropertiesIdentifier:"#",suggestionListHead:function(){return{label:e.getLocaleString("search.list.council"),color:{"#49006a":e.getLocaleString("search.list.council")}}},styles:{CATAST_Pol_Concejo:{polygon:{fillColor:"#000000",fillOpacity:.1,strokeColor:"#49006a",strokeWidth:2,strokeOpacity:1}}}};e.availableSearchTypes[TC.Consts.searchType.STREET]={root:null,limit:null,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:"CATAST_Lin_CalleEje",renderFeatureType:"CATAST_Txt_Calle",dataIdProperty:["CVIA"],queryProperties:{tProperty:["ENTINOAC","ENTIDADC"],sProperty:["VIA","VIANOAC"]},suggestionListHead:function(){return{label:e.getLocaleString("search.list.street"),color:{"#CB0000":e.getLocaleString("search.list.street")}}},outputProperties:["ENTIDADC","VIA","CENTIDADC","CMUNICIPIO"],outputFormatLabel:"{1}, {0}",styles:{CATAST_Lin_CalleEje:{line:{strokeColor:"#CB0000",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid"}},CATAST_Txt_Calle:{point:{label:"VIA",angle:"CADANGLE",fontColor:"#000000",fontSize:7,fontWeight:"bold",labelOutlineColor:"#ffffff",labelOutlineWidth:2}}},parser:e.getAddress,goTo:e.goToAddress};e.availableSearchTypes[TC.Consts.searchType.NUMBER]={root:null,limit:null,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:"CATAST_Txt_Portal",renderFeatureType:"",dataIdProperty:["CMUNICIPIO","CENTIDADC","CVIA","PORTAL"],queryProperties:{tProperty:["ENTIDADC","ENTINOAC"],sProperty:["VIA","VIANOAC"],pProperty:["PORTAL"]},suggestionListHead:function(){return{label:e.getLocaleString("search.list.number"),color:{"#CB0000":e.getLocaleString("search.list.number")}}},outputProperties:["ENTIDADC","VIA","PORTAL","CENTIDADC","CMUNICIPIO"],outputFormatLabel:"{1} {2}, {0}",styles:{CATAST_Txt_Portal:{point:{radius:0,label:"PORTAL",angle:"CADANGLE",fontColor:"#CB0000",fontSize:14,fontWeight:"bold",labelOutlineColor:"#FFFFFF",labelOutlineWidth:4}}},parser:e.getAddress,goTo:e.goToAddress};e.availableSearchTypes[TC.Consts.searchType.URBAN]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:"ESTADI_Pol_EntidadPob",renderFeatureType:"",dataIdProperty:["CMUNICIPIO","CENTIDAD"],idPropertiesIdentifier:"#",queryProperties:{tProperty:["ENTINOAC","ENTIDAD"]},suggestionListHead:function(){return{label:e.getLocaleString("search.list.urban"),color:{"#feba1e":e.getLocaleString("search.list.urban")}}},outputProperties:["MUNICIPIO","ENTIDAD"],outputFormatLabel:"{1} ({0})",searchWeight:2,styles:{ESTADI_Pol_EntidadPob:{polygon:{fillColor:"#000000",fillOpacity:.1,strokeColor:"#feba1e",strokeWidth:2,strokeOpacity:1}}},parser:e.getAddress,goTo:e.goToAddress};e.availableSearchTypes[TC.Consts.searchType.COMMONWEALTH]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:["POLUCI_Pol_MancoRSUg"],renderFeatureType:"",dataIdProperty:["CMANCOMUNI"],queryProperties:{tProperty:["MANCOMUNID"]},outputProperties:["MANCOMUNID"],outputFormatLabel:"{0}",searchWeight:1,styles:{POLUCI_Pol_MancoRSUg:{polygon:{fillColor:"#000000",fillOpacity:.1,strokeColor:"#fc4e2a",strokeWidth:2,strokeOpacity:1}}}};e.rootCfg={};e.rootCfg[TC.Consts.searchType.MUNICIPALITY]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:"CATAST_Pol_Municipio",dataIdProperty:["CMUNICIPIO"],queryProperties:{tProperty:["MUNICIPIO"]},outputProperties:["MUNICIPIO"],outputFormatLabel:"{0}",getRootLabel:function(){var t=new $.Deferred;if(e.rootCfg.active&&!e.rootCfg[TC.Consts.searchType.MUNICIPALITY].rootLabel){var o={};o.SERVICE="WFS";o.VERSION=e.rootCfg[TC.Consts.searchType.MUNICIPALITY].version;o.REQUEST="GetFeature";o.TYPENAME=e.rootCfg[TC.Consts.searchType.MUNICIPALITY].featurePrefix+":"+e.rootCfg[TC.Consts.searchType.MUNICIPALITY].featureType;o.OUTPUTFORMAT=e.rootCfg[TC.Consts.searchType.MUNICIPALITY].outputFormat;o.PROPERTYNAME=["CMUNICIPIO"].concat(e.rootCfg[TC.Consts.searchType.MUNICIPALITY].outputProperties).join(",");o.CQL_FILTER=e.rootCfg[TC.Consts.searchType.MUNICIPALITY].root.map(function(e){return["CMUNICIPIO"].map(function(t,o){return t+"="+e[o]}).join(" AND ")});o.CQL_FILTER=o.CQL_FILTER.join(" OR ");$.ajax({url:e.rootCfg[TC.Consts.searchType.MUNICIPALITY].url+"?"+$.param(o),type:"GET"}).done(function(o){if(o.totalFeatures>0){e.rootCfg[TC.Consts.searchType.MUNICIPALITY].rootLabel=o.features.map(function(t){return{id:["CMUNICIPIO"].map(function(e){return t.properties[e]}).join("#"),label:t.properties[e.rootCfg[TC.Consts.searchType.MUNICIPALITY].outputProperties[0]].toLowerCase()}});t.resolve(e.rootCfg[TC.Consts.searchType.MUNICIPALITY].rootLabel)}else{e.rootCfg[TC.Consts.searchType.MUNICIPALITY].rootLabel=[];t.resolve(e.rootCfg[TC.Consts.searchType.MUNICIPALITY].rootLabel)}}).fail(function(){t.resolve([])})}else t.resolve(e.rootCfg[TC.Consts.searchType.MUNICIPALITY].rootLabel);return t}};e.rootCfg[TC.Consts.searchType.LOCALITY]={root:null,limit:!1,url:e.url||"//idena.navarra.es/ogc/wfs",version:e.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:e.featurePrefix||"IDENA",geometryName:"the_geom",featureType:["ESTADI_Pol_EntidadPob"],renderFeatureType:"",dataIdProperty:["CMUNICIPIO","CENTIDADC"],queryProperties:{tProperty:["ENTINOAC"]},outputProperties:["ENTINOAC"],getRootLabel:function(){var t=new $.Deferred;if(e.rootCfg.active&&!e.rootCfg[TC.Consts.searchType.LOCALITY].rootLabel){var o={};o.SERVICE="WFS";o.VERSION=e.rootCfg[TC.Consts.searchType.LOCALITY].version;o.REQUEST="GetFeature";o.TYPENAME=e.rootCfg[TC.Consts.searchType.LOCALITY].featurePrefix+":"+e.rootCfg[TC.Consts.searchType.LOCALITY].featureType;o.OUTPUTFORMAT=e.rootCfg[TC.Consts.searchType.LOCALITY].outputFormat;o.PROPERTYNAME=["CMUNICIPIO","CENTIDAD"].concat(e.rootCfg[TC.Consts.searchType.LOCALITY].outputProperties).join(",");o.CQL_FILTER=e.rootCfg[TC.Consts.searchType.LOCALITY].root.map(function(e){return["CMUNICIPIO","CENTIDAD"].map(function(t,o){return t+"="+e[o]}).join(" AND ")});o.CQL_FILTER=o.CQL_FILTER.join(" OR ");$.ajax({url:e.rootCfg[TC.Consts.searchType.LOCALITY].url+"?"+$.param(o),type:"GET"}).done(function(o){if(o.totalFeatures>0){e.rootCfg[TC.Consts.searchType.LOCALITY].rootLabel=o.features.map(function(t){return{id:["CMUNICIPIO","CENTIDAD"].map(function(e){return t.properties[e]}).join("#"),label:t.properties[e.rootCfg[TC.Consts.searchType.LOCALITY].outputProperties[0]].toLowerCase()}});t.resolve(e.rootCfg[TC.Consts.searchType.LOCALITY].rootLabel)}else{e.rootCfg[TC.Consts.searchType.LOCALITY].rootLabel=[];t.resolve(e.rootCfg[TC.Consts.searchType.LOCALITY].rootLabel)}}).fail(function(){t.resolve([])})}else t.resolve(e.rootCfg[TC.Consts.searchType.LOCALITY].rootLabel);return t}};e.allowedSearchTypes=e.options.allowedSearchTypes||{};if(e.options.allowedSearchTypes)for(var t in e.options.allowedSearchTypes)if(e.availableSearchTypes[t]&&!$.isEmptyObject(e.options.allowedSearchTypes[t])){$.extend(e.availableSearchTypes[t],e.options.allowedSearchTypes[t]);if(e.options.allowedSearchTypes[t].root&&t!=TC.Consts.searchType.MUNICIPALITY&&e.options.allowedSearchTypes[t].rootType==TC.Consts.searchType.MUNICIPALITY||t!=TC.Consts.searchType.LOCALITY&&e.options.allowedSearchTypes[t].rootType==TC.Consts.searchType.LOCALITY){e.rootCfg.active=e.rootCfg[e.options.allowedSearchTypes[t].rootType];e.rootCfg.active.root=e.options.allowedSearchTypes[t].root;e.rootCfg.active.limit=e.options.allowedSearchTypes[t].limit;e.availableSearchTypes[TC.Consts.searchType.STREET].queryProperties.tProperty=e.availableSearchTypes[TC.Consts.searchType.NUMBER].queryProperties.tProperty=e.rootCfg.active.dataIdProperty}}e.rootCfg.active&&e.rootCfg.active.getRootLabel();e.queryableFeatures=e.options.queryableFeatures||!1;e.UTMX_LEN=6;e.UTMY_LEN=7;e.CADASTRAL=TC.Consts.searchType.CADASTRAL;e.COORDINATES=TC.Consts.searchType.COORDINATES;e.MUNICIPALITY=TC.Consts.searchType.MUNICIPALITY;e.LOCALITY=TC.Consts.searchType.LOCALITY;e.COUNCIL=TC.Consts.searchType.COUNCIL;e.STREET=TC.Consts.searchType.STREET;e.NUMBER=TC.Consts.searchType.NUMBER;e.COMMONWEALTH=TC.Consts.searchType.COMMONWEALTH;e.URBAN=TC.Consts.searchType.URBAN;e.ROAD=TC.Consts.searchType.ROAD;e.ROADPK=TC.Consts.searchType.ROADPK;e.wrap=new TC.wrap.control.Search(e);e.interval=500;e.searchTypes={CADASTRAL_SEARCH:{parser:e.getCadastralRef,goTo:e.goToCadastralRef},COORDINATES_SEARCH:{parser:e.getCoordinates,goTo:e.goToCoordinates},ADDRESS_SEARCH:{types:[TC.Consts.searchType.MUNICIPALITY,TC.Consts.searchType.LOCALITY,TC.Consts.searchType.COUNCIL,TC.Consts.searchType.URBAN,TC.Consts.searchType.STREET,TC.Consts.searchType.NUMBER],parser:e.getAddress,goTo:e.goToAddress}};e.NORMAL_PATTERNS={ROMAN_NUMBER:/M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3}){1,}?\S?\./i,ABSOLUTE_NOT_DOT:/[`~!@#$%^&*_|+\=?;:'"\{\}\[\]\\]/gi,ABSOLUTE:/[`~!@#$%^&*_|+\=?;:'.\{\}\[\]\\]/gi};e.filter=function(e){var t=function(t,o){for(var r=0;r<e._search.data.length;r++)if(e._search.data[r].id==t&&(!o||o&&e._search.data[r].dataRole===o))return e._search.data[r]},o=function(t){var o=e.availableSearchTypes[t.dataRole],r=t.dataLayer;if(o.renderFeatureType){t.dataLayer instanceof Array||(r=[t.dataLayer]);r=r.concat(o.renderFeatureType instanceof Array?o.renderFeatureType:[o.renderFeatureType])}return r};return{getPropertyName:function(t,o){return e.availableSearchTypes[t].queryProperties[o+"Property"]},getPropertyValue:function(t,o){return e.availableSearchTypes[t][o]},getIsLikeNode:function(t,o){var r=/([\-\"\.\\xba\(\)\/])/g;r.test(o)&&(o=o.replace(r,"\\$1"));return o.toString().indexOf(e._LIKE_PATTERN)>-1?'<Or><PropertyIsLike escape="\\" singleChar="_" wildCard="*" matchCase="false"><PropertyName>'+t+"</PropertyName><Literal>"+o.toLowerCase().replace(/\</gi,"&lt;").replace(/\>/gi,"&gt;")+'</Literal></PropertyIsLike><PropertyIsLike escape="\\" singleChar="_" wildCard="*" matchCase="false"><PropertyName>'+t+"</PropertyName><Literal>"+o.toUpperCase().replace(/\</gi,"&lt;").replace(/\>/gi,"&gt;")+"</Literal></PropertyIsLike></Or>":"<PropertyIsEqualTo><PropertyName>"+t+"</PropertyName><Literal>"+o.replace(/\</gi,"&lt;").replace(/\>/gi,"&gt;")+"</Literal></PropertyIsEqualTo>"},getFilterNode:function(t,o){var r;if(t instanceof Array||"string"==typeof t){if(t instanceof Array&&t.length>1){r="<ogc:Or>";for(var i=0;i<t.length;i++)r+=e.filter.getIsLikeNode($.trim(t[i]),o);return r+="</ogc:Or>"}return e.filter.getIsLikeNode($.trim(t instanceof Array&&1===t.length?t[0]:t),o)}var n=[];for(var a in t)if(t[a]instanceof Array&&t[a].length>1){r="<Or>";for(var i=0;i<t[a].length;i++)r+=e.filter.getIsLikeNode($.trim(t[a][i]),o);r+="</Or>";n.push('(<Filter xmlns="http://www.opengis.net/ogc">'+r+"</Filter>)")}else{var l=t[a];t[a]instanceof Array&&1==t[a].length&&(l=t[a][0]);n.push('(<Filter xmlns="http://www.opengis.net/ogc"><Or>'+e.filter.getIsLikeNode($.trim(l),o)+"</Or></Filter>)")}return n.join("")},getFilter:function(t,o){var r={};r.multiL=!1;r.f="";var i,n=function(t,o){var r=[];if(o!=e.rootCfg.active.root)for(var i=o.split("#"),n=0;n<e.rootCfg.active.dataIdProperty.length;n++){0==n&&e.rootCfg.active.dataIdProperty.length>1&&r.push("<ogc:And>");r.push(e.filter.getFilterNode(e.rootCfg.active.dataIdProperty[n],i.length>n?i[n]:i[0]));n==e.rootCfg.active.dataIdProperty.length-1&&e.rootCfg.active.dataIdProperty.length>1&&r.push("</ogc:And>")}else{for(var a=0;a<e.rootCfg.active.root.length;a++){var i=e.rootCfg.active.root[a];0==a&&e.rootCfg.active.root.length>1&&r.push("<ogc:Or>");for(var n=0;n<e.rootCfg.active.dataIdProperty.length;n++){0==n&&e.rootCfg.active.dataIdProperty.length>1&&r.push("<ogc:And>");r.push(e.filter.getFilterNode(e.rootCfg.active.dataIdProperty[n],i.length>n?i[n]:i[0]));n==e.rootCfg.active.dataIdProperty.length-1&&e.rootCfg.active.dataIdProperty.length>1&&r.push("</ogc:And>")}}e.rootCfg.active.root.length>1&&r.push("</ogc:Or>")}return t.concat(r)};switch(o){case e.NUMBER:i=[];if(e.rootCfg.active||!/(\<|\>|\<\>)/gi.exec(t.t)&&!/(\<|\>|\<\>)/gi.exec(t.s)){e.rootCfg.active?i=n(i,t.t):i.push(e.filter.getFilterNode(e.filter.getPropertyName(o,"t"),e._LIKE_PATTERN+t.t+e._LIKE_PATTERN));i.push(e.filter.getFilterNode(e.filter.getPropertyName(o,"s"),e._LIKE_PATTERN+t.s+e._LIKE_PATTERN))}else{var a=/(\<|\>|\<\>)/gi.exec(t.t);a?i.push(e.filter.getFilterNode(e.filter.getPropertyName(o,"t"),e._LIKE_PATTERN+t.t.substring(0,t.t.indexOf(a[0])).trim()+e._LIKE_PATTERN)):e.rootCfg.active?i=n(i,t.t):i.push(e.filter.getFilterNode(e.filter.getPropertyName(o,"t"),e._LIKE_PATTERN+t.t+e._LIKE_PATTERN));a=/(\<|\>|\<\>)/gi.exec(t.s);i.push(a?e.filter.getFilterNode(e.filter.getPropertyName(o,"s"),e._LIKE_PATTERN+t.s.substring(0,t.s.indexOf(a[0])).trim()+e._LIKE_PATTERN):e.filter.getFilterNode(e.filter.getPropertyName(o,"s"),e._LIKE_PATTERN+t.s+e._LIKE_PATTERN))}i.push(e.filter.getFilterNode(e.filter.getPropertyName(o,"p"),t.p+"*"));r.f='<ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:And>'+i.join("")+"</ogc:And></ogc:Filter>";break;case e.STREET:i=[];if(e.rootCfg.active||!/(\<|\>|\<\>)/gi.exec(t.t)&&!/(\<|\>|\<\>)/gi.exec(t.s)){e.rootCfg.active?i=n(i,t.t):i.push(e.filter.getFilterNode(e.filter.getPropertyName(o,"t"),e._LIKE_PATTERN+t.t+e._LIKE_PATTERN));i.push(e.filter.getFilterNode(e.filter.getPropertyName(o,"s"),e._LIKE_PATTERN+t.s+e._LIKE_PATTERN))}else{var a=/(\<|\>|\<\>)/gi.exec(t.t);a?i.push(e.filter.getFilterNode(e.filter.getPropertyName(o,"t"),e._LIKE_PATTERN+t.t.substring(0,t.t.indexOf(a[0])).trim()+e._LIKE_PATTERN)):e.rootCfg.active?i=n(i,t.t):i.push(e.filter.getFilterNode(e.filter.getPropertyName(o,"t"),e._LIKE_PATTERN+t.t+e._LIKE_PATTERN));a=/(\<|\>|\<\>)/gi.exec(t.s);i.push(a?e.filter.getFilterNode(e.filter.getPropertyName(o,"s"),e._LIKE_PATTERN+t.s.substring(0,t.s.indexOf(a[0])).trim()+e._LIKE_PATTERN):e.filter.getFilterNode(e.filter.getPropertyName(o,"s"),e._LIKE_PATTERN+t.s+e._LIKE_PATTERN))}r.f='<ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:And>'+i.join("")+"</ogc:And></ogc:Filter>";break;case e.COUNCIL:r.f='<ogc:Filter xmlns:ogc="http://www.opengis.net/ogc">'+e.filter.getFilterNode(e.filter.getPropertyName(o,"t"),e._LIKE_PATTERN+t.t+e._LIKE_PATTERN)+"</ogc:Filter>";break;case e.URBAN:r.f='<ogc:Filter xmlns:ogc="http://www.opengis.net/ogc">'+e.filter.getFilterNode(e.filter.getPropertyName(o,"t"),e._LIKE_PATTERN+t.t+e._LIKE_PATTERN)+"</ogc:Filter>";break;case e.LOCALITY:r.f=e.filter.getFilterNode(e.filter.getPropertyName(o,"t"),e._LIKE_PATTERN+t.t+e._LIKE_PATTERN);r.multiL=!0;break;case e.MUNICIPALITY:r.f='<ogc:Filter xmlns:ogc="http://www.opengis.net/ogc">'+e.filter.getFilterNode(e.filter.getPropertyName(o,"t"),e._LIKE_PATTERN+t.t+e._LIKE_PATTERN)+"</ogc:Filter>";break;case e.ROAD:r.f='<ogc:Filter xmlns:ogc="http://www.opengis.net/ogc">'+e.filter.getFilterNode(e.filter.getPropertyName(o,"t"),e._LIKE_PATTERN+t.t+e._LIKE_PATTERN)+"</ogc:Filter>";break;case e.ROADPK:var i=[];i.push(e.filter.getFilterNode(e.filter.getPropertyName(o,"t"),e._LIKE_PATTERN+t.t+e._LIKE_PATTERN));i.push(e.filter.getFilterNode(e.filter.getPropertyName(o,"s"),e._LIKE_PATTERN+t.s+e._LIKE_PATTERN));r.f='<ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"><ogc:And>'+i.join("")+"</ogc:And></ogc:Filter>"}return r},getParams:function(t,o,r,i){var n=e.filter.getFilter(t,o),a={REQUEST:"GetFeature",SERVICE:"WFS",MAXFEATURES:500,VERSION:e.availableSearchTypes[o].version,OUTPUTFORMAT:e.availableSearchTypes[o].outputFormat},l=e.filter.getPropertyValue(o,"featureType");if(l instanceof Array){for(var s=[],p=0;p<l.length;p++)s.push(e.availableSearchTypes[o].featurePrefix?e.availableSearchTypes[o].featurePrefix+":"+$.trim(l[p]):$.trim(l[p]));a.TYPENAME=s.join(",")}else a.TYPENAME=e.availableSearchTypes[o].featurePrefix?e.availableSearchTypes[o].featurePrefix+":"+$.trim(l):$.trim(l);var c=function(e){if(""!==(e||"")){if(e instanceof Array)return e.join(",");var t=[];if(e instanceof Object)for(var o in e){var r=e[o][0];e[o].length>1&&(r=e[o].join(","));t.push(r)}return t}},u=c(r),g=c(i);if(u instanceof Array&&g instanceof Array){a.PROPERTYNAME="";for(var p=0;p<u.length;p++)a.PROPERTYNAME+="("+u[p]+","+g[p]+")"}else a.PROPERTYNAME=u+","+g;a.FILTER=n.f;return $.param(a)},getGoToFilterLayer:function(e,r){var i=t(e,r);return o(i)},getGoToFilter:function(r,i){var n=[],a=r.split("#"),l=t(r,i);if(l&&l.dataRole){var s=e.availableSearchTypes[l.dataRole],p=s.dataIdProperty,c=o(l);if(r.indexOf("#")>-1&&c instanceof Array)for(var u=0;u<c.length;u++)for(var g=0;g<p[c[u]].length;g++)n.push({name:p[c[u]][g],value:a[g]});else if(-1==r.indexOf("#")&&c instanceof Array){for(var d=p,u=0;u<c.length;u++)if(!n.hasOwnProperty(c[u])){d instanceof Object&&p.hasOwnProperty(c[u])&&(d=p[c[u]]);for(var g=0;g<d.length;g++)g<a.length&&n.push({name:d[g],value:a[g]})}}else{p instanceof Object&&p.hasOwnProperty(c)&&(p=p[c]);for(var u=0;u<p.length;u++)n.push({name:p[u],value:a[u]})}}return e.transformFilter(n)},getGoToElement:function(e){return t(e)}}}(e)};TC.inherit(TC.control.Search,TC.Control);!function(){var e=TC.control.Search.prototype;e.CLASS="tc-ctl-search";TC.Consts.event.SEARCHQUERYEMPTY=TC.Consts.event.SEARCHQUERYEMPTY||"searchqueryempty.tc";e.template=TC.isDebug?TC.apiLocation+"TC/templates/Search.html":function(){function t(e,t){return e.w("<h2>").h("i18n",t,{},{$key:"search.1"}).w('</h2><div class="tc-ctl-search-content"><input type="search" class="tc-ctl-search-txt" placeholder="').h("i18n",t,{},{$key:"search.placeholder"}).w('" title="').h("i18n",t,{},{$key:"search.instructions"}).w('" /><a title="').h("i18n",t,{},{$key:"search.instructions"}).w('" class="tc-ctl-btn tc-ctl-search-btn">').h("i18n",t,{},{$key:"search.2"}).w('</a><ul class="tc-ctl-search-list"></ul></div>')}dust.register(e.CLASS,t);t.__dustBody=!0;return t};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);t._search={data:[]};t.layerStyleFN=function(){function e(e){return e.indexOf(".")>-1?e.split(".")[0]:e}function o(e,o,r){for(var i in t.allowedSearchTypes){var n=t.availableSearchTypes[i]||t.allowedSearchTypes[i];if(n&&n.hasOwnProperty("featureType")&&(n.featureType.indexOf(r)>-1||n.renderFeatureType&&n.renderFeatureType.indexOf(r)>-1)&&n.styles[r].hasOwnProperty(o))return n.styles[r][o][e]}return TC.Cfg.styles[o][e]}return function(t,r,i,n){var a=this;n instanceof TC.Feature||a.map.$events.trigger($.Event(TC.Consts.event.FEATURESADD,{layer:a.layer,geom:n.geom}));var l=o(r,t,e(n.id));if(i){if(l instanceof Array){var s=l.map(function(e){return n.getData().hasOwnProperty(e)?n.getData()[e]:""}),p=this.getSearchTypeByFeature(e(n.id));return p?p.outputFormatLabel.tcFormat(s):s.join(" ")}return n.getData().hasOwnProperty(l)?n.getData()[l]:""}return l}}();e.loaded(function(){var o=t.layerStyleFN;t.layerPromise=e.addLayer({id:TC.getUID(),title:"B\xfasquedas",stealth:!0,type:TC.Consts.layerType.VECTOR,styles:{polygon:{fillColor:o.bind(t,"polygon","fillColor",!1),fillOpacity:o.bind(t,"polygon","fillOpacity",!1),strokeColor:o.bind(t,"polygon","strokeColor",!1),strokeOpacity:o.bind(t,"polygon","strokeOpacity",!1),strokeWidth:o.bind(t,"polygon","strokeWidth",!1)},line:{strokeColor:o.bind(t,"line","strokeColor",!1),strokeOpacity:o.bind(t,"line","strokeOpacity",!1),strokeWidth:o.bind(t,"line","strokeWidth",!1)},marker:{anchor:TC.Defaults.styles.marker.anchor,height:TC.Defaults.styles.marker.height,width:TC.Defaults.styles.marker.width},point:{radius:o.bind(t,"point","radius",!1),height:o.bind(t,"point","height",!1),width:o.bind(t,"point","width",!1),fillColor:o.bind(t,"point","fillColor",!1),fillOpacity:o.bind(t,"point","fillOpacity",!1),strokeColor:o.bind(t,"point","strokeColor",!1),strokeWidth:o.bind(t,"point","strokeWidth",!1),fontSize:o.bind(t,"point","fontSize",!1),fontColor:o.bind(t,"point","fontColor",!1),labelOutlineColor:o.bind(t,"point","labelOutlineColor",!1),labelOutlineWidth:o.bind(t,"point","labelOutlineWidth",!1),label:o.bind(t,"point","label",!0),angle:o.bind(t,"point","angle",!0)}}});$.when(t.layerPromise).then(function(e){t.layer=e})});t.EMPTY_RESULTS_LABEL=t.getLocaleString("noResults");t.EMPTY_RESULTS_TITLE=t.getLocaleString("checkCriterion");t.OUTBBX_LABEL=t.getLocaleString("outsideOfLimits");t.WFS_TYPE_ATTRS=["url","version","geometryName","featurePrefix","featureType","properties","outputFormat"];t.availableSearchTypes[TC.Consts.searchType.ROAD]={root:null,limit:!1,url:t.url||"//idena.navarra.es/ogc/wfs",version:t.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:t.featurePrefix||"IDENA",geometryName:"the_geom",featureType:"INFRAE_Lin_CtraEje",dataIdProperty:["DCARRETERA"],queryProperties:{tProperty:["DCARRETERA"]},suggestionListHead:function(){return{label:t.getLocaleString("search.list.road"),color:{"#00b2fc":t.getLocaleString("search.list.road")}}},outputProperties:["DCARRETERA"],outputFormatLabel:t.getLocaleString("search.list.road.shorter")+": {0}",searchWeight:2,styles:{INFRAE_Lin_CtraEje:{polygon:{strokeColor:"#00b2fc",strokeOpacity:1,strokeWidth:5},line:{strokeColor:"#00b2fc",strokeOpacity:1,strokeWidth:5,strokeLinecap:"round",strokeDashstyle:"solid"}}},parser:t.getRoad,goTo:t.goToRoad,pattern:new RegExp("^(?:(?:"+t.getLocaleString("search.list.road")+"|"+t.getLocaleString("search.list.road.shorter")+")\\:?)?\\s*((A?|AP?|N?|NA?|PA?)\\s*\\-?\\s*(\\d{1,4})\\s*\\-?\\s*(A?|B?|C?|R?))$","i")};t.availableSearchTypes[TC.Consts.searchType.ROADPK]={root:null,limit:!1,url:t.url||"//idena.navarra.es/ogc/wfs",version:t.version||"1.1.0",outputFormat:TC.Consts.format.JSON,featurePrefix:t.featurePrefix||"IDENA",geometryName:"the_geom",featureType:"INFRAE_Sym_CtraPK",dataIdProperty:["DCARRETERA","CPK"],queryProperties:{tProperty:["DCARRETERA"],sProperty:["PK"]},suggestionListHead:function(){return{label:t.getLocaleString("search.list.pk.larger"),color:{"#00b2fc":t.getLocaleString("search.list.road")+" "+t.getLocaleString("search.list.pk")}}},outputProperties:["DCARRETERA","PK"],outputFormatLabel:t.getLocaleString("search.list.road.shorter")+": {0} "+t.getLocaleString("search.list.pk")+": {1}",searchWeight:2,styles:{INFRAE_Sym_CtraPK:{point:{label:["DCARRETERA","PK"],fontColor:"#00b2fc",fontSize:14,fontWeight:"bold",labelOutlineColor:"#ffffff",labelOutlineWidth:2}}},parser:t.getPK,goTo:t.goToPK,pattern:new RegExp("^(?:(?:"+t.getLocaleString("search.list.road")+"|"+t.getLocaleString("search.list.road.shorter")+")\\:?)?\\s*((A?|AP?|N?|NA?|PA?)\\s*\\-?\\s*(\\d{1,4})\\s*\\-?\\s*(A?|B?|C?|R?))\\s*\\,*\\s*(?:(?:"+t.getLocaleString("search.list.pk")+"\\:?)|(?:P\\:?)|(?:K\\:?)|(?:KM\\:?)|(?:\\s+|\\,+))\\s*(\\d{1,4})$","i")}};e.renderData=function(e,t){var o=this;o._search=o._search||{};var r=function(){o.search(o.$text.val(),function(e){if(1===e.length){o.$text.val(e[0].label);o.goToResult(e[0].id);o.$list.hide("fast")}else 0===e.length&&o.$list.hide("fast")})};TC.Control.prototype.renderData.call(o,e,function(){var e=function(){o.$text.val(o.$list[0].label||o.$list.find("li:not([header]) > a > span").text());o.lastPattern=o.$text.val();o.goToResult(o.$list[0].id||unescape(o.$list.find("li:not([header]) > a").attr("href")).substring(1));o.$list.hide("fast")};o.$text=o._$div.find("input.tc-ctl-search-txt");o.$list=o._$div.find(".tc-ctl-search-list");o.$button=o._$div.find(".tc-ctl-search-btn");o.$button.on(TC.Consts.event.CLICK,function(){o.getLayer().then(function(t){o.$list.find("li > a:not(.tc-ctl-search-li-loading,.tc-ctl-search-li-empty)").length>1||(t.features.length>0?t.map.zoomToFeatures(t.features):1===o.$list.find("li > a:not(.tc-ctl-search-li-loading,.tc-ctl-search-li-empty)").length?e():o.$text.trigger("keyup.autocomplete"))})});o.$list.on(TC.Consts.event.CLICK,"a.tc-ctl-search-li-empty",function(){o.$list.hide("fast");o.$text.focus()});try{if(o.$text.has($("::-ms-clear"))){var t;o.$text.on("mouseup",function(e){t=o.$text.val();""!==t&&setTimeout(function(){var e=o.$text.val();if(""===e){o.$list.hide("fast");r()}},1)})}}catch(i){}o.$text.on("keypress",function(t){if(13==t.which){t.preventDefault();t.stopPropagation();o.lastPattern="";1===o.$list.find("li > a:not(.tc-ctl-search-li-loading,.tc-ctl-search-li-empty)").length?e():r();return!1}}).on("search",function(){if(0===o.$text.val().length){o.$list.hide("fast");r()}}).on("input",function(){if(0===o.$text.val().length){o.$list.hide("fast");r()}}).on("targetCleared.autocomplete",function(){o.$list.hide("fast")}).on("targetUpdated.autocomplete",function(){o.$list.find("li").length>0&&o.$list.show("fast")});o.lastPattern="";o.retryTimeout=null;TC.loadJS(!o.$text.autocomplete,[TC.apiLocation+"lib/jQuery/autocomplete.js"],function(){var e;o.$text=o._$div.find("input.tc-ctl-search-txt");o.$text.autocomplete({link:"#",target:o.$list,minLength:2,ctx:o,source:function(t,r){function i(){var t=o.$text.val().trim();if(t.length>0&&(!o.lastPattern||t!=o.lastPattern)&&performance.now()-o.lastpress>o.interval){window.cancelAnimationFrame(e);e=void 0;o.$list.hide("fast");o.lastPattern=t;o.search(t,r)}else e=requestAnimationFrame(i)}o.lastpress=performance.now();e||(e=requestAnimationFrame(i))},callback:function(e){var t=$(e.target);$(e.target).is("a")||(t=$(e.target).closest("a"));o.$text.val($(t).find("span[hidden]").text());o.lastPattern=o.$text.val();o.goToResult(unescape($(t).attr("href")).substring(1),$(t).parent().attr("dataRole"));o.$text.autocomplete("clear")},buildHTML:function(e){function t(e,t){var o=parseInt(e,10),r=parseInt(t,10);if(isNaN(o)&&isNaN(r)){var i=e.replace(n,""),l=t.replace(n,"");if(i===l){var s=parseInt(e.replace(a,""),10),p=parseInt(t.replace(a,""),10);return s===p?0:s>p?1:-1}return i>l?1:-1}return isNaN(o)?1:isNaN(r)?-1:o>r?1:-1}var r=[],i=[],n=/[^a-zA-Z]/g,a=/[^0-9]/g,l=e.results.sort(function(e,o){return e.dataRole>o.dataRole?1:e.dataRole<o.dataRole?-1:t(e.label,o.label)});o.rootCfg.active&&(l=l.sort(function(e,o){var r=this.rootCfg.active.root[0].join("-"),i=this.rootCfg.active.dataIdProperty.map(function(t){return e.properties[t].toString()}).join("-"),n=this.rootCfg.active.dataIdProperty.map(function(e){return o.properties[e].toString()}).join("-");return i!==r&&n===r?1:i===r&&n!==r?-1:t(e.label,o.label)}.bind(o)));for(var s=0;s<l.length;s++){var p=l[s];if(-1==i.indexOf(p.dataRole)){var c=this.ctx.availableSearchTypes[p.dataRole]||this.ctx.allowedSearchTypes[p.dataRole],u=c.suggestionListHead(),g='<li header><span class="header">'+u.label+"</span>";for(var d in u.color)g+='<span class="header-color" title="'+u.color[d]+'" style="color: '+d+';"></span>';r[r.length]=g+"</li>";i.push(p.dataRole)}var h=p.label,f=[],y=this.ctx.lastPattern;y=o.NORMAL_PATTERNS.ROMAN_NUMBER.test(y)?y.replace(o.NORMAL_PATTERNS.ABSOLUTE_NOT_DOT,""):y.replace(o.NORMAL_PATTERNS.ABSOLUTE,"");var m=[],v=",";-1==y.indexOf(v)&&(v=" ");m=y.trim().split(v);if(p.label.indexOf(this.ctx.LAT_LABEL)>-1&&p.label.indexOf(this.ctx.LON_LABEL)>-1||p.label.indexOf(this.ctx.UTMX_LABEL)>-1&&p.label.indexOf(this.ctx.UTMY_LABEL)>-1){m=this.ctx.lastPattern.split(" ");for(var C=0;C<m.length;C++)","==m[C].trim().slice(-1)&&(m[C]=m[C].slice(0,-1))}for(var T=0;T<m.length;T++)if(m[T].trim().length>0){f.push("("+m[T].trim().replace(/\(/gi,"\\(").replace(/\)/gi,"\\)")+")");var _=/((\<)|(\>)|(\<\>))/gi.exec(m[T].trim());if(_)for(var S=m[T].trim().replace(/((\<)|(\>)|(\<\>))/gi,"").split(" "),E=0;E<S.length;E++)S[E].trim().length>0&&f.push("("+S[E].trim().replace(/\(/gi,"\\(").replace(/\)/gi,"\\)")+")")}if(p.dataRole==TC.Consts.searchType.ROAD||p.dataRole==TC.Consts.searchType.ROADPK){var x=o.availableSearchTypes[p.dataRole].pattern,_=x.exec(this.ctx.lastPattern);if(_){f=[];if(_[2]&&_[3]){f.push(_[2]+"-"+_[3]);_[4]&&(f[f.length-1]=f[f.length-1]+"-"+_[4]);f[f.length-1]="("+f[f.length-1]+")"}_[5]&&f.push("(?:"+o.getLocaleString("search.list.pk")+"\\:\\s\\d*)("+_[5]+")\\d*")}}var P="("+f.join("|")+")";P=P.replace(/a/gi,"[a|\xe1]");P=P.replace(/e/gi,"[e|\xe9]");P=P.replace(/i/gi,"[i|\xed]");P=P.replace(/o/gi,"[o|\xf3]");P=P.replace(/u/gi,"[u|\xfa|\xfc]");var L=new RegExp(P,"gi"),w=p.label;h=p.dataRole==TC.Consts.searchType.ROAD||p.dataRole==TC.Consts.searchType.ROADPK?w.replace(L,function(){var e=Array.prototype.slice.call(arguments,0);return e[e.length-3]?e[0].replace(e[e.length-3],"<b>"+e[e.length-3]+"</b>"):"<b>"+e[0]+"</b>"}):w.replace(L,"<b>$1</b>");r[r.length]='<li dataRole="'+p.dataRole+'"><a href="#'+encodeURIComponent(p.id)+'"><span hidden>'+p.label+"</span>"+h+"</a></li>"}return r.join("")}});o.$text.add(o.$list).keydown(function(e){if(!e.ctrlKey&&!e.altKey&&!e.shiftKey)if(40===e.keyCode){o.$text[0]==document.activeElement?o.$list.find("li:not([header]):first a").focus():o.$list.find("li:not([header]):last a").is(":focus")?o.$text.focus():o.$list.find("li:not([header])").find("a:focus").parent("li:not([header])").nextAll("li:not([header]):first").find("a").focus();e.preventDefault();e.stopPropagation()}else if(38===e.keyCode){o.$text[0]==document.activeElement?o.$list.find("li:not([header]):last a").focus():document.activeElement==o.$list.find("li:not([header]):first a").get(0)?o.$list.find("li:not([header]):last a").focus():o.$list.find("li:not([header])").find("a:focus").parent("li:not([header])").prevAll("li:not([header]):first").find("a").focus();

e.preventDefault();e.stopPropagation()}e.stopPropagation()})})});$.isFunction(t)&&t()};e.getLayer=function(){var e=this;e.layerPromise=e.layerPromise||new $.Deferred;if(e.layer){var t=new $.Deferred;t.resolve(e.layer);return t}return e.layerPromise};e.getFeatures=function(){var e=this;return e.layer.features};e.getSearchTypeByFeature=function(e){var t=this;for(var o in t.allowedSearchTypes){var r=t.availableSearchTypes[o]||t.allowedSearchTypes[o];if(r&&r.hasOwnProperty("featureType")&&(r.featureType.indexOf(e)>-1||r.renderFeatureType&&r.renderFeatureType.indexOf(e)>-1))return r}return null};e.cleanMap=function(){var e=this;e.getLayer().then(function(t){var o=t.features;t.clearFeatures();e.map.$events.trigger($.Event(TC.Consts.event.FEATUREREMOVE,{layer:t,feature:o}));for(var r=0;r<e.WFS_TYPE_ATTRS.length;r++)t.hasOwnProperty(e.WFS_TYPE_ATTRS[r])&&delete t[e.WFS_TYPE_ATTRS[r]]})};e.getMunicipalities=function(){var e=this;TC.cache.search=TC.cache.search||{};if(!TC.cache.search.municipalities){e._municipalitiesDeferred=new $.Deferred;var t={REQUEST:"GetFeature",SERVICE:"WFS",TYPENAME:e.availableSearchTypes[TC.Consts.searchType.CADASTRAL].municipality.featureType,VERSION:e.availableSearchTypes[TC.Consts.searchType.CADASTRAL].version,PROPERTYNAME:e.availableSearchTypes[TC.Consts.searchType.CADASTRAL].municipality.outputProperties.join(","),OUTPUTFORMAT:e.availableSearchTypes[TC.Consts.searchType.CADASTRAL].outputFormat};e.availableSearchTypes[TC.Consts.searchType.CADASTRAL].featurePrefix&&(t.TYPENAME=e.availableSearchTypes[TC.Consts.searchType.CADASTRAL].featurePrefix+":"+t.TYPENAME);var o=e.availableSearchTypes[TC.Consts.searchType.CADASTRAL].url+"?"+$.param(t);$.ajax({url:o,type:"GET",dataType:"text"}).done(function(t){var o;o=e.availableSearchTypes[TC.Consts.searchType.CADASTRAL].outputFormat===TC.Consts.format.JSON?new TC.wrap.parser.JSON:new TC.wrap.parser.WFS({featureNS:e.availableSearchTypes[TC.Consts.searchType.CADASTRAL].municipality.featurePrefix,featureType:e.availableSearchTypes[TC.Consts.searchType.CADASTRAL].municipality.featureType});var r=o.read(t);TC.cache.search.municipalities=[];for(var i=0;i<r.length;i++){var n=r[i];TC.cache.search.municipalities.push({label:n.data[e.availableSearchTypes[TC.Consts.searchType.CADASTRAL].municipality.outputProperties[1]],id:n.data[e.availableSearchTypes[TC.Consts.searchType.CADASTRAL].municipality.outputProperties[0]]})}TC.cache.search.municipalities.sort(function(e,t){var o;o=e.label<t.label?-1:e.label>t.label?1:0;return o});e._municipalitiesDeferred.resolve(TC.cache.search.municipalities)}).fail(function(){e._municipalitiesDeferred.resolve()})}return TC.cache.search.municipalities||e._municipalitiesDeferred.promise()};e.getCoordinates=function(e){var t=this,o=new $.Deferred,r=e.match(new RegExp("^"+$.trim(t.UTMX_LABEL.toLowerCase())+"*\\s*([0-9]{"+t.UTMX_LEN+"}(?:[.,]\\d+)?)\\s*\\,?\\s*"+$.trim(t.UTMY_LABEL.toLowerCase())+"*\\s*([0-9]{"+t.UTMY_LEN+"}(?:[.,]\\d+)?)$"));r&&(e=r[1]+" "+r[2]);r=e.match(new RegExp("^"+$.trim(t.LAT_LABEL.toLowerCase())+"*\\s*([-+]?\\d{1,3}([.,]\\d+)?)\\,?\\s*"+$.trim(t.LON_LABEL.toLowerCase())+"*\\s*([-+]?\\d{1,2}([.,]\\d+)?)$"));r&&(e=r[1]+" "+r[3]);if(/\d/.test(e)&&(new RegExp("^([0-9]{"+t.UTMX_LEN+"}(?:[.,]\\d+)?)\\s*\\,?\\s*([0-9]{"+t.UTMY_LEN+"}(?:[.,]\\d+)?)$").test(e)||/^([-+]?\d{1,3}([.,]\d+)?)\,?\s*([-+]?\d{1,2}([.,]\d+)?)$/.test(e))){r=/^([-+]?\d{1,3}([.,]\d+)?)\,?\s*([-+]?\d{1,2}([.,]\d+)?)$/.exec(e);if(r&&(r[1].indexOf(",")>-1||r[3].indexOf(",")>-1)){r[1]=r[1].replace(",",".");r[3]=r[3].replace(",",".");e=r[1]+" "+r[3]}if(!r||r&&(r[1].indexOf(",")>-1?r[1].replace(",","."):r[1])<=180&&(r[3].indexOf(",")>-1?r[3].replace(",","."):r[3])<=90){r=new RegExp("^([0-9]{"+t.UTMX_LEN+"}(?:[.,]\\d+)?)\\s*\\,?\\s*([0-9]{"+t.UTMY_LEN+"}(?:[.,]\\d+)?)$").exec(e);if(r&&(r[1].indexOf(",")>-1||r[2].indexOf(",")>-1)){r[1]=r[1].replace(",",".");r[2]=r[2].replace(",",".");e=r[1]+" "+r[2]}e=e.replace(t.UTMX_LABEL,"").replace(t.UTMY_LABEL,"").replace(t.LON_LABEL,"").replace(t.LAT_LABEL,"");var i=TC.Util.parseCoords(e);if(i){var n=i[0].value,a=i[1].value,l=i[0].type===TC.Consts.UTM?t.UTMX:t.LAT,s=i[1].type===TC.Consts.UTM?t.UTMY:t.LON,p=l+n+s+a,c=t.getPoint(p);if(c&&!t.insideLimit(c)){n=i[1].value;a=i[0].value;l=i[1].type===TC.Consts.UTM?t.UTMX:t.LAT;s=i[0].type===TC.Consts.UTM?t.UTMY:t.LON;p=l+n+s+a;c=t.getPoint(p)}if(c){t.availableSearchTypes[TC.Consts.searchType.COORDINATES].label=/^X(\d+(?:\.\d+)?)Y(\d+(?:\.\d+)?)$/.test(p)?t.getLocaleString("search.list.coordinates.utm")+t.map.crs:t.getLocaleString("search.list.coordinates.geo");o.resolve([{id:p,label:t.getLabel(p),dataRole:TC.Consts.searchType.COORDINATES}])}else o.resolve([])}else o.resolve([])}else o.resolve([])}else o.resolve([]);return o.promise()};e.getCadastralRef=function(e){var t=this,o=new $.Deferred,r=e.match(new RegExp($.trim(t.MUN_LABEL.toLowerCase())+"?\\s(.*)\\,\\s?"+$.trim(t.POL_LABEL.toLowerCase())+"?\\s(\\d{1,2})\\,\\s?"+$.trim(t.PAR_LABEL.toLowerCase())+"?\\s(\\d{1,4})"));r&&(e=r[1]+", "+r[2]+", "+r[3]);var i=e;!/^(.*)\,(\s*\d{1,2}\s*)\,(\s*\d{1,4}\s*)$/.test(e)&&t.availableSearchTypes[TC.Consts.searchType.CADASTRAL].suggestionRoot&&(i=t.availableSearchTypes[TC.Consts.searchType.CADASTRAL].suggestionRoot+", "+e);/^(.*)\,(\s*\d{1,2}\s*)\,(\s*\d{1,4}\s*)$/.test(i)&&!new RegExp("^([0-9]{"+t.UTMX_LEN+"})\\s*\\,\\s*([0-9]{"+t.UTMY_LEN+"})$").test(e)?$.when(t.getMunicipalities()).then(function(e){var r=/^(.*)\,(\s*\d{1,2}\s*)\,(\s*\d{1,4}\s*)$/.exec(i);if(r){var n=new RegExp($.trim(r[1]).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),a=$.grep(e,function(e){e=e.label||e.id||e;return n.test(e)||n.test(t.removePunctuation(e))}),l=function(e,o,r,i){var n=[];n.push[t.MUN]=e;n.push[t.POL]=r;n.push[t.PAR]=i;return{id:t.MUN+e+t.POL+r+t.PAR+i,label:t.getLabel(t.MUN+o+t.POL+r+t.PAR+i),dataRole:TC.Consts.searchType.CADASTRAL,properties:n}};if(a.length>0)for(var s=0;s<a.length;s++)a[s]=l(a[s].id,a[s].label,$.trim(r[2]),$.trim(r[3]));/^[0-9]*$/g.test(r[1])&&a.push(l($.trim(r[1]),$.trim(r[1]),$.trim(r[2]),$.trim(r[3])));o.resolve(a)}}):o.resolve([]);return o.promise()};e.getAddress=function(e){var t=this,o=new $.Deferred,r=[],i=function(e){var o=[];for(var r in t.allowedSearchTypes)switch(!0){case r==TC.Consts.searchType.MUNICIPALITY:case r==TC.Consts.searchType.LOCALITY:case r==TC.Consts.searchType.COUNCIL:case r==TC.Consts.searchType.URBAN:case r==TC.Consts.searchType.STREET:case r==TC.Consts.searchType.NUMBER:t.availableSearchTypes[r]&&t.availableSearchTypes[r].hasOwnProperty("queryProperties")&&Object.keys(t.availableSearchTypes[r].queryProperties).length===Object.keys(e).length&&o.push(r)}o=o.sort(function(e,o){return(t.availableSearchTypes[e].searchWeight||0)>=(t.availableSearchTypes[o].searchWeight||0)?1:0}).filter(function(e){for(var r=0;r<o.length;r++)if((t.availableSearchTypes[o[r]].searchWeight||0)>(t.availableSearchTypes[e].searchWeight||0))return!1;return!0});return o},n=function(e,o){var r;r=t.availableSearchTypes[o].outputFormat===TC.Consts.format.JSON?new TC.wrap.parser.JSON:new TC.wrap.parser.WFS({featureNS:t.availableSearchTypes[o].featurePrefix,featureType:t.availableSearchTypes[o].featureType});return r.read(e)},a=function(e){var o="";e=t.removePunctuation(e);var r,i=/(.*)\s<>\s.*/;if(e.indexOf("(")>-1||e.indexOf(")")>-1){i=/(.*)(\s<>\s.*\(.*\))/;if(e.indexOf("<>")>-1&&i.test(e)){r=e.match(i);if(null!==r){o=e.replace(r[2],"");o=o.splitRemoveWhiteSpaces(",").join(",")}}else{i=/\(.*\)/;if(!i.test(e)){i=/\(.*/;if(!i.test(e)){i=/.*\)/;i.test(e)||(i=/\(.*\)/)}}o=e.replace(i,"");o=o.splitRemoveWhiteSpaces(",").join(",")}e=o}e=t.NORMAL_PATTERNS.ROMAN_NUMBER.test(e)?e.replace(t.NORMAL_PATTERNS.ABSOLUTE_NOT_DOT,""):e.replace(t.NORMAL_PATTERNS.ABSOLUTE,"");return e.toLowerCase()},l=function(e){for(var o=function(e){return/^(\d{1,3})\s?\-?\s?([a-z]{0,4})\s?\-?\s?([a-z]{0,4})$/i.test(e)},r=function(e){var o=[],r=/^(\d{1,3})\s?\-?\s?([a-z]{0,4})\s?\-?\s?([a-z]{0,4})$/i.exec(e);if(r){for(var i=1;i<r.length;i++)r[i].trim().length>0&&o.push(r[i].trim());return o.join(t._LIKE_PATTERN)}return e},i=function(e){return/^([a-z]{1,4})\s?\-?\s?(\d{1,3})$/i.test(e)},n=function(e){var o=[],r=/^([a-z]{1,4})\s?\-?\s?(\d{1,3})$/i.exec(e);if(r){for(var i=1;i<r.length;i++)r[i].trim().length>0&&o.push(r[i].trim());return o.join(t._LIKE_PATTERN)}return e},a=function(e){return/^(sn|S\/N|s\/n|s\-n)$/i.test(e)},l=function(e){var t=/^(sn|S\/N|s\/n|s\-n)$/i.exec(e);return t?"s*n":e},s=function(e){return/^([a-z]{1,4}\s?\+\s?[a-z]{1,4})$/i.test(e)},p=function(e){var t=/^([a-z]{1,4}\s?\+\s?[a-z]{1,4})$/i.exec(e);return t?e:e},c=[o,i,a,s],u=[r,n,l,p],g=0;g<u.length&&!c[g].call(t,e);)g++;return g<u.length?u[g].call(t,e):e},s=function(e,o,r){var i=new $.Deferred;e=e.trim();","==e.charAt(e.length-1)&&(e=e.substring(0,e.length-1));var n=[],a=function(e){if(o)for(var t=e.length;t--;)if(r){if(e[t].t){var i=this.rootCfg.active.rootLabel.filter(function(o){return o.label.indexOf(this.removePunctuation(e[t].t).toLowerCase())>-1}.bind(this));1==i.length?e[t].t=i[0].id:i.length>1?i.map(function(o){var r=$.extend({},e[t]);r.t=o.id;e.push(r)}):0==i.length&&e.splice(t,1)}}else e.push($.extend({},e[t],{t:o}))}.bind(t),s=function(e,t){var o=/^([^0-9\,]+)(?:\s*\,\s*)(?:([^\,][a-z\u00f1\u00e1\u00e9\u00ed\u00f3\u00fa\u00fc\s*\-\.\(\)\/0-9]+))(?:\s*\,\s*)(?:(\d{1,3}\s?\-?\s?[a-z]{0,4}\s?\-?\s?[a-z]{0,4})|([a-z]{1,4}\s?\-?\s?\d{1,3})|(sn|S\/N|s\/n|s\-n)|([a-z]{1,4}\s?\+\s?[a-z]{1,4}))$/i.exec(e);if(o&&o[1]&&o[2]){var r=function(){return l((o[3]||o[4]||o[5]||o[6]).trim())};if(/^([^0-9]+)$/i.test(o[1].trim())&&/^([^0-9]+)$/i.test(o[2].trim())){t.push({t:o[1].trim(),s:o[2].trim(),p:r()});t.push({t:o[2].trim(),s:o[1].trim(),p:r()})}else t.push(/^([^0-9]+)$/i.test(o[1].trim())?{t:o[1].trim(),s:o[2].trim(),p:r()}:{s:o[1].trim(),t:o[2].trim(),p:r()});a(t);return!0}return!1},p=function(e,t){var o=/^(?:([^\,][a-z\u00f1\u00e1\u00e9\u00ed\u00f3\u00fa\u00fc\s*\-\.\(\)\/0-9]+))(?:\s*\,\s*)(?:(\d{1,3}\s?\-?\s?[a-z]{0,4}\s?\-?\s?[a-z]{0,4})|([a-z]{1,4}\s?\-?\s?\d{1,3})|(sn|S\/N|s\/n|s\-n)|([a-z]{1,4}\s?\+\s?[a-z]{1,4}))(?:\s*\,\s*)([^0-9\,]+)$/i.exec(e);if(o&&o[6]&&o[1]){var r=function(){return l((o[2]||o[3]||o[4]||o[5]).trim())};if(/^([^0-9]+)$/i.test(o[6].trim())&&/^([^0-9]+)$/i.test(o[1].trim())){t.push({t:o[6].trim(),s:o[1].trim(),p:r()});t.push({t:o[1].trim(),s:o[6].trim(),p:r()})}else t.push(/^([^0-9]+)$/i.test(o[6].trim())?{t:o[6].trim(),s:o[1].trim(),p:r()}:{s:o[6].trim(),t:o[1].trim(),p:r()});a(t);return!0}return!1},c=function(e,t){var o=/^(?:([^\,][a-z\u00f1\u00e1\u00e9\u00ed\u00f3\u00fa\u00fc\s*\-\.\(\)\/0-9]+))(?:\s*\,\s*)([^0-9\,]+)(?:\s*\,\s*)(?:(\d{1,3}\s?\-?\s?[a-z]{0,4}\s?\-?\s?[a-z]{0,4})|([a-z]{1,4}\s?\-?\s?\d{1,3})|(sn|S\/N|s\/n|s\-n)|([a-z]{1,4}\s?\+\s?[a-z]{1,4}))$/i.exec(e);if(o&&o[1]&&o[2]){t.push({t:o[2].trim(),s:o[1].trim(),p:l((o[3]||o[4]||o[5]||o[6]).trim())});a(t);return!0}return!1},u=function(e,o){var r=/^([^0-9\,]+)(?:\s*\,\s*)(?:([^\,][a-z\u00f1\u00e1\u00e9\u00ed\u00f3\u00fa\u00fc\s*\-\.\(\)\/0-9]+))$/i.exec(e);if(r&&r[1]&&r[2]){if(/^([^0-9]+)$/i.test(r[1].trim())&&/^([^0-9]+)$/i.test(r[2].trim())){o.push({t:r[1].trim(),s:r[2].trim()});o.push({s:r[1].trim(),t:r[2].trim()})}else{var i=function(e){for(var o=e.split(" ").reverse(),r=[],i=0;i<o.length;i++)if(1==o[i].length){r.push(o[i]);o[i]=""}return r.length>0?o.reverse().join(" ").trim()+t._LIKE_PATTERN+r.reverse().join(t._LIKE_PATTERN):o.reverse().join(" ").trim()};o.push(/^([^0-9]+)$/i.test(r[1].trim())?{t:r[1].trim(),s:i(r[2].trim())}:{s:i(r[1].trim()),t:r[2].trim()})}a(o);return!0}return!1},g=function(e,o){var r=/^(?:([^\,][a-z\u00f1\u00e1\u00e9\u00ed\u00f3\u00fa\u00fc\s*\-\.\(\)\/0-9]+))(?:\s*\,\s*)([^0-9\,]+)$/i.exec(e);if(r){for(var i={},n=e.split(",").reverse(),s=0;s<n.length;s++)if(/^([^0-9\,]+)$/i.test(n[s].trim()))i.t=n[s].trim();else if(/(\s*\d+)/i.test(n[s].trim()))if(-1==n[s].trim().indexOf(" "))i.s=n[s].trim();else{for(var p=n[s].trim().split(" ").reverse(),c=function(e){var t=/^(?:(\d{1,3}\s?\-?\s?[a-z]{0,4}\s?\-?\s?[a-z]{0,4})|([a-z]{1,4}\s?\-?\s?\d{1,3})|(sn|S\/N|s\/n|s\-n)|([a-z]{1,4}\s?\+\s?[a-z]{1,4}))$/i.exec(e.trim());if(t){i.p=l(e.trim());return!0}return!1},u=0,g=p[u].trim();u<p.length&&!c(g);){u++;u<p.length&&(g+=p[u])}if(i.p){for(var d=p,h=0;h<d.length;h++){for(var f=!1,y=0;y<d[h].split("").length;y++)i.p.indexOf(d[h][y])>-1&&(f=!0);if(f){{d[h]}d[h]="";if(i.p==l(g))break}}if(/^([^\,][a-z\u00f1\u00e1\u00e9\u00ed\u00f3\u00fa\u00fc\s*\-\.\(\)\/0-9]+)$/i.test(p.reverse().join(" ").trim())){for(var m=[],v=p.reverse(),C=0;C<v.length;C++)if(1==v[C].trim().length){m.push(v[C].trim());v[C]=""}i.s=m.length>0?v.reverse().join(" ").trim()+t._LIKE_PATTERN+m.reverse().join(t._LIKE_PATTERN):v.reverse().join(" ").trim()}o.push({t:i.t,s:i.s+" "+i.p})}else i.s=n[s].trim()}o.push(i);a(o);return!0}return!1},d=function(e,t){var r=/^([^\,][a-z\u00f1\u00e1\u00e9\u00ed\u00f3\u00fa\u00fc\s*\-\.\(\)\/0-9\<\>]+)$/i.exec(e);if(r&&r[1]){t.push(o?{t:o,s:r[1].trim()}:{t:r[1].trim()});return!0}return!1},h=function(e,t){var r=/^([^\,][a-z\u00f1\u00e1\u00e9\u00ed\u00f3\u00fa\u00fc\s*\-\.\(\)\/]+)\s*\,?\s*((\d{1,3}\s?\-?\s?[a-z]{0,4}\s?\-?\s?[a-z]{0,4})|([a-z]{1,4}\s?\-?\s?\d{1,3})|(sn|S\/N|s\/n|s\-n)|([a-z]{1,4}\s?\+\s?[a-z]{1,4}))$/i.exec(e);if(r&&r[1]&&r[2]){t.push(o?{t:o,s:r[1].trim(),p:l(r[2].trim())}:{t:r[1].trim(),s:r[2].trim()});return!0}return!1},f=function(e,t){var r=/^([^\,][0-9\s*\-\.\(\)\/]+)\s*\,?\s*(\d{1,3}\s?\-?\s?[a-z]{0,4}\s?\-?\s?[a-z]{0,4})|([a-z]{1,4}\s?\-?\s?\d{1,3})|(sn|S\/N|s\/n|s\-n)|([a-z]{1,4}\s?\+\s?[a-z]{1,4})$/i.exec(e);if(r&&r[1]&&r[2]&&o){t.push({t:o,s:r[1].trim(),p:l(r[2].trim())});return!0}return!1},y=function(){for(var o=[function(e){return e.length>=3},function(e){return/^\d+$/.test(e)?!1:/^\d+\,\s*\d+$/.test(e)?!1:!0}],r=0;r<o.length;r++)if(!o[r].call(t,e))return!1;return!0};if(y(e)){var m=[s,p,c,u,g];m=o&&e.split(",").length<3?[h,f,d].concat(m):m.concat([h,f,d]);var v=0;try{for(;v<m.length&&!m[v].call(t,e,n);)v++}catch(C){TC.error("Error seg\xfan el patr\xf3n: "+e,TC.Consts.msgErrorMode.EMAIL,"Error en la b\xfasqueda del callejero")}}n.length>0&&o?$.when(t.rootCfg.active.getRootLabel()).then(function(e){if(e)for(var r=n.length;r--;){var a=n[r];if(n.length>1&&a.t==o&&e.filter(function(e){return e.indexOf(t.removePunctuation(a.s).toLowerCase())>-1}).length>0){n.splice(r,1);break}}i.resolve(n)}):i.resolve(n);return i.promise()},p=function(e,o,i,n){for(var a=0;a<e.length;a++){var l=[],s=[],p="",c=i,u=n,g=t.filter.getPropertyValue(o,"outputFormatLabel"),d=e[a].id.split(".").slice(0,1).shift();if(!(i instanceof Array)){c=i[d];u=n[d];g=g[d]}for(var h=0;h<c.length;h++)l.push(e[a].data[c[h]]);for(var h=0;h<u.length;h++)s.push(e[a].data[u[h]]);var f=function(e){for(var t=[],o=0;o<e.length;o++)-1==jQuery.inArray(e[o],t)&&t.push(e[o]);return t};l instanceof Array&&g&&f(l).length>1?p=g.tcFormat(l):l instanceof Array&&1==f(l).length&&(p=l[0]);var y=p.toCamelCase(),m=function(e,t){for(var o=0;o<r.length;o++)if(r[o].dataRole==e&&r[o].text.toLowerCase().trim()==t.toLowerCase().trim())return!0;return!1};if(!m(o,y)){for(var v=[],C=0;C<i.length;C++)v[i[C]]=l[C];r.push({text:y,label:y,id:s.join("#"),dataRole:o,dataLayer:d,properties:v})}}}.bind(t);e=a(e);$.when(s(e,t.rootCfg.active&&t.rootCfg.active.root||"",t.rootCfg.active&&t.rootCfg.active.limit||!1)).then(function(e){function a(e,i){var a=t.filter.getPropertyValue(i,"outputProperties"),l=t.filter.getPropertyValue(i,"dataIdProperty");return $.ajax({url:t.availableSearchTypes[i].url,type:"POST",contentType:"application/x-www-form-urlencoded;charset=UTF-8",dataType:"text",data:t.filter.getParams(e,i,a,l),beforeSend:function(){t.$list.html('<li><a class="tc-ctl-search-li-loading" href="#">'+t.getLocaleString("searching")+'<span class="tc-ctl-search-loading-spinner tc-ctl-search-loading"></span></a></li>');t.$text.trigger("targetUpdated.autocomplete")}}).done(function(e){var t=n(e,i);p(t,i,a,l)}).fail(function(e){"abort"!==e.statusText&&alert("error");o.resolve(r)})}if(e){t._search.data=r;if(t.request){for(var l=0;l<t.request.length;l++)t.request[l].abort();t.request=[]}else t.request=[];$.map(e,function(e,o){for(var r=i(e),o=0;o<r.length;o++){var n=r[o];n&&t.allowedSearchTypes[n]&&t.request.push(a(e,n))}});$.when.apply($,t.request).then(function(){t.request=null;o.resolve(r)})}else o.resolve(r)});return o.promise()};e.getRoad=function(e){var t=this,o=new $.Deferred;e=e.trim();if(e.length<2)o.resolve([]);else{var r=TC.Consts.searchType.ROAD,i=t.availableSearchTypes[r].pattern,n=i.exec(e);if(n&&n[3]){var a=t.filter.getPropertyValue(r,"outputProperties"),l=t.filter.getPropertyValue(r,"dataIdProperty"),s=t.filter.getPropertyValue(r,"outputFormatLabel"),p=n[2]?n[2].trim()+"-"+n[3].trim():n[3].trim();n[4]&&n[4].length>0&&(p=p+"-"+n[4].trim());$.ajax({url:t.availableSearchTypes[r].url+"?"+t.filter.getParams({t:p},r,a,l),type:"GET",contentType:"application/x-www-form-urlencoded;charset=UTF-8",beforeSend:function(){if(t.request){for(var e=0;e<t.request.length;e++)t.request[e].abort();t.request=[]}else t.request=[];t.$list.html('<li><a class="tc-ctl-search-li-loading" href="#">'+t.getLocaleString("searching")+'<span class="tc-ctl-search-loading-spinner tc-ctl-search-loading"></span></a></li>');t.$text.trigger("targetUpdated.autocomplete")}}).done(function(e){var t=[];if(e.totalFeatures>0){e.features.map(function(e){if(!t.some(function(t){return t.text==e.properties[a[0]]})){var o=s.tcFormat(a.map(function(t){return e.properties[t]})),i=a.map(function(t){return e.properties[t]}).join("-");t.push({id:l.map(function(t){return e.properties[t]}).join("#"),label:o,text:i,dataLayer:e.id.split(".")[0],dataRole:r})}});o.resolve(t)}else o.resolve([])}).fail(function(e){o.resolve([])})}else o.resolve([])}return o.promise()};e.getPK=function(e){var t=this,o=new $.Deferred;e=e.trim();if(e.length<3)o.resolve([]);else{var r=TC.Consts.searchType.ROADPK,i=t.availableSearchTypes[r].pattern,n=i.exec(e);if(n&&n[3]&&n[5]){var a=t.filter.getPropertyValue(r,"outputProperties"),l=t.filter.getPropertyValue(r,"dataIdProperty"),s=t.filter.getPropertyValue(r,"outputFormatLabel"),p=n[2]?n[2].trim()+"-"+n[3].trim():n[3].trim();n[4]&&n[4].length>0&&(p=p+"-"+n[4].trim());$.ajax({url:t.availableSearchTypes[r].url+"?"+t.filter.getParams({t:p,s:n[5].trim()},r,a,l),type:"GET",contentType:"application/x-www-form-urlencoded;charset=UTF-8",beforeSend:function(){if(t.request){for(var e=0;e<t.request.length;e++)t.request[e].abort();t.request=[]}else t.request=[];t.$list.html('<li><a class="tc-ctl-search-li-loading" href="#">'+t.getLocaleString("searching")+'<span class="tc-ctl-search-loading-spinner tc-ctl-search-loading"></span></a></li>');t.$text.trigger("targetUpdated.autocomplete")}}).done(function(e){var t=[];if(e.totalFeatures>0){e.features.map(function(e){if(!t.some(function(t){return t.label==e.properties[a[0]]})){var o=s.tcFormat(a.map(function(t){return e.properties[t]}));t.push({id:l.map(function(t){return e.properties[t]}).join("#"),label:o,text:o,dataLayer:e.id.split(".")[0],dataRole:r})}});o.resolve(t)}else o.resolve([])}).fail(function(e){o.resolve([])})}else o.resolve([])}return o.promise()};e.search=function(e,t){var o=this,r=[];e=$.trim(e);if(e.length>0){e=e.toLowerCase();var i=[],n=function(t){var n=new $.Deferred;i.push(n);$.when(t.call(o,e)).then(function(e){r=r.concat(e);n.resolve(r)})},a=!1;for(var l in o.allowedSearchTypes)switch(l){case TC.Consts.searchType.CADASTRAL:n(o.availableSearchTypes[TC.Consts.searchType.CADASTRAL].parser);break;case TC.Consts.searchType.COORDINATES:n(o.availableSearchTypes[TC.Consts.searchType.COORDINATES].parser);break;case TC.Consts.searchType.ROAD:n(o.availableSearchTypes[TC.Consts.searchType.ROAD].parser);break;case TC.Consts.searchType.ROADPK:n(o.availableSearchTypes[TC.Consts.searchType.ROADPK].parser);break;case TC.Consts.searchType.MUNICIPALITY:case TC.Consts.searchType.LOCALITY:case TC.Consts.searchType.COUNCIL:case TC.Consts.searchType.URBAN:case TC.Consts.searchType.STREET:case TC.Consts.searchType.NUMBER:if(!a){n(o.availableSearchTypes[l].parser);a=!0}break;default:o.allowedSearchTypes[l].parser?n(o.allowedSearchTypes[l].parser):console.log("Falta implementaci\xf3n del m\xe9todo parser")}$.when.apply(o,i).then(function(){r&&(o._search.data=r=r.sort(function(e,t){var o,r=/(\d+)/,i="";if(r.test(e.label)&&r.test(t.label)){o=e.label.match(r)[1];i=t.label.match(r)[1]}else{o=e.label;i=t.label}return o>i?1:i>o?-1:0}.bind(o)));t&&t(r);if(0===r.length){o.cleanMap();if(!o.layer||o.layer&&0===o.layer.features.length){o.$list.html('<li><a title="'+o.EMPTY_RESULTS_TITLE+'" class="tc-ctl-search-li-empty">'+o.EMPTY_RESULTS_LABEL+"</a></li>");o.$text.trigger("targetUpdated.autocomplete")}}})}else o.cleanMap()};var t=function(e){var t=this;if(e&&e.length>0)for(var o=0;o<e.length;o++)e[o].showsPopup!=t.queryableFeatures&&(e[o].showsPopup=t.queryableFeatures)};e.goToResult=function(e,o){var r=this,i=null;r.loading||(r.loading=r.map.getControlsByClass("TC.control.LoadingIndicator")[0]);var n;n=r.loading.addWait();if(Modernizr.mq("(max-width: 30em)")){r.$text.blur();r.map.$events.trigger($.Event(TC.Consts.event.TOOLSCLOSE),{})}r.cleanMap();var a=!1,l=!0;for(var s in r.allowedSearchTypes)if(l)switch(s){case TC.Consts.searchType.CADASTRAL:i=r.availableSearchTypes[TC.Consts.searchType.CADASTRAL].goTo.call(r,e);null!==i&&(l=!1);break;case TC.Consts.searchType.COORDINATES:i=r.availableSearchTypes[TC.Consts.searchType.COORDINATES].goTo.call(r,e);null!==i&&(l=!1);break;case TC.Consts.searchType.ROAD:o===TC.Consts.searchType.ROAD&&(i=r.availableSearchTypes[TC.Consts.searchType.ROAD].goTo.call(r,e));null!==i&&(l=!1);break;case TC.Consts.searchType.ROADPK:i=r.availableSearchTypes[TC.Consts.searchType.ROADPK].goTo.call(r,e);null!==i&&(l=!1);break;case TC.Consts.searchType.MUNICIPALITY:case TC.Consts.searchType.LOCALITY:case TC.Consts.searchType.COUNCIL:case TC.Consts.searchType.URBAN:case TC.Consts.searchType.STREET:case TC.Consts.searchType.NUMBER:var p=o||r.filter.getGoToElement(e).dataRole;if(p&&p===s){i=r.availableSearchTypes[p].goTo.call(r,e,p);null!==i&&(l=!1)}break;default:if(r.allowedSearchTypes[s].goTo){a=!0;i=r.allowedSearchTypes[s].goTo.call(r,e);null!==i&&(l=!1)}else console.log("Falta implementaci\xf3n del m\xe9todo goTo")}r.loading.removeWait(n);if(i){n=r.loading.addWait();r.getLayer().then(function(o){switch(!0){case i.params.type==TC.Consts.layerType.VECTOR:for(var a=0;a<r.WFS_TYPE_ATTRS.length;a++)o.hasOwnProperty(r.WFS_TYPE_ATTRS[a])&&delete o[r.WFS_TYPE_ATTRS[a]];break;case i.params.type==TC.Consts.layerType.WFS:for(var a=0;a<r.WFS_TYPE_ATTRS.length;a++)o[r.WFS_TYPE_ATTRS[a]]=i.params[r.WFS_TYPE_ATTRS[a]]}o.type=i.params.type;o.refresh().then(function(){r.map.one(TC.Consts.event.LAYERUPDATE,function(e){if(e.layer==o){r.map.one(TC.Consts.event.FEATURESADD,function(e){if(e.layer==o){if(!e.layer.features||0==e.layer.features.length&&e.layer.wrap.layer.getSource().getFeatures()){r.$list.hide("fast");e.layer.map.setExtent(e.layer.wrap.layer.getSource().getExtent())}else if(e.layer.features&&e.layer.features.length>0){r.$list.hide("fast");t.call(r,e.layer.features);r.layer.map.zoomToFeatures(e.layer.features);r.map.$events.trigger($.Event(TC.Consts.event.FEATURESADD,{layer:r.layer,features:r.layer.features}))}else if(e.layer.features&&0==e.layer.features.length&&i.params.type==TC.Consts.layerType.WFS){r.$list.html(i.emptyResultHTML);r.$text.trigger("targetUpdated.autocomplete");r.map.$events.trigger($.Event(TC.Consts.event.SEARCHQUERYEMPTY))}r.loading.removeWait(n)}});i.params.type!=TC.Consts.layerType.WFS&&r.map.one(TC.Consts.event.FEATURESADD,function(e){if(e.layer.features&&0==e.layer.features.length){r.$list.html(i.emptyResultHTML);r.$text.trigger("targetUpdated.autocomplete");r.map.$events.trigger($.Event(TC.Consts.event.SEARCHQUERYEMPTY))}});if(e.layer.features&&e.layer.features.length>0){r.$list.hide("fast");t.call(r,e.layer.features);r.layer.map.zoomToFeatures(r.layer.features);r.map.$events.trigger($.Event(TC.Consts.event.FEATURESADD,{layer:r.layer,features:r.layer.features}));r.loading.removeWait(n)}else if(e.layer.features&&0==e.layer.features.length&&i.params.type==TC.Consts.layerType.WFS){r.$list.html(i.emptyResultHTML);r.$text.trigger("targetUpdated.autocomplete");r.map.$events.trigger($.Event(TC.Consts.event.SEARCHQUERYEMPTY));r.loading.removeWait(n)}}});0==o.features.length&&r.map.$events.trigger($.Event(TC.Consts.event.LAYERUPDATE,{layer:o,id:e}))})})}else a||r.map.$events.trigger($.Event(TC.Consts.event.SEARCHQUERYEMPTY))};var o=function(e){var t=this;if(e&&e.layer==t.layer){var o,r,i,n=e.id,a=t.getPoint(n);if(a&&t.insideLimit(a)){r=t.getLabel(n);i=t.layer.addMarker(a,$.extend({},t.map.options.styles.point,{title:r,group:r}));o=t.map.options.pointBoundsRadius;t.map.setExtent([a[0]-o,a[1]-o,a[0]+o,a[1]+o])}else{var l=/^Lat((?:[+-]?)\d+(?:\.\d+)?)Lon((?:[+-]?)\d+(?:\.\d+)?)$/.exec(n);n=t.LAT+l[2]+t.LON+l[1];a=t.getPoint(n);if(a&&t.insideLimit(a)){r=t.getLabel(n);i=t.layer.addMarker(a,$.extend({},t.map.options.styles.point,{title:r,group:r}));o=t.map.options.pointBoundsRadius;t.map.setExtent([a[0]-o,a[1]-o,a[0]+o,a[1]+o]);t.$text.val(r)}}$.when(i).then(function(e){t.map.$events.trigger($.Event(TC.Consts.event.FEATURESADD,{layer:t.layer,features:[e]}))})}};e.goToCoordinates=function(e){var t=this,r={};if(/^X(\d+(?:[\.\,]\d+)?)Y(\d+(?:[\.\,]\d+)?)$/.test(e)||/^Lat((?:[+-]?)\d+(?:[.,]\d+)?)Lon((?:[+-]?)\d+(?:[.,]\d+)?)$/.test(e)){r.params={type:TC.Consts.layerType.VECTOR,styles:{marker:{url:t.layerStyleFN.bind(t,"marker","url",!0)}}};r.emptyResultHTML='<li><a class="tc-ctl-search-li-empty">'+t.OUTBBX_LABEL+"</a></li>";var i=o.bind(t);t.map.one(TC.Consts.event.LAYERUPDATE,i);return r}return null};e.goToCadastralRef=function(e){var t=this,o={};if(/^\M(\d+)\P(\d{1,2})Par{1}(\d{1,4})/g.test(e)){var r=/^\M(\d+)\P(\d{1,2})Par{1}(\d{1,4})/g.exec(e);TC.filter||TC.syncLoadJS(TC.apiLocation+"TC/Filter");o.params={type:TC.Consts.layerType.WFS,url:t.availableSearchTypes[TC.Consts.searchType.CADASTRAL].url,version:t.availableSearchTypes[TC.Consts.searchType.CADASTRAL].version,geometryName:t.availableSearchTypes[TC.Consts.searchType.CADASTRAL].geometryName,featurePrefix:t.availableSearchTypes[TC.Consts.searchType.CADASTRAL].featurePrefix,featureType:t.availableSearchTypes[TC.Consts.searchType.CADASTRAL].featureType,properties:new TC.filter.and(new TC.filter.equalTo(t.availableSearchTypes[TC.Consts.searchType.CADASTRAL].queryProperties.municipality,$.trim(r[1])),new TC.filter.equalTo(t.availableSearchTypes[TC.Consts.searchType.CADASTRAL].queryProperties.polygon,$.trim(r[2])),new TC.filter.equalTo(t.availableSearchTypes[TC.Consts.searchType.CADASTRAL].queryProperties.parcel,$.trim(r[3]))),outputFormat:t.availableSearchTypes[TC.Consts.searchType.CADASTRAL].outputFormat,styles:t.availableSearchTypes[TC.Consts.searchType.CADASTRAL].styles};o.emptyResultHTML='<li><a title="'+t.EMPTY_RESULTS_TITLE+'" class="tc-ctl-search-li-empty">'+t.EMPTY_RESULTS_LABEL+"</a></li>";return o}return null};e.goToRoad=function(e){var t=this,o={},r=TC.Consts.searchType.ROAD;o.params={type:TC.Consts.layerType.WFS,url:t.availableSearchTypes[r].url,version:t.availableSearchTypes[r].version,geometryName:t.availableSearchTypes[r].geometryName,featurePrefix:t.availableSearchTypes[r].featurePrefix,featureType:t.filter.getGoToFilterLayer(e),maxFeatures:3e3,properties:t.filter.getGoToFilter(e,r),outputFormat:t.availableSearchTypes[r].outputFormat,styles:t.availableSearchTypes[r].styles};o.emptyResultHTML='<li><a title="'+t.EMPTY_RESULTS_TITLE+'" class="tc-ctl-search-li-empty">'+t.EMPTY_RESULTS_LABEL+"</a></li>";return o};e.goToPK=function(e){var t=this,o={},r=TC.Consts.searchType.ROADPK;o.params={type:TC.Consts.layerType.WFS,url:t.availableSearchTypes[r].url,version:t.availableSearchTypes[r].version,geometryName:t.availableSearchTypes[r].geometryName,featurePrefix:t.availableSearchTypes[r].featurePrefix,featureType:t.filter.getGoToFilterLayer(e),maxFeatures:3e3,properties:t.filter.getGoToFilter(e,r),outputFormat:t.availableSearchTypes[r].outputFormat,styles:t.availableSearchTypes[r].styles};o.emptyResultHTML='<li><a title="'+t.EMPTY_RESULTS_TITLE+'" class="tc-ctl-search-li-empty">'+t.EMPTY_RESULTS_LABEL+"</a></li>";return o};e.goToAddress=function(e,t){var o=this,r={},i=o.availableSearchTypes[t];r.params={type:TC.Consts.layerType.WFS,url:i.url,version:i.version,geometryName:i.geometryName,featurePrefix:i.featurePrefix,featureType:o.filter.getGoToFilterLayer(e),maxFeatures:3e3,properties:o.filter.getGoToFilter(e,t),outputFormat:i.outputFormat,styles:i.styles};return r};e.getPoint=function(e){var t,o=this,r=o.map.wrap.isGeo(),i=/^X(\d+(?:\.\d+)?)Y(\d+(?:\.\d+)?)$/.exec(e);if(i&&3===i.length){t=[parseFloat(i[1]),parseFloat(i[2])];r&&(t=TC.Util.reproject(t,o.map.options.utmCrs,o.map.crs))}else{i=/^Lat((?:[+-]?)\d+(?:[.,]\d+)?)Lon((?:[+-]?)\d+(?:[.,]\d+)?)$/.exec(e);if(i&&3===i.length){t=[parseFloat(i[2]),parseFloat(i[1])];if(!r)return TC.Util.reproject(t,o.map.options.geoCrs,o.map.crs)}i=/^Lon((?:[+-]?)\d+(?:[.,]\d+)?)Lat((?:[+-]?)\d+(?:[.,]\d+)?)$/.exec(e);if(i&&3===i.length){t=[parseFloat(i[2]),parseFloat(i[1])];if(!r)return TC.Util.reproject(t,o.map.options.geoCrs,o.map.crs)}}return t};e.insideLimit=function(e){var t=this,o=function(e,t){return e instanceof Array?t[0]>=e[0]&&t[0]<=e[2]&&t[1]>=e[1]&&t[1]<=e[3]:!0};return o(t.map.options.maxExtent,e)?!0:!1};e.getPattern=function(){var e=this;return e.$text.val()};e.getLabel=function(e){var t=this,o=e,r=TC.Util.getMapLocale(t.map);if(e.match(new RegExp("^(?:"+t.LAT+"[-\\d])|(?:"+t.UTMX+"[\\d])"))){o=o.replace(t.LAT,t.LAT_LABEL).replace(t.LON," "+t.LON_LABEL).replace(t.UTMX,t.UTMX_LABEL).replace(t.UTMY," "+t.UTMY_LABEL);var i=o.match(new RegExp("^"+$.trim(t.LAT_LABEL)+"*\\s*([-+]?\\d{1,3}([.,]\\d+)?)\\,?\\s*"+$.trim(t.LON_LABEL)+"*\\s*([-+]?\\d{1,2}([.,]\\d+)?)$"));if(i){o=o.replace(i[1],parseFloat(i[1]).toLocaleString(r));o=o.replace(i[3],parseFloat(i[3]).toLocaleString(r))}var n=1.1.toLocaleString(r).substring(1,2),i=o.match(new RegExp("^"+$.trim(t.UTMX_LABEL)+"*\\s*([0-9]{"+t.UTMX_LEN+"}(?:[.,]\\d+)?)\\s*\\,?\\s*"+$.trim(t.UTMY_LABEL)+"*\\s*([0-9]{"+t.UTMY_LEN+"}(?:[.,]\\d+)?)$"));if(i){Number.isInteger(parseFloat(i[1]))||(o=o.replace(i[1],i[1].replace(".",n)));Number.isInteger(parseFloat(i[2]))||(o=o.replace(i[2],i[2].replace(".",n)))}}else if(e.match(new RegExp("^(?:"+t.LON+"[-\\d])"))){o=o.replace(t.LON,t.LON_LABEL).replace(t.LAT," "+t.LAT_LABEL);var i=o.match(new RegExp("^"+$.trim(t.LON_LABEL)+"*\\s*([-+]?\\d{1,3}([.,]\\d+)?)\\,?\\s*"+$.trim(t.LAT_LABEL)+"*\\s*([-+]?\\d{1,2}([.,]\\d+)?)$"));if(i){o=o.replace(i[1],parseFloat(i[1]).toLocaleString(r));o=o.replace(i[3],parseFloat(i[3]).toLocaleString(r))}}else if(e.match(new RegExp("^(?:(\\"+t.MUN+"{1})(.*)(\\"+t.POL+"{1})(\\d{1,2})(\\"+t.PAR+"{1})(\\d{1,4}))"))){var i=e.match(new RegExp("^(?:(\\"+t.MUN+"{1})(.*)(\\"+t.POL+"{1})(\\d{1,2})(\\"+t.PAR+"{1})(\\d{1,4}))"));o=t.MUN_LABEL+i[2]+", "+t.POL_LABEL+i[4]+", "+t.PAR_LABEL+i[6]}return o};e.removePunctuation=function(e){e=e||"";for(var t=new Array(e.length),o={"\xe1":"a","\xc1":"A","\xe9":"e","\xc9":"E","\xed":"i","\xcd":"I","\xf3":"o","\xd3":"O","\xfa":"u","\xfc":"u","\xda":"U","\xdc":"U"},r=0,i=e.length;i>r;r++)t[r]=o[e.charAt(r)]||e.charAt(r);return t.join("")};e.decodeEntities=function(e){return $("<div/>").html(e).text()};e.transformFilter=function(e){TC.filter||TC.syncLoadJS(TC.apiLocation+"TC/Filter");if(e&&e instanceof Array){var t=e.map(function(e){if(!e.hasOwnProperty("type"))return new TC.filter.equalTo(e.name,e.value);switch(!0){case e.type==TC.Consts.comparison.EQUAL_TO:return new TC.filter.equalTo(e.name,e.value)}});return t.length>1?TC.filter.and.apply(null,t):t[0]}}}();String.prototype.tcFormat||(String.prototype.tcFormat=function(){var e=(arguments||[""])[0];return this.replace(/{(\d+)}/g,function(t,o){return"undefined"!=typeof e[o]?e[o]:t})});String.prototype.splitRemoveWhiteSpaces||(String.prototype.splitRemoveWhiteSpaces=function(e){for(var t=[],o=this.split(e),r=0;r<o.length;r++)$.trim(o[r]).length>0&&t.push($.trim(o[r]));

return t});String.prototype.toCamelCase||(String.prototype.toCamelCase=function(){var e=this.toLowerCase(),t=this.toLowerCase().match(/\W+(.)/g);if(t)for(var o=0;o<t.length;o++)/[;:.<>\{\}\[\]\/\s()]/g.test(t[o])&&(e=e.replace(t[o],t[o].toUpperCase()));return e.charAt(0).toUpperCase()+e.substring(1)});Array.prototype.hasOwnProperty("findByProperty")||Object.defineProperty(Array.prototype,"findByProperty",{enumerable:!1,writable:!0,value:function(e,t){for(var o=0;o<this.length;o++)if(this[o][e]==t)return this[o]}});String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var o=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>o.length)&&(t=o.length);t-=e.length;var r=o.indexOf(e,t);return-1!==r&&r===t});TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.SelectContainer=function(){var e=this;TC.Control.apply(e,arguments);var t=e._classSelector="."+e.CLASS;e._selectors={TAB:t+"-tab",RADIOBUTTON:"input[type=radio][name=sctnr-sel]",ELEMENT:t+"-elm"};e.controlOptions=e.options.controls||[];var o=e.controlOptions.length;e._ctlDeferreds=new Array(o);for(var r=0;o>r;r++)e._ctlDeferreds[r]=$.Deferred()};TC.inherit(TC.control.SelectContainer,TC.Control);!function(){var e=TC.control.SelectContainer.prototype;e.CLASS="tc-ctl-sctnr";e.template=TC.isDebug?TC.apiLocation+"TC/templates/SelectContainer.html":function(){function t(e,t){return e.w("<h2>").f(t.get(["title"],!1),t,"h").w('</h2><div class="tc-ctl-sctnr-select"><form>').s(t.get(["controls"],!1),t,{block:o},{}).w("</form></div>").s(t.get(["controls"],!1),t,{block:r},{})}function o(e,t){return e.w('<label class="tc-ctl-sctnr-tab tc-ctl-sctnr-tab-').f(t.get(["$idx"],!1),t,"h").w('" style="width:calc(100%/').f(t.get(["$len"],!1),t,"h").w(' - 1px)"><input type="radio" name="sctnr-sel" value="').f(t.get(["$idx"],!1),t,"h").w('" /><span>').f(t.get(["title"],!1),t,"h").w("</span></label>")}function r(e,t){return e.w('<div class="tc-ctl-sctnr-elm tc-ctl-sctnr-elm-').f(t.get(["$idx"],!1),t,"h").w(' tc-hidden"></div>')}dust.register(e.CLASS,t);t.__dustBody=!0;o.__dustBody=!0;r.__dustBody=!0;return t};e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);t.renderPromise().then(function(){t.title=t.getLocaleString(t.options.title||"moreControls");t._$div.find("h2").first().html(t.title);for(var o=new Array(t.controlOptions.length),r=0,i=t.controlOptions.length;i>r;r++){var n=t.controlOptions[r];o[r]=e.addControl(n.name,$.extend({div:t._$div.find("."+t.CLASS+"-elm-"+r)},n.options))}var a=function(e,o){e.renderPromise().then(function(){var r=t.getLocaleString(t.controlOptions[o].title)||e._$div.find("h2").first().html();e._$div.parents(t._classSelector).first().find(t._selectors.TAB+"-"+o+" span").html(r)})};$.when.apply(t,o).then(function(){for(var e=0,o=arguments.length;o>e;e++){var r=arguments[e];a(r,e);t._ctlDeferreds[e].resolve(r)}})})};e.render=function(e){var t=this;t.renderData({title:t.title,controls:t.controlOptions},function(){var e=function(e){var o=$(this).closest(t._selectors.TAB).find(t._selectors.RADIOBUTTON),r=o.val(),i=t._$div.find(t._selectors.ELEMENT);if(t._oldValue===r&&t.options.deselectable){setTimeout(function(){o.prop("checked",!1)},0);t._oldValue=null;$active=$();$hidden=i}else{$active=i.filter(t._selectors.ELEMENT+"-"+r);$hidden=i.not($active);t._oldValue=r}$active.removeClass(TC.Consts.classes.HIDDEN);$hidden.addClass(TC.Consts.classes.HIDDEN);o.prop("checked",!0)};t._$div.find("span").on(TC.Consts.event.CLICK,e);for(var o=0,r=t._ctlDeferreds.length;r>o;o++)t.getControl(o).then(function(e){e.render()});"number"==typeof t.options.defaultSelection&&e.call(t._$div.find(t._selectors.RADIOBUTTON).get(t.options.defaultSelection))})};e.getControl=function(e){var t=this._ctlDeferreds[e];if(!t){t=$.Deferred();t.reject()}return t.promise()}}();TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.control.Share=function(e){var t=this;t._classSelector="."+t.CLASS;TC.Control.apply(t,arguments);var o=e||{};t._$dialogDiv=$(TC.Util.getDiv(o.dialogDiv));o.dialogDiv||t._$dialogDiv.appendTo("body");t.render()};TC.inherit(TC.control.Share,TC.Control);!function(){var e=TC.control.Share.prototype;e.CLASS="tc-ctl-share";e.QR_MAX_LENGTH=150;e.IFRAME_WIDTH="600px";e.IFRAME_HEIGHT="450px";e.MOBILEFAV="Siga las instrucciones del navegador del dispositivo m\xf3vil para a\xf1adir como favorito. Se guardar\xe1 el estado actual del mapa.";e.NAVALERT=" +D para guardar en marcadores.";e.render=function(e){var t=this;t.getRenderedHtml(t.CLASS+"-dialog",null,function(e){t._$dialogDiv.html(e)}).then(function(){TC.Control.prototype.render.call(t,function(){if(TC.Util.detectChrome()||TC.Util.detectIE()>=10||TC.Util.detectFirefox()>=41){t._$div.find("button").removeClass("hide");var o=t._$div.find("input[type=text]");o.removeAttr("data-original-title")}TC.Util.detectMobile()||t._$div.find(".share-whatsapp").addClass(TC.Consts.classes.HIDDEN);var r=t._$div.find("."+t.CLASS+"-url-box");t._$div.find("span").on(TC.Consts.event.CLICK,function(e){var t=$(this).closest("label").find("input[type=radio][name=format]"),o=t.val();r.removeClass(TC.Consts.classes.HIDDEN);r.not(".tc-"+o).addClass(TC.Consts.classes.HIDDEN)});$.isFunction(e)&&e()})})};e.getLocation=function(){var e=window.location.href;window.location.hash&&(e=e.substr(0,e.indexOf(window.location.hash)));return e};e.generateLink=function(){var e=this,t=window.location.href,o=t.indexOf("#");o>0&&(t=t.substring(0,o));if(e.extraParams){var r=TC.Util.getQueryStringParams(t);$.extend(r,e.extraParams);var i=t.indexOf("?");i>=0&&(t=t.substring(0,i));t=t.concat("?",$.param(r))}TC.Util.getParameterByName("lang").length>0&&(t=t.indexOf("&")>-1?t.replace("lang="+TC.Util.getParameterByName("lang")+"&",""):t.replace("?lang="+TC.Util.getParameterByName("lang"),""));var n=e.map.getMapState(),a=t.concat("#",n);if(!(a.length>TC.Consts.URL_MAX_LENGTH)){e.enableButtons(a);return a}e.disableButtons()};e.generateIframe=function(e){var t=this,o=e||this.generateLink();return o?'<iframe style="width:'+t.IFRAME_WIDTH+";height:"+t.IFRAME_HEIGHT+';" src="'+o+'"></iframe>':void 0};e.register=function(t){var o=this;TC.Control.prototype.register.call(o,t);o.MOBILEFAV=o.getLocaleString("mobileBookmarks.instructions");o.NAVALERT=o.getLocaleString("bookmarks.instructions");var r=function(e){var t=$(e).parent().find("input[type=text]");t.val(t.hasClass("tc-url")?o.generateLink():o.generateIframe());t.select()},i=function(){document.getSelection().removeAllRanges();document.getSelection().addRange(document.createRange())};o._$div.on("click","h2",function(e){o._$div.find(".tc-url input[type=text]").val(o.generateLink());o._$div.find(".tc-iframe input[type=text]").val(o.generateIframe())});o._$div.on("click",".tc-ctl-share-url-box button",function(e){r(e.target);document.execCommand("copy");var t=$(this);t.text(o.getLocaleString("copied"));setTimeout(function(){t.text(o.getLocaleString("copy"));i()},1e3)});o._$div.on("click","input[type=text]",function(e){r(e.target)});o._$div.on("click",".ga-share-icon.disabled",function(e){e.stopImmediatePropagation();e.preventDefault();return!1});o._$div.on("click","a.share-email",function(e){e.preventDefault();var t=o.generateLink();t&&(window.location.href="mailto:?body="+encodeURIComponent(t+"\n"))});o._$div.on("click","a.qr-generator",function(e){e.preventDefault();var t=o.generateLink();t&&TC.loadJS("undefined"==typeof QRCode,[TC.apiLocation+"lib/qrcode/qrcode.min.js"],function(){t.length>o.QR_MAX_LENGTH&&(t=TC.Util.shortenUrl(t));TC.Util.showModal(o._$dialogDiv.find(o._classSelector+"-qr-dialog"));var e=o._$dialogDiv.find(".qrcode");e.empty();new QRCode(e[0],t)})});o._$div.on("click","a.share-fb",function(e){e.preventDefault();var t=o.generateLink();if(t){window.open("https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(t));return!1}});o._$div.on("click","a.share-twitter",function(e){e.preventDefault();var t=o.generateLink();if(t){var r=TC.Util.shortenUrl(t);if(void 0!==r){var i=encodeURIComponent(window.document.title?window.document.title:"Visor API SITNA");window.open("https://twitter.com/intent/tweet?text="+i+"&amp;url="+encodeURIComponent(r));return!1}TC.error("La URL "+t+" no ha podido ser acortada por ser no v\xe1lida")}});TC.Util.detectMobile()&&o._$div.on("click","a.share-whatsapp",function(e){e.preventDefault();var t=o.generateLink();if(t){var r=TC.Util.shortenUrl(t),i="whatsapp://send?text=";location.href=void 0!==r?i+encodeURIComponent(r):i+encodeURIComponent(t);return!1}});o._$div.on("click","a.share-star",function(t){t.preventDefault();var r=o.generateLink(),i=document.title;if(TC.Util.detectMobile())alert(e.MOBILEFAV);else if(window.sidebar&&window.sidebar.addPanel)window.sidebar.addPanel(i,r,"");else if(window.sidebar&&/Firefox/i.test(navigator.userAgent)||window.opera&&window.print){window.location.href=r;alert((/Mac/i.test(navigator.userAgent)?"Cmd":"Ctrl")+e.NAVALERT)}else if(window.external&&"AddFavorite"in window.external)window.external.AddFavorite(r,i);else{window.location.href=r;alert((/Mac/i.test(navigator.userAgent)?"Cmd":"Ctrl")+e.NAVALERT)}return!1})};e.enableButtons=function(e){var t=this;TC.Control.prototype.enable.call(t);var o=t._$div.find("."+t.CLASS+"-alert"),r=t._$div.find(".tc-button"),i=t._$div.find(".ga-share-icon"),n=t._$div.find(".tc-textbox");o.toggleClass(TC.Consts.classes.HIDDEN,!0);r.toggleClass("disabled",!1);r.removeAttr("disabled");$.each(i,function(e,t){$(t).toggleClass("disabled",!1)});n.filter(".tc-url").val(e);n.filter(".tc-iframe").val(t.generateIframe(e))};e.disableButtons=function(){var e=this;TC.Control.prototype.disable.call(e);var t=e._$div.find("."+e.CLASS+"-alert"),o=e._$div.find(".tc-button"),r=e._$div.find(".ga-share-icon"),i=e._$div.find(".tc-textbox");t.toggleClass(TC.Consts.classes.HIDDEN,!1);o.toggleClass("disabled",!0);o.attr("disabled","disabled");$.each(r,function(e,t){$(t).toggleClass("disabled",!0)});i.val()};e.template={};if(TC.isDebug){e.template[e.CLASS]=TC.apiLocation+"TC/templates/Share.html";e.template[e.CLASS+"-dialog"]=TC.apiLocation+"TC/templates/ShareDialog.html"}else{e.template[e.CLASS]=function(){function t(e,t){return e.w("<h2>").h("i18n",t,{},{$key:"share"}).w('</h2><div><div class="ga-share-icons"><a class="ga-share-icon share-email" target="_blank" data-toggle="tooltip" data-placement="top" title="').h("i18n",t,{},{$key:"sendMapByEmail"}).w('"href="#"><i class="icon-envelope-alt"></i></a><a class="ga-share-icon qr-generator" target="_blank" data-toggle="tooltip" data-placement="top" title="').h("i18n",t,{},{$key:"createQrCode"}).w('"href="#"><i class="icon-qrcode"></i></a><a class="ga-share-icon share-fb" target="_blank" data-toggle="tooltip" data-placement="top" title="').h("i18n",t,{},{$key:"shareMapToFacebook"}).w('"href="#"><i class="icon-facebook"></i></a><a class="ga-share-icon share-twitter" target="_blank" data-toggle="tooltip" data-placement="top" title="').h("i18n",t,{},{$key:"shareMapToTwitter"}).w('"href="#"><i class="icon-twitter"></i></a><a class="ga-share-icon share-whatsapp" target="_blank" data-toggle="tooltip" data-placement="top" title="').h("i18n",t,{},{$key:"shareMapToWhatsapp"}).w('"href="#"><i class="icon-whatsapp"></i></a><a class="ga-share-icon share-star" target="_blank" data-toggle="tooltip" data-placement="top" title="').h("i18n",t,{},{$key:"addToBookmarks"}).w('"href="#"><i class="icon-star"></i></a></div><div class="tc-ctl-share-select"><form><label class="tc-ctl-share-btn-url"><input type="radio" checked="checked" name="format" value="url" /><span>').h("i18n",t,{},{$key:"shareLink"}).w('</span></label><label class="tc-ctl-share-btn-iframe"><input type="radio" name="format" value="iframe" /><span>').h("i18n",t,{},{$key:"embedMap"}).w('</span></label></form></div><div class="tc-ctl-share-url-box tc-group tc-url"><input type="text" class="tc-textbox tc-url" readonly data-toggle="tooltip" data-placement="top" title="').h("i18n",t,{},{$key:"shareLink.tip.1"}).w('" /><button class="tc-button hide" title="').h("i18n",t,{},{$key:"shareLink.tip.2"}).w('">').h("i18n",t,{},{$key:"copy"}).w('</button></div><div class="tc-ctl-share-url-box tc-group tc-iframe tc-hidden"><input type="text" class="tc-textbox tc-iframe" readonly data-toggle="tooltip" data-placement="top" title="').h("i18n",t,{},{$key:"embedMap.tip.1"}).w('" /><button class="tc-button hide" title="').h("i18n",t,{},{$key:"embedMap.tip.2"}).w('">').h("i18n",t,{},{$key:"copy"}).w('</button></div><div class="tc-ctl-share-alert tc-alert alert-warning tc-hidden"><p>').h("i18n",t,{},{$key:"tooManyLayersLoaded|s"}).w("</p> </div></div>")}dust.register(e.CLASS,t);t.__dustBody=!0;return t};e.template[e.CLASS+"-dialog"]=function(){function t(e,t){return e.w('<div class="tc-ctl-share-qr-dialog tc-modal"><div class="tc-modal-background tc-modal-close"></div><div class="tc-modal-window"><div class="tc-modal-header"><h3>').h("i18n",t,{},{$key:"qrCode"}).w('</h3><div class="tc-ctl-popup-close tc-modal-close"></div></div><div class="tc-modal-body"><div class="qrcode"></div></div><div class="tc-modal-footer"><button type="button" class="tc-button tc-modal-close">').h("i18n",t,{},{$key:"close"}).w("</button></div></div></div>")}dust.register(e.CLASS+"-dialog",t);t.__dustBody=!0;return t}}}();TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");!function(){TC.Consts.url.GOOGLEMAPS="//maps.googleapis.com/maps/api/js?v=3";var e=TC.Consts.url.GOOGLEMAPS;TC.Cfg.proxyExceptions=TC.Cfg.proxyExceptions||[];TC.Cfg.proxyExceptions.push(TC.Consts.url.GOOGLEMAPS);TC.control.StreetView=function(){var t=this;this._templatePromise=$.Deferred();t._sv=null;t._mapActiveControl=null;TC.Control.apply(t,arguments);t.options.googleMapsKey&&(e+="&key="+t.options.googleMapsKey);t.viewDiv=null;t._$viewDiv=null;t._startLonLat=null};TC.inherit(TC.control.StreetView,TC.Control);var t=TC.control.StreetView.prototype;t.CLASS="tc-ctl-sv";t.template={};if(TC.isDebug){t.template[t.CLASS]=TC.apiLocation+"TC/templates/StreetView.html";t.template[t.CLASS+"-view"]=TC.apiLocation+"TC/templates/StreetViewView.html"}else{t.template[t.CLASS]=function(){function e(e,t){return e.w('<div class="tc-ctl-sv-btn" title="').h("i18n",t,{},{$key:"sv.tip"}).w('"><div class="tc-ctl-sv-drag"></div></div>')}dust.register(t.CLASS,e);e.__dustBody=!0;return e};t.template[t.CLASS+"-view"]=function(){function e(e,t){return e.w('<div class="tc-ctl-sv-btn-close" title="').h("i18n",t,{},{$key:"closeStreetView"}).w('"></div>')}dust.register(t.CLASS+"-view",e);e.__dustBody=!0;return e}}var o=function(e){e._$div.find("."+e.CLASS+"-btn").addClass(TC.Consts.classes.CHECKED);$(e.map.div).addClass(e.CLASS+"-active")},r=function(e){e.layer.clearFeatures();e._$div.find("."+e.CLASS+"-btn").removeClass(TC.Consts.classes.CHECKED);e._$div.find("."+e.CLASS+"-drag").removeClass(TC.Consts.classes.HIDDEN);$(e.map.div).removeClass(e.CLASS+"-active");e._startLonLat=null},i=function(e){var t=!1,o=e._$div.find("."+e.CLASS+"-btn"),i=e._$div.find("."+e.CLASS+"-drag"),n=o[0].getBoundingClientRect(),a=i[0].getBoundingClientRect();i.addClass(TC.Consts.classes.HIDDEN);if(a.top<n.top||a.top>n.bottom||a.left<n.left||a.left>n.right){t=!0;for(var l=e.map.getExtent(),s=[l[2],l[3]],p=(new Array(16),0);16>p;p++)e.layer.addMarker(s,{cssClass:"tc-marker-sv-"+p,width:48,height:48,anchor:[0,1]});var c=e.map.div.getBoundingClientRect(),u=(a.left+a.right)/2-c.left,g=a.bottom-c.top,d=e.map.wrap.getCoordinateFromPixel([u,g]);e.callback(d)}else r(e);return t};t.register=function(e){var t=this;if(!t._$viewDiv){t.viewDiv=TC.Util.getDiv(t.options.viewDiv);t._$viewDiv=$(t.viewDiv).addClass(t.CLASS+"-view "+TC.Consts.classes.HIDDEN);t.options.viewDiv||t._$viewDiv.insertBefore(e.div)}TC.Control.prototype.register.call(t,e);t.layer=null;for(var n=t.CLASS+"-layer",a=0;a<e.workLayers.length;a++){var l=e.workLayers[a];if(l.type===TC.Consts.layerType.VECTOR&&l.id===n){t.layer=l;break}}t.layer||e.loaded(function(){$.when(e.addLayer({id:n,stealth:!0,type:TC.Consts.layerType.VECTOR})).then(function(e){t.layer=e})});t._templatePromise.then(function(){TC.loadJS(!$.fn.drag,[TC.apiLocation+"lib/jquery/jquery.event.drag.js",TC.apiLocation+"lib/jquery/jquery.event.drop.js"],function(){var e=t._$div.find("."+t.CLASS+"-drag");e.drag(function(t,o){e.css({transform:"translate("+o.deltaX+"px, "+o.deltaY+"px)"})}).drag("start",function(e,r){o(t);e.preventDefault();e.stopPropagation()}).drag("end",function(o,r){i(t);e.css({transform:"none"})})});var e=t._$viewDiv;e.find("."+t.CLASS+"-btn-close").on("mouseup",function(o){$(t.map.div).removeClass(TC.Consts.classes.COLLAPSED).trigger("resize");e.addClass(TC.Consts.classes.HIDDEN).removeClass(TC.Consts.classes.VISIBLE);t._$div.find("."+t.CLASS+"-drag").removeClass(TC.Consts.classes.HIDDEN);t.layer.wrap.setDraggable(!1);r(t);t._sv.setVisible(!1);o.stopPropagation();t._previousActiveControl&&t._previousActiveControl.activate()})},function(e,t,o){TC.error("Error de renderizado Streetview")})};t.render=function(){var e=this;TC.Control.prototype.render.call(e,function(){dust.cache[e.CLASS+"-view"]?dust.render(e.CLASS+"-view",null,function(t,o){setTimeout(function(){e._$viewDiv.html(o);t&&TC.error(t);e._templatePromise.resolve()},300)}):TC.error("No hay dust.cache para StreetView")})};var n=0;t.callback=function(t){var o=this,i="EPSG:4326",a=function(e){if(o._sv){var t=e.getBounds();lonLat=TC.Util.reproject([(t[0]+t[2])/2,(t[1]+t[3])/2],o.map.crs,i);o._sv.setPosition({lng:lonLat[0],lat:lonLat[1]})}},l=function(e){if(o._sv){var t=e.getBounds();o._startLonLat=[(t[0]+t[2])/2,(t[1]+t[3])/2]}},s=o.map.getLoadingIndicator();s&&(n=s.addWait(n));var p=$(o.map.div),c=function(e,r){o.layer.clearFeatures();var n,s;if(e){var c=e.getPosition();n=TC.Util.reproject([c.lng(),c.lat()],i,o.map.crs);s=e.getPov().heading}else{n=t;s=0}o.map.addMarker(n,{cssClass:"tc-marker-sv-"+(Math.round(16*s/360)+16)%16,width:48,height:48,anchor:[.4791666666666667,.7083333333333333],layer:o.layer,showsPopup:!1});$.when.apply(this,o.map._markerDeferreds).then(function(e){o.layer.wrap.setDraggable(!0,a,l)});if(r){var u=function(){o.map.setCenter(n)};p.hasClass(TC.Consts.classes.COLLAPSED)?u():setTimeout(u,1200)}};TC.loadJS(!window.google||!google.maps,e,function(){if(window.google){c();var e=o._$viewDiv,a=TC.Util.reproject(t,o.map.crs,i),l=e.hasClass(TC.Consts.classes.VISIBLE),u="transitionend.tc";e.off(u).on(u,function(e){if(("width"===e.originalEvent.propertyName||"height"===e.originalEvent.propertyName)&&!l){l=!0;google.maps.event.trigger(o._sv,"resize");p.addClass(TC.Consts.classes.COLLAPSED).trigger("resize")}});var g={position:new google.maps.LatLng(a[1],a[0]),pov:{heading:0,pitch:0},zoom:1,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_TOP},panControlOptions:{position:google.maps.ControlPosition.LEFT_TOP}};if(o._sv)o._sv.setOptions(g);else{o._sv=new google.maps.StreetViewPanorama(e[0],g);google.maps.event.addListener(o._sv,"position_changed",function(){c(o._sv,e.hasClass(TC.Consts.classes.VISIBLE))});google.maps.event.addListener(o._sv,"pov_changed",function(){if(o.layer.features&&o.layer.features.length>0){var e=o.layer.features[0];delete e.options.url;e.options.cssClass="tc-marker-sv-"+(Math.round(16*o._sv.getPov().heading/360)+16)%16;e.setStyle(e.options);o.layer.refresh()}});google.maps.event.addListener(o._sv,"status_changed",function(){var t=o._sv.getStatus();s&&s.removeWait(n);if(t===google.maps.StreetViewStatus.OK){if(!e.hasClass(TC.Consts.classes.VISIBLE)){o._sv.setVisible(!0);c(o._sv,!0);if(o.map.activeControl){o._previousActiveControl=o.map.activeControl;o.map.activeControl.deactivate(!0)}setTimeout(function(){e.css("left","").css("top","");e.removeClass(TC.Consts.classes.HIDDEN).addClass(TC.Consts.classes.VISIBLE)},200)}}else{TC.alert(o.getLocaleString(t===google.maps.StreetViewStatus.ZERO_RESULTS?"noStreetView":"streetViewUnknownError"));if(o._startLonLat)o.callback(o._startLonLat);else{o.layer.wrap.setDraggable(!1);r(o)}}})}c(o._sv)}else r(o)})}}();TC.control=TC.control||{};TC.control.MapContents||TC.syncLoadJS(TC.apiLocation+"TC/Control");!function(){Array.prototype.filter||(Array.prototype.filter=function(e){"use strict";if(void 0===this||null===this)throw new TypeError;var t=Object(this),o=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var r=[],i=arguments.length>=2?arguments[1]:void 0,n=0;o>n;n++)if(n in t){var a=t[n];e.call(i,a,n,t)&&r.push(a)}return r})}();!function(){for(var e=0,t=["ms","moz","webkit","o"],o=!(!window.performance||!window.performance.now),r=0,i=t.length;i>r&&!window.requestAnimationFrame;r+=1){window.requestAnimationFrame=window[t[r]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[t[r]+"CancelAnimationFrame"]||window[t[r]+"CancelRequestAnimationFrame"]}window.requestAnimationFrame||(window.requestAnimationFrame=function(t,o){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),n=window.setTimeout(function(){t(r+i)},i);e=r+i;return n});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)});if(!o){var n=window.requestAnimationFrame,a=+new Date;window.requestAnimationFrame=function(e,t){var o=function(t){var o=1e12>t?t:t-a;return e(o)};n(o,t)}}}();!function(){TC.Consts.classes.THREED=TC.Consts.classes.THREED||"tc-threed";TC.Consts.event.TERRAINLOADED=TC.Consts.event.TERRAINLOADED||"terrainloaded.tc.threed";TC.Consts.event.TERRAINRECEIVING=TC.Consts.event.TERRAINRECEIVING||"terrainreceiving.tc.threed";TC.control.ThreeD=function(){var e=this;TC.Control.apply(e,arguments);e.$events=$(e);e.selectors={divThreedMap:e.options.divMap};e.Consts={BLANK_BASE:"blank",DEFAULT_TILE_SIZE:256,TERRAIN_URL:"https://pmpwvinet18.tcsa.local/customcesiumterrain/epsg3857/geodetic/_5m/5m",events:{GFI:"gfi.tc.threed"}};e.options.terrainURL&&(e.Consts.TERRAIN_URL=e.options.terrainURL);e.options.isDebug&&(TC.Consts.url.CESIUM=TC.apiLocation+"lib/cesium/debug/Cesium.js")};TC.inherit(TC.control.ThreeD,TC.Control);var e=TC.control.ThreeD.prototype;e.CLASS="tc-ctl-threed";e.classes={MAPTHREED:"tc-map-threed",LOADING:"tc-loading",BTNACTIVE:"active",CAMERACTRARROWDISABLED:"disabled-arrow",BETA:"tc-beta-button",FOCUS:"focus",HIGHLIGHTED:"highlighted",DISABLED:"disabled",OUTFOCUS:"outfocus",GFIRESULTSTR:"-gfiTR",GFIRESULTSTH:"-gfiTH",GFIRESULTSTD:"-gfiTD"};e.direction={TO_TWO_D:"two_d",TO_THREE_D:"three_d"};e.threeDControls=["search","attribution","basemapSelector","listTOC","selectContainer","externalWMS","fileImport","layerCatalog","click","fullScreen","loadingIndicator","navBar","overviewMap","legend","fullScreen","threeD"];e.template={};if(TC.isDebug){e.template[e.CLASS]=TC.apiLocation+"TC/templates/ThreeD.html";e.template[e.CLASS+"-overlay"]=TC.apiLocation+"TC/templates/ThreeDOverlay.html";e.template[e.CLASS+"-cm-ctls"]=TC.apiLocation+"TC/templates/ThreeDCameraControls.html"}else{e.template[e.CLASS+"-cm-ctls"]=function(){function t(e,t){return e.w('<div><svg xmlns:dc="http://purl.org/dc/elements/1.1/"xmlns:cc="http://creativecommons.org/ns#"xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"xmlns:svg="http://www.w3.org/2000/svg"xmlns="http://www.w3.org/2000/svg"xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"width="220"height="135"viewBox="0 0 63.40233 35.531682"version="1.1"id="threedControls"><g inkscape:groupmode="layer"id="backgroundLayer"inkscape:label="backgroundLayer"transform="translate(-2.3693123,-42.387899)"><path style="fill:#ffffff;fill-opacity:0.23999999;stroke:none;stroke-width:0.2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:0.3169643;paint-order:stroke fill markers"d="M 48.005285,42.387899 A 17.766048,17.766048 0 0 0 34.067635,49.16888 17.754217,17.754217 0 0 0 20.123267,42.399784 17.754217,17.754217 0 0 0 2.3693123,60.153739 a 17.754217,17.754217 0 0 0 17.7539547,17.75447 17.754217,17.754217 0 0 0 13.923699,-6.76961 17.766048,17.766048 0 0 0 13.958319,6.78098 17.766048,17.766048 0 0 0 17.766357,-17.76584 17.766048,17.766048 0 0 0 -17.766357,-17.76584 z"id="background"inkscape:connector-curvature="0" /></g><g inkscape:label="tiltLayer"inkscape:groupmode="layer"id="tiltLayer"transform="translate(-26.69084,-42.254264)"style="display:inline"><g class="tc-ctl-threed-cm-tilt-indicator"><path class="tc-ctl-threed-cm-tilt-inner"id="tiltInner"d="m 44.44423,52.861576 c 3.959106,0 7.167321,3.203889 7.167321,7.168124 0,3.964234 -3.208215,7.174892 -7.167321,7.174892 -3.959106,0 -7.160559,-3.210658 -7.160559,-7.174892 0,-3.964235 3.201453,-7.168124 7.160559,-7.168124 z"inkscape:connector-curvature="0"><title>').h("i18n",t,{},{$key:"threed.tilt.reset"}).w('</title></path><path class="tc-ctl-threed-cm-tilt-inner-image"d="m 40.116095,64.124648 c -0.12075,-0.119221 -0.171366,-0.928328 -0.171366,-2.739326 0,-2.143319 0.03709,-2.606753 0.223349,-2.79065 0.19727,-0.194769 0.269957,-0.196719 0.622509,-0.01671 0.219537,0.112088 0.761654,0.542242 1.204705,0.955894 l 0.805547,0.752098 v 0.939855 c 0,0.51692 -0.06955,1.085596 -0.154558,1.263727 -0.173436,0.363428 -1.919571,1.804317 -2.186551,1.804317 -0.09475,0 -0.249383,-0.07614 -0.343635,-0.169192 z m 3.287741,-0.05029 c -0.307698,-0.212789 -0.317387,-0.295835 -0.317387,-2.721198 0,-1.757783 0.05096,-2.552024 0.171366,-2.670904 0.120776,-0.119243 0.941399,-0.169194 2.779684,-0.169194 2.432612,0 2.618273,0.01838 2.756146,0.27272 0.08484,0.156511 0.147831,1.267987 0.147831,2.608402 0,3.088986 0.189068,2.899662 -2.895738,2.899662 -1.872744,0 -2.3862,-0.04266 -2.641902,-0.219488 z m 0.586357,-6.180807 c -0.314529,-0.267117 -0.397432,-0.458143 -0.397432,-0.915756 0,-0.785501 0.427643,-1.207722 1.223233,-1.207722 1.162181,0 1.675866,1.23538 0.851939,2.048861 -0.522115,0.515494 -1.126934,0.542392 -1.67774,0.07462 z m 2.780604,-0.09201 c -0.374474,-0.369724 -0.423284,-0.501051 -0.3506,-0.943285 0.118405,-0.72038 0.53618,-1.088187 1.236028,-1.088187 0.699848,0 1.117624,0.367807 1.236028,1.088187 0.07269,0.442234 0.02388,0.573561 -0.3506,0.943285 -0.300932,0.297119 -0.573881,0.429526 -0.885428,0.429526 -0.311544,0 -0.584496,-0.132407 -0.885428,-0.429526 z"id="tiltImage"inkscape:connector-curvature="0"><title>').h("i18n",t,{},{$key:"threed.tilt.reset"}).w('</title></path><path class="tc-ctl-threed-cm-tilt-outer tc-ctl-threed-cm-tilt-outer-circle"id="tiltOuter"d="m 44.44423,48.705554 c -6.246102,0 -11.312196,5.070128 -11.312196,11.324146 0,6.254017 5.066094,11.330914 11.312196,11.330914 6.246102,0 11.312196,-5.076897 11.312196,-11.330914 0,-6.254018 -5.066094,-11.324146 -11.312196,-11.324146 z m 0,4.156022 c 3.959106,0 7.167321,3.203889 7.167321,7.168124 0,3.964234 -3.208215,7.174892 -7.167321,7.174892 -3.959106,0 -7.160559,-3.210658 -7.160559,-7.174892 0,-3.964235 3.201453,-7.168124 7.160559,-7.168124 z"inkscape:connector-curvature="0"><title>').h("i18n",t,{},{$key:"threed.tilt.drag"}).w('</title></path><path class="tc-ctl-threed-cm-tilt-outer tc-ctl-threed-cm-tilt-outer-shell-circle"sodipodi:nodetypes="ssssssccccsccccssccsssccscccccccsccssscsssssccccccccccccccc"inkscape:connector-curvature="0"id="tiltShell"d="m 44.44423,48.705554 c -6.246102,0 -11.312196,5.070128 -11.312196,11.324146 0,6.254017 5.066094,11.330914 11.312196,11.330914 6.246102,0 11.312196,-5.076897 11.312196,-11.330914 0,-6.254018 -5.066094,-11.324146 -11.312196,-11.324146 z m 0,0.379051 c 2.995132,0 5.705501,1.203885 7.681205,3.154245 l -2.386853,2.382605 0.135232,0.135376 2.386853,-2.382606 c 1.930016,1.972963 3.12387,4.674054 3.12387,7.655475 0,2.981421 -1.193854,5.680844 -3.12387,7.655474 l -2.386853,-2.382605 -0.135232,0.135375 2.386853,2.382606 c -1.975664,1.951759 -4.686314,3.161013 -7.681205,3.161013 -1.94179,0 -3.766282,-0.506879 -5.347316,-1.395323 -0.850442,-0.477894 -1.630441,-1.06619 -2.320365,-1.745384 l 2.407138,-2.402912 c 1.358381,1.325983 3.214811,2.145699 5.260543,2.145699 4.163407,0 7.545972,-3.385283 7.545972,-7.553943 0,-4.168661 -3.382565,-7.547175 -7.545972,-7.547175 -2.045732,0 -3.902162,0.81461 -5.260543,2.13893 l -2.407138,-2.402912 c 1.972594,-1.940536 4.681097,-3.133938 7.667681,-3.133938 z m -0.189325,0.182756 v 3.01887 h 0.378651 v -3.01887 z m -7.606826,3.086558 2.400376,2.402912 C 37.721509,56.11715 36.90502,57.97796 36.90502,60.0297 c 0,2.05174 0.816489,3.910884 2.143435,5.272869 l -2.400376,2.402912 c -0.435151,-0.44326 -0.832923,-0.923297 -1.188195,-1.435068 -0.462681,-0.666492 -0.853281,-1.386809 -1.160484,-2.149815 -0.508689,-1.263436 -0.788715,-2.64392 -0.788715,-4.090898 0,-2.99182 1.197141,-5.70104 3.137394,-7.675781 z m 7.796151,0.507657 c 3.959106,0 7.167321,3.203889 7.167321,7.168124 0,3.964234 -3.208215,7.174892 -7.167321,7.174892 -3.959106,0 -7.160559,-3.210658 -7.160559,-7.174892 0,-3.964235 3.201453,-7.168124 7.160559,-7.168124 z m -10.744219,6.978598 v 0.379051 h 3.022445 v -0.379051 z m 18.513325,0 v 0.379051 h 3.029207 v -0.379051 z m -7.931385,7.932994 v 3.01887 h 0.37189 v -3.01887 z"><title>').h("i18n",t,{},{$key:"threed.tilt.drag"}).w('</title></path></g></g><g id="rotateLayer"inkscape:groupmode="layer"inkscape:label="rotateLayer"style="display:inline"transform="translate(-2.3693123,-42.387899)"><path class="tc-ctl-threed-cm-rotate-right"sodipodi:nodetypes="cccccccc"inkscape:connector-curvature="0"id="right"d="m 53.241331,72.907368 0.900176,1.930847 c 3.602027,-1.827343 6.291427,-4.493353 8.092762,-8.066897 l 0.969844,0.452626 -0.663464,-4.788009 -3.222445,2.974451 0.983506,0.459005 c -1.447339,3.107391 -3.949649,5.598011 -7.060379,7.037977 z"><title>').h("i18n",t,{},{$key:"threed.rotate.right"}).w('</title></path><path class="tc-ctl-threed-cm-rotate-left"sodipodi:nodetypes="cccccccc"inkscape:connector-curvature="0"id="left"d="m 42.795431,72.906221 -0.900176,1.930846 c -3.602027,-1.827342 -6.291427,-4.493352 -8.092762,-8.066896 l -0.969844,0.452626 0.663465,-4.788009 3.222444,2.974451 -0.983506,0.459005 c 1.44734,3.107391 3.949649,5.598011 7.060379,7.037977 z"><title>').h("i18n",t,{},{$key:"threed.rotate.left"}).w('</title></path><path class="tc-ctl-threed-cm-tilt-up"sodipodi:nodetypes="cccccccc"inkscape:connector-curvature="0"id="up"d="M 7.737296,54.610066 5.80645,53.70989 c 1.827342,-3.602027 4.493352,-6.291427 8.066896,-8.092762 l -0.452626,-0.969844 4.788009,0.663465 -2.974451,3.222444 -0.459005,-0.983506 c -3.107391,1.44734 -5.598011,3.949649 -7.037977,7.060379 z"><title>').h("i18n",t,{},{$key:"threed.tilt.left"}).w('</title></path><path class="tc-ctl-threed-cm-tilt-down"sodipodi:nodetypes="cccccccc"inkscape:connector-curvature="0"id="down"d="m 7.684579,65.708846 -1.930847,0.900176 c 1.827343,3.602027 4.493353,6.291427 8.066897,8.092762 l -0.452626,0.969844 4.788009,-0.663464 -2.974451,-3.222445 -0.459005,0.983506 C 11.615165,71.321886 9.124545,68.819576 7.684579,65.708846 Z"><title>').h("i18n",t,{},{$key:"threed.tilt.right"}).w('</title></path><g class="tc-ctl-threed-cm-rotate-indicator"><path class="tc-ctl-threed-cm-rotate-inner"inkscape:connector-curvature="0"d="m 48.010487,52.995444 c 3.959106,0 7.167321,3.203889 7.167321,7.168124 0,3.964234 -3.208215,7.174892 -7.167321,7.174892 -3.959106,0 -7.160559,-3.210658 -7.160559,-7.174892 0,-3.964235 3.201453,-7.168124 7.160559,-7.168124 z"id="rotateInner"><title>').h("i18n",t,{},{$key:"threed.rotate.reset"}).w('</title></path><path class="tc-ctl-threed-cm-rotate-inner-image"d="m 45.461645,60.604061 c 0.860585,-1.857231 1.777009,-3.864779 2.036499,-4.461218 0.471802,-1.084433 0.471802,-1.084433 0.66474,-0.667935 2.070474,4.46957 3.86201,8.443545 3.825603,8.485934 -0.02561,0.02982 -0.943964,-0.165127 -2.040793,-0.433206 -1.994234,-0.487419 -1.994234,-0.487419 -3.881098,-0.01711 -1.037775,0.258673 -1.950491,0.470314 -2.028258,0.470314 -0.07777,0 0.562721,-1.519553 1.423307,-3.376784 z m 1.23418,2.027617 c 1.353421,-0.310159 1.353421,-0.310159 1.353421,-2.998288 0,-1.534227 -0.05572,-2.627602 -0.129797,-2.547123 -0.101525,0.110295 -2.316061,4.831583 -2.659547,5.670031 -0.09645,0.23543 -0.15884,0.240844 1.435923,-0.12462 z"id="rotateImage"inkscape:connector-curvature="0"><title>').h("i18n",t,{},{
$key:"threed.rotate.reset"}).w('</title></path><path class="tc-ctl-threed-cm-rotate-outer tc-ctl-threed-cm-rotate-outer-circle"inkscape:connector-curvature="0"d="m 48.010487,48.839422 c -6.246102,0 -11.312196,5.070128 -11.312196,11.324146 0,6.254017 5.066094,11.330914 11.312196,11.330914 6.246102,0 11.312196,-5.076897 11.312196,-11.330914 0,-6.254018 -5.066094,-11.324146 -11.312196,-11.324146 z m 0,4.156022 c 3.959106,0 7.167321,3.203889 7.167321,7.168124 0,3.964234 -3.208215,7.174892 -7.167321,7.174892 -3.959106,0 -7.160559,-3.210658 -7.160559,-7.174892 0,-3.964235 3.201453,-7.168124 7.160559,-7.168124 z"id="rotateOuter"><title>').h("i18n",t,{},{$key:"threed.rotate.drag"}).w('</title></path><path class="tc-ctl-threed-cm-rotate-outer tc-ctl-threed-cm-rotate-outer-shell-circle"d="m 48.010487,48.839422 c -6.246102,0 -11.312196,5.070128 -11.312196,11.324146 0,6.254017 5.066094,11.330914 11.312196,11.330914 6.246102,0 11.312196,-5.076897 11.312196,-11.330914 0,-6.254018 -5.066094,-11.324146 -11.312196,-11.324146 z m 0,0.379051 c 2.995132,0 5.705501,1.203885 7.681205,3.154245 l -2.386853,2.382605 0.135232,0.135376 2.386853,-2.382606 c 1.930016,1.972963 3.12387,4.674054 3.12387,7.655475 0,2.981421 -1.193854,5.680844 -3.12387,7.655474 l -2.386853,-2.382605 -0.135232,0.135375 2.386853,2.382606 c -1.975664,1.951759 -4.686314,3.161013 -7.681205,3.161013 -1.94179,0 -3.766282,-0.506879 -5.347316,-1.395323 -0.850442,-0.477894 -1.630441,-1.06619 -2.320365,-1.745384 l 2.407138,-2.402912 c 1.358381,1.325983 3.214811,2.145699 5.260543,2.145699 4.163407,0 7.545972,-3.385283 7.545972,-7.553943 0,-4.168661 -3.382565,-7.547175 -7.545972,-7.547175 -2.045732,0 -3.902162,0.81461 -5.260543,2.13893 l -2.407138,-2.402912 c 1.972594,-1.940536 4.681097,-3.133938 7.667681,-3.133938 z m -0.189325,0.182756 v 3.01887 h 0.378651 v -3.01887 z m -7.606826,3.086558 2.400376,2.402912 c -1.326946,1.360319 -2.143435,3.221129 -2.143435,5.272869 0,2.05174 0.816489,3.910884 2.143435,5.272869 l -2.400376,2.402912 c -0.435151,-0.44326 -0.832923,-0.923297 -1.188195,-1.435068 -0.462681,-0.666492 -0.853281,-1.386809 -1.160484,-2.149815 -0.508689,-1.263436 -0.788715,-2.64392 -0.788715,-4.090898 0,-2.99182 1.197141,-5.70104 3.137394,-7.675781 z m 7.796151,0.507657 c 3.959106,0 7.167321,3.203889 7.167321,7.168124 0,3.964234 -3.208215,7.174892 -7.167321,7.174892 -3.959106,0 -7.160559,-3.210658 -7.160559,-7.174892 0,-3.964235 3.201453,-7.168124 7.160559,-7.168124 z m -10.744219,6.978598 v 0.379051 h 3.022445 v -0.379051 z m 18.513325,0 v 0.379051 H 58.8088 v -0.379051 z m -7.931385,7.932994 v 3.01887 h 0.37189 v -3.01887 z"id="rotateShell"inkscape:connector-curvature="0"sodipodi:nodetypes="ssssssccccsccccssccsssccscccccccsccssscsssssccccccccccccccc"><title>').h("i18n",t,{},{$key:"threed.rotate.drag"}).w("</title></path></g></g></svg></div>")}dust.register(e.CLASS+"-cm-ctls",t);t.__dustBody=!0;return t};e.template[e.CLASS+"-overlay"]=function(){function t(e,t){return e.w('<div class="tc-ctl-threed-overlay" hidden><svg class="tc-ctl-threed-overlay-svg"><defs><filter id="fGaussian" x="0" y="0"><feGaussianBlur in="SourceGraphic" stdDeviation="3" /></filter></defs><rect width="100%" height="100%" fill="white" fill-opacity="0.5" filter="url(#fGaussian)" /> </svg> </div>')}dust.register(e.CLASS+"-overlay",t);t.__dustBody=!0;return t};e.template[e.CLASS]=function(){function t(e,t){return e.w('<button class="tc-ctl-threed-btn tc-beta-button" title="').h("i18n",t,{},{$key:"threed.tip"}).w('"></button>')}dust.register(e.CLASS,t);t.__dustBody=!0;return t}}e.viewer;e.mapView;e.terrainProvider;e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e);t.mapView=new MapView(e,t)};e.renderData=function(e,t){var o=this;TC.Control.prototype.renderData.call(o,e,function(){o.getRenderedHtml(o.CLASS+"-overlay",{},function(e){o.overlay=$(e)});o.$button=o._$div.find("."+o.CLASS+"-btn");o.$button.on(TC.Consts.event.CLICK,function(){o.$button.attr("disabled","disabled");o.waiting||(o.waiting=o.map.getLoadingIndicator().addWait());for(var e=[],t=0,r=o.threeDControls.length;r>t;t++){var i=o.threeDControls[t];i=i.substr(0,1).toUpperCase()+i.substr(1);e=e.concat(o.map.getControlsByClass("TC.control."+i))}o.ctrlsToMng=e;if(o.mapIs3D){o.deactivate();o.cameraControls.resetRotation({duration:1e3}).then(function(){var e=function(){o.mapIs3D=!1;o.map._$div.removeClass(TC.Consts.classes.THREED);o.$button.attr("title",o.getLocaleString("threed.tip"));o.map3D.destroy.call(o);o.map3D.setViewFromCameraView.call(o).then(function(){o.$divThreedMap.removeClass(o.classes.MAPTHREED);o.$divThreedMap.removeClass("tc-ctl-threed-divMap-fadeIn").addClass("tc-ctl-threed-divMap-fadeOut");$(o.mapView.viewHTML).removeClass("tc-ctl-threed-divMap-fadeOut").addClass("tc-ctl-threed-divMap-fadeIn");o.viewer.destroy();o.viewer=null;o.$button.removeAttr("disabled");o.$button.toggleClass(o.classes.BTNACTIVE);o.map.getLoadingIndicator().removeWait(o.waiting);delete o.waiting});o.mapView.setRotation(0);o._ovMap.wrap.draw3DCamera(null)},t=u(o.viewer.scene),r=Cesium.Matrix4.fromTranslation(t),i=f(o.viewer.scene,t);o.map3D.rotateAroundAxis(o.viewer.scene.camera,-i,o.viewer.scene.camera.right,r,{duration:1500,callback:e})})}else{o.activate();if(o.browserSupportWebGL.call(o)||!o.browserSupportWebGL.call(o)){o.mapIs3D=!0;o.overlay.removeAttr("hidden");o.overlay.appendTo(o.map._$div.parent());o.map._$div.addClass(TC.Consts.classes.THREED);o.$divThreedMap=$("#"+o.selectors.divThreedMap);o.$divThreedMap.addClass(o.classes.MAPTHREED);o.$divThreedMap.addClass(o.classes.LOADING);o.$button.attr("title",o.getLocaleString("threed.two.tip"));o.$button.removeClass(o.classes.BETA);o.map3D.loadViewer.call(o).then(function(){o.$divThreedMap.removeClass("tc-ctl-threed-divMap-fadeOut").addClass("tc-ctl-threed-divMap-fadeIn");$(o.mapView.viewHTML).removeClass("tc-ctl-threed-divMap-fadeIn").addClass("tc-ctl-threed-divMap-fadeOut");o.$divThreedMap.removeClass(o.classes.LOADING);o.$button.toggleClass(o.classes.BTNACTIVE);if(o.options.allowedGFI){o.map3D.linked2DControls.featureInfo=new TwoDLinkedFeatureInfo(o);var e=new Cesium.ScreenSpaceEventHandler(o.viewer.canvas,!1);e.setInputAction(function(e){var t=o.viewer.camera.getPickRay(e.position),r=o.viewer.scene.globe.pick(t,o.viewer.scene);r&&o.map3D.getInfoOnPickedPosition.call(o,r)},Cesium.ScreenSpaceEventType.LEFT_CLICK)}o.map3D.setCameraFromMapView.call(o);o.map3D.setBaseLayer.call(o,o.map.baseLayer);o.map.workLayers.filter(function(e){return e instanceof TC.layer.Raster}).reverse().forEach(function(e){o.map3D.addLayer.call(o,e)});$.when(o.viewer.readyPromise).then(function(){o.cameraControls?o.cameraControls.render.call(o.cameraControls):o.cameraControls=new CameraControls(o);var e=Cesium.Math.toRadians(50),t=u(o.viewer.scene);t=Cesium.Matrix4.fromTranslation(t);var r=function(){Cesium.Camera.DEFAULT_VIEW_RECTANGLE=o.map3D.initialRectangle=o.viewer.camera.computeViewRectangle();Cesium.Camera.DEFAULT_VIEW_FACTOR=0;o.$button.removeAttr("disabled");o.overlay.attr("hidden","hidden");o.map.getLoadingIndicator().removeWait(o.waiting);delete o.waiting;o.$events.on(TC.Consts.event.TERRAINLOADED,function(){if(o.viewer.billboardCollection){for(var e=0;e<o.viewer.billboardCollection.length;e++){var t=Cesium.Ellipsoid.WGS84.cartesianToCartographic(o.viewer.billboardCollection.get(e).position),r=o.viewer.scene.globe.getHeight(t),i={longitude:t.longitude,latitude:t.latitude,height:t.height+r};o.viewer.billboardCollection.get(e).position=Cesium.Ellipsoid.WGS84.cartographicToCartesian(i)}o.map3D.customRender.restart()}})};o.map3D.rotateAroundAxis(o.viewer.scene.camera,-e,o.viewer.scene.camera.right,t,{duration:2e3,callback:r})}.bind(o))})}}})});$.isFunction(t)&&t()};e.activate=function(){var e=this;TC.Control.prototype.activate.call(e)};e.deactivate=function(){var e=this;TC.Control.prototype.deactivate.call(e)};MapView=function(e,t){var o=this;o.map=e;o.parent=t;$.when(o.map.getViewHTML()).then(function(e){o.viewHTML=e}.bind(o));o.proj4Obj=proj4(o.map.crs);o.proj4Obj.oProj.METERS_PER_UNIT=1;o.maxResolution;o._oldMapSetCenter=e.setCenter;e.setCenter=function(r,i){t.mapIs3D?t.map3D.flyToMapCoordinates.call(t,r):o._oldMapSetCenter.call(e,r,i)}};MapView.prototype.getCenter=function(){return this.map.getCenter()};MapView.prototype.getExtent=function(){return this.map.getExtent()};MapView.prototype.getResolution=function(){return this.map.getResolution()};MapView.prototype.getRotation=function(){return this.map.getRotation()};MapView.prototype.getMaxResolution=function(){if(this.maxResolution)return this.maxResolution;if(null!==this.map.getResolutions())this.maxResolution=this.map.getResolutions()[0];else{var e=this.map.options.baselayerExtent;this.maxResolution=(e[2]-e[0])/this.parent.Consts.DEFAULT_TILE_SIZE}return this.maxResolution};MapView.prototype.getPixelFromCoordinate=function(e){return this.map.getPixelFromCoordinate(e)};MapView.prototype.setCenter=function(e){this._oldMapSetCenter.call(this.map,e)};MapView.prototype.setExtent=function(e){this.map.setExtent(e)};MapView.prototype.setResolution=function(e){this.map.setResolution(e)};MapView.prototype.setRotation=function(e){this.map.setRotation(e)};var t=function(e,t){var o=1e6,r=t[0]-e[0],i=t[1]-e[1],n=Math.atan(i/r);0>r&&(n+=Math.PI);return[e[0]+o*Math.cos(n),e[1]+o*Math.sin(n)]},o=function(e,t){var o=t[0]-e[0],r=t[1]-e[1];return o*o+r*r},r=function(e){var r=this;e=e||{};if(e.nearMapCoords){var n=e.bottomPixel.clone();n.y=Math.round(9*n.y/10);var a=i.call(r,n);if(a){var l=[e.nearMapCoords,a].sort(function(t,r){return o(e.cameraPosition,t)-o(e.cameraPosition,r)});return t.apply(this,l)}}return null},i=function(e){var t=this,o=p(t.viewer.scene,e);if(o){o=Cesium.Cartographic.fromCartesian(o);return TC.Util.reproject([Cesium.Math.toDegrees(o.longitude),Cesium.Math.toDegrees(o.latitude)],t.map3D.crs,t.map.crs)}return null},n=function(e,t){var o=this,r=o.viewer.camera.frustum.fovy,i=o.mapView.proj4Obj.oProj.METERS_PER_UNIT,n=e*o.mapView.viewHTML.getBoundingClientRect().height,a=Math.cos(Math.abs(t)),l=n*i*a;return l/2/Math.tan(r/2)},a=function(e,t){var o=this,r=o.viewer.scene.canvas,i=o.viewer.camera.frustum.fovy,n=o.mapView.proj4Obj.oProj.METERS_PER_UNIT,a=2*e*Math.tan(i/2),l=Math.cos(Math.abs(t)),s=a/n/l,p=s/r.clientHeight,c=o.map.getResolutions();if(null==c){c=new Array(22);for(var u=0,g=c.length;g>u;++u)c[u]=o.mapView.getMaxResolution()/Math.pow(2,u)}for(var u=0;u<c.length;u++){if(c[u]<Math.abs(p)){p=c[u-1];break}if(c[u]===Math.abs(p)){p=c[u];break}u===c.length-1&&(p=c[u])}return p},l=function(e,t,o,r,i){function n(i){a||(a=i);var s=g(l((i-a)/c,0,1));e.transform.clone(f);var p=(s-h)*t;h=s;e.lookAtTransform(r);e.rotate(o,p);e.lookAtTransform(f);if(1>s)requestAnimationFrame(n);else{d&&d();y.resolve()}}var a,l=Cesium.Math.clamp,s=Cesium.defaultValue,p=i||{},c=s(p.duration,500),u=function(e){return e},g=s(p.easing,u),d=p.callback,h=0,f=new Cesium.Matrix4,y=new $.Deferred;requestAnimationFrame(n);return y},p=function(e,t){var o=e.camera.getPickRay(t),r=e.globe.pick(o,e);return r||e.camera.pickEllipsoid(t)},c=function(e){var t=e.canvas,o=new Cesium.Cartesian2(t.clientWidth/2,t.clientHeight/2);return p(e,o)},u=function(e){var t=e.canvas,o=new Cesium.Cartesian2(t.clientWidth/2,t.clientHeight);return p(e,o)},g=function(e){var t=e.camera,o=t.frustum.fovy/2,r=t.direction,i=Cesium.Quaternion.fromAxisAngle(t.right,o),n=Cesium.Matrix3.fromQuaternion(i),a=new Cesium.Cartesian3;Cesium.Matrix3.multiplyByVector(n,r,a);return new Cesium.Ray(t.position,a)},d=function(e,t,o,r){var i=e.camera,n=f(e,o),a=i.right,s=Cesium.Quaternion.fromAxisAngle(a,n),p=Cesium.Matrix3.fromQuaternion(s),c=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(i.position,o,c);var u=new Cesium.Cartesian3;Cesium.Matrix3.multiplyByVector(p,c,u);Cesium.Cartesian3.add(u,o,u);var g=Cesium.Matrix4.fromTranslation(u);l(i,t,u,g,r)},h=function(e,t,o){var r=new Cesium.Cartesian3,i=new Cesium.Cartesian3,n=new Cesium.Cartesian3;Cesium.Cartesian3.normalize(e,r);Cesium.Cartesian3.normalize(t,i);Cesium.Cartesian3.cross(r,i,n);var a=Cesium.Cartesian3.dot(r,i),l=Cesium.Cartesian3.magnitude(n),s=Cesium.Cartesian3.dot(o,n),p=Math.atan2(l,a);return s>=0?p:-p},f=function(e,t){var o=e.camera,r=o.frustum.fovy/2,i=g(e),n=Cesium.Cartesian3.clone(i.direction);Cesium.Cartesian3.negate(n,n);var a=new Cesium.Cartesian3;Cesium.Ellipsoid.WGS84.geocentricSurfaceNormal(t,a);var l=new Cesium.Cartesian3;Cesium.Cartesian3.negate(o.right,l);var s=h(a,n,l);return s+r};CameraControls=function(e){var t=this;t.parent=e;var o=function(e){var t=this;t.isFocusingCameraCtrls=!1},n=function(){var e=this;e.isFocusingCameraCtrls=!0;e.lastFocused=performance.now();if(e.$div.hasClass(e.parent.classes.OUTFOCUS)){e.$div.removeClass(e.parent.classes.OUTFOCUS);e.$tiltIndicatorOuterCircle.attr("class",e.$tiltIndicatorOuterCircle.attr("class").replace(e.parent.classes.OUTFOCUS,""));e.$tiltIndicatorOuterShellCircle.attr("class",e.$tiltIndicatorOuterShellCircle.attr("class").replace(e.parent.classes.OUTFOCUS,""));e.$rotateIndicatorOuterCircle.attr("class",e.$rotateIndicatorOuterCircle.attr("class").replace(e.parent.classes.OUTFOCUS,""));e.$rotateIndicatorOuterShellCircle.attr("class",e.$rotateIndicatorOuterShellCircle.attr("class").replace(e.parent.classes.OUTFOCUS,""))}},l=function(){var e=this;e.moving=!0},s=function(){var e=this;e.moving=!1},p=function(){var e=this,t=e.parent;e.parent.map3D.isLoadingTiles.call(e.parent)&&e.customCollisionDetection();var o=e.getCamera(),n=o.positionCartographic;if(e.moving){c(e.$tiltIndicator,o.pitch);c(e.$rotateIndicator,-o.heading);e.disableTilt(5);e._coordsXY=TC.Util.reproject([Cesium.Math.toDegrees(n.longitude),Cesium.Math.toDegrees(n.latitude)],t.map3D.crs,t.map.crs);t.mapView.setCenter(e._coordsXY);t.mapView.setResolution(a.call(t,n.height,n.latitude))}if(e._coordsXY){t._ovMap=t._ovMap||t.map.getControlsByClass("TC.control.OverviewMap")[0];if(t._ovMap){var l=t.viewer.scene,s=l.canvas,p=new Cesium.Cartesian2(0,s.clientHeight-1),u=new Cesium.Cartesian2(s.clientWidth-1,s.clientHeight-1),g=[p,u,new Cesium.Cartesian2(s.clientWidth-1,0),new Cesium.Cartesian2(0,0)].map(function(e){return i.call(t,e)}).filter(function(e){return null!==e});if(g.length&&g.length<4){var d=r.call(t,{nearMapCoords:g[0],bottomPixel:p,cameraPosition:e._coordsXY}),h=r.call(t,{nearMapCoords:g[1],bottomPixel:u,cameraPosition:e._coordsXY});if(d&&h){g[2]=h;g[3]=d}}t._ovMap.wrap.draw3DCamera({position:e._coordsXY,heading:o.heading,fov:g})}}},c=function(e,t){var o=$(e)[0].getBBox();value="rotate("+Cesium.Math.toDegrees(t)+" "+(o.x+o.width/2)+" "+(o.y+o.height/2)+")";document.getElementsByClassName(e[0].className.baseVal)[0].setAttribute("transform",value)};t.outControlsEvents=TC.Util.detectMouse()?"mouseleave":"touchleave, touchend";t.outControls=o.bind(t);t.inControlsEvents=TC.Util.detectMouse()?"mouseenter":"touchmove, touchstart";t.inControls=n.bind(t);t.moveStart=l.bind(t);t.moveEnd=s.bind(t);t.postRender=p.bind(t);t.selectors={tilt:"-cm-tilt",rotate:"-cm-rotate",indicator:"-indicator",leftArrow:"-left",rightArrow:"-right",downArrow:"-down",upArrow:"-up"};t.render()};CameraControls.prototype.bind=function(){function e(){t.lastFocused||(t.lastFocused=performance.now());var o=performance.now()-t.lastFocused;if(o>5e3&&t.isFocusingCameraCtrls!==!0&&!t.$div.hasClass(t.parent.classes.OUTFOCUS)){t.$div.addClass(t.parent.classes.OUTFOCUS);t.$tiltIndicatorOuterCircle.attr("class",t.$tiltIndicatorOuterCircle.attr("class")+" "+t.parent.classes.OUTFOCUS);t.$tiltIndicatorOuterShellCircle.attr("class",t.$tiltIndicatorOuterShellCircle.attr("class")+" "+t.parent.classes.OUTFOCUS);t.$rotateIndicatorOuterCircle.attr("class",t.$rotateIndicatorOuterCircle.attr("class")+" "+t.parent.classes.OUTFOCUS);t.$rotateIndicatorOuterShellCircle.attr("class",t.$rotateIndicatorOuterShellCircle.attr("class")+" "+t.parent.classes.OUTFOCUS)}t.rAFInOutControls=requestAnimationFrame(e)}var t=this;t.getCamera().moveStart.addEventListener(t.moveStart);t.getCamera().moveEnd.addEventListener(t.moveEnd);t.parent.viewer.scene.postRender.addEventListener(t.postRender);t.$div.on(t.outControlsEvents,t.outControls);t.$div.on(t.inControlsEvents,t.inControls);t.rAFInOutControls=requestAnimationFrame(e)};CameraControls.prototype.unbind=function(){var e=this;e.$div.addClass(TC.Consts.classes.HIDDEN);e.getCamera().moveStart.removeEventListener(e.moveStart);e.getCamera().moveEnd.removeEventListener(e.moveEnd);e.parent.viewer.scene.postRender.removeEventListener(e.postRender);e.$div.off(e.outControlsEvents,e.outControls);e.$div.off(e.inControlsEvents,e.inControls);window.cancelAnimationFrame(e.rAFInOutControls);e.lastFocused=void 0;e.rAFInOutControls=void 0};CameraControls.prototype.getCamera=function(){var e=this;return e.parent.viewer.scene.camera};CameraControls.prototype.render=function(){var e=this;if(e.$div){e.$div.removeClass(TC.Consts.classes.HIDDEN);e.bind()}else e.parent.getRenderedHtml(e.parent.CLASS+"-cm-ctls",{},function(t){e.$div=$('<div class="'+e.parent.CLASS+'-cm-ctls"></div>');e.$div.appendTo(e.parent.map._$div);$(t).appendTo(e.$div);var o="."+e.parent.CLASS+e.selectors.tilt;e.$tiltIndicatorInner=e.$div.find("[class^="+o.replace(".","")+"-inner]");e.$tiltIndicatorInner.on(TC.Consts.event.CLICK,e.resetTilt.bind(e));e.$tiltIndicator=e.$div.find(o+"-indicator");e.$tiltIndicatorOuterCircle=e.$div.find(o+"-outer-circle");e.$tiltIndicatorOuterShellCircle=e.$div.find(o+"-outer-shell-circle");e.$tiltIndicatorCircle=e.$div.find("[class^="+o.replace(".","")+"-outer]");e.$tiltIndicatorCircle.on("mousedown",function(e){var t=this;e.stopPropagation&&e.stopPropagation();e.preventDefault&&e.preventDefault();var o=new Cesium.Cartesian2,r=e.currentTarget,i=e.currentTarget.getBoundingClientRect(),n=new Cesium.Cartesian2((i.right-i.left)/2,(i.bottom-i.top)/2),a=new Cesium.Cartesian2(e.clientX-i.left,e.clientY-i.top),l=Cesium.Cartesian2.subtract(a,n,o);t.draggingTilt.call(t,r,l);e.cancelBubble=!0;e.returnValue=!1;return!1}.bind(e));e.$tiltUp=e.$div.find(o+e.selectors.upArrow);e.$tiltUp.on(TC.Util.detectMouse()?"mousedown":"touchstart",function(t){if(void 0!==$(t.target).attr("disabled")){t.stopPropagation&&t.stopPropagation();t.preventDefault&&t.preventDefault();t.cancelBubble=!0;t.returnValue=!1;return!1}t.stopPropagation&&t.stopPropagation();t.preventDefault&&t.preventDefault();e.inControls(t);var o=TC.Util.detectMouse()?"mouseup":"touchend";document.removeEventListener(o,e.tiltUpMouseUpFunction,!1);e.tiltUpMouseUpFunction=void 0;e.tilt.call(e,5);e.tiltUpInterval=setInterval(function(){e.isTiltUpDisabled?e.tiltUpMouseUpFunction():e.tilt.call(e,5)}.bind(e),101);e.tiltUpMouseUpFunction=function(){clearInterval(e.tiltUpInterval);e.tiltUpInterval=void 0;document.removeEventListener(o,e.tiltUpMouseUpFunction,!1);e.tiltUpMouseUpFunction=void 0};document.addEventListener(o,e.tiltUpMouseUpFunction,!1);t.cancelBubble=!0;t.returnValue=!1;return!1}.bind(e));e.$tiltDown=e.$div.find(o+e.selectors.downArrow);e.$tiltDown.on(TC.Util.detectMouse()?"mousedown":"touchstart",function(t){if(void 0!==$(t.target).attr("disabled")){t.stopPropagation&&t.stopPropagation();t.preventDefault&&t.preventDefault();t.cancelBubble=!0;t.returnValue=!1;return!1}t.stopPropagation&&t.stopPropagation();t.preventDefault&&t.preventDefault();e.inControls(t);var o=TC.Util.detectMouse()?"mouseup":"touchend";document.removeEventListener(o,e.tiltDownMouseUpFunction,!1);e.tiltDownMouseUpFunction=void 0;e.tilt.call(e,-5);e.tiltDownInterval=setInterval(function(){e.isTiltDownDisabled?e.tiltDownMouseUpFunction():e.tilt.call(e,-5)}.bind(e),101);e.tiltDownMouseUpFunction=function(){clearInterval(e.tiltDownInterval);e.tiltDownInterval=void 0;document.removeEventListener(o,e.tiltDownMouseUpFunction,!1);e.tiltDownMouseUpFunction=void 0};document.addEventListener(o,e.tiltDownMouseUpFunction,!1);t.cancelBubble=!0;t.returnValue=!1;return!1}.bind(e));var r="."+e.parent.CLASS+e.selectors.rotate;e.$rotateIndicatorInner=e.$div.find("[class^="+r.replace(".","")+"-inner]");e.$rotateIndicatorInner.on(TC.Consts.event.CLICK,e.resetRotation.bind(e));e.$rotateIndicator=e.$div.find(r+"-indicator");e.$rotateIndicatorOuterCircle=e.$div.find(r+"-outer-circle");e.$rotateIndicatorOuterShellCircle=e.$div.find(r+"-outer-shell-circle");e.$rotateIndicatorCircle=e.$div.find("[class^="+r.replace(".","")+"-outer]");e.$rotateIndicatorCircle.on("mousedown",function(e){var t=this;e.stopPropagation&&e.stopPropagation();e.preventDefault&&e.preventDefault();var o=new Cesium.Cartesian2,r=e.currentTarget,i=e.currentTarget.getBoundingClientRect(),n=new Cesium.Cartesian2((i.right-i.left)/2,(i.bottom-i.top)/2),a=new Cesium.Cartesian2(e.clientX-i.left,e.clientY-i.top),l=Cesium.Cartesian2.subtract(a,n,o);t.draggingRotate.call(t,r,l);e.cancelBubble=!0;e.returnValue=!1;return!1}.bind(e));e.$rotateLeft=e.$div.find(r+e.selectors.leftArrow);e.$rotateLeft.on(TC.Util.detectMouse()?"mousedown":"touchstart",function(t){t.stopPropagation&&t.stopPropagation();t.preventDefault&&t.preventDefault();e.inControls(t);var o=TC.Util.detectMouse()?"mouseup":"touchend";document.removeEventListener(o,e.rotateLeftMouseUpFunction,!1);e.rotateLeftMouseUpFunction=void 0;e.rotate.call(e,-15);e.rotateLeftInterval=setInterval(function(){e.rotate.call(e,-15)}.bind(e),101);e.rotateLeftMouseUpFunction=function(){clearInterval(e.rotateLeftInterval);e.rotateLeftInterval=void 0;document.removeEventListener(o,e.rotateLeftMouseUpFunction,!1);e.rotateLeftMouseUpFunction=void 0};document.addEventListener(o,e.rotateLeftMouseUpFunction,!1);t.cancelBubble=!0;t.returnValue=!1;return!1}.bind(e));e.$rotateRight=e.$div.find(r+e.selectors.rightArrow);e.$rotateRight.on(TC.Util.detectMouse()?"mousedown":"touchstart",function(t){t.stopPropagation&&t.stopPropagation();t.preventDefault&&t.preventDefault();e.inControls(t);var o=TC.Util.detectMouse()?"mouseup":"touchend";document.removeEventListener(o,e.rotateRightMouseUpFunction,!1);e.rotateRightMouseUpFunction=void 0;e.rotate.call(e,15);e.rotateRightInterval=setInterval(function(){e.rotate.call(e,15)}.bind(e),101);e.rotateRightMouseUpFunction=function(){clearInterval(e.rotateRightInterval);e.rotateRightInterval=void 0;document.removeEventListener(o,e.rotateRightMouseUpFunction,!1);e.rotateRightMouseUpFunction=void 0};document.addEventListener(o,e.rotateRightMouseUpFunction,!1);t.cancelBubble=!0;t.returnValue=!1;return!1}.bind(e));e.bind()}.bind(this))};CameraControls.prototype.disableTilt=function(e){var t=this,o=Cesium.Math.toRadians(Math.abs(e));t.isTiltUpDisabled=void 0==u(t.parent.viewer.scene)?!0:t.getCamera().pitch+o>=Cesium.Math.PI_OVER_TWO;t.isTiltDownDisabled=t.getCamera().pitch-o<=-Cesium.Math.PI_OVER_TWO;t.$tiltUp.attr("disabled",t.isTiltUpDisabled);t.isTiltUpDisabled?-1==t.$tiltUp.attr("class").indexOf(t.parent.classes.CAMERACTRARROWDISABLED)&&t.$tiltUp.attr("class",t.$tiltUp.attr("class")+" "+t.parent.classes.CAMERACTRARROWDISABLED):t.$tiltUp.attr("class",t.$tiltUp.attr("class").replace(" "+t.parent.classes.CAMERACTRARROWDISABLED,""));t.$tiltDown.attr("disabled",t.isTiltDownDisabled);t.isTiltDownDisabled?-1==t.$tiltDown.attr("class").indexOf(t.parent.classes.CAMERACTRARROWDISABLED)&&t.$tiltDown.attr("class",t.$tiltDown.attr("class")+" "+t.parent.classes.CAMERACTRARROWDISABLED):t.$tiltDown.attr("class",t.$tiltDown.attr("class").replace(" "+t.parent.classes.CAMERACTRARROWDISABLED,""))};CameraControls.prototype.tilt=function(e){var t=this;t.disableTilt(e);void 0==c(t.parent.viewer.scene)&&(e>0?t.getCamera().lookUp():t.getCamera().lookDown());if(!(e>=Cesium.Math.PI_OVER_TWO&&t.isTiltUpDisabled||e<=-Cesium.Math.PI_OVER_TWO&&t.isTiltDownDisabled)){var o=Cesium.Math.toRadians(e),r=c(t.parent.viewer.scene);if(r){var i=Cesium.Matrix4.fromTranslation(r);t.parent.map3D.rotateAroundAxis(t.getCamera(),-o,t.getCamera().right,i,{duration:100})}}};CameraControls.prototype.rotate=function(e){var t=this;e=Cesium.Math.toRadians(e);var o=u(t.parent.viewer.scene);o&&d(t.parent.viewer.scene,e,o,{duration:100})};CameraControls.prototype.draggingTilt=function(e,t){var o=this;o.$tiltIndicatorOuterCircle.attr("class",o.$tiltIndicatorOuterCircle.attr("class")+" "+o.parent.classes.HIGHLIGHTED);var r=new Cesium.Matrix4,i=new Cesium.Matrix4,n=new Cesium.Cartesian2;document.removeEventListener("mousemove",o.tiltMouseMoveFunction,!1);document.removeEventListener("mouseup",o.tiltMouseUpFunction,!1);o.tiltTickFunction&&o.parent.viewer.clock.onTick.removeEventListener(o.tiltTickFunction);o.tiltMouseMoveFunction=void 0;o.tiltMouseUpFunction=void 0;o.tiltTickFunction=void 0;o.isTilting=!0;o.tiltLastTimestamp=performance.now();var a=o.parent.viewer.scene,l=a.camera,s=c(a);if(s){o.tiltFrame=Cesium.Transforms.eastNorthUpToFixedFrame(s,Cesium.Ellipsoid.WGS84,i);o.tiltIsLook=!1}else{o.tiltFrame=Cesium.Transforms.eastNorthUpToFixedFrame(l.positionWC,Cesium.Ellipsoid.WGS84,i);o.tiltIsLook=!0}var p=Math.atan2(-t.y,t.x);o.tiltInitialCursorAngle=Cesium.Math.zeroToTwoPi(p-Cesium.Math.PI_OVER_TWO);o.tiltInitialCameraAngle=Math.atan2(l.position.y,l.position.x);o.tiltTickFunction=function(e){var t=this,o=performance.now(),i=(o-t.tiltLastTimestamp,c(a));i&&!t.tiltLastPivot&&(t.tiltLastPivot=i);if(!i&&t.tiltLastPivot)i=t.tiltLastPivot;else if(!t.tiltLastPivot)return;var n=t.tiltCursorAngle+Cesium.Math.PI_OVER_TWO,s=n-t.tiltInitialCursorAngle;a=t.parent.viewer.scene;l=a.camera;var p=Cesium.Matrix4.clone(l.transform,r);l.lookAtTransform(t.tiltFrame);var u=Cesium.Math.zeroToTwoPi(t.tiltInitialCameraAngle-s),g=Math.atan2(l.position.y,l.position.x),d=.02*Math.sin(u-g);t.tiltIsLook?l.look(l.right,-d):l.rotateUp(d);l.lookAtTransform(p);t.tiltLastTimestamp=o}.bind(o);o.tiltMouseMoveFunction=function(t){var o=this,r=e.getBoundingClientRect();center=new Cesium.Cartesian2((r.right-r.left)/2,(r.bottom-r.top)/2);var i=new Cesium.Cartesian2(t.clientX-r.left,t.clientY-r.top),a=Cesium.Cartesian2.subtract(i,center,n),l=Math.atan2(-a.y,a.x);o.tiltCursorAngle=Cesium.Math.zeroToTwoPi(l-Cesium.Math.PI_OVER_TWO)}.bind(o);o.tiltMouseUpFunction=function(e){o.$tiltIndicatorOuterCircle.attr("class",o.$tiltIndicatorOuterCircle.attr("class").replace(o.parent.classes.HIGHLIGHTED,""));o.isTilting=!1;document.removeEventListener("mousemove",o.tiltMouseMoveFunction,!1);document.removeEventListener("mouseup",o.tiltMouseUpFunction,!1);void 0!==o.tiltTickFunction&&o.parent.viewer.clock.onTick.removeEventListener(o.tiltTickFunction);o.tiltMouseMoveFunction=void 0;o.tiltMouseUpFunction=void 0;o.tiltTickFunction=void 0};document.addEventListener("mousemove",o.tiltMouseMoveFunction,!1);document.addEventListener("mouseup",o.tiltMouseUpFunction,!1);o._unsubscribeFromClockTick=o.parent.viewer.clock.onTick.addEventListener(o.tiltTickFunction);var p=Math.atan2(-t.y,t.x);o.tiltCursorAngle=Cesium.Math.zeroToTwoPi(p-Cesium.Math.PI_OVER_TWO)};CameraControls.prototype.draggingRotate=function(e,t){var o=this;o.$rotateIndicatorOuterCircle.attr("class",o.$rotateIndicatorOuterCircle.attr("class")+" "+o.parent.classes.HIGHLIGHTED);var r=new Cesium.Matrix4,i=new Cesium.Matrix4,n=new Cesium.Cartesian2;document.removeEventListener("mousemove",o.rotateMouseMoveFunction,!1);document.removeEventListener("mouseup",o.rotateMouseUpFunction,!1);o.rotateMouseMoveFunction=void 0;o.rotateMouseUpFunction=void 0;o.isRotating=!0;o.rotateInitialCursorAngle=Math.atan2(-t.y,t.x);var a=o.parent.viewer.scene,l=a.camera,s=c(o.parent.viewer.scene);if(null==s||void 0==s){s=u(o.parent.viewer.scene);if(null==s||void 0==s){o.rotateFrame=Cesium.Transforms.eastNorthUpToFixedFrame(l.positionWC,Cesium.Ellipsoid.WGS84,i);o.rotateIsLook=!0}else{o.rotateFrame=Cesium.Transforms.eastNorthUpToFixedFrame(s,Cesium.Ellipsoid.WGS84,i);o.rotateIsLook=!1}}else{o.rotateFrame=Cesium.Transforms.eastNorthUpToFixedFrame(s,Cesium.Ellipsoid.WGS84,i);o.rotateIsLook=!1}try{var p=Cesium.Matrix4.clone(l.transform,r);l.lookAtTransform(o.rotateFrame);o.rotateInitialCameraAngle=Math.atan2(l.position.y,l.position.x);o.rotateInitialCameraDistance=Cesium.Cartesian3.magnitude(new Cesium.Cartesian3(l.position.x,l.position.y,0));l.lookAtTransform(p)}catch(g){o.rotateMouseUpFunction()}o.rotateMouseMoveFunction=function(t){var i=e.getBoundingClientRect(),a=new Cesium.Cartesian2((i.right-i.left)/2,(i.bottom-i.top)/2),s=new Cesium.Cartesian2(t.clientX-i.left,t.clientY-i.top),c=Cesium.Cartesian2.subtract(s,a,n),u=Math.atan2(-c.y,c.x),g=u-o.rotateInitialCursorAngle,d=Cesium.Math.zeroToTwoPi(o.rotateInitialCameraAngle-g);l=o.parent.viewer.scene.camera;try{p=Cesium.Matrix4.clone(l.transform,r);l.lookAtTransform(o.rotateFrame);var h=Math.atan2(l.position.y,l.position.x);l.rotateRight(d-h);l.lookAtTransform(p)}catch(t){o.rotateMouseUpFunction()}};o.rotateMouseUpFunction=function(e){o.isRotating=!1;o.$rotateIndicatorOuterCircle.attr("class",o.$rotateIndicatorOuterCircle.attr("class").replace(o.parent.classes.HIGHLIGHTED,""));document.removeEventListener("mousemove",o.rotateMouseMoveFunction,!1);document.removeEventListener("mouseup",o.rotateMouseUpFunction,!1);o.rotateMouseMoveFunction=void 0;o.rotateMouseUpFunction=void 0};document.addEventListener("mousemove",o.rotateMouseMoveFunction,!1);document.addEventListener("mouseup",o.rotateMouseUpFunction,!1)};CameraControls.prototype.resetTilt=function(){var e=this,t=-e.getCamera().pitch-Cesium.Math.toRadians(50);e.tilt(Cesium.Math.toDegrees(t))};CameraControls.prototype.resetRotation=function(e){var t,o=this,r=new $.Deferred;t=-o.getCamera().heading;for(;t<-Math.PI;)t+=2*Math.PI;for(;t>Math.PI;)t-=2*Math.PI;e?e.callback=function(){r.resolve()}:r.resolve();var i=u(o.parent.viewer.scene);i&&d(o.parent.viewer.scene,t,i,e);return r};CameraControls.prototype.customCollisionDetection=function(){{var e,t,o=this,r=new Cesium.Matrix4,i=new Cesium.Cartographic,n=o.parent.viewer.scene,a=o.parent.viewer.scene.camera,l=n.screenSpaceCameraController,s=(l.enableCollisionDetection,l.minimumCollisionTerrainHeight),p=l.minimumZoomDistance,c=n.globe,u=c.ellipsoid;n.mapProjection}if(!Cesium.Matrix4.equals(a.transform,Cesium.Matrix4.IDENTITY)){e=Cesium.Matrix4.clone(a.transform,r);t=Cesium.Cartesian3.magnitude(a.position);a._setTransform(Cesium.Matrix4.IDENTITY)}var g=i;u.cartesianToCartographic(a.position,g);var d=!1;if(g.height<s){var h=c.getHeight(g);if(void 0!==h&&null!==h){h+=p;if(g.height<h){g.height=h;u.cartographicToCartesian(g,a.position);d=!0}}}if(void 0!==e&&null!==e){a._setTransform(e);if(d){Cesium.Cartesian3.normalize(a.position,a.position);Cesium.Cartesian3.negate(a.position,a.direction);Cesium.Cartesian3.multiplyByScalar(a.position,Math.max(t,p),a.position);Cesium.Cartesian3.normalize(a.direction,a.direction);Cesium.Cartesian3.cross(a.direction,a.up,a.right);Cesium.Cartesian3.cross(a.right,a.direction,a.up)}}};CameraControls.prototype.limitCameraToInitExtent=function(){var e=this,t=e.viewer.camera.positionCartographic.clone();if(!(t.longitude>=e.initExtent.west&&t.longitude<=e.initExtent.east&&t.latitude>=e.initExtent.south&&t.latitude<=e.initExtent.north)){var o=e.viewer.scene.screenSpaceCameraController.maximumZoomDistance,r=.05*t.height/o;t.longitude=Math.max(e.initExtent.west-r,t.longitude);t.latitude=Math.max(e.initExtent.south-r,t.latitude);t.longitude=Math.min(e.initExtent.east+r,t.longitude);t.latitude=Math.min(e.initExtent.north+r,t.latitude);e.viewer.camera.setView({destination:Cesium.Ellipsoid.WGS84.cartographicToCartesian(t),orientation:{heading:e.viewer.camera.heading,pitch:e.viewer.camera.pitch}})}e.viewer.scene.screenSpaceCameraController.minimumZoomDistance=t.height>1800?400:200};CustomRenderLoop=function(e,t,o){this.map2D=e;this.listentTo=[TC.Consts.event.LAYERADD,TC.Consts.event.LAYERORDER,TC.Consts.event.LAYERREMOVE,TC.Consts.event.LAYEROPACITY,TC.Consts.event.LAYERVISIBILITY,TC.Consts.event.ZOOM,TC.Consts.event.BASELAYERCHANGE,TC.Consts.event.FEATUREADD,TC.Consts.event.FEATUREREMOVE,TC.Consts.event.LAYERUPDATE,TC.Consts.event.TERRAINLOADED,TC.Consts.event.ZOOMTO].join(" ");this.map3D=t;this.scene_=this.map3D.scene;this.verboseRendering=o;this._boundNotifyRepaintRequired=this.notifyRepaintRequired.bind(this);

this.lastCameraViewMatrix_=new Cesium.Matrix4;this.lastCameraMoveTime_=0;this.stoppedRendering=!1;this._removeTileLoadProgressListener=this.scene_.globe.tileLoadProgressEvent.addEventListener(function(e){this.tilesWaiting=0===e?!1:!0}.bind(this));this._removePostRenderListener=this.scene_.postRender.addEventListener(this.postRender.bind(this));this._wheelEvent="";this._wheelEvent="onwheel"in this.scene_.canvas?"wheel":document.onmousewheel?"mousewheel":"DOMMouseScroll";this._originalLoadWithXhr=Cesium.loadWithXhr.load;this._originalScheduleTask=Cesium.TaskProcessor.prototype.scheduleTask;this._originalCameraSetView=Cesium.Camera.prototype.setView;this._originalCameraMove=Cesium.Camera.prototype.move;this._originalCameraRotate=Cesium.Camera.prototype.rotate;this._originalCameraLookAt=Cesium.Camera.prototype.lookAt;this._originalCameraFlyTo=Cesium.Camera.prototype.flyTo;this.enable()};CustomRenderLoop.prototype.repaintOn_=function(e,t){var o=this.scene_.canvas;o.addEventListener(e,this._boundNotifyRepaintRequired,t)};CustomRenderLoop.prototype.removeRepaintOn_=function(e,t){var o=this.scene_.canvas;o.removeEventListener(e,this._boundNotifyRepaintRequired,t)};CustomRenderLoop.prototype.enable=function(){this.repaintOn_("mousemove",!1);this.repaintOn_("mousedown",!1);this.repaintOn_("mouseup",!1);this.repaintOn_("touchstart",!1);this.repaintOn_("touchend",!1);this.repaintOn_("touchmove",!1);if(window.PointerEvent){this.repaintOn_("pointerdown",!1);this.repaintOn_("pointerup",!1);this.repaintOn_("pointermove",!1)}this.repaintOn_(this._wheelEvent,!1);window.addEventListener("resize",this._boundNotifyRepaintRequired,!1);var e=this;Cesium.loadWithXhr.load=function(t,o,r,i,n,a,l,s,p){a.promise.always(e._boundNotifyRepaintRequired);e._originalLoadWithXhr(t,o,r,i,n,a,l,s,p)};Cesium.TaskProcessor.prototype.scheduleTask=function(t,o){var r=e._originalScheduleTask.call(this,t,o),i=this;if(!i._originalWorkerMessageSinkRepaint){var n=i._worker;i._originalWorkerMessageSinkRepaint=n.onmessage;n.onmessage=function(t){i._originalWorkerMessageSinkRepaint(t);e.notifyRepaintRequired()}}return r};Cesium.Camera.prototype.setView=function(){e._originalCameraSetView.apply(this,arguments);e.notifyRepaintRequired()};Cesium.Camera.prototype.move=function(){e._originalCameraMove.apply(this,arguments);e.notifyRepaintRequired()};Cesium.Camera.prototype.rotate=function(){e._originalCameraRotate.apply(this,arguments);e.notifyRepaintRequired()};Cesium.Camera.prototype.lookAt=function(){e._originalCameraLookAt.apply(this,arguments);e.notifyRepaintRequired()};Cesium.Camera.prototype.flyTo=function(){e._originalCameraFlyTo.apply(this,arguments);e.notifyRepaintRequired()};this.map2D.on(this.listentTo,this._boundNotifyRepaintRequired)};CustomRenderLoop.prototype.disable=function(){if(this._removePostRenderListener){this._removePostRenderListener();this._removePostRenderListener=void 0}if(this._removeTileLoadProgressListener){this._removeTileLoadProgressListener();this._removeTileLoadProgressListener=void 0}this.removeRepaintOn_("mousemove",!1);this.removeRepaintOn_("mousedown",!1);this.removeRepaintOn_("mouseup",!1);this.removeRepaintOn_("touchstart",!1);this.removeRepaintOn_("touchend",!1);this.removeRepaintOn_("touchmove",!1);if(window.PointerEvent){this.removeRepaintOn_("pointerdown",!1);this.removeRepaintOn_("pointerup",!1);this.removeRepaintOn_("pointermove",!1)}this.removeRepaintOn_(this._wheelEvent,!1);window.removeEventListener("resize",this._boundNotifyRepaintRequired,!1);Cesium.loadWithXhr.load=this._originalLoadWithXhr;Cesium.TaskProcessor.prototype.scheduleTask=this._originalScheduleTask;Cesium.Camera.prototype.setView=this._originalCameraSetView;Cesium.Camera.prototype.move=this._originalCameraMove;Cesium.Camera.prototype.rotate=this._originalCameraRotate;Cesium.Camera.prototype.lookAt=this._originalCameraLookAt;Cesium.Camera.prototype.flyTo=this._originalCameraFlyTo;this.map2D.off(this.listentTo,this._boundNotifyRepaintRequired)};CustomRenderLoop.prototype.postRender=function(e){var t=Date.now(),o=this.scene_,r=o.camera;Cesium.Matrix4.equalsEpsilon(this.lastCameraViewMatrix_,r.viewMatrix,1e-5)||(this.lastCameraMoveTime_=t);var i=t-this.lastCameraMoveTime_<3e3,n=o.tweens;if(!i&&!this.tilesWaiting&&0==n.length){this.verboseRendering&&console.log("stopping rendering @ "+Date.now());this.parent.setBlockRendering(!0);this.stoppedRendering=!0}Cesium.Matrix4.clone(r.viewMatrix,this.lastCameraViewMatrix_)};CustomRenderLoop.prototype.restart=function(){this.notifyRepaintRequired()};CustomRenderLoop.prototype.notifyRepaintRequired=function(){this.verboseRendering&&this.stoppedRendering&&console.log("starting rendering @ "+Date.now());this.lastCameraMoveTime_=Date.now();this.parent.setBlockRendering(!1);this.stoppedRendering=!1};CustomRenderLoop.prototype.setDebug=function(e){this.verboseRendering=e};CustomRender=function(e,t,o){this.idRequestAnimationFrame=null;this._blockRendering=!1;this._canvasClientWidth=0;this._canvasClientHeight=0;this._resolutionScale=1;this._viewer=t;this._canvas=t.scene.canvas;this._clock=t.clock||new Cesium.Clock;this._handleResize=function(e){var t=this._canvas.clientWidth,o=this._canvas.clientHeight;if(!(0===t|0===o||t===this._canvasClientWidth&&o===this._canvasClientHeight)){var r=this._resolutionScale;this._canvasClientWidth=t;this._canvasClientHeight=o;t*=r;o*=r;this._canvas.width=t;this._canvas.height=o;e.scene.camera.frustum.aspectRatio=t/o}};this._renderingAnimation=function(){function e(){if(this._blockRendering)this._clock.tick();else{this._viewer.scene.initializeFrame();this._handleResize(this._viewer);var t=this._clock.tick()||Cesium.JulianDate.now();this._viewer.scene.render(t)}this.idRequestAnimationFrame=requestAnimationFrame(e.bind(this))}this.idRequestAnimationFrame=requestAnimationFrame(e.bind(this))};o&&(this._resolutionScale=.5);this.renderLoop=new CustomRenderLoop(e,t,!1);this.renderLoop.parent=this};CustomRender.prototype.start=function(e){this.renderLoop.setDebug(e||!1);this._renderingAnimation()};CustomRender.prototype.stop=function(){window.cancelAnimationFrame(this.idRequestAnimationFrame)};CustomRender.prototype.restart=function(){this.renderLoop.restart()};CustomRender.prototype.setBlockRendering=function(e){this._blockRendering=e};CustomRender.prototype.getCanvas=function(){return this._canvas};TwoDLinkedFeatureInfo=function(e){this.layer=null;var t=null,o=null,r=null,i=null,n=function(){var t=new $.Deferred;if(o)t.resolve();else{TC.control.ResultsPanel||TC.syncLoadJS(TC.apiLocation+"TC/control/ResultsPanel");o=new TC.control.ResultsPanel({div:"results-panel",content:"table",titles:{main:e.getLocaleString("threed.rs.panel.gfi"),max:e.getLocaleString("threed.rs.panel.gfi")},openOn:e.Consts.events.GFI});o.register(e.map);o.render(function(){o.onClose=function(){p();e.map.$events.trigger($.Event(TC.Consts.event.POPUPHIDE,{control:r.popup}))}.bind(this);e.map.on(TC.Consts.event.RESULTSPANELCLOSE,o.onClose);t.resolve()})}return t},l=function(o){if(t)t.position=o;else{var r=(TC.control.FeatureInfoCommons.prototype.markerStyle,{position:o,billboard:{image:TC.Util.getBackgroundUrlFromCss(e.CLASS+"-marker"),eyeOffset:new Cesium.Cartesian3(0,0,-100),verticalOrigin:Cesium.VerticalOrigin.BOTTOM,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND}});t=e.map3D.addNativeFeature.call(e,r)}},p=function(){e.map3D.removeFeature.call(e,t);t=null};r=e.map.getControlsByClass(TC.control.FeatureInfo)[0];if(r){r.marker=!0;i=r.popup.$popupDiv;r.popup.hide();this.layer=r.layer;e.map3D.vector2DLayers.push(this.layer)}this.clear=function(){this.layer=null;p();if(o){o.onClose&&e.map.off(TC.Consts.event.RESULTSPANELCLOSE,o.onClose);o.close()}if(r){r.popup.$popupDiv=i;r.popup.hide()}};this.send=function(t){var c=new $.Deferred;e.waiting||(e.waiting=e.map.getLoadingIndicator().addWait());r.popup.$popupDiv=i;l(t);$.when(n()).then(function(){for(var i,n=Cesium.Ellipsoid.WGS84.cartesianToCartographic(t),l=TC.Util.reproject([Cesium.Math.toDegrees(n.longitude),Cesium.Math.toDegrees(n.latitude)],e.map3D.crs,e.map.crs),u=e.map.options.pixelTolerance||TC.Cfg.pixelTolerance,g=2*u+1,d=e.viewer.scene.globe._surface._tilesToRender,h=0;!i&&h<d.length;++h){var f=d[h];Cesium.Rectangle.contains(f.rectangle,n)&&(i=f)}if(!i)return c;for(var y=i.data.imagery,m=y.length-1;m>=0;--m){var v=y[m],C=v.readyImagery;if(!C)return c}var T=a.call(e,e.viewer.camera.positionCartographic.height,e.viewer.camera.positionCartographic.latitude),_=g*T/2,S=[l[0]-_,l[1]-_,l[0]+_,l[1]+_],E=[u,u];e.map.one(TC.Consts.event.POPUP,function(e){o.open(e.control.$popupDiv.find("."+r.CLASS).clone(!0,!0));r.popup.$popupDiv=o.$divTable;r.onShowPopUp(e);r.popup.$popupDiv.removeAttr("style");c.resolve(e)});e.map.one(TC.Consts.event.NOFEATUREINFO,function(e){r.isActive=savedIsActive;p(s);o&&o.close();c.resolve(e)});e.map.one(TC.Consts.event.FEATUREINFO,function(e){r.isActive=savedIsActive;if(0==e.featureCount){p();o&&o.close()}c.resolve(e)});savedIsActive=r.isActive;r.isActive=!0;r.beforeGetFeatureInfo({xy:E,control:r});r.wrap.getFeatureInfo(E,{mapSize:[g,g],boundingBox:S})});return c}};TwoDLinkedLegend=function(e){var t=e.map.getControlsByClass(TC.control.Legend)[0];this.refresh=function(){t&&e.map3D.workLayers.length>0&&t.loadGraphics()}};RasterConverter=function(e){this.layerCrs=null;var e=e,t={CRS:["Capability","Layer","CRS"],TILEMATRIXSET:["Contents","TileMatrixSet","Identifier"],TILEMATRIXSETLABELS:["Contents","TileMatrixSet"]},o=function(e,t,r){if(r<t.length-1)return e.hasOwnProperty(t[r])?o(e[t[r]],t,++r):null;if(e instanceof Array){for(var i=[],n=0;n<e.length;n++)e[n].hasOwnProperty(t[r])&&i.push(e[n][t[r]]);return i}return e[t[r]]},r=function(e){return(capsURL=TC.Util.isOnCapabilities(e.url))&&(caps=TC.capabilities[capsURL])?o(caps,t.CRS,0)||o(caps,t.TILEMATRIXSET,0):null},i=function(e,r){if((capsURL=TC.Util.isOnCapabilities(e.url))&&(caps=TC.capabilities[capsURL]))for(var i=o(caps,t.TILEMATRIXSETLABELS,0),n=0;n<i.length;n++)if(i[n].Identifier===r)return o(i[n],["TileMatrix","Identifier"],0);return null},n=function(e){var t=i(e,this.layerCrs),o={url:e.options.urlPattern,layer:e.layerNames,style:"default",format:e.format||e.options.format,tileMatrixSetID:this.layerCrs,tileMatrixLabels:t,tilingScheme:new Cesium.GeographicTilingScheme};e.usesProxy&&(o.proxy={getURL:function(e){return TC.proxify(e)}});return new Cesium.WebMapTileServiceImageryProvider(o)},a=function(e){var t={url:e.url,layers:e.layerNames,parameters:{version:"1.3.0",transparent:!0,format:e.format||e.options.format}};(e.usesProxy||e.usesSSL&&!TC.Util.isSameOrigin(e.url))&&(t.proxy={getURL:function(e){return TC.proxify(e)}});return new Cesium.WebMapServiceImageryProvider(t)};this.isCompatible=function(t){var o=r(t);if(o&&o.length&&e.test(o.join(","))){this.layerCrs=o.join(",").match(e)[0];return!0}return!1};this.convert=function(e){var t;this.isCompatible(e);if(null!=this.layerCrs){switch(!0){case TC.Consts.layerType.WMTS==e.type:t=n.call(this,e);break;case TC.Consts.layerType.WMS==e.type:t=a(e)}if(t){if(void 0!==t.enablePickFeatures){t.enablePickFeatures=!1;t.tcLayer=e}return t}}return null}};FeatureConverter=function(){var e=null,t=function(e,t){e instanceof Array&&(e="rgba("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")");var o=Cesium.Color.fromCssColorString(e);return t?o.withAlpha(t):o},o=function(e,t,o){for(var r in t){var i=e[t[r].prop];if(i)if("function"==typeof i){var n=i(o);n&&(t[r].val=n)}else t[r].val=i}},r=function(t){var o;if(1==t.length){var r,i,n,a,l=t[0],s=1e3;r=new Cesium.Cartesian3(l.x-s,l.y,l.z);i=new Cesium.Cartesian3(l.x,l.y-s,l.z);n=new Cesium.Cartesian3(l.x+s,l.y,l.z);a=new Cesium.Cartesian3(l.x,l.y+s,l.z);o=Cesium.Rectangle.fromCartesianArray([r,i,n,a],Cesium.Ellipsoid.WGS84)}else o=Cesium.Rectangle.fromCartesianArray(t,Cesium.Ellipsoid.WGS84);var p=e.camera.getRectangleCameraCoordinates(o),c=Cesium.Cartesian3.distance(p,Cesium.BoundingSphere.fromPoints(t).center),u=e.camera.frustum.getPixelDimensions(e.drawingBufferWidth,e.drawingBufferHeight,c,new Cesium.Cartesian2);u=Math.max(u.x,u.y);return 0==Math.round(u)?1:u},i=function(e){var t;t=e.layer.hasOwnProperty("styles")?e.layer.styles:TC.Defaults.styles;t=void 0==t[e.STYLETYPE]?t["polyline"===e.STYLETYPE?"line":e.STYLETYPE]:t["multipolygon"===e.STYLETYPE?"polygon":e.STYLETYPE];t=$.extend({},t,e.options,e.getStyle());return t},n=function(e){var n={},a=i(e);n.options=function(){var r={},i={color:{prop:"fillColor"},opacity:{prop:"fillOpacity"},outlineColor:{prop:"strokeColor"},outlineOpacity:{prop:"strokeOpacity"},width:{prop:"strokeWidth"}};o(a,i,e);var n;i.color.hasOwnProperty("val")&&(n=i.opacity.hasOwnProperty("val")?t(i.color.val,i.opacity.val):t(i.color.val));r.color=Cesium.ColorGeometryInstanceAttribute.fromColor(n);i.outlineColor.hasOwnProperty("val")&&(n=i.outlineOpacity.hasOwnProperty("val")?t(i.outlineColor.val,i.outlineOpacity.val):t(i.outlineColor.val));r.outlineColor=Cesium.ColorGeometryInstanceAttribute.fromColor(n);i.width.hasOwnProperty("val")&&(r.width=i.width.val);return r};TC.feature.MultiPolygon&&e instanceof TC.feature.MultiPolygon?n.geometryType=function(t,o){for(var i=[],n=[],a=function(t){return new Cesium.GeometryInstance({id:e.id,geometry:new Cesium.PolygonGeometry({polygonHierarchy:t}),attributes:{color:o.color}})},l=function(t){return new Cesium.GeometryInstance({id:e.id+"outLine",geometry:new Cesium.CorridorGeometry({positions:t,width:r(t)*o.width}),attributes:{color:o.outlineColor}})},s=0;s<t.length;s++){for(var p=0;p<t[s].length;p++){var c;if(0==p){n.push(l(t[s][0]));c=new Cesium.PolygonHierarchy(t[s][0])}else{n.push(l(t[s][p]));c.holes.push(new Cesium.PolygonHierarchy(t[s][p]))}}i.push(a(c))}return[new Cesium.GroundPrimitive({geometryInstances:i}),new Cesium.GroundPrimitive({geometryInstances:n})]}:TC.feature.Polygon&&e instanceof TC.feature.Polygon&&(n.geometryType=function(t,o){return[new Cesium.GroundPrimitive({geometryInstances:new Cesium.GeometryInstance({id:e.id,geometry:new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(t)}),attributes:{color:o.color}})}),new Cesium.GroundPrimitive({geometryInstances:new Cesium.GeometryInstance({id:e.id+"outLine",geometry:new Cesium.CorridorGeometry({positions:t,width:r(t)*o.width}),attributes:{color:o.outlineColor}})})]});return n},a=function(e){var n={},a=i(e);n.options=function(){var r={},i={color:{prop:"strokeColor"},opacity:{prop:"strokeOpacity"},width:{prop:"strokeWidth"}};o(a,i,e);i.width.hasOwnProperty("val")&&(r.width=i.width.val);var n;i.color.hasOwnProperty("val")&&(n=i.opacity.hasOwnProperty("val")?t(i.color.val,i.opacity.val):t(i.color.val));r.color=Cesium.ColorGeometryInstanceAttribute.fromColor(n);return r};TC.feature.MultiPolyline&&e instanceof TC.feature.MultiPolyline?n.geometryType=function(t,o){1==t.length&&(t=t[0]);return new Cesium.GroundPrimitive({geometryInstances:new Cesium.GeometryInstance({id:e.id,geometry:new Cesium.CorridorGeometry({positions:t,width:r(t)*o.width}),attributes:{color:o.color}})})}:TC.feature.Polyline&&e instanceof TC.feature.Polyline&&(n.geometryType=function(t,o){return new Cesium.GroundPrimitive({geometryInstances:new Cesium.GeometryInstance({id:e.id,geometry:new Cesium.CorridorGeometry({positions:t,width:r(t)*o.width}),attributes:{color:o.color}})})});return n},l=function(e){var r={},n=i(e);r.options=function(){var r={},i={rotation:{prop:"angle"},label:{prop:"label"},fontSize:{prop:"fontSize"},fontColor:{prop:"fontColor"},outlineLabelColor:{prop:"labelOutlineColor"},outlineLabelWidth:{prop:"labelOutlineWidth"},anchor:{prop:"anchor"},height:{prop:"height"},width:{prop:"width"},url:{prop:"url"},color:{prop:"fillColor"},opacity:{prop:"fillOpacity"},outlineColor:{prop:"strokeColor"},outlineOpacity:{prop:"strokeOpacity"},outlineWidth:{prop:"strokeWidth"},radius:{prop:"radius"}};o(n,i,e);if(i.anchor.hasOwnProperty("val")){r.url=!i.url.hasOwnProperty("val")&&e.options.url?e.options.url:i.url.val;r.anchor=i.anchor.val}i.height.hasOwnProperty("val")&&(r.height=i.height.val);i.width.hasOwnProperty("val")&&(r.width=i.width.val);i.rotation.hasOwnProperty("val")&&(r.rotation=i.rotation.val);i.label.hasOwnProperty("val")&&(r.label=i.label.val);i.fontSize.hasOwnProperty("val")&&(r.fontSize=i.fontSize.val);i.fontColor.hasOwnProperty("val")&&(r.fontColor=t(i.fontColor.val));i.outlineLabelColor.hasOwnProperty("val")&&(r.outlineLabelColor=t(i.outlineLabelColor.val));i.outlineLabelWidth.hasOwnProperty("val")&&(r.outlineLabelWidth=i.outlineLabelWidth.val);i.color.hasOwnProperty("val")&&(r.color=i.opacity.hasOwnProperty("val")?t(i.color.val,i.opacity.val):t(i.color.val));i.outlineColor.hasOwnProperty("val")&&(r.outlineColor=i.outlineOpacity.hasOwnProperty("val")?t(i.outlineColor.val,i.outlineOpacity.val):t(i.outlineColor.val));i.outlineWidth.hasOwnProperty("val")&&(r.outlineWidth=i.outlineWidth.val);i.radius.hasOwnProperty("val")&&(r.radius=i.radius.val);return r};if(TC.feature.Marker&&e instanceof TC.feature.Marker)r.geometryType=function(t,o){var r={id:e.id,name:e.id,position:t[0],billboard:{image:o.url,width:o.width,height:o.height,eyeOffset:new Cesium.Cartesian3(0,0,-100),pixelOffset:new Cesium.Cartesian2(o.anchor[0],o.anchor[1]),verticalOrigin:Cesium.VerticalOrigin.BOTTOM,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND}};return o.label?[r,{id:e.id,name:e.id,position:t[0],label:{text:o.label,font:"14pt sans-serif",heightReference:Cesium.HeightReference.CLAMP_TO_GROUND,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,fillColor:o.fontColor,showBackground:!0,eyeOffset:new Cesium.Cartesian3(0,0,-100)}}]:r};else if(TC.feature.Point&&e instanceof TC.feature.Point){var a=new Cesium.PinBuilder;r.geometryType=function(t,o){var r=o.label;return r&&!/^[0-9]*\-{0,1}[a-z]{0,4}$/gi.test(r)?{id:e.id,name:e.id,position:t[0],label:{text:o.label,font:"14px san-serif Arial",showBackground:!0,eyeOffset:new Cesium.Cartesian3(0,0,-100),heightReference:Cesium.HeightReference.CLAMP_TO_GROUND,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BASELINE,fillColor:Cesium.Color.WHITE}}:/^[0-9]*\-{0,1}[a-z]{0,4}$/gi.test(r)?{id:e.id,name:e.id,position:t[0],billboard:{image:a.fromText(r,o.fontColor,48).toDataURL(),eyeOffset:new Cesium.Cartesian3(0,0,-100),verticalOrigin:Cesium.VerticalOrigin.BOTTOM,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND}}:{id:e.id,name:e.id,position:t[0],billboard:{image:a.fromColor(Cesium.Color.fromCssColorString(TC.Cfg.styles.point.fillColor),24).toDataURL(),eyeOffset:new Cesium.Cartesian3(0,0,-100),verticalOrigin:Cesium.VerticalOrigin.BOTTOM,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND}}}}return r};this.convert=function(t,o,r,i){e=t;var s,p,c,u,g,d=[],h=function(e,t){e=TC.Util.reproject(e,r,i);t.push(e.length>2?Cesium.Cartesian3.fromDegrees(e[0],e[1],e[2]):Cesium.Cartesian3.fromDegrees(e[0],e[1]))},f=o.geometry,y=function(e,t){if($.isArray(e))for(var o=0;o<e.length;o++)h(e[o],t)},m=function(e,t){if($.isArray(e))for(var o=0;o<e.length;o++){t.push([]);y(e[o],t[t.length-1])}},v=function(e){if($.isArray(e))for(var t=0;t<e.length;t++){d.push([]);m(e[t],d[d.length-1])}};switch(!0){case TC.feature.MultiPolygon&&o instanceof TC.feature.MultiPolygon:g=f;if($.isArray(g)){v(g);p=n.call(self,o)}break;case TC.feature.Polygon&&o instanceof TC.feature.Polygon||TC.feature.MultiPolyline&&o instanceof TC.feature.MultiPolyline:u=f;if($.isArray(u)){m(u,d);o instanceof TC.feature.Polygon?p=n(o):o instanceof TC.feature.MultiPolyline&&(p=a(o))}break;case TC.feature.Polyline&&o instanceof TC.feature.Polyline:c=f;if($.isArray(c)){y(c,d);p=a(o)}break;case TC.feature.Marker&&o instanceof TC.feature.Marker:c=[f];y(c,d);p=l(o);break;case TC.feature.Point&&o instanceof TC.feature.Point:c=[f];y(c,d);p=l(o)}if(0==d.length)return null;s={id:o.id,attributes:o.data,geometry:p.geometryType(d,p.options()),boundigSphere:Cesium.BoundingSphere.fromPoints(d)};return s}};e.map3D=function(){var e={baseMap:"",baseMaps:[],baseVector:""},t={layers:[],getProperties:function(e){if(e.options&&e.options.hasOwnProperty("4326")){t.layers.push({id:e.id,opts:e.options[4326]});return t.layers[t.layers.length-1].opts}return null},findById:function(e){if(0==this.layers.length)return null;for(var t=0;t<this.layers.length;t++)if(this.layers[t].id.toLowerCase().trim()===e.toLowerCase().trim())return this.layers[t].opts;return null}},o=function(o){var r=this,i=o.baseLayer instanceof TC.layer.Raster;i?null==(crs=s.isCompatible(o.baseLayer))&&null==t.getProperties.call(r,r.map.baseLayer)&&o.toast(r.getLocaleString("threed.baseLayerNoCompatible",{name:o.baseLayer.layerNames})):e.baseVector=o.baseLayer;if(0===e.baseMaps.length)for(var n=0;n<o.baseLayers.length;n++)o.baseLayers[n]instanceof TC.layer.Raster&&!s.isCompatible(o.baseLayers[n])&&null==t.getProperties.call(r,o.baseLayers[n])&&e.baseMaps.push({l:o.baseLayers[n],i:n});e.baseMap=i?o.baseLayer:r.Consts.BLANK_BASE},r=function(t){var o=!1;if(e.baseMaps&&e.baseMaps.length){for(var r=0;r<e.baseMaps.length;r++)for(var i=0;i<t.baseLayers.length;i++)if(t.baseLayers[i]===e.baseMaps[r].l){e.baseMap==t.baseLayers[i]&&(o=!0);t.$events.trigger($.Event(TC.Consts.event.LAYERREMOVE,{layer:t.baseLayers[i]}));t.baseLayers.splice(i,1);break}if(o){t.baseLayer=t.baseLayers[0];t.$events.trigger($.Event(TC.Consts.event.BASELAYERCHANGE,{layer:t.baseLayer}))}}},i=function(t){if(e.baseMaps&&e.baseMaps.length)for(var o=0;o<e.baseMaps.length;o++){t.$events.trigger($.Event(TC.Consts.event.LAYERADD,{layer:e.baseMaps[o].l}));t.baseLayers.splice(e.baseMaps[o].i,0,e.baseMaps[o].l)}},s=new RasterConverter(/(EPSG\:?4326)/i),p=new FeatureConverter,g=function(){var e=new $.Deferred;window.Cesium?e.resolve():TC.loadJS(!window.Cesium,[TC.Consts.url.CESIUM],function(){e.resolve()});return e},d=function(){var e=this;if(!TC.Util.detectMobile()){e.viewer.scene.screenSpaceCameraController.enableZoom=!1;var t,o=e.viewer.scene.canvas;t="onwheel"in o?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";o.addEventListener(t,function(t){var o;if(t.deltaY){var r=t.deltaMode;o=r===t.DOM_DELTA_PIXEL?-t.deltaY:r===t.DOM_DELTA_LINE?40*-t.deltaY:120*-t.deltaY}else o=t.detail>0?-120*t.detail:t.wheelDelta;e.map3D.zoomToCartesian.call(e,e.map3D._lastMousePosition,o)},!1);var r=new Cesium.ScreenSpaceEventHandler(e.viewer.scene.canvas);r.setInputAction(function(t){e.map3D._lastMousePosition=t},Cesium.ScreenSpaceEventType.MOUSE_MOVE);r.setInputAction(function(t){e.map3D.zoomToCartesian.call(e,e.map3D._lastMousePosition,t)},Cesium.ScreenSpaceEventType.WHEEL);var i=new Cesium.Cartesian2,n=0;r.setInputAction(function(e){Cesium.Cartesian2.lerp(e.position1,e.position2,.5,i)},Cesium.ScreenSpaceEventType.PINCH_START);r.setInputAction(function(t){var o=t.distance.endPosition.y-t.distance.startPosition.y,r=o/e.viewer.scene.canvas.clientHeight;r=Math.min(r,e.viewer.scene.screenSpaceCameraController.maximumMovementRatio);n=r},Cesium.ScreenSpaceEventType.PINCH_MOVE);r.setInputAction(function(t){e.map3D.zoomToCartesian.call(e,{endPosition:i},n)},Cesium.ScreenSpaceEventType.PINCH_END)}},h=function(e){var t=e;switch(!0){case e instanceof Cesium.GroundPrimitive:this.viewer.scene.groundPrimitives.add(e);break;case e instanceof Object&&e.hasOwnProperty("billboard"):this.viewer.billboardCollection||(this.viewer.billboardCollection=this.viewer.scene.primitives.add(new Cesium.BillboardCollection({scene:this.viewer.scene})));var o=this.viewer.billboardCollection.add({position:e.position,image:e.billboard.image,verticalOrigin:e.billboard.verticalOrigin,heightReference:e.billboard.heightReference});t=o;break;case e instanceof Object:t=this.viewer.entities.add(e)}return t},f=function(e,t,o){e.vector2DFeatures.hasOwnProperty(t)?e.vector2DFeatures[t].push(o):e.vector2DFeatures[t]=[o]},y=[TC.Consts.event.BEFOREBASELAYERCHANGE,TC.Consts.event.BASELAYERCHANGE,TC.Consts.event.LAYERADD,TC.Consts.event.LAYERREMOVE,TC.Consts.event.LAYERVISIBILITY,TC.Consts.event.LAYEROPACITY,TC.Consts.event.LAYERORDER,TC.Consts.event.FEATUREADD,TC.Consts.event.FEATUREREMOVE,TC.Consts.event.FEATURESCLEAR,TC.Consts.event.ZOOM,TC.Consts.event.ZOOMTO],m=function(e){var t=this,o=e.type+".tc";switch(!0){case o==TC.Consts.event.BEFOREBASELAYERCHANGE:t.waiting||(t.waiting=t.map.getLoadingIndicator().addWait());break;case o==TC.Consts.event.BASELAYERCHANGE:t.map3D.setBaseLayer.call(t,e.layer);break;case o==TC.Consts.event.LAYERADD:t.map3D.addLayer.call(t,e.layer);break;case o==TC.Consts.event.LAYERREMOVE:t.map3D.removeLayer.call(t,e.layer);break;case o==TC.Consts.event.LAYERVISIBILITY:t.map3D.setRenderOptionsLayer.call(t,e.layer,{visibility:e.layer.getVisibility()});break;case o==TC.Consts.event.LAYEROPACITY:t.map3D.setRenderOptionsLayer.call(t,e.layer,{opacity:e.layer.getOpacity()});break;case o==TC.Consts.event.LAYERORDER:for(var r=0;r<t.map3D.workLayers.length;r++)if(t.map3D.workLayers[r].imageryProvider&&t.map3D.workLayers[r].imageryProvider.layers.join(",")===e.layer.names.join(",")){if(e.oldIndex>e.newIndex)for(var i=e.oldIndex-e.newIndex,n=0;i>n;n++)t.viewer.scene.imageryLayers.lower(t.map3D.workLayers[r]);else for(var i=e.newIndex-e.oldIndex,n=0;i>n;n++)t.viewer.scene.imageryLayers.raise(t.map3D.workLayers[r]);t.map3D.workLayers.splice(e.newIndex,0,t.map3D.workLayers.splice(e.oldIndex,1)[0]);break}break;case o==TC.Consts.event.FEATUREADD:t.map3D.addFeature.call(t,e.feature);break;case o==TC.Consts.event.FEATUREREMOVE:if(t.map3D.vector2DFeatures&&t.map3D.vector2DFeatures.hasOwnProperty(e.layer.id)){for(var a=t.map3D.vector2DFeatures[e.layer.id],r=0;r<a.length;r++)t.map3D.removeFeature.call(t,a[r]);delete t.map3D.vector2DFeatures[e.layer.id]}break;case o==TC.Consts.event.FEATURESCLEAR:if(t.map3D.vector2DFeatures&&t.map3D.vector2DFeatures.hasOwnProperty(e.layer.id)){for(var a=t.map3D.vector2DFeatures[e.layer.id],r=0;r<a.length;r++)t.map3D.removeFeature.call(t,a[r]);delete t.map3D.vector2DFeatures[e.layer.id]}break;case o==TC.Consts.event.ZOOM:t.cameraControls&&!t.cameraControls.moving&&t.map3D.flyToMapCoordinates.call(t,t.mapView.getCenter());break;case o==TC.Consts.event.ZOOMTO:if(t.lastZoom&&performance.now()-t.lastZoom<50)return;t.lastZoom=performance.now();var l=TC.Util.reproject(e.extent.slice(0,2),t.map.crs,t.map3D.crs),s=TC.Util.reproject(e.extent.slice(2),t.map.crs,t.map3D.crs),p=Cesium.Rectangle.fromDegrees(l[0],l[1],s[0],s[1]);t.map3D.flyToRectangle.call(t,p)}},v=function(e){for(var t=this,o=0,r=t.map.controls.length;r>o;o++){var i=t.map.controls[o];if(t.ctrlsToMng.indexOf(i)<0)switch(!0){case t.direction.TO_TWO_D==e:i.enable();break;case t.direction.TO_THREE_D==e:i.disable()}}switch(!0){case t.direction.TO_TWO_D==e:$("[data-no-3d]").removeClass(TC.Consts.classes.HIDDEN);t.ctrlsToMng.forEach(function(e){e._$div.removeClass(TC.Consts.classes.THREED)});break;case t.direction.TO_THREE_D==e:$("[data-no-3d]").addClass(TC.Consts.classes.HIDDEN);t.ctrlsToMng.forEach(function(e){e._$div.addClass(TC.Consts.classes.THREED)})}t.map3D.linked2DControls.legend=new TwoDLinkedLegend(t)},C=function(){for(var e=this,t=new $.Deferred,o=[],r=0;r<e.threeDControls.length;r++){var i=e.threeDControls[r];i=i.substr(0,1).toUpperCase()+i.substr(1);var n=e.map.getControlsByClass("TC.control."+i);n&&n.length&&n[0].getLayer?o.push(n[0].getLayer()):n[0].layer?o.push(n[0].layer):n[0].layers&&n[0].layers.forEach(function(e){e instanceof TC.layer.Vector&&o.push(e)})}$.when.apply($,o).then(function(){if(arguments&&arguments.length){e.map3D.vector2DLayers=Array.prototype.slice.call(arguments,0).filter(function(e){return e instanceof TC.layer.Vector});e.map3D.vector2DLayers.forEach(function(t){t.features&&t.features.length&&t.features.forEach(function(t){e.map3D.addFeature.call(e,t)})})}t.resolve()});return t},T=function(e){var t,o,r,i=this,n=200,a=function(e){var t=this,o=new Cesium.Cartesian2(t.viewer.scene.canvas.clientWidth/2,t.viewer.scene.canvas.clientHeight/2);t.map3D.zoomToCartesian.call(t,{endPosition:o},e)};if(e){t=function(e){var t=this;e.stopPropagation&&e.stopPropagation();e.preventDefault&&e.preventDefault();var o=TC.Util.reproject(t.map.options.initialExtent.slice(0,2),t.map.crs,t.map3D.crs),r=TC.Util.reproject(t.map.options.initialExtent.slice(2),t.map.crs,t.map3D.crs),i=Cesium.Rectangle.fromDegrees(o[0],o[1],r[0],r[1]);t.map3D.flyToRectangle.call(t,i,{duration:.1});return!1}.bind(i);o=function(e){a.call(i,n)}.bind(i);r=function(e){a.call(i,-n)}.bind(i);$("."+TC.control.NavBar.prototype.CLASS+"-btn-home").on("click",t);$("."+TC.control.NavBar.prototype.CLASS+"-btn-zoomin").on("click",o);$("."+TC.control.NavBar.prototype.CLASS+"-btn-zoomout").on("click",r)}else{$("."+TC.control.NavBar.prototype.CLASS+"-btn-home").off("click",t);$("."+TC.control.NavBar.prototype.CLASS+"-btn-zoomin").off("click",o);$("."+TC.control.NavBar.prototype.CLASS+"-btn-zoomout").off("click",r)}};return{crs:"EPSG:4326",crsPattern:/(EPSG\:?4326)/i,customRender:null,baseLayer:null,workLayers:[],vector2DLayers:[],vector2DFeatures:{},linked2DControls:{},isLoadingTiles:function(){var e=this,t=e.viewer.scene.globe._surface;return!t._tileProvider.ready||t._tileLoadQueueHigh.length>0||t._tileLoadQueueMedium.length>0||t._tileLoadQueueLow.length>0||t._debug.tilesWaitingForChildren>0},loadTerrainProvider:function(){var e=this;e.terrainProvider||(e.terrainProvider=new Cesium.CesiumTerrainProvider({url:e.Consts.TERRAIN_URL,requestWaterMask:!0,requestVertexNormals:!0}));return e.terrainProvider},loadViewer:function(){var e=this,t=new $.Deferred;e.viewer?t.resolve(e.viewer):g().then(function(){var o=new Cesium.Globe;o.baseColor=Cesium.Color.WHITE;o.enableLighting=!0;e.viewer=e.map3D.viewer=new Cesium.Viewer(e.selectors.divThreedMap,{terrainProvider:e.map3D.loadTerrainProvider.call(e),terrainExaggeration:1,terrainShadows:Cesium.ShadowMode.ENABLED,animation:!1,timeline:!1,fullscreenButton:!1,baseLayerPicker:!1,imageryProvider:!1,navigationInstructionsInitiallyVisible:!1,navigationHelpButton:!1,geocoder:!1,homeButton:!1,infoBox:!1,sceneModePicker:!1,selectionIndicator:!1,globe:o,useDefaultRenderLoop:!e.options.customRender});if(e.options.customRender){e.map3D.customRender=new CustomRender(e.map,e.viewer,e.isSlower);e.map3D.customRender.start(e.options.isDebug||!1);e.map3D.customRender.parent=e}e.viewer.readyPromise=new $.Deferred;e.viewer.scene.backgroundColor=Cesium.Color.WHITE;e.viewer.scene.screenSpaceCameraController.enableCollisionDetection=!0;e.viewer.scene.screenSpaceCameraController.maximumZoomDistance=5e5;e.viewer.scene.globe.depthTestAgainstTerrain=!0;e.viewer.scene.imageryLayers.removeAll();e.viewer.terrainProvider.errorEvent.addEventListener(function(e){if(e.error)switch(e.error.statusCode){case 403:case 404:}},e);e.viewer.scene.renderError.addEventListener(function(e){var t=this;t.$divThreedMap.addClass(t.classes.LOADING);t.map.toast("Error",{type:TC.Consts.msgType.ERROR})},e);e.map3D.tileLoadingHandler=new Cesium.EventHelper;e.map3D.tileLoadingHandler.add(e.viewer.scene.globe.tileLoadProgressEvent,function(t){e.waiting||(e.waiting=e.map.getLoadingIndicator().addWait());if(0===t){e.map.getLoadingIndicator().removeWait(e.waiting);delete e.waiting;e.viewer.readyPromise.resolve();e.$events.trigger(TC.Consts.event.TERRAINLOADED,{})}else e.$events.trigger(TC.Consts.event.TERRAINRECEIVING,{})}.bind(e));d.call(e);T.call(e,!0);$(".cesium-viewer-bottom").remove();e.map3D._event2DHandler=m.bind(e);e.map.on(y.join(" "),e.map3D._event2DHandler);v.call(e,e.direction.TO_THREE_D);C.call(e);t.resolve(e.viewer)});return t},setBaseLayer:function(i){var n=this;if(n.map3D.baseLayer){if(n.map3D.baseLayer!==n.Consts.BLANK_BASE){n.viewer.scene.imageryLayers.raiseToTop(n.map3D.baseLayer);n.viewer.scene.imageryLayers.remove(n.map3D.baseLayer,!0)}if(i instanceof TC.layer.Vector){n.map3D.baseLayer=n.Consts.BLANK_BASE;n.map.getLoadingIndicator().removeWait(n.waiting);delete n.waiting}else{if(null!=(obj=t.findById(i.id))){$.extend(obj,{map:n.map});i=new TC.layer.Raster(obj);i.isBase=!0}n.map3D.addLayer.call(n,i)}}else{o.call(n,n.map);r.call(n,n.map);if(i instanceof TC.layer.Raster){
if(i.options.relatedWMTS){n.map.baseLayer=i=n.map.getLayer(i.options.relatedWMTS);n.map.$events.trigger($.Event(TC.Consts.event.BASELAYERCHANGE,{layer:n.map.baseLayer}))}else if(null!=(obj=t.findById(n.map.baseLayer.id))){$.extend(obj,{map:n.map});i=new TC.layer.Raster(obj);i.isBase=!0}n.map3D.addLayer.call(n,i)}else n.map3D.baseLayer=n.Consts.BLANK_BASE}e.baseMap=n.map.baseLayer},addLayer:function(e){var t=this;switch(!0){case TC.Consts.layerType.VECTOR==e.type:t.map3D.vector2DLayers.push(e);break;case TC.Consts.layerType.WMTS==e.type:case TC.Consts.layerType.WMS==e.type:if(s.isCompatible(e)){var o=s.convert(e);if(o){var r=t.viewer.scene.imageryLayers.addImageryProvider(o);if(e.isBase){t.map3D.baseLayer=r;t.viewer.scene.imageryLayers.lowerToBottom(r)}else{r.show=e.getVisibility();r.alpha=e.getOpacity();t.map3D.workLayers.push(r);t.map3D.linked2DControls.legend.refresh()}}}else t.map.toast(t.getLocaleString("threed.crsNoCompatible",{name:e.layerNames}))}},removeLayer:function(e){var t=this;switch(!0){case TC.Consts.layerType.VECTOR==e.type:if(t.map3D.vector2DFeatures&&t.map3D.vector2DFeatures.hasOwnProperty(e.id)){for(var o=t.map3D.vector2DFeatures[e.id],r=0;r<o.length;r++)t.map3D.removeFeature.call(t,o[r]);delete t.map3D.vector2DFeatures[e.id]}break;case TC.Consts.layerType.WMTS==e.type:case TC.Consts.layerType.WMS==e.type:for(var r=0;r<t.map3D.workLayers.length;r++)if(e.names&&t.map3D.workLayers[r].imageryProvider.layers.join(",")===e.names.join(",")||e.title&&t.map3D.workLayers[r].imageryProvider.layers.join(",")===e.title){t.viewer.scene.imageryLayers.raiseToTop(t.map3D.workLayers[r]);t.viewer.scene.imageryLayers.remove(t.map3D.workLayers[r],!0);t.map3D.workLayers.splice(r,1);break}}},setRenderOptionsLayer:function(e,t){var o=this;switch(!0){case TC.Consts.layerType.Vector==e.type:if(o.map3D.vector2DFeatures[e.id])for(var r=o.map3D.vector2DFeatures[e.id],i=0;i<r.length;i++)o.map3D.setRenderOptionsFeature(r[i],{show:!r[i].show});break;case TC.Consts.layerType.WMTS==e.type:case TC.Consts.layerType.WMS==e.type:for(var i=0;i<o.map3D.workLayers.length;i++)if(e.names&&o.map3D.workLayers[i].imageryProvider.layers.join(",")===e.names.join(",")||e.title&&o.map3D.workLayers[i].imageryProvider.layers.join(",")===e.title){t.hasOwnProperty("visibility")&&(o.map3D.workLayers[i].show=t.visibility);t.hasOwnProperty("opacity")&&(o.map3D.workLayers[i].alpha=t.opacity);break}}},flyToMapCoordinates:function(e){var t=this,o=TC.Util.reproject(e,t.map.crs,t.map3D.crs),r=t.viewer.camera.positionCartographic.height,i=Cesium.Cartesian3.fromDegrees(o[0],o[1],r),n=t.viewer.camera;n.flyTo({destination:i,orientation:{heading:n.heading,pitch:n.pitch}})},flyToRectangle:function(e,t){var o=this,r=$.Deferred();t=t||{};var i=Cesium.Math.EPSILON3;if(e.east===e.west){e.east+=i;e.west-=i}if(e.north===e.south){e.north+=i;e.south-=i}var n=.2,a=e.width*n/2,l=e.height*n/2;e.east-=a;e.west+=l;e.north+=l;e.south-=l;var s=o.viewer.scene,p=s.camera,c=p.getRectangleCameraCoordinates(e),g=Cesium.Ellipsoid.WGS84.cartesianToCartographic(c),d=s.globe.terrainProvider,h=6,f=[Cesium.Rectangle.center(e)];Cesium.sampleTerrain(d,h,f).then(function(i){var n={longitude:g.longitude,latitude:g.latitude,height:g.height+i[0].height},a=Cesium.Ellipsoid.WGS84.cartographicToCartesian(n);o.$events.one(TC.Consts.event.TERRAINLOADED,function(){var t=p.getRectangleCameraCoordinates(e),i=Cesium.Ellipsoid.WGS84.cartesianToCartographic(t),n=o.viewer.scene.globe.getHeight(i),a={longitude:i.longitude,latitude:i.latitude,height:i.height+n},l=Cesium.Ellipsoid.WGS84.cartographicToCartesian(a);p.flyTo({duration:3,destination:l,complete:function(){var e=Cesium.Math.toRadians(50),t=u(this.viewer.scene);t=Cesium.Matrix4.fromTranslation(t);this.map3D.rotateAroundAxis(this.viewer.scene.camera,-e,this.viewer.scene.camera.right,t,{duration:250,callback:function(){r.resolve()}})}.bind(o)})});p.flyTo({duration:t.duration||1,destination:a,complete:function(){o.map3D.isLoadingTiles.call(o)||o.$events.trigger(TC.Consts.event.TERRAINLOADED,{})}})});return r},zoomToCartesian:function(e,t){var o=this,r=o.viewer.scene;if(!e||!e.endPosition){var i=r.canvas,n=new Cesium.Cartesian2(i.clientWidth/2,i.clientHeight/2);e={endPosition:n}}var a=r.camera.getPickRay(e.endPosition),l=r.globe.pick(a,r);if(l){var s=Cesium.Cartesian3.distance(a.origin,l);if(1>s)return;o.map3D._zoomTo||(o.map3D._zoomTo={amount:0});o.map3D._zoomTo.direction=t>0?1:0;o.map3D._zoomTo.amount+=5*s/100;o.map3D._zoomTo.endPosition=e.endPosition}var p=function(t){var o=this,r=o.viewer.scene,i=r.camera.getPickRay(e.endPosition||t.endPosition),n=r.globe.pick(i,r);if(n){var a=Cesium.Cartesian3.distance(i.origin,n);if(1>a)return;var l=r.camera.position,s=(r.camera.direction,toGo=new Cesium.Cartesian3);Cesium.Cartesian3.multiplyByScalar(i.direction,1==t.direction?t.amount:-t.amount,s);Cesium.Cartesian3.add(l,s,toGo);var p=new Cesium.Ray(toGo,i.direction),c=r.globe.pick(p,r);if(c){var u=function(){this.map3D._zoomTo={direction:1,amount:0,endPosition:{}}};Cesium.Cartesian3.distance(toGo,c)<1||Math.abs(Cesium.Ellipsoid.WGS84.cartesianToCartographic(toGo).height)<r.screenSpaceCameraController.minimumZoomDistance?u.call(o):o.viewer.camera.flyTo({destination:toGo,orientation:{heading:r.camera.heading,pitch:r.camera.pitch,roll:r.camera.roll},duration:1,easingFunction:Cesium.EasingFunction.LINEAR_NONE,complete:function(e){this.map3D._zoomTo={direction:1,amount:0,endPosition:{}}}.bind(o,Cesium.Cartesian3.distance(toGo,c))})}}};setTimeout(function(){p.call(o,o.map3D._zoomTo)}.bind(o),50)},rotateAroundAxis:function(e,t,o,r,i){return l(e,t,o,r,i)},addFeature:function(e,t){var o=this;if(!(o.map3D.linked2DControls.featureInfo&&e.layer===o.map3D.linked2DControls.featureInfo.layer&&e instanceof TC.feature.Marker)&&o.map3D.vector2DLayers.indexOf(e.layer)>-1){var r=p.convert(o.viewer.scene,e,o.map.crs,o.map3D.crs);if(r)if(r.geometry instanceof Array)r.geometry.forEach(function(t){t=h.call(o,t);f(o.map3D,e.layer.id,t)});else{var i=h.call(o,r.geometry);f(o.map3D,e.layer.id,i)}}},removeFeature:function(e){var t=this;if(e){switch(!0){case e instanceof Cesium.GroundPrimitive:t.viewer.scene.groundPrimitives.remove(e);break;case e instanceof Cesium.Billboard:t.viewer.billboardCollection.remove(e);break;case e instanceof Object:t.viewer.entities.removeById(e.id)}t.map3D.customRender.restart()}},setRenderOptionsFeature:function(e,t){e&&(e.show=t.show)},addNativeFeature:function(e){return h.call(this,e)},setCameraFromMapView:function(){var e=this,t=e.mapView.getCenter();if(t){var o=TC.Util.reproject(t,e.map.crs,e.map3D.crs),r=n.call(e,e.mapView.getResolution()||0,Cesium.Math.toRadians(o[0])),o=TC.Util.reproject(t,e.map.crs,e.map3D.crs),i=new Cesium.Cartographic(Cesium.Math.toRadians(o[0]),Cesium.Math.toRadians(o[1]));e.viewer.scene.globe&&(i.height=e.viewer.scene.globe.getHeight(i)||0);var a=Cesium.Ellipsoid.WGS84.cartographicToCartesian(i),l={pitch:Cesium.Math.toRadians(-90),heading:-e.mapView.getRotation(),roll:0};e.viewer.camera.setView({destination:a,orientation:l});e.viewer.camera.moveBackward(r)}},setViewFromCameraView:function(){var e=this;if(!e.setViewFromCameraViewInProgress||"resolved"==e.setViewFromCameraViewInProgress.state()){e.setViewFromCameraViewInProgress=new $.Deferred;{var t=Cesium.Ellipsoid.WGS84,o=e.viewer.scene;target_=c(o)}if(!target_){var r=e.viewer.scene.globe,i=e.viewer.camera.positionCartographic.clone(),n=r.getHeight(i);i.height=n||0;target_=Cesium.Ellipsoid.WGS84.cartographicToCartesian(i)}var l=Cesium.Cartesian3.distance(target_,e.viewer.camera.position),s=t.cartesianToCartographic(target_),p=TC.Util.reproject([Cesium.Math.toDegrees(s.longitude),Cesium.Math.toDegrees(s.latitude)],e.map3D.crs,e.map.crs);e.mapView.setCenter(p);e.mapView.setResolution(a.call(e,l,s?s.latitude:0));e.setViewFromCameraViewInProgress.resolve()}return e.setViewFromCameraViewInProgress},getInfoOnPickedPosition:function(e){var t=this;if(e){t.map.one(TC.Consts.event.DRAWTABLE,function(e){t.map.getLoadingIndicator().removeWait(t.waiting);delete t.waiting});t.map3D.linked2DControls.featureInfo.send.call(t,e).then(function(e){t.map.getLoadingIndicator().removeWait(t.waiting);delete t.waiting})}},destroy:function(){var t=this;t.map3D.customRender.stop();t.map3D.vector2DLayers=[];t.map3D.vector2DFeatures={};t.map.off(y.join(" "),t.map3D._event2DHandler);v.call(t,t.direction.TO_TWO_D);T.call(t,!1);i();t.map.baseLayer=e.baseMap==t.Consts.BLANK_BASE?e.baseVector:e.baseMap;t.map.$events.trigger($.Event(TC.Consts.event.BASELAYERCHANGE,{layer:t.map.baseLayer}));e.baseMap="";t.map3D.baseLayer=null;t.map3D.workLayers=[];t.cameraControls.unbind();t.map3D.linked2DControls.featureInfo&&t.map3D.linked2DControls.featureInfo.clear(t.map);t.map3D.tileLoadingHandler.removeAll();delete t.map3D.tileLoadingHandler}}}();e.browserSupportWebGL=function(){var e=this,t=!1;if(window.WebGLRenderingContext){var o=document.createElement("canvas"),r={alpha:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};try{var i=o.getContext("webgl",r)||o.getContext("experimental-webgl",r)||o.getContext("webkit-3d",r)||o.getContext("moz-webgl",r);if(i)t=!0;else{r.failIfMajorPerformanceCaveat=!1;i=o.getContext("webgl",r)||o.getContext("experimental-webgl",r)||o.getContext("webkit-3d",r)||o.getContext("moz-webgl",r);if(i){t="slow";e.isSlower=!0}else t=!1}}catch(n){console.log(E)}if("slow"===t||!t){var a="slow"===t?"threed.slowSupport.supported":"threed.not.supported";e.map.toast(e.getLocaleString(a),{type:TC.Consts.msgType.WARNING,duration:1e4})}return t}t=!1}}();TC.layer=TC.layer||{};TC.Layer||TC.syncLoadJS(TC.apiLocation+"TC/Layer");TC.Consts.BLANK_IMAGE="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7";!function(){var e=function(){this.strategy;this.setStrategy=function(e){this.strategy=e};this.query=function(e,t,o,r){return this.strategy.query(e,t,o,r)}},t=function(){this.query=function(e,t,o,i){t.usesSSL=TC.Util.isSecureURL(e);r(e).then(o,function(n,a,l){if(n.status)i(t,a+"]["+l);else{t.usesProxy=!0;r(e,!0).then(function(e){o(e)},function(e,o,r){i(t,o+"]["+r)})}})}},o=function(){var e=function(e){var t=$.Deferred();$.ajax({type:"GET",url:e,dataType:"jsonp",success:function(e){t.resolve(!1)},error:function(e,o,r){t.resolve(e.status&&200===e.status&&"parsererror"!==o?!0:!1)}});return t};this.query=function(t,o,i,n){var a=t.replace(/^(f|ht)tp?:\/\//i,"https://");r(a).then(function(e){o.usesSSL=!0;i(e)},function(l,s,p){l.status?r(t,!0).then(function(e){o.usesProxy=!0;o.usesSSL=!0;i(e)},function(e,t,r){n(o,t+"]["+r)}):TC.isUsingServiceWorker&&TC.isUsingServiceWorker()?r(t,!0).then(function(e){o.usesProxy=!0;o.usesSSL=!1;i(e)},function(e,t,r){n(o,t+"]["+r)}):e(a).then(function(e){e?r(t,!0).then(function(e){o.usesProxy=!0;o.usesSSL=TC.Util.isSecureURL(t);i(e)},function(e,t,r){n(o,t+"]["+r)}):r(t,!0).then(function(e){o.usesProxy=!1;o.usesSSL=!1;i(e)},function(e,t,r){n(o,t+"]["+r)})})})}},r=function(e,t){var o=TC._capabilitiesRequests[e]=!t&&TC._capabilitiesRequests[e]||$.ajax({url:t?TC.proxify(e):e,type:"GET",dataType:n?"text":"xml"});return o},i={},n=window.hasOwnProperty("Worker"),a=$.Deferred();if(n){var l=TC.apiLocation+"TC/workers/tc-caps-web-worker.js";TC.Util.isSameOrigin(TC.apiLocation)?a.resolve(l):$.ajax({url:l,type:"GET",dataType:"text"}).then(function(e){var t=new Blob([e],{type:"text/javascript"}),o=window.URL.createObjectURL(t);a.resolve(o)},function(e){a.reject()})}var s=function(e,t,o){var r=e.url,n=!1,a=i[r];if(a){e._capabilitiesPromise=a;n=!0}else e._capabilitiesPromise=a=i[r]=$.Deferred();a.then(function(t){if(t.error)c(e,t.error);else{e.capabilities=e.capabilities||t;var o=e.getGetMapUrl();TC.capabilities[e.options.url]=TC.capabilities[e.options.url]||t;TC.capabilities[o]=TC.capabilities[o]||t;t.usesProxy&&(e.usesProxy=!0);t.usesSSL&&(e.usesSSL=!0);d(e)}});if(!n){TC.loadJS(!window.localforage,[TC.Consts.url.LOCALFORAGE],function(){localforage.getItem(e.CAPABILITIES_STORE_KEY_PREFIX+r).then(function(t){t&&i[e.url].resolve(t)})});var l,s={};if(e.type===TC.Consts.layerType.WMTS)if(e.options.encoding===TC.Consts.WMTSEncoding.RESTFUL){var u="/1.0.0/WMTSCapabilities.xml";if(r.indexOf(u)<r.length-u.length){"/"===r[r.length-1]&&(u=u.substr(1));l=r+u}else l=r}else{l=r;s.SERVICE="WMTS";s.VERSION="1.0.0";s.REQUEST="GetCapabilities"}else{l=r;s.SERVICE="WMS";s.VERSION="1.3.0";s.REQUEST="GetCapabilities"}l=l+"?"+$.param(s);TC._capabilitiesRequests=TC._capabilitiesRequests||{};TC.isUsingServiceWorker=null;if(!TC.isUsingServiceWorker){var g=e.map||$("#map").data("map"),h=g?g.getControlsByClass("TC.control.SWCacheClient"):null;TC.isUsingServiceWorker=h&&h.length>0?function(){return"pending"!==h[0].getServiceWorker().state()?h[0].serviceWorkerEnabled:!1}:function(){return!1}}p(l,e,t,o)}},p=function(r,i,n,a){var l=new e,s=function(e){n(i,e)};l.setStrategy(TC.Util.isSecureURL(document.location.href)&&!TC.Util.isSecureURL(r)?new o:new t);l.query(r,i,s,a)},c=function(e,t){var o="No se pudo obtener el documento de capacidades de servicio "+e.url+": ["+t+"]";e._capabilitiesPromise.reject(o);TC.error(o);e.map&&e.map.$events.trigger($.Event(TC.Consts.event.LAYERERROR,{layer:e,reason:"couldNotGetCapabilities"}));e.wrap.setLayer(null)},u=function(e,t){TC.loadJS(!window.localforage,[TC.Consts.url.LOCALFORAGE],function(){var o=e.CAPABILITIES_STORE_KEY_PREFIX+e.options.url,r=function(){localforage.setItem(o,t)};e.map?e.map.loaded(r):r()})},g=function(e,t){var o;if(t.documentElement){if($(t).find("ServiceException").length>0)o={error:$(t).find("ServiceException").text()};else{var r=e.type===TC.Consts.layerType.WMTS?new e.wrap.WmtsParser:new e.wrap.WmsParser;o=r.read(t);e.type===TC.Consts.layerType.WMTS&&o.Contents&&o.Contents.Layer&&$("Layer",t).each(function(e,t){var r=TC.Util.getElementByNodeName(t,"ows:Identifier")[0],i=r.firstChild.data,n=$(t),a=o.Contents.Layer.filter(function(e){return e.Identifier==i});if(a.length){a=a[0];for(var l=0;l<a.TileMatrixSetLink.length;l++){var s=a.TileMatrixSetLink[l];matrixId=s.TileMatrixSet;xmlLink=n.find("TileMatrixSetLink").each(function(e,t){return $(t).find("TileMatrixSet:first").text()==matrixId});if(xmlLink.length){xmlLink=xmlLink[0];s.TileMatrixSetLimits=[];$(xmlLink).find("TileMatrixLimits").each(function(e,t){var o=$(t);s.TileMatrixSetLimits.push({TileMatrix:o.find("TileMatrix").text(),MinTileRow:parseInt(o.find("MinTileRow").text()),MinTileCol:parseInt(o.find("MinTileCol").text()),MaxTileRow:parseInt(o.find("MaxTileRow").text()),MaxTileCol:parseInt(o.find("MaxTileCol").text())})})}}}})}e.usesProxy&&(o.usesProxy=!0);i[e.url].resolve(o);u(e,o)}else if(n&&"string"==typeof t)a.then(function(r){var n=new Worker(r);n.onmessage=function(t){o="success"===t.data.state?t.data.capabilities:{error:"Web worker error"};e.usesProxy&&(o.usesProxy=!0);e.usesSSL&&(o.usesSSL=!0);i[e.url].resolve(o);n.terminate();u(e,o)};n.postMessage({type:e.type,text:t})});else{o=t;e.usesProxy&&(o.usesProxy=!0);i[e.url].resolve(o)}},d=function(e){var t;if(!e.wrap.layer){switch(e.type){case TC.Consts.layerType.GROUP:break;case TC.Consts.layerType.WMTS:t=f(e);break;default:t=h(e)}e.wrap.setLayer(t)}},h=function(e){var t=$.isArray(e.names)?e.names.join(","):e.names,o=e.options.format,r=e.options,i={LAYERS:t,FORMAT:o,TRANSPARENT:e.transparent,VERSION:e.capabilities.version||"1.3.0"};e.params&&$.extend(i,e.params);var n=e.getPreferredInfoFormat();null!==n&&(i.INFO_FORMAT=n);return e.wrap.createWmsLayer(e.url,i,r)},f=function(e){return e.wrap.createWmtsLayer(e.options.matrixSet,e.names[0],e.options)},y=function A(e,t){var o=$.inArray(t.name,e.availableNames);if(-1===o)for(var r=0,i=t.children.length;i>r;r++){o=A(e,t.children[r]);if(-1!==o)break}return o},m=function b(e,t){var o=function(t,o){return y(e,o)-y(e,t)};t.children.sort(o);for(var r=0,i=t.children.length;i>r;r++)b(e,t.children[r])},v=function M(e,t,o){var r=!1;o.count=o.count+1;if(e.name===t)r=!0;else for(var i=e.children.length-1;i>=0;i--)if(M(e.children[i],t,o)){r=!0;break}return r};TC.layer.Raster=function(){var e=this;this._capabilitiesPromise=null;TC.Layer.apply(e,arguments);e.wrap=new TC.wrap.layer.Raster(e);e.transparent=e.options.transparent===!1?!1:!0;e.url=e.options.url;e.params=e.options.params;if("string"==typeof e.options.layerNames)e.names=e.availableNames=e.options.layerNames.split(",");else{e.names=[];e.availableNames=[];if($.isArray(e.options.layerNames))for(var t=0;t<e.options.layerNames.length;t++){var o=e.options.layerNames[t];if("string"==typeof o){e.names.push(o);e.availableNames.push(o)}else if(o.hasOwnProperty("name")){e.availableNames.push(o.name);(void 0===o.isVisible||o.isVisible)&&e.names.push(o.name)}}else{var r=e.options.params?e.options.params.sld_body:null;if(r){var i=$.parseXML(r),n=TC.Util.getElementByNodeName(i,"sld:NamedLayer");if(n&&n.length>0){var a=TC.Util.getElementByNodeName(n[0],"sld:Name");if(a&&a.length>0){var o=$(a[0]).text();e.names.push(o);e.availableNames.push(o)}}}}}e.ignorePrefixes=void 0===e.options.ignorePrefixes?!0:e.options.ignorePrefixes;e._capabilitiesNodes={};s(e,g,c);e._disgregatedLayerNames=null;TC.Consts.layerType.WMTS==e.type&&e.wrap.setWMTSUrl()};TC.inherit(TC.layer.Raster,TC.Layer);TC.layer.Raster.prototype.CAPABILITIES_STORE_KEY_PREFIX="TC.capabilities.";TC.layer.Raster.prototype.setVisibility=function(e){var t=this;t.tree=null;t._cache.visibilityStates={};TC.Layer.prototype.setVisibility.call(t,e)};var C=function(e){var t=e.layerNames,o=e.matrixSet,r=e.capabilities,i=[],n=r.Contents.TileMatrixSet.filter(function(e){return e.Identifier==o});if(n.length){n=n[0];var a=r.Contents.Layer.filter(function(e){return e.Identifier==t})[0];if(a.TileMatrixSetLink&&a.TileMatrixSetLink.length&&a.TileMatrixSetLink[0].TileMatrixSetLimits){for(var l,s=a.TileMatrixSetLink[0].TileMatrixSetLimits,p=0;p<s.length;p++){l=s[p];var c=n.TileMatrix.filter(function(e){return e.Identifier==l.TileMatrix});if(c.length){var u=$.extend({matrixIndex:n.TileMatrix.indexOf(c[0])},c[0],l);i.push(u)}}return i}return n.TileMatrix}return null},T=function(e,t){if(e.type!==TC.Consts.layerType.WMS)return t;var o=t.slice();_(e,o,e.wrap.getRootLayerNode());return o},_=function I(e,t,o){var r=!1,i=e.wrap.getLayerNodes(o);if(i.length){for(var n=0,a=i.length;a>n;n++)I(e,t,i[n])&&(r=!0);var l,s,p=$.map(i,function(t){return e.wrap.getName(t)}).reverse(),c=!1;s=l=$.inArray(p[0],t);if(0>l)c=!0;else for(var n=1,a=p.length;a>n;n++)if(p[n]!=t[++l]){c=!0;break}if(!c){var u=e.wrap.getName(o);if(u&&p.length>1){t.splice(s,p.length,u);r=!0}}}return r},S=function(e,t){for(var o=[],r=t.slice(),i=e.wrap.getRootLayerNode(),n=0,a=r.length;a>n;n++)o=o.concat(E(e,r[n],i));return o},E=function O(e,t,o,r){for(var i=[],n=e.wrap.getName(o),a=e.compareNames(t,n),l=!1,s=e.wrap.getLayerNodes(o),p=0;p<s.length;p++){var c=O(e,t,s[p],r||a);c.length?i=i.concat(c):l=!0}(!s.length||l)&&(r||a)&&(i=[n]);return i},x=function(e){return $.extend({aggregate:!0,lazy:!1},e)},P=function(e,t,o){var r,i,n,a=[];r=e?e:[];i=t?t:[];n=o?o:[];for(var l=r.concat(i),s=0;s<l.length;s++)$.inArray(l[s],l)===s&&-1===$.inArray(l[s],n)&&(a[a.length]=l[s]);return a},L=function(e,t){var o="string"==typeof t?t.split(","):t;if(e.capabilities){var r=e.getTree();o.sort(function(e,t){var o={count:0},i={count:0};v(r,e,o);v(r,t,i);return o.count-i.count})}return o},w=function(e,t,o,r){return $.grep(o,function(o){return e.compareNames(t,o,r)}).length>0};TC.layer.Raster.prototype.getLimitedMatrixSet=function(){return C(this)};TC.layer.Raster.prototype.setLayerNames=function(e,t){var o=this,r=new $.Deferred;$.when(o.wrap.getLayer()).then(function(){var i=$.isArray(e)?e:e.split(",");o.names=i;var n=x(t);n.aggregate&&(i=T(o,i));o._disgregatedLayerNames=null;var a={LAYERS:i.join(","),TRANSPARENT:!0};i.length||o.setVisibility(!1);if(n.lazy){var l=o._newParams||o.wrap.getParams();o._newParams=$.extend(l,a)}else{o.map&&o.map.$events.trigger($.Event(TC.Consts.event.BEFOREUPDATEPARAMS,{layer:o}));o.tree=null;o._cache.visibilityStates={};o.wrap.setParams(a);(n.reset||!o.map)&&(o.availableNames=o.names);o.map&&o.map.$events.trigger($.Event(TC.Consts.event.UPDATEPARAMS,{layer:o}))}r.resolve(o.names)});return r};TC.layer.Raster.prototype.addLayerNames=function(e,t){var o=this,r=new $.Deferred;$.when(o.wrap.getLayer()).then(function(){var i=x(t),n=$.isArray(e)?e:e.split(","),a=o.wrap.getParams().LAYERS;if(i.aggregate){n=S(o,n);a=o.getDisgregatedLayerNames()}$.when(o.setLayerNames(L(o,P(a,n,null)),t)).then(function(e){r.resolve(e)})});return r};TC.layer.Raster.prototype.removeLayerNames=function(e,t){var o=this,r=new $.Deferred;$.when(o.wrap.getLayer()).then(function(){var i=x(t),n=$.isArray(e)?e:e.split(","),a=o.wrap.getParams().LAYERS;if(i.aggregate){n=S(o,n);a=o.getDisgregatedLayerNames()}$.when(o.setLayerNames(L(o,P(a,null,n)),t)).then(function(e){r.resolve(e)})});return r};TC.layer.Raster.prototype.toggleLayerNames=function(e,t){var o=this,r=new $.Deferred;$.when(o.wrap.getLayer()).then(function(){var i=x(t),n=$.isArray(e)?e:e.split(","),a=o.wrap.getParams().LAYERS;if(i.aggregate){n=S(o,n);a=o.getDisgregatedLayerNames()}for(var l=[],s=[],p=0;p<n.length;p++){var c=n[p];$.inArray(c,a)<0?l[l.length]=c:s[s.length]=c}var u=[];l.length>0&&u.push(o.addLayerNames(l,i));s.length>0&&u.push(o.removeLayerNames(s,i));$.when.apply(this,u).then(function(e,t){r.resolve(e?t?e.concat(t):e:[])})});return r};TC.layer.Raster.prototype.getDisgregatedLayerNames=function(){var e=this,t=e.wrap.getLayer();if(e.wrap.isNative(t)&&e.type===TC.Consts.layerType.WMS){if(!e._disgregatedLayerNames){var o=e.wrap.getParams().LAYERS;o=$.isArray(o)?o:o.split(",");e._disgregatedLayerNames=S(e,o)}}else e._disgregatedLayerNames=e.names;return e._disgregatedLayerNames.slice()};TC.layer.Raster.prototype.isValidFromNames=function(){for(var e=this,t=!0,o=0,r=e.names.length;r>o;o++)if(!e.getLayerNodeByName(e.names[o])){t=!1;break}return t};TC.layer.Raster.prototype.isCompatible=function(e){var t=this,o=!1;switch(t.type){case TC.Consts.layerType.WMTS:case TC.Consts.layerType.WMS:o=t.wrap.isCompatible(e)}return o};TC.layer.Raster.prototype.isVisibleByScale=function(e,t){var o,r,i,n=this,a=function(){return n.map.wrap.getResolution()/28e-5};switch(n.type){case TC.Consts.layerType.WMTS:o=!1;var l=n.wrap.getTileMatrix(n.options.matrixSet);if(l){r=a();for(i=0;i<l.length;i++){var s=n.wrap.getScaleDenominators(l[i]);if(s[0]===r){o=!0;break}}}break;case TC.Consts.layerType.WMS:o=!0;var p=n.wrap.getAllLayerNodes();if(p.length>0){r=a();var c;if("number"==typeof e)c=n._capabilitiesNodes[e];else for(i=0;i<p.length;i++){var u=p[i];if(n.compareNames(n.wrap.getName(u),e,t)){c=u;break}}if(c){var s=n.wrap.getScaleDenominators(c);o=!(parseFloat(s[1])>r||parseFloat(s[0])<r)}}break;default:o=!0}return o};TC.layer.Raster.prototype.isVisibleByName=function(e,t){var o=this,r=!1;switch(o.type){case TC.Consts.layerType.WMTS:if(o.wrap.getWMTSLayer()){r=!0;break}break;case TC.Consts.layerType.WMS:var i=function(e){return n(e,o.wrap.getRootLayerNode())},n=function s(e,r){var i=null,n=o.wrap.getName(r);if(o.compareNames(n,e,t))i=[n];else for(var a=o.wrap.getLayerNodes(r),l=0;l<a.length;l++){var p=a[l],c=s(e,p);if(c){TC.Util.fastUnshift(c,n);i=c;break}}return i},a=i(e);if(a)for(var l=0;l<a.length;l++)if(w(o,a[l],o.names)){r=!0;break}break;default:r=!0}return r};TC.layer.Raster.prototype.getTree=function(){var e=this,t=e.tree,o=function(t,o){e.options.inverseTree?TC.Util.fastUnshift(t.children,o):t.children[t.children.length]=o};if(!t){var r,i=function l(t,i,n){var a;for(var s in e._capabilitiesNodes)if(e._capabilitiesNodes[s]===t){a=s;break}if(!a){a=TC.getUID();e._capabilitiesNodes[a]=t}var p={name:e.wrap.getName(t),title:t.title||t.Title,uid:a,children:[]};n&&(r=p);w(e,p.name,e.availableNames)&&(i=!0);if(e.options.isBase){p.name=e.names.join(",");p.title=e.title||p.title;p.isBase=e.isDefault;e.options.thumbnail&&(p.legend={src:e.options.thumbnail})}else{p.isVisible=p===r?e.getVisibility():e.isVisibleByName(p.name);var c,u=e.wrap.getLayerNodes(t);for(c=0;c<u.length;c++){var g=l(u[c],i);g&&o(p,g)}p.legend=e.wrap.getLegend(t);if(!i&&!n){r.children=r.children.concat(p.children);p=null}}return p};switch(e.type){case TC.Consts.layerType.WMTS:t=i(e.wrap.getWMTSLayer(),!e.options.hideTree,!0);break;case TC.Consts.layerType.WMS:if(e.capabilities){t=i(e.wrap.getRootLayerNode(),!e.options.hideTree,!0);var n=e._cache.visibilityStates,a=function s(e){var t=TC.Consts.visibility.NOT_VISIBLE;if(e){if(void 0!==n[e.uid])t=n[e.uid];else{if(e.children)for(var o=!1,r=!1,i=0,a=e.children.length;a>i;i++){var l=s(e.children[i]);switch(l){case TC.Consts.visibility.VISIBLE:o=!0;break;case TC.Consts.visibility.NOT_VISIBLE:r=!0;break;case TC.Consts.visibility.HAS_VISIBLE:o=!0;r=!0}o&&(t=r?TC.Consts.visibility.HAS_VISIBLE:TC.Consts.visibility.VISIBLE)}e.isVisible&&(t=TC.Consts.visibility.VISIBLE);n[e.uid]=t}e.visibilityState=t}return t};a(t);e.options.hideTree&&m(e,t)}}t||(t={name:e.name,title:e.title});t.title=e.title||t.title;e.tree=t}return t};TC.layer.Raster.prototype.setNodeVisibility=function(e,t){var o=this;o.tree||(o.tree=o.getTree());var r=function a(e){var t=[];if(e.name)t[0]=e.name;else for(var o=0;o<e.children.length;o++)t=t.concat(a(e.children[o]));return t},i=o.findNode(e,o.tree);if(i===o.tree)t&&0===o.names.length?o.addLayerNames(o.availableNames).then(function(){o.setVisibility(!0)}):o.setVisibility(t);else{var n=r(i);t?o.addLayerNames(n):o.removeLayerNames(n)}};TC.layer.Raster.prototype.getNodeVisibility=function(e){var t=this;t.tree||(t.tree=t.getTree());return t._cache.visibilityStates[e]};TC.layer.Raster.prototype.getNodePath=function(e,t){var o=this,r=[];if(o.type===TC.Consts.layerType.WMS&&o.capabilities){e=e||o.names[0];var i=function n(r){var i=[],a=o.wrap.getName(r);if(o.compareNames(a,e,t))i.push(r);else for(var l=o.wrap.getLayerNodes(r),s=0;s<l.length;s++){var p=n(l[s]);if(p.length){i=p;TC.Util.fastUnshift(i,r);break}}return i};r=i(o.wrap.getRootLayerNode())}return r};TC.layer.Raster.prototype.getPath=function(e,t){return $.map(this.getNodePath(e,t),function(e){return e.title||e.Title})};TC.layer.Raster.prototype.getLayerNodeByName=function(e){for(var t=null,o=this,r=o.wrap.getServiceType()===TC.Consts.layerType.WMTS?o.wrap.getIdentifier:o.wrap.getName,i=o.wrap.getAllLayerNodes(),n=0,a=i.length;a>n;n++)if(o.compareNames(r(i[n]),e)){t=i[n];break}return t};TC.layer.Raster.prototype.getChildrenLayers=function(e){var t=[],o=function(e,t){if(e&&e.Layer&&e.Layer.length)for(var r=0;r<e.Layer.length;r++){t[t.length]=e.Layer[r];o(e.Layer[r],t)}};o(e,t);return t};TC.layer.Raster.prototype.compareNames=function(e,t,o){var r=e===t,i=this,n=void 0!==o?o:i.ignorePrefixes;if(!r&&n&&e&&t){var a=e.indexOf(":"),l=t.indexOf(":");a>=0&&0>l?r=e.substr(a+1)===t:l>=0&&0>a&&(r=e===t.substr(l+1))}return r};TC.layer.Raster.prototype.getCapabilitiesPromise=function(){return this._capabilitiesPromise};TC.layer.Raster.prototype.getResolutions=function(){return this.wrap.getResolutions()};TC.layer.Raster.prototype.searchSubLayers=function(e){this.patternFn||(this.patternFn=function(e){e=e.replace(/[^a-z\u00e1\u00e9\u00ed\u00f3\u00fa\u00fc\u00f1 ]/gi,"\\$&");e=e.replace(/(a|\u00e1)/gi,"(a|\xe1)");e=e.replace(/(e|\u00e9)/gi,"(e|\xe9)");e=e.replace(/(i|\u00ed)/gi,"(i|\xed)");e=e.replace(/(o|\u00f3)/gi,"(o|\xf3)");e=e.replace(/(u|\u00fa|\u00fc)/gi,"(u|\xfa|\xfc)");e=e.replace(/(n|\u00f1)/gi,"(n|\xf1)");return e});if(e&&e.length&&e.length>=3){var t=this,o=null;if(this.lastPattern&&e.indexOf(this.lastPattern)>=0)o=this.lastMatches;else if(t.availableNames&&t.availableNames.length>0){o=[];for(var r=0;r<t.availableNames.length;r++){var i=t.getLayerNodeByName(t.availableNames[r]);if(i){o[o.length]=i;o=o.concat(t.getChildrenLayers(i))}}}else o=t.wrap.getAllLayerNodes();var n=this.patternFn(e),a=new RegExp(n,"i"),l=o.map(function(e,o){delete e.tcScore;e.tcPosition=o;t.wrap.normalizeLayerNode(e);var r=e.Title.trim(),i=a.exec(r),n=i?i.index:-1,l=-1;if(e.Abstract){var s=e.Abstract.trim(),p=a.exec(s);l=p?p.index:-1}i&&r==i[0]?e.tcScore=20:0==n?e.tcScore=15:n>-1?e.tcScore=10:0==l?e.tcScore=5:l>-1&&(e.tcScore=1);return e.tcScore?e:null}).filter(function(e){return null!=e}).sort(function(e,t){if(t.tcScore===e.tcScore){var o=TC.Util.replaceAccent(e.Title),r=TC.Util.replaceAccent(t.Title);return r>o?-1:o>r?1:0}return t.tcScore-e.tcScore});this.lastPattern=e;this.lastMatches=l;return l}return[]};var R=function(e){var t=e;if(e){var o=e.match(/\??SERVICE=\w+&/i);o&&(t=t.replace(o[0],""))}return t};TC.layer.Raster.prototype.getGetMapUrl=function(){return R(this.wrap.getGetMapUrl())};TC.layer.Raster.prototype.getPreferredInfoFormat=function(){for(var e=this,t=null,o=e.wrap.getInfoFormats(),r=0;r<TC.wrap.layer.Raster.infoFormatPreference.length;r++){var i=TC.wrap.layer.Raster.infoFormatPreference[r];if($.inArray(i,o)>=0){t=i;break}}return t};TC.layer.Raster.prototype.getLegendGraphicImage=function(){var e=this,t=$.Deferred();if(e.options.params.base64LegendSrc)return t.resolve(e.options.params.base64LegendSrc);if("function"==typeof window.btoa){for(var o=e.names[0],r=e.wrap.getInfo(o),i=new XMLHttpRequest,n=r.legend[0].src.split("?"),a=n[1].split("&"),l=e.options.params.sld_body?"sld_body="+e.options.params.sld_body:"",s=0;s<a.length;s++){var p=a[s].split("=");p&&p.length>1&&p[1]&&(l+="&"+a[s])}e.options.params.env&&(l+="&"+e.options.params.env);i.open("POST",n[0],!0);i.setRequestHeader("Content-Type","application/x-www-form-urlencoded");i.responseType="arraybuffer";i.onload=function(o){if(200===this.status){for(var r=new Uint8Array(this.response),n=r.length,a=new Array(n);n--;)a[n]=String.fromCharCode(r[n]);var l=a.join(""),s=i.getResponseHeader("content-type");if(0===s.indexOf("image")){var p;p="data:"+s+";base64,"+window.btoa(l);e.options.params.base64LegendSrc=p;t.resolve(p)}}};i.send(l)}else t.reject("Funci\xf3n window.btoa no soportada por el navegador");return t.promise()}}();var esriParser={parse:function(e){var t=[],o=(new DOMParser).parseFromString(e,"text/xml");if("FeatureInfoResponse"===o.documentElement.tagName)for(var r=o.documentElement.getElementsByTagName("FeatureInfoCollection"),i=0,n=r.length;n>i;i++)for(var a=r[i],l=a.getAttribute("layername"),s=a.getElementsByTagName("FeatureInfo"),p=0,c=s.length;c>p;p++){for(var u=s[p].getElementsByTagName("Field"),g={},d=0,h=u.length;h>d;d++){var f=u[d];g[getElementText(f.getElementsByTagName("FieldName")[0])]=getElementText(f.getElementsByTagName("FieldValue")[0])}var y=new ol.Feature(g);y.setId(l+"."+TC.getUID());t[t.length]=y}return t}};TC.layer.Raster.prototype.getWFSCapabilitiesPromise=function(){"undefined"==typeof WFSCapabilities&&TC.syncLoadJS(TC.apiLocation+"TC/layer/WFSCapabilitiesParser");var e=this.options.url.replace(/service=wms/i,"service=wfs").replace(/\/wms(\/|\?|\b)/i,"$'/wfs/"),t=$.Deferred(),o=e.substring(e.indexOf("://")<0?0:e.indexOf("://")+3);if(TC.WFScapabilities[o]){setTimeout(function(){t.resolve(TC.WFScapabilities[o])},100);return t}var r={};r.SERVICE="WFS";r.VERSION="2.0.0";r.REQUEST="GetCapabilities";$.ajax({url:this.usesProxy?TC.proxify(e+"?"+$.param(r)):this.usesSSL?e.replace(/^(f|ht)tp?:\/\//i,"https://")+"?"+$.param(r):e+"?"+$.param(r),type:"GET"}).then(function(){var e,r;r=jQuery.isXMLDoc(arguments[0])?arguments[0]:(new DOMParser).parseFromString(arguments[0],"text/xml");var i=$(r).find("ServiceException");0===i.length&&(i=$(r).find("ExceptionText"));if(i.length>0)t.reject(null,"error",i.html());else{try{e=WFSCapabilities.Parse(r)}catch(n){t.reject(n);return}if(e.Operations){var a=e.Operations.GetCapabilities.DCP&&e.Operations.GetCapabilities.DCP.HTTP.Get["xlink:href"]||e.Operations.GetCapabilities.DCPType[0].HTTP.Get.onlineResource;TC.WFScapabilities[a]=e;TC.WFScapabilities[o]=e;t.resolve(e)}else t.reject(null)}},function(e,o,r){t.reject(e,o,r)});return t};TC.layer=TC.layer||{};TC.Layer||TC.syncLoadJS(TC.apiLocation+"TC/Layer");TC.layer.Vector=function(){var e=this;TC.Layer.apply(e,arguments);e.type=e.options.type||TC.Consts.layerType.VECTOR;e.features=[];e.selectedFeatures=[];var t=function(e){var t=e.indexOf("?");

if(t>=0)e=e.substr(0,t);else{t=e.indexOf("#");t>=0&&(e=e.substr(0,t))}return".kml"===e.substr(e.length-4).toLowerCase()};if(e.url&&(t(e.url)||e.type===TC.Consts.layerType.KML)){e.type=TC.Consts.layerType.KML;var o=function(e){for(var t=e,o=new RegExp("([^/]+.kml)","i"),r=0;3>r;r++){e=decodeURIComponent(e);var i=o.exec(e);if(i.length>1){t=i[1];break}}return t};e.title=e.options.title||o(e.url)}e.wrap=new TC.wrap.layer.Vector(e);var r=e.wrap.createVectorLayer();e.wrap.setLayer(r)};TC.inherit(TC.layer.Vector,TC.Layer);!function(){var e=TC.layer.Vector.prototype;e.getTree=function(){var e=this,t=null;if(!e.options.stealth){t={};t.children=[];for(var o=0;o<e.features.length;o++){var r=e.features[o].getPath();if(r.length){var i=TC.Util.addArrayToTree(r,t);i&&(i.legend=e.features[o].getLegend())}}t.name=e.name||t.name;t.title=e.title||t.title;t.uid=e.id}return t};var t=function(e,t,o,r){var i=new $.Deferred;$.when(t.call(e,[o],r)).then(function(t){i.resolve(t[0]);e.map.$events.trigger($.Event(TC.Consts.event.FEATUREADD,{layer:e,feature:t[0]}))});return i},o=function(e,t,o,r,i){var n=new $.Deferred,a=e.options.styles&&e.options.styles[r]||TC.Cfg.styles[r],l=$.extend(!0,{},a,i);TC.loadJS(!TC.feature||TC.feature&&!TC.feature[o],[TC.apiLocation+"TC/feature/"+o],function(){for(var r=TC.feature[o],i=new Array(t.length),a=[],s=0,p=t.length;p>s;s++){var c,u=t[s];if(u instanceof r){c=u;c.layer=e}else{l.layer=e;c=new r(u,l)}i[s]=c;e.features[e.features.length]=c;c.wrap.isNative(u)||(a[a.length]=c.wrap.feature);c.options.showPopup&&c.showPopup()}a.length&&e.wrap.addFeatures(a);n.resolve(i)});return n};e.addPoint=function(e,o){return t(this,this.addPoints,e,o)};e.addPoints=function(e,t){return o(this,e,"Point",TC.Consts.geom.POINT,t)};e.addMarker=function(e,o){return t(this,this.addMarkers,e,o)};e.addMarkers=function(e,t){return o(this,e,"Marker","marker",t)};e.addPolyline=function(e,o){return t(this,this.addPolylines,e,o)};e.addPolylines=function(e,t){return o(this,e,"Polyline",TC.Consts.geom.POLYLINE,t)};e.addMultiPolyline=function(e,o){return t(this,this.addMultiPolylines,e,o)};e.addMultiPolylines=function(e,t){return o(this,e,"MultiPolyline",TC.Consts.geom.POLYLINE,t)};e.addPolygon=function(e,o){return t(this,this.addPolygons,e,o)};e.addPolygons=function(e,t){return o(this,e,"Polygon",TC.Consts.geom.POLYGON,t)};e.addMultiPolygon=function(e,o){return t(this,this.addMultiPolygons,e,o)};e.addMultiPolygons=function(e,t){return o(this,e,"MultiPolygon",TC.Consts.geom.POLYGON,t)};e.addCircle=function(e,o){return t(this,this.addCircles,e,o)};e.addCircles=function(e,t){return o(this,e,"Circle",TC.Consts.geom.POLYGON,t)};e.addFeature=function(e){var t,o=this;TC.feature&&(TC.feature.Point&&e instanceof TC.feature.Point?t=o.addPoint(e):TC.feature.Polyline&&e instanceof TC.feature.Polyline?t=o.addPolyline(e):TC.feature.Polygon&&e instanceof TC.feature.Polygon?t=o.addPolygon(e):TC.feature.MultiPolygon&&e instanceof TC.feature.MultiPolygon?t=o.addMultiPolygon(e):TC.feature.MultiPolyline&&e instanceof TC.feature.MultiPolyline?t=o.addMultiPolyline(e):TC.feature.Circle&&e instanceof TC.feature.Circle&&(t=o.addCircle(e)));return t};e.removeFeature=function(e){this.wrap.removeFeature(e)};e.getFeatureById=function(e){var t=null,o=this.wrap.getFeatureById(e);o&&(t=o._wrap.parent);return t};e.clearFeatures=function(){var e=this;if(e.features&&e.wrap){e.features.length=0;e.wrap.clearFeatures()}};e.describeFeatureType=function(e,t){var o=this,r=$.Deferred();$.ajax({url:o.wrap.getDescribeFeatureTypeUrl(),type:"GET",dataType:"xml"}).then(function(e){var t="http://www.w3.org/2001/XMLSchema",o=e.getElementsByTagNameNS(t,"complexType")[0];if(o){for(var i=o.getElementsByTagNameNS(t,"element"),n=new Array(i.length),a=0,l=i.length;l>a;a++){var s=i[a];n[a]={name:s.getAttribute("name"),type:s.getAttribute("type"),nillable:"true"===s.getAttribute("nillable")?!0:!1,minOccurs:parseInt(s.getAttribute("minOccurs")),maxOccurs:parseInt(s.getAttribute("maxOccurs"))}}r.resolve(n)}else{var p=e.getElementsByTagName("Exception")[0];p&&r.reject(p.getElementsByTagName("ExceptionText")[0].innerHTML)}},function(e,t,o){r.reject(o)});r.then(function(t){$.isFunction(e)&&e(t)},function(e){$.isFunction(t)&&t(e)});return r.promise()};e["import"]=function(e){this.wrap["import"](e)};e.setNodeVisibility=function(e,t){var o=this;o.state=TC.Layer.state.LOADING;o.map.$events.trigger($.Event(TC.Consts.event.BEFOREUPDATE));o.map.$events.trigger($.Event(TC.Consts.event.BEFORELAYERUPDATE,{layer:o}));o.tree||(o.tree=o.getTree());var r=o.findNode(e,o.tree);if(r===o.tree)o.setVisibility(t);else{var i=o._cache.visibilityStates;i[e]=t?TC.Consts.visibility.VISIBLE:TC.Consts.visibility.NOT_VISIBLE;var n,a,l=!1;for(n=0;n<o.features.length;n++){a=o.features[n];if(a.id==e){l=!0;a.setVisibility(t);break}}if(!l)for(n=0;n<o.features.length;n++){a=o.features[n];void 0===a._path&&(a._path="/"+a.getPath().join("/"));a._path===e&&a.setVisibility(t)}}o.state=TC.Layer.state.IDLE;o.map.$events.trigger($.Event(TC.Consts.event.LAYERUPDATE,{layer:o}));o.map.$events.trigger($.Event(TC.Consts.event.UPDATE))};e.getNodeVisibility=function(e){var t=this,o=TC.Layer.prototype.getNodeVisibility.call(t,e);t.tree||(t.tree=t.getTree());var r=t.findNode(e,t.tree);if(r===t.tree)o=t.getVisibility()?TC.Consts.visibility.VISIBLE:TC.Consts.visibility.NOT_VISIBLE;else{var i=t._cache.visibilityStates,n=i[e];void 0!==n&&(o=n)}return o};e.setModifiable=function(e){this.wrap.setModifiable(e)};e.applyEdits=function(e,t,o){return this.wrap.sendTransaction(e,t,o)};e.refresh=function(){return this.wrap.reloadSource()}}();var WFSCapabilities=function(){var e={V1_0_0:"1.0.0",V1_1_0:"1.1.0",V2_0_0:"2.0.0"},t=function(){var t,a=[],l=[],s=[],p=xml2json(arguments[0]);switch(p.version){case e.V1_0_0:t=e.V1_0_0;break;case e.V1_1_0:t=e.V1_1_0;break;case e.V2_0_0:t=e.V2_0_0}a=o(p,t),l=r(p,t),s=i(p,t);var c=n(p,t),u={Operations:a,FeatureTypes:l,Filters:s};return $.extend(u,c),u},o=function(t,o){switch(o){case e.V1_0_0:var r=t.Capability.Request;if(r.GetFeature){var i=[];for(var n in r.GetFeature.ResultFormat)i.push(n.toLowerCase());r.GetFeature.outputFormat=i,delete r.GetFeature.ResultFormat,r.GetFeature.Operations=t.FeatureTypeList.Operations}return r;case e.V1_1_0:return{};case e.V2_0_0:var a={};for(var n in t.OperationsMetadata){var l={};l[n]=t.OperationsMetadata[n];for(var s in l[n])l[n][s]&&l[n][s].hasOwnProperty("AllowedValues")&&(l[n][s]=l[n][s].AllowedValues.Value);$.extend(a,l)}return a}return null},r=function(t,o){switch(o){case e.V1_0_0:for(var r={},i=0;i<t.FeatureTypeList.FeatureType.length;i++){var n=t.FeatureTypeList.FeatureType[i].Name;r[n.substring(n.indexOf(":")+1)]=t.FeatureTypeList.FeatureType[i]}return r;case e.V1_1_0:return{};case e.V2_0_0:for(var r={},i=0;i<t.FeatureTypeList.FeatureType.length;i++){var n=t.FeatureTypeList.FeatureType[i].Name;r[n.substring(n.indexOf(":")+1)]=t.FeatureTypeList.FeatureType[i]}return r}return null},i=function(t,o){switch(o){case e.V1_0_0:return t.Filter_Capabilities;case e.V1_1_0:return{};case e.V2_0_0:var r=t.Filter_Capabilities;return r}return null},n=function(t,o){switch(o){case e.V1_0_0:var r={};for(var i in t)"string"==typeof t[i]&&(r[i]=t[i]);return r;case e.V1_1_0:return{};case e.V2_0_0:var r={};for(var i in t)"string"==typeof t[i]&&(r[i]=t[i]);return r}return{}},a=function(e){var e=e,t=$.Deferred(),o=e.substring(e.indexOf("://")<0?0:e.indexOf("://")+3);if(TC.capabilities[o])return t.resolve(TC.capabilities[o]),t;var r={};return r.SERVICE="WFS",r.VERSION="2.0.0",r.REQUEST="GetCapabilities",$.ajax({url:TC.proxify(e)+"?"+$.param(r),type:"GET"}).then(function(){var e=WFSCapabilities.Parse(arguments[0]),r=e.Operations.GetCapabilities.DCP&&e.Operations.GetCapabilities.DCP.HTTP.Get["xlink:href"]||e.Operations.GetCapabilities.DCPType[0].HTTP.Get.onlineResource;TC.capabilities[r]=e,TC.capabilities[o]=e,t.resolve(WFSCapabilities.Parse(arguments[0]))}),t};return{Promises:a,Parse:t}}(),TC=TC||{};TC.Geometry=TC.Geometry||{isPoint:function(e){return $.isArray(e)&&e.length>=2&&"number"==typeof e[0]&&"number"==typeof e[1]},isRing:function(e){return $.isArray(e)&&(0===e.length||TC.Geometry.isPoint(e[0]))},isRingCollection:function(e){return $.isArray(e)&&(0===e.length||TC.Geometry.isRing(e[0]))},isMultiRingCollection:function(e){return $.isArray(e)&&(0===e.length||TC.Geometry.isRingCollection(e[0]))},getNearest:function(e,t){return TC.wrap.Geometry.getNearest(e,t)},isInside:function t(e,o){var r=!1;if(TC.Geometry.isPoint(e))if(TC.Geometry.isPoint(o))r=e[0]===o[0]&&e[1]===o[1];else if(TC.Geometry.isRing(o))for(var i=0,n=o.length-1;i<o.length;n=i++){var a=o[i][0],l=o[i][1],s=o[n][0],p=o[n][1],c=l>e[1]!=p>e[1]&&e[0]<(s-a)*(e[1]-l)/(p-l)+a;c&&(r=!r)}else if(TC.Geometry.isRingCollection(o)&&o.length>0){if(t(e,o[0])){for(var u=!1,i=1;i<o.length;i++)if(t(e,o[i])){u=!0;break}u||(r=!0)}}else if(TC.Geometry.isMultiRingCollection(o)&&o.length>0)for(var i=0,g=o.length;g>i;i++)if(t(e,o[i])){r=!0;break}return r}};var SITNA=window.SITNA||{},TC=window.TC||{};TC.isDebug=!1;!function(){if(!window.TC||!window.TC.Cfg){var e,t;if(document.currentScript)t=document.currentScript;else{var o=document.getElementsByTagName("script");t=o[o.length-1]}var e=t.getAttribute("src");TC.apiLocation=e.substr(0,e.lastIndexOf("/")+1);var r=TC.apiLocation+(TC.isDebug?"tcmap.js":"tcmap.min.js"),i=new XMLHttpRequest;i.open("GET",r,!1);i.send(null);var n=document.getElementsByTagName("head")[0],t=document.createElement("script");t.type="text/javascript";t.text=i.responseText;n.appendChild(t)}}();SITNA.Map=function(e,t){var o,r,i=this,n=new TC.Map(e,t);i.addLayer=function(e,t){n.addLayer(e,t)};i.setBaseLayer=function(e,t){n.setBaseLayer(e,t)};i.addMarker=function(e,t){n.addMarker(e,t)};i.zoomToMarkers=function(e){n.zoomToMarkers(e)};i.loaded=function(e){n.loaded(e)};n.loaded(function(){o=new TC.control.Search;o.register(n);o.getLayer().then(function(e){r=e});if(!n.activeControl){var e=n.getControlsByClass("TC.control.FeatureInfo")[0];e&&e.activate()}});i.getQueryableData=function(e,t){var r=o.availableSearchTypes[e];if(r.queryableData)t&&t(r.queryableData);else{var i={request:"GetFeature",service:"WFS",typename:r.featurePrefix+":"+r.featureType,version:r.version,propertyname:(r.dataIdProperty instanceof Array?r.dataIdProperty:[r.dataIdProperty]).concat(r.outputProperties instanceof Array?r.outputProperties:[r.outputProperties]).join(","),outputformat:TC.Consts.format.JSON},n=r.url+"?"+$.param(i);$.ajax({url:n}).done(function(e){r.queryableData=[];if(e.features)for(var i=e.features,n=0;n<i.length;n++){var a=i[n],e={};e.id=[];r.dataIdProperty instanceof Array||(r.dataIdProperty=[r.dataIdProperty]);for(var l=0;l<r.dataIdProperty.length;l++)a.properties.hasOwnProperty(r.dataIdProperty[l])&&e.id.push(a.properties[r.dataIdProperty[l]]);e.id=e.id.join(r.idPropertiesIdentifier?r.idPropertiesIdentifier:"");e.label=[];r.outputProperties instanceof Array||(r.outputProperties=[r.outputProperties]);for(var s=0;s<r.outputProperties.length;s++)a.properties.hasOwnProperty(r.outputProperties[s])&&e.label.push(a.properties[r.outputProperties[s]]);var p=e.label instanceof Array&&e.label.join("").trim().length>0||!(e.label instanceof Array)&&e.label.trim().length>0;e.label=r.outputFormatLabel?r.outputFormatLabel.tcFormat(e.label):e.label.join("-");p&&r.queryableData.push(e)}r.queryableData=r.queryableData.sort(function(e,t){return(r.idPropertiesIdentifier?-1!=e.id.indexOf(r.idPropertiesIdentifier):1)?o.removePunctuation(e.label.split(" ")[0])<o.removePunctuation(t.label.split(" ")[0])?-1:o.removePunctuation(e.label.split(" ")[0])>o.removePunctuation(t.label.split(" ")[0])?1:0:o.removePunctuation(e.label)<o.removePunctuation(t.label)?-1:o.removePunctuation(e.label)>o.removePunctuation(t.label)?1:0});r.queryableData=r.queryableData.filter(function(e,t,o){return 1>t?!0:e.id!==o[t-1].id&&e.label!==o[t-1].label});t&&t(r.queryableData)})}};i.getMunicipalities=function(e){i.getQueryableData(SITNA.Consts.mapSearchType.MUNICIPALITY,e)};i.getUrbanAreas=function(e){i.getQueryableData(SITNA.Consts.mapSearchType.URBAN,e)};i.getCommonwealths=function(e){i.getQueryableData(SITNA.Consts.mapSearchType.COMMONWEALTH,e)};i.getCouncils=function(e){i.getQueryableData(SITNA.Consts.mapSearchType.COUNCIL,e)};i.searchCommonwealth=function(e,t){i.searchTyped(SITNA.Consts.mapSearchType.COMMONWEALTH,e,t)};i.searchCouncil=function(e,t){i.searchTyped(SITNA.Consts.mapSearchType.COUNCIL,e,t)};i.searchUrbanArea=function(e,t){i.searchTyped(SITNA.Consts.mapSearchType.URBAN,e,t)};i.searchMunicipality=function(e,t){i.searchTyped(SITNA.Consts.mapSearchType.MUNICIPALITY,e,t)};i.searchTyped=function(e,t,a){var l=TC.getUID(),s=o.availableSearchTypes[e];t instanceof Array&&s.goToIdFormat&&(t=s.goToIdFormat.tcFormat(t));o._search.data=o._search.data||[];o._search.data.push({dataLayer:s.featureType,dataRole:e,id:t,label:"",text:""});i.removeSearch();if(o.availableSearchTypes[e]&&!o.allowedSearchTypes[e]){o.allowedSearchTypes={};o.allowedSearchTypes[e]={};o.availableSearchTypes[e].hasOwnProperty("goTo")||(o.allowedSearchTypes[e]={goTo:function(){var r,a=function(e,t,o){return e[t][o]},p=function(e){var t=[];s.idPropertiesIdentifier&&(e=e.split(s.idPropertiesIdentifier));e instanceof Array||(e=[e]);for(var o=0;o<s.dataIdProperty.length;o++)t.push({name:s.dataIdProperty[o],value:e[o],type:TC.Consts.comparison.EQUAL_TO});return t},c={id:l,type:SITNA.Consts.layerType.WFS,url:s.url,version:s.version,stealth:!0,geometryName:"the_geom",featurePrefix:s.featurePrefix,featureType:s.featureType,properties:p(t),outputFormat:TC.Consts.format.JSON,styles:{polygon:{fillColor:a.bind(self,s.styles[s.featureType],"polygon","fillColor"),fillOpacity:a.bind(self,s.styles[s.featureType],"polygon","fillOpacity")},line:{strokeColor:a.bind(self,s.styles[s.featureType],"line","strokeColor"),strokeOpacity:a.bind(self,s.styles[s.featureType],"line","strokeOpacity"),strokeWidth:a.bind(self,s.styles[s.featureType],"line","strokeWidth")}}};n.addLayer(c).then(function(t){r=t;i.search={layer:t,type:e};delete o.allowedSearchTypes[e]});n.one(TC.Consts.event.FEATURESADD,function(e){if(e.layer==r&&e.layer.features&&e.layer.features.length>0){for(var t=0;t<e.layer.features.length;t++)e.layer.features[t].showsPopup!=o.queryableFeatures&&(e.layer.features[t].showsPopup=o.queryableFeatures);n.zoomToFeatures(e.layer.features)}})}})}n.one(TC.Consts.event.SEARCHQUERYEMPTY,function(e){n.toast(o.EMPTY_RESULTS_LABEL,{type:TC.Consts.msgType.INFO,duration:5e3});a&&a(null)});n.one(TC.Consts.event.FEATURESADD,function(t){t.layer==r&&t.layer.features&&t.layer.features.length>0&&n.zoomToFeatures(t.layer.features);i.search={layer:t.layer,type:e};a&&a(t.layer.id!==l?t.layer.id:l)});o.goToResult(t)};i.searchFeature=function(e,t,r,a){var l=TC.getUID(),s=o.featurePrefix;i.removeSearch();e=(e||"").trim();t=(t||"").trim();r=(r||"").trim();if(0==e.length||0==t.length||0==r.length){n.toast(o.EMPTY_RESULTS_LABEL,{type:TC.Consts.msgType.INFO,duration:5e3});a&&a(null)}else{if(e.indexOf(":")>-1){s=e.split(":")[0];e=e.split(":")[1]}var p,c={id:l,type:SITNA.Consts.layerType.WFS,url:o.url,version:o.version,stealth:!0,geometryName:"the_geom",featurePrefix:s,featureType:e,maxFeatures:1,properties:o.transformFilter([{name:t,value:r,type:TC.Consts.comparison.EQUAL_TO}]),outputFormat:TC.Consts.format.JSON};n.addLayer(c).then(function(e){p=e;i.search={layer:e,type:SITNA.Consts.mapSearchType.GENERIC}});n.on(TC.Consts.event.FEATURESADD,function(e){if(e.layer==p&&e.layer.features&&e.layer.features.length>0){for(var t=0;t<e.layer.features.length;t++)e.layer.features[t].showsPopup!=o.queryableFeatures&&(e.layer.features[t].showsPopup=o.queryableFeatures);n.zoomToFeatures(e.layer.features)}});n.on(TC.Consts.event.LAYERUPDATE,function(e){e.layer==p&&e.newData&&e.newData.features&&0==e.newData.features.length&&n.toast(o.EMPTY_RESULTS_LABEL,{type:TC.Consts.msgType.INFO,duration:5e3});a&&a(e.layer==p&&e.newData&&e.newData.features&&0==e.newData.features.length?null:l)})}};i.removeSearch=function(e){if(i.search)if(o.availableSearchTypes[i.search.type]&&o.availableSearchTypes[i.search.type].hasOwnProperty("goTo")){for(var t=0;t<i.search.layer.features.length;t++)i.search.layer.removeFeature(i.search.layer.features[t]);i.search=null}else n.removeLayer(i.search.layer).then(function(){i.search=null});e&&e()};i.exportImage=function(){return n.exportImage()};i.search=null};SITNA.Consts=TC.Consts;SITNA.Cfg=TC.Cfg;SITNA.Cfg.layout=TC.apiLocation+"TC/layout/responsive";