!function(){self.addEventListener("install",function(e){var n="TC.offline.map.common";e.waitUntil(caches.has(n).then(function(e){e&&caches.open(n).then(function(e){e.keys().then(function(e){console.log("Revisando cache...");e.length&&fetch(e[0]).then(function(){caches.delete(n).then(function(){console.log("Cache con bug ("+n+") borrada")})},function(e){console.log(e)})})})}))});self.addEventListener("activate",function(e){e.waitUntil(self.clients.claim())});self.addEventListener("fetch",function(e){e.respondWith(caches.match(e.request).then(function(n){return n||fetch(e.request).catch(function(n){console.log("[fetch] Could not fetch "+e.request.url+": "+n)})}))});var e={};self.addEventListener("message",function(n){var t=function(e){self.clients.matchAll().then(function(n){n.forEach(function(n){n.postMessage(e)})})},c=n.data.action;switch(c){case"create":var a=n.data.name,o=n.data.silent;e[a]=c;var i=function(){caches.open(a).then(function(i){var s=n.data.list,f=s.length,l=0;s.forEach(function(n){e[a]&&i.add(n).then(function(){if(!o){t({action:c,name:a,event:"progress",count:++l,total:f});l===f&&t({action:c,name:a,event:"cached"})}},function(){t({action:c,name:a,event:"error",url:n})})})})};caches.delete(a).then(i,i);break;case"delete":a=n.data.name,o=n.data.silent;delete e[a];caches.delete(a).then(function(){o||t({action:c,name:a,event:"deleted"})},function(){t({action:c,name:a,event:"error"})})}})}();