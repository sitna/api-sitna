!function(e,t){"use strict";function r(e,t){var r=e.length;return~t&&r>t&&(r=t),r}function o(e,t){A.setTimeout(e,t||0)}function n(e){o(function(){throw e})}function a(e){return/(^(https?:)?\/\/)|(\.(js|php)$)/.test(e)&&!/(\n|\r)/m.test(e)}function s(e){return e&&e.constructor&&e.call&&e.apply}function i(e){var t;return(t=Array.isArray)?t(e)?e:[e]:h.concat(e)}function l(e){return h.slice.call(e)}function C(){var e=l(arguments);return function(){return S.apply(S,e.concat(l(arguments)))}}function c(e,t){var r=this;if((!r.readyState||/^c|loade/.test(r.readyState))&&!r.loadStatus){if(r.onload=r.onreadystatechange=r.onerror=null,r.loadStatus=!0,t&&"error"===t.type){var o=r.src||"Resource",a=" fails to load.",s={name:"ConnectionError",source:o,evt:t,stack:o+a,message:a,toString:function(){return this.source+this.message}};return n(s),void e.reject(s)}e.resolve()}}function T(e,t){var r="script",o=O.createElement(r),n=O.getElementsByTagName(r),a=n[n.length-1];if(o.async=!0,o.src=e,t){o.loadStatus=!1;var s=C(c,o,t);o.onload=o.onreadystatechange=o.onerror=s;var i=a;i=i||document.body.firstChild,i.parentNode.insertBefore(o,i)}}function p(e,t){R(function(){try{e.call(null,t)}catch(r){t.reject(r)}})}function u(e,t){if(!s(e)){if(a(e))return void T(e,t);if(L)return e=m+encodeURIComponent(e),void T(e,t)}var r=s(e)?e:Function(e);if(!t.async){var o=r;r=function(e){try{o.call(null),e.resolve()}catch(t){e.reject(t)}}}p(r,t)}function f(e,t){var r=this;r.tasks=[],r.callbacks=[],r.errors=[],r.data={},r.nextTask=0,r.nextCallback=0,r.until=-1,r.digest=!1,r.add(e).whenDone(t)}function d(){var e=this;if(e.digest)return void o(C(d,e),50/3);e.digest=!0;for(var t,n,a=e.nextCallback;a<r(e.callbacks,e.until);a++)if(e.nextTask===e.tasks.length){if(n=e.nextCallback,t=e.callbacks[n]){if(e.nextCallback=a+1,t.call(null,e.data,e.nextTask-1,e.errors),!t.untilThen)continue;e.nextCallback--,e.until=-1}e.callbacks.splice(n,1)}e.digest=!1}function E(){var e=this;return e.nextTask<e.tasks.length&&++e.nextTask!==e.tasks.length?e:(d.call(e),e)}function g(e,t){return new f(e,t)}var m="data:application/javascript,",y="OMITTED",O=document,A=window,h=Array.prototype,L=!0;O.all&&!O.addEventListener&&(L=!1);var R=A.requestAnimationFrame||A.webkitRequestAnimationFrame||A.mozRequestAnimationFrame||o,S=Function.call;f.prototype.resolve=function(e,t){var r=this;return e&&e!==y&&(r.data[e]=t),E.call(r)},f.prototype.reject=function(e){var t=this;return e&&(n(e),t.errors.push(e)),E.call(t)},f.prototype.whenDone=function(e){var t=this;return e?t.nextTask>t.tasks.length?t:(t.callbacks.push(e),t.nextTask===t.tasks.length&&t.resolve(),t):t},f.prototype.add=function(e,t){var r=this;if(!e)return r;if(t&&r[t]){var o=new Error("Callback value name: "+t+" is registered");n(o),r.errors.push(o)}e=i(e);for(var a,s=({resolve:C(r.resolve,r,t),reject:r.reject,async:!!t},0);s<e.length;s++)a=e[s],a&&(r.tasks.push(a),u(a,r));return r},f.prototype.then=function(e,t){function r(){o.until=o.nextCallback,o.add(e,t)}var o=this;return e?(r.untilThen=!0,o.whenDone(r)):o},"undefined"!=typeof module&&module.exports?module.exports=g:"function"==typeof define&&define.amd?define(function(){return g}):t[e]=g}("asyncJS",this);var TC=TC||{};TC.version="1.1.3",function(){if(!TC.apiLocation){var e,t;if(document.currentScript)t=document.currentScript;else{var r=document.getElementsByTagName("script");t=r[r.length-1]}var e=t.getAttribute("src");TC.apiLocation=e.substr(0,e.lastIndexOf("/")+1)}}(),TC.Consts||(TC.Consts={},TC.Consts.OLNS_LEGACY="OpenLayers",TC.Consts.OLNS="ol",TC.Consts.PROJ4JSOBJ_LEGACY="Proj4js",TC.Consts.PROJ4JSOBJ="proj4",TC.Consts.GEOGRAPHIC="geographic",TC.Consts.UTM="UTM",TC.Consts.OLD_BROWSER_ALERT="TC.oldBrowserAlert",TC.Consts.CLUSTER_ANIMATION_DURATION=200,TC.Consts.ZOOM_ANIMATION_DURATION=300,TC.Consts.URL_MAX_LENGTH=2048,TC.Consts.METER_PRECISION=0,TC.Consts.DEGREE_PRECISION=5,TC.Consts.url={SPLIT_REGEX:/([^:]*:)?\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,MODERNIZR:"lib/modernizr.js",JQUERY_LEGACY:TC.apiLocation+"lib/jquery/jquery.1.10.2.js",JQUERY:"//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.js",OL_LEGACY:"lib/OpenLayers/OpenLayers.debug.js",OL:"lib/ol/build/ol-custom.js",OL_CONNECTOR_LEGACY:"TC/ol/ol2.js",OL_CONNECTOR:"TC/ol/ol3.js",TEMPLATING:"lib/dust/dust-full-helpers.min.js",TEMPLATING_I18N:"lib/dust/dustjs-i18n.min.js",PROJ4JS_LEGACY:"lib/proj4js/legacy/proj4js-compressed.js",PROJ4JS:"lib/proj4js/proj4-src.js",SPATIALREFERENCE:"http://spatialreference.org/",LOCALFORAGE:TC.apiLocation+"lib/localForage/localforage.min.js",D3C3:TC.apiLocation+"lib/d3c3/d3c3.min.js",CESIUM:TC.apiLocation+"lib/cesium/debug/Cesium.js",JSNLOG:"lib/jsnlog/jsnlog.min.js",ERROR_LOGGER:TC.apiLocation+"errors/logger.ashx",PDFMAKE:TC.apiLocation+"lib/pdfmake/pdfmake-fonts.min.js",JSONPACK:"lib/jsonpack/jsonpack.min.js"},TC.Consts.classes={MAP:"tc-map",POINT:"tc-point",MARKER:"tc-marker",VISIBLE:"tc-visible",HIDDEN:"tc-hidden",COLLAPSED:"tc-collapsed",CHECKED:"tc-checked",DISABLED:"tc-disabled",ACTIVE:"tc-active",LASTCHILD:"tc-lastchild",TRANSPARENT:"tc-transparent",DROP:"tc-drop",LOADING:"tc-loading",IPAD_IOS7_FIX:"tc-ipad-ios7-fix",INFO:"tc-msg-info",WARNING:"tc-msg-warning",ERROR:"tc-msg-error"},TC.Consts.msgType={INFO:"info",WARNING:"warning",ERROR:"error"},TC.Consts.event={MAPLOAD:"mapload.tc",MAPREADY:"mapready.tc",BEFORELAYERADD:"beforelayeradd.tc",LAYERADD:"layeradd.tc",LAYERREMOVE:"layerremove.tc",LAYERORDER:"layerorder.tc",BEFORELAYERUPDATE:"beforelayerupdate.tc",LAYERUPDATE:"layerupdate.tc",LAYERERROR:"layererror.tc",BEFOREBASELAYERCHANGE:"beforebaselayerchange.tc",BASELAYERCHANGE:"baselayerchange.tc",BEFOREUPDATE:"beforeupdate.tc",UPDATE:"update.tc",BEFOREZOOM:"beforezoom.tc",ZOOM:"zoom.tc",BEFOREUPDATEPARAMS:"beforeupdateparams.tc",UPDATEPARAMS:"updateparams.tc",VECTORUPDATE:"vectorupdate.tc",FEATUREADD:"featureadd.tc",BEFOREFEATURESADD:"beforefeaturesadd.tc",FEATURESADD:"featuresadd.tc",FEATUREREMOVE:"featureremove.tc",FEATURESIMPORT:"featuresimport.tc",BEFORETILELOAD:"beforetileload.tc",TILELOAD:"tileload.tc",CONTROLACTIVATE:"controlactivate.tc",CONTROLDEACTIVATE:"controldeactivate.tc",BEFORECONTROLRENDER:"beforecontrolrender.tc",CONTROLRENDER:"controlrender.tc",BEFORELAYOUTLOAD:"beforelayoutload.tc",LAYOUTLOAD:"layoutload.tc",LAYERVISIBILITY:"layervisibility.tc",LAYEROPACITY:"layeropacity.tc",FEATURECLICK:"featureclick.tc",NOFEATURECLICK:"nofeatureclick.tc",BEFOREFEATUREINFO:"beforefeatureinfo.tc",FEATUREINFO:"featureinfo.tc",NOFEATUREINFO:"nofeatureinfo.tc",FEATUREINFOERROR:"featureinfoerror.tc",CLICK:"click.tc",STARTLOADING:"startloading.tc",STOPLOADING:"stoploading.tc",EXTERNALSERVICEADDED:"externalserviceadded.tc"},TC.Consts.layer={IDENA_ORTHOPHOTO:"ortofoto",IDENA_BASEMAP:"mapabase",IDENA_CADASTER:"catastro",IDENA_CARTO:"cartografia",IDENA_ORTHOPHOTO2012:"ortofoto2012",IDENA_DYNBASEMAP:"mapabase_dinamico",IDENA_BW_RELIEF:"relieve_bn",IDENA_BASEMAP_ORTHOPHOTO:"base_orto",BLANK:"ninguno"},TC.Consts.text={API_ERROR:"Error API SITNA",APP_ERROR:"Error de aplicación"},TC.Consts.layerType={WMS:"WMS",WMTS:"WMTS",WFS:"WFS",VECTOR:"vector",KML:"KML",GPX:"GPX",GEOJSON:"GeoJSON",GROUP:"group"},TC.Consts.geom={POINT:"point",MULTIPOINT:"multipoint",POLYLINE:"polyline",POLYGON:"polygon",MULTIPOLYLINE:"multipolyline",MULTIPOLYGON:"multipolygon",CIRCLE:"circle",RECTANGLE:"rectangle"},TC.Consts.searchType={CADASTRAL:"cadastral",COORDINATES:"coordinates",MUNICIPALITY:"municipality",COUNCIL:"council",LOCALITY:"locality",STREET:"street",NUMBER:"number",URBAN:"urban",COMMONWEALTH:"commonwealth"},TC.Consts.mapSearchType={MUNICIPALITY:TC.Consts.searchType.MUNICIPALITY,COUNCIL:TC.Consts.searchType.COUNCIL,URBAN:TC.Consts.searchType.URBAN,COMMONWEALTH:TC.Consts.searchType.COMMONWEALTH,GENERIC:"generic"},TC.Consts.comparison={EQUAL_TO:"=="},TC.Consts.WMTSEncoding={KVP:"KVP",RESTFUL:"RESTful"},TC.Consts.mimeType={PNG:"image/png",JPEG:"image/jpeg",JSON:"application/json",KML:"application/vnd.google-earth.kml+xml",GML:"application/gml+xml",XML:"application/xml"},TC.Consts.format={JSON:"JSON",KML:"KML",GML:"GML",GML2:"GML2",GML3:"GML2",GEOJSON:"GeoJSON",TOPOJSON:"TopoJSON",GPX:"GPX",WKT:"WKT"},TC.Consts.visibility={NOT_VISIBLE:0,NOT_VISIBLE_AT_RESOLUTION:1,HAS_VISIBLE:2,VISIBLE:4},TC.Consts.MARKER="marker",TC.Defaults=function(){var e={},t=function(t){var r=t.features.length,o=e[r];return o||(o=Math.round(15*Math.sqrt(r)),e[r]=o),o},r={},o=function(e){var t=e.features.length,o=r[t];if(!o){var n=Math.round(100+155*Math.min(6,t)/6);n>255&&(n=255);var a=Math.round(255-155*Math.max(0,t-4)/6);100>a&&(a=100);var s=100;o="#"+n.toString(16)+a.toString(16)+s.toString(16),r[t]=o}return o};return{imageRatio:1.05,proxy:"",crs:"EPSG:25830",utmCrs:"EPSG:25830",geoCrs:"EPSG:4326",initialExtent:[541084.221,4640788.225,685574.4632,4796618.764],maxExtent:[480408,4599748,742552,4861892],baselayerExtent:[480408,4599748,742552,4861892],resolutions:[1024,512,256,128,64,32,16,8,4,2,1,.5,.25],pointBoundsRadius:30,extentMargin:.2,mouseWheelZoom:!0,attribution:'<a href="http://sitna.navarra.es/" target="_blank">SITNA</a>',oldBrowserAlert:!0,notifyApplicationErrors:!1,maxErrorCount:10,locale:"es_ES",screenSize:20,pixelTolerance:10,toastDuration:5e3,avgTileSize:31e3,availableBaseLayers:[{id:TC.Consts.layer.IDENA_BASEMAP,title:"Mapa base",type:TC.Consts.layerType.WMTS,url:"//idena.navarra.es/ogc/wmts/",matrixSet:"epsg25830extended",layerNames:"mapabase",encoding:TC.Consts.WMTSEncoding.RESTFUL,format:"image/png",isDefault:!0,hideTree:!0,thumbnail:TC.apiLocation+"TC/css/img/thumb-basemap.png"},{id:TC.Consts.layer.IDENA_ORTHOPHOTO,title:"Ortofoto 2014",type:TC.Consts.layerType.WMTS,url:"//idena.navarra.es/ogc/wmts/",matrixSet:"epsg25830reduced",layerNames:"ortofoto2014",encoding:TC.Consts.WMTSEncoding.RESTFUL,format:"image/jpeg",isDefault:!1,hideTree:!0,thumbnail:TC.apiLocation+"TC/css/img/thumb-orthophoto.jpg"},{id:TC.Consts.layer.IDENA_ORTHOPHOTO2012,title:"Ortofoto 2012",type:TC.Consts.layerType.WMTS,url:"//idena.navarra.es/ogc/wmts/",matrixSet:"epsg25830",layerNames:"ortofoto2012",encoding:TC.Consts.WMTSEncoding.RESTFUL,format:"image/jpeg",isDefault:!1,hideTree:!0,thumbnail:TC.apiLocation+"TC/css/img/thumb-ortho2012.jpg"},{id:TC.Consts.layer.IDENA_CADASTER,title:"Catastro",type:TC.Consts.layerType.WMS,url:"//idena.navarra.es/ogc/wms",layerNames:"catastro,regionesFronterizas",format:"image/png",isDefault:!1,hideTree:!0,thumbnail:TC.apiLocation+"TC/css/img/thumb-cadaster.png"},{id:TC.Consts.layer.IDENA_CARTO,title:"Cartografía topográfica",type:TC.Consts.layerType.WMS,url:"//idena.navarra.es/ogc/wms",layerNames:"IDENA:cartografia_topografica",format:"image/jpeg",isDefault:!1,hideTree:!0,thumbnail:TC.apiLocation+"TC/css/img/thumb-carto.png"},{id:TC.Consts.layer.IDENA_BW_RELIEF,title:"Relieve",type:TC.Consts.layerType.WMS,url:"//idena.navarra.es/ogc/wms",layerNames:"IDENA:mapa_relieve_bn",format:"image/jpeg",isDefault:!1,hideTree:!0,thumbnail:TC.apiLocation+"TC/css/img/thumb-relief_bw.jpg"},{id:TC.Consts.layer.IDENA_BASEMAP_ORTHOPHOTO,title:"Mapa base/ortofoto 2014",type:TC.Consts.layerType.WMS,url:"//idena.navarra.es/ogc/wms",layerNames:"mapaBase_orto",format:"image/jpeg",isDefault:!1,hideTree:!0,thumbnail:TC.apiLocation+"TC/css/img/thumb-base_ortho.jpg"},{id:TC.Consts.layer.IDENA_DYNBASEMAP,title:"Mapa base",type:TC.Consts.layerType.WMS,url:"//idena.navarra.es/ogc/wms",layerNames:"mapaBase,regionesFronterizas",format:"image/jpeg",isDefault:!1,hideTree:!0,thumbnail:TC.apiLocation+"TC/css/img/thumb-basemap.png"},{id:TC.Consts.layer.BLANK,title:"Mapa en blanco",type:TC.Consts.layerType.VECTOR}],baseLayers:[TC.Consts.layer.IDENA_BASEMAP,TC.Consts.layer.IDENA_ORTHOPHOTO,TC.Consts.layer.IDENA_CADASTER,TC.Consts.layer.IDENA_CARTO],defaultBaseLayer:TC.Consts.layer.IDENA_BASEMAP,workLayers:[],controls:{loadingIndicator:!0,navBar:!1,scaleBar:!1,scale:!1,scaleSelector:!1,overviewMap:!1,basemapSelector:!1,attribution:!0,TOC:!1,coordinates:!0,legend:!1,popup:!1,search:{url:"//idena.navarra.es/ogc/wfs",allowedSearchTypes:{coordinates:{},municipality:{}}},measure:!1,streetView:!0,featureInfo:!0},layout:null,styles:{point:{fillColor:"#f00",fillOpacity:.5,strokeColor:"#f00",strokeWidth:2,radius:6},marker:{classes:[TC.Consts.classes.MARKER+1,TC.Consts.classes.MARKER+2,TC.Consts.classes.MARKER+3,TC.Consts.classes.MARKER+4,TC.Consts.classes.MARKER+5],anchor:[.5,1],width:32,height:32},line:{strokeColor:"#f00",strokeWidth:2},polygon:{strokeColor:"#f00",strokeWidth:2,fillColor:"#000",fillOpacity:.3},cluster:{point:{cssClass:"",anchor:[.5,.5],fillColor:o,fillOpacity:.6,width:t,height:t,label:"${features.length}",fontColor:"#000",fontSize:12}},selection:{point:{fillColor:"#00f",fillOpacity:.5,strokeColor:"#00f",strokeWidth:2,radius:6},line:{strokeColor:"#00f",strokeWidth:2},polygon:{strokeColor:"#00f",strokeWidth:2,fillColor:"#000",fillOpacity:.3}}}}}(),function(){Array.prototype.map||(Array.prototype.map=function(e){"use strict";if(void 0===this||null===this)throw new TypeError;var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var o=new Array(r),n=arguments.length>=2?arguments[1]:void 0,a=0;r>a;a++)a in t&&(o[a]=e.call(n,t[a],a,t));return o}),TC.proxify=function(e){e=$.trim(e);var t=e;if(TC.Cfg.proxy){var r=!1;if(TC.Cfg.proxyExceptions)for(var o=0;o<TC.Cfg.proxyExceptions.length;o++)if(e.indexOf(TC.Cfg.proxyExceptions[o])>-1){r=!0;break}r||TC.Util.isSameOrigin(e)||("function"==typeof TC.Cfg.proxy?t=TC.Cfg.proxy(e):(t=TC.Cfg.proxy,"http"!=e.substr(0,4)&&(t+=window.location.protocol),t+=encodeURIComponent(e)))}return t};var e=function(){var e,t=document,r=t.getElementsByTagName("head");return 0===r.length?(e=t.createElement("head"),t.documentElement.insertBefore(e,document.body)):e=r[0],e};TC.syncLoadJS=function(t){var r=new XMLHttpRequest;r.open("GET",t,!1),r.send(null);var o=document.createElement("script");o.type="text/javascript",o.text=r.responseText,e().appendChild(o)},window.yepnope||TC.syncLoadJS(TC.apiLocation+TC.Consts.url.MODERNIZR),TC.isLegacy=TC.isLegacy||!Modernizr.canvas,window.jQuery||TC.syncLoadJS(Modernizr.canvas&&!TC.isLegacy?TC.Consts.url.JQUERY:TC.Consts.url.JQUERY_LEGACY),TC.isDebug=!1,$(document).ready(function(){var e,t="Unknown library",r="OpenLayers 2",o="OpenLayers 3";TC.Control?(e="Compiled",TC.isLegacy?window.OpenLayers&&(t=r):window.ol&&(t=o)):(e="On demand",t=TC.isLegacy?r:o),TC.version=TC.version+" ("+e+"; "+t+"; @ "+TC.apiLocation+")"}),TC.downloadedJSs=[],TC.requestedJSs={},TC.loadJSInOrder=function(e,t,r){TC.loadJS(e,t,r,!0)},TC.loadJS=function(e,t,r,o){arguments.length<4&&(o=!1);var n=$.isArray(t)?t:[t];if(Modernizr.canvas)if(e){for(var a,s=[],i=[],l=0;l<n.length;l++)a=n[l],TC.downloadedJSs[a]||(TC.requestedJSs[a]?i.push(a):s.push(a));if(0==s.length&&0==i.length)r();else if(s.length>0&&0==i.length){for(var C=asyncJS(),l=0;l<s.length;l++)TC.requestedJSs[s[l]]=C;if(o)for(var l=0;l<s.length;l++)0==l?C.add(s[l]):C.then(s[l]);else C.add(s);C.whenDone(function(){for(var e=0;e<s.length;e++)TC.downloadedJSs.push(s[e]),delete TC.requestedJSs[s[e]];r()})}else if(0==s.length&&i.length>0)for(var c,T=i.length,p=0,l=0;l<i.length;l++){var c=i[l],C=TC.requestedJSs[c];C.whenDone(function(e,t,o){p++,p>=T&&r()})}else console.error("Mezcla de tareas en proceso y nuevas!!")}else r();else{if(e)for(var l=0;l<n.length;l++)TC.syncLoadJS(n[l]);r&&r()}};var t=function(e){for(var t=!1,r=0;r<document.styleSheets.length;r++){var o=document.styleSheets[r].href;if(o){var n=o.indexOf(e);if(n>=0&&n===o.length-e.length){t=!0;break}}}return t};TC.loadCSS=function(r){if(!t(r)){var o=document.createElement("link");o.rel="stylesheet",o.href=r,e().appendChild(o)}};TC.loadProjDef=function(e,t){var r,o="EPSG:",n="urn:ogc:def:crs:EPSG::",a="http://www.opengis.net/gml/srs/epsg.xml#",s=o+"25830",i=n+"25830",l=a+"25830";TC.isLegacy?(Proj4js.defs[s]="+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs",Proj4js.defs[i]=Proj4js.defs[s],Proj4js.defs[l]=Proj4js.defs[s],r=function(e){return Proj4js.defs[e]}):(proj4.defs(s,"+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs"),proj4.defs(i,proj4.defs(s)),proj4.defs(l,proj4.defs(s)),r=function(e){return proj4.defs(e)}),window.Proj4js||(window.Proj4js={Proj:function(e){return proj4(Proj4js.defs[e])},defs:proj4.defs,transform:proj4});var C=function(e){s=o+e,i=n+e,l=a+e,Proj4js.defs[i]=Proj4js.defs[s],Proj4js.defs[l]=Proj4js.defs[s],TC.isLegacy||(proj4.defs(s,Proj4js.defs[s]),proj4.defs(i,Proj4js.defs[s]),proj4.defs(l,Proj4js.defs[s]))};if(r(e))$.isFunction(t)&&(C(T),t());else{var c=e.lastIndexOf("#");0>c&&(c=e.lastIndexOf(":"));var T=e.substr(c+1),p=TC.proxify(TC.Consts.url.SPATIALREFERENCE+"ref/epsg/"+T+"/proj4js/");"boolean"==typeof t?t?(TC.syncLoadJS(p),C(T)):TC.loadJS(!0,p):TC.loadJS(!0,p,function(){C(T),t()})}},TC.url={templating:[TC.apiLocation+TC.Consts.url.TEMPLATING,TC.apiLocation+TC.Consts.url.TEMPLATING_I18N]},TC.isLegacy?(TC.url.ol=TC.apiLocation+TC.Consts.url.OL_LEGACY,TC.url.olConnector=TC.apiLocation+TC.Consts.url.OL_CONNECTOR_LEGACY,TC.url.proj4js=TC.apiLocation+TC.Consts.url.PROJ4JS_LEGACY):(TC.url.ol=TC.apiLocation+TC.Consts.url.OL,TC.url.olConnector=TC.apiLocation+TC.Consts.url.OL_CONNECTOR,TC.url.proj4js=TC.apiLocation+TC.Consts.url.PROJ4JS),TC.Cfg=$.extend(!0,{},TC.Defaults,TC.Cfg),TC.capabilities={},TC.WFScapabilities={},TC.cache={},TC.inherit=function(e,t){function r(){}r.prototype=t.prototype,e._super=t.prototype,e.prototype=new r,e.prototype.constructor=e},TC.alert=function(e){alert(e)},TC.prompt=function(e,t,r){var o=prompt(e,t);$.isFunction(r)&&r(o)},TC.confirm=function(e,t,r){confirm(e)?$.isFunction(t)&&t():$.isFunction(r)&&r()},TC.error=function(e){window.console&&console.error(e)},TC.Object=function(){var e=this;e.$events=$(e)},TC.Object.prototype.on=function(e,t){var r=this;return r.$events.on(e,t),r},TC.Object.prototype.one=function(e,t){var r=this;return r.$events.one(e,t),r},TC.Object.prototype.off=function(e,t){var r=this;return r.$events.off(e,t),r},TC.wrap={Map:function(e){var t=this;t.parent=e,t.map=null,t.mapDeferred=new $.Deferred,t.getMap=function(){return t.map||t.mapDeferred.promise()}},Layer:function(e){var t=this;t.parent=e,t.layer=null,t.layerDeferred=new $.Deferred,t.getLayer=function(){return t.layer||t.layerDeferred.promise()},t.setLayer=function(e){t.layer=e,e?t.layerDeferred.resolve(e):t.layerDeferred.reject()}},layer:{Raster:function(){TC.wrap.Layer.apply(this,arguments)},Vector:function(){TC.wrap.Layer.apply(this,arguments)}},Control:function(e){var t=this;t.parent=e},control:{Click:function(){TC.wrap.Control.apply(this,arguments)},ScaleBar:function(){TC.wrap.Control.apply(this,arguments)},NavBar:function(){TC.wrap.Control.apply(this,arguments)},Coordinates:function(){TC.wrap.Control.apply(this,arguments)},Search:function(){TC.wrap.Control.apply(this,arguments)},Measure:function(){TC.wrap.Control.apply(this,arguments)},OverviewMap:function(){TC.wrap.Control.apply(this,arguments)},FeatureInfo:function(){TC.wrap.Control.apply(this,arguments)},Popup:function(){TC.wrap.Control.apply(this,arguments)},PolygonFeatureInfo:function(){TC.wrap.Control.apply(this,arguments)},Geolocation:function(){TC.wrap.Control.apply(this,arguments)},Draw:function(){TC.wrap.Control.apply(this,arguments)},CacheBuilder:function(){TC.wrap.Control.apply(this,arguments)},Edit:function(){TC.wrap.Control.apply(this,arguments)}},Feature:function(){}},TC.inherit(TC.wrap.layer.Raster,TC.wrap.Layer),TC.inherit(TC.wrap.layer.Vector,TC.wrap.Layer),TC.inherit(TC.wrap.control.Click,TC.wrap.Control),TC.inherit(TC.wrap.control.ScaleBar,TC.wrap.Control),TC.inherit(TC.wrap.control.NavBar,TC.wrap.Control),TC.inherit(TC.wrap.control.Coordinates,TC.wrap.Control),TC.inherit(TC.wrap.control.Measure,TC.wrap.Control),TC.inherit(TC.wrap.control.OverviewMap,TC.wrap.Control),TC.inherit(TC.wrap.control.Popup,TC.wrap.Control),TC.inherit(TC.wrap.control.FeatureInfo,TC.wrap.control.Click),TC.inherit(TC.wrap.control.PolygonFeatureInfo,TC.wrap.control.Click),TC.inherit(TC.wrap.control.Geolocation,TC.wrap.Control),TC.inherit(TC.wrap.control.Draw,TC.wrap.Control),TC.inherit(TC.wrap.control.CacheBuilder,TC.wrap.Control),TC.inherit(TC.wrap.control.Edit,TC.wrap.Control),TC.loadCSS(TC.apiLocation+"TC/css/tcmap.css"),TC.Map||TC.syncLoadJS(TC.apiLocation+"TC/Map.js"),TC.Util||TC.syncLoadJS(TC.apiLocation+"TC/Util.js");var r=1;TC.getUID=function(){var e=r.toString();return r+=1,e}}(),function(e,t){function r(e){return e}function o(e){return decodeURIComponent(e.replace(n," "))}var n=/\+/g;e.cookie=function(n,a,s){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(a))||null===a)){if(s=e.extend({},e.cookie.defaults,s),null===a&&(s.expires=-1),"number"==typeof s.expires){var i=s.expires,l=s.expires=new Date;l.setDate(l.getDate()+i)}return a=String(a),t.cookie=[encodeURIComponent(n),"=",s.raw?a:encodeURIComponent(a),s.expires?";expires="+s.expires.toUTCString():"",s.path?";path="+s.path:"",s.domain?";domain="+s.domain:"",s.secure?";secure":""].join("")}s=a||e.cookie.defaults||{};for(var C,c=s.raw?r:o,T=t.cookie.split("; "),p=0;C=T[p]&&T[p].split("=");p++)if(c(C.shift())===n)return c(C.join("="));return null},e.cookie.defaults={}}(jQuery,document)),$(function(){var e=function(){var e,t,r,o=(navigator.appVersion,navigator.userAgent),n=navigator.appName,a=""+parseFloat(navigator.appVersion),s=parseInt(navigator.appVersion,10);return-1!=(t=o.indexOf("Opera"))?(n="Opera",a=o.substring(t+6),-1!=(t=o.indexOf("Version"))&&(a=o.substring(t+8))):-1!=(t=o.indexOf("MSIE"))?(n="Microsoft Internet Explorer",a=o.substring(t+5)):-1!=(t=o.indexOf("Chrome"))?(n="Chrome",a=o.substring(t+7)):-1!=(t=o.indexOf("Safari"))?(n="Safari",a=o.substring(t+7),-1!=(t=o.indexOf("Version"))&&(a=o.substring(t+8))):-1!=(t=o.indexOf("Firefox"))?(n="Firefox",a=o.substring(t+8)):(e=o.lastIndexOf(" ")+1)<(t=o.lastIndexOf("/"))&&(n=o.substring(e,t),a=o.substring(t+1),n.toLowerCase()==n.toUpperCase()&&(n=navigator.appName)),-1!=(r=a.indexOf(";"))&&(a=a.substring(0,r)),-1!=(r=a.indexOf(" "))&&(a=a.substring(0,r)),s=parseInt(""+a,10),isNaN(s)&&(a=""+parseFloat(navigator.appVersion),s=parseInt(navigator.appVersion,10)),{name:n,version:s}};TC.browser=e(),TC.Cfg.oldBrowserAlert&&!Modernizr.mq("only all")&&(TC.Util.storage.getCookie(TC.Consts.OLD_BROWSER_ALERT)||(alert("Con su "+TC.browser.name+" "+TC.browser.version+" la aplicación no funcionará. Le recomendamos que utilice un navegador más actualizado."),TC.Util.storage.setCookie(TC.Consts.OLD_BROWSER_ALERT,1))),/ip(ad|hone|od)/i.test(navigator.userAgent)&&(TC.Consts.event.CLICK="touchstart.tc"),window.JL||TC.syncLoadJS(TC.apiLocation+TC.Consts.url.JSNLOG),JL.defaultAjaxUrl=TC.Consts.url.ERROR_LOGGER,window.addEventListener("error",function(){var e=0,t=$("."+TC.Consts.classes.MAP).data("map");return function(r){var o=r.message,n=r.filename,a=r.lineno,s=r.colno,i=r.error,l=n.indexOf(TC.apiLocation)>0;if((TC.Cfg.notifyApplicationErrors||l)&&e<TC.Cfg.maxErrorCount){var C=l?TC.Consts.text.API_ERROR:TC.Consts.text.APP_ERROR;if(JL("onerrorLogger").fatalException({msg:C,errorMsg:o,url:n,lineNumber:a,column:s,appUrl:location.href,prevState:t.getPreviousMapState(),userAgent:navigator.userAgent},i),e++,!TC.isDebug){var c="webmaster@itracasa.es";$.when(TC.i18n.loadResources(!TC.i18n[t.options.locale],TC.apiLocation+"TC/resources/",t.options.locale)).done(function(){TC.error(TC.Util.getLocaleString(t.options.locale,"genericError")+(t.options.contactEmail||c),{type:TC.Consts.msgType.ERROR})})}}return!1}}(),!1)});